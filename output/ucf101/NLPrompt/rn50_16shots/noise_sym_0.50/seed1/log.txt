***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.1572, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 254
clean true:249
clean false:5
clean_rate:0.9803149606299213
noisy true:263
noisy false:1099
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 1362
epoch [1/200] batch [5/7] time 0.172 (0.208) data 0.095 (0.110) loss_x loss_x 2.8379 (2.6441) acc_x 43.7500 (48.7500) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/42] time 0.172 (0.196) data 0.094 (0.108) loss_u loss_u 0.9707 (0.9649) acc_u 3.1250 (8.7500) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [10/42] time 0.170 (0.194) data 0.093 (0.109) loss_u loss_u 0.9692 (0.9661) acc_u 9.3750 (9.6875) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [15/42] time 0.178 (0.193) data 0.100 (0.110) loss_u loss_u 0.9619 (0.9665) acc_u 12.5000 (8.7500) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [20/42] time 0.163 (0.189) data 0.086 (0.106) loss_u loss_u 0.9556 (0.9652) acc_u 6.2500 (8.2812) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [25/42] time 0.196 (0.189) data 0.118 (0.108) loss_u loss_u 0.9229 (0.9624) acc_u 15.6250 (8.7500) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [30/42] time 0.187 (0.189) data 0.110 (0.109) loss_u loss_u 0.9531 (0.9626) acc_u 15.6250 (8.7500) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [35/42] time 0.173 (0.188) data 0.096 (0.107) loss_u loss_u 0.9365 (0.9616) acc_u 15.6250 (9.0179) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [40/42] time 0.189 (0.188) data 0.113 (0.108) loss_u loss_u 0.9824 (0.9624) acc_u 0.0000 (8.5156) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1009
confident_label rate tensor(0.1894, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 306
clean true:303
clean false:3
clean_rate:0.9901960784313726
noisy true:304
noisy false:1006
after delete: len(clean_dataset) 306
after delete: len(noisy_dataset) 1310
epoch [2/200] batch [5/9] time 0.185 (0.174) data 0.108 (0.097) loss_x loss_x 1.3242 (1.5434) acc_x 78.1250 (65.6250) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/40] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.8892 (0.9068) acc_u 12.5000 (12.5000) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [10/40] time 0.184 (0.178) data 0.107 (0.100) loss_u loss_u 0.9058 (0.9145) acc_u 15.6250 (11.5625) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [15/40] time 0.171 (0.177) data 0.094 (0.099) loss_u loss_u 0.8828 (0.9113) acc_u 18.7500 (12.7083) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [20/40] time 0.164 (0.175) data 0.087 (0.098) loss_u loss_u 0.8740 (0.9062) acc_u 18.7500 (13.2812) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [25/40] time 0.191 (0.176) data 0.114 (0.099) loss_u loss_u 0.9561 (0.9029) acc_u 6.2500 (13.5000) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [30/40] time 0.180 (0.176) data 0.102 (0.098) loss_u loss_u 0.9121 (0.9050) acc_u 15.6250 (13.4375) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [35/40] time 0.179 (0.176) data 0.101 (0.098) loss_u loss_u 0.8696 (0.9048) acc_u 18.7500 (13.2143) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [40/40] time 0.158 (0.175) data 0.080 (0.098) loss_u loss_u 0.8467 (0.8996) acc_u 21.8750 (13.9844) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 850
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 388
clean true:385
clean false:3
clean_rate:0.9922680412371134
noisy true:381
noisy false:847
after delete: len(clean_dataset) 388
after delete: len(noisy_dataset) 1228
epoch [3/200] batch [5/12] time 0.178 (0.170) data 0.101 (0.093) loss_x loss_x 1.4570 (1.2681) acc_x 59.3750 (65.0000) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [10/12] time 0.169 (0.177) data 0.091 (0.100) loss_x loss_x 1.6328 (1.2053) acc_x 56.2500 (67.5000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/38] time 0.190 (0.175) data 0.113 (0.098) loss_u loss_u 0.9424 (0.9168) acc_u 6.2500 (10.6250) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [10/38] time 0.197 (0.175) data 0.120 (0.098) loss_u loss_u 0.9683 (0.9196) acc_u 3.1250 (10.6250) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [15/38] time 0.179 (0.175) data 0.102 (0.098) loss_u loss_u 0.8354 (0.9121) acc_u 15.6250 (10.8333) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [20/38] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.9312 (0.9129) acc_u 3.1250 (10.6250) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [25/38] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9263 (0.9155) acc_u 12.5000 (10.5000) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [30/38] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.8867 (0.9119) acc_u 15.6250 (10.9375) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [35/38] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9165 (0.9114) acc_u 6.2500 (10.9821) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 801
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 409
clean true:400
clean false:9
clean_rate:0.9779951100244498
noisy true:415
noisy false:792
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1207
epoch [4/200] batch [5/12] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 1.1094 (1.1019) acc_x 71.8750 (73.1250) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/12] time 0.222 (0.191) data 0.145 (0.114) loss_x loss_x 1.0693 (1.0726) acc_x 75.0000 (73.4375) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/37] time 0.182 (0.186) data 0.106 (0.110) loss_u loss_u 0.8770 (0.9093) acc_u 12.5000 (8.7500) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [10/37] time 0.180 (0.185) data 0.102 (0.108) loss_u loss_u 0.9438 (0.9167) acc_u 6.2500 (8.7500) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [15/37] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.9121 (0.9146) acc_u 12.5000 (9.5833) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [20/37] time 0.184 (0.185) data 0.105 (0.108) loss_u loss_u 0.9277 (0.9163) acc_u 6.2500 (9.3750) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [25/37] time 0.186 (0.185) data 0.109 (0.108) loss_u loss_u 0.8945 (0.9149) acc_u 9.3750 (9.5000) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [30/37] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9453 (0.9147) acc_u 6.2500 (9.5833) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [35/37] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.9424 (0.9153) acc_u 6.2500 (9.3750) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 798
confident_label rate tensor(0.2791, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 451
clean true:448
clean false:3
clean_rate:0.9933481152993349
noisy true:370
noisy false:795
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1165
epoch [5/200] batch [5/14] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.9766 (1.0838) acc_x 75.0000 (70.6250) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/14] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.9038 (1.0297) acc_x 68.7500 (72.8125) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/36] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.9453 (0.9522) acc_u 6.2500 (6.8750) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [10/36] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9424 (0.9439) acc_u 12.5000 (7.8125) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [15/36] time 0.172 (0.181) data 0.095 (0.104) loss_u loss_u 0.9302 (0.9398) acc_u 9.3750 (7.9167) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [20/36] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.8955 (0.9351) acc_u 12.5000 (8.4375) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [25/36] time 0.170 (0.180) data 0.093 (0.103) loss_u loss_u 0.9512 (0.9323) acc_u 3.1250 (9.1250) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [30/36] time 0.209 (0.182) data 0.132 (0.105) loss_u loss_u 0.9624 (0.9316) acc_u 3.1250 (8.9583) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [35/36] time 0.189 (0.183) data 0.112 (0.106) loss_u loss_u 0.9106 (0.9291) acc_u 9.3750 (9.3750) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 747
confident_label rate tensor(0.2816, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 455
clean true:449
clean false:6
clean_rate:0.9868131868131869
noisy true:420
noisy false:741
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1161
epoch [6/200] batch [5/14] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 1.3477 (1.1875) acc_x 56.2500 (69.3750) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [10/14] time 0.176 (0.184) data 0.100 (0.108) loss_x loss_x 0.8643 (1.1325) acc_x 75.0000 (72.1875) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/36] time 0.164 (0.177) data 0.088 (0.101) loss_u loss_u 0.8940 (0.9181) acc_u 12.5000 (9.3750) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [10/36] time 0.178 (0.177) data 0.100 (0.100) loss_u loss_u 0.9595 (0.9390) acc_u 3.1250 (6.8750) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [15/36] time 0.219 (0.179) data 0.142 (0.102) loss_u loss_u 0.9136 (0.9288) acc_u 3.1250 (8.1250) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [20/36] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9702 (0.9254) acc_u 3.1250 (8.4375) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [25/36] time 0.174 (0.179) data 0.097 (0.102) loss_u loss_u 0.9517 (0.9260) acc_u 9.3750 (8.6250) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [30/36] time 0.187 (0.179) data 0.109 (0.102) loss_u loss_u 0.9189 (0.9271) acc_u 12.5000 (8.5417) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [35/36] time 0.195 (0.180) data 0.117 (0.102) loss_u loss_u 0.9487 (0.9267) acc_u 6.2500 (8.5714) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 757
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 437
clean true:434
clean false:3
clean_rate:0.9931350114416476
noisy true:425
noisy false:754
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1179
epoch [7/200] batch [5/13] time 0.189 (0.172) data 0.113 (0.095) loss_x loss_x 0.6870 (0.7933) acc_x 81.2500 (76.2500) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/13] time 0.181 (0.177) data 0.105 (0.100) loss_x loss_x 0.6899 (0.9505) acc_x 87.5000 (75.6250) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/36] time 0.181 (0.179) data 0.105 (0.102) loss_u loss_u 0.8955 (0.9210) acc_u 12.5000 (9.3750) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [10/36] time 0.167 (0.178) data 0.089 (0.101) loss_u loss_u 0.8643 (0.8986) acc_u 12.5000 (10.6250) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [15/36] time 0.184 (0.178) data 0.107 (0.102) loss_u loss_u 0.9448 (0.9068) acc_u 3.1250 (10.4167) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/36] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9199 (0.9067) acc_u 12.5000 (10.6250) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [25/36] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9116 (0.9049) acc_u 9.3750 (11.1250) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [30/36] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9287 (0.9108) acc_u 6.2500 (10.3125) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [35/36] time 0.184 (0.180) data 0.106 (0.104) loss_u loss_u 0.9141 (0.9104) acc_u 9.3750 (10.7143) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 763
confident_label rate tensor(0.2760, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 446
clean true:438
clean false:8
clean_rate:0.9820627802690582
noisy true:415
noisy false:755
after delete: len(clean_dataset) 446
after delete: len(noisy_dataset) 1170
epoch [8/200] batch [5/13] time 0.157 (0.163) data 0.081 (0.086) loss_x loss_x 0.9590 (0.9896) acc_x 84.3750 (80.0000) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [10/13] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 1.2881 (1.0066) acc_x 62.5000 (74.3750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/36] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9248 (0.9437) acc_u 9.3750 (6.8750) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [10/36] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.9204 (0.9307) acc_u 6.2500 (7.8125) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [15/36] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8730 (0.9268) acc_u 15.6250 (8.1250) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [20/36] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9077 (0.9221) acc_u 12.5000 (9.0625) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [25/36] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.9780 (0.9246) acc_u 3.1250 (8.8750) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [30/36] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.8979 (0.9212) acc_u 9.3750 (9.2708) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [35/36] time 0.186 (0.182) data 0.108 (0.104) loss_u loss_u 0.9204 (0.9169) acc_u 6.2500 (9.5536) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 696
confident_label rate tensor(0.2921, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 472
clean true:468
clean false:4
clean_rate:0.9915254237288136
noisy true:452
noisy false:692
after delete: len(clean_dataset) 472
after delete: len(noisy_dataset) 1144
epoch [9/200] batch [5/14] time 0.159 (0.164) data 0.082 (0.088) loss_x loss_x 1.2637 (0.8027) acc_x 68.7500 (82.5000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [10/14] time 0.167 (0.164) data 0.090 (0.087) loss_x loss_x 0.8555 (0.9162) acc_x 68.7500 (77.1875) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/35] time 0.167 (0.166) data 0.089 (0.089) loss_u loss_u 0.9722 (0.9281) acc_u 6.2500 (9.3750) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/35] time 0.166 (0.166) data 0.088 (0.089) loss_u loss_u 0.9326 (0.9221) acc_u 9.3750 (9.6875) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [15/35] time 0.182 (0.169) data 0.104 (0.092) loss_u loss_u 0.9614 (0.9323) acc_u 6.2500 (8.7500) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [20/35] time 0.181 (0.171) data 0.104 (0.094) loss_u loss_u 0.9180 (0.9273) acc_u 9.3750 (9.2188) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [25/35] time 0.185 (0.173) data 0.108 (0.096) loss_u loss_u 0.9165 (0.9223) acc_u 9.3750 (10.0000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [30/35] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.8848 (0.9218) acc_u 9.3750 (9.6875) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [35/35] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.9092 (0.9210) acc_u 6.2500 (9.6429) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 743
confident_label rate tensor(0.2791, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 451
clean true:447
clean false:4
clean_rate:0.991130820399113
noisy true:426
noisy false:739
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1165
epoch [10/200] batch [5/14] time 0.158 (0.179) data 0.081 (0.102) loss_x loss_x 1.0322 (0.8516) acc_x 75.0000 (78.7500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/14] time 0.174 (0.171) data 0.097 (0.094) loss_x loss_x 1.4375 (0.9627) acc_x 65.6250 (76.2500) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/36] time 0.182 (0.176) data 0.103 (0.099) loss_u loss_u 0.9448 (0.9431) acc_u 9.3750 (7.5000) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [10/36] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8960 (0.9118) acc_u 15.6250 (11.2500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [15/36] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.9219 (0.9130) acc_u 12.5000 (11.4583) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [20/36] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8906 (0.9129) acc_u 12.5000 (10.9375) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [25/36] time 0.189 (0.179) data 0.111 (0.102) loss_u loss_u 0.8926 (0.9122) acc_u 9.3750 (10.7500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [30/36] time 0.173 (0.180) data 0.096 (0.103) loss_u loss_u 0.9556 (0.9143) acc_u 3.1250 (10.3125) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [35/36] time 0.182 (0.180) data 0.105 (0.102) loss_u loss_u 0.9458 (0.9147) acc_u 6.2500 (10.3571) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 712
confident_label rate tensor(0.2884, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 466
clean true:462
clean false:4
clean_rate:0.9914163090128756
noisy true:442
noisy false:708
after delete: len(clean_dataset) 466
after delete: len(noisy_dataset) 1150
epoch [11/200] batch [5/14] time 0.172 (0.174) data 0.096 (0.098) loss_x loss_x 0.9824 (0.8023) acc_x 81.2500 (82.5000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [10/14] time 0.159 (0.173) data 0.082 (0.097) loss_x loss_x 0.8838 (0.9101) acc_x 75.0000 (79.0625) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/35] time 0.186 (0.169) data 0.110 (0.092) loss_u loss_u 0.8916 (0.8827) acc_u 15.6250 (16.2500) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [10/35] time 0.172 (0.170) data 0.094 (0.094) loss_u loss_u 0.9341 (0.8980) acc_u 9.3750 (13.4375) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [15/35] time 0.183 (0.172) data 0.104 (0.095) loss_u loss_u 0.9341 (0.9094) acc_u 6.2500 (11.8750) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [20/35] time 0.186 (0.174) data 0.109 (0.098) loss_u loss_u 0.9741 (0.9154) acc_u 3.1250 (10.7812) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [25/35] time 0.184 (0.175) data 0.106 (0.098) loss_u loss_u 0.9692 (0.9146) acc_u 6.2500 (11.2500) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [30/35] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.9395 (0.9123) acc_u 6.2500 (11.2500) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [35/35] time 0.182 (0.177) data 0.106 (0.100) loss_u loss_u 0.8496 (0.9104) acc_u 25.0000 (11.5179) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 706
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:473
clean false:7
clean_rate:0.9854166666666667
noisy true:437
noisy false:699
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [12/200] batch [5/15] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.7568 (1.1238) acc_x 87.5000 (71.2500) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [10/15] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 1.2480 (1.0910) acc_x 71.8750 (71.5625) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [15/15] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.9204 (1.1024) acc_x 65.6250 (71.6667) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/35] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8726 (0.9174) acc_u 12.5000 (11.2500) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [10/35] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8569 (0.9079) acc_u 18.7500 (12.5000) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [15/35] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9492 (0.9164) acc_u 3.1250 (11.2500) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [20/35] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.9580 (0.9145) acc_u 6.2500 (11.0938) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [25/35] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9624 (0.9143) acc_u 3.1250 (10.8750) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [30/35] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9443 (0.9126) acc_u 6.2500 (10.8333) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [35/35] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.9600 (0.9121) acc_u 6.2500 (10.8036) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 708
confident_label rate tensor(0.2890, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 467
clean true:463
clean false:4
clean_rate:0.9914346895074947
noisy true:445
noisy false:704
after delete: len(clean_dataset) 467
after delete: len(noisy_dataset) 1149
epoch [13/200] batch [5/14] time 0.182 (0.183) data 0.105 (0.107) loss_x loss_x 1.0840 (0.8953) acc_x 68.7500 (75.0000) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [10/14] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.7007 (0.9221) acc_x 84.3750 (75.9375) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/35] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.8750 (0.8931) acc_u 15.6250 (13.7500) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [10/35] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.9131 (0.9078) acc_u 12.5000 (11.8750) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [15/35] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.8760 (0.9063) acc_u 15.6250 (12.2917) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [20/35] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.8989 (0.9036) acc_u 12.5000 (12.5000) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [25/35] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.9341 (0.9013) acc_u 9.3750 (12.6250) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [30/35] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.9346 (0.9039) acc_u 12.5000 (12.1875) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [35/35] time 0.181 (0.183) data 0.103 (0.106) loss_u loss_u 0.9575 (0.9052) acc_u 3.1250 (11.9643) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 702
confident_label rate tensor(0.3057, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 494
clean true:490
clean false:4
clean_rate:0.9919028340080972
noisy true:424
noisy false:698
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1122
epoch [14/200] batch [5/15] time 0.173 (0.173) data 0.096 (0.096) loss_x loss_x 1.0254 (0.8528) acc_x 78.1250 (80.0000) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [10/15] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 1.0703 (0.9791) acc_x 81.2500 (76.8750) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [15/15] time 0.167 (0.171) data 0.091 (0.094) loss_x loss_x 0.9585 (0.9848) acc_x 71.8750 (76.2500) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/35] time 0.169 (0.171) data 0.091 (0.094) loss_u loss_u 0.9258 (0.9111) acc_u 12.5000 (11.2500) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [10/35] time 0.177 (0.171) data 0.099 (0.094) loss_u loss_u 0.9204 (0.9245) acc_u 6.2500 (9.3750) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [15/35] time 0.184 (0.173) data 0.107 (0.096) loss_u loss_u 0.9346 (0.9229) acc_u 12.5000 (9.7917) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [20/35] time 0.176 (0.174) data 0.100 (0.097) loss_u loss_u 0.9277 (0.9148) acc_u 6.2500 (10.6250) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [25/35] time 0.177 (0.174) data 0.100 (0.097) loss_u loss_u 0.8789 (0.9133) acc_u 15.6250 (10.8750) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [30/35] time 0.161 (0.173) data 0.083 (0.096) loss_u loss_u 0.9824 (0.9172) acc_u 3.1250 (10.3125) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [35/35] time 0.165 (0.173) data 0.088 (0.096) loss_u loss_u 0.9097 (0.9176) acc_u 9.3750 (10.4464) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 692
confident_label rate tensor(0.3020, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 488
clean true:485
clean false:3
clean_rate:0.9938524590163934
noisy true:439
noisy false:689
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1128
epoch [15/200] batch [5/15] time 0.165 (0.185) data 0.088 (0.108) loss_x loss_x 1.1943 (1.0247) acc_x 68.7500 (76.2500) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [10/15] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7583 (0.9702) acc_x 71.8750 (77.5000) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [15/15] time 0.173 (0.177) data 0.095 (0.100) loss_x loss_x 0.9971 (0.9623) acc_x 65.6250 (75.8333) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/35] time 0.162 (0.176) data 0.085 (0.099) loss_u loss_u 0.9414 (0.9221) acc_u 9.3750 (10.0000) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/35] time 0.163 (0.173) data 0.086 (0.096) loss_u loss_u 0.8906 (0.9138) acc_u 12.5000 (10.9375) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [15/35] time 0.185 (0.173) data 0.108 (0.095) loss_u loss_u 0.9106 (0.9156) acc_u 9.3750 (10.6250) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [20/35] time 0.184 (0.174) data 0.106 (0.097) loss_u loss_u 0.9487 (0.9187) acc_u 9.3750 (10.6250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [25/35] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.8750 (0.9168) acc_u 15.6250 (10.8750) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [30/35] time 0.184 (0.176) data 0.106 (0.099) loss_u loss_u 0.8955 (0.9166) acc_u 9.3750 (10.7292) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [35/35] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.9541 (0.9175) acc_u 3.1250 (10.5357) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 679
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:501
clean false:6
clean_rate:0.9881656804733728
noisy true:436
noisy false:673
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [16/200] batch [5/15] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.9663 (1.0042) acc_x 78.1250 (75.0000) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [10/15] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.8130 (0.9375) acc_x 81.2500 (75.3125) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [15/15] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 1.0322 (0.9212) acc_x 75.0000 (76.4583) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/34] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8745 (0.8988) acc_u 12.5000 (11.2500) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/34] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.9570 (0.9286) acc_u 3.1250 (7.8125) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [15/34] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9243 (0.9271) acc_u 12.5000 (8.1250) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [20/34] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.8433 (0.9272) acc_u 15.6250 (8.1250) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [25/34] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.9053 (0.9225) acc_u 12.5000 (8.7500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [30/34] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.9116 (0.9250) acc_u 9.3750 (8.4375) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 657
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 503
clean true:500
clean false:3
clean_rate:0.9940357852882704
noisy true:459
noisy false:654
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1113
epoch [17/200] batch [5/15] time 0.170 (0.171) data 0.093 (0.094) loss_x loss_x 0.9995 (0.8251) acc_x 71.8750 (76.8750) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [10/15] time 0.180 (0.176) data 0.104 (0.099) loss_x loss_x 1.0459 (0.8522) acc_x 71.8750 (77.1875) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [15/15] time 0.161 (0.174) data 0.084 (0.098) loss_x loss_x 0.3704 (0.8318) acc_x 93.7500 (78.9583) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/34] time 0.164 (0.175) data 0.087 (0.098) loss_u loss_u 0.9238 (0.9453) acc_u 6.2500 (5.6250) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/34] time 0.159 (0.172) data 0.082 (0.095) loss_u loss_u 0.9360 (0.9220) acc_u 6.2500 (9.0625) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [15/34] time 0.182 (0.173) data 0.106 (0.096) loss_u loss_u 0.9395 (0.9256) acc_u 9.3750 (8.9583) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [20/34] time 0.186 (0.175) data 0.108 (0.098) loss_u loss_u 0.9326 (0.9201) acc_u 12.5000 (9.5312) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [25/34] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.8784 (0.9148) acc_u 18.7500 (10.7500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [30/34] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.8921 (0.9136) acc_u 12.5000 (10.6250) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:496
clean false:5
clean_rate:0.9900199600798403
noisy true:446
noisy false:669
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [18/200] batch [5/15] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.9932 (1.0305) acc_x 65.6250 (73.1250) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [10/15] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.9897 (0.9261) acc_x 78.1250 (76.5625) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [15/15] time 0.189 (0.183) data 0.112 (0.107) loss_x loss_x 0.4800 (0.9025) acc_x 90.6250 (76.4583) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/34] time 0.173 (0.183) data 0.097 (0.106) loss_u loss_u 0.8706 (0.8997) acc_u 12.5000 (11.8750) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [10/34] time 0.188 (0.180) data 0.111 (0.103) loss_u loss_u 0.9033 (0.8909) acc_u 9.3750 (13.4375) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [15/34] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9351 (0.9022) acc_u 6.2500 (11.6667) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [20/34] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9531 (0.9084) acc_u 9.3750 (10.9375) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [25/34] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9175 (0.9057) acc_u 12.5000 (11.1250) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [30/34] time 0.185 (0.183) data 0.109 (0.106) loss_u loss_u 0.8921 (0.9092) acc_u 15.6250 (10.8333) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 644
confident_label rate tensor(0.3094, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 500
clean true:495
clean false:5
clean_rate:0.99
noisy true:477
noisy false:639
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1116
epoch [19/200] batch [5/15] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 1.3809 (1.1080) acc_x 71.8750 (73.7500) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/15] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 0.6069 (0.9362) acc_x 90.6250 (77.5000) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [15/15] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.9805 (0.9075) acc_x 75.0000 (77.5000) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/34] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.8931 (0.8980) acc_u 12.5000 (11.8750) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [10/34] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.7881 (0.8777) acc_u 25.0000 (14.3750) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [15/34] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.8940 (0.9021) acc_u 12.5000 (11.4583) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [20/34] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8730 (0.9121) acc_u 18.7500 (10.6250) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [25/34] time 0.187 (0.184) data 0.109 (0.107) loss_u loss_u 0.8809 (0.9077) acc_u 15.6250 (11.0000) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [30/34] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9131 (0.9087) acc_u 9.3750 (10.9375) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 653
confident_label rate tensor(0.3051, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 493
clean true:490
clean false:3
clean_rate:0.9939148073022313
noisy true:473
noisy false:650
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1123
epoch [20/200] batch [5/15] time 0.177 (0.177) data 0.100 (0.100) loss_x loss_x 0.3901 (0.7319) acc_x 87.5000 (80.0000) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [10/15] time 0.173 (0.177) data 0.096 (0.100) loss_x loss_x 1.1426 (0.8462) acc_x 68.7500 (77.5000) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [15/15] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.6641 (0.8124) acc_x 87.5000 (78.3333) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/35] time 0.184 (0.181) data 0.107 (0.103) loss_u loss_u 0.9316 (0.9300) acc_u 6.2500 (7.5000) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [10/35] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9834 (0.9341) acc_u 0.0000 (7.5000) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/35] time 0.192 (0.182) data 0.115 (0.105) loss_u loss_u 0.9639 (0.9322) acc_u 3.1250 (7.9167) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [20/35] time 0.161 (0.181) data 0.084 (0.104) loss_u loss_u 0.8682 (0.9270) acc_u 25.0000 (8.9062) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [25/35] time 0.172 (0.180) data 0.094 (0.103) loss_u loss_u 0.8926 (0.9174) acc_u 12.5000 (10.2500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [30/35] time 0.162 (0.179) data 0.084 (0.102) loss_u loss_u 0.8833 (0.9119) acc_u 12.5000 (10.7292) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [35/35] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.8638 (0.9086) acc_u 15.6250 (11.2500) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 655
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 502
clean true:501
clean false:1
clean_rate:0.99800796812749
noisy true:460
noisy false:654
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1114
epoch [21/200] batch [5/15] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 1.3516 (0.9110) acc_x 62.5000 (76.2500) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [10/15] time 0.177 (0.182) data 0.100 (0.106) loss_x loss_x 0.4890 (0.8816) acc_x 90.6250 (77.5000) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [15/15] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.8047 (0.8204) acc_x 75.0000 (78.3333) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/34] time 0.185 (0.182) data 0.107 (0.106) loss_u loss_u 0.8867 (0.9200) acc_u 18.7500 (10.0000) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [10/34] time 0.180 (0.183) data 0.103 (0.106) loss_u loss_u 0.8784 (0.9203) acc_u 15.6250 (9.6875) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [15/34] time 0.174 (0.182) data 0.096 (0.105) loss_u loss_u 0.9575 (0.9127) acc_u 3.1250 (10.2083) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/34] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9487 (0.9104) acc_u 6.2500 (10.7812) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [25/34] time 0.169 (0.180) data 0.091 (0.103) loss_u loss_u 0.9263 (0.9142) acc_u 6.2500 (10.0000) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [30/34] time 0.172 (0.181) data 0.096 (0.104) loss_u loss_u 0.8628 (0.9119) acc_u 21.8750 (10.7292) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 662
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 492
clean true:489
clean false:3
clean_rate:0.9939024390243902
noisy true:465
noisy false:659
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1124
epoch [22/200] batch [5/15] time 0.183 (0.180) data 0.107 (0.103) loss_x loss_x 0.8833 (0.9059) acc_x 78.1250 (81.8750) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [10/15] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.7729 (0.7512) acc_x 87.5000 (84.3750) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [15/15] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.7363 (0.8129) acc_x 78.1250 (80.8333) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/35] time 0.172 (0.181) data 0.095 (0.104) loss_u loss_u 0.8569 (0.9260) acc_u 15.6250 (7.5000) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [10/35] time 0.188 (0.179) data 0.111 (0.102) loss_u loss_u 0.9434 (0.9054) acc_u 6.2500 (10.6250) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [15/35] time 0.165 (0.178) data 0.087 (0.101) loss_u loss_u 0.9751 (0.9103) acc_u 6.2500 (10.6250) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [20/35] time 0.181 (0.178) data 0.105 (0.101) loss_u loss_u 0.8994 (0.9090) acc_u 12.5000 (11.0938) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [25/35] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.9067 (0.9080) acc_u 9.3750 (11.0000) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [30/35] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.8569 (0.9036) acc_u 15.6250 (11.4583) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [35/35] time 0.168 (0.177) data 0.092 (0.100) loss_u loss_u 0.8848 (0.9013) acc_u 15.6250 (11.7857) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 694
confident_label rate tensor(0.2964, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 479
clean true:474
clean false:5
clean_rate:0.9895615866388309
noisy true:448
noisy false:689
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1137
epoch [23/200] batch [5/14] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.8755 (0.7712) acc_x 75.0000 (81.2500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/14] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.5054 (0.8294) acc_x 90.6250 (79.3750) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/35] time 0.172 (0.181) data 0.093 (0.104) loss_u loss_u 0.9209 (0.8859) acc_u 12.5000 (15.0000) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [10/35] time 0.177 (0.180) data 0.099 (0.103) loss_u loss_u 0.9395 (0.8779) acc_u 12.5000 (15.3125) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [15/35] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.8936 (0.8858) acc_u 9.3750 (13.9583) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/35] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9663 (0.8945) acc_u 6.2500 (13.2812) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [25/35] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.9268 (0.8956) acc_u 6.2500 (12.7500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [30/35] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.9751 (0.9008) acc_u 3.1250 (12.2917) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [35/35] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.7837 (0.9001) acc_u 21.8750 (12.2321) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 502
clean true:496
clean false:6
clean_rate:0.9880478087649402
noisy true:481
noisy false:633
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1114
epoch [24/200] batch [5/15] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 1.1250 (0.8129) acc_x 65.6250 (76.2500) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [10/15] time 0.180 (0.184) data 0.104 (0.107) loss_x loss_x 1.1299 (0.8909) acc_x 75.0000 (77.1875) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [15/15] time 0.220 (0.186) data 0.143 (0.109) loss_x loss_x 0.8936 (0.8902) acc_x 78.1250 (77.7083) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/34] time 0.181 (0.185) data 0.105 (0.108) loss_u loss_u 0.9297 (0.9146) acc_u 9.3750 (9.3750) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/34] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.8896 (0.8986) acc_u 12.5000 (11.5625) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [15/34] time 0.182 (0.185) data 0.104 (0.108) loss_u loss_u 0.8999 (0.8997) acc_u 15.6250 (11.4583) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [20/34] time 0.163 (0.184) data 0.086 (0.107) loss_u loss_u 0.9644 (0.9073) acc_u 3.1250 (10.3125) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [25/34] time 0.188 (0.184) data 0.111 (0.107) loss_u loss_u 0.9492 (0.9115) acc_u 6.2500 (10.2500) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [30/34] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9268 (0.9065) acc_u 9.3750 (10.9375) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 642
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 541
clean true:537
clean false:4
clean_rate:0.9926062846580407
noisy true:437
noisy false:638
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1075
epoch [25/200] batch [5/16] time 0.171 (0.183) data 0.094 (0.107) loss_x loss_x 0.4275 (0.6456) acc_x 90.6250 (81.2500) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/16] time 0.173 (0.178) data 0.096 (0.102) loss_x loss_x 1.0654 (0.7989) acc_x 71.8750 (77.5000) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [15/16] time 0.172 (0.176) data 0.095 (0.099) loss_x loss_x 0.4160 (0.7619) acc_x 84.3750 (78.3333) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/33] time 0.174 (0.176) data 0.097 (0.099) loss_u loss_u 0.9863 (0.9275) acc_u 0.0000 (6.8750) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [10/33] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9561 (0.9170) acc_u 6.2500 (9.0625) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [15/33] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9033 (0.9145) acc_u 9.3750 (9.1667) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [20/33] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.9399 (0.9240) acc_u 9.3750 (8.2812) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [25/33] time 0.180 (0.179) data 0.102 (0.102) loss_u loss_u 0.9287 (0.9259) acc_u 9.3750 (7.8750) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [30/33] time 0.178 (0.179) data 0.100 (0.102) loss_u loss_u 0.9829 (0.9281) acc_u 0.0000 (8.0208) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 666
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 502
clean true:497
clean false:5
clean_rate:0.9900398406374502
noisy true:453
noisy false:661
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1114
epoch [26/200] batch [5/15] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 1.0645 (0.8304) acc_x 75.0000 (78.7500) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/15] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 1.0752 (0.8480) acc_x 68.7500 (78.7500) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [15/15] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.5747 (0.8259) acc_x 87.5000 (79.5833) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/34] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.8369 (0.8932) acc_u 21.8750 (12.5000) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [10/34] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.8257 (0.8919) acc_u 25.0000 (13.7500) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [15/34] time 0.181 (0.183) data 0.103 (0.106) loss_u loss_u 0.9023 (0.8983) acc_u 9.3750 (12.0833) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [20/34] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9434 (0.9025) acc_u 6.2500 (11.4062) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [25/34] time 0.176 (0.183) data 0.099 (0.106) loss_u loss_u 0.9268 (0.9070) acc_u 6.2500 (10.8750) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [30/34] time 0.178 (0.181) data 0.100 (0.104) loss_u loss_u 0.9082 (0.9044) acc_u 9.3750 (11.0417) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 644
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:504
clean false:7
clean_rate:0.9863013698630136
noisy true:468
noisy false:637
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [27/200] batch [5/15] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 1.5137 (0.7325) acc_x 71.8750 (82.5000) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [10/15] time 0.172 (0.182) data 0.096 (0.105) loss_x loss_x 0.9678 (0.7978) acc_x 71.8750 (80.9375) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [15/15] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.7998 (0.8609) acc_x 81.2500 (79.3750) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/34] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.9209 (0.9163) acc_u 9.3750 (8.7500) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [10/34] time 0.188 (0.181) data 0.111 (0.104) loss_u loss_u 0.9146 (0.9101) acc_u 12.5000 (9.6875) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/34] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8672 (0.9129) acc_u 15.6250 (10.0000) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [20/34] time 0.168 (0.182) data 0.091 (0.105) loss_u loss_u 0.8872 (0.9121) acc_u 12.5000 (10.0000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [25/34] time 0.163 (0.180) data 0.085 (0.103) loss_u loss_u 0.8320 (0.9119) acc_u 18.7500 (10.0000) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [30/34] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.8638 (0.9022) acc_u 12.5000 (11.2500) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:519
clean false:3
clean_rate:0.9942528735632183
noisy true:469
noisy false:625
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [28/200] batch [5/16] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.8418 (0.7438) acc_x 71.8750 (78.1250) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/16] time 0.165 (0.181) data 0.088 (0.104) loss_x loss_x 0.9121 (0.7785) acc_x 75.0000 (78.4375) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/16] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.6680 (0.7879) acc_x 84.3750 (78.9583) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/34] time 0.191 (0.181) data 0.113 (0.104) loss_u loss_u 0.8560 (0.9178) acc_u 15.6250 (9.3750) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [10/34] time 0.182 (0.181) data 0.106 (0.105) loss_u loss_u 0.9136 (0.9156) acc_u 15.6250 (10.6250) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [15/34] time 0.184 (0.181) data 0.107 (0.105) loss_u loss_u 0.9268 (0.9248) acc_u 12.5000 (10.0000) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [20/34] time 0.182 (0.181) data 0.106 (0.104) loss_u loss_u 0.8433 (0.9146) acc_u 21.8750 (10.7812) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [25/34] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.9697 (0.9090) acc_u 3.1250 (11.2500) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [30/34] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9199 (0.9102) acc_u 9.3750 (11.1458) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 679
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 509
clean true:502
clean false:7
clean_rate:0.9862475442043221
noisy true:435
noisy false:672
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1107
epoch [29/200] batch [5/15] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.7686 (0.9573) acc_x 87.5000 (76.8750) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/15] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.7578 (0.9507) acc_x 75.0000 (76.8750) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [15/15] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 1.2119 (0.9935) acc_x 71.8750 (75.8333) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/34] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9443 (0.8994) acc_u 6.2500 (13.1250) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [10/34] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.9243 (0.8995) acc_u 6.2500 (12.1875) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [15/34] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8408 (0.8944) acc_u 15.6250 (12.9167) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [20/34] time 0.181 (0.180) data 0.105 (0.103) loss_u loss_u 0.9014 (0.8986) acc_u 15.6250 (12.1875) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [25/34] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8623 (0.9022) acc_u 12.5000 (11.7500) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [30/34] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9038 (0.9019) acc_u 9.3750 (11.4583) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 664
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 492
clean true:489
clean false:3
clean_rate:0.9939024390243902
noisy true:463
noisy false:661
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1124
epoch [30/200] batch [5/15] time 0.160 (0.161) data 0.083 (0.084) loss_x loss_x 0.8682 (0.7931) acc_x 75.0000 (75.0000) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [10/15] time 0.189 (0.169) data 0.112 (0.092) loss_x loss_x 1.0986 (0.8277) acc_x 75.0000 (75.3125) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [15/15] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.8623 (0.8261) acc_x 75.0000 (75.6250) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/35] time 0.191 (0.177) data 0.113 (0.100) loss_u loss_u 0.9531 (0.9111) acc_u 3.1250 (9.3750) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/35] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.9360 (0.9033) acc_u 3.1250 (10.6250) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/35] time 0.166 (0.174) data 0.087 (0.097) loss_u loss_u 0.8857 (0.9018) acc_u 12.5000 (10.8333) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [20/35] time 0.160 (0.173) data 0.082 (0.096) loss_u loss_u 0.8979 (0.8952) acc_u 9.3750 (11.8750) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [25/35] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.9722 (0.8942) acc_u 3.1250 (12.0000) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [30/35] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.8633 (0.8973) acc_u 15.6250 (11.6667) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [35/35] time 0.185 (0.176) data 0.108 (0.098) loss_u loss_u 0.9194 (0.8941) acc_u 12.5000 (12.3214) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 630
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 541
clean true:537
clean false:4
clean_rate:0.9926062846580407
noisy true:449
noisy false:626
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1075
epoch [31/200] batch [5/16] time 0.181 (0.178) data 0.104 (0.102) loss_x loss_x 0.8291 (0.7232) acc_x 75.0000 (78.7500) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [10/16] time 0.163 (0.174) data 0.085 (0.097) loss_x loss_x 0.7070 (0.7398) acc_x 87.5000 (79.0625) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/16] time 0.169 (0.171) data 0.092 (0.094) loss_x loss_x 1.4688 (0.7900) acc_x 62.5000 (78.7500) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/33] time 0.174 (0.171) data 0.096 (0.093) loss_u loss_u 0.8613 (0.9051) acc_u 18.7500 (11.8750) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/33] time 0.174 (0.172) data 0.096 (0.094) loss_u loss_u 0.9336 (0.9173) acc_u 9.3750 (10.0000) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/33] time 0.184 (0.173) data 0.106 (0.096) loss_u loss_u 0.8955 (0.9189) acc_u 18.7500 (10.2083) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [20/33] time 0.182 (0.175) data 0.105 (0.097) loss_u loss_u 0.9531 (0.9273) acc_u 6.2500 (8.9062) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [25/33] time 0.183 (0.176) data 0.106 (0.098) loss_u loss_u 0.9160 (0.9226) acc_u 12.5000 (9.5000) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [30/33] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.8848 (0.9224) acc_u 12.5000 (9.3750) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 537
clean true:532
clean false:5
clean_rate:0.9906890130353817
noisy true:460
noisy false:619
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1079
epoch [32/200] batch [5/16] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 1.1777 (0.7626) acc_x 84.3750 (81.8750) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [10/16] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.8564 (0.7523) acc_x 71.8750 (82.8125) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/16] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.6694 (0.7655) acc_x 84.3750 (81.8750) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/33] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9863 (0.9243) acc_u 0.0000 (8.7500) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [10/33] time 0.184 (0.181) data 0.107 (0.105) loss_u loss_u 0.8989 (0.9018) acc_u 12.5000 (11.2500) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/33] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9175 (0.9142) acc_u 12.5000 (10.0000) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [20/33] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.9312 (0.9176) acc_u 12.5000 (9.6875) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [25/33] time 0.211 (0.183) data 0.133 (0.106) loss_u loss_u 0.8955 (0.9151) acc_u 12.5000 (9.8750) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [30/33] time 0.184 (0.183) data 0.108 (0.106) loss_u loss_u 0.9023 (0.9129) acc_u 6.2500 (10.2083) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 520
clean true:515
clean false:5
clean_rate:0.9903846153846154
noisy true:483
noisy false:613
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1096
epoch [33/200] batch [5/16] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.7549 (0.7712) acc_x 81.2500 (79.3750) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/16] time 0.159 (0.182) data 0.082 (0.105) loss_x loss_x 0.6763 (0.7303) acc_x 75.0000 (80.3125) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/16] time 0.158 (0.177) data 0.081 (0.101) loss_x loss_x 0.7349 (0.7580) acc_x 65.6250 (78.5417) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/34] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.9097 (0.9269) acc_u 9.3750 (10.0000) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/34] time 0.159 (0.175) data 0.081 (0.099) loss_u loss_u 0.9048 (0.9196) acc_u 9.3750 (10.6250) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [15/34] time 0.183 (0.177) data 0.107 (0.100) loss_u loss_u 0.8931 (0.9039) acc_u 18.7500 (12.9167) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [20/34] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.8506 (0.9006) acc_u 15.6250 (12.9688) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [25/34] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.8843 (0.9060) acc_u 9.3750 (12.0000) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [30/34] time 0.192 (0.180) data 0.115 (0.103) loss_u loss_u 0.9351 (0.9085) acc_u 6.2500 (11.5625) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 635
confident_label rate tensor(0.3342, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 540
clean true:533
clean false:7
clean_rate:0.987037037037037
noisy true:448
noisy false:628
after delete: len(clean_dataset) 540
after delete: len(noisy_dataset) 1076
epoch [34/200] batch [5/16] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.7744 (0.8086) acc_x 71.8750 (76.8750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/16] time 0.178 (0.182) data 0.100 (0.105) loss_x loss_x 0.5518 (0.7532) acc_x 87.5000 (79.0625) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/16] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.6445 (0.7092) acc_x 71.8750 (80.6250) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/33] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9062 (0.8911) acc_u 9.3750 (13.7500) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [10/33] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8970 (0.9120) acc_u 12.5000 (10.0000) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/33] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9346 (0.8989) acc_u 9.3750 (12.5000) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/33] time 0.185 (0.183) data 0.107 (0.105) loss_u loss_u 0.9849 (0.9072) acc_u 0.0000 (11.4062) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [25/33] time 0.182 (0.182) data 0.106 (0.105) loss_u loss_u 0.9424 (0.9079) acc_u 6.2500 (11.1250) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [30/33] time 0.171 (0.182) data 0.095 (0.105) loss_u loss_u 0.7822 (0.8972) acc_u 28.1250 (12.3958) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.3354, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 542
clean true:536
clean false:6
clean_rate:0.988929889298893
noisy true:467
noisy false:607
after delete: len(clean_dataset) 542
after delete: len(noisy_dataset) 1074
epoch [35/200] batch [5/16] time 0.187 (0.183) data 0.109 (0.106) loss_x loss_x 0.5571 (0.6286) acc_x 84.3750 (84.3750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/16] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8589 (0.7222) acc_x 71.8750 (82.5000) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/16] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.9434 (0.7949) acc_x 81.2500 (81.2500) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/33] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9502 (0.9004) acc_u 9.3750 (11.2500) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [10/33] time 0.184 (0.184) data 0.106 (0.106) loss_u loss_u 0.9253 (0.8999) acc_u 6.2500 (11.5625) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/33] time 0.176 (0.184) data 0.098 (0.106) loss_u loss_u 0.8550 (0.8996) acc_u 18.7500 (12.0833) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [20/33] time 0.183 (0.184) data 0.106 (0.106) loss_u loss_u 0.9062 (0.9080) acc_u 12.5000 (11.2500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [25/33] time 0.183 (0.184) data 0.106 (0.106) loss_u loss_u 0.9038 (0.9104) acc_u 9.3750 (11.0000) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [30/33] time 0.183 (0.184) data 0.106 (0.106) loss_u loss_u 0.8638 (0.9118) acc_u 15.6250 (10.8333) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.3286, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 531
clean true:528
clean false:3
clean_rate:0.9943502824858758
noisy true:460
noisy false:625
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1085
epoch [36/200] batch [5/16] time 0.182 (0.183) data 0.105 (0.107) loss_x loss_x 0.6890 (0.7045) acc_x 84.3750 (81.8750) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/16] time 0.172 (0.179) data 0.094 (0.103) loss_x loss_x 0.4851 (0.7504) acc_x 84.3750 (80.6250) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/16] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.9814 (0.8072) acc_x 75.0000 (79.5833) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/33] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8774 (0.8952) acc_u 12.5000 (10.6250) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/33] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9463 (0.9125) acc_u 6.2500 (9.3750) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/33] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8706 (0.9146) acc_u 18.7500 (10.4167) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [20/33] time 0.172 (0.182) data 0.096 (0.105) loss_u loss_u 0.9170 (0.9134) acc_u 12.5000 (10.7812) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [25/33] time 0.169 (0.181) data 0.092 (0.104) loss_u loss_u 0.9053 (0.9097) acc_u 12.5000 (11.1250) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [30/33] time 0.170 (0.180) data 0.093 (0.103) loss_u loss_u 0.9165 (0.9081) acc_u 9.3750 (11.1458) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.3403, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 550
clean true:545
clean false:5
clean_rate:0.990909090909091
noisy true:458
noisy false:608
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1066
epoch [37/200] batch [5/17] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.8213 (0.7628) acc_x 75.0000 (81.8750) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/17] time 0.168 (0.181) data 0.090 (0.104) loss_x loss_x 1.3945 (0.8381) acc_x 71.8750 (77.1875) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/17] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.6377 (0.8133) acc_x 81.2500 (78.3333) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/33] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.9331 (0.9179) acc_u 6.2500 (10.0000) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [10/33] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9810 (0.9260) acc_u 0.0000 (8.4375) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/33] time 0.181 (0.182) data 0.105 (0.105) loss_u loss_u 0.9380 (0.9243) acc_u 9.3750 (8.5417) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [20/33] time 0.167 (0.181) data 0.090 (0.104) loss_u loss_u 0.8315 (0.9141) acc_u 15.6250 (9.6875) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [25/33] time 0.187 (0.181) data 0.108 (0.104) loss_u loss_u 0.9019 (0.9173) acc_u 12.5000 (9.6250) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [30/33] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.9463 (0.9180) acc_u 6.2500 (9.5833) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 603
confident_label rate tensor(0.3397, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 549
clean true:545
clean false:4
clean_rate:0.9927140255009107
noisy true:468
noisy false:599
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1067
epoch [38/200] batch [5/17] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.9448 (0.8249) acc_x 71.8750 (78.7500) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/17] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.9702 (0.8179) acc_x 68.7500 (77.5000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/17] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.9819 (0.8275) acc_x 75.0000 (77.5000) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/33] time 0.181 (0.181) data 0.104 (0.105) loss_u loss_u 0.8589 (0.8990) acc_u 18.7500 (11.2500) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [10/33] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9062 (0.8894) acc_u 12.5000 (12.5000) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/33] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8774 (0.8870) acc_u 12.5000 (12.9167) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [20/33] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.8735 (0.8925) acc_u 15.6250 (12.1875) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [25/33] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9175 (0.8971) acc_u 9.3750 (11.7500) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [30/33] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9277 (0.9057) acc_u 12.5000 (10.9375) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 617
confident_label rate tensor(0.3329, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 538
clean true:530
clean false:8
clean_rate:0.9851301115241635
noisy true:469
noisy false:609
after delete: len(clean_dataset) 538
after delete: len(noisy_dataset) 1078
epoch [39/200] batch [5/16] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.8267 (0.7124) acc_x 71.8750 (80.6250) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [10/16] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.6089 (0.8523) acc_x 81.2500 (76.5625) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/16] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.5439 (0.8658) acc_x 84.3750 (77.0833) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/33] time 0.179 (0.182) data 0.101 (0.105) loss_u loss_u 0.9492 (0.9097) acc_u 3.1250 (10.0000) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [10/33] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.9160 (0.9194) acc_u 9.3750 (8.7500) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/33] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9824 (0.9104) acc_u 0.0000 (9.7917) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [20/33] time 0.189 (0.181) data 0.112 (0.104) loss_u loss_u 0.9102 (0.9119) acc_u 9.3750 (9.5312) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [25/33] time 0.171 (0.180) data 0.092 (0.102) loss_u loss_u 0.8989 (0.9055) acc_u 12.5000 (10.5000) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [30/33] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.8823 (0.9074) acc_u 15.6250 (10.4167) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 621
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 537
clean true:532
clean false:5
clean_rate:0.9906890130353817
noisy true:463
noisy false:616
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1079
epoch [40/200] batch [5/16] time 0.183 (0.200) data 0.106 (0.123) loss_x loss_x 0.6304 (0.7554) acc_x 84.3750 (82.5000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/16] time 0.182 (0.192) data 0.105 (0.115) loss_x loss_x 1.2393 (0.8159) acc_x 59.3750 (80.3125) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/16] time 0.181 (0.188) data 0.104 (0.111) loss_x loss_x 1.0234 (0.8165) acc_x 75.0000 (80.0000) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/33] time 0.157 (0.186) data 0.080 (0.109) loss_u loss_u 0.9155 (0.9121) acc_u 9.3750 (9.3750) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [10/33] time 0.183 (0.185) data 0.107 (0.108) loss_u loss_u 0.8784 (0.8979) acc_u 15.6250 (10.9375) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/33] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.9346 (0.9013) acc_u 6.2500 (10.8333) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/33] time 0.180 (0.185) data 0.102 (0.107) loss_u loss_u 0.9414 (0.9082) acc_u 3.1250 (10.0000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [25/33] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9468 (0.9103) acc_u 3.1250 (9.7500) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [30/33] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9233 (0.9110) acc_u 6.2500 (9.8958) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 627
confident_label rate tensor(0.3292, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 532
clean true:525
clean false:7
clean_rate:0.9868421052631579
noisy true:464
noisy false:620
after delete: len(clean_dataset) 532
after delete: len(noisy_dataset) 1084
epoch [41/200] batch [5/16] time 0.172 (0.176) data 0.094 (0.099) loss_x loss_x 1.4580 (1.0358) acc_x 65.6250 (75.0000) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [10/16] time 0.188 (0.181) data 0.112 (0.104) loss_x loss_x 0.5586 (0.8664) acc_x 84.3750 (78.4375) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/16] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 1.0947 (0.8513) acc_x 62.5000 (77.9167) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/33] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.8140 (0.8960) acc_u 21.8750 (13.1250) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [10/33] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9033 (0.9060) acc_u 9.3750 (11.2500) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/33] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.8535 (0.9053) acc_u 15.6250 (11.2500) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [20/33] time 0.162 (0.181) data 0.085 (0.104) loss_u loss_u 0.8677 (0.8998) acc_u 12.5000 (12.0312) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [25/33] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9351 (0.9028) acc_u 9.3750 (11.6250) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [30/33] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9019 (0.8999) acc_u 12.5000 (11.9792) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.3379, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 546
clean true:539
clean false:7
clean_rate:0.9871794871794872
noisy true:454
noisy false:616
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 1070
epoch [42/200] batch [5/17] time 0.176 (0.175) data 0.100 (0.098) loss_x loss_x 0.7935 (1.0723) acc_x 84.3750 (72.5000) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/17] time 0.160 (0.175) data 0.084 (0.098) loss_x loss_x 0.6011 (0.8461) acc_x 87.5000 (77.8125) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/17] time 0.183 (0.177) data 0.106 (0.101) loss_x loss_x 1.2773 (0.8087) acc_x 71.8750 (78.9583) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/33] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.9517 (0.9417) acc_u 3.1250 (6.2500) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [10/33] time 0.183 (0.177) data 0.106 (0.101) loss_u loss_u 0.8901 (0.9238) acc_u 12.5000 (8.4375) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [15/33] time 0.169 (0.176) data 0.091 (0.100) loss_u loss_u 0.8403 (0.9201) acc_u 18.7500 (9.1667) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [20/33] time 0.184 (0.177) data 0.108 (0.101) loss_u loss_u 0.8467 (0.9126) acc_u 15.6250 (10.3125) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [25/33] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.8276 (0.9081) acc_u 18.7500 (10.7500) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [30/33] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8169 (0.9055) acc_u 21.8750 (11.2500) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:543
clean false:5
clean_rate:0.9908759124087592
noisy true:487
noisy false:581
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [43/200] batch [5/17] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.8745 (0.7826) acc_x 81.2500 (75.6250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/17] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 1.0869 (0.8109) acc_x 78.1250 (77.1875) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/17] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.9902 (0.7542) acc_x 81.2500 (79.1667) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/33] time 0.182 (0.182) data 0.106 (0.105) loss_u loss_u 0.8770 (0.9190) acc_u 12.5000 (10.0000) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/33] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.9243 (0.9177) acc_u 6.2500 (9.3750) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [15/33] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.8950 (0.9143) acc_u 12.5000 (10.2083) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/33] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.9292 (0.9158) acc_u 9.3750 (9.8438) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [25/33] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.9399 (0.9208) acc_u 6.2500 (9.2500) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [30/33] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.9233 (0.9155) acc_u 9.3750 (10.0000) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 580
confident_label rate tensor(0.3478, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 562
clean true:559
clean false:3
clean_rate:0.994661921708185
noisy true:477
noisy false:577
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1054
epoch [44/200] batch [5/17] time 0.169 (0.180) data 0.092 (0.104) loss_x loss_x 0.9160 (0.6515) acc_x 81.2500 (85.0000) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/17] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.7153 (0.6926) acc_x 81.2500 (83.7500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/17] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 1.0273 (0.7451) acc_x 68.7500 (81.0417) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/32] time 0.178 (0.181) data 0.102 (0.104) loss_u loss_u 0.8296 (0.9087) acc_u 18.7500 (11.2500) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [10/32] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9092 (0.9072) acc_u 12.5000 (11.5625) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [15/32] time 0.169 (0.180) data 0.092 (0.103) loss_u loss_u 0.9580 (0.9133) acc_u 6.2500 (10.2083) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/32] time 0.181 (0.180) data 0.103 (0.103) loss_u loss_u 0.9380 (0.9155) acc_u 6.2500 (10.1562) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [25/32] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.9087 (0.9109) acc_u 12.5000 (10.6250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [30/32] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9619 (0.9172) acc_u 3.1250 (9.6875) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3459, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 559
clean true:551
clean false:8
clean_rate:0.9856887298747764
noisy true:477
noisy false:580
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 1057
epoch [45/200] batch [5/17] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.8643 (0.7346) acc_x 81.2500 (78.7500) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/17] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.3572 (0.6385) acc_x 90.6250 (81.5625) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/17] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.6030 (0.6339) acc_x 78.1250 (81.6667) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/33] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9341 (0.9232) acc_u 9.3750 (9.3750) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [10/33] time 0.171 (0.182) data 0.095 (0.105) loss_u loss_u 0.9722 (0.9207) acc_u 3.1250 (9.6875) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/33] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8750 (0.9101) acc_u 12.5000 (10.6250) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/33] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.8955 (0.9069) acc_u 9.3750 (11.0938) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [25/33] time 0.171 (0.182) data 0.094 (0.104) loss_u loss_u 0.9927 (0.9094) acc_u 0.0000 (11.0000) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [30/33] time 0.171 (0.180) data 0.094 (0.103) loss_u loss_u 0.8325 (0.9104) acc_u 18.7500 (10.7292) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 608
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 537
clean true:529
clean false:8
clean_rate:0.9851024208566108
noisy true:479
noisy false:600
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1079
epoch [46/200] batch [5/16] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 1.2080 (0.9814) acc_x 68.7500 (75.6250) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/16] time 0.183 (0.180) data 0.107 (0.103) loss_x loss_x 0.5156 (0.8231) acc_x 90.6250 (79.6875) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/16] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.7441 (0.7971) acc_x 78.1250 (79.7917) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/33] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.8682 (0.9099) acc_u 12.5000 (9.3750) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/33] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8794 (0.9115) acc_u 9.3750 (9.0625) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/33] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9443 (0.9095) acc_u 6.2500 (9.5833) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/33] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8208 (0.9094) acc_u 21.8750 (10.3125) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [25/33] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9150 (0.9044) acc_u 12.5000 (11.2500) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [30/33] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.8774 (0.9055) acc_u 18.7500 (11.0417) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.3329, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 538
clean true:533
clean false:5
clean_rate:0.9907063197026023
noisy true:465
noisy false:613
after delete: len(clean_dataset) 538
after delete: len(noisy_dataset) 1078
epoch [47/200] batch [5/16] time 0.180 (0.186) data 0.104 (0.109) loss_x loss_x 1.1377 (0.8812) acc_x 68.7500 (78.7500) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/16] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.4468 (0.8259) acc_x 90.6250 (80.0000) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/16] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.5977 (0.8110) acc_x 87.5000 (81.0417) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/33] time 0.170 (0.179) data 0.092 (0.102) loss_u loss_u 0.7974 (0.8977) acc_u 28.1250 (13.7500) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/33] time 0.181 (0.180) data 0.103 (0.103) loss_u loss_u 0.9204 (0.9133) acc_u 9.3750 (11.8750) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [15/33] time 0.176 (0.179) data 0.098 (0.102) loss_u loss_u 0.8574 (0.9112) acc_u 18.7500 (12.0833) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/33] time 0.172 (0.178) data 0.094 (0.100) loss_u loss_u 0.8711 (0.8992) acc_u 12.5000 (12.5000) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [25/33] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.9541 (0.9020) acc_u 3.1250 (11.7500) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [30/33] time 0.195 (0.179) data 0.118 (0.102) loss_u loss_u 0.9048 (0.9014) acc_u 9.3750 (11.7708) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 574
confident_label rate tensor(0.3447, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 557
clean true:552
clean false:5
clean_rate:0.9910233393177738
noisy true:490
noisy false:569
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1059
epoch [48/200] batch [5/17] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.8940 (0.7774) acc_x 81.2500 (80.0000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/17] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.9868 (0.7881) acc_x 71.8750 (80.0000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/17] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.8628 (0.7190) acc_x 75.0000 (81.6667) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/33] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8735 (0.9132) acc_u 15.6250 (12.5000) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [10/33] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.9141 (0.9297) acc_u 12.5000 (9.6875) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/33] time 0.189 (0.184) data 0.111 (0.107) loss_u loss_u 0.9536 (0.9267) acc_u 6.2500 (9.5833) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [20/33] time 0.190 (0.185) data 0.113 (0.107) loss_u loss_u 0.9492 (0.9204) acc_u 6.2500 (9.6875) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [25/33] time 0.167 (0.184) data 0.091 (0.106) loss_u loss_u 0.9282 (0.9169) acc_u 6.2500 (10.2500) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [30/33] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8159 (0.9119) acc_u 21.8750 (10.9375) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.3397, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 549
clean true:543
clean false:6
clean_rate:0.9890710382513661
noisy true:450
noisy false:617
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1067
epoch [49/200] batch [5/17] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.4407 (0.8531) acc_x 90.6250 (77.5000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/17] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.4966 (0.6944) acc_x 84.3750 (81.2500) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/17] time 0.183 (0.182) data 0.105 (0.105) loss_x loss_x 0.4412 (0.6949) acc_x 87.5000 (81.6667) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/33] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.8726 (0.8984) acc_u 12.5000 (10.6250) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/33] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.8442 (0.8948) acc_u 18.7500 (12.1875) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/33] time 0.193 (0.182) data 0.115 (0.105) loss_u loss_u 0.9277 (0.9050) acc_u 6.2500 (10.4167) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/33] time 0.180 (0.183) data 0.104 (0.106) loss_u loss_u 0.8662 (0.9053) acc_u 15.6250 (10.3125) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [25/33] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.9209 (0.9061) acc_u 12.5000 (10.5000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/33] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.9111 (0.9081) acc_u 9.3750 (10.2083) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 612
confident_label rate tensor(0.3403, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 550
clean true:542
clean false:8
clean_rate:0.9854545454545455
noisy true:462
noisy false:604
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1066
epoch [50/200] batch [5/17] time 0.170 (0.183) data 0.093 (0.107) loss_x loss_x 0.5239 (0.6782) acc_x 87.5000 (81.2500) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/17] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.4631 (0.6617) acc_x 87.5000 (81.8750) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/17] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 1.3428 (0.7137) acc_x 68.7500 (80.0000) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/33] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.8604 (0.8937) acc_u 15.6250 (11.8750) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/33] time 0.174 (0.184) data 0.096 (0.107) loss_u loss_u 0.7920 (0.8938) acc_u 25.0000 (12.5000) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/33] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8574 (0.8937) acc_u 18.7500 (12.5000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/33] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9888 (0.9026) acc_u 0.0000 (11.2500) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [25/33] time 0.181 (0.185) data 0.104 (0.108) loss_u loss_u 0.9429 (0.9089) acc_u 9.3750 (10.6250) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/33] time 0.171 (0.183) data 0.094 (0.106) loss_u loss_u 0.8994 (0.9044) acc_u 12.5000 (11.0417) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 607
confident_label rate tensor(0.3453, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 558
clean true:549
clean false:9
clean_rate:0.9838709677419355
noisy true:460
noisy false:598
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1058
epoch [51/200] batch [5/17] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 1.2178 (1.1008) acc_x 75.0000 (75.6250) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/17] time 0.183 (0.183) data 0.105 (0.106) loss_x loss_x 0.8662 (1.0742) acc_x 78.1250 (75.9375) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/17] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.7070 (0.9609) acc_x 75.0000 (77.9167) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/33] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9648 (0.8987) acc_u 3.1250 (11.2500) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/33] time 0.184 (0.183) data 0.107 (0.105) loss_u loss_u 0.8560 (0.9048) acc_u 21.8750 (11.8750) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [15/33] time 0.204 (0.183) data 0.127 (0.106) loss_u loss_u 0.9702 (0.9049) acc_u 3.1250 (11.4583) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/33] time 0.180 (0.183) data 0.102 (0.106) loss_u loss_u 0.9893 (0.9104) acc_u 0.0000 (10.4688) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [25/33] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8594 (0.9127) acc_u 15.6250 (10.1250) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [30/33] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9048 (0.9116) acc_u 9.3750 (10.1042) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 554
clean true:545
clean false:9
clean_rate:0.983754512635379
noisy true:443
noisy false:619
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1062
epoch [52/200] batch [5/17] time 0.182 (0.178) data 0.104 (0.101) loss_x loss_x 1.1055 (1.0434) acc_x 81.2500 (71.8750) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/17] time 0.159 (0.172) data 0.082 (0.095) loss_x loss_x 0.3708 (0.8253) acc_x 93.7500 (78.4375) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/17] time 0.185 (0.171) data 0.108 (0.094) loss_x loss_x 0.5615 (0.7508) acc_x 87.5000 (80.2083) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/33] time 0.165 (0.175) data 0.088 (0.098) loss_u loss_u 0.9551 (0.9396) acc_u 3.1250 (8.1250) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/33] time 0.168 (0.174) data 0.090 (0.097) loss_u loss_u 0.9097 (0.9091) acc_u 12.5000 (11.2500) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/33] time 0.229 (0.178) data 0.152 (0.100) loss_u loss_u 0.8882 (0.9059) acc_u 12.5000 (11.2500) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/33] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.8789 (0.9033) acc_u 15.6250 (11.4062) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [25/33] time 0.178 (0.178) data 0.100 (0.101) loss_u loss_u 0.9165 (0.9060) acc_u 12.5000 (11.6250) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [30/33] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9175 (0.9040) acc_u 9.3750 (11.7708) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.3490, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 564
clean true:558
clean false:6
clean_rate:0.9893617021276596
noisy true:476
noisy false:576
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1052
epoch [53/200] batch [5/17] time 0.184 (0.178) data 0.108 (0.102) loss_x loss_x 1.1826 (0.7834) acc_x 71.8750 (80.0000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/17] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 1.0527 (0.7579) acc_x 78.1250 (79.0625) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/17] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.8018 (0.7873) acc_x 81.2500 (78.7500) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/32] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.9541 (0.9007) acc_u 9.3750 (12.5000) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/32] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9438 (0.9085) acc_u 9.3750 (10.9375) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/32] time 0.188 (0.183) data 0.110 (0.105) loss_u loss_u 0.8804 (0.9004) acc_u 15.6250 (12.2917) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/32] time 0.176 (0.183) data 0.099 (0.106) loss_u loss_u 0.9702 (0.9043) acc_u 3.1250 (11.7188) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [25/32] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9336 (0.9111) acc_u 9.3750 (11.0000) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/32] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9600 (0.9091) acc_u 3.1250 (11.1458) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.3472, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 561
clean true:555
clean false:6
clean_rate:0.9893048128342246
noisy true:480
noisy false:575
after delete: len(clean_dataset) 561
after delete: len(noisy_dataset) 1055
epoch [54/200] batch [5/17] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.8066 (0.8639) acc_x 71.8750 (77.5000) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/17] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 1.1680 (0.8074) acc_x 71.8750 (79.3750) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/17] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.7314 (0.8423) acc_x 81.2500 (78.3333) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/32] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.9873 (0.8879) acc_u 0.0000 (11.8750) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/32] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.8516 (0.8958) acc_u 15.6250 (10.9375) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [15/32] time 0.191 (0.184) data 0.114 (0.107) loss_u loss_u 0.8931 (0.8981) acc_u 12.5000 (11.4583) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/32] time 0.182 (0.184) data 0.106 (0.107) loss_u loss_u 0.9492 (0.9032) acc_u 6.2500 (10.7812) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [25/32] time 0.178 (0.185) data 0.101 (0.108) loss_u loss_u 0.8760 (0.9060) acc_u 15.6250 (10.5000) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/32] time 0.182 (0.185) data 0.105 (0.108) loss_u loss_u 0.8604 (0.9057) acc_u 18.7500 (10.9375) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 565
confident_label rate tensor(0.3601, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 582
clean true:574
clean false:8
clean_rate:0.9862542955326461
noisy true:477
noisy false:557
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1034
epoch [55/200] batch [5/18] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.6934 (0.5838) acc_x 81.2500 (85.6250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/18] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5557 (0.6142) acc_x 81.2500 (83.4375) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/18] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.9854 (0.7432) acc_x 78.1250 (81.2500) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/32] time 0.185 (0.179) data 0.106 (0.102) loss_u loss_u 0.9805 (0.9284) acc_u 3.1250 (8.7500) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [10/32] time 0.182 (0.180) data 0.104 (0.103) loss_u loss_u 0.9800 (0.9295) acc_u 0.0000 (8.1250) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/32] time 0.169 (0.180) data 0.091 (0.102) loss_u loss_u 0.8828 (0.9244) acc_u 12.5000 (9.1667) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/32] time 0.176 (0.179) data 0.098 (0.101) loss_u loss_u 0.9741 (0.9242) acc_u 3.1250 (8.9062) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/32] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9351 (0.9193) acc_u 6.2500 (9.3750) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/32] time 0.186 (0.179) data 0.108 (0.101) loss_u loss_u 0.9253 (0.9157) acc_u 6.2500 (9.7917) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.3502, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 566
clean true:558
clean false:8
clean_rate:0.9858657243816255
noisy true:460
noisy false:590
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1050
epoch [56/200] batch [5/17] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 1.0508 (0.8610) acc_x 71.8750 (76.8750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/17] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.9990 (0.7703) acc_x 75.0000 (79.0625) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/17] time 0.182 (0.184) data 0.105 (0.108) loss_x loss_x 0.3926 (0.7183) acc_x 87.5000 (80.4167) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/32] time 0.182 (0.184) data 0.106 (0.107) loss_u loss_u 0.9072 (0.8954) acc_u 12.5000 (12.5000) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [10/32] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8677 (0.8956) acc_u 18.7500 (11.8750) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/32] time 0.182 (0.184) data 0.104 (0.108) loss_u loss_u 0.8960 (0.8958) acc_u 9.3750 (11.4583) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/32] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8320 (0.8966) acc_u 18.7500 (11.5625) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [25/32] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.9604 (0.9019) acc_u 6.2500 (11.1250) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [30/32] time 0.184 (0.184) data 0.108 (0.107) loss_u loss_u 0.9326 (0.9079) acc_u 6.2500 (10.4167) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.3558, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 575
clean true:569
clean false:6
clean_rate:0.9895652173913043
noisy true:465
noisy false:576
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1041
epoch [57/200] batch [5/17] time 0.175 (0.179) data 0.099 (0.102) loss_x loss_x 1.1836 (0.8997) acc_x 71.8750 (78.1250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/17] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.7998 (0.8398) acc_x 78.1250 (80.3125) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/17] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.9751 (0.8112) acc_x 68.7500 (81.0417) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/32] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.8511 (0.8946) acc_u 18.7500 (13.7500) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/32] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9028 (0.9070) acc_u 9.3750 (11.2500) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/32] time 0.180 (0.178) data 0.103 (0.101) loss_u loss_u 0.8364 (0.9052) acc_u 21.8750 (11.8750) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/32] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.9487 (0.9062) acc_u 6.2500 (11.5625) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/32] time 0.185 (0.179) data 0.106 (0.102) loss_u loss_u 0.9355 (0.9085) acc_u 6.2500 (11.2500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [30/32] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9688 (0.9126) acc_u 3.1250 (10.6250) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 591
clean true:588
clean false:3
clean_rate:0.9949238578680203
noisy true:489
noisy false:536
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1025
epoch [58/200] batch [5/18] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.5889 (0.5493) acc_x 81.2500 (85.0000) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/18] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.6758 (0.6168) acc_x 84.3750 (83.7500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/18] time 0.185 (0.181) data 0.108 (0.105) loss_x loss_x 0.6909 (0.6177) acc_x 87.5000 (83.7500) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/32] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9619 (0.9409) acc_u 6.2500 (7.5000) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/32] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.8940 (0.9280) acc_u 12.5000 (8.4375) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [15/32] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9590 (0.9251) acc_u 3.1250 (8.7500) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/32] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9053 (0.9167) acc_u 12.5000 (9.6875) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/32] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9043 (0.9174) acc_u 12.5000 (10.1250) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/32] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9639 (0.9216) acc_u 6.2500 (9.4792) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 612
clean true:599
clean false:13
clean_rate:0.9787581699346405
noisy true:480
noisy false:524
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1004
epoch [59/200] batch [5/19] time 0.159 (0.170) data 0.083 (0.094) loss_x loss_x 0.6221 (0.6244) acc_x 84.3750 (82.5000) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/19] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.4424 (0.6580) acc_x 84.3750 (81.5625) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/19] time 0.181 (0.176) data 0.105 (0.100) loss_x loss_x 0.8125 (0.6924) acc_x 75.0000 (80.6250) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/31] time 0.165 (0.175) data 0.088 (0.098) loss_u loss_u 0.9414 (0.9309) acc_u 6.2500 (7.5000) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [10/31] time 0.177 (0.174) data 0.101 (0.097) loss_u loss_u 0.8862 (0.9235) acc_u 12.5000 (8.4375) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/31] time 0.181 (0.174) data 0.104 (0.098) loss_u loss_u 0.8936 (0.9290) acc_u 12.5000 (7.9167) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [20/31] time 0.173 (0.175) data 0.096 (0.099) loss_u loss_u 0.9336 (0.9239) acc_u 9.3750 (9.0625) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [25/31] time 0.173 (0.176) data 0.097 (0.099) loss_u loss_u 0.9126 (0.9245) acc_u 12.5000 (8.8750) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/31] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.9351 (0.9233) acc_u 6.2500 (9.0625) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3614, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 584
clean true:577
clean false:7
clean_rate:0.988013698630137
noisy true:488
noisy false:544
after delete: len(clean_dataset) 584
after delete: len(noisy_dataset) 1032
epoch [60/200] batch [5/18] time 0.178 (0.184) data 0.102 (0.107) loss_x loss_x 0.8477 (0.6948) acc_x 81.2500 (85.6250) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/18] time 0.180 (0.178) data 0.103 (0.101) loss_x loss_x 0.5254 (0.6978) acc_x 87.5000 (84.6875) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [15/18] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.7163 (0.7062) acc_x 78.1250 (84.3750) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/32] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.9248 (0.8854) acc_u 9.3750 (12.5000) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/32] time 0.186 (0.179) data 0.110 (0.101) loss_u loss_u 0.9448 (0.8899) acc_u 6.2500 (12.8125) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/32] time 0.175 (0.178) data 0.099 (0.101) loss_u loss_u 0.9150 (0.8971) acc_u 12.5000 (12.2917) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [20/32] time 0.187 (0.179) data 0.111 (0.102) loss_u loss_u 0.9111 (0.8957) acc_u 9.3750 (12.1875) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/32] time 0.180 (0.180) data 0.104 (0.103) loss_u loss_u 0.8809 (0.9011) acc_u 15.6250 (11.3750) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [30/32] time 0.182 (0.180) data 0.106 (0.103) loss_u loss_u 0.8647 (0.9028) acc_u 15.6250 (11.2500) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3632, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 587
clean true:581
clean false:6
clean_rate:0.989778534923339
noisy true:484
noisy false:545
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1029
epoch [61/200] batch [5/18] time 0.181 (0.172) data 0.104 (0.095) loss_x loss_x 0.8169 (0.7163) acc_x 84.3750 (84.3750) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/18] time 0.184 (0.177) data 0.108 (0.100) loss_x loss_x 0.5352 (0.6844) acc_x 87.5000 (84.0625) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/18] time 0.183 (0.179) data 0.105 (0.102) loss_x loss_x 0.8486 (0.7214) acc_x 81.2500 (82.9167) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/32] time 0.177 (0.180) data 0.099 (0.103) loss_u loss_u 0.8716 (0.9039) acc_u 15.6250 (11.2500) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/32] time 0.159 (0.178) data 0.082 (0.101) loss_u loss_u 0.9443 (0.9044) acc_u 3.1250 (10.9375) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/32] time 0.189 (0.179) data 0.111 (0.102) loss_u loss_u 0.9600 (0.9193) acc_u 6.2500 (9.7917) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/32] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9009 (0.9125) acc_u 12.5000 (10.4688) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [25/32] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.9355 (0.9137) acc_u 6.2500 (10.3750) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/32] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.8945 (0.9172) acc_u 15.6250 (9.8958) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 594
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 577
clean true:567
clean false:10
clean_rate:0.9826689774696707
noisy true:455
noisy false:584
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1039
epoch [62/200] batch [5/18] time 0.172 (0.185) data 0.096 (0.109) loss_x loss_x 0.6040 (0.6912) acc_x 81.2500 (79.3750) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/18] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.7227 (0.6526) acc_x 87.5000 (82.1875) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/18] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.4722 (0.6458) acc_x 93.7500 (82.9167) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/32] time 0.182 (0.186) data 0.105 (0.109) loss_u loss_u 0.8350 (0.8773) acc_u 21.8750 (14.3750) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/32] time 0.183 (0.185) data 0.105 (0.108) loss_u loss_u 0.8833 (0.8755) acc_u 18.7500 (15.0000) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [15/32] time 0.192 (0.185) data 0.114 (0.108) loss_u loss_u 0.8799 (0.8928) acc_u 15.6250 (12.9167) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/32] time 0.167 (0.185) data 0.090 (0.108) loss_u loss_u 0.9194 (0.8966) acc_u 9.3750 (12.5000) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/32] time 0.170 (0.182) data 0.094 (0.105) loss_u loss_u 0.8462 (0.8986) acc_u 18.7500 (12.5000) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/32] time 0.171 (0.182) data 0.093 (0.105) loss_u loss_u 0.9009 (0.8953) acc_u 9.3750 (12.9167) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 593
clean true:587
clean false:6
clean_rate:0.9898819561551433
noisy true:469
noisy false:554
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1023
epoch [63/200] batch [5/18] time 0.182 (0.178) data 0.106 (0.101) loss_x loss_x 1.0410 (0.7306) acc_x 78.1250 (81.8750) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/18] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.6807 (0.6361) acc_x 78.1250 (83.4375) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/18] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.7119 (0.6811) acc_x 71.8750 (81.2500) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/31] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9580 (0.9187) acc_u 6.2500 (10.0000) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [10/31] time 0.178 (0.182) data 0.101 (0.105) loss_u loss_u 0.9058 (0.9151) acc_u 9.3750 (10.0000) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/31] time 0.182 (0.182) data 0.106 (0.105) loss_u loss_u 0.8262 (0.8976) acc_u 25.0000 (12.5000) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/31] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9658 (0.9055) acc_u 3.1250 (11.4062) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [25/31] time 0.198 (0.183) data 0.120 (0.106) loss_u loss_u 0.8774 (0.9011) acc_u 15.6250 (11.8750) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/31] time 0.184 (0.183) data 0.105 (0.105) loss_u loss_u 0.9380 (0.9060) acc_u 6.2500 (11.1458) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 580
confident_label rate tensor(0.3608, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 583
clean true:574
clean false:9
clean_rate:0.9845626072041166
noisy true:462
noisy false:571
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1033
epoch [64/200] batch [5/18] time 0.168 (0.168) data 0.091 (0.091) loss_x loss_x 0.8735 (0.7193) acc_x 81.2500 (78.7500) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/18] time 0.185 (0.177) data 0.108 (0.099) loss_x loss_x 0.6235 (0.6979) acc_x 81.2500 (81.2500) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/18] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 0.3940 (0.7057) acc_x 90.6250 (81.8750) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/32] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9072 (0.8955) acc_u 9.3750 (12.5000) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/32] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8843 (0.8989) acc_u 12.5000 (12.8125) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/32] time 0.181 (0.180) data 0.104 (0.102) loss_u loss_u 0.9268 (0.9060) acc_u 6.2500 (11.2500) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/32] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.8809 (0.8953) acc_u 15.6250 (12.3438) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/32] time 0.197 (0.181) data 0.120 (0.104) loss_u loss_u 0.8315 (0.8982) acc_u 21.8750 (12.1250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/32] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8877 (0.8950) acc_u 12.5000 (12.6042) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:584
clean false:6
clean_rate:0.9898305084745763
noisy true:471
noisy false:555
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [65/200] batch [5/18] time 0.183 (0.195) data 0.106 (0.117) loss_x loss_x 0.4165 (0.6274) acc_x 87.5000 (80.6250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/18] time 0.181 (0.192) data 0.103 (0.115) loss_x loss_x 0.6050 (0.6200) acc_x 81.2500 (80.3125) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/18] time 0.186 (0.189) data 0.109 (0.111) loss_x loss_x 0.2462 (0.6424) acc_x 93.7500 (81.0417) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/32] time 0.236 (0.213) data 0.159 (0.135) loss_u loss_u 0.8462 (0.8724) acc_u 15.6250 (17.5000) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/32] time 0.183 (0.207) data 0.106 (0.130) loss_u loss_u 0.8408 (0.8996) acc_u 18.7500 (13.1250) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/32] time 0.182 (0.203) data 0.105 (0.126) loss_u loss_u 0.8657 (0.9132) acc_u 15.6250 (11.2500) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/32] time 0.186 (0.200) data 0.109 (0.123) loss_u loss_u 0.9297 (0.9112) acc_u 9.3750 (11.5625) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/32] time 0.176 (0.197) data 0.099 (0.120) loss_u loss_u 0.9473 (0.9087) acc_u 6.2500 (11.6250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [30/32] time 0.185 (0.196) data 0.109 (0.119) loss_u loss_u 0.9287 (0.9091) acc_u 6.2500 (11.4583) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.3663, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 592
clean true:586
clean false:6
clean_rate:0.9898648648648649
noisy true:482
noisy false:542
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1024
epoch [66/200] batch [5/18] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.6587 (0.7276) acc_x 84.3750 (80.6250) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/18] time 0.175 (0.179) data 0.098 (0.102) loss_x loss_x 0.4634 (0.7508) acc_x 90.6250 (81.2500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/18] time 0.185 (0.179) data 0.107 (0.103) loss_x loss_x 0.5610 (0.6945) acc_x 84.3750 (82.0833) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/32] time 0.162 (0.180) data 0.084 (0.103) loss_u loss_u 0.9180 (0.9074) acc_u 9.3750 (10.0000) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [10/32] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8555 (0.8907) acc_u 25.0000 (13.1250) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/32] time 0.188 (0.179) data 0.111 (0.102) loss_u loss_u 0.9380 (0.9086) acc_u 6.2500 (10.8333) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/32] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.8877 (0.9088) acc_u 12.5000 (10.6250) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/32] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.8447 (0.9045) acc_u 21.8750 (11.6250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/32] time 0.184 (0.181) data 0.108 (0.104) loss_u loss_u 0.8755 (0.9014) acc_u 15.6250 (11.9792) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:597
clean false:6
clean_rate:0.9900497512437811
noisy true:490
noisy false:523
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [67/200] batch [5/18] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.6924 (0.7795) acc_x 78.1250 (80.0000) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/18] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 1.0332 (0.7620) acc_x 65.6250 (79.3750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/18] time 0.159 (0.179) data 0.082 (0.102) loss_x loss_x 0.7559 (0.7584) acc_x 87.5000 (80.4167) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/31] time 0.177 (0.178) data 0.098 (0.101) loss_u loss_u 0.9189 (0.9147) acc_u 9.3750 (8.7500) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/31] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9229 (0.9225) acc_u 12.5000 (8.4375) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/31] time 0.160 (0.177) data 0.083 (0.101) loss_u loss_u 0.8442 (0.9140) acc_u 18.7500 (9.5833) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/31] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.9189 (0.9172) acc_u 9.3750 (9.5312) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [25/31] time 0.164 (0.176) data 0.086 (0.100) loss_u loss_u 0.8838 (0.9176) acc_u 12.5000 (9.5000) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/31] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.8247 (0.9128) acc_u 18.7500 (9.8958) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.3521, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 569
clean true:562
clean false:7
clean_rate:0.9876977152899824
noisy true:482
noisy false:565
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1047
epoch [68/200] batch [5/17] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.7964 (0.6115) acc_x 78.1250 (85.0000) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [10/17] time 0.168 (0.172) data 0.092 (0.095) loss_x loss_x 0.5977 (0.6838) acc_x 87.5000 (82.8125) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [15/17] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 0.7705 (0.6982) acc_x 75.0000 (82.0833) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/32] time 0.186 (0.174) data 0.108 (0.097) loss_u loss_u 0.8613 (0.8798) acc_u 18.7500 (14.3750) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [10/32] time 0.170 (0.173) data 0.091 (0.095) loss_u loss_u 0.8364 (0.8693) acc_u 18.7500 (15.6250) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/32] time 0.172 (0.174) data 0.092 (0.096) loss_u loss_u 0.9438 (0.8747) acc_u 6.2500 (14.3750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/32] time 0.181 (0.174) data 0.103 (0.096) loss_u loss_u 0.9727 (0.8871) acc_u 3.1250 (13.2812) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/32] time 0.174 (0.175) data 0.096 (0.097) loss_u loss_u 0.8174 (0.8896) acc_u 18.7500 (13.0000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [30/32] time 0.170 (0.175) data 0.092 (0.097) loss_u loss_u 0.9458 (0.8929) acc_u 6.2500 (12.3958) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.3583, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 579
clean true:571
clean false:8
clean_rate:0.9861830742659758
noisy true:473
noisy false:564
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 1037
epoch [69/200] batch [5/18] time 0.175 (0.179) data 0.097 (0.102) loss_x loss_x 0.4727 (0.6875) acc_x 90.6250 (83.1250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/18] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.7329 (0.7639) acc_x 68.7500 (79.3750) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/18] time 0.157 (0.171) data 0.080 (0.094) loss_x loss_x 0.7036 (0.7185) acc_x 75.0000 (80.4167) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/32] time 0.183 (0.174) data 0.105 (0.096) loss_u loss_u 0.9570 (0.8822) acc_u 6.2500 (13.1250) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/32] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.9292 (0.8982) acc_u 6.2500 (11.2500) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/32] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.9678 (0.9007) acc_u 6.2500 (11.2500) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/32] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.9102 (0.9028) acc_u 12.5000 (11.2500) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [25/32] time 0.196 (0.179) data 0.119 (0.101) loss_u loss_u 0.8540 (0.9023) acc_u 18.7500 (11.5000) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [30/32] time 0.182 (0.180) data 0.105 (0.102) loss_u loss_u 0.8208 (0.9002) acc_u 18.7500 (11.4583) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 546
confident_label rate tensor(0.3608, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 583
clean true:575
clean false:8
clean_rate:0.9862778730703259
noisy true:495
noisy false:538
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1033
epoch [70/200] batch [5/18] time 0.182 (0.183) data 0.104 (0.106) loss_x loss_x 0.9102 (0.6194) acc_x 68.7500 (81.8750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/18] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.5068 (0.7130) acc_x 87.5000 (82.1875) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/18] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.3071 (0.6778) acc_x 93.7500 (82.7083) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/32] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.9360 (0.9341) acc_u 6.2500 (6.2500) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [10/32] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9014 (0.9131) acc_u 12.5000 (9.0625) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/32] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.9497 (0.9148) acc_u 6.2500 (8.9583) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/32] time 0.161 (0.181) data 0.083 (0.104) loss_u loss_u 0.9292 (0.9129) acc_u 9.3750 (9.3750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/32] time 0.176 (0.181) data 0.098 (0.104) loss_u loss_u 0.8872 (0.9050) acc_u 12.5000 (10.1250) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [30/32] time 0.203 (0.181) data 0.126 (0.104) loss_u loss_u 0.9585 (0.9106) acc_u 3.1250 (9.5833) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 507
confident_label rate tensor(0.3812, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 616
clean true:608
clean false:8
clean_rate:0.987012987012987
noisy true:501
noisy false:499
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1000
epoch [71/200] batch [5/19] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 0.6309 (0.6836) acc_x 84.3750 (81.2500) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/19] time 0.181 (0.177) data 0.105 (0.100) loss_x loss_x 0.7910 (0.7461) acc_x 78.1250 (80.0000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/19] time 0.181 (0.177) data 0.105 (0.100) loss_x loss_x 0.6543 (0.7118) acc_x 75.0000 (81.4583) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/31] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.9619 (0.9323) acc_u 6.2500 (6.8750) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [10/31] time 0.184 (0.177) data 0.105 (0.100) loss_u loss_u 0.9346 (0.9246) acc_u 6.2500 (7.8125) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/31] time 0.183 (0.178) data 0.107 (0.102) loss_u loss_u 0.8984 (0.9164) acc_u 9.3750 (8.5417) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/31] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9111 (0.9189) acc_u 9.3750 (8.5938) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [25/31] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.8516 (0.9177) acc_u 15.6250 (9.0000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [30/31] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9165 (0.9199) acc_u 9.3750 (8.6458) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 544
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 609
clean true:600
clean false:9
clean_rate:0.9852216748768473
noisy true:472
noisy false:535
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1007
epoch [72/200] batch [5/19] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 0.9116 (0.7876) acc_x 68.7500 (78.7500) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/19] time 0.182 (0.191) data 0.105 (0.115) loss_x loss_x 0.6426 (0.7692) acc_x 81.2500 (79.6875) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/19] time 0.169 (0.186) data 0.092 (0.109) loss_x loss_x 0.6538 (0.7368) acc_x 81.2500 (80.6250) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/31] time 0.163 (0.177) data 0.086 (0.100) loss_u loss_u 0.8774 (0.9145) acc_u 18.7500 (11.2500) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [10/31] time 0.162 (0.175) data 0.084 (0.098) loss_u loss_u 0.9663 (0.9111) acc_u 3.1250 (10.9375) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [15/31] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.8979 (0.9151) acc_u 12.5000 (10.6250) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/31] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9160 (0.9059) acc_u 9.3750 (11.4062) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [25/31] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.9307 (0.9151) acc_u 9.3750 (10.2500) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [30/31] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.9146 (0.9156) acc_u 9.3750 (10.2083) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.3632, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 587
clean true:581
clean false:6
clean_rate:0.989778534923339
noisy true:466
noisy false:563
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1029
epoch [73/200] batch [5/18] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.7305 (0.7889) acc_x 81.2500 (81.2500) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/18] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 0.6812 (0.7407) acc_x 71.8750 (80.3125) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/18] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.6597 (0.7375) acc_x 81.2500 (80.2083) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/32] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.9702 (0.9197) acc_u 3.1250 (9.3750) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [10/32] time 0.187 (0.177) data 0.110 (0.100) loss_u loss_u 0.8589 (0.9052) acc_u 15.6250 (10.6250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/32] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9917 (0.8992) acc_u 0.0000 (11.2500) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/32] time 0.165 (0.177) data 0.088 (0.100) loss_u loss_u 0.9238 (0.9016) acc_u 9.3750 (11.4062) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/32] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.8057 (0.9012) acc_u 21.8750 (11.2500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [30/32] time 0.183 (0.177) data 0.107 (0.100) loss_u loss_u 0.8994 (0.9051) acc_u 9.3750 (10.6250) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.3620, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 585
clean true:579
clean false:6
clean_rate:0.9897435897435898
noisy true:489
noisy false:542
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1031
epoch [74/200] batch [5/18] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.6416 (0.7366) acc_x 87.5000 (83.1250) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [10/18] time 0.166 (0.180) data 0.090 (0.103) loss_x loss_x 0.5996 (0.7444) acc_x 87.5000 (81.2500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/18] time 0.173 (0.176) data 0.097 (0.099) loss_x loss_x 0.7793 (0.7371) acc_x 81.2500 (81.0417) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/32] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.9150 (0.8826) acc_u 12.5000 (14.3750) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [10/32] time 0.185 (0.177) data 0.107 (0.101) loss_u loss_u 0.9526 (0.8949) acc_u 6.2500 (13.1250) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/32] time 0.182 (0.178) data 0.104 (0.101) loss_u loss_u 0.9150 (0.9007) acc_u 9.3750 (11.8750) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/32] time 0.162 (0.178) data 0.085 (0.102) loss_u loss_u 0.9341 (0.8997) acc_u 9.3750 (12.0312) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/32] time 0.179 (0.178) data 0.102 (0.102) loss_u loss_u 0.9751 (0.9038) acc_u 3.1250 (11.6250) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [30/32] time 0.183 (0.179) data 0.107 (0.102) loss_u loss_u 0.9429 (0.9013) acc_u 6.2500 (11.8750) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 606
clean true:601
clean false:5
clean_rate:0.9917491749174917
noisy true:476
noisy false:534
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1010
epoch [75/200] batch [5/18] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.7310 (0.5455) acc_x 78.1250 (87.5000) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/18] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.8789 (0.6913) acc_x 81.2500 (83.4375) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/18] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.6157 (0.6606) acc_x 87.5000 (83.5417) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/31] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9473 (0.9218) acc_u 3.1250 (8.1250) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [10/31] time 0.186 (0.184) data 0.107 (0.107) loss_u loss_u 0.9077 (0.9176) acc_u 12.5000 (10.0000) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/31] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8623 (0.9180) acc_u 15.6250 (10.6250) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [20/31] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9951 (0.9184) acc_u 0.0000 (10.3125) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/31] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8784 (0.9092) acc_u 12.5000 (11.1250) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [30/31] time 0.181 (0.183) data 0.104 (0.107) loss_u loss_u 0.9478 (0.9107) acc_u 6.2500 (10.7292) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 607
clean true:602
clean false:5
clean_rate:0.9917627677100495
noisy true:479
noisy false:530
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1009
epoch [76/200] batch [5/18] time 0.170 (0.194) data 0.094 (0.118) loss_x loss_x 0.7651 (0.6352) acc_x 81.2500 (83.7500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/18] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.4050 (0.7094) acc_x 84.3750 (82.5000) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [15/18] time 0.168 (0.181) data 0.092 (0.104) loss_x loss_x 0.7227 (0.6780) acc_x 81.2500 (83.1250) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/31] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.9351 (0.9058) acc_u 9.3750 (12.5000) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [10/31] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.9331 (0.9054) acc_u 6.2500 (12.1875) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/31] time 0.186 (0.176) data 0.108 (0.099) loss_u loss_u 0.8589 (0.9075) acc_u 15.6250 (11.6667) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/31] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9204 (0.9118) acc_u 9.3750 (11.0938) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [25/31] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.9316 (0.9102) acc_u 6.2500 (11.0000) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [30/31] time 0.179 (0.179) data 0.102 (0.102) loss_u loss_u 0.8628 (0.9093) acc_u 15.6250 (10.9375) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 602
clean true:589
clean false:13
clean_rate:0.978405315614618
noisy true:479
noisy false:535
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1014
epoch [77/200] batch [5/18] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.5605 (0.7199) acc_x 75.0000 (78.1250) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/18] time 0.180 (0.183) data 0.104 (0.106) loss_x loss_x 0.5415 (0.7485) acc_x 78.1250 (78.4375) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/18] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.4729 (0.7946) acc_x 93.7500 (78.3333) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/31] time 0.179 (0.182) data 0.102 (0.105) loss_u loss_u 0.8892 (0.9182) acc_u 15.6250 (9.3750) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [10/31] time 0.192 (0.183) data 0.115 (0.106) loss_u loss_u 0.9707 (0.9182) acc_u 3.1250 (9.6875) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/31] time 0.202 (0.184) data 0.124 (0.107) loss_u loss_u 0.8276 (0.9115) acc_u 18.7500 (10.4167) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/31] time 0.187 (0.184) data 0.111 (0.107) loss_u loss_u 0.9077 (0.9050) acc_u 9.3750 (11.0938) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/31] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.8926 (0.9087) acc_u 15.6250 (10.7500) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/31] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.8857 (0.9001) acc_u 12.5000 (11.9792) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 531
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:586
clean false:4
clean_rate:0.9932203389830508
noisy true:499
noisy false:527
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [78/200] batch [5/18] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.5015 (0.7575) acc_x 90.6250 (80.0000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/18] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.8232 (0.7152) acc_x 81.2500 (81.5625) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/18] time 0.168 (0.182) data 0.092 (0.105) loss_x loss_x 1.0176 (0.7810) acc_x 71.8750 (80.0000) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/32] time 0.159 (0.177) data 0.081 (0.100) loss_u loss_u 0.8486 (0.9204) acc_u 15.6250 (9.3750) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [10/32] time 0.160 (0.175) data 0.083 (0.098) loss_u loss_u 0.8652 (0.9061) acc_u 15.6250 (10.6250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/32] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.9395 (0.9113) acc_u 6.2500 (10.0000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/32] time 0.186 (0.176) data 0.108 (0.099) loss_u loss_u 0.9551 (0.9010) acc_u 6.2500 (11.2500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/32] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9800 (0.9046) acc_u 3.1250 (10.7500) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [30/32] time 0.184 (0.178) data 0.107 (0.100) loss_u loss_u 0.9312 (0.9002) acc_u 6.2500 (11.1458) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 519
confident_label rate tensor(0.3843, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 621
clean true:615
clean false:6
clean_rate:0.9903381642512077
noisy true:482
noisy false:513
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 995
epoch [79/200] batch [5/19] time 0.195 (0.186) data 0.117 (0.109) loss_x loss_x 0.4028 (0.7043) acc_x 84.3750 (82.5000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/19] time 0.176 (0.185) data 0.100 (0.108) loss_x loss_x 0.7046 (0.6793) acc_x 81.2500 (82.5000) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/19] time 0.192 (0.185) data 0.115 (0.108) loss_x loss_x 0.9189 (0.7075) acc_x 78.1250 (82.0833) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/31] time 0.174 (0.183) data 0.096 (0.106) loss_u loss_u 0.9106 (0.9016) acc_u 9.3750 (11.2500) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [10/31] time 0.174 (0.181) data 0.097 (0.104) loss_u loss_u 0.9121 (0.9134) acc_u 9.3750 (10.3125) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [15/31] time 0.175 (0.181) data 0.098 (0.104) loss_u loss_u 0.9214 (0.9136) acc_u 9.3750 (10.0000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/31] time 0.170 (0.179) data 0.094 (0.102) loss_u loss_u 0.9336 (0.9141) acc_u 6.2500 (10.1562) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [25/31] time 0.167 (0.178) data 0.090 (0.101) loss_u loss_u 0.9424 (0.9174) acc_u 6.2500 (9.7500) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [30/31] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.9653 (0.9170) acc_u 6.2500 (9.6875) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 618
clean true:609
clean false:9
clean_rate:0.9854368932038835
noisy true:478
noisy false:520
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 998
epoch [80/200] batch [5/19] time 0.183 (0.189) data 0.105 (0.112) loss_x loss_x 0.8496 (0.8313) acc_x 78.1250 (80.6250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/19] time 0.160 (0.186) data 0.083 (0.109) loss_x loss_x 0.8218 (0.7651) acc_x 71.8750 (79.6875) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/19] time 0.189 (0.183) data 0.111 (0.107) loss_x loss_x 0.5171 (0.7325) acc_x 90.6250 (81.4583) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/31] time 0.161 (0.181) data 0.083 (0.104) loss_u loss_u 0.9663 (0.9455) acc_u 6.2500 (6.8750) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [10/31] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8745 (0.9213) acc_u 15.6250 (9.6875) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [15/31] time 0.168 (0.180) data 0.091 (0.103) loss_u loss_u 0.9155 (0.9198) acc_u 9.3750 (9.7917) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/31] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9077 (0.9153) acc_u 9.3750 (9.8438) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [25/31] time 0.173 (0.180) data 0.096 (0.103) loss_u loss_u 0.9912 (0.9219) acc_u 3.1250 (9.1250) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [30/31] time 0.169 (0.180) data 0.092 (0.103) loss_u loss_u 0.8877 (0.9188) acc_u 12.5000 (9.2708) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:605
clean false:10
clean_rate:0.983739837398374
noisy true:472
noisy false:529
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [81/200] batch [5/19] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.9395 (0.8536) acc_x 71.8750 (79.3750) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/19] time 0.177 (0.182) data 0.100 (0.106) loss_x loss_x 0.9331 (0.7749) acc_x 71.8750 (78.7500) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/19] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 0.4775 (0.7319) acc_x 90.6250 (80.6250) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/31] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.8325 (0.8849) acc_u 25.0000 (14.3750) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/31] time 0.159 (0.175) data 0.082 (0.098) loss_u loss_u 0.9312 (0.8929) acc_u 12.5000 (13.4375) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/31] time 0.175 (0.175) data 0.097 (0.098) loss_u loss_u 0.9268 (0.9016) acc_u 9.3750 (12.5000) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/31] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.9644 (0.9100) acc_u 3.1250 (11.2500) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [25/31] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.9355 (0.9063) acc_u 6.2500 (11.5000) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [30/31] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.8936 (0.9042) acc_u 12.5000 (11.5625) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 519
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 608
clean true:598
clean false:10
clean_rate:0.9835526315789473
noisy true:499
noisy false:509
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1008
epoch [82/200] batch [5/19] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.6519 (0.6884) acc_x 75.0000 (78.1250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/19] time 0.170 (0.181) data 0.093 (0.104) loss_x loss_x 0.6079 (0.6782) acc_x 81.2500 (80.9375) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/19] time 0.168 (0.181) data 0.091 (0.104) loss_x loss_x 0.5859 (0.6242) acc_x 78.1250 (82.0833) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/31] time 0.160 (0.174) data 0.083 (0.097) loss_u loss_u 0.8862 (0.8673) acc_u 12.5000 (15.6250) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [10/31] time 0.162 (0.172) data 0.084 (0.095) loss_u loss_u 0.8735 (0.8847) acc_u 15.6250 (13.7500) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [15/31] time 0.181 (0.172) data 0.104 (0.095) loss_u loss_u 0.8857 (0.8892) acc_u 12.5000 (12.9167) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [20/31] time 0.159 (0.173) data 0.082 (0.096) loss_u loss_u 0.8735 (0.8944) acc_u 12.5000 (12.0312) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [25/31] time 0.171 (0.173) data 0.093 (0.096) loss_u loss_u 0.9014 (0.8949) acc_u 9.3750 (12.1250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [30/31] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.9990 (0.9057) acc_u 0.0000 (10.9375) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:590
clean false:7
clean_rate:0.9882747068676717
noisy true:492
noisy false:527
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [83/200] batch [5/18] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.5557 (0.7479) acc_x 87.5000 (82.5000) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/18] time 0.189 (0.183) data 0.113 (0.106) loss_x loss_x 0.8555 (0.6973) acc_x 81.2500 (81.5625) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/18] time 0.187 (0.185) data 0.110 (0.109) loss_x loss_x 0.6650 (0.6642) acc_x 81.2500 (82.0833) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/31] time 0.160 (0.183) data 0.082 (0.106) loss_u loss_u 0.8276 (0.8752) acc_u 21.8750 (15.6250) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [10/31] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9507 (0.8946) acc_u 6.2500 (12.5000) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/31] time 0.162 (0.181) data 0.085 (0.104) loss_u loss_u 0.8999 (0.9004) acc_u 12.5000 (12.0833) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/31] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.9629 (0.9050) acc_u 3.1250 (11.4062) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [25/31] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.9487 (0.9061) acc_u 6.2500 (11.2500) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [30/31] time 0.211 (0.182) data 0.135 (0.105) loss_u loss_u 0.9683 (0.9073) acc_u 3.1250 (10.9375) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:609
clean false:6
clean_rate:0.9902439024390244
noisy true:475
noisy false:526
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [84/200] batch [5/19] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.7402 (0.6941) acc_x 81.2500 (81.8750) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [10/19] time 0.160 (0.168) data 0.084 (0.091) loss_x loss_x 0.3755 (0.6425) acc_x 87.5000 (83.4375) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/19] time 0.170 (0.167) data 0.092 (0.090) loss_x loss_x 0.7163 (0.6348) acc_x 78.1250 (82.5000) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/31] time 0.183 (0.168) data 0.106 (0.091) loss_u loss_u 0.8867 (0.9226) acc_u 12.5000 (8.1250) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/31] time 0.181 (0.169) data 0.104 (0.092) loss_u loss_u 0.8291 (0.9126) acc_u 21.8750 (10.6250) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/31] time 0.182 (0.172) data 0.104 (0.095) loss_u loss_u 0.9819 (0.9201) acc_u 3.1250 (9.7917) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/31] time 0.178 (0.173) data 0.100 (0.096) loss_u loss_u 0.8916 (0.9131) acc_u 12.5000 (10.1562) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [25/31] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.9092 (0.9131) acc_u 12.5000 (10.1250) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [30/31] time 0.176 (0.175) data 0.098 (0.098) loss_u loss_u 0.9038 (0.9090) acc_u 9.3750 (10.5208) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 531
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:598
clean false:7
clean_rate:0.9884297520661157
noisy true:487
noisy false:524
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [85/200] batch [5/18] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.5566 (0.5987) acc_x 84.3750 (83.7500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [10/18] time 0.171 (0.180) data 0.094 (0.104) loss_x loss_x 0.9854 (0.6885) acc_x 75.0000 (81.5625) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/18] time 0.193 (0.178) data 0.116 (0.102) loss_x loss_x 0.5161 (0.6500) acc_x 84.3750 (82.9167) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/31] time 0.177 (0.181) data 0.099 (0.104) loss_u loss_u 0.9629 (0.9398) acc_u 6.2500 (8.7500) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [10/31] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9277 (0.9219) acc_u 6.2500 (9.6875) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [15/31] time 0.187 (0.181) data 0.110 (0.104) loss_u loss_u 0.9199 (0.9251) acc_u 9.3750 (8.9583) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [20/31] time 0.185 (0.182) data 0.107 (0.104) loss_u loss_u 0.9126 (0.9219) acc_u 9.3750 (9.2188) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [25/31] time 0.198 (0.182) data 0.121 (0.105) loss_u loss_u 0.8799 (0.9141) acc_u 12.5000 (10.0000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [30/31] time 0.170 (0.181) data 0.092 (0.104) loss_u loss_u 0.9062 (0.9095) acc_u 12.5000 (10.5208) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:608
clean false:7
clean_rate:0.9886178861788618
noisy true:504
noisy false:497
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [86/200] batch [5/19] time 0.179 (0.173) data 0.103 (0.096) loss_x loss_x 0.9995 (0.6177) acc_x 68.7500 (80.6250) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/19] time 0.163 (0.178) data 0.085 (0.100) loss_x loss_x 0.3308 (0.5828) acc_x 90.6250 (82.1875) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/19] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 0.7856 (0.6464) acc_x 78.1250 (81.4583) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/31] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8784 (0.9080) acc_u 15.6250 (10.6250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [10/31] time 0.188 (0.183) data 0.110 (0.105) loss_u loss_u 0.9150 (0.9155) acc_u 9.3750 (10.0000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [15/31] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.9448 (0.9062) acc_u 6.2500 (10.8333) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/31] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.9395 (0.9029) acc_u 9.3750 (11.2500) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/31] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.9097 (0.9003) acc_u 9.3750 (11.3750) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [30/31] time 0.183 (0.184) data 0.105 (0.106) loss_u loss_u 0.9126 (0.9040) acc_u 9.3750 (11.1458) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 608
clean true:601
clean false:7
clean_rate:0.9884868421052632
noisy true:476
noisy false:532
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1008
epoch [87/200] batch [5/19] time 0.167 (0.171) data 0.090 (0.095) loss_x loss_x 0.7051 (0.5739) acc_x 87.5000 (85.6250) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/19] time 0.179 (0.173) data 0.102 (0.096) loss_x loss_x 1.1406 (0.6711) acc_x 75.0000 (83.7500) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/19] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.5376 (0.6532) acc_x 81.2500 (83.7500) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/31] time 0.163 (0.177) data 0.087 (0.100) loss_u loss_u 0.8921 (0.8887) acc_u 9.3750 (13.1250) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [10/31] time 0.161 (0.174) data 0.085 (0.097) loss_u loss_u 0.9180 (0.8957) acc_u 9.3750 (12.1875) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [15/31] time 0.159 (0.175) data 0.082 (0.098) loss_u loss_u 0.9678 (0.9083) acc_u 3.1250 (10.6250) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/31] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9106 (0.9097) acc_u 12.5000 (10.1562) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [25/31] time 0.166 (0.175) data 0.089 (0.098) loss_u loss_u 0.9150 (0.9093) acc_u 6.2500 (10.1250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [30/31] time 0.161 (0.174) data 0.084 (0.097) loss_u loss_u 0.9180 (0.9074) acc_u 15.6250 (10.5208) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 613
clean true:608
clean false:5
clean_rate:0.9918433931484503
noisy true:481
noisy false:522
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1003
epoch [88/200] batch [5/19] time 0.184 (0.176) data 0.108 (0.099) loss_x loss_x 1.0459 (0.7554) acc_x 75.0000 (80.0000) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/19] time 0.185 (0.180) data 0.107 (0.103) loss_x loss_x 0.9946 (0.7451) acc_x 87.5000 (82.5000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [15/19] time 0.185 (0.182) data 0.107 (0.105) loss_x loss_x 0.5454 (0.7118) acc_x 87.5000 (83.1250) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/31] time 0.191 (0.183) data 0.113 (0.106) loss_u loss_u 0.9028 (0.9321) acc_u 9.3750 (8.1250) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/31] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9365 (0.9338) acc_u 9.3750 (7.8125) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [15/31] time 0.182 (0.184) data 0.106 (0.107) loss_u loss_u 0.8813 (0.9171) acc_u 12.5000 (9.7917) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [20/31] time 0.197 (0.185) data 0.120 (0.108) loss_u loss_u 0.9238 (0.9165) acc_u 9.3750 (10.1562) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/31] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.8682 (0.9118) acc_u 12.5000 (10.5000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [30/31] time 0.159 (0.182) data 0.083 (0.105) loss_u loss_u 0.8774 (0.9127) acc_u 12.5000 (10.2083) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 600
clean true:592
clean false:8
clean_rate:0.9866666666666667
noisy true:495
noisy false:521
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1016
epoch [89/200] batch [5/18] time 0.159 (0.179) data 0.083 (0.103) loss_x loss_x 0.5405 (0.5753) acc_x 84.3750 (86.8750) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/18] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.7876 (0.5025) acc_x 78.1250 (88.4375) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/18] time 0.175 (0.174) data 0.098 (0.097) loss_x loss_x 0.5742 (0.5340) acc_x 84.3750 (86.4583) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/31] time 0.188 (0.171) data 0.110 (0.094) loss_u loss_u 0.9097 (0.9094) acc_u 9.3750 (11.2500) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [10/31] time 0.184 (0.173) data 0.108 (0.097) loss_u loss_u 0.9834 (0.9329) acc_u 3.1250 (8.1250) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [15/31] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.7979 (0.9220) acc_u 21.8750 (8.9583) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/31] time 0.185 (0.176) data 0.109 (0.100) loss_u loss_u 0.8760 (0.9150) acc_u 15.6250 (9.8438) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [25/31] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.9204 (0.9185) acc_u 9.3750 (9.5000) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [30/31] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.8193 (0.9091) acc_u 25.0000 (10.8333) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.3812, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 616
clean true:608
clean false:8
clean_rate:0.987012987012987
noisy true:486
noisy false:514
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1000
epoch [90/200] batch [5/19] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.6860 (0.7343) acc_x 84.3750 (80.6250) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/19] time 0.175 (0.183) data 0.099 (0.106) loss_x loss_x 0.7764 (0.7038) acc_x 78.1250 (81.2500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/19] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 0.5171 (0.7124) acc_x 81.2500 (80.2083) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/31] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.9810 (0.9310) acc_u 3.1250 (8.1250) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [10/31] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.8447 (0.9217) acc_u 18.7500 (9.3750) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [15/31] time 0.171 (0.177) data 0.095 (0.100) loss_u loss_u 0.9175 (0.9081) acc_u 12.5000 (11.0417) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [20/31] time 0.180 (0.178) data 0.103 (0.100) loss_u loss_u 0.9717 (0.9120) acc_u 6.2500 (10.9375) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [25/31] time 0.162 (0.177) data 0.085 (0.100) loss_u loss_u 0.8423 (0.9035) acc_u 15.6250 (11.3750) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [30/31] time 0.172 (0.177) data 0.094 (0.099) loss_u loss_u 0.9082 (0.9119) acc_u 9.3750 (10.3125) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 618
clean true:610
clean false:8
clean_rate:0.9870550161812298
noisy true:495
noisy false:503
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 998
epoch [91/200] batch [5/19] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.8276 (0.7328) acc_x 81.2500 (82.5000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/19] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.3704 (0.7346) acc_x 96.8750 (82.1875) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/19] time 0.188 (0.184) data 0.111 (0.106) loss_x loss_x 0.2898 (0.6407) acc_x 93.7500 (83.5417) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/31] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8989 (0.9037) acc_u 12.5000 (11.8750) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [10/31] time 0.173 (0.181) data 0.096 (0.104) loss_u loss_u 0.9302 (0.9154) acc_u 6.2500 (10.6250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [15/31] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.8960 (0.9097) acc_u 12.5000 (11.2500) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/31] time 0.166 (0.181) data 0.089 (0.104) loss_u loss_u 0.9590 (0.9072) acc_u 6.2500 (11.0938) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [25/31] time 0.168 (0.180) data 0.091 (0.103) loss_u loss_u 0.9067 (0.9156) acc_u 9.3750 (10.1250) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [30/31] time 0.182 (0.180) data 0.106 (0.102) loss_u loss_u 0.9058 (0.9158) acc_u 9.3750 (10.0000) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 614
clean true:604
clean false:10
clean_rate:0.9837133550488599
noisy true:490
noisy false:512
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1002
epoch [92/200] batch [5/19] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.4102 (0.6990) acc_x 90.6250 (85.0000) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/19] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.6787 (0.6649) acc_x 84.3750 (84.6875) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [15/19] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.3464 (0.6637) acc_x 93.7500 (85.0000) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/31] time 0.161 (0.178) data 0.084 (0.101) loss_u loss_u 0.8701 (0.9345) acc_u 15.6250 (7.5000) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [10/31] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.8525 (0.9095) acc_u 18.7500 (10.6250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [15/31] time 0.175 (0.178) data 0.099 (0.101) loss_u loss_u 0.9048 (0.9124) acc_u 9.3750 (9.7917) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/31] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.9087 (0.9052) acc_u 9.3750 (10.6250) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [25/31] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.8672 (0.8999) acc_u 15.6250 (11.7500) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [30/31] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.8872 (0.9017) acc_u 12.5000 (11.5625) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 499
confident_label rate tensor(0.3979, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 643
clean true:634
clean false:9
clean_rate:0.9860031104199067
noisy true:483
noisy false:490
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 973
epoch [93/200] batch [5/20] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.3376 (0.6849) acc_x 90.6250 (80.6250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/20] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.7090 (0.6670) acc_x 81.2500 (81.8750) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/20] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.3716 (0.6669) acc_x 87.5000 (81.8750) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [20/20] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.6182 (0.6587) acc_x 81.2500 (82.6562) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/30] time 0.168 (0.180) data 0.090 (0.103) loss_u loss_u 0.8975 (0.9368) acc_u 9.3750 (6.8750) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [10/30] time 0.170 (0.178) data 0.093 (0.101) loss_u loss_u 0.8999 (0.9336) acc_u 12.5000 (7.1875) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [15/30] time 0.180 (0.177) data 0.103 (0.100) loss_u loss_u 0.9429 (0.9238) acc_u 6.2500 (8.5417) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/30] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.9644 (0.9284) acc_u 3.1250 (7.9688) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [25/30] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9473 (0.9275) acc_u 6.2500 (8.2500) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [30/30] time 0.196 (0.179) data 0.117 (0.102) loss_u loss_u 0.9766 (0.9292) acc_u 3.1250 (8.0208) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.3855, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 623
clean true:616
clean false:7
clean_rate:0.9887640449438202
noisy true:506
noisy false:487
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 993
epoch [94/200] batch [5/19] time 0.189 (0.188) data 0.113 (0.112) loss_x loss_x 0.5283 (0.5607) acc_x 87.5000 (84.3750) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/19] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 0.5942 (0.5878) acc_x 75.0000 (84.0625) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [15/19] time 0.192 (0.187) data 0.115 (0.110) loss_x loss_x 0.7935 (0.5931) acc_x 75.0000 (83.7500) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/31] time 0.185 (0.187) data 0.108 (0.110) loss_u loss_u 0.8970 (0.9055) acc_u 12.5000 (11.8750) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [10/31] time 0.195 (0.187) data 0.117 (0.110) loss_u loss_u 0.9019 (0.8966) acc_u 15.6250 (12.8125) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [15/31] time 0.183 (0.186) data 0.106 (0.109) loss_u loss_u 0.9600 (0.8978) acc_u 6.2500 (13.3333) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/31] time 0.178 (0.186) data 0.100 (0.109) loss_u loss_u 0.9922 (0.9068) acc_u 3.1250 (12.0312) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/31] time 0.176 (0.185) data 0.099 (0.108) loss_u loss_u 0.9707 (0.9144) acc_u 3.1250 (10.7500) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [30/31] time 0.174 (0.184) data 0.096 (0.107) loss_u loss_u 0.8921 (0.9122) acc_u 15.6250 (10.9375) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.3911, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 632
clean true:620
clean false:12
clean_rate:0.9810126582278481
noisy true:505
noisy false:479
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 984
epoch [95/200] batch [5/19] time 0.169 (0.171) data 0.093 (0.094) loss_x loss_x 0.5215 (0.7639) acc_x 81.2500 (78.7500) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/19] time 0.168 (0.173) data 0.091 (0.096) loss_x loss_x 0.6406 (0.6771) acc_x 81.2500 (80.9375) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [15/19] time 0.159 (0.173) data 0.082 (0.096) loss_x loss_x 1.0068 (0.7144) acc_x 81.2500 (82.0833) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/30] time 0.169 (0.171) data 0.092 (0.094) loss_u loss_u 0.9082 (0.8973) acc_u 9.3750 (11.8750) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/30] time 0.170 (0.170) data 0.093 (0.093) loss_u loss_u 0.9561 (0.9087) acc_u 3.1250 (10.3125) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [15/30] time 0.165 (0.170) data 0.087 (0.093) loss_u loss_u 0.9209 (0.9137) acc_u 9.3750 (10.2083) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/30] time 0.183 (0.172) data 0.106 (0.095) loss_u loss_u 0.9238 (0.9173) acc_u 9.3750 (10.0000) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [25/30] time 0.183 (0.173) data 0.107 (0.096) loss_u loss_u 0.8975 (0.9169) acc_u 9.3750 (9.7500) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [30/30] time 0.166 (0.173) data 0.089 (0.096) loss_u loss_u 0.9033 (0.9160) acc_u 9.3750 (9.6875) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.3849, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 622
clean true:616
clean false:6
clean_rate:0.9903536977491961
noisy true:488
noisy false:506
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 994
epoch [96/200] batch [5/19] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.4280 (0.7367) acc_x 90.6250 (81.2500) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/19] time 0.191 (0.180) data 0.114 (0.104) loss_x loss_x 0.5283 (0.7781) acc_x 84.3750 (81.2500) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/19] time 0.187 (0.181) data 0.110 (0.104) loss_x loss_x 0.7422 (0.7535) acc_x 78.1250 (81.2500) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/31] time 0.182 (0.181) data 0.104 (0.105) loss_u loss_u 0.8623 (0.8982) acc_u 15.6250 (12.5000) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [10/31] time 0.180 (0.182) data 0.104 (0.105) loss_u loss_u 0.9048 (0.8967) acc_u 9.3750 (12.5000) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [15/31] time 0.185 (0.182) data 0.109 (0.105) loss_u loss_u 0.9346 (0.8955) acc_u 9.3750 (12.5000) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [20/31] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9370 (0.8961) acc_u 9.3750 (12.6562) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/31] time 0.182 (0.182) data 0.105 (0.106) loss_u loss_u 0.9678 (0.9057) acc_u 3.1250 (11.3750) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [30/31] time 0.180 (0.182) data 0.103 (0.106) loss_u loss_u 0.8872 (0.9112) acc_u 12.5000 (10.6250) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 516
confident_label rate tensor(0.3868, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 625
clean true:614
clean false:11
clean_rate:0.9824
noisy true:486
noisy false:505
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 991
epoch [97/200] batch [5/19] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.6729 (0.5745) acc_x 84.3750 (85.0000) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/19] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.1970 (0.5624) acc_x 96.8750 (86.2500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/19] time 0.190 (0.184) data 0.114 (0.107) loss_x loss_x 0.7837 (0.6564) acc_x 81.2500 (82.9167) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/30] time 0.169 (0.183) data 0.091 (0.106) loss_u loss_u 0.8862 (0.9211) acc_u 12.5000 (8.7500) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [10/30] time 0.190 (0.183) data 0.113 (0.106) loss_u loss_u 0.8154 (0.9051) acc_u 18.7500 (10.6250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [15/30] time 0.177 (0.184) data 0.100 (0.107) loss_u loss_u 0.8789 (0.9088) acc_u 12.5000 (10.0000) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/30] time 0.184 (0.184) data 0.107 (0.106) loss_u loss_u 0.9224 (0.9097) acc_u 9.3750 (9.8438) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [25/30] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.8540 (0.9108) acc_u 15.6250 (9.6250) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [30/30] time 0.161 (0.182) data 0.083 (0.105) loss_u loss_u 0.8511 (0.9105) acc_u 15.6250 (9.6875) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:619
clean false:9
clean_rate:0.9856687898089171
noisy true:469
noisy false:519
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [98/200] batch [5/19] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.6680 (0.7827) acc_x 84.3750 (78.7500) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/19] time 0.168 (0.181) data 0.091 (0.104) loss_x loss_x 0.6768 (0.6558) acc_x 84.3750 (83.4375) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/19] time 0.174 (0.180) data 0.097 (0.104) loss_x loss_x 0.9312 (0.6702) acc_x 78.1250 (82.9167) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/30] time 0.177 (0.177) data 0.099 (0.100) loss_u loss_u 0.8989 (0.8932) acc_u 9.3750 (11.8750) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [10/30] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.9629 (0.9041) acc_u 6.2500 (11.2500) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [15/30] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9648 (0.9034) acc_u 3.1250 (10.8333) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [20/30] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9438 (0.9053) acc_u 6.2500 (10.4688) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [25/30] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.8989 (0.9071) acc_u 15.6250 (10.3750) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [30/30] time 0.185 (0.179) data 0.109 (0.102) loss_u loss_u 0.9087 (0.9109) acc_u 12.5000 (10.1042) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 556
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 593
clean true:585
clean false:8
clean_rate:0.9865092748735245
noisy true:475
noisy false:548
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1023
epoch [99/200] batch [5/18] time 0.176 (0.182) data 0.100 (0.105) loss_x loss_x 0.2961 (0.3779) acc_x 93.7500 (92.5000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/18] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.6528 (0.4286) acc_x 84.3750 (91.2500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [15/18] time 0.179 (0.178) data 0.103 (0.101) loss_x loss_x 1.3066 (0.5506) acc_x 62.5000 (87.9167) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/31] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.8921 (0.8853) acc_u 12.5000 (14.3750) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/31] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9023 (0.8993) acc_u 9.3750 (12.1875) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [15/31] time 0.184 (0.180) data 0.108 (0.103) loss_u loss_u 0.8862 (0.8974) acc_u 12.5000 (12.5000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/31] time 0.185 (0.180) data 0.107 (0.104) loss_u loss_u 0.9141 (0.8975) acc_u 9.3750 (12.3438) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [25/31] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8618 (0.8908) acc_u 12.5000 (13.1250) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [30/31] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.8311 (0.8877) acc_u 21.8750 (13.3333) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.3855, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 623
clean true:614
clean false:9
clean_rate:0.985553772070626
noisy true:480
noisy false:513
all clean rate:  [0.9803149606299213, 0.9901960784313726, 0.9922680412371134, 0.9779951100244498, 0.9933481152993349, 0.9868131868131869, 0.9931350114416476, 0.9820627802690582, 0.9915254237288136, 0.991130820399113, 0.9914163090128756, 0.9854166666666667, 0.9914346895074947, 0.9919028340080972, 0.9938524590163934, 0.9881656804733728, 0.9940357852882704, 0.9900199600798403, 0.99, 0.9939148073022313, 0.99800796812749, 0.9939024390243902, 0.9895615866388309, 0.9880478087649402, 0.9926062846580407, 0.9900398406374502, 0.9863013698630136, 0.9942528735632183, 0.9862475442043221, 0.9939024390243902, 0.9926062846580407, 0.9906890130353817, 0.9903846153846154, 0.987037037037037, 0.988929889298893, 0.9943502824858758, 0.990909090909091, 0.9927140255009107, 0.9851301115241635, 0.9906890130353817, 0.9868421052631579, 0.9871794871794872, 0.9908759124087592, 0.994661921708185, 0.9856887298747764, 0.9851024208566108, 0.9907063197026023, 0.9910233393177738, 0.9890710382513661, 0.9854545454545455, 0.9838709677419355, 0.983754512635379, 0.9893617021276596, 0.9893048128342246, 0.9862542955326461, 0.9858657243816255, 0.9895652173913043, 0.9949238578680203, 0.9787581699346405, 0.988013698630137, 0.989778534923339, 0.9826689774696707, 0.9898819561551433, 0.9845626072041166, 0.9898305084745763, 0.9898648648648649, 0.9900497512437811, 0.9876977152899824, 0.9861830742659758, 0.9862778730703259, 0.987012987012987, 0.9852216748768473, 0.989778534923339, 0.9897435897435898, 0.9917491749174917, 0.9917627677100495, 0.978405315614618, 0.9932203389830508, 0.9903381642512077, 0.9854368932038835, 0.983739837398374, 0.9835526315789473, 0.9882747068676717, 0.9902439024390244, 0.9884297520661157, 0.9886178861788618, 0.9884868421052632, 0.9918433931484503, 0.9866666666666667, 0.987012987012987, 0.9870550161812298, 0.9837133550488599, 0.9860031104199067, 0.9887640449438202, 0.9810126582278481, 0.9903536977491961, 0.9824, 0.9856687898089171, 0.9865092748735245, 0.985553772070626]
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 993
epoch [100/200] batch [5/19] time 0.173 (0.176) data 0.097 (0.100) loss_x loss_x 0.4204 (0.5460) acc_x 87.5000 (85.0000) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/19] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.6523 (0.5893) acc_x 84.3750 (83.7500) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [15/19] time 0.177 (0.174) data 0.101 (0.098) loss_x loss_x 0.6890 (0.6157) acc_x 78.1250 (83.5417) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/31] time 0.166 (0.175) data 0.089 (0.098) loss_u loss_u 0.8076 (0.8744) acc_u 21.8750 (14.3750) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [10/31] time 0.188 (0.174) data 0.110 (0.097) loss_u loss_u 0.8623 (0.8792) acc_u 15.6250 (13.7500) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [15/31] time 0.186 (0.176) data 0.109 (0.099) loss_u loss_u 0.9302 (0.8969) acc_u 6.2500 (11.6667) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [20/31] time 0.203 (0.178) data 0.126 (0.101) loss_u loss_u 0.9653 (0.9028) acc_u 6.2500 (11.0938) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [25/31] time 0.185 (0.179) data 0.109 (0.102) loss_u loss_u 0.8848 (0.9036) acc_u 12.5000 (11.1250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [30/31] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.9390 (0.9050) acc_u 6.2500 (11.0417) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:621
clean false:7
clean_rate:0.9888535031847133
noisy true:502
noisy false:486
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [101/200] batch [5/19] time 0.184 (0.189) data 0.108 (0.112) loss_x loss_x 0.5938 (0.6987) acc_x 87.5000 (84.3750) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/19] time 0.184 (0.186) data 0.107 (0.110) loss_x loss_x 0.5518 (0.7019) acc_x 87.5000 (84.3750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [15/19] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.2482 (0.6621) acc_x 93.7500 (85.4167) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/30] time 0.160 (0.181) data 0.082 (0.104) loss_u loss_u 0.9971 (0.9277) acc_u 0.0000 (6.8750) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [10/30] time 0.161 (0.178) data 0.084 (0.101) loss_u loss_u 0.8838 (0.9196) acc_u 12.5000 (8.7500) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [15/30] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.9136 (0.9128) acc_u 9.3750 (9.7917) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/30] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8970 (0.9117) acc_u 12.5000 (9.6875) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [25/30] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9185 (0.9105) acc_u 9.3750 (10.0000) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [30/30] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8403 (0.9073) acc_u 18.7500 (10.4167) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.3892, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 629
clean true:620
clean false:9
clean_rate:0.985691573926868
noisy true:499
noisy false:488
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 987
epoch [102/200] batch [5/19] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.4897 (0.6810) acc_x 78.1250 (80.0000) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [10/19] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.4463 (0.7719) acc_x 93.7500 (78.7500) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/19] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 1.1035 (0.7145) acc_x 71.8750 (81.0417) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/30] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9502 (0.9014) acc_u 6.2500 (11.2500) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/30] time 0.175 (0.182) data 0.097 (0.105) loss_u loss_u 0.9526 (0.9222) acc_u 3.1250 (9.3750) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [15/30] time 0.179 (0.182) data 0.102 (0.105) loss_u loss_u 0.8579 (0.9087) acc_u 18.7500 (10.8333) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/30] time 0.175 (0.181) data 0.098 (0.104) loss_u loss_u 0.9873 (0.9143) acc_u 3.1250 (10.1562) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [25/30] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9219 (0.9141) acc_u 12.5000 (10.2500) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [30/30] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.9517 (0.9130) acc_u 6.2500 (10.2083) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:630
clean false:10
clean_rate:0.984375
noisy true:502
noisy false:474
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [103/200] batch [5/20] time 0.168 (0.172) data 0.092 (0.095) loss_x loss_x 0.3467 (0.5748) acc_x 90.6250 (84.3750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/20] time 0.169 (0.167) data 0.091 (0.090) loss_x loss_x 0.6025 (0.5958) acc_x 87.5000 (85.0000) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [15/20] time 0.159 (0.165) data 0.082 (0.088) loss_x loss_x 0.5244 (0.5857) acc_x 84.3750 (85.4167) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [20/20] time 0.172 (0.165) data 0.096 (0.089) loss_x loss_x 0.2559 (0.6014) acc_x 96.8750 (85.0000) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/30] time 0.179 (0.168) data 0.101 (0.091) loss_u loss_u 0.9971 (0.9328) acc_u 0.0000 (10.0000) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [10/30] time 0.189 (0.170) data 0.112 (0.093) loss_u loss_u 0.9165 (0.9242) acc_u 12.5000 (9.6875) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [15/30] time 0.185 (0.172) data 0.107 (0.095) loss_u loss_u 0.9082 (0.9201) acc_u 9.3750 (9.7917) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [20/30] time 0.172 (0.172) data 0.095 (0.095) loss_u loss_u 0.9302 (0.9192) acc_u 9.3750 (9.5312) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [25/30] time 0.187 (0.173) data 0.109 (0.096) loss_u loss_u 0.9390 (0.9133) acc_u 9.3750 (10.2500) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [30/30] time 0.158 (0.172) data 0.081 (0.095) loss_u loss_u 0.9214 (0.9142) acc_u 12.5000 (10.2083) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.3861, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 624
clean true:616
clean false:8
clean_rate:0.9871794871794872
noisy true:478
noisy false:514
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 992
epoch [104/200] batch [5/19] time 0.178 (0.166) data 0.101 (0.089) loss_x loss_x 0.5171 (0.5415) acc_x 87.5000 (86.8750) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/19] time 0.167 (0.168) data 0.090 (0.091) loss_x loss_x 0.5493 (0.6310) acc_x 84.3750 (85.3125) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [15/19] time 0.158 (0.167) data 0.082 (0.090) loss_x loss_x 0.7402 (0.6275) acc_x 75.0000 (84.1667) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/31] time 0.179 (0.172) data 0.101 (0.095) loss_u loss_u 0.8774 (0.8953) acc_u 12.5000 (13.7500) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/31] time 0.170 (0.172) data 0.092 (0.095) loss_u loss_u 0.8604 (0.8781) acc_u 15.6250 (14.6875) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [15/31] time 0.170 (0.172) data 0.091 (0.095) loss_u loss_u 0.9751 (0.8913) acc_u 0.0000 (13.1250) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [20/31] time 0.177 (0.173) data 0.100 (0.095) loss_u loss_u 0.9360 (0.8986) acc_u 6.2500 (12.0312) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [25/31] time 0.173 (0.173) data 0.096 (0.096) loss_u loss_u 0.9951 (0.8996) acc_u 0.0000 (12.0000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [30/31] time 0.161 (0.173) data 0.084 (0.096) loss_u loss_u 0.8872 (0.9053) acc_u 12.5000 (11.4583) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 498
confident_label rate tensor(0.3837, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 620
clean true:611
clean false:9
clean_rate:0.9854838709677419
noisy true:507
noisy false:489
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 996
epoch [105/200] batch [5/19] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.7417 (0.5609) acc_x 84.3750 (88.7500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/19] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.6260 (0.6341) acc_x 84.3750 (86.2500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [15/19] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.6592 (0.5846) acc_x 87.5000 (86.8750) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/31] time 0.173 (0.176) data 0.095 (0.099) loss_u loss_u 0.9121 (0.9237) acc_u 9.3750 (9.3750) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [10/31] time 0.188 (0.176) data 0.112 (0.099) loss_u loss_u 0.8628 (0.8984) acc_u 15.6250 (12.5000) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [15/31] time 0.187 (0.178) data 0.111 (0.101) loss_u loss_u 0.8872 (0.9005) acc_u 12.5000 (12.0833) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/31] time 0.196 (0.179) data 0.120 (0.102) loss_u loss_u 0.9478 (0.9016) acc_u 6.2500 (12.1875) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [25/31] time 0.168 (0.180) data 0.091 (0.103) loss_u loss_u 0.9102 (0.9032) acc_u 9.3750 (11.7500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [30/31] time 0.196 (0.180) data 0.120 (0.102) loss_u loss_u 0.8911 (0.9013) acc_u 12.5000 (11.8750) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 520
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 611
clean true:603
clean false:8
clean_rate:0.9869067103109657
noisy true:493
noisy false:512
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 1005
epoch [106/200] batch [5/19] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 0.8433 (0.5742) acc_x 81.2500 (86.2500) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/19] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.4805 (0.6159) acc_x 87.5000 (82.8125) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/19] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.7041 (0.6420) acc_x 81.2500 (82.0833) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/31] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.8965 (0.9181) acc_u 12.5000 (9.3750) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [10/31] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9058 (0.9189) acc_u 9.3750 (9.6875) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [15/31] time 0.183 (0.184) data 0.107 (0.107) loss_u loss_u 0.9624 (0.9125) acc_u 3.1250 (10.2083) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [20/31] time 0.177 (0.184) data 0.100 (0.107) loss_u loss_u 0.9194 (0.9092) acc_u 12.5000 (10.7812) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/31] time 0.171 (0.182) data 0.093 (0.105) loss_u loss_u 0.8853 (0.9048) acc_u 12.5000 (11.0000) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [30/31] time 0.160 (0.180) data 0.082 (0.103) loss_u loss_u 0.8262 (0.8979) acc_u 18.7500 (11.8750) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 488
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 626
clean true:619
clean false:7
clean_rate:0.9888178913738019
noisy true:509
noisy false:481
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 990
epoch [107/200] batch [5/19] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.9951 (0.8270) acc_x 71.8750 (76.2500) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/19] time 0.164 (0.181) data 0.087 (0.105) loss_x loss_x 0.4417 (0.7276) acc_x 90.6250 (80.6250) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/19] time 0.180 (0.176) data 0.103 (0.099) loss_x loss_x 0.7520 (0.7476) acc_x 81.2500 (80.2083) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/30] time 0.169 (0.178) data 0.091 (0.101) loss_u loss_u 0.9502 (0.9159) acc_u 6.2500 (10.6250) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [10/30] time 0.160 (0.177) data 0.083 (0.100) loss_u loss_u 0.8599 (0.9023) acc_u 15.6250 (11.2500) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [15/30] time 0.164 (0.174) data 0.088 (0.098) loss_u loss_u 0.8779 (0.8918) acc_u 12.5000 (12.5000) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/30] time 0.168 (0.174) data 0.090 (0.097) loss_u loss_u 0.9580 (0.8967) acc_u 6.2500 (11.8750) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [25/30] time 0.167 (0.173) data 0.090 (0.096) loss_u loss_u 0.9565 (0.9007) acc_u 3.1250 (11.3750) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [30/30] time 0.161 (0.173) data 0.084 (0.096) loss_u loss_u 0.9526 (0.9043) acc_u 3.1250 (11.0417) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:618
clean false:10
clean_rate:0.9840764331210191
noisy true:504
noisy false:484
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [108/200] batch [5/19] time 0.186 (0.177) data 0.109 (0.100) loss_x loss_x 0.8418 (0.7630) acc_x 81.2500 (81.8750) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/19] time 0.183 (0.180) data 0.107 (0.103) loss_x loss_x 0.5771 (0.6274) acc_x 84.3750 (84.0625) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/19] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.3245 (0.6057) acc_x 90.6250 (85.2083) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/30] time 0.200 (0.184) data 0.123 (0.107) loss_u loss_u 0.8291 (0.9071) acc_u 18.7500 (10.0000) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [10/30] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.8882 (0.9007) acc_u 9.3750 (10.9375) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [15/30] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9814 (0.9115) acc_u 0.0000 (10.0000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [20/30] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9624 (0.9086) acc_u 3.1250 (10.0000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [25/30] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.8789 (0.9100) acc_u 12.5000 (10.1250) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [30/30] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8857 (0.9069) acc_u 15.6250 (10.7292) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 468
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:630
clean false:10
clean_rate:0.984375
noisy true:518
noisy false:458
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [109/200] batch [5/20] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.6079 (0.7221) acc_x 81.2500 (82.5000) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [10/20] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.8159 (0.7085) acc_x 81.2500 (83.1250) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [15/20] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.8994 (0.7592) acc_x 71.8750 (81.0417) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [20/20] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 1.1836 (0.7393) acc_x 62.5000 (80.9375) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/30] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9580 (0.9290) acc_u 3.1250 (7.5000) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [10/30] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8975 (0.9172) acc_u 9.3750 (9.0625) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [15/30] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.9604 (0.9265) acc_u 3.1250 (7.9167) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [20/30] time 0.165 (0.182) data 0.088 (0.105) loss_u loss_u 0.9976 (0.9231) acc_u 0.0000 (8.4375) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [25/30] time 0.169 (0.181) data 0.091 (0.104) loss_u loss_u 0.7949 (0.9169) acc_u 21.8750 (9.1250) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [30/30] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9414 (0.9106) acc_u 6.2500 (10.1042) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 611
clean true:604
clean false:7
clean_rate:0.9885433715220949
noisy true:484
noisy false:521
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 1005
epoch [110/200] batch [5/19] time 0.165 (0.168) data 0.089 (0.092) loss_x loss_x 0.6909 (0.7182) acc_x 81.2500 (81.2500) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [10/19] time 0.180 (0.167) data 0.104 (0.090) loss_x loss_x 0.4597 (0.6822) acc_x 90.6250 (80.9375) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/19] time 0.180 (0.168) data 0.104 (0.092) loss_x loss_x 0.5767 (0.6523) acc_x 81.2500 (82.0833) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/31] time 0.166 (0.169) data 0.089 (0.093) loss_u loss_u 0.9399 (0.8963) acc_u 6.2500 (11.8750) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/31] time 0.170 (0.170) data 0.093 (0.094) loss_u loss_u 0.9155 (0.9033) acc_u 12.5000 (12.5000) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [15/31] time 0.175 (0.170) data 0.098 (0.093) loss_u loss_u 0.8667 (0.9035) acc_u 18.7500 (12.2917) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [20/31] time 0.183 (0.171) data 0.105 (0.094) loss_u loss_u 0.8262 (0.9028) acc_u 21.8750 (12.3438) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [25/31] time 0.183 (0.172) data 0.107 (0.096) loss_u loss_u 0.7993 (0.8999) acc_u 25.0000 (12.6250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [30/31] time 0.182 (0.174) data 0.106 (0.097) loss_u loss_u 0.8687 (0.8971) acc_u 15.6250 (12.8125) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:618
clean false:10
clean_rate:0.9840764331210191
noisy true:498
noisy false:490
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [111/200] batch [5/19] time 0.158 (0.163) data 0.081 (0.086) loss_x loss_x 0.3896 (0.6553) acc_x 96.8750 (84.3750) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [10/19] time 0.183 (0.168) data 0.107 (0.091) loss_x loss_x 0.7544 (0.6289) acc_x 81.2500 (84.6875) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/19] time 0.176 (0.171) data 0.099 (0.094) loss_x loss_x 0.4275 (0.6579) acc_x 84.3750 (84.3750) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/30] time 0.181 (0.174) data 0.103 (0.097) loss_u loss_u 0.9146 (0.8896) acc_u 9.3750 (12.5000) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [10/30] time 0.170 (0.174) data 0.092 (0.097) loss_u loss_u 0.8613 (0.8933) acc_u 15.6250 (12.1875) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [15/30] time 0.170 (0.174) data 0.094 (0.097) loss_u loss_u 0.9263 (0.8986) acc_u 12.5000 (11.8750) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [20/30] time 0.168 (0.173) data 0.092 (0.096) loss_u loss_u 0.9009 (0.9008) acc_u 9.3750 (11.8750) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [25/30] time 0.184 (0.174) data 0.107 (0.097) loss_u loss_u 0.9932 (0.9082) acc_u 0.0000 (11.1250) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [30/30] time 0.185 (0.175) data 0.108 (0.098) loss_u loss_u 0.9043 (0.9085) acc_u 9.3750 (11.0417) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.3843, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 621
clean true:612
clean false:9
clean_rate:0.9855072463768116
noisy true:504
noisy false:491
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 995
epoch [112/200] batch [5/19] time 0.164 (0.165) data 0.087 (0.087) loss_x loss_x 0.8164 (0.5976) acc_x 75.0000 (81.2500) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [10/19] time 0.178 (0.167) data 0.101 (0.089) loss_x loss_x 0.5679 (0.6730) acc_x 84.3750 (81.8750) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [15/19] time 0.172 (0.170) data 0.095 (0.093) loss_x loss_x 0.8730 (0.6568) acc_x 78.1250 (82.2917) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/31] time 0.181 (0.173) data 0.104 (0.096) loss_u loss_u 0.8755 (0.8892) acc_u 15.6250 (12.5000) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/31] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.9224 (0.8914) acc_u 9.3750 (12.8125) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [15/31] time 0.187 (0.177) data 0.109 (0.099) loss_u loss_u 0.9697 (0.8913) acc_u 3.1250 (12.7083) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [20/31] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.8755 (0.8928) acc_u 9.3750 (12.3438) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [25/31] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.9468 (0.8929) acc_u 6.2500 (12.2500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [30/31] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9253 (0.8977) acc_u 9.3750 (11.6667) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 489
confident_label rate tensor(0.3954, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 639
clean true:632
clean false:7
clean_rate:0.9890453834115805
noisy true:495
noisy false:482
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 977
epoch [113/200] batch [5/19] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.2455 (0.5229) acc_x 90.6250 (88.7500) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/19] time 0.184 (0.176) data 0.106 (0.099) loss_x loss_x 1.1758 (0.6487) acc_x 71.8750 (83.4375) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [15/19] time 0.180 (0.177) data 0.104 (0.100) loss_x loss_x 0.7104 (0.6487) acc_x 84.3750 (83.7500) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/30] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.9067 (0.9082) acc_u 12.5000 (11.8750) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/30] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8901 (0.9178) acc_u 9.3750 (9.6875) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [15/30] time 0.186 (0.181) data 0.107 (0.104) loss_u loss_u 0.8896 (0.9243) acc_u 12.5000 (8.9583) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/30] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8730 (0.9214) acc_u 12.5000 (9.0625) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [25/30] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8428 (0.9242) acc_u 15.6250 (8.5000) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [30/30] time 0.182 (0.181) data 0.106 (0.104) loss_u loss_u 0.8984 (0.9210) acc_u 15.6250 (9.0625) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.3967, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 641
clean true:633
clean false:8
clean_rate:0.9875195007800313
noisy true:477
noisy false:498
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 975
epoch [114/200] batch [5/20] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.3657 (0.4468) acc_x 93.7500 (86.8750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/20] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.7876 (0.5740) acc_x 81.2500 (84.3750) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [15/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5122 (0.5685) acc_x 84.3750 (85.4167) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [20/20] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.6094 (0.5879) acc_x 75.0000 (84.2188) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/30] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.8887 (0.9071) acc_u 12.5000 (9.3750) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/30] time 0.177 (0.182) data 0.099 (0.105) loss_u loss_u 0.9004 (0.9039) acc_u 12.5000 (10.3125) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [15/30] time 0.166 (0.181) data 0.089 (0.104) loss_u loss_u 0.9316 (0.9080) acc_u 9.3750 (10.0000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/30] time 0.197 (0.182) data 0.120 (0.105) loss_u loss_u 0.9458 (0.9135) acc_u 6.2500 (9.5312) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [25/30] time 0.158 (0.181) data 0.081 (0.104) loss_u loss_u 0.9492 (0.9129) acc_u 6.2500 (9.7500) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [30/30] time 0.175 (0.180) data 0.097 (0.103) loss_u loss_u 0.9609 (0.9143) acc_u 3.1250 (9.4792) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 509
confident_label rate tensor(0.3861, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 624
clean true:612
clean false:12
clean_rate:0.9807692307692307
noisy true:495
noisy false:497
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 992
epoch [115/200] batch [5/19] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.3816 (0.5964) acc_x 90.6250 (85.0000) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [10/19] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.8901 (0.6375) acc_x 78.1250 (83.7500) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [15/19] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.3967 (0.6238) acc_x 90.6250 (83.5417) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/31] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.9229 (0.9028) acc_u 9.3750 (12.5000) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/31] time 0.191 (0.182) data 0.112 (0.105) loss_u loss_u 0.9443 (0.8964) acc_u 6.2500 (12.5000) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [15/31] time 0.169 (0.181) data 0.092 (0.104) loss_u loss_u 0.7856 (0.8879) acc_u 25.0000 (13.3333) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [20/31] time 0.178 (0.181) data 0.100 (0.104) loss_u loss_u 0.8833 (0.8919) acc_u 12.5000 (12.6562) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [25/31] time 0.158 (0.179) data 0.082 (0.102) loss_u loss_u 0.8364 (0.8892) acc_u 21.8750 (12.8750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [30/31] time 0.165 (0.178) data 0.088 (0.101) loss_u loss_u 0.9180 (0.8958) acc_u 9.3750 (12.0833) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.3979, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 643
clean true:635
clean false:8
clean_rate:0.9875583203732504
noisy true:522
noisy false:451
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 973
epoch [116/200] batch [5/20] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.3799 (0.7997) acc_x 90.6250 (81.2500) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/20] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.8174 (0.6889) acc_x 75.0000 (80.9375) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [15/20] time 0.181 (0.182) data 0.103 (0.105) loss_x loss_x 1.0430 (0.7446) acc_x 71.8750 (81.0417) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [20/20] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.4663 (0.7153) acc_x 87.5000 (82.5000) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/30] time 0.191 (0.183) data 0.114 (0.106) loss_u loss_u 0.9014 (0.8971) acc_u 12.5000 (12.5000) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [10/30] time 0.168 (0.182) data 0.090 (0.105) loss_u loss_u 0.8794 (0.8977) acc_u 15.6250 (13.4375) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [15/30] time 0.171 (0.180) data 0.095 (0.103) loss_u loss_u 0.9463 (0.9154) acc_u 6.2500 (10.8333) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [20/30] time 0.186 (0.181) data 0.108 (0.105) loss_u loss_u 0.9604 (0.9186) acc_u 6.2500 (10.4688) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [25/30] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.9600 (0.9123) acc_u 6.2500 (11.0000) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [30/30] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.9629 (0.9123) acc_u 3.1250 (10.7292) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:620
clean false:8
clean_rate:0.9872611464968153
noisy true:496
noisy false:492
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [117/200] batch [5/19] time 0.212 (0.194) data 0.135 (0.117) loss_x loss_x 0.5415 (0.5239) acc_x 78.1250 (82.5000) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/19] time 0.182 (0.188) data 0.105 (0.112) loss_x loss_x 0.9858 (0.5782) acc_x 65.6250 (80.9375) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [15/19] time 0.186 (0.187) data 0.108 (0.111) loss_x loss_x 0.5835 (0.5911) acc_x 84.3750 (81.2500) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/30] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9009 (0.8977) acc_u 9.3750 (11.2500) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [10/30] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9321 (0.8976) acc_u 6.2500 (11.5625) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [15/30] time 0.157 (0.182) data 0.080 (0.105) loss_u loss_u 0.9673 (0.9092) acc_u 3.1250 (10.4167) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [20/30] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.9004 (0.9072) acc_u 9.3750 (10.6250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [25/30] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8833 (0.9103) acc_u 12.5000 (10.6250) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [30/30] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.9956 (0.9121) acc_u 0.0000 (10.3125) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 485
confident_label rate tensor(0.3936, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 636
clean true:628
clean false:8
clean_rate:0.9874213836477987
noisy true:503
noisy false:477
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 980
epoch [118/200] batch [5/19] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.2368 (0.5300) acc_x 93.7500 (89.3750) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/19] time 0.269 (0.192) data 0.192 (0.115) loss_x loss_x 0.4316 (0.5007) acc_x 90.6250 (89.0625) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [15/19] time 0.181 (0.189) data 0.105 (0.112) loss_x loss_x 0.9307 (0.5486) acc_x 78.1250 (87.5000) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/30] time 0.180 (0.186) data 0.104 (0.110) loss_u loss_u 0.9780 (0.9427) acc_u 3.1250 (6.8750) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/30] time 0.180 (0.185) data 0.103 (0.108) loss_u loss_u 0.8438 (0.9229) acc_u 18.7500 (8.7500) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [15/30] time 0.171 (0.184) data 0.095 (0.107) loss_u loss_u 0.9634 (0.9171) acc_u 3.1250 (9.5833) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/30] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9087 (0.9204) acc_u 9.3750 (9.0625) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [25/30] time 0.183 (0.184) data 0.107 (0.107) loss_u loss_u 0.8311 (0.9108) acc_u 21.8750 (10.5000) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [30/30] time 0.191 (0.184) data 0.114 (0.107) loss_u loss_u 0.8955 (0.9063) acc_u 12.5000 (11.0417) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 617
clean true:609
clean false:8
clean_rate:0.9870340356564019
noisy true:485
noisy false:514
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 999
epoch [119/200] batch [5/19] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 0.5342 (0.6096) acc_x 84.3750 (81.2500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/19] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.5444 (0.6098) acc_x 81.2500 (81.8750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [15/19] time 0.161 (0.176) data 0.083 (0.099) loss_x loss_x 0.6113 (0.5927) acc_x 87.5000 (83.5417) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/31] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.9966 (0.9489) acc_u 0.0000 (5.0000) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/31] time 0.166 (0.178) data 0.090 (0.101) loss_u loss_u 0.9033 (0.9233) acc_u 12.5000 (8.4375) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [15/31] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9009 (0.9118) acc_u 12.5000 (9.7917) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [20/31] time 0.163 (0.177) data 0.084 (0.100) loss_u loss_u 0.8271 (0.8997) acc_u 18.7500 (11.4062) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [25/31] time 0.163 (0.176) data 0.086 (0.099) loss_u loss_u 0.8018 (0.8962) acc_u 21.8750 (11.7500) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [30/31] time 0.180 (0.176) data 0.103 (0.099) loss_u loss_u 0.9253 (0.9002) acc_u 9.3750 (11.4583) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 461
confident_label rate tensor(0.3942, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 637
clean true:631
clean false:6
clean_rate:0.9905808477237049
noisy true:524
noisy false:455
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 979
epoch [120/200] batch [5/19] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.6274 (0.6260) acc_x 78.1250 (81.8750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/19] time 0.169 (0.175) data 0.093 (0.098) loss_x loss_x 0.7373 (0.7010) acc_x 78.1250 (81.8750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [15/19] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 0.4526 (0.6428) acc_x 87.5000 (82.7083) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/30] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8970 (0.9323) acc_u 12.5000 (8.1250) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/30] time 0.168 (0.176) data 0.092 (0.100) loss_u loss_u 0.8999 (0.9206) acc_u 12.5000 (9.3750) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [15/30] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.8525 (0.9143) acc_u 12.5000 (9.7917) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [20/30] time 0.167 (0.175) data 0.089 (0.098) loss_u loss_u 0.9141 (0.9182) acc_u 12.5000 (9.5312) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [25/30] time 0.159 (0.173) data 0.082 (0.096) loss_u loss_u 0.8965 (0.9163) acc_u 9.3750 (9.6250) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [30/30] time 0.194 (0.175) data 0.118 (0.098) loss_u loss_u 0.8682 (0.9103) acc_u 21.8750 (10.7292) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 485
confident_label rate tensor(0.3923, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 634
clean true:624
clean false:10
clean_rate:0.9842271293375394
noisy true:507
noisy false:475
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 982
epoch [121/200] batch [5/19] time 0.183 (0.188) data 0.106 (0.112) loss_x loss_x 0.5254 (0.7430) acc_x 90.6250 (81.8750) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [10/19] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5254 (0.6249) acc_x 87.5000 (84.6875) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [15/19] time 0.173 (0.182) data 0.096 (0.105) loss_x loss_x 0.2510 (0.5495) acc_x 96.8750 (86.2500) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/30] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9297 (0.9138) acc_u 9.3750 (11.8750) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/30] time 0.188 (0.184) data 0.111 (0.107) loss_u loss_u 0.8320 (0.8986) acc_u 21.8750 (12.5000) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [15/30] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9907 (0.9050) acc_u 3.1250 (11.8750) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [20/30] time 0.179 (0.184) data 0.103 (0.106) loss_u loss_u 0.8623 (0.9044) acc_u 15.6250 (11.8750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [25/30] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.9424 (0.9090) acc_u 6.2500 (11.2500) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [30/30] time 0.188 (0.183) data 0.111 (0.106) loss_u loss_u 0.9409 (0.9084) acc_u 6.2500 (11.1458) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 617
clean true:605
clean false:12
clean_rate:0.9805510534846029
noisy true:499
noisy false:500
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 999
epoch [122/200] batch [5/19] time 0.190 (0.188) data 0.114 (0.111) loss_x loss_x 0.5469 (0.6610) acc_x 81.2500 (82.5000) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [10/19] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.4810 (0.7007) acc_x 93.7500 (81.8750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [15/19] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.4226 (0.6603) acc_x 90.6250 (83.7500) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/31] time 0.168 (0.181) data 0.090 (0.104) loss_u loss_u 0.8818 (0.8974) acc_u 15.6250 (12.5000) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/31] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.9443 (0.9004) acc_u 6.2500 (11.8750) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [15/31] time 0.162 (0.176) data 0.085 (0.099) loss_u loss_u 0.8979 (0.9018) acc_u 12.5000 (11.6667) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [20/31] time 0.168 (0.175) data 0.090 (0.098) loss_u loss_u 0.8242 (0.8967) acc_u 21.8750 (12.3438) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [25/31] time 0.167 (0.174) data 0.090 (0.097) loss_u loss_u 0.8628 (0.8953) acc_u 15.6250 (12.3750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [30/31] time 0.159 (0.174) data 0.083 (0.097) loss_u loss_u 0.8110 (0.8896) acc_u 21.8750 (12.9167) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 481
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:620
clean false:8
clean_rate:0.9872611464968153
noisy true:515
noisy false:473
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [123/200] batch [5/19] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 1.1328 (0.8649) acc_x 71.8750 (77.5000) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/19] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.5122 (0.7492) acc_x 87.5000 (80.6250) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [15/19] time 0.169 (0.181) data 0.093 (0.104) loss_x loss_x 0.4138 (0.6801) acc_x 87.5000 (82.7083) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/30] time 0.189 (0.181) data 0.111 (0.104) loss_u loss_u 0.8926 (0.9052) acc_u 15.6250 (12.5000) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/30] time 0.161 (0.178) data 0.084 (0.101) loss_u loss_u 0.8994 (0.8998) acc_u 12.5000 (12.1875) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [15/30] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8848 (0.9051) acc_u 15.6250 (11.8750) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [20/30] time 0.185 (0.180) data 0.109 (0.103) loss_u loss_u 0.9165 (0.8988) acc_u 9.3750 (12.0312) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [25/30] time 0.178 (0.180) data 0.100 (0.103) loss_u loss_u 0.8662 (0.9025) acc_u 15.6250 (11.5000) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [30/30] time 0.187 (0.180) data 0.109 (0.103) loss_u loss_u 0.8940 (0.9011) acc_u 12.5000 (11.5625) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 488
confident_label rate tensor(0.3985, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 644
clean true:634
clean false:10
clean_rate:0.984472049689441
noisy true:494
noisy false:478
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 972
epoch [124/200] batch [5/20] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.5850 (0.6639) acc_x 84.3750 (82.5000) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [10/20] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.4885 (0.6477) acc_x 84.3750 (81.5625) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [15/20] time 0.184 (0.181) data 0.106 (0.104) loss_x loss_x 0.3357 (0.6585) acc_x 90.6250 (82.2917) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [20/20] time 0.185 (0.181) data 0.108 (0.105) loss_x loss_x 0.6582 (0.6612) acc_x 84.3750 (82.1875) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/30] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8350 (0.9005) acc_u 15.6250 (10.0000) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/30] time 0.188 (0.183) data 0.111 (0.106) loss_u loss_u 0.8677 (0.9083) acc_u 15.6250 (9.6875) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [15/30] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.9307 (0.9109) acc_u 6.2500 (10.0000) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [20/30] time 0.178 (0.182) data 0.101 (0.104) loss_u loss_u 0.9067 (0.9102) acc_u 9.3750 (10.0000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [25/30] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.9043 (0.9057) acc_u 9.3750 (10.7500) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [30/30] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8867 (0.9032) acc_u 12.5000 (11.3542) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.4016, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 649
clean true:642
clean false:7
clean_rate:0.9892141756548536
noisy true:515
noisy false:452
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 967
epoch [125/200] batch [5/20] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5703 (0.6280) acc_x 84.3750 (85.6250) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [10/20] time 0.165 (0.181) data 0.089 (0.104) loss_x loss_x 0.6079 (0.5945) acc_x 87.5000 (85.6250) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [15/20] time 0.159 (0.175) data 0.082 (0.099) loss_x loss_x 1.1191 (0.6358) acc_x 81.2500 (85.0000) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [20/20] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.3430 (0.6463) acc_x 90.6250 (84.3750) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/30] time 0.160 (0.174) data 0.083 (0.097) loss_u loss_u 0.9102 (0.9099) acc_u 12.5000 (10.6250) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/30] time 0.170 (0.174) data 0.092 (0.097) loss_u loss_u 0.9956 (0.9177) acc_u 0.0000 (9.3750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [15/30] time 0.174 (0.175) data 0.096 (0.098) loss_u loss_u 0.8799 (0.9214) acc_u 12.5000 (9.1667) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/30] time 0.172 (0.174) data 0.095 (0.097) loss_u loss_u 0.8452 (0.9121) acc_u 18.7500 (10.4688) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [25/30] time 0.183 (0.175) data 0.105 (0.098) loss_u loss_u 0.9399 (0.9106) acc_u 6.2500 (10.6250) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [30/30] time 0.163 (0.174) data 0.086 (0.097) loss_u loss_u 0.9570 (0.9122) acc_u 6.2500 (10.3125) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 455
confident_label rate tensor(0.4010, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 648
clean true:639
clean false:9
clean_rate:0.9861111111111112
noisy true:522
noisy false:446
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 968
epoch [126/200] batch [5/20] time 0.180 (0.177) data 0.104 (0.100) loss_x loss_x 0.4612 (0.5405) acc_x 87.5000 (86.8750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [10/20] time 0.183 (0.177) data 0.106 (0.101) loss_x loss_x 0.4270 (0.5037) acc_x 90.6250 (87.1875) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [15/20] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.2930 (0.5324) acc_x 93.7500 (85.8333) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [20/20] time 0.185 (0.181) data 0.108 (0.105) loss_x loss_x 0.4290 (0.5239) acc_x 87.5000 (85.6250) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/30] time 0.163 (0.179) data 0.085 (0.102) loss_u loss_u 0.8564 (0.9024) acc_u 21.8750 (11.8750) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/30] time 0.182 (0.179) data 0.106 (0.102) loss_u loss_u 0.9385 (0.9227) acc_u 6.2500 (9.0625) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [15/30] time 0.180 (0.178) data 0.102 (0.101) loss_u loss_u 0.8965 (0.9199) acc_u 9.3750 (9.3750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/30] time 0.175 (0.178) data 0.097 (0.101) loss_u loss_u 0.8936 (0.9176) acc_u 15.6250 (10.0000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [25/30] time 0.170 (0.177) data 0.092 (0.100) loss_u loss_u 0.8398 (0.9166) acc_u 15.6250 (9.8750) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [30/30] time 0.180 (0.178) data 0.102 (0.100) loss_u loss_u 0.9360 (0.9211) acc_u 6.2500 (9.1667) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 470
confident_label rate tensor(0.3991, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 645
clean true:641
clean false:4
clean_rate:0.993798449612403
noisy true:505
noisy false:466
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 971
epoch [127/200] batch [5/20] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.6504 (0.6555) acc_x 84.3750 (83.1250) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [10/20] time 0.174 (0.181) data 0.098 (0.104) loss_x loss_x 0.4688 (0.5622) acc_x 93.7500 (86.8750) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [15/20] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.3408 (0.5329) acc_x 90.6250 (87.9167) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [20/20] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.6523 (0.5390) acc_x 87.5000 (87.8125) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/30] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.9126 (0.9037) acc_u 9.3750 (11.2500) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/30] time 0.160 (0.174) data 0.082 (0.097) loss_u loss_u 0.9180 (0.9082) acc_u 12.5000 (10.6250) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [15/30] time 0.190 (0.176) data 0.112 (0.098) loss_u loss_u 0.9146 (0.9153) acc_u 9.3750 (9.7917) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [20/30] time 0.193 (0.176) data 0.116 (0.099) loss_u loss_u 0.8247 (0.9104) acc_u 18.7500 (10.6250) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [25/30] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.9194 (0.9104) acc_u 9.3750 (10.5000) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [30/30] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.8521 (0.9071) acc_u 15.6250 (10.7292) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 478
confident_label rate tensor(0.3942, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 637
clean true:626
clean false:11
clean_rate:0.9827315541601256
noisy true:512
noisy false:467
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 979
epoch [128/200] batch [5/19] time 0.165 (0.173) data 0.088 (0.096) loss_x loss_x 0.5103 (0.5540) acc_x 84.3750 (85.0000) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [10/19] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.3696 (0.5447) acc_x 90.6250 (86.5625) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [15/19] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.5688 (0.5893) acc_x 81.2500 (85.4167) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/30] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.8994 (0.9133) acc_u 12.5000 (11.2500) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [10/30] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.7666 (0.9002) acc_u 28.1250 (11.8750) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [15/30] time 0.175 (0.180) data 0.097 (0.103) loss_u loss_u 0.8882 (0.9018) acc_u 12.5000 (11.4583) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [20/30] time 0.173 (0.180) data 0.096 (0.102) loss_u loss_u 0.8022 (0.8999) acc_u 25.0000 (12.0312) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [25/30] time 0.191 (0.180) data 0.114 (0.102) loss_u loss_u 0.9053 (0.9058) acc_u 15.6250 (11.6250) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [30/30] time 0.166 (0.179) data 0.089 (0.101) loss_u loss_u 0.9102 (0.9048) acc_u 9.3750 (11.5625) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 492
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:623
clean false:5
clean_rate:0.9920382165605095
noisy true:501
noisy false:487
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [129/200] batch [5/19] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 0.5762 (0.5915) acc_x 75.0000 (81.8750) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/19] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.3220 (0.5685) acc_x 90.6250 (84.3750) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [15/19] time 0.184 (0.179) data 0.106 (0.102) loss_x loss_x 0.5415 (0.5288) acc_x 84.3750 (85.8333) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/30] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9248 (0.9187) acc_u 9.3750 (10.6250) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [10/30] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9507 (0.9043) acc_u 6.2500 (11.5625) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [15/30] time 0.194 (0.181) data 0.118 (0.104) loss_u loss_u 0.8657 (0.9042) acc_u 15.6250 (11.4583) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [20/30] time 0.179 (0.181) data 0.103 (0.104) loss_u loss_u 0.8828 (0.9125) acc_u 12.5000 (10.4688) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [25/30] time 0.166 (0.181) data 0.090 (0.104) loss_u loss_u 0.8789 (0.9069) acc_u 15.6250 (11.5000) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [30/30] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.8784 (0.9017) acc_u 15.6250 (12.0833) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 450
confident_label rate tensor(0.4152, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 671
clean true:660
clean false:11
clean_rate:0.9836065573770492
noisy true:506
noisy false:439
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 945
epoch [130/200] batch [5/20] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.7881 (0.6829) acc_x 78.1250 (81.2500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [10/20] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.6743 (0.6407) acc_x 78.1250 (82.1875) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [15/20] time 0.159 (0.178) data 0.082 (0.101) loss_x loss_x 0.6987 (0.6372) acc_x 84.3750 (83.3333) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [20/20] time 0.190 (0.175) data 0.112 (0.098) loss_x loss_x 1.0029 (0.6429) acc_x 81.2500 (83.4375) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/29] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9448 (0.9167) acc_u 6.2500 (8.7500) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [10/29] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.9985 (0.9160) acc_u 0.0000 (9.3750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [15/29] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9385 (0.9231) acc_u 6.2500 (8.5417) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [20/29] time 0.183 (0.181) data 0.105 (0.103) loss_u loss_u 0.9297 (0.9226) acc_u 9.3750 (8.9062) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [25/29] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.9058 (0.9215) acc_u 12.5000 (9.0000) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.4053, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 655
clean true:645
clean false:10
clean_rate:0.9847328244274809
noisy true:500
noisy false:461
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 961
epoch [131/200] batch [5/20] time 0.183 (0.200) data 0.107 (0.123) loss_x loss_x 0.6826 (0.8105) acc_x 81.2500 (80.6250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/20] time 0.160 (0.185) data 0.084 (0.108) loss_x loss_x 0.3789 (0.6981) acc_x 90.6250 (83.1250) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [15/20] time 0.170 (0.178) data 0.094 (0.102) loss_x loss_x 0.7856 (0.6592) acc_x 90.6250 (84.3750) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [20/20] time 0.170 (0.176) data 0.094 (0.100) loss_x loss_x 0.4375 (0.6553) acc_x 87.5000 (84.0625) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/30] time 0.160 (0.175) data 0.082 (0.098) loss_u loss_u 0.9297 (0.9062) acc_u 9.3750 (10.0000) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/30] time 0.169 (0.174) data 0.092 (0.097) loss_u loss_u 0.9214 (0.9217) acc_u 9.3750 (8.7500) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [15/30] time 0.183 (0.173) data 0.105 (0.096) loss_u loss_u 0.9004 (0.9209) acc_u 9.3750 (9.3750) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/30] time 0.168 (0.173) data 0.091 (0.096) loss_u loss_u 0.8252 (0.9133) acc_u 25.0000 (10.1562) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [25/30] time 0.168 (0.172) data 0.090 (0.095) loss_u loss_u 0.9321 (0.9189) acc_u 9.3750 (9.6250) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [30/30] time 0.172 (0.173) data 0.095 (0.096) loss_u loss_u 0.9282 (0.9164) acc_u 6.2500 (9.7917) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 507
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 619
clean true:612
clean false:7
clean_rate:0.9886914378029079
noisy true:497
noisy false:500
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 997
epoch [132/200] batch [5/19] time 0.192 (0.177) data 0.115 (0.101) loss_x loss_x 0.3206 (0.4757) acc_x 93.7500 (88.1250) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/19] time 0.168 (0.176) data 0.091 (0.100) loss_x loss_x 0.6509 (0.5124) acc_x 84.3750 (87.8125) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/19] time 0.184 (0.177) data 0.108 (0.101) loss_x loss_x 0.4656 (0.5563) acc_x 87.5000 (86.6667) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/31] time 0.174 (0.177) data 0.096 (0.100) loss_u loss_u 0.8623 (0.8899) acc_u 15.6250 (13.7500) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/31] time 0.173 (0.176) data 0.096 (0.100) loss_u loss_u 0.8311 (0.8888) acc_u 21.8750 (13.1250) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [15/31] time 0.176 (0.175) data 0.098 (0.098) loss_u loss_u 0.8848 (0.8868) acc_u 12.5000 (12.9167) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [20/31] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.8955 (0.8903) acc_u 12.5000 (12.3438) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [25/31] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9316 (0.8930) acc_u 12.5000 (12.3750) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [30/31] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9282 (0.8967) acc_u 9.3750 (11.8750) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 452
confident_label rate tensor(0.4146, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 670
clean true:657
clean false:13
clean_rate:0.9805970149253731
noisy true:507
noisy false:439
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 946
epoch [133/200] batch [5/20] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.3279 (0.4871) acc_x 93.7500 (86.8750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/20] time 0.184 (0.177) data 0.107 (0.101) loss_x loss_x 0.4983 (0.4374) acc_x 87.5000 (89.0625) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [15/20] time 0.187 (0.177) data 0.111 (0.101) loss_x loss_x 0.3943 (0.5157) acc_x 90.6250 (87.2917) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [20/20] time 0.180 (0.178) data 0.103 (0.102) loss_x loss_x 0.5322 (0.5185) acc_x 81.2500 (86.5625) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/29] time 0.178 (0.179) data 0.101 (0.103) loss_u loss_u 0.9189 (0.9380) acc_u 9.3750 (6.2500) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/29] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.8862 (0.9221) acc_u 12.5000 (8.1250) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [15/29] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8965 (0.9225) acc_u 12.5000 (8.1250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/29] time 0.190 (0.181) data 0.113 (0.104) loss_u loss_u 0.9463 (0.9222) acc_u 6.2500 (8.4375) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [25/29] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.8833 (0.9241) acc_u 12.5000 (8.3750) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 495
confident_label rate tensor(0.3917, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 633
clean true:616
clean false:17
clean_rate:0.9731437598736177
noisy true:505
noisy false:478
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 983
epoch [134/200] batch [5/19] time 0.180 (0.173) data 0.103 (0.096) loss_x loss_x 0.7754 (0.6101) acc_x 78.1250 (82.5000) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/19] time 0.190 (0.175) data 0.113 (0.098) loss_x loss_x 0.1449 (0.5442) acc_x 96.8750 (84.3750) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [15/19] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.7886 (0.5891) acc_x 81.2500 (83.9583) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/30] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9341 (0.9162) acc_u 6.2500 (10.0000) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [10/30] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9473 (0.9200) acc_u 6.2500 (9.6875) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [15/30] time 0.170 (0.181) data 0.092 (0.104) loss_u loss_u 0.8936 (0.9098) acc_u 9.3750 (10.6250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/30] time 0.163 (0.178) data 0.086 (0.101) loss_u loss_u 0.9585 (0.9037) acc_u 3.1250 (11.0938) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [25/30] time 0.163 (0.177) data 0.087 (0.100) loss_u loss_u 0.8965 (0.9019) acc_u 12.5000 (11.3750) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [30/30] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.9072 (0.9025) acc_u 9.3750 (11.3542) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.4016, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 649
clean true:637
clean false:12
clean_rate:0.9815100154083205
noisy true:489
noisy false:478
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 967
epoch [135/200] batch [5/20] time 0.179 (0.186) data 0.102 (0.110) loss_x loss_x 0.3611 (0.4418) acc_x 87.5000 (88.1250) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [10/20] time 0.177 (0.178) data 0.100 (0.101) loss_x loss_x 0.6982 (0.4655) acc_x 87.5000 (87.8125) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [15/20] time 0.160 (0.175) data 0.083 (0.098) loss_x loss_x 0.7549 (0.5127) acc_x 84.3750 (86.8750) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [20/20] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.5918 (0.5291) acc_x 81.2500 (86.5625) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/30] time 0.161 (0.174) data 0.084 (0.097) loss_u loss_u 0.9189 (0.9392) acc_u 9.3750 (6.8750) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [10/30] time 0.161 (0.172) data 0.083 (0.095) loss_u loss_u 0.9116 (0.9300) acc_u 9.3750 (8.1250) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [15/30] time 0.179 (0.172) data 0.102 (0.094) loss_u loss_u 0.9746 (0.9344) acc_u 3.1250 (7.9167) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [20/30] time 0.183 (0.173) data 0.106 (0.096) loss_u loss_u 0.8574 (0.9274) acc_u 15.6250 (8.7500) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [25/30] time 0.183 (0.174) data 0.107 (0.097) loss_u loss_u 0.9502 (0.9228) acc_u 6.2500 (9.1250) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [30/30] time 0.182 (0.175) data 0.105 (0.098) loss_u loss_u 0.8062 (0.9131) acc_u 21.8750 (10.2083) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 473
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:633
clean false:7
clean_rate:0.9890625
noisy true:510
noisy false:466
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [136/200] batch [5/20] time 0.189 (0.183) data 0.111 (0.107) loss_x loss_x 0.4036 (0.5858) acc_x 87.5000 (83.1250) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [10/20] time 0.182 (0.183) data 0.104 (0.106) loss_x loss_x 0.6577 (0.5704) acc_x 75.0000 (81.8750) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [15/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.3933 (0.5922) acc_x 90.6250 (83.1250) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [20/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 1.3135 (0.6600) acc_x 59.3750 (81.0938) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/30] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9194 (0.9073) acc_u 9.3750 (8.7500) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/30] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9521 (0.9057) acc_u 6.2500 (9.6875) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [15/30] time 0.168 (0.181) data 0.091 (0.105) loss_u loss_u 0.8809 (0.9115) acc_u 12.5000 (9.1667) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/30] time 0.158 (0.180) data 0.081 (0.103) loss_u loss_u 0.8828 (0.9027) acc_u 15.6250 (10.3125) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [25/30] time 0.159 (0.177) data 0.083 (0.101) loss_u loss_u 0.8931 (0.9027) acc_u 12.5000 (10.6250) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [30/30] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.8711 (0.9015) acc_u 12.5000 (10.9375) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 478
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 659
clean true:649
clean false:10
clean_rate:0.9848254931714719
noisy true:489
noisy false:468
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 957
epoch [137/200] batch [5/20] time 0.181 (0.180) data 0.105 (0.103) loss_x loss_x 0.8608 (0.7230) acc_x 78.1250 (80.6250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/20] time 0.157 (0.173) data 0.081 (0.096) loss_x loss_x 0.7173 (0.6694) acc_x 81.2500 (82.1875) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [15/20] time 0.158 (0.174) data 0.082 (0.097) loss_x loss_x 1.0527 (0.6790) acc_x 62.5000 (81.2500) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [20/20] time 0.183 (0.173) data 0.107 (0.097) loss_x loss_x 0.8135 (0.6955) acc_x 78.1250 (81.2500) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/29] time 0.184 (0.173) data 0.107 (0.096) loss_u loss_u 0.8857 (0.9119) acc_u 12.5000 (9.3750) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/29] time 0.189 (0.174) data 0.111 (0.097) loss_u loss_u 0.8628 (0.9003) acc_u 18.7500 (11.2500) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [15/29] time 0.185 (0.176) data 0.107 (0.099) loss_u loss_u 0.9648 (0.9004) acc_u 3.1250 (11.4583) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [20/29] time 0.178 (0.177) data 0.100 (0.100) loss_u loss_u 0.8784 (0.9119) acc_u 12.5000 (10.1562) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [25/29] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.8906 (0.9138) acc_u 12.5000 (10.0000) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 475
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:631
clean false:9
clean_rate:0.9859375
noisy true:510
noisy false:466
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [138/200] batch [5/20] time 0.174 (0.173) data 0.098 (0.097) loss_x loss_x 0.8652 (0.5096) acc_x 81.2500 (89.3750) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/20] time 0.171 (0.173) data 0.093 (0.096) loss_x loss_x 0.4062 (0.5126) acc_x 87.5000 (87.1875) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/20] time 0.183 (0.174) data 0.107 (0.097) loss_x loss_x 0.3909 (0.5834) acc_x 87.5000 (86.4583) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [20/20] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 0.6274 (0.5665) acc_x 84.3750 (86.5625) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/30] time 0.160 (0.171) data 0.083 (0.094) loss_u loss_u 0.9160 (0.8977) acc_u 9.3750 (11.2500) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/30] time 0.184 (0.170) data 0.107 (0.093) loss_u loss_u 0.8369 (0.8959) acc_u 18.7500 (12.5000) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [15/30] time 0.186 (0.172) data 0.107 (0.095) loss_u loss_u 0.9736 (0.9087) acc_u 3.1250 (10.8333) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [20/30] time 0.169 (0.173) data 0.092 (0.096) loss_u loss_u 0.8784 (0.8981) acc_u 12.5000 (11.7188) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [25/30] time 0.179 (0.173) data 0.102 (0.096) loss_u loss_u 0.8018 (0.8957) acc_u 18.7500 (11.6250) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [30/30] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.8838 (0.8997) acc_u 12.5000 (11.2500) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 446
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 673
clean true:664
clean false:9
clean_rate:0.986627043090639
noisy true:506
noisy false:437
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 943
epoch [139/200] batch [5/21] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 0.4973 (0.4796) acc_x 81.2500 (85.0000) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [10/21] time 0.172 (0.174) data 0.096 (0.097) loss_x loss_x 0.4746 (0.6048) acc_x 87.5000 (84.3750) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [15/21] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.5591 (0.5705) acc_x 84.3750 (85.8333) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/21] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 1.1670 (0.6029) acc_x 75.0000 (85.3125) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/29] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.9229 (0.9060) acc_u 12.5000 (11.8750) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [10/29] time 0.192 (0.181) data 0.115 (0.104) loss_u loss_u 0.8677 (0.9131) acc_u 15.6250 (10.3125) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [15/29] time 0.199 (0.182) data 0.122 (0.105) loss_u loss_u 0.9033 (0.9040) acc_u 9.3750 (10.8333) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [20/29] time 0.181 (0.182) data 0.105 (0.105) loss_u loss_u 0.9204 (0.9122) acc_u 9.3750 (9.8438) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [25/29] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9385 (0.9184) acc_u 6.2500 (9.1250) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 473
confident_label rate tensor(0.4041, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 653
clean true:643
clean false:10
clean_rate:0.9846860643185299
noisy true:500
noisy false:463
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 963
epoch [140/200] batch [5/20] time 0.169 (0.180) data 0.092 (0.103) loss_x loss_x 0.7549 (0.6397) acc_x 78.1250 (82.5000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/20] time 0.161 (0.176) data 0.084 (0.100) loss_x loss_x 0.4146 (0.5487) acc_x 87.5000 (85.6250) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/20] time 0.185 (0.174) data 0.108 (0.097) loss_x loss_x 0.6406 (0.5218) acc_x 87.5000 (86.6667) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [20/20] time 0.180 (0.176) data 0.104 (0.099) loss_x loss_x 0.8311 (0.5752) acc_x 75.0000 (84.8438) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/30] time 0.176 (0.177) data 0.099 (0.100) loss_u loss_u 0.9531 (0.9091) acc_u 6.2500 (11.2500) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/30] time 0.177 (0.175) data 0.100 (0.098) loss_u loss_u 0.8784 (0.9108) acc_u 12.5000 (10.3125) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [15/30] time 0.173 (0.175) data 0.096 (0.098) loss_u loss_u 0.8696 (0.9088) acc_u 12.5000 (10.6250) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/30] time 0.189 (0.175) data 0.112 (0.098) loss_u loss_u 0.9683 (0.9037) acc_u 3.1250 (11.0938) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [25/30] time 0.184 (0.175) data 0.106 (0.098) loss_u loss_u 0.9243 (0.9091) acc_u 9.3750 (10.5000) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [30/30] time 0.171 (0.175) data 0.095 (0.098) loss_u loss_u 0.9111 (0.9100) acc_u 12.5000 (10.6250) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 446
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 673
clean true:659
clean false:14
clean_rate:0.9791976225854383
noisy true:511
noisy false:432
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 943
epoch [141/200] batch [5/21] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.5020 (0.6816) acc_x 84.3750 (83.7500) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [10/21] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.4343 (0.6194) acc_x 84.3750 (84.0625) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [15/21] time 0.183 (0.177) data 0.107 (0.100) loss_x loss_x 0.5166 (0.5850) acc_x 84.3750 (85.0000) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/21] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.7461 (0.5774) acc_x 84.3750 (85.4688) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/29] time 0.185 (0.180) data 0.109 (0.103) loss_u loss_u 0.9517 (0.9374) acc_u 6.2500 (8.1250) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/29] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9707 (0.9300) acc_u 3.1250 (8.7500) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [15/29] time 0.187 (0.182) data 0.109 (0.105) loss_u loss_u 0.9658 (0.9321) acc_u 6.2500 (8.1250) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [20/29] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8726 (0.9289) acc_u 12.5000 (8.4375) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [25/29] time 0.166 (0.181) data 0.090 (0.104) loss_u loss_u 0.9395 (0.9287) acc_u 6.2500 (8.3750) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 474
confident_label rate tensor(0.4041, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 653
clean true:638
clean false:15
clean_rate:0.9770290964777948
noisy true:504
noisy false:459
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 963
epoch [142/200] batch [5/20] time 0.159 (0.175) data 0.083 (0.099) loss_x loss_x 0.5225 (0.4531) acc_x 87.5000 (88.7500) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [10/20] time 0.167 (0.177) data 0.090 (0.101) loss_x loss_x 0.4055 (0.5122) acc_x 90.6250 (86.5625) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [15/20] time 0.189 (0.173) data 0.112 (0.096) loss_x loss_x 1.2764 (0.5962) acc_x 71.8750 (85.0000) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [20/20] time 0.178 (0.175) data 0.102 (0.098) loss_x loss_x 0.8320 (0.6091) acc_x 75.0000 (84.0625) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/30] time 0.177 (0.175) data 0.100 (0.098) loss_u loss_u 0.9185 (0.9001) acc_u 9.3750 (11.2500) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [10/30] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.8750 (0.9177) acc_u 12.5000 (8.7500) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [15/30] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9351 (0.9245) acc_u 12.5000 (8.7500) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [20/30] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.8574 (0.8994) acc_u 18.7500 (12.0312) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [25/30] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9009 (0.9047) acc_u 9.3750 (11.2500) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [30/30] time 0.185 (0.179) data 0.109 (0.102) loss_u loss_u 0.9526 (0.9060) acc_u 6.2500 (11.2500) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 659
clean true:644
clean false:15
clean_rate:0.9772382397572079
noisy true:513
noisy false:444
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 957
epoch [143/200] batch [5/20] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.5713 (0.5832) acc_x 87.5000 (85.6250) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/20] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.4473 (0.5815) acc_x 87.5000 (85.3125) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [15/20] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.9180 (0.6282) acc_x 68.7500 (82.7083) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [20/20] time 0.182 (0.177) data 0.106 (0.101) loss_x loss_x 0.5103 (0.6171) acc_x 84.3750 (83.1250) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/29] time 0.185 (0.179) data 0.108 (0.103) loss_u loss_u 0.8569 (0.8710) acc_u 15.6250 (13.7500) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/29] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8936 (0.8970) acc_u 12.5000 (11.5625) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [15/29] time 0.181 (0.180) data 0.103 (0.104) loss_u loss_u 0.8984 (0.9063) acc_u 12.5000 (11.0417) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/29] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9648 (0.9123) acc_u 3.1250 (10.1562) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [25/29] time 0.183 (0.181) data 0.106 (0.105) loss_u loss_u 0.9380 (0.9074) acc_u 9.3750 (11.0000) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 457
confident_label rate tensor(0.4053, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 655
clean true:644
clean false:11
clean_rate:0.983206106870229
noisy true:515
noisy false:446
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 961
epoch [144/200] batch [5/20] time 0.181 (0.179) data 0.105 (0.103) loss_x loss_x 0.7656 (0.5736) acc_x 81.2500 (87.5000) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/20] time 0.184 (0.181) data 0.108 (0.105) loss_x loss_x 0.7925 (0.6422) acc_x 71.8750 (83.4375) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [15/20] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.5610 (0.5982) acc_x 84.3750 (85.2083) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [20/20] time 0.184 (0.179) data 0.107 (0.103) loss_x loss_x 0.5024 (0.6051) acc_x 87.5000 (85.3125) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/30] time 0.200 (0.181) data 0.122 (0.104) loss_u loss_u 0.9019 (0.8876) acc_u 12.5000 (13.1250) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/30] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.9453 (0.9077) acc_u 3.1250 (10.0000) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/30] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8169 (0.8968) acc_u 25.0000 (11.8750) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [20/30] time 0.187 (0.182) data 0.109 (0.105) loss_u loss_u 0.9253 (0.8968) acc_u 6.2500 (11.5625) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [25/30] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9321 (0.8989) acc_u 6.2500 (11.2500) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [30/30] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.9458 (0.9077) acc_u 6.2500 (10.5208) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 460
confident_label rate tensor(0.4041, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 653
clean true:642
clean false:11
clean_rate:0.9831546707503829
noisy true:514
noisy false:449
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 963
epoch [145/200] batch [5/20] time 0.177 (0.182) data 0.100 (0.106) loss_x loss_x 0.9678 (0.7079) acc_x 68.7500 (82.5000) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/20] time 0.161 (0.176) data 0.084 (0.099) loss_x loss_x 0.2096 (0.5330) acc_x 96.8750 (86.2500) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [15/20] time 0.161 (0.170) data 0.083 (0.094) loss_x loss_x 0.5327 (0.5497) acc_x 87.5000 (85.4167) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [20/20] time 0.171 (0.169) data 0.094 (0.092) loss_x loss_x 0.3704 (0.5495) acc_x 90.6250 (85.6250) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/30] time 0.168 (0.171) data 0.090 (0.094) loss_u loss_u 0.9346 (0.9304) acc_u 6.2500 (6.8750) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/30] time 0.192 (0.174) data 0.115 (0.097) loss_u loss_u 0.9336 (0.9211) acc_u 6.2500 (8.4375) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [15/30] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.8428 (0.9177) acc_u 18.7500 (9.3750) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/30] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9209 (0.9176) acc_u 12.5000 (9.3750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [25/30] time 0.168 (0.176) data 0.090 (0.099) loss_u loss_u 0.8623 (0.9176) acc_u 15.6250 (9.3750) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [30/30] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.8340 (0.9181) acc_u 15.6250 (9.2708) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.4035, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 652
clean true:639
clean false:13
clean_rate:0.9800613496932515
noisy true:491
noisy false:473
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 964
epoch [146/200] batch [5/20] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.3276 (0.5399) acc_x 93.7500 (83.1250) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/20] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.5078 (0.5615) acc_x 87.5000 (84.0625) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [15/20] time 0.177 (0.179) data 0.099 (0.103) loss_x loss_x 0.5498 (0.5480) acc_x 84.3750 (84.7917) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [20/20] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.4775 (0.5239) acc_x 90.6250 (86.0938) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/30] time 0.174 (0.177) data 0.096 (0.100) loss_u loss_u 0.8623 (0.9088) acc_u 15.6250 (10.0000) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/30] time 0.189 (0.178) data 0.111 (0.101) loss_u loss_u 0.8726 (0.9078) acc_u 12.5000 (10.3125) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/30] time 0.189 (0.179) data 0.111 (0.102) loss_u loss_u 0.8701 (0.8951) acc_u 15.6250 (11.8750) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/30] time 0.179 (0.179) data 0.101 (0.102) loss_u loss_u 0.8809 (0.9017) acc_u 15.6250 (11.2500) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [25/30] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.9302 (0.9034) acc_u 9.3750 (11.1250) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [30/30] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.9048 (0.9055) acc_u 9.3750 (10.8333) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 458
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 673
clean true:661
clean false:12
clean_rate:0.9821693907875185
noisy true:497
noisy false:446
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 943
epoch [147/200] batch [5/21] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.3381 (0.4596) acc_x 90.6250 (86.8750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/21] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.2886 (0.5170) acc_x 90.6250 (86.8750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/21] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.7622 (0.5154) acc_x 81.2500 (86.6667) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/21] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.2305 (0.4992) acc_x 93.7500 (87.0312) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/29] time 0.163 (0.179) data 0.085 (0.102) loss_u loss_u 0.8979 (0.8810) acc_u 12.5000 (14.3750) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/29] time 0.170 (0.178) data 0.093 (0.101) loss_u loss_u 0.9199 (0.8922) acc_u 9.3750 (13.1250) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/29] time 0.180 (0.177) data 0.104 (0.101) loss_u loss_u 0.8428 (0.8913) acc_u 18.7500 (13.1250) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [20/29] time 0.168 (0.177) data 0.090 (0.100) loss_u loss_u 0.9282 (0.9040) acc_u 9.3750 (11.5625) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [25/29] time 0.166 (0.176) data 0.089 (0.099) loss_u loss_u 0.8608 (0.9081) acc_u 15.6250 (10.8750) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 477
confident_label rate tensor(0.4084, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 660
clean true:647
clean false:13
clean_rate:0.9803030303030303
noisy true:492
noisy false:464
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 956
epoch [148/200] batch [5/20] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.4421 (0.5552) acc_x 93.7500 (88.1250) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [10/20] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.5552 (0.6137) acc_x 90.6250 (86.8750) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [15/20] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.5957 (0.6107) acc_x 84.3750 (86.0417) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [20/20] time 0.167 (0.179) data 0.090 (0.102) loss_x loss_x 0.4548 (0.5930) acc_x 87.5000 (86.5625) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/29] time 0.169 (0.176) data 0.093 (0.099) loss_u loss_u 0.9404 (0.9160) acc_u 6.2500 (8.1250) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/29] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9336 (0.9172) acc_u 6.2500 (8.4375) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [15/29] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9897 (0.9145) acc_u 0.0000 (9.3750) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/29] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8672 (0.9083) acc_u 12.5000 (10.3125) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [25/29] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8892 (0.9109) acc_u 12.5000 (10.2500) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.4072, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 658
clean true:645
clean false:13
clean_rate:0.9802431610942249
noisy true:512
noisy false:446
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 958
epoch [149/200] batch [5/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.2203 (0.4839) acc_x 96.8750 (88.7500) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [10/20] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.3633 (0.5242) acc_x 90.6250 (87.8125) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [15/20] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.8291 (0.5316) acc_x 71.8750 (87.0833) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [20/20] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.5386 (0.5260) acc_x 87.5000 (87.6562) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/29] time 0.178 (0.183) data 0.101 (0.106) loss_u loss_u 0.9160 (0.9191) acc_u 9.3750 (9.3750) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/29] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.8364 (0.9181) acc_u 21.8750 (9.3750) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [15/29] time 0.189 (0.182) data 0.111 (0.105) loss_u loss_u 0.9517 (0.9220) acc_u 6.2500 (8.9583) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/29] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9067 (0.9170) acc_u 12.5000 (9.6875) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [25/29] time 0.181 (0.183) data 0.103 (0.106) loss_u loss_u 0.8765 (0.9093) acc_u 15.6250 (10.5000) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.4041, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 653
clean true:636
clean false:17
clean_rate:0.9739663093415007
noisy true:500
noisy false:463
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 963
epoch [150/200] batch [5/20] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.4397 (0.5541) acc_x 93.7500 (86.8750) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/20] time 0.167 (0.180) data 0.090 (0.103) loss_x loss_x 0.8081 (0.5923) acc_x 78.1250 (85.0000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [15/20] time 0.160 (0.177) data 0.083 (0.100) loss_x loss_x 0.6694 (0.6062) acc_x 84.3750 (85.2083) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [20/20] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.5361 (0.5607) acc_x 87.5000 (85.7812) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/30] time 0.176 (0.177) data 0.100 (0.100) loss_u loss_u 0.9990 (0.9255) acc_u 0.0000 (8.1250) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/30] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.9243 (0.9129) acc_u 9.3750 (9.6875) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [15/30] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.8867 (0.9101) acc_u 12.5000 (10.4167) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [20/30] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8818 (0.9127) acc_u 15.6250 (10.1562) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [25/30] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.9619 (0.9167) acc_u 6.2500 (9.8750) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [30/30] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.7744 (0.9071) acc_u 28.1250 (11.0417) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 489
confident_label rate tensor(0.4016, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 649
clean true:636
clean false:13
clean_rate:0.9799691833590138
noisy true:491
noisy false:476
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 967
epoch [151/200] batch [5/20] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.5503 (0.6175) acc_x 87.5000 (86.2500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [10/20] time 0.170 (0.178) data 0.094 (0.101) loss_x loss_x 0.8682 (0.6240) acc_x 81.2500 (86.2500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [15/20] time 0.181 (0.178) data 0.104 (0.102) loss_x loss_x 0.6060 (0.5743) acc_x 84.3750 (86.6667) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [20/20] time 0.181 (0.179) data 0.105 (0.102) loss_x loss_x 0.2605 (0.5581) acc_x 96.8750 (86.7188) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/30] time 0.173 (0.178) data 0.096 (0.102) loss_u loss_u 0.9189 (0.8782) acc_u 9.3750 (13.7500) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/30] time 0.173 (0.178) data 0.095 (0.101) loss_u loss_u 0.9961 (0.8993) acc_u 0.0000 (11.5625) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [15/30] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.8198 (0.8995) acc_u 18.7500 (11.2500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [20/30] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9678 (0.9083) acc_u 3.1250 (10.3125) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [25/30] time 0.190 (0.179) data 0.111 (0.102) loss_u loss_u 0.8374 (0.9029) acc_u 21.8750 (11.2500) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [30/30] time 0.180 (0.179) data 0.102 (0.102) loss_u loss_u 0.9077 (0.9049) acc_u 12.5000 (11.3542) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 479
confident_label rate tensor(0.3998, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 646
clean true:633
clean false:13
clean_rate:0.9798761609907121
noisy true:504
noisy false:466
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 970
epoch [152/200] batch [5/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.6074 (0.5881) acc_x 84.3750 (83.7500) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [10/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.1678 (0.4683) acc_x 96.8750 (87.8125) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [15/20] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.5107 (0.4653) acc_x 90.6250 (87.7083) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [20/20] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.4731 (0.4759) acc_x 90.6250 (87.3438) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/30] time 0.191 (0.183) data 0.114 (0.106) loss_u loss_u 0.9468 (0.9235) acc_u 6.2500 (8.1250) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/30] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.8501 (0.8972) acc_u 15.6250 (10.9375) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [15/30] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.9126 (0.8934) acc_u 12.5000 (11.8750) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/30] time 0.185 (0.183) data 0.108 (0.107) loss_u loss_u 0.9121 (0.8992) acc_u 9.3750 (11.0938) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [25/30] time 0.186 (0.183) data 0.109 (0.107) loss_u loss_u 0.8633 (0.8975) acc_u 18.7500 (11.6250) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [30/30] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.9395 (0.8976) acc_u 6.2500 (11.6667) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 450
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:657
clean false:11
clean_rate:0.9835329341317365
noisy true:509
noisy false:439
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [153/200] batch [5/20] time 0.184 (0.177) data 0.106 (0.100) loss_x loss_x 0.6543 (0.5826) acc_x 78.1250 (84.3750) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.6953 (0.5756) acc_x 84.3750 (85.9375) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [15/20] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.4421 (0.5355) acc_x 87.5000 (86.6667) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [20/20] time 0.174 (0.180) data 0.097 (0.103) loss_x loss_x 0.3098 (0.4896) acc_x 96.8750 (87.8125) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/29] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.7710 (0.8793) acc_u 25.0000 (14.3750) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/29] time 0.183 (0.180) data 0.107 (0.102) loss_u loss_u 0.9146 (0.8962) acc_u 9.3750 (11.8750) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [15/29] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.8218 (0.9021) acc_u 18.7500 (11.2500) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/29] time 0.169 (0.180) data 0.092 (0.102) loss_u loss_u 0.8882 (0.9129) acc_u 12.5000 (9.6875) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [25/29] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.8994 (0.9149) acc_u 12.5000 (9.5000) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 446
confident_label rate tensor(0.4041, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 653
clean true:644
clean false:9
clean_rate:0.9862174578866769
noisy true:526
noisy false:437
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 963
epoch [154/200] batch [5/20] time 0.183 (0.190) data 0.107 (0.113) loss_x loss_x 0.5479 (0.4150) acc_x 84.3750 (89.3750) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [10/20] time 0.163 (0.180) data 0.086 (0.103) loss_x loss_x 0.7432 (0.4357) acc_x 81.2500 (89.0625) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [15/20] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.7827 (0.4580) acc_x 84.3750 (88.7500) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [20/20] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.6279 (0.4781) acc_x 84.3750 (87.9688) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/30] time 0.182 (0.181) data 0.106 (0.105) loss_u loss_u 0.8682 (0.8884) acc_u 15.6250 (13.1250) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/30] time 0.178 (0.180) data 0.100 (0.103) loss_u loss_u 0.8945 (0.9030) acc_u 12.5000 (11.5625) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [15/30] time 0.188 (0.179) data 0.112 (0.102) loss_u loss_u 0.9922 (0.9144) acc_u 0.0000 (10.4167) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/30] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.8994 (0.9032) acc_u 12.5000 (11.5625) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [25/30] time 0.158 (0.178) data 0.081 (0.101) loss_u loss_u 0.8486 (0.9050) acc_u 18.7500 (11.5000) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [30/30] time 0.162 (0.177) data 0.084 (0.100) loss_u loss_u 0.8472 (0.9089) acc_u 18.7500 (11.1458) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 444
confident_label rate tensor(0.4158, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 672
clean true:658
clean false:14
clean_rate:0.9791666666666666
noisy true:514
noisy false:430
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 944
epoch [155/200] batch [5/21] time 0.168 (0.167) data 0.091 (0.090) loss_x loss_x 0.7622 (0.5795) acc_x 71.8750 (86.2500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/21] time 0.172 (0.167) data 0.096 (0.090) loss_x loss_x 0.5186 (0.6143) acc_x 84.3750 (83.7500) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [15/21] time 0.176 (0.171) data 0.099 (0.094) loss_x loss_x 1.1768 (0.6674) acc_x 59.3750 (82.2917) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/21] time 0.158 (0.169) data 0.082 (0.092) loss_x loss_x 0.5762 (0.6404) acc_x 84.3750 (83.2812) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/29] time 0.184 (0.172) data 0.107 (0.095) loss_u loss_u 0.9531 (0.8908) acc_u 3.1250 (11.8750) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/29] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.7378 (0.8927) acc_u 28.1250 (11.8750) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [15/29] time 0.161 (0.173) data 0.084 (0.096) loss_u loss_u 0.8945 (0.9040) acc_u 9.3750 (10.6250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [20/29] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.8940 (0.9097) acc_u 12.5000 (10.1562) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [25/29] time 0.193 (0.175) data 0.115 (0.098) loss_u loss_u 0.9199 (0.9155) acc_u 12.5000 (9.7500) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 452
confident_label rate tensor(0.4196, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 678
clean true:666
clean false:12
clean_rate:0.9823008849557522
noisy true:498
noisy false:440
after delete: len(clean_dataset) 678
after delete: len(noisy_dataset) 938
epoch [156/200] batch [5/21] time 0.193 (0.186) data 0.117 (0.109) loss_x loss_x 0.4932 (0.3861) acc_x 87.5000 (92.5000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [10/21] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.8330 (0.4463) acc_x 68.7500 (89.3750) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/21] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.7979 (0.5393) acc_x 81.2500 (87.0833) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/21] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.5820 (0.5409) acc_x 90.6250 (87.1875) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/29] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.9365 (0.8967) acc_u 9.3750 (11.8750) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/29] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.9209 (0.9136) acc_u 6.2500 (9.6875) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/29] time 0.166 (0.181) data 0.089 (0.104) loss_u loss_u 0.9556 (0.9199) acc_u 9.3750 (9.1667) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/29] time 0.197 (0.181) data 0.120 (0.104) loss_u loss_u 0.8521 (0.9161) acc_u 18.7500 (9.6875) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [25/29] time 0.158 (0.180) data 0.082 (0.103) loss_u loss_u 0.9800 (0.9205) acc_u 0.0000 (9.0000) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.4072, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 658
clean true:649
clean false:9
clean_rate:0.986322188449848
noisy true:508
noisy false:450
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 958
epoch [157/200] batch [5/20] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.4800 (0.5042) acc_x 90.6250 (86.2500) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/20] time 0.170 (0.179) data 0.093 (0.102) loss_x loss_x 0.3899 (0.5270) acc_x 96.8750 (86.2500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [15/20] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.7192 (0.5988) acc_x 75.0000 (83.7500) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [20/20] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.7300 (0.6113) acc_x 81.2500 (84.2188) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/29] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9160 (0.8828) acc_u 9.3750 (14.3750) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/29] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9067 (0.8912) acc_u 9.3750 (12.8125) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/29] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.8413 (0.8957) acc_u 15.6250 (12.0833) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/29] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9873 (0.9075) acc_u 3.1250 (10.7812) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [25/29] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9111 (0.9112) acc_u 9.3750 (10.5000) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.4053, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 655
clean true:640
clean false:15
clean_rate:0.9770992366412213
noisy true:505
noisy false:456
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 961
epoch [158/200] batch [5/20] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.2927 (0.6116) acc_x 87.5000 (82.5000) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/20] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.8389 (0.6342) acc_x 75.0000 (82.8125) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [15/20] time 0.190 (0.184) data 0.113 (0.107) loss_x loss_x 0.4084 (0.5907) acc_x 90.6250 (83.9583) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [20/20] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.6685 (0.5873) acc_x 84.3750 (84.5312) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/30] time 0.189 (0.184) data 0.112 (0.107) loss_u loss_u 0.7979 (0.8593) acc_u 21.8750 (15.0000) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/30] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8540 (0.8889) acc_u 15.6250 (12.1875) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [15/30] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8560 (0.8965) acc_u 18.7500 (11.4583) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/30] time 0.179 (0.184) data 0.103 (0.107) loss_u loss_u 0.7461 (0.8968) acc_u 25.0000 (11.4062) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [25/30] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9214 (0.9038) acc_u 9.3750 (10.7500) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [30/30] time 0.183 (0.184) data 0.107 (0.108) loss_u loss_u 0.9023 (0.9014) acc_u 9.3750 (11.0417) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 449
confident_label rate tensor(0.4090, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 661
clean true:647
clean false:14
clean_rate:0.9788199697428139
noisy true:520
noisy false:435
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 955
epoch [159/200] batch [5/20] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.7344 (0.5967) acc_x 75.0000 (81.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/20] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.9185 (0.5922) acc_x 81.2500 (83.7500) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [15/20] time 0.170 (0.179) data 0.093 (0.102) loss_x loss_x 0.4563 (0.5669) acc_x 87.5000 (85.8333) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [20/20] time 0.169 (0.176) data 0.092 (0.100) loss_x loss_x 0.4556 (0.5226) acc_x 90.6250 (86.8750) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/29] time 0.187 (0.176) data 0.109 (0.099) loss_u loss_u 0.8696 (0.8892) acc_u 15.6250 (12.5000) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/29] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.9346 (0.8686) acc_u 6.2500 (15.0000) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [15/29] time 0.162 (0.176) data 0.085 (0.099) loss_u loss_u 0.9468 (0.8865) acc_u 6.2500 (13.1250) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/29] time 0.159 (0.174) data 0.083 (0.097) loss_u loss_u 0.8965 (0.8921) acc_u 12.5000 (12.3438) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [25/29] time 0.179 (0.175) data 0.103 (0.098) loss_u loss_u 0.9375 (0.8971) acc_u 9.3750 (12.1250) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 443
confident_label rate tensor(0.4152, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 671
clean true:659
clean false:12
clean_rate:0.9821162444113264
noisy true:514
noisy false:431
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 945
epoch [160/200] batch [5/20] time 0.179 (0.179) data 0.102 (0.103) loss_x loss_x 0.4231 (0.4860) acc_x 90.6250 (87.5000) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [10/20] time 0.180 (0.179) data 0.104 (0.103) loss_x loss_x 0.8311 (0.5663) acc_x 84.3750 (87.1875) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/20] time 0.180 (0.180) data 0.104 (0.104) loss_x loss_x 0.4070 (0.5546) acc_x 87.5000 (86.2500) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [20/20] time 0.178 (0.180) data 0.102 (0.103) loss_x loss_x 0.1669 (0.5398) acc_x 93.7500 (86.2500) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/29] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.8960 (0.9010) acc_u 9.3750 (10.0000) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/29] time 0.188 (0.180) data 0.111 (0.103) loss_u loss_u 0.9048 (0.9123) acc_u 9.3750 (9.3750) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [15/29] time 0.169 (0.180) data 0.092 (0.103) loss_u loss_u 0.9116 (0.9112) acc_u 9.3750 (9.5833) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/29] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8623 (0.9068) acc_u 15.6250 (10.4688) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [25/29] time 0.172 (0.180) data 0.095 (0.103) loss_u loss_u 0.8452 (0.9035) acc_u 18.7500 (10.8750) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 449
confident_label rate tensor(0.4183, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 676
clean true:663
clean false:13
clean_rate:0.9807692307692307
noisy true:504
noisy false:436
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 940
epoch [161/200] batch [5/21] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 0.5786 (0.5248) acc_x 84.3750 (88.1250) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/21] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.2661 (0.4724) acc_x 90.6250 (88.7500) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/21] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.3867 (0.4868) acc_x 90.6250 (88.1250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/21] time 0.182 (0.183) data 0.105 (0.107) loss_x loss_x 0.3916 (0.5058) acc_x 90.6250 (87.9688) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/29] time 0.189 (0.183) data 0.112 (0.107) loss_u loss_u 0.9390 (0.8972) acc_u 6.2500 (11.2500) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/29] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.8760 (0.8935) acc_u 15.6250 (11.8750) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [15/29] time 0.186 (0.183) data 0.108 (0.107) loss_u loss_u 0.9453 (0.9041) acc_u 6.2500 (10.8333) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/29] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.9380 (0.9093) acc_u 6.2500 (10.1562) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [25/29] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.8950 (0.9114) acc_u 12.5000 (10.2500) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 460
confident_label rate tensor(0.4072, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 658
clean true:647
clean false:11
clean_rate:0.9832826747720365
noisy true:509
noisy false:449
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 958
epoch [162/200] batch [5/20] time 0.211 (0.191) data 0.134 (0.114) loss_x loss_x 0.4087 (0.5171) acc_x 90.6250 (89.3750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/20] time 0.184 (0.187) data 0.107 (0.111) loss_x loss_x 0.3896 (0.5351) acc_x 87.5000 (87.5000) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/20] time 0.168 (0.182) data 0.091 (0.106) loss_x loss_x 0.2017 (0.5342) acc_x 90.6250 (86.4583) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [20/20] time 0.168 (0.180) data 0.092 (0.104) loss_x loss_x 0.7251 (0.5279) acc_x 87.5000 (86.8750) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/29] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8921 (0.8891) acc_u 12.5000 (13.1250) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/29] time 0.176 (0.180) data 0.097 (0.104) loss_u loss_u 0.9380 (0.9090) acc_u 6.2500 (10.3125) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [15/29] time 0.184 (0.181) data 0.108 (0.105) loss_u loss_u 0.9575 (0.9137) acc_u 3.1250 (9.5833) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/29] time 0.188 (0.182) data 0.109 (0.105) loss_u loss_u 0.8604 (0.9170) acc_u 15.6250 (9.3750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [25/29] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8813 (0.9149) acc_u 15.6250 (10.0000) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 435
confident_label rate tensor(0.4177, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 675
clean true:665
clean false:10
clean_rate:0.9851851851851852
noisy true:516
noisy false:425
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 941
epoch [163/200] batch [5/21] time 0.171 (0.169) data 0.094 (0.092) loss_x loss_x 0.4836 (0.5476) acc_x 84.3750 (85.6250) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/21] time 0.193 (0.174) data 0.116 (0.097) loss_x loss_x 0.3433 (0.5287) acc_x 93.7500 (85.6250) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/21] time 0.187 (0.174) data 0.109 (0.097) loss_x loss_x 0.8628 (0.5270) acc_x 75.0000 (86.0417) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/21] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.3962 (0.5261) acc_x 90.6250 (86.2500) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/29] time 0.185 (0.177) data 0.107 (0.099) loss_u loss_u 0.9307 (0.9400) acc_u 6.2500 (6.2500) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/29] time 0.168 (0.175) data 0.090 (0.098) loss_u loss_u 0.8638 (0.9229) acc_u 15.6250 (8.7500) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [15/29] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.9365 (0.9228) acc_u 6.2500 (8.5417) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/29] time 0.160 (0.175) data 0.082 (0.097) loss_u loss_u 0.8984 (0.9156) acc_u 12.5000 (9.3750) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [25/29] time 0.163 (0.174) data 0.086 (0.096) loss_u loss_u 0.9121 (0.9168) acc_u 9.3750 (9.3750) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 438
confident_label rate tensor(0.4146, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 670
clean true:660
clean false:10
clean_rate:0.9850746268656716
noisy true:518
noisy false:428
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 946
epoch [164/200] batch [5/20] time 0.179 (0.178) data 0.102 (0.102) loss_x loss_x 0.7471 (0.5403) acc_x 78.1250 (86.2500) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [10/20] time 0.176 (0.179) data 0.100 (0.102) loss_x loss_x 0.2532 (0.5292) acc_x 90.6250 (85.3125) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [15/20] time 0.180 (0.177) data 0.104 (0.100) loss_x loss_x 0.3689 (0.5119) acc_x 93.7500 (86.4583) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [20/20] time 0.158 (0.176) data 0.082 (0.099) loss_x loss_x 0.6660 (0.5583) acc_x 81.2500 (85.0000) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/29] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.9160 (0.9252) acc_u 12.5000 (9.3750) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/29] time 0.160 (0.174) data 0.084 (0.098) loss_u loss_u 0.8535 (0.9034) acc_u 15.6250 (11.8750) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/29] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.9419 (0.8999) acc_u 6.2500 (12.0833) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/29] time 0.163 (0.174) data 0.086 (0.097) loss_u loss_u 0.9048 (0.9013) acc_u 12.5000 (11.5625) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [25/29] time 0.184 (0.173) data 0.108 (0.096) loss_u loss_u 0.9277 (0.9101) acc_u 6.2500 (10.5000) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.3923, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 634
clean true:626
clean false:8
clean_rate:0.9873817034700315
noisy true:506
noisy false:476
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 982
epoch [165/200] batch [5/19] time 0.217 (0.191) data 0.141 (0.115) loss_x loss_x 0.5024 (0.4391) acc_x 84.3750 (89.3750) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/19] time 0.180 (0.187) data 0.103 (0.111) loss_x loss_x 1.2754 (0.5748) acc_x 68.7500 (84.6875) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/19] time 0.168 (0.183) data 0.091 (0.106) loss_x loss_x 0.3521 (0.5104) acc_x 90.6250 (86.8750) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/30] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9043 (0.8873) acc_u 9.3750 (13.1250) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/30] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.8271 (0.8619) acc_u 18.7500 (15.9375) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [15/30] time 0.168 (0.178) data 0.092 (0.101) loss_u loss_u 0.8354 (0.8796) acc_u 15.6250 (13.3333) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/30] time 0.161 (0.177) data 0.084 (0.100) loss_u loss_u 0.9526 (0.8889) acc_u 6.2500 (12.6562) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [25/30] time 0.182 (0.176) data 0.104 (0.098) loss_u loss_u 0.8242 (0.8865) acc_u 18.7500 (13.0000) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [30/30] time 0.163 (0.176) data 0.086 (0.098) loss_u loss_u 0.9292 (0.8900) acc_u 9.3750 (12.7083) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.4146, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 670
clean true:657
clean false:13
clean_rate:0.9805970149253731
noisy true:527
noisy false:419
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 946
epoch [166/200] batch [5/20] time 0.177 (0.182) data 0.100 (0.105) loss_x loss_x 1.1182 (0.6606) acc_x 68.7500 (84.3750) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [10/20] time 0.173 (0.181) data 0.097 (0.104) loss_x loss_x 0.6572 (0.6061) acc_x 87.5000 (86.2500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [15/20] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.7065 (0.5801) acc_x 78.1250 (85.4167) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [20/20] time 0.174 (0.176) data 0.097 (0.099) loss_x loss_x 0.4287 (0.5789) acc_x 90.6250 (86.0938) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/29] time 0.174 (0.176) data 0.096 (0.100) loss_u loss_u 0.9204 (0.9349) acc_u 12.5000 (8.7500) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [10/29] time 0.185 (0.176) data 0.097 (0.098) loss_u loss_u 0.9512 (0.9292) acc_u 6.2500 (8.4375) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [15/29] time 0.176 (0.176) data 0.098 (0.099) loss_u loss_u 0.9556 (0.9189) acc_u 6.2500 (9.3750) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/29] time 0.185 (0.176) data 0.107 (0.098) loss_u loss_u 0.8691 (0.9128) acc_u 12.5000 (9.8438) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [25/29] time 0.183 (0.177) data 0.105 (0.099) loss_u loss_u 0.9082 (0.9152) acc_u 15.6250 (9.7500) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.3998, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 646
clean true:639
clean false:7
clean_rate:0.9891640866873065
noisy true:513
noisy false:457
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 970
epoch [167/200] batch [5/20] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.1642 (0.4372) acc_x 100.0000 (88.7500) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [10/20] time 0.164 (0.182) data 0.088 (0.105) loss_x loss_x 0.7661 (0.4422) acc_x 78.1250 (89.0625) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [15/20] time 0.183 (0.178) data 0.107 (0.101) loss_x loss_x 0.3330 (0.5059) acc_x 90.6250 (88.1250) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [20/20] time 0.163 (0.176) data 0.086 (0.099) loss_x loss_x 0.3291 (0.5173) acc_x 90.6250 (87.6562) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/30] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.9033 (0.9253) acc_u 12.5000 (8.7500) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/30] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8311 (0.9070) acc_u 18.7500 (10.3125) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/30] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9419 (0.9013) acc_u 6.2500 (11.6667) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/30] time 0.187 (0.179) data 0.109 (0.102) loss_u loss_u 0.8843 (0.8974) acc_u 12.5000 (11.8750) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [25/30] time 0.171 (0.178) data 0.093 (0.100) loss_u loss_u 0.9453 (0.8936) acc_u 9.3750 (12.5000) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [30/30] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.9082 (0.8946) acc_u 12.5000 (12.2917) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 451
confident_label rate tensor(0.4047, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 654
clean true:643
clean false:11
clean_rate:0.9831804281345565
noisy true:522
noisy false:440
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 962
epoch [168/200] batch [5/20] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.4382 (0.4471) acc_x 87.5000 (88.1250) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/20] time 0.175 (0.181) data 0.099 (0.105) loss_x loss_x 0.5332 (0.4911) acc_x 84.3750 (86.8750) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/20] time 0.168 (0.178) data 0.092 (0.102) loss_x loss_x 0.8071 (0.5127) acc_x 81.2500 (86.8750) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [20/20] time 0.186 (0.181) data 0.110 (0.104) loss_x loss_x 0.7754 (0.5135) acc_x 81.2500 (86.7188) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/30] time 0.185 (0.181) data 0.108 (0.105) loss_u loss_u 0.9219 (0.9120) acc_u 12.5000 (11.8750) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/30] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9341 (0.8997) acc_u 6.2500 (11.5625) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/30] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8877 (0.8993) acc_u 12.5000 (11.6667) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/30] time 0.160 (0.180) data 0.083 (0.103) loss_u loss_u 0.9209 (0.9046) acc_u 9.3750 (11.0938) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [25/30] time 0.180 (0.179) data 0.103 (0.103) loss_u loss_u 0.7720 (0.9020) acc_u 28.1250 (11.2500) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [30/30] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.9009 (0.9019) acc_u 12.5000 (11.2500) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 478
confident_label rate tensor(0.4022, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 650
clean true:640
clean false:10
clean_rate:0.9846153846153847
noisy true:498
noisy false:468
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 966
epoch [169/200] batch [5/20] time 0.169 (0.181) data 0.093 (0.104) loss_x loss_x 0.6104 (0.6040) acc_x 84.3750 (85.0000) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/20] time 0.190 (0.175) data 0.114 (0.098) loss_x loss_x 0.5103 (0.5673) acc_x 87.5000 (85.3125) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [15/20] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.5522 (0.5571) acc_x 84.3750 (85.6250) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [20/20] time 0.182 (0.179) data 0.106 (0.102) loss_x loss_x 0.5093 (0.5250) acc_x 90.6250 (86.5625) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/30] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.9624 (0.9327) acc_u 3.1250 (8.1250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [10/30] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.9028 (0.9233) acc_u 12.5000 (9.3750) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/30] time 0.164 (0.177) data 0.086 (0.101) loss_u loss_u 0.9043 (0.9174) acc_u 12.5000 (9.7917) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/30] time 0.159 (0.176) data 0.083 (0.099) loss_u loss_u 0.8833 (0.9092) acc_u 12.5000 (10.4688) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [25/30] time 0.174 (0.175) data 0.096 (0.098) loss_u loss_u 0.7690 (0.9026) acc_u 25.0000 (10.8750) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [30/30] time 0.182 (0.175) data 0.106 (0.098) loss_u loss_u 0.8491 (0.9032) acc_u 18.7500 (10.9375) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.4115, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 665
clean true:652
clean false:13
clean_rate:0.9804511278195489
noisy true:522
noisy false:429
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 951
epoch [170/200] batch [5/20] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.7529 (0.5213) acc_x 81.2500 (86.8750) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/20] time 0.160 (0.181) data 0.083 (0.104) loss_x loss_x 0.7695 (0.6201) acc_x 81.2500 (84.6875) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [15/20] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 0.1625 (0.6608) acc_x 96.8750 (85.0000) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [20/20] time 0.177 (0.177) data 0.101 (0.100) loss_x loss_x 0.1586 (0.6041) acc_x 100.0000 (86.5625) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/29] time 0.176 (0.176) data 0.099 (0.099) loss_u loss_u 0.9556 (0.9190) acc_u 6.2500 (10.0000) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/29] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.9497 (0.9281) acc_u 6.2500 (8.4375) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/29] time 0.159 (0.174) data 0.081 (0.097) loss_u loss_u 0.9434 (0.9156) acc_u 6.2500 (9.7917) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/29] time 0.168 (0.174) data 0.091 (0.097) loss_u loss_u 0.9399 (0.9140) acc_u 6.2500 (9.6875) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [25/29] time 0.230 (0.175) data 0.153 (0.098) loss_u loss_u 0.8672 (0.9098) acc_u 15.6250 (10.3750) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 449
confident_label rate tensor(0.4053, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 655
clean true:644
clean false:11
clean_rate:0.983206106870229
noisy true:523
noisy false:438
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 961
epoch [171/200] batch [5/20] time 0.162 (0.179) data 0.086 (0.102) loss_x loss_x 0.5474 (0.4930) acc_x 87.5000 (86.8750) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/20] time 0.162 (0.173) data 0.086 (0.097) loss_x loss_x 0.3958 (0.4997) acc_x 87.5000 (87.1875) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [15/20] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.4800 (0.5267) acc_x 84.3750 (86.8750) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [20/20] time 0.163 (0.174) data 0.087 (0.097) loss_x loss_x 0.4211 (0.5007) acc_x 90.6250 (87.6562) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/30] time 0.197 (0.173) data 0.120 (0.097) loss_u loss_u 0.9141 (0.9062) acc_u 12.5000 (10.6250) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [10/30] time 0.182 (0.175) data 0.105 (0.098) loss_u loss_u 0.9150 (0.8922) acc_u 9.3750 (12.5000) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [15/30] time 0.176 (0.174) data 0.098 (0.097) loss_u loss_u 0.9487 (0.8938) acc_u 6.2500 (12.7083) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/30] time 0.167 (0.173) data 0.089 (0.096) loss_u loss_u 0.8926 (0.8947) acc_u 9.3750 (12.3438) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [25/30] time 0.176 (0.173) data 0.097 (0.096) loss_u loss_u 0.9409 (0.8965) acc_u 6.2500 (12.1250) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [30/30] time 0.184 (0.174) data 0.106 (0.097) loss_u loss_u 0.8428 (0.9011) acc_u 15.6250 (11.3542) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 433
confident_label rate tensor(0.4177, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 675
clean true:662
clean false:13
clean_rate:0.9807407407407407
noisy true:521
noisy false:420
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 941
epoch [172/200] batch [5/21] time 0.164 (0.173) data 0.087 (0.097) loss_x loss_x 0.8511 (0.5190) acc_x 78.1250 (85.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/21] time 0.167 (0.175) data 0.091 (0.099) loss_x loss_x 0.7393 (0.5378) acc_x 84.3750 (85.9375) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [15/21] time 0.178 (0.174) data 0.102 (0.097) loss_x loss_x 0.5830 (0.5555) acc_x 87.5000 (86.2500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/21] time 0.177 (0.174) data 0.100 (0.098) loss_x loss_x 0.7622 (0.5634) acc_x 78.1250 (86.4062) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/29] time 0.170 (0.175) data 0.093 (0.098) loss_u loss_u 0.9062 (0.9056) acc_u 9.3750 (10.6250) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/29] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.8999 (0.9021) acc_u 9.3750 (10.9375) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/29] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.9102 (0.9128) acc_u 9.3750 (10.0000) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/29] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9663 (0.9148) acc_u 3.1250 (9.8438) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [25/29] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.8433 (0.9060) acc_u 15.6250 (10.7500) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.4103, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 663
clean true:652
clean false:11
clean_rate:0.9834087481146304
noisy true:511
noisy false:442
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 953
epoch [173/200] batch [5/20] time 0.178 (0.169) data 0.102 (0.092) loss_x loss_x 0.7192 (0.5392) acc_x 81.2500 (85.0000) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/20] time 0.175 (0.172) data 0.098 (0.095) loss_x loss_x 0.4868 (0.6707) acc_x 87.5000 (83.4375) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [15/20] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.4536 (0.6616) acc_x 90.6250 (83.5417) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [20/20] time 0.175 (0.174) data 0.098 (0.098) loss_x loss_x 0.6924 (0.6043) acc_x 84.3750 (85.1562) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/29] time 0.158 (0.173) data 0.082 (0.097) loss_u loss_u 0.9526 (0.9454) acc_u 6.2500 (7.5000) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/29] time 0.180 (0.172) data 0.103 (0.095) loss_u loss_u 0.9517 (0.9218) acc_u 9.3750 (10.6250) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [15/29] time 0.174 (0.172) data 0.096 (0.095) loss_u loss_u 0.8188 (0.9207) acc_u 18.7500 (10.2083) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/29] time 0.171 (0.172) data 0.093 (0.095) loss_u loss_u 0.8521 (0.9163) acc_u 15.6250 (10.3125) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [25/29] time 0.185 (0.172) data 0.109 (0.096) loss_u loss_u 0.8735 (0.9155) acc_u 12.5000 (10.0000) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 445
confident_label rate tensor(0.4127, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 667
clean true:654
clean false:13
clean_rate:0.9805097451274363
noisy true:517
noisy false:432
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 949
epoch [174/200] batch [5/20] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.4612 (0.6464) acc_x 84.3750 (82.5000) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/20] time 0.182 (0.186) data 0.106 (0.109) loss_x loss_x 0.4495 (0.5504) acc_x 90.6250 (85.6250) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [15/20] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.3997 (0.5674) acc_x 90.6250 (85.8333) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [20/20] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.6377 (0.5738) acc_x 87.5000 (85.7812) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/29] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9058 (0.9239) acc_u 9.3750 (8.7500) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/29] time 0.186 (0.182) data 0.107 (0.105) loss_u loss_u 0.8584 (0.9128) acc_u 15.6250 (10.0000) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [15/29] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9053 (0.9085) acc_u 9.3750 (10.6250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/29] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9380 (0.9107) acc_u 6.2500 (10.1562) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [25/29] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9370 (0.9078) acc_u 6.2500 (10.3750) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 483
confident_label rate tensor(0.4016, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 649
clean true:632
clean false:17
clean_rate:0.9738058551617874
noisy true:501
noisy false:466
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 967
epoch [175/200] batch [5/20] time 0.184 (0.185) data 0.107 (0.109) loss_x loss_x 0.6855 (0.5524) acc_x 78.1250 (86.2500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/20] time 0.182 (0.184) data 0.105 (0.108) loss_x loss_x 0.7549 (0.6029) acc_x 78.1250 (85.3125) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [15/20] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.6523 (0.6116) acc_x 81.2500 (85.6250) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [20/20] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.2397 (0.5920) acc_x 96.8750 (86.5625) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/30] time 0.158 (0.179) data 0.081 (0.102) loss_u loss_u 0.9297 (0.8964) acc_u 6.2500 (11.2500) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/30] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.8608 (0.8923) acc_u 15.6250 (12.1875) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [15/30] time 0.182 (0.177) data 0.105 (0.101) loss_u loss_u 0.9688 (0.9050) acc_u 3.1250 (11.2500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/30] time 0.167 (0.179) data 0.090 (0.102) loss_u loss_u 0.7944 (0.8954) acc_u 21.8750 (12.0312) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [25/30] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9409 (0.9001) acc_u 6.2500 (11.5000) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [30/30] time 0.173 (0.179) data 0.096 (0.102) loss_u loss_u 0.9390 (0.9001) acc_u 9.3750 (11.5625) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 438
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:659
clean false:9
clean_rate:0.9865269461077845
noisy true:519
noisy false:429
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [176/200] batch [5/20] time 0.168 (0.175) data 0.092 (0.098) loss_x loss_x 0.7534 (0.5884) acc_x 84.3750 (85.6250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/20] time 0.181 (0.176) data 0.105 (0.099) loss_x loss_x 0.5317 (0.5275) acc_x 84.3750 (87.5000) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [15/20] time 0.183 (0.178) data 0.107 (0.102) loss_x loss_x 0.4927 (0.5494) acc_x 84.3750 (86.4583) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [20/20] time 0.181 (0.179) data 0.104 (0.103) loss_x loss_x 0.3962 (0.5571) acc_x 90.6250 (86.2500) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/29] time 0.184 (0.180) data 0.107 (0.104) loss_u loss_u 0.8618 (0.9032) acc_u 15.6250 (11.2500) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/29] time 0.160 (0.181) data 0.083 (0.104) loss_u loss_u 0.7939 (0.8991) acc_u 21.8750 (11.5625) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/29] time 0.163 (0.179) data 0.085 (0.102) loss_u loss_u 0.9014 (0.9021) acc_u 12.5000 (11.4583) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/29] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.9819 (0.9055) acc_u 3.1250 (11.0938) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [25/29] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.9189 (0.9058) acc_u 9.3750 (11.1250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 489
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 659
clean true:646
clean false:13
clean_rate:0.9802731411229135
noisy true:481
noisy false:476
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 957
epoch [177/200] batch [5/20] time 0.159 (0.158) data 0.083 (0.082) loss_x loss_x 0.7305 (0.6052) acc_x 78.1250 (83.7500) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/20] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.6436 (0.5950) acc_x 87.5000 (84.0625) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [15/20] time 0.164 (0.159) data 0.087 (0.083) loss_x loss_x 0.5752 (0.6358) acc_x 84.3750 (83.7500) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [20/20] time 0.183 (0.163) data 0.106 (0.087) loss_x loss_x 0.6021 (0.5830) acc_x 84.3750 (84.8438) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/29] time 0.187 (0.168) data 0.109 (0.091) loss_u loss_u 0.9072 (0.8954) acc_u 9.3750 (11.8750) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/29] time 0.182 (0.170) data 0.105 (0.093) loss_u loss_u 0.9390 (0.9002) acc_u 6.2500 (11.5625) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [15/29] time 0.184 (0.172) data 0.106 (0.095) loss_u loss_u 0.8921 (0.9011) acc_u 12.5000 (11.2500) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/29] time 0.183 (0.173) data 0.106 (0.096) loss_u loss_u 0.8677 (0.8974) acc_u 12.5000 (11.5625) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [25/29] time 0.184 (0.175) data 0.106 (0.098) loss_u loss_u 0.8735 (0.8979) acc_u 15.6250 (11.7500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:657
clean false:11
clean_rate:0.9835329341317365
noisy true:517
noisy false:431
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [178/200] batch [5/20] time 0.183 (0.177) data 0.107 (0.100) loss_x loss_x 0.8306 (0.7863) acc_x 81.2500 (81.2500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/20] time 0.169 (0.178) data 0.093 (0.102) loss_x loss_x 0.3389 (0.6529) acc_x 93.7500 (84.0625) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/20] time 0.161 (0.181) data 0.085 (0.104) loss_x loss_x 0.2404 (0.5644) acc_x 96.8750 (86.2500) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [20/20] time 0.176 (0.178) data 0.098 (0.102) loss_x loss_x 0.7739 (0.5461) acc_x 75.0000 (86.2500) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/29] time 0.181 (0.176) data 0.104 (0.100) loss_u loss_u 0.9204 (0.9305) acc_u 9.3750 (8.1250) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/29] time 0.167 (0.176) data 0.090 (0.099) loss_u loss_u 0.9517 (0.9333) acc_u 3.1250 (7.5000) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/29] time 0.159 (0.174) data 0.083 (0.097) loss_u loss_u 0.9346 (0.9314) acc_u 6.2500 (7.7083) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/29] time 0.171 (0.173) data 0.093 (0.096) loss_u loss_u 0.8423 (0.9195) acc_u 18.7500 (8.9062) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [25/29] time 0.193 (0.175) data 0.115 (0.098) loss_u loss_u 0.9268 (0.9188) acc_u 9.3750 (9.0000) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 463
confident_label rate tensor(0.4127, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 667
clean true:655
clean false:12
clean_rate:0.9820089955022488
noisy true:498
noisy false:451
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 949
epoch [179/200] batch [5/20] time 0.187 (0.184) data 0.110 (0.106) loss_x loss_x 0.5200 (0.5754) acc_x 84.3750 (85.6250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/20] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.3977 (0.6175) acc_x 87.5000 (85.6250) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/20] time 0.182 (0.181) data 0.105 (0.103) loss_x loss_x 0.6479 (0.5836) acc_x 87.5000 (85.4167) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [20/20] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.6763 (0.5546) acc_x 81.2500 (86.2500) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/29] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.8857 (0.8983) acc_u 12.5000 (11.8750) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/29] time 0.166 (0.178) data 0.089 (0.101) loss_u loss_u 0.9180 (0.9215) acc_u 9.3750 (9.3750) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/29] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9131 (0.9173) acc_u 9.3750 (10.0000) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/29] time 0.183 (0.179) data 0.106 (0.101) loss_u loss_u 0.8730 (0.9075) acc_u 12.5000 (10.9375) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [25/29] time 0.196 (0.178) data 0.118 (0.101) loss_u loss_u 0.8730 (0.9107) acc_u 12.5000 (10.5000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.4220, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 682
clean true:672
clean false:10
clean_rate:0.9853372434017595
noisy true:502
noisy false:432
after delete: len(clean_dataset) 682
after delete: len(noisy_dataset) 934
epoch [180/200] batch [5/21] time 0.189 (0.200) data 0.113 (0.123) loss_x loss_x 0.2781 (0.4167) acc_x 93.7500 (90.6250) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/21] time 0.184 (0.192) data 0.108 (0.115) loss_x loss_x 0.5444 (0.5526) acc_x 87.5000 (87.8125) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/21] time 0.174 (0.189) data 0.096 (0.112) loss_x loss_x 0.4001 (0.5454) acc_x 90.6250 (86.2500) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/21] time 0.180 (0.186) data 0.102 (0.109) loss_x loss_x 0.3201 (0.5193) acc_x 90.6250 (86.0938) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/29] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8760 (0.9046) acc_u 12.5000 (10.6250) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/29] time 0.176 (0.181) data 0.099 (0.104) loss_u loss_u 0.9702 (0.9161) acc_u 3.1250 (9.3750) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/29] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8550 (0.9150) acc_u 18.7500 (9.7917) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/29] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9590 (0.9185) acc_u 3.1250 (9.3750) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [25/29] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9131 (0.9144) acc_u 6.2500 (9.6250) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.4239, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 685
clean true:671
clean false:14
clean_rate:0.9795620437956204
noisy true:504
noisy false:427
after delete: len(clean_dataset) 685
after delete: len(noisy_dataset) 931
epoch [181/200] batch [5/21] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.2288 (0.4186) acc_x 96.8750 (91.2500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/21] time 0.165 (0.170) data 0.088 (0.093) loss_x loss_x 0.6934 (0.4758) acc_x 81.2500 (88.4375) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/21] time 0.185 (0.173) data 0.108 (0.096) loss_x loss_x 0.5874 (0.4856) acc_x 87.5000 (87.5000) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/21] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.7456 (0.5319) acc_x 81.2500 (86.7188) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/29] time 0.185 (0.178) data 0.109 (0.101) loss_u loss_u 0.9243 (0.8978) acc_u 12.5000 (12.5000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/29] time 0.173 (0.178) data 0.095 (0.101) loss_u loss_u 0.9434 (0.9170) acc_u 6.2500 (10.0000) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/29] time 0.160 (0.177) data 0.083 (0.100) loss_u loss_u 0.9180 (0.9168) acc_u 9.3750 (9.7917) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/29] time 0.165 (0.175) data 0.088 (0.098) loss_u loss_u 0.9160 (0.9165) acc_u 9.3750 (10.0000) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [25/29] time 0.162 (0.175) data 0.085 (0.098) loss_u loss_u 0.8457 (0.9183) acc_u 18.7500 (9.8750) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 468
confident_label rate tensor(0.4121, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 666
clean true:653
clean false:13
clean_rate:0.9804804804804805
noisy true:495
noisy false:455
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 950
epoch [182/200] batch [5/20] time 0.175 (0.183) data 0.098 (0.107) loss_x loss_x 0.7939 (0.5369) acc_x 84.3750 (85.6250) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/20] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.6665 (0.5597) acc_x 81.2500 (84.6875) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/20] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.7666 (0.5731) acc_x 75.0000 (85.4167) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [20/20] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.4338 (0.5853) acc_x 93.7500 (85.4688) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/29] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.9614 (0.9074) acc_u 3.1250 (11.2500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/29] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8926 (0.9113) acc_u 12.5000 (10.6250) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/29] time 0.159 (0.182) data 0.083 (0.105) loss_u loss_u 0.8560 (0.9032) acc_u 15.6250 (11.2500) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/29] time 0.175 (0.181) data 0.099 (0.104) loss_u loss_u 0.8906 (0.9038) acc_u 12.5000 (11.0938) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [25/29] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8896 (0.9109) acc_u 9.3750 (10.1250) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 444
confident_label rate tensor(0.4158, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 672
clean true:663
clean false:9
clean_rate:0.9866071428571429
noisy true:509
noisy false:435
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 944
epoch [183/200] batch [5/21] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.5728 (0.4072) acc_x 81.2500 (89.3750) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/21] time 0.186 (0.174) data 0.108 (0.096) loss_x loss_x 0.3613 (0.4579) acc_x 90.6250 (89.0625) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [15/21] time 0.173 (0.175) data 0.097 (0.098) loss_x loss_x 0.5835 (0.4552) acc_x 87.5000 (88.9583) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/21] time 0.168 (0.174) data 0.092 (0.097) loss_x loss_x 0.4651 (0.4485) acc_x 87.5000 (88.7500) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/29] time 0.171 (0.173) data 0.094 (0.096) loss_u loss_u 0.9458 (0.9145) acc_u 9.3750 (10.6250) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/29] time 0.181 (0.174) data 0.104 (0.097) loss_u loss_u 0.7983 (0.8954) acc_u 28.1250 (12.8125) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/29] time 0.159 (0.174) data 0.081 (0.097) loss_u loss_u 0.7925 (0.8928) acc_u 25.0000 (12.7083) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/29] time 0.157 (0.173) data 0.079 (0.096) loss_u loss_u 0.9604 (0.8990) acc_u 6.2500 (12.0312) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [25/29] time 0.186 (0.173) data 0.108 (0.096) loss_u loss_u 0.9673 (0.9096) acc_u 3.1250 (10.6250) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.4214, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 681
clean true:669
clean false:12
clean_rate:0.9823788546255506
noisy true:506
noisy false:429
after delete: len(clean_dataset) 681
after delete: len(noisy_dataset) 935
epoch [184/200] batch [5/21] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.3550 (0.4668) acc_x 90.6250 (88.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/21] time 0.179 (0.186) data 0.102 (0.109) loss_x loss_x 0.9160 (0.5014) acc_x 78.1250 (87.5000) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/21] time 0.167 (0.180) data 0.091 (0.103) loss_x loss_x 0.3523 (0.5002) acc_x 93.7500 (87.2917) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/21] time 0.169 (0.180) data 0.092 (0.104) loss_x loss_x 0.5957 (0.5145) acc_x 81.2500 (86.4062) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/29] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.9487 (0.9389) acc_u 3.1250 (5.6250) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/29] time 0.177 (0.180) data 0.100 (0.103) loss_u loss_u 0.9917 (0.9344) acc_u 0.0000 (6.5625) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/29] time 0.159 (0.177) data 0.081 (0.101) loss_u loss_u 0.8706 (0.9227) acc_u 12.5000 (8.3333) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/29] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9209 (0.9209) acc_u 9.3750 (8.4375) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [25/29] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9146 (0.9208) acc_u 9.3750 (8.6250) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 438
confident_label rate tensor(0.4152, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 671
clean true:658
clean false:13
clean_rate:0.9806259314456036
noisy true:520
noisy false:425
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 945
epoch [185/200] batch [5/20] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.4441 (0.5028) acc_x 90.6250 (87.5000) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [10/20] time 0.178 (0.176) data 0.101 (0.099) loss_x loss_x 0.7114 (0.5897) acc_x 81.2500 (85.3125) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/20] time 0.171 (0.174) data 0.095 (0.098) loss_x loss_x 0.4438 (0.5806) acc_x 87.5000 (85.4167) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [20/20] time 0.172 (0.174) data 0.095 (0.098) loss_x loss_x 0.3196 (0.5707) acc_x 90.6250 (85.1562) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/29] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.8916 (0.8904) acc_u 18.7500 (14.3750) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/29] time 0.183 (0.176) data 0.106 (0.100) loss_u loss_u 0.8726 (0.8985) acc_u 15.6250 (12.1875) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/29] time 0.188 (0.178) data 0.110 (0.100) loss_u loss_u 0.8223 (0.9014) acc_u 18.7500 (11.4583) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/29] time 0.161 (0.177) data 0.084 (0.100) loss_u loss_u 0.9048 (0.8993) acc_u 9.3750 (11.5625) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [25/29] time 0.167 (0.177) data 0.089 (0.100) loss_u loss_u 0.9619 (0.9099) acc_u 3.1250 (10.3750) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.4103, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 663
clean true:654
clean false:9
clean_rate:0.9864253393665159
noisy true:503
noisy false:450
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 953
epoch [186/200] batch [5/20] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.4917 (0.5357) acc_x 84.3750 (88.1250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/20] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.7207 (0.5577) acc_x 78.1250 (86.2500) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [15/20] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.5210 (0.5136) acc_x 87.5000 (87.7083) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [20/20] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.4255 (0.4941) acc_x 93.7500 (88.1250) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/29] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.9438 (0.9212) acc_u 9.3750 (10.6250) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/29] time 0.215 (0.181) data 0.138 (0.104) loss_u loss_u 0.9365 (0.9161) acc_u 6.2500 (10.0000) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/29] time 0.205 (0.180) data 0.127 (0.102) loss_u loss_u 0.8867 (0.9105) acc_u 12.5000 (10.2083) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/29] time 0.189 (0.181) data 0.112 (0.104) loss_u loss_u 0.9365 (0.9112) acc_u 6.2500 (10.1562) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [25/29] time 0.182 (0.180) data 0.105 (0.102) loss_u loss_u 0.9028 (0.9059) acc_u 9.3750 (10.7500) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 438
confident_label rate tensor(0.4171, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 674
clean true:662
clean false:12
clean_rate:0.9821958456973294
noisy true:516
noisy false:426
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 942
epoch [187/200] batch [5/21] time 0.184 (0.186) data 0.107 (0.110) loss_x loss_x 0.4343 (0.4902) acc_x 90.6250 (89.3750) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/21] time 0.187 (0.185) data 0.110 (0.109) loss_x loss_x 0.6924 (0.5044) acc_x 84.3750 (88.7500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/21] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.3147 (0.4955) acc_x 90.6250 (88.5417) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/21] time 0.181 (0.184) data 0.104 (0.108) loss_x loss_x 0.5513 (0.5032) acc_x 90.6250 (87.8125) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/29] time 0.188 (0.184) data 0.112 (0.108) loss_u loss_u 0.8872 (0.9083) acc_u 12.5000 (11.2500) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/29] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.8789 (0.9110) acc_u 12.5000 (10.0000) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/29] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8501 (0.9079) acc_u 15.6250 (10.2083) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/29] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.9707 (0.9143) acc_u 3.1250 (9.6875) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [25/29] time 0.158 (0.181) data 0.080 (0.104) loss_u loss_u 0.8516 (0.9087) acc_u 15.6250 (10.3750) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.4146, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 670
clean true:660
clean false:10
clean_rate:0.9850746268656716
noisy true:515
noisy false:431
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 946
epoch [188/200] batch [5/20] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7354 (0.5227) acc_x 78.1250 (85.0000) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/20] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.2386 (0.5127) acc_x 96.8750 (86.5625) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/20] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.3347 (0.4891) acc_x 90.6250 (87.5000) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [20/20] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.3323 (0.4916) acc_x 93.7500 (87.6562) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/29] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.9146 (0.9087) acc_u 9.3750 (10.6250) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/29] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.8584 (0.9104) acc_u 18.7500 (10.3125) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/29] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.9570 (0.9169) acc_u 6.2500 (9.5833) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/29] time 0.173 (0.183) data 0.095 (0.106) loss_u loss_u 0.8994 (0.9183) acc_u 12.5000 (9.5312) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [25/29] time 0.174 (0.182) data 0.097 (0.105) loss_u loss_u 0.9502 (0.9165) acc_u 6.2500 (9.7500) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 437
confident_label rate tensor(0.4115, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 665
clean true:655
clean false:10
clean_rate:0.9849624060150376
noisy true:524
noisy false:427
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 951
epoch [189/200] batch [5/20] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.6606 (0.6370) acc_x 84.3750 (85.6250) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/20] time 0.183 (0.168) data 0.106 (0.091) loss_x loss_x 0.5430 (0.5848) acc_x 81.2500 (84.6875) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/20] time 0.179 (0.170) data 0.102 (0.094) loss_x loss_x 0.7271 (0.5646) acc_x 84.3750 (86.0417) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [20/20] time 0.185 (0.173) data 0.109 (0.097) loss_x loss_x 0.6235 (0.5453) acc_x 78.1250 (86.5625) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/29] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.8315 (0.8946) acc_u 18.7500 (11.8750) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/29] time 0.183 (0.176) data 0.106 (0.100) loss_u loss_u 0.9678 (0.9047) acc_u 3.1250 (10.9375) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/29] time 0.182 (0.177) data 0.106 (0.100) loss_u loss_u 0.8608 (0.9035) acc_u 12.5000 (11.0417) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/29] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.8677 (0.9086) acc_u 12.5000 (10.3125) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [25/29] time 0.194 (0.179) data 0.116 (0.102) loss_u loss_u 0.8643 (0.9031) acc_u 15.6250 (10.8750) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.4226, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 683
clean true:670
clean false:13
clean_rate:0.9809663250366032
noisy true:514
noisy false:419
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 933
epoch [190/200] batch [5/21] time 0.178 (0.185) data 0.102 (0.108) loss_x loss_x 0.4414 (0.5074) acc_x 90.6250 (89.3750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/21] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.1997 (0.5189) acc_x 93.7500 (88.1250) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [15/21] time 0.176 (0.174) data 0.099 (0.098) loss_x loss_x 0.3704 (0.5104) acc_x 87.5000 (87.7083) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/21] time 0.179 (0.175) data 0.101 (0.099) loss_x loss_x 0.2737 (0.5028) acc_x 96.8750 (88.2812) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/29] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.8184 (0.9172) acc_u 21.8750 (9.3750) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/29] time 0.167 (0.176) data 0.090 (0.099) loss_u loss_u 0.9482 (0.9168) acc_u 6.2500 (10.0000) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [15/29] time 0.182 (0.176) data 0.106 (0.099) loss_u loss_u 0.8638 (0.9142) acc_u 15.6250 (10.0000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/29] time 0.168 (0.176) data 0.090 (0.099) loss_u loss_u 0.9634 (0.9217) acc_u 3.1250 (8.9062) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [25/29] time 0.165 (0.175) data 0.087 (0.097) loss_u loss_u 0.8569 (0.9201) acc_u 15.6250 (9.2500) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 659
clean true:646
clean false:13
clean_rate:0.9802731411229135
noisy true:506
noisy false:451
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 957
epoch [191/200] batch [5/20] time 0.175 (0.180) data 0.097 (0.103) loss_x loss_x 0.7031 (0.6361) acc_x 81.2500 (83.7500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/20] time 0.184 (0.179) data 0.106 (0.102) loss_x loss_x 0.4604 (0.6340) acc_x 90.6250 (84.3750) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [15/20] time 0.190 (0.181) data 0.113 (0.104) loss_x loss_x 0.4172 (0.6300) acc_x 90.6250 (84.1667) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [20/20] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.6665 (0.6211) acc_x 81.2500 (84.3750) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/29] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8628 (0.8934) acc_u 15.6250 (11.8750) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [10/29] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.9058 (0.9038) acc_u 9.3750 (10.6250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/29] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8984 (0.8974) acc_u 12.5000 (11.4583) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/29] time 0.175 (0.181) data 0.098 (0.104) loss_u loss_u 0.9619 (0.9044) acc_u 3.1250 (10.6250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [25/29] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.9316 (0.9053) acc_u 6.2500 (10.3750) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 430
confident_label rate tensor(0.4171, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 674
clean true:662
clean false:12
clean_rate:0.9821958456973294
noisy true:524
noisy false:418
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 942
epoch [192/200] batch [5/21] time 0.176 (0.175) data 0.099 (0.099) loss_x loss_x 0.3379 (0.5318) acc_x 87.5000 (88.1250) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/21] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.6724 (0.5132) acc_x 81.2500 (87.1875) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/21] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.2869 (0.4699) acc_x 100.0000 (89.1667) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/21] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.4546 (0.4772) acc_x 90.6250 (89.0625) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/29] time 0.177 (0.174) data 0.099 (0.097) loss_u loss_u 0.8979 (0.8787) acc_u 12.5000 (13.7500) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/29] time 0.190 (0.177) data 0.112 (0.099) loss_u loss_u 0.8462 (0.8911) acc_u 18.7500 (12.5000) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/29] time 0.181 (0.177) data 0.103 (0.100) loss_u loss_u 0.9253 (0.9033) acc_u 6.2500 (10.8333) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/29] time 0.170 (0.177) data 0.094 (0.100) loss_u loss_u 0.9683 (0.9084) acc_u 3.1250 (10.1562) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [25/29] time 0.173 (0.176) data 0.096 (0.099) loss_u loss_u 0.8896 (0.9053) acc_u 12.5000 (10.6250) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 447
confident_label rate tensor(0.4220, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 682
clean true:672
clean false:10
clean_rate:0.9853372434017595
noisy true:497
noisy false:437
after delete: len(clean_dataset) 682
after delete: len(noisy_dataset) 934
epoch [193/200] batch [5/21] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.3242 (0.4592) acc_x 90.6250 (88.7500) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/21] time 0.190 (0.182) data 0.113 (0.105) loss_x loss_x 0.2272 (0.4628) acc_x 90.6250 (88.4375) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/21] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.5674 (0.4960) acc_x 87.5000 (87.9167) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/21] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.4075 (0.5240) acc_x 90.6250 (87.3438) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/29] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.9473 (0.9195) acc_u 6.2500 (9.3750) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/29] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.9048 (0.9246) acc_u 12.5000 (8.7500) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/29] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9370 (0.9143) acc_u 6.2500 (10.0000) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/29] time 0.182 (0.182) data 0.106 (0.104) loss_u loss_u 0.9287 (0.9180) acc_u 9.3750 (9.3750) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [25/29] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8975 (0.9169) acc_u 9.3750 (9.3750) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 448
confident_label rate tensor(0.4109, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 664
clean true:650
clean false:14
clean_rate:0.9789156626506024
noisy true:518
noisy false:434
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 952
epoch [194/200] batch [5/20] time 0.177 (0.182) data 0.100 (0.105) loss_x loss_x 0.3494 (0.4655) acc_x 90.6250 (88.7500) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/20] time 0.170 (0.173) data 0.094 (0.096) loss_x loss_x 0.2795 (0.4683) acc_x 93.7500 (87.5000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/20] time 0.194 (0.173) data 0.117 (0.096) loss_x loss_x 0.2979 (0.4216) acc_x 93.7500 (89.1667) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [20/20] time 0.192 (0.174) data 0.116 (0.098) loss_x loss_x 0.2747 (0.4505) acc_x 93.7500 (89.3750) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/29] time 0.182 (0.175) data 0.105 (0.098) loss_u loss_u 0.8735 (0.8650) acc_u 12.5000 (14.3750) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/29] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.9307 (0.8935) acc_u 6.2500 (11.5625) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/29] time 0.182 (0.178) data 0.104 (0.101) loss_u loss_u 0.9341 (0.8936) acc_u 9.3750 (12.0833) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/29] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.9697 (0.8996) acc_u 3.1250 (11.4062) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [25/29] time 0.171 (0.176) data 0.093 (0.099) loss_u loss_u 0.9761 (0.9053) acc_u 3.1250 (11.0000) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 454
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 659
clean true:646
clean false:13
clean_rate:0.9802731411229135
noisy true:516
noisy false:441
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 957
epoch [195/200] batch [5/20] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.8804 (0.4842) acc_x 87.5000 (89.3750) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/20] time 0.158 (0.173) data 0.082 (0.096) loss_x loss_x 0.7461 (0.5494) acc_x 81.2500 (86.8750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [15/20] time 0.160 (0.169) data 0.083 (0.092) loss_x loss_x 0.8374 (0.5504) acc_x 71.8750 (86.2500) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [20/20] time 0.184 (0.169) data 0.107 (0.092) loss_x loss_x 0.4385 (0.5352) acc_x 87.5000 (86.0938) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/29] time 0.182 (0.172) data 0.105 (0.095) loss_u loss_u 0.8481 (0.8937) acc_u 25.0000 (13.1250) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/29] time 0.181 (0.174) data 0.105 (0.097) loss_u loss_u 0.8086 (0.9033) acc_u 25.0000 (11.8750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/29] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.9395 (0.9088) acc_u 6.2500 (10.8333) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/29] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.9448 (0.9070) acc_u 6.2500 (11.2500) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [25/29] time 0.189 (0.177) data 0.112 (0.100) loss_u loss_u 0.9229 (0.9047) acc_u 9.3750 (11.3750) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 455
confident_label rate tensor(0.4066, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 657
clean true:648
clean false:9
clean_rate:0.9863013698630136
noisy true:513
noisy false:446
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 959
epoch [196/200] batch [5/20] time 0.184 (0.175) data 0.108 (0.099) loss_x loss_x 0.2076 (0.4852) acc_x 96.8750 (89.3750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/20] time 0.179 (0.174) data 0.102 (0.098) loss_x loss_x 0.8745 (0.5580) acc_x 84.3750 (87.5000) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/20] time 0.182 (0.175) data 0.106 (0.099) loss_x loss_x 0.3511 (0.5296) acc_x 90.6250 (87.5000) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [20/20] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 0.4824 (0.5497) acc_x 90.6250 (86.7188) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/29] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.9297 (0.8960) acc_u 6.2500 (12.5000) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/29] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.8921 (0.8997) acc_u 12.5000 (11.5625) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/29] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.9932 (0.9017) acc_u 0.0000 (11.0417) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/29] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.8916 (0.9062) acc_u 12.5000 (10.4688) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [25/29] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.8672 (0.9016) acc_u 15.6250 (11.1250) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 458
confident_label rate tensor(0.4152, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 671
clean true:661
clean false:10
clean_rate:0.9850968703427719
noisy true:497
noisy false:448
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 945
epoch [197/200] batch [5/20] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.6943 (0.4766) acc_x 78.1250 (89.3750) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/20] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5278 (0.5070) acc_x 87.5000 (88.1250) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/20] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.4221 (0.4946) acc_x 93.7500 (88.7500) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [20/20] time 0.187 (0.185) data 0.107 (0.107) loss_x loss_x 0.7114 (0.5023) acc_x 78.1250 (87.8125) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/29] time 0.185 (0.185) data 0.108 (0.107) loss_u loss_u 0.9370 (0.9257) acc_u 6.2500 (8.7500) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/29] time 0.186 (0.185) data 0.108 (0.107) loss_u loss_u 0.9487 (0.9261) acc_u 6.2500 (8.7500) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/29] time 0.186 (0.185) data 0.107 (0.107) loss_u loss_u 0.8931 (0.9189) acc_u 12.5000 (9.7917) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/29] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9829 (0.9230) acc_u 3.1250 (9.3750) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [25/29] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8525 (0.9192) acc_u 18.7500 (9.7500) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 440
confident_label rate tensor(0.4171, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 674
clean true:663
clean false:11
clean_rate:0.983679525222552
noisy true:513
noisy false:429
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 942
epoch [198/200] batch [5/21] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.7236 (0.4399) acc_x 84.3750 (89.3750) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/21] time 0.161 (0.180) data 0.085 (0.104) loss_x loss_x 0.3787 (0.4745) acc_x 93.7500 (87.8125) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/21] time 0.181 (0.178) data 0.105 (0.102) loss_x loss_x 0.4136 (0.4585) acc_x 90.6250 (88.3333) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/21] time 0.162 (0.176) data 0.086 (0.100) loss_x loss_x 0.3796 (0.4859) acc_x 90.6250 (87.3438) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/29] time 0.160 (0.173) data 0.083 (0.097) loss_u loss_u 0.9741 (0.9131) acc_u 3.1250 (8.7500) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/29] time 0.161 (0.171) data 0.084 (0.095) loss_u loss_u 0.8950 (0.9192) acc_u 9.3750 (8.4375) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/29] time 0.177 (0.170) data 0.099 (0.094) loss_u loss_u 0.9326 (0.9194) acc_u 6.2500 (8.5417) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/29] time 0.178 (0.171) data 0.101 (0.094) loss_u loss_u 0.8716 (0.9161) acc_u 15.6250 (9.2188) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [25/29] time 0.191 (0.172) data 0.113 (0.095) loss_u loss_u 0.9365 (0.9198) acc_u 9.3750 (8.8750) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 467
confident_label rate tensor(0.4066, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 657
clean true:642
clean false:15
clean_rate:0.9771689497716894
noisy true:507
noisy false:452
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 959
epoch [199/200] batch [5/20] time 0.175 (0.180) data 0.099 (0.103) loss_x loss_x 0.4099 (0.5178) acc_x 90.6250 (86.8750) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/20] time 0.180 (0.179) data 0.103 (0.103) loss_x loss_x 0.7412 (0.5077) acc_x 81.2500 (86.8750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [15/20] time 0.183 (0.180) data 0.106 (0.104) loss_x loss_x 0.4321 (0.5590) acc_x 93.7500 (86.6667) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [20/20] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.7520 (0.5927) acc_x 78.1250 (85.6250) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/29] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8457 (0.8798) acc_u 15.6250 (13.7500) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/29] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8965 (0.8990) acc_u 12.5000 (11.5625) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/29] time 0.172 (0.181) data 0.095 (0.105) loss_u loss_u 0.8774 (0.8951) acc_u 12.5000 (12.0833) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/29] time 0.170 (0.179) data 0.092 (0.103) loss_u loss_u 0.9399 (0.8995) acc_u 6.2500 (11.4062) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [25/29] time 0.168 (0.179) data 0.090 (0.102) loss_u loss_u 0.9092 (0.9008) acc_u 12.5000 (11.3750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 455
confident_label rate tensor(0.4121, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 666
clean true:653
clean false:13
clean_rate:0.9804804804804805
noisy true:508
noisy false:442
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 950
epoch [200/200] batch [5/20] time 0.210 (0.205) data 0.133 (0.129) loss_x loss_x 0.2786 (0.4208) acc_x 93.7500 (88.7500) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/20] time 0.197 (0.192) data 0.120 (0.116) loss_x loss_x 0.4553 (0.4542) acc_x 90.6250 (89.3750) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/20] time 0.204 (0.194) data 0.127 (0.117) loss_x loss_x 0.3892 (0.4681) acc_x 87.5000 (89.1667) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [20/20] time 0.181 (0.191) data 0.105 (0.114) loss_x loss_x 0.7290 (0.4930) acc_x 84.3750 (88.9062) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/29] time 0.183 (0.189) data 0.106 (0.112) loss_u loss_u 0.8765 (0.8980) acc_u 15.6250 (12.5000) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/29] time 0.185 (0.188) data 0.107 (0.111) loss_u loss_u 0.7856 (0.8873) acc_u 25.0000 (13.1250) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/29] time 0.182 (0.187) data 0.105 (0.110) loss_u loss_u 0.8652 (0.8953) acc_u 12.5000 (11.8750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/29] time 0.195 (0.187) data 0.119 (0.110) loss_u loss_u 0.9028 (0.8973) acc_u 9.3750 (11.5625) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [25/29] time 0.182 (0.187) data 0.105 (0.110) loss_u loss_u 0.9155 (0.9032) acc_u 9.3750 (10.8750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,722
* accuracy: 72.0%
* error: 28.0%
* macro_f1: 70.3%
Elapsed: 0:58:57
