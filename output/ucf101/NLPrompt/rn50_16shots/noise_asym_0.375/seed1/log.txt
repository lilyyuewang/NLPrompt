***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.2036, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 329
clean true:313
clean false:16
clean_rate:0.9513677811550152
noisy true:199
noisy false:1088
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1287
epoch [1/200] batch [5/10] time 0.185 (0.219) data 0.108 (0.120) loss_x loss_x 2.4824 (2.7418) acc_x 53.1250 (46.2500) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/10] time 0.178 (0.199) data 0.100 (0.110) loss_x loss_x 2.0449 (2.5322) acc_x 65.6250 (52.1875) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/40] time 0.177 (0.193) data 0.098 (0.107) loss_u loss_u 0.9434 (0.9533) acc_u 18.7500 (14.3750) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [10/40] time 0.167 (0.188) data 0.088 (0.104) loss_u loss_u 0.9678 (0.9542) acc_u 0.0000 (11.2500) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [15/40] time 0.194 (0.187) data 0.116 (0.104) loss_u loss_u 0.9326 (0.9525) acc_u 12.5000 (11.0417) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [20/40] time 0.189 (0.188) data 0.111 (0.106) loss_u loss_u 0.9458 (0.9505) acc_u 6.2500 (10.9375) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [25/40] time 0.195 (0.188) data 0.117 (0.106) loss_u loss_u 0.9697 (0.9500) acc_u 9.3750 (10.7500) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [30/40] time 0.194 (0.189) data 0.117 (0.108) loss_u loss_u 0.9370 (0.9473) acc_u 15.6250 (11.5625) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [35/40] time 0.192 (0.190) data 0.113 (0.109) loss_u loss_u 0.9355 (0.9471) acc_u 12.5000 (11.7857) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [40/40] time 0.187 (0.189) data 0.110 (0.108) loss_u loss_u 0.9346 (0.9463) acc_u 12.5000 (12.1875) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 976
confident_label rate tensor(0.2519, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 407
clean true:393
clean false:14
clean_rate:0.9656019656019657
noisy true:247
noisy false:962
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1209
epoch [2/200] batch [5/12] time 0.169 (0.179) data 0.092 (0.101) loss_x loss_x 1.2422 (1.3959) acc_x 65.6250 (66.2500) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/12] time 0.182 (0.177) data 0.105 (0.099) loss_x loss_x 1.1279 (1.4294) acc_x 65.6250 (63.1250) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/37] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.8691 (0.8895) acc_u 12.5000 (14.3750) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [10/37] time 0.165 (0.175) data 0.087 (0.097) loss_u loss_u 0.8521 (0.8816) acc_u 15.6250 (14.3750) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [15/37] time 0.174 (0.175) data 0.094 (0.097) loss_u loss_u 0.8228 (0.8642) acc_u 25.0000 (17.0833) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [20/37] time 0.164 (0.174) data 0.086 (0.096) loss_u loss_u 0.8525 (0.8637) acc_u 18.7500 (16.8750) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [25/37] time 0.174 (0.173) data 0.095 (0.095) loss_u loss_u 0.7324 (0.8583) acc_u 34.3750 (17.2500) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [30/37] time 0.174 (0.173) data 0.096 (0.095) loss_u loss_u 0.8574 (0.8555) acc_u 12.5000 (17.9167) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [35/37] time 0.181 (0.174) data 0.102 (0.096) loss_u loss_u 0.8853 (0.8534) acc_u 12.5000 (18.1250) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 802
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 517
clean true:509
clean false:8
clean_rate:0.9845261121856866
noisy true:305
noisy false:794
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1099
epoch [3/200] batch [5/16] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.9644 (1.1888) acc_x 78.1250 (70.6250) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/16] time 0.167 (0.181) data 0.090 (0.103) loss_x loss_x 0.9639 (1.1932) acc_x 71.8750 (67.1875) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/16] time 0.171 (0.178) data 0.094 (0.101) loss_x loss_x 1.5459 (1.1772) acc_x 65.6250 (68.7500) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/34] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.8535 (0.8406) acc_u 18.7500 (20.0000) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [10/34] time 0.169 (0.177) data 0.091 (0.100) loss_u loss_u 0.9453 (0.8586) acc_u 6.2500 (16.8750) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [15/34] time 0.161 (0.175) data 0.082 (0.097) loss_u loss_u 0.8667 (0.8613) acc_u 18.7500 (17.5000) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [20/34] time 0.192 (0.176) data 0.114 (0.099) loss_u loss_u 0.9204 (0.8744) acc_u 12.5000 (15.9375) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [25/34] time 0.185 (0.178) data 0.106 (0.100) loss_u loss_u 0.8428 (0.8769) acc_u 21.8750 (15.7500) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [30/34] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.8784 (0.8786) acc_u 18.7500 (15.6250) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 759
confident_label rate tensor(0.3292, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 532
clean true:521
clean false:11
clean_rate:0.9793233082706767
noisy true:336
noisy false:748
after delete: len(clean_dataset) 532
after delete: len(noisy_dataset) 1084
epoch [4/200] batch [5/16] time 0.172 (0.179) data 0.095 (0.101) loss_x loss_x 1.0908 (1.1624) acc_x 78.1250 (70.0000) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/16] time 0.175 (0.180) data 0.098 (0.102) loss_x loss_x 0.6733 (1.1341) acc_x 71.8750 (67.8125) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [15/16] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 0.8892 (1.0801) acc_x 75.0000 (70.6250) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/33] time 0.188 (0.184) data 0.111 (0.106) loss_u loss_u 0.8516 (0.8463) acc_u 21.8750 (22.5000) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [10/33] time 0.171 (0.183) data 0.092 (0.106) loss_u loss_u 0.9238 (0.8580) acc_u 12.5000 (20.3125) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [15/33] time 0.178 (0.184) data 0.100 (0.106) loss_u loss_u 0.8750 (0.8573) acc_u 21.8750 (20.0000) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [20/33] time 0.165 (0.183) data 0.087 (0.106) loss_u loss_u 0.8350 (0.8581) acc_u 21.8750 (19.3750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [25/33] time 0.173 (0.183) data 0.095 (0.105) loss_u loss_u 0.8745 (0.8649) acc_u 18.7500 (18.1250) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [30/33] time 0.171 (0.181) data 0.093 (0.104) loss_u loss_u 0.9268 (0.8689) acc_u 9.3750 (17.3958) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 772
confident_label rate tensor(0.3459, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 559
clean true:543
clean false:16
clean_rate:0.9713774597495528
noisy true:301
noisy false:756
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 1057
epoch [5/200] batch [5/17] time 0.185 (0.183) data 0.108 (0.105) loss_x loss_x 1.1934 (1.0264) acc_x 68.7500 (73.7500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/17] time 0.188 (0.180) data 0.111 (0.103) loss_x loss_x 1.1162 (0.9816) acc_x 71.8750 (76.2500) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/17] time 0.191 (0.183) data 0.112 (0.105) loss_x loss_x 1.1543 (1.0302) acc_x 65.6250 (73.9583) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/33] time 0.200 (0.185) data 0.121 (0.107) loss_u loss_u 0.7578 (0.8632) acc_u 31.2500 (15.6250) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [10/33] time 0.188 (0.186) data 0.109 (0.108) loss_u loss_u 0.8745 (0.8678) acc_u 9.3750 (15.3125) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [15/33] time 0.181 (0.186) data 0.102 (0.108) loss_u loss_u 0.9253 (0.8717) acc_u 9.3750 (14.3750) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [20/33] time 0.186 (0.186) data 0.109 (0.108) loss_u loss_u 0.8945 (0.8768) acc_u 15.6250 (14.0625) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [25/33] time 0.182 (0.186) data 0.104 (0.108) loss_u loss_u 0.8774 (0.8755) acc_u 12.5000 (13.7500) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [30/33] time 0.172 (0.185) data 0.094 (0.107) loss_u loss_u 0.8125 (0.8772) acc_u 21.8750 (13.7500) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 732
confident_label rate tensor(0.3472, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 561
clean true:550
clean false:11
clean_rate:0.9803921568627451
noisy true:334
noisy false:721
after delete: len(clean_dataset) 561
after delete: len(noisy_dataset) 1055
epoch [6/200] batch [5/17] time 0.187 (0.192) data 0.109 (0.115) loss_x loss_x 1.3096 (1.0966) acc_x 65.6250 (71.2500) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/17] time 0.172 (0.186) data 0.095 (0.109) loss_x loss_x 0.8730 (0.9137) acc_x 75.0000 (76.2500) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [15/17] time 0.176 (0.184) data 0.099 (0.107) loss_x loss_x 1.0938 (0.9300) acc_x 68.7500 (76.2500) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/32] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.9004 (0.9021) acc_u 9.3750 (10.6250) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/32] time 0.171 (0.181) data 0.093 (0.103) loss_u loss_u 0.9253 (0.8734) acc_u 12.5000 (13.7500) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/32] time 0.172 (0.179) data 0.094 (0.101) loss_u loss_u 0.9126 (0.8786) acc_u 9.3750 (13.7500) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [20/32] time 0.177 (0.178) data 0.099 (0.100) loss_u loss_u 0.9058 (0.8802) acc_u 9.3750 (13.1250) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [25/32] time 0.183 (0.178) data 0.105 (0.100) loss_u loss_u 0.8291 (0.8744) acc_u 25.0000 (14.0000) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [30/32] time 0.178 (0.179) data 0.099 (0.101) loss_u loss_u 0.8589 (0.8739) acc_u 15.6250 (14.2708) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 719
confident_label rate tensor(0.3595, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 581
clean true:571
clean false:10
clean_rate:0.9827882960413081
noisy true:326
noisy false:709
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1035
epoch [7/200] batch [5/18] time 0.185 (0.188) data 0.108 (0.110) loss_x loss_x 1.5420 (1.0577) acc_x 59.3750 (73.7500) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/18] time 0.185 (0.188) data 0.108 (0.110) loss_x loss_x 0.8169 (0.9983) acc_x 81.2500 (76.8750) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [15/18] time 0.172 (0.186) data 0.094 (0.108) loss_x loss_x 0.6992 (1.0374) acc_x 81.2500 (76.0417) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/32] time 0.163 (0.184) data 0.085 (0.106) loss_u loss_u 0.8975 (0.8740) acc_u 9.3750 (15.6250) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/32] time 0.187 (0.183) data 0.109 (0.105) loss_u loss_u 0.8911 (0.8758) acc_u 9.3750 (14.6875) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [15/32] time 0.187 (0.183) data 0.109 (0.105) loss_u loss_u 0.8945 (0.8708) acc_u 15.6250 (16.4583) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/32] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9561 (0.8740) acc_u 3.1250 (15.6250) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [25/32] time 0.184 (0.184) data 0.107 (0.106) loss_u loss_u 0.8809 (0.8782) acc_u 18.7500 (15.0000) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [30/32] time 0.186 (0.184) data 0.108 (0.106) loss_u loss_u 0.8989 (0.8840) acc_u 9.3750 (14.3750) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 702
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 601
clean true:586
clean false:15
clean_rate:0.9750415973377704
noisy true:328
noisy false:687
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1015
epoch [8/200] batch [5/18] time 0.184 (0.188) data 0.106 (0.110) loss_x loss_x 0.7427 (0.9673) acc_x 81.2500 (72.5000) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/18] time 0.189 (0.183) data 0.111 (0.105) loss_x loss_x 0.7100 (0.9645) acc_x 81.2500 (73.1250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/18] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 1.0977 (0.9291) acc_x 65.6250 (74.3750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/31] time 0.187 (0.181) data 0.108 (0.103) loss_u loss_u 0.8950 (0.8776) acc_u 12.5000 (13.1250) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/31] time 0.164 (0.179) data 0.086 (0.102) loss_u loss_u 0.8555 (0.8725) acc_u 15.6250 (14.3750) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/31] time 0.180 (0.177) data 0.102 (0.099) loss_u loss_u 0.9526 (0.8848) acc_u 3.1250 (12.9167) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/31] time 0.172 (0.177) data 0.094 (0.099) loss_u loss_u 0.9595 (0.8803) acc_u 0.0000 (13.5938) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [25/31] time 0.172 (0.176) data 0.094 (0.098) loss_u loss_u 0.8213 (0.8771) acc_u 28.1250 (14.1250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [30/31] time 0.202 (0.176) data 0.124 (0.098) loss_u loss_u 0.8652 (0.8779) acc_u 15.6250 (13.9583) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.3663, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 592
clean true:577
clean false:15
clean_rate:0.9746621621621622
noisy true:353
noisy false:671
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1024
epoch [9/200] batch [5/18] time 0.189 (0.186) data 0.111 (0.109) loss_x loss_x 0.6538 (0.8812) acc_x 84.3750 (76.2500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/18] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.6069 (0.8874) acc_x 84.3750 (77.8125) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [15/18] time 0.179 (0.184) data 0.101 (0.107) loss_x loss_x 1.5615 (1.0241) acc_x 59.3750 (75.2083) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/32] time 0.187 (0.181) data 0.109 (0.103) loss_u loss_u 0.8174 (0.8405) acc_u 28.1250 (21.8750) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/32] time 0.168 (0.179) data 0.090 (0.101) loss_u loss_u 0.8604 (0.8508) acc_u 9.3750 (19.0625) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/32] time 0.179 (0.178) data 0.101 (0.100) loss_u loss_u 0.9292 (0.8590) acc_u 6.2500 (17.2917) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [20/32] time 0.189 (0.178) data 0.111 (0.100) loss_u loss_u 0.8174 (0.8626) acc_u 15.6250 (16.4062) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [25/32] time 0.189 (0.179) data 0.111 (0.101) loss_u loss_u 0.8447 (0.8655) acc_u 18.7500 (16.3750) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [30/32] time 0.174 (0.179) data 0.097 (0.101) loss_u loss_u 0.8701 (0.8684) acc_u 15.6250 (15.8333) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:599
clean false:16
clean_rate:0.9739837398373984
noisy true:341
noisy false:660
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [10/200] batch [5/19] time 0.188 (0.186) data 0.109 (0.108) loss_x loss_x 0.7046 (0.9943) acc_x 81.2500 (74.3750) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/19] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 1.1318 (0.9698) acc_x 62.5000 (72.8125) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [15/19] time 0.178 (0.181) data 0.100 (0.104) loss_x loss_x 1.2930 (0.9720) acc_x 65.6250 (72.5000) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/31] time 0.195 (0.187) data 0.117 (0.109) loss_u loss_u 0.8750 (0.8690) acc_u 12.5000 (14.3750) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/31] time 0.185 (0.187) data 0.107 (0.109) loss_u loss_u 0.9194 (0.8810) acc_u 6.2500 (14.3750) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [15/31] time 0.185 (0.186) data 0.107 (0.109) loss_u loss_u 0.9399 (0.8823) acc_u 6.2500 (14.7917) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [20/31] time 0.183 (0.186) data 0.105 (0.109) loss_u loss_u 0.8545 (0.8848) acc_u 15.6250 (14.5312) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [25/31] time 0.184 (0.186) data 0.107 (0.108) loss_u loss_u 0.9033 (0.8811) acc_u 9.3750 (14.1250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [30/31] time 0.185 (0.186) data 0.107 (0.108) loss_u loss_u 0.8491 (0.8784) acc_u 18.7500 (14.3750) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 669
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 618
clean true:608
clean false:10
clean_rate:0.9838187702265372
noisy true:339
noisy false:659
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 998
epoch [11/200] batch [5/19] time 0.177 (0.184) data 0.098 (0.106) loss_x loss_x 0.8838 (0.9119) acc_x 78.1250 (78.1250) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/19] time 0.187 (0.182) data 0.109 (0.104) loss_x loss_x 0.5698 (0.8664) acc_x 81.2500 (77.5000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/19] time 0.171 (0.181) data 0.094 (0.103) loss_x loss_x 0.7319 (0.8556) acc_x 81.2500 (78.3333) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/31] time 0.164 (0.176) data 0.085 (0.099) loss_u loss_u 0.9365 (0.8717) acc_u 3.1250 (13.7500) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/31] time 0.188 (0.176) data 0.111 (0.098) loss_u loss_u 0.9316 (0.8736) acc_u 6.2500 (13.7500) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/31] time 0.186 (0.177) data 0.109 (0.099) loss_u loss_u 0.8716 (0.8738) acc_u 12.5000 (13.9583) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/31] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.8379 (0.8733) acc_u 15.6250 (13.7500) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [25/31] time 0.183 (0.179) data 0.105 (0.101) loss_u loss_u 0.8394 (0.8727) acc_u 21.8750 (13.8750) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [30/31] time 0.163 (0.178) data 0.086 (0.101) loss_u loss_u 0.8594 (0.8743) acc_u 18.7500 (13.9583) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 663
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 617
clean true:600
clean false:17
clean_rate:0.9724473257698542
noisy true:353
noisy false:646
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 999
epoch [12/200] batch [5/19] time 0.176 (0.177) data 0.098 (0.099) loss_x loss_x 0.7954 (0.9371) acc_x 81.2500 (79.3750) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/19] time 0.169 (0.178) data 0.092 (0.100) loss_x loss_x 1.1514 (0.9075) acc_x 78.1250 (78.1250) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [15/19] time 0.187 (0.180) data 0.110 (0.102) loss_x loss_x 0.6738 (0.8994) acc_x 78.1250 (76.8750) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/31] time 0.162 (0.178) data 0.083 (0.100) loss_u loss_u 0.9126 (0.8797) acc_u 9.3750 (14.3750) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/31] time 0.167 (0.177) data 0.089 (0.099) loss_u loss_u 0.8418 (0.8698) acc_u 18.7500 (14.6875) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/31] time 0.162 (0.175) data 0.085 (0.098) loss_u loss_u 0.9058 (0.8656) acc_u 9.3750 (14.7917) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/31] time 0.168 (0.174) data 0.090 (0.096) loss_u loss_u 0.8916 (0.8666) acc_u 12.5000 (14.5312) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [25/31] time 0.165 (0.173) data 0.087 (0.096) loss_u loss_u 0.9116 (0.8663) acc_u 12.5000 (14.7500) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [30/31] time 0.181 (0.174) data 0.104 (0.096) loss_u loss_u 0.8042 (0.8652) acc_u 21.8750 (14.8958) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 675
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:625
clean false:15
clean_rate:0.9765625
noisy true:316
noisy false:660
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [13/200] batch [5/20] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 1.0742 (1.0215) acc_x 71.8750 (73.7500) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/20] time 0.187 (0.186) data 0.110 (0.108) loss_x loss_x 0.9424 (0.9712) acc_x 78.1250 (75.3125) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [15/20] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.9028 (0.9771) acc_x 71.8750 (74.3750) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [20/20] time 0.163 (0.184) data 0.085 (0.107) loss_x loss_x 1.4609 (1.0049) acc_x 65.6250 (74.3750) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/30] time 0.182 (0.183) data 0.104 (0.105) loss_u loss_u 0.9468 (0.9062) acc_u 6.2500 (10.0000) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/30] time 0.172 (0.181) data 0.094 (0.103) loss_u loss_u 0.8940 (0.8953) acc_u 18.7500 (12.1875) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [15/30] time 0.188 (0.181) data 0.109 (0.103) loss_u loss_u 0.8018 (0.8824) acc_u 25.0000 (13.7500) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/30] time 0.186 (0.182) data 0.108 (0.104) loss_u loss_u 0.8228 (0.8729) acc_u 15.6250 (14.5312) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [25/30] time 0.184 (0.182) data 0.106 (0.104) loss_u loss_u 0.8818 (0.8700) acc_u 12.5000 (14.8750) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [30/30] time 0.185 (0.183) data 0.106 (0.105) loss_u loss_u 0.8872 (0.8727) acc_u 12.5000 (14.4792) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 626
clean true:611
clean false:15
clean_rate:0.9760383386581469
noisy true:346
noisy false:644
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 990
epoch [14/200] batch [5/19] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 1.2383 (0.9818) acc_x 65.6250 (76.2500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/19] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.6372 (1.1065) acc_x 75.0000 (73.1250) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [15/19] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 1.1035 (1.1171) acc_x 71.8750 (71.6667) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/30] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.8726 (0.8475) acc_u 12.5000 (16.2500) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/30] time 0.185 (0.184) data 0.106 (0.106) loss_u loss_u 0.8066 (0.8575) acc_u 18.7500 (15.0000) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [15/30] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.8711 (0.8674) acc_u 9.3750 (13.1250) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [20/30] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.9126 (0.8716) acc_u 9.3750 (12.9688) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [25/30] time 0.183 (0.184) data 0.105 (0.106) loss_u loss_u 0.9219 (0.8766) acc_u 12.5000 (12.5000) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [30/30] time 0.185 (0.184) data 0.106 (0.106) loss_u loss_u 0.8384 (0.8727) acc_u 15.6250 (13.0208) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 645
confident_label rate tensor(0.3998, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 646
clean true:632
clean false:14
clean_rate:0.978328173374613
noisy true:339
noisy false:631
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 970
epoch [15/200] batch [5/20] time 0.191 (0.188) data 0.113 (0.110) loss_x loss_x 0.7812 (0.9498) acc_x 78.1250 (76.8750) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/20] time 0.185 (0.189) data 0.108 (0.111) loss_x loss_x 1.2188 (0.8894) acc_x 71.8750 (77.1875) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [15/20] time 0.195 (0.189) data 0.118 (0.112) loss_x loss_x 0.9497 (0.8628) acc_x 68.7500 (77.0833) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [20/20] time 0.168 (0.186) data 0.091 (0.109) loss_x loss_x 1.0420 (0.8887) acc_x 75.0000 (75.7812) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/30] time 0.163 (0.185) data 0.085 (0.108) loss_u loss_u 0.9111 (0.8588) acc_u 15.6250 (17.5000) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [10/30] time 0.163 (0.182) data 0.086 (0.104) loss_u loss_u 0.9253 (0.8810) acc_u 6.2500 (15.0000) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [15/30] time 0.161 (0.179) data 0.083 (0.102) loss_u loss_u 0.8657 (0.8850) acc_u 15.6250 (14.5833) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/30] time 0.167 (0.178) data 0.088 (0.100) loss_u loss_u 0.9316 (0.8720) acc_u 9.3750 (15.7812) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [25/30] time 0.179 (0.177) data 0.100 (0.099) loss_u loss_u 0.9170 (0.8768) acc_u 6.2500 (15.6250) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [30/30] time 0.183 (0.178) data 0.104 (0.100) loss_u loss_u 0.8442 (0.8773) acc_u 15.6250 (15.3125) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 651
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:624
clean false:16
clean_rate:0.975
noisy true:341
noisy false:635
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [16/200] batch [5/20] time 0.188 (0.196) data 0.110 (0.118) loss_x loss_x 0.4380 (0.8956) acc_x 90.6250 (74.3750) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/20] time 0.182 (0.186) data 0.105 (0.108) loss_x loss_x 1.3467 (1.0007) acc_x 71.8750 (74.0625) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [15/20] time 0.174 (0.184) data 0.095 (0.106) loss_x loss_x 0.9307 (0.9138) acc_x 78.1250 (76.4583) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [20/20] time 0.178 (0.180) data 0.100 (0.103) loss_x loss_x 0.8047 (0.9156) acc_x 78.1250 (76.0938) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/30] time 0.161 (0.178) data 0.084 (0.100) loss_u loss_u 0.9165 (0.9113) acc_u 15.6250 (10.0000) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [10/30] time 0.176 (0.177) data 0.097 (0.099) loss_u loss_u 0.8608 (0.8871) acc_u 15.6250 (13.4375) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [15/30] time 0.170 (0.177) data 0.092 (0.099) loss_u loss_u 0.8843 (0.8890) acc_u 18.7500 (13.3333) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/30] time 0.180 (0.178) data 0.102 (0.100) loss_u loss_u 0.9229 (0.8904) acc_u 6.2500 (12.9688) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [25/30] time 0.162 (0.177) data 0.084 (0.099) loss_u loss_u 0.8652 (0.8799) acc_u 25.0000 (14.6250) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [30/30] time 0.173 (0.177) data 0.095 (0.099) loss_u loss_u 0.8052 (0.8701) acc_u 18.7500 (15.7292) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 602
confident_label rate tensor(0.4090, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 661
clean true:647
clean false:14
clean_rate:0.9788199697428139
noisy true:367
noisy false:588
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 955
epoch [17/200] batch [5/20] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 1.6016 (0.9044) acc_x 59.3750 (74.3750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/20] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.5474 (0.8458) acc_x 71.8750 (75.3125) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [15/20] time 0.161 (0.182) data 0.083 (0.105) loss_x loss_x 0.7847 (0.7633) acc_x 84.3750 (78.5417) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [20/20] time 0.180 (0.180) data 0.103 (0.102) loss_x loss_x 0.9800 (0.8082) acc_x 65.6250 (77.3438) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/29] time 0.163 (0.179) data 0.086 (0.102) loss_u loss_u 0.9609 (0.8732) acc_u 3.1250 (15.0000) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [10/29] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.8521 (0.8614) acc_u 21.8750 (17.8125) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/29] time 0.172 (0.178) data 0.094 (0.101) loss_u loss_u 0.8794 (0.8760) acc_u 15.6250 (15.6250) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/29] time 0.171 (0.177) data 0.093 (0.100) loss_u loss_u 0.8857 (0.8722) acc_u 15.6250 (15.9375) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [25/29] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.8809 (0.8697) acc_u 15.6250 (16.1250) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.4072, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 658
clean true:642
clean false:16
clean_rate:0.9756838905775076
noisy true:350
noisy false:608
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 958
epoch [18/200] batch [5/20] time 0.172 (0.172) data 0.094 (0.095) loss_x loss_x 0.6162 (0.8453) acc_x 75.0000 (78.1250) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/20] time 0.192 (0.175) data 0.114 (0.097) loss_x loss_x 0.6895 (0.8471) acc_x 84.3750 (78.1250) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [15/20] time 0.175 (0.176) data 0.098 (0.098) loss_x loss_x 0.6934 (0.8707) acc_x 81.2500 (78.1250) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [20/20] time 0.189 (0.176) data 0.111 (0.099) loss_x loss_x 0.9048 (0.8529) acc_x 78.1250 (78.4375) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/29] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.8828 (0.8937) acc_u 21.8750 (16.2500) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [10/29] time 0.189 (0.179) data 0.112 (0.102) loss_u loss_u 0.9263 (0.8875) acc_u 9.3750 (14.3750) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/29] time 0.165 (0.178) data 0.087 (0.101) loss_u loss_u 0.8325 (0.8740) acc_u 21.8750 (16.2500) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/29] time 0.179 (0.179) data 0.101 (0.102) loss_u loss_u 0.7954 (0.8730) acc_u 28.1250 (16.2500) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [25/29] time 0.164 (0.178) data 0.086 (0.100) loss_u loss_u 0.8394 (0.8723) acc_u 15.6250 (16.0000) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.4177, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 675
clean true:661
clean false:14
clean_rate:0.9792592592592593
noisy true:345
noisy false:596
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 941
epoch [19/200] batch [5/21] time 0.185 (0.191) data 0.107 (0.113) loss_x loss_x 1.0195 (0.7847) acc_x 68.7500 (76.8750) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/21] time 0.190 (0.189) data 0.111 (0.112) loss_x loss_x 1.6553 (0.8150) acc_x 62.5000 (78.7500) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/21] time 0.185 (0.188) data 0.109 (0.111) loss_x loss_x 0.7930 (0.8004) acc_x 78.1250 (79.1667) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/21] time 0.158 (0.186) data 0.081 (0.109) loss_x loss_x 1.5371 (0.8852) acc_x 65.6250 (77.8125) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/29] time 0.187 (0.184) data 0.109 (0.107) loss_u loss_u 0.8833 (0.8956) acc_u 15.6250 (12.5000) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [10/29] time 0.187 (0.185) data 0.108 (0.107) loss_u loss_u 0.8472 (0.8978) acc_u 18.7500 (12.5000) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/29] time 0.186 (0.185) data 0.108 (0.107) loss_u loss_u 0.8828 (0.8773) acc_u 18.7500 (15.0000) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [20/29] time 0.174 (0.185) data 0.096 (0.107) loss_u loss_u 0.8413 (0.8764) acc_u 21.8750 (15.0000) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [25/29] time 0.168 (0.183) data 0.090 (0.105) loss_u loss_u 0.8921 (0.8836) acc_u 15.6250 (14.1250) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 650
confident_label rate tensor(0.3948, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 638
clean true:621
clean false:17
clean_rate:0.9733542319749217
noisy true:345
noisy false:633
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 978
epoch [20/200] batch [5/19] time 0.181 (0.181) data 0.103 (0.103) loss_x loss_x 1.1230 (1.0101) acc_x 71.8750 (71.2500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [10/19] time 0.197 (0.188) data 0.120 (0.110) loss_x loss_x 0.9312 (0.9357) acc_x 71.8750 (75.3125) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [15/19] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 0.8804 (0.9044) acc_x 75.0000 (75.4167) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/30] time 0.185 (0.186) data 0.107 (0.109) loss_u loss_u 0.9058 (0.8519) acc_u 9.3750 (16.2500) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/30] time 0.186 (0.186) data 0.108 (0.109) loss_u loss_u 0.8486 (0.8351) acc_u 15.6250 (20.0000) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/30] time 0.183 (0.186) data 0.105 (0.109) loss_u loss_u 0.9375 (0.8438) acc_u 6.2500 (18.7500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/30] time 0.176 (0.185) data 0.098 (0.107) loss_u loss_u 0.9175 (0.8498) acc_u 12.5000 (18.1250) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [25/30] time 0.167 (0.183) data 0.089 (0.106) loss_u loss_u 0.9155 (0.8577) acc_u 9.3750 (16.7500) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [30/30] time 0.168 (0.182) data 0.090 (0.105) loss_u loss_u 0.8765 (0.8563) acc_u 12.5000 (16.9792) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 616
confident_label rate tensor(0.4072, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 658
clean true:644
clean false:14
clean_rate:0.9787234042553191
noisy true:356
noisy false:602
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 958
epoch [21/200] batch [5/20] time 0.159 (0.172) data 0.082 (0.094) loss_x loss_x 0.7832 (0.8631) acc_x 81.2500 (75.6250) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [10/20] time 0.159 (0.167) data 0.082 (0.090) loss_x loss_x 1.2881 (0.8380) acc_x 68.7500 (75.9375) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [15/20] time 0.160 (0.166) data 0.083 (0.088) loss_x loss_x 0.7852 (0.8059) acc_x 84.3750 (77.9167) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [20/20] time 0.232 (0.172) data 0.154 (0.094) loss_x loss_x 1.1270 (0.8192) acc_x 71.8750 (77.9688) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/29] time 0.208 (0.179) data 0.131 (0.102) loss_u loss_u 0.8013 (0.8545) acc_u 25.0000 (18.1250) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [10/29] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8394 (0.8415) acc_u 18.7500 (19.0625) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [15/29] time 0.207 (0.184) data 0.129 (0.107) loss_u loss_u 0.9243 (0.8569) acc_u 12.5000 (17.0833) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [20/29] time 0.193 (0.186) data 0.115 (0.109) loss_u loss_u 0.8774 (0.8607) acc_u 12.5000 (16.5625) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [25/29] time 0.194 (0.186) data 0.117 (0.109) loss_u loss_u 0.9102 (0.8679) acc_u 6.2500 (15.2500) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.4041, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 653
clean true:637
clean false:16
clean_rate:0.9754977029096478
noisy true:354
noisy false:609
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 963
epoch [22/200] batch [5/20] time 0.187 (0.186) data 0.108 (0.108) loss_x loss_x 1.2285 (1.0521) acc_x 71.8750 (71.2500) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/20] time 0.181 (0.186) data 0.103 (0.109) loss_x loss_x 0.5801 (0.9203) acc_x 81.2500 (75.9375) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [15/20] time 0.160 (0.181) data 0.082 (0.103) loss_x loss_x 0.8848 (0.9146) acc_x 75.0000 (75.8333) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [20/20] time 0.168 (0.177) data 0.089 (0.099) loss_x loss_x 0.6914 (0.9129) acc_x 84.3750 (76.0938) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/30] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.8281 (0.8189) acc_u 25.0000 (21.8750) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/30] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.8481 (0.8297) acc_u 15.6250 (20.3125) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/30] time 0.186 (0.180) data 0.107 (0.101) loss_u loss_u 0.8379 (0.8321) acc_u 18.7500 (20.6250) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/30] time 0.185 (0.180) data 0.107 (0.102) loss_u loss_u 0.8242 (0.8441) acc_u 25.0000 (19.2188) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [25/30] time 0.179 (0.180) data 0.101 (0.102) loss_u loss_u 0.8857 (0.8480) acc_u 18.7500 (18.3750) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [30/30] time 0.167 (0.179) data 0.090 (0.101) loss_u loss_u 0.9087 (0.8529) acc_u 9.3750 (17.9167) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.4251, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 687
clean true:672
clean false:15
clean_rate:0.9781659388646288
noisy true:339
noisy false:590
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 929
epoch [23/200] batch [5/21] time 0.184 (0.189) data 0.106 (0.112) loss_x loss_x 0.7246 (0.6984) acc_x 87.5000 (84.3750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/21] time 0.161 (0.183) data 0.083 (0.106) loss_x loss_x 0.8423 (0.7288) acc_x 68.7500 (82.5000) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/21] time 0.205 (0.186) data 0.128 (0.109) loss_x loss_x 0.7476 (0.7930) acc_x 81.2500 (79.3750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/21] time 0.182 (0.183) data 0.104 (0.106) loss_x loss_x 1.3496 (0.8355) acc_x 68.7500 (78.1250) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/29] time 0.181 (0.183) data 0.103 (0.106) loss_u loss_u 0.7998 (0.8704) acc_u 21.8750 (15.0000) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [10/29] time 0.167 (0.182) data 0.089 (0.105) loss_u loss_u 0.8877 (0.8625) acc_u 15.6250 (16.8750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/29] time 0.161 (0.180) data 0.083 (0.102) loss_u loss_u 0.8647 (0.8618) acc_u 15.6250 (17.2917) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [20/29] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.8813 (0.8638) acc_u 15.6250 (16.7188) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [25/29] time 0.191 (0.181) data 0.112 (0.104) loss_u loss_u 0.9277 (0.8674) acc_u 9.3750 (16.2500) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.4127, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 667
clean true:654
clean false:13
clean_rate:0.9805097451274363
noisy true:365
noisy false:584
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 949
epoch [24/200] batch [5/20] time 0.163 (0.180) data 0.086 (0.102) loss_x loss_x 0.8584 (0.9386) acc_x 75.0000 (76.8750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/20] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.7422 (0.9052) acc_x 78.1250 (75.6250) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [15/20] time 0.163 (0.177) data 0.085 (0.100) loss_x loss_x 1.0498 (0.8977) acc_x 68.7500 (76.0417) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [20/20] time 0.177 (0.176) data 0.099 (0.099) loss_x loss_x 0.9165 (0.8811) acc_x 81.2500 (76.4062) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/29] time 0.173 (0.176) data 0.095 (0.098) loss_u loss_u 0.9126 (0.8643) acc_u 9.3750 (17.5000) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [10/29] time 0.161 (0.174) data 0.083 (0.096) loss_u loss_u 0.8115 (0.8749) acc_u 21.8750 (15.6250) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [15/29] time 0.176 (0.173) data 0.098 (0.095) loss_u loss_u 0.8804 (0.8821) acc_u 18.7500 (14.7917) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/29] time 0.162 (0.172) data 0.084 (0.094) loss_u loss_u 0.7627 (0.8728) acc_u 31.2500 (15.6250) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [25/29] time 0.165 (0.171) data 0.087 (0.093) loss_u loss_u 0.8589 (0.8713) acc_u 15.6250 (15.6250) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 573
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 692
clean true:676
clean false:16
clean_rate:0.976878612716763
noisy true:367
noisy false:557
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 924
epoch [25/200] batch [5/21] time 0.187 (0.187) data 0.109 (0.109) loss_x loss_x 0.9058 (0.7274) acc_x 71.8750 (80.6250) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/21] time 0.184 (0.187) data 0.107 (0.109) loss_x loss_x 0.6895 (0.7646) acc_x 84.3750 (78.7500) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/21] time 0.187 (0.187) data 0.109 (0.109) loss_x loss_x 0.6450 (0.8145) acc_x 84.3750 (77.5000) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/21] time 0.187 (0.187) data 0.110 (0.109) loss_x loss_x 0.7173 (0.7984) acc_x 75.0000 (78.1250) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/28] time 0.164 (0.186) data 0.085 (0.108) loss_u loss_u 0.8047 (0.8399) acc_u 28.1250 (20.6250) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [10/28] time 0.187 (0.184) data 0.109 (0.106) loss_u loss_u 0.9067 (0.8484) acc_u 9.3750 (20.0000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/28] time 0.178 (0.184) data 0.101 (0.106) loss_u loss_u 0.8467 (0.8600) acc_u 15.6250 (17.9167) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [20/28] time 0.174 (0.183) data 0.096 (0.105) loss_u loss_u 0.9580 (0.8739) acc_u 3.1250 (15.7812) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [25/28] time 0.164 (0.182) data 0.086 (0.104) loss_u loss_u 0.8599 (0.8778) acc_u 18.7500 (15.2500) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.4220, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 682
clean true:668
clean false:14
clean_rate:0.9794721407624634
noisy true:364
noisy false:570
after delete: len(clean_dataset) 682
after delete: len(noisy_dataset) 934
epoch [26/200] batch [5/21] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.4441 (0.7293) acc_x 87.5000 (83.1250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/21] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.7778 (0.7614) acc_x 75.0000 (80.6250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/21] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 1.1416 (0.8129) acc_x 71.8750 (79.3750) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/21] time 0.169 (0.181) data 0.092 (0.103) loss_x loss_x 1.0820 (0.8422) acc_x 78.1250 (78.4375) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/29] time 0.169 (0.178) data 0.092 (0.101) loss_u loss_u 0.8525 (0.8591) acc_u 18.7500 (16.8750) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/29] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.8101 (0.8682) acc_u 18.7500 (16.2500) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [15/29] time 0.186 (0.178) data 0.108 (0.100) loss_u loss_u 0.8672 (0.8575) acc_u 15.6250 (17.2917) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/29] time 0.161 (0.176) data 0.084 (0.098) loss_u loss_u 0.8501 (0.8542) acc_u 18.7500 (17.3438) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [25/29] time 0.168 (0.175) data 0.090 (0.097) loss_u loss_u 0.8604 (0.8557) acc_u 18.7500 (17.1250) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.4251, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 687
clean true:669
clean false:18
clean_rate:0.9737991266375546
noisy true:350
noisy false:579
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 929
epoch [27/200] batch [5/21] time 0.174 (0.176) data 0.096 (0.098) loss_x loss_x 0.5063 (0.9655) acc_x 84.3750 (75.0000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/21] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.5601 (0.9502) acc_x 81.2500 (74.3750) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/21] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.6470 (0.9019) acc_x 84.3750 (75.6250) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/21] time 0.162 (0.173) data 0.085 (0.095) loss_x loss_x 0.8667 (0.8809) acc_x 81.2500 (77.3438) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/29] time 0.217 (0.174) data 0.139 (0.096) loss_u loss_u 0.8423 (0.8336) acc_u 18.7500 (18.1250) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/29] time 0.166 (0.176) data 0.087 (0.098) loss_u loss_u 0.8447 (0.8310) acc_u 18.7500 (19.6875) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [15/29] time 0.187 (0.178) data 0.109 (0.100) loss_u loss_u 0.9321 (0.8474) acc_u 6.2500 (17.0833) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/29] time 0.180 (0.178) data 0.103 (0.101) loss_u loss_u 0.8584 (0.8502) acc_u 15.6250 (17.1875) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [25/29] time 0.213 (0.179) data 0.134 (0.101) loss_u loss_u 0.7500 (0.8550) acc_u 28.1250 (16.5000) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 617
confident_label rate tensor(0.4035, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 652
clean true:637
clean false:15
clean_rate:0.9769938650306749
noisy true:362
noisy false:602
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 964
epoch [28/200] batch [5/20] time 0.178 (0.181) data 0.101 (0.103) loss_x loss_x 0.8589 (0.9287) acc_x 81.2500 (77.5000) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/20] time 0.192 (0.185) data 0.114 (0.108) loss_x loss_x 0.8486 (0.8229) acc_x 78.1250 (80.0000) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/20] time 0.198 (0.184) data 0.121 (0.106) loss_x loss_x 0.5332 (0.8715) acc_x 81.2500 (78.1250) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [20/20] time 0.189 (0.185) data 0.111 (0.107) loss_x loss_x 0.7432 (0.8458) acc_x 78.1250 (78.1250) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/30] time 0.183 (0.185) data 0.105 (0.107) loss_u loss_u 0.9370 (0.8884) acc_u 6.2500 (13.7500) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/30] time 0.167 (0.183) data 0.089 (0.105) loss_u loss_u 0.8833 (0.8620) acc_u 12.5000 (15.9375) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/30] time 0.160 (0.182) data 0.082 (0.104) loss_u loss_u 0.8804 (0.8468) acc_u 9.3750 (16.8750) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/30] time 0.190 (0.181) data 0.112 (0.103) loss_u loss_u 0.9019 (0.8493) acc_u 12.5000 (16.8750) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [25/30] time 0.192 (0.182) data 0.115 (0.104) loss_u loss_u 0.8804 (0.8503) acc_u 15.6250 (17.1250) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [30/30] time 0.171 (0.181) data 0.093 (0.104) loss_u loss_u 0.8730 (0.8571) acc_u 15.6250 (16.4583) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.4127, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 667
clean true:650
clean false:17
clean_rate:0.974512743628186
noisy true:361
noisy false:588
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 949
epoch [29/200] batch [5/20] time 0.169 (0.177) data 0.091 (0.100) loss_x loss_x 1.3389 (1.1098) acc_x 71.8750 (71.8750) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/20] time 0.187 (0.180) data 0.109 (0.102) loss_x loss_x 0.8975 (0.9260) acc_x 71.8750 (75.6250) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/20] time 0.164 (0.176) data 0.086 (0.098) loss_x loss_x 0.9165 (0.9006) acc_x 81.2500 (76.6667) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [20/20] time 0.189 (0.183) data 0.111 (0.105) loss_x loss_x 0.8018 (0.9169) acc_x 81.2500 (76.7188) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/29] time 0.187 (0.184) data 0.109 (0.106) loss_u loss_u 0.8965 (0.8075) acc_u 12.5000 (23.1250) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/29] time 0.187 (0.185) data 0.109 (0.107) loss_u loss_u 0.8901 (0.8351) acc_u 15.6250 (20.3125) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [15/29] time 0.188 (0.185) data 0.110 (0.107) loss_u loss_u 0.9038 (0.8462) acc_u 12.5000 (18.7500) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/29] time 0.186 (0.185) data 0.108 (0.107) loss_u loss_u 0.8364 (0.8486) acc_u 21.8750 (18.4375) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [25/29] time 0.184 (0.184) data 0.103 (0.106) loss_u loss_u 0.8833 (0.8436) acc_u 18.7500 (19.0000) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 707
clean true:687
clean false:20
clean_rate:0.9717114568599717
noisy true:362
noisy false:547
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 909
epoch [30/200] batch [5/22] time 0.185 (0.182) data 0.106 (0.104) loss_x loss_x 0.7344 (0.7792) acc_x 81.2500 (78.7500) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/22] time 0.162 (0.180) data 0.084 (0.103) loss_x loss_x 0.5889 (0.7584) acc_x 90.6250 (80.0000) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/22] time 0.175 (0.175) data 0.098 (0.097) loss_x loss_x 1.1699 (0.7895) acc_x 75.0000 (80.0000) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/22] time 0.172 (0.174) data 0.095 (0.097) loss_x loss_x 1.0947 (0.7995) acc_x 71.8750 (79.2188) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/28] time 0.171 (0.174) data 0.093 (0.096) loss_u loss_u 0.7905 (0.8335) acc_u 28.1250 (21.8750) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/28] time 0.176 (0.173) data 0.099 (0.096) loss_u loss_u 0.8892 (0.8373) acc_u 12.5000 (20.6250) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [15/28] time 0.184 (0.175) data 0.106 (0.097) loss_u loss_u 0.8711 (0.8519) acc_u 15.6250 (18.3333) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [20/28] time 0.187 (0.176) data 0.108 (0.099) loss_u loss_u 0.8423 (0.8574) acc_u 21.8750 (17.6562) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [25/28] time 0.183 (0.177) data 0.106 (0.099) loss_u loss_u 0.9409 (0.8628) acc_u 6.2500 (16.8750) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 573
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 702
clean true:675
clean false:27
clean_rate:0.9615384615384616
noisy true:368
noisy false:546
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 914
epoch [31/200] batch [5/21] time 0.164 (0.171) data 0.086 (0.094) loss_x loss_x 1.1465 (0.9228) acc_x 71.8750 (78.1250) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/21] time 0.169 (0.172) data 0.091 (0.094) loss_x loss_x 0.7954 (0.8942) acc_x 71.8750 (76.5625) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/21] time 0.160 (0.168) data 0.082 (0.091) loss_x loss_x 0.6982 (0.8590) acc_x 78.1250 (77.0833) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/21] time 0.179 (0.171) data 0.101 (0.093) loss_x loss_x 0.4753 (0.8643) acc_x 90.6250 (77.0312) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/28] time 0.188 (0.175) data 0.110 (0.097) loss_u loss_u 0.8223 (0.8198) acc_u 21.8750 (22.5000) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/28] time 0.168 (0.174) data 0.090 (0.096) loss_u loss_u 0.8921 (0.8616) acc_u 12.5000 (16.8750) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/28] time 0.177 (0.174) data 0.099 (0.097) loss_u loss_u 0.7329 (0.8558) acc_u 37.5000 (17.5000) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/28] time 0.191 (0.176) data 0.112 (0.098) loss_u loss_u 0.8232 (0.8594) acc_u 18.7500 (17.1875) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [25/28] time 0.171 (0.176) data 0.093 (0.098) loss_u loss_u 0.7852 (0.8537) acc_u 25.0000 (17.5000) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 712
clean true:696
clean false:16
clean_rate:0.9775280898876404
noisy true:378
noisy false:526
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 904
epoch [32/200] batch [5/22] time 0.162 (0.165) data 0.084 (0.088) loss_x loss_x 0.6333 (0.7329) acc_x 81.2500 (83.7500) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/22] time 0.164 (0.165) data 0.087 (0.088) loss_x loss_x 0.5391 (0.7358) acc_x 84.3750 (81.5625) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/22] time 0.162 (0.165) data 0.083 (0.087) loss_x loss_x 0.4587 (0.8005) acc_x 90.6250 (80.6250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/22] time 0.162 (0.164) data 0.085 (0.087) loss_x loss_x 1.2832 (0.8193) acc_x 71.8750 (80.0000) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/28] time 0.180 (0.169) data 0.102 (0.091) loss_u loss_u 0.7148 (0.8287) acc_u 31.2500 (20.0000) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/28] time 0.188 (0.169) data 0.110 (0.092) loss_u loss_u 0.9170 (0.8449) acc_u 9.3750 (18.7500) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [15/28] time 0.163 (0.170) data 0.085 (0.093) loss_u loss_u 0.7622 (0.8438) acc_u 28.1250 (17.9167) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/28] time 0.178 (0.171) data 0.100 (0.093) loss_u loss_u 0.8379 (0.8480) acc_u 18.7500 (17.1875) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [25/28] time 0.184 (0.172) data 0.106 (0.094) loss_u loss_u 0.9185 (0.8532) acc_u 9.3750 (16.8750) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 707
clean true:686
clean false:21
clean_rate:0.9702970297029703
noisy true:367
noisy false:542
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 909
epoch [33/200] batch [5/22] time 0.172 (0.184) data 0.094 (0.107) loss_x loss_x 0.7090 (0.6932) acc_x 84.3750 (83.7500) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/22] time 0.177 (0.186) data 0.100 (0.108) loss_x loss_x 0.6323 (0.7036) acc_x 87.5000 (82.5000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/22] time 0.214 (0.186) data 0.135 (0.108) loss_x loss_x 0.6279 (0.7319) acc_x 81.2500 (82.0833) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/22] time 0.162 (0.183) data 0.085 (0.105) loss_x loss_x 0.9771 (0.7507) acc_x 78.1250 (81.5625) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/28] time 0.187 (0.179) data 0.108 (0.101) loss_u loss_u 0.7485 (0.8296) acc_u 28.1250 (20.6250) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/28] time 0.175 (0.180) data 0.097 (0.102) loss_u loss_u 0.9282 (0.8671) acc_u 12.5000 (15.6250) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/28] time 0.166 (0.179) data 0.086 (0.101) loss_u loss_u 0.7905 (0.8621) acc_u 25.0000 (16.2500) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/28] time 0.161 (0.178) data 0.082 (0.099) loss_u loss_u 0.9004 (0.8636) acc_u 9.3750 (15.6250) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [25/28] time 0.185 (0.178) data 0.108 (0.100) loss_u loss_u 0.8813 (0.8677) acc_u 15.6250 (15.2500) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 570
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 717
clean true:694
clean false:23
clean_rate:0.9679218967921897
noisy true:352
noisy false:547
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 899
epoch [34/200] batch [5/22] time 0.182 (0.190) data 0.104 (0.112) loss_x loss_x 0.9863 (0.7747) acc_x 71.8750 (78.7500) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/22] time 0.167 (0.188) data 0.089 (0.110) loss_x loss_x 0.7783 (0.6852) acc_x 84.3750 (81.5625) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/22] time 0.182 (0.184) data 0.104 (0.106) loss_x loss_x 1.2832 (0.7799) acc_x 65.6250 (79.5833) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/22] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 1.1553 (0.7915) acc_x 71.8750 (80.0000) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/28] time 0.184 (0.187) data 0.106 (0.109) loss_u loss_u 0.8774 (0.8443) acc_u 9.3750 (17.5000) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/28] time 0.183 (0.186) data 0.105 (0.109) loss_u loss_u 0.9233 (0.8738) acc_u 12.5000 (15.3125) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [15/28] time 0.186 (0.186) data 0.108 (0.109) loss_u loss_u 0.9302 (0.8682) acc_u 6.2500 (15.8333) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/28] time 0.184 (0.186) data 0.107 (0.108) loss_u loss_u 0.8833 (0.8614) acc_u 15.6250 (16.7188) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [25/28] time 0.184 (0.186) data 0.106 (0.108) loss_u loss_u 0.8481 (0.8595) acc_u 18.7500 (17.1250) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 555
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 720
clean true:700
clean false:20
clean_rate:0.9722222222222222
noisy true:361
noisy false:535
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 896
epoch [35/200] batch [5/22] time 0.177 (0.177) data 0.099 (0.100) loss_x loss_x 0.8940 (0.8215) acc_x 75.0000 (78.1250) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/22] time 0.170 (0.180) data 0.092 (0.103) loss_x loss_x 0.7490 (0.7936) acc_x 84.3750 (78.7500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/22] time 0.182 (0.180) data 0.105 (0.102) loss_x loss_x 1.0400 (0.8285) acc_x 62.5000 (77.9167) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/22] time 0.164 (0.178) data 0.087 (0.100) loss_x loss_x 0.9722 (0.8302) acc_x 81.2500 (77.8125) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/28] time 0.170 (0.178) data 0.092 (0.101) loss_u loss_u 0.8911 (0.8629) acc_u 12.5000 (15.6250) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/28] time 0.184 (0.179) data 0.106 (0.101) loss_u loss_u 0.8755 (0.8511) acc_u 15.6250 (17.1875) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/28] time 0.182 (0.180) data 0.105 (0.102) loss_u loss_u 0.9106 (0.8732) acc_u 9.3750 (14.7917) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/28] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.9438 (0.8722) acc_u 3.1250 (14.5312) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [25/28] time 0.182 (0.181) data 0.104 (0.103) loss_u loss_u 0.8037 (0.8662) acc_u 21.8750 (15.1250) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.4468, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 722
clean true:701
clean false:21
clean_rate:0.9709141274238227
noisy true:373
noisy false:521
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 894
epoch [36/200] batch [5/22] time 0.187 (0.189) data 0.110 (0.111) loss_x loss_x 0.7871 (0.6557) acc_x 75.0000 (78.7500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/22] time 0.194 (0.190) data 0.115 (0.112) loss_x loss_x 0.8296 (0.7191) acc_x 81.2500 (80.9375) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/22] time 0.188 (0.189) data 0.110 (0.111) loss_x loss_x 0.5513 (0.6768) acc_x 84.3750 (82.0833) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/22] time 0.162 (0.184) data 0.085 (0.106) loss_x loss_x 1.4473 (0.7574) acc_x 65.6250 (79.2188) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/27] time 0.167 (0.179) data 0.090 (0.101) loss_u loss_u 0.8955 (0.8568) acc_u 15.6250 (18.7500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/27] time 0.174 (0.177) data 0.096 (0.100) loss_u loss_u 0.8511 (0.8676) acc_u 15.6250 (16.2500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [15/27] time 0.175 (0.177) data 0.096 (0.099) loss_u loss_u 0.9092 (0.8718) acc_u 9.3750 (15.4167) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [20/27] time 0.164 (0.177) data 0.086 (0.099) loss_u loss_u 0.7656 (0.8550) acc_u 31.2500 (17.1875) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [25/27] time 0.171 (0.176) data 0.093 (0.098) loss_u loss_u 0.8511 (0.8568) acc_u 18.7500 (17.3750) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 546
confident_label rate tensor(0.4505, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 728
clean true:709
clean false:19
clean_rate:0.9739010989010989
noisy true:361
noisy false:527
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 888
epoch [37/200] batch [5/22] time 0.165 (0.180) data 0.087 (0.102) loss_x loss_x 0.8799 (0.7614) acc_x 75.0000 (80.0000) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/22] time 0.182 (0.177) data 0.105 (0.099) loss_x loss_x 0.8574 (0.7414) acc_x 84.3750 (81.8750) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/22] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 0.7769 (0.8058) acc_x 81.2500 (79.3750) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/22] time 0.171 (0.175) data 0.092 (0.097) loss_x loss_x 1.2334 (0.8474) acc_x 62.5000 (77.6562) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/27] time 0.186 (0.177) data 0.109 (0.099) loss_u loss_u 0.9331 (0.9104) acc_u 9.3750 (11.8750) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/27] time 0.187 (0.178) data 0.109 (0.100) loss_u loss_u 0.8872 (0.8871) acc_u 12.5000 (14.3750) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/27] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.8252 (0.8814) acc_u 25.0000 (15.6250) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/27] time 0.185 (0.180) data 0.106 (0.102) loss_u loss_u 0.7720 (0.8663) acc_u 28.1250 (17.3438) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [25/27] time 0.159 (0.179) data 0.081 (0.101) loss_u loss_u 0.8833 (0.8623) acc_u 15.6250 (17.3750) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 520
confident_label rate tensor(0.4554, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 736
clean true:715
clean false:21
clean_rate:0.9714673913043478
noisy true:381
noisy false:499
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 880
epoch [38/200] batch [5/23] time 0.174 (0.180) data 0.097 (0.103) loss_x loss_x 0.5889 (0.5179) acc_x 84.3750 (85.0000) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/23] time 0.173 (0.172) data 0.096 (0.094) loss_x loss_x 0.8408 (0.6759) acc_x 75.0000 (81.2500) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/23] time 0.181 (0.172) data 0.104 (0.095) loss_x loss_x 0.8027 (0.7239) acc_x 78.1250 (79.5833) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/23] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 0.8950 (0.7007) acc_x 65.6250 (79.8438) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/27] time 0.186 (0.178) data 0.107 (0.100) loss_u loss_u 0.8774 (0.8778) acc_u 12.5000 (14.3750) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/27] time 0.189 (0.179) data 0.110 (0.102) loss_u loss_u 0.8325 (0.8553) acc_u 18.7500 (16.5625) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/27] time 0.188 (0.181) data 0.109 (0.103) loss_u loss_u 0.8105 (0.8608) acc_u 25.0000 (16.4583) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [20/27] time 0.209 (0.182) data 0.130 (0.104) loss_u loss_u 0.8569 (0.8620) acc_u 15.6250 (16.0938) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [25/27] time 0.185 (0.182) data 0.106 (0.104) loss_u loss_u 0.8140 (0.8605) acc_u 21.8750 (16.1250) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 523
confident_label rate tensor(0.4567, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 738
clean true:720
clean false:18
clean_rate:0.975609756097561
noisy true:373
noisy false:505
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 878
epoch [39/200] batch [5/23] time 0.186 (0.190) data 0.109 (0.112) loss_x loss_x 0.6826 (0.5997) acc_x 84.3750 (83.7500) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/23] time 0.168 (0.181) data 0.090 (0.103) loss_x loss_x 1.1289 (0.7448) acc_x 78.1250 (81.5625) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/23] time 0.186 (0.180) data 0.109 (0.102) loss_x loss_x 0.3184 (0.7271) acc_x 93.7500 (82.5000) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/23] time 0.171 (0.178) data 0.093 (0.100) loss_x loss_x 0.8003 (0.7154) acc_x 71.8750 (81.7188) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/27] time 0.166 (0.176) data 0.088 (0.098) loss_u loss_u 0.8896 (0.8632) acc_u 12.5000 (16.2500) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/27] time 0.159 (0.174) data 0.082 (0.097) loss_u loss_u 0.8799 (0.8646) acc_u 15.6250 (15.3125) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/27] time 0.205 (0.174) data 0.127 (0.096) loss_u loss_u 0.9058 (0.8801) acc_u 9.3750 (14.1667) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [20/27] time 0.184 (0.175) data 0.106 (0.097) loss_u loss_u 0.8804 (0.8764) acc_u 12.5000 (14.5312) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [25/27] time 0.181 (0.175) data 0.101 (0.097) loss_u loss_u 0.7988 (0.8679) acc_u 21.8750 (15.7500) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 721
clean true:700
clean false:21
clean_rate:0.970873786407767
noisy true:371
noisy false:524
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 895
epoch [40/200] batch [5/22] time 0.180 (0.184) data 0.103 (0.106) loss_x loss_x 1.6309 (0.8516) acc_x 50.0000 (78.7500) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/22] time 0.185 (0.179) data 0.106 (0.102) loss_x loss_x 0.8750 (0.8593) acc_x 81.2500 (80.0000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/22] time 0.185 (0.181) data 0.107 (0.103) loss_x loss_x 0.9502 (0.8393) acc_x 78.1250 (80.2083) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/22] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.5605 (0.8174) acc_x 87.5000 (80.3125) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/27] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.8394 (0.8513) acc_u 15.6250 (16.8750) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/27] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.8257 (0.8378) acc_u 21.8750 (18.4375) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [15/27] time 0.186 (0.183) data 0.108 (0.105) loss_u loss_u 0.8442 (0.8503) acc_u 18.7500 (16.8750) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [20/27] time 0.178 (0.183) data 0.100 (0.105) loss_u loss_u 0.8584 (0.8532) acc_u 21.8750 (17.1875) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [25/27] time 0.175 (0.181) data 0.096 (0.104) loss_u loss_u 0.8325 (0.8510) acc_u 18.7500 (17.5000) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 700
clean true:686
clean false:14
clean_rate:0.98
noisy true:367
noisy false:549
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 916
epoch [41/200] batch [5/21] time 0.179 (0.186) data 0.101 (0.108) loss_x loss_x 0.9165 (0.8352) acc_x 75.0000 (78.7500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/21] time 0.161 (0.175) data 0.083 (0.098) loss_x loss_x 0.5845 (0.7954) acc_x 84.3750 (80.9375) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/21] time 0.172 (0.173) data 0.094 (0.095) loss_x loss_x 0.9395 (0.7624) acc_x 78.1250 (81.8750) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/21] time 0.190 (0.175) data 0.113 (0.097) loss_x loss_x 1.1484 (0.7658) acc_x 75.0000 (81.2500) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/28] time 0.168 (0.177) data 0.088 (0.099) loss_u loss_u 0.8301 (0.8207) acc_u 21.8750 (23.1250) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [10/28] time 0.181 (0.177) data 0.102 (0.099) loss_u loss_u 0.8164 (0.8224) acc_u 21.8750 (22.1875) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [15/28] time 0.167 (0.177) data 0.088 (0.099) loss_u loss_u 0.8989 (0.8338) acc_u 9.3750 (20.2083) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [20/28] time 0.177 (0.178) data 0.099 (0.100) loss_u loss_u 0.8398 (0.8436) acc_u 18.7500 (18.9062) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [25/28] time 0.190 (0.178) data 0.113 (0.100) loss_u loss_u 0.8457 (0.8406) acc_u 21.8750 (19.5000) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 514
confident_label rate tensor(0.4684, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 757
clean true:727
clean false:30
clean_rate:0.9603698811096433
noisy true:375
noisy false:484
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 859
epoch [42/200] batch [5/23] time 0.184 (0.202) data 0.107 (0.125) loss_x loss_x 0.7861 (0.7228) acc_x 78.1250 (81.2500) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/23] time 0.183 (0.188) data 0.105 (0.110) loss_x loss_x 0.6416 (0.7979) acc_x 87.5000 (79.6875) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/23] time 0.182 (0.185) data 0.104 (0.107) loss_x loss_x 0.9219 (0.8182) acc_x 75.0000 (77.9167) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/23] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.9663 (0.8322) acc_x 71.8750 (77.8125) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/26] time 0.188 (0.185) data 0.108 (0.108) loss_u loss_u 0.8325 (0.8558) acc_u 18.7500 (17.5000) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/26] time 0.175 (0.185) data 0.096 (0.107) loss_u loss_u 0.8896 (0.8557) acc_u 15.6250 (18.7500) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/26] time 0.184 (0.184) data 0.105 (0.106) loss_u loss_u 0.9507 (0.8646) acc_u 6.2500 (17.2917) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/26] time 0.178 (0.184) data 0.098 (0.106) loss_u loss_u 0.9199 (0.8747) acc_u 12.5000 (15.7812) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [25/26] time 0.172 (0.183) data 0.093 (0.105) loss_u loss_u 0.8291 (0.8748) acc_u 21.8750 (15.3750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 530
confident_label rate tensor(0.4554, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 736
clean true:714
clean false:22
clean_rate:0.970108695652174
noisy true:372
noisy false:508
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 880
epoch [43/200] batch [5/23] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.9951 (0.8614) acc_x 81.2500 (79.3750) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/23] time 0.181 (0.184) data 0.104 (0.106) loss_x loss_x 0.5747 (0.7918) acc_x 87.5000 (82.1875) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/23] time 0.183 (0.182) data 0.106 (0.104) loss_x loss_x 0.9800 (0.8093) acc_x 75.0000 (80.6250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/23] time 0.166 (0.180) data 0.088 (0.103) loss_x loss_x 0.5098 (0.7750) acc_x 90.6250 (80.7812) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/27] time 0.168 (0.178) data 0.090 (0.100) loss_u loss_u 0.7061 (0.8308) acc_u 31.2500 (20.0000) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/27] time 0.176 (0.177) data 0.097 (0.099) loss_u loss_u 0.7974 (0.8380) acc_u 28.1250 (19.0625) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/27] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.8320 (0.8515) acc_u 18.7500 (17.9167) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [20/27] time 0.184 (0.177) data 0.107 (0.099) loss_u loss_u 0.8843 (0.8610) acc_u 12.5000 (16.5625) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [25/27] time 0.190 (0.178) data 0.110 (0.100) loss_u loss_u 0.8979 (0.8556) acc_u 12.5000 (17.0000) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 485
confident_label rate tensor(0.4678, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 756
clean true:735
clean false:21
clean_rate:0.9722222222222222
noisy true:396
noisy false:464
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 860
epoch [44/200] batch [5/23] time 0.177 (0.181) data 0.100 (0.103) loss_x loss_x 0.8916 (0.7629) acc_x 81.2500 (80.6250) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/23] time 0.183 (0.181) data 0.105 (0.104) loss_x loss_x 0.7427 (0.7801) acc_x 78.1250 (79.3750) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/23] time 0.248 (0.187) data 0.171 (0.109) loss_x loss_x 0.5835 (0.7889) acc_x 81.2500 (78.5417) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/23] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.4507 (0.7782) acc_x 90.6250 (78.9062) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/26] time 0.168 (0.181) data 0.090 (0.103) loss_u loss_u 0.8574 (0.8352) acc_u 15.6250 (19.3750) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/26] time 0.198 (0.180) data 0.120 (0.102) loss_u loss_u 0.8628 (0.8523) acc_u 18.7500 (18.1250) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/26] time 0.165 (0.178) data 0.087 (0.101) loss_u loss_u 0.7788 (0.8480) acc_u 31.2500 (18.7500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/26] time 0.202 (0.179) data 0.123 (0.101) loss_u loss_u 0.8398 (0.8554) acc_u 18.7500 (17.6562) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [25/26] time 0.173 (0.179) data 0.093 (0.102) loss_u loss_u 0.8076 (0.8565) acc_u 21.8750 (17.6250) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 499
confident_label rate tensor(0.4678, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 756
clean true:731
clean false:25
clean_rate:0.966931216931217
noisy true:386
noisy false:474
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 860
epoch [45/200] batch [5/23] time 0.160 (0.180) data 0.083 (0.103) loss_x loss_x 0.6406 (0.6279) acc_x 81.2500 (85.0000) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/23] time 0.165 (0.172) data 0.087 (0.094) loss_x loss_x 0.6421 (0.7151) acc_x 87.5000 (82.5000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/23] time 0.163 (0.169) data 0.086 (0.091) loss_x loss_x 0.6128 (0.7028) acc_x 84.3750 (82.2917) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/23] time 0.203 (0.171) data 0.125 (0.093) loss_x loss_x 0.7803 (0.7090) acc_x 87.5000 (82.3438) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/26] time 0.185 (0.175) data 0.106 (0.097) loss_u loss_u 0.8452 (0.8566) acc_u 21.8750 (18.1250) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/26] time 0.185 (0.177) data 0.107 (0.099) loss_u loss_u 0.9160 (0.8563) acc_u 12.5000 (17.8125) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/26] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.8643 (0.8644) acc_u 12.5000 (16.0417) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/26] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.8813 (0.8618) acc_u 12.5000 (15.9375) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [25/26] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.9072 (0.8588) acc_u 12.5000 (17.2500) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 514
confident_label rate tensor(0.4554, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 736
clean true:717
clean false:19
clean_rate:0.9741847826086957
noisy true:385
noisy false:495
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 880
epoch [46/200] batch [5/23] time 0.177 (0.188) data 0.100 (0.110) loss_x loss_x 0.5396 (0.7050) acc_x 81.2500 (80.6250) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/23] time 0.182 (0.185) data 0.105 (0.107) loss_x loss_x 0.6367 (0.7314) acc_x 84.3750 (81.2500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/23] time 0.185 (0.184) data 0.109 (0.106) loss_x loss_x 0.8506 (0.7936) acc_x 78.1250 (79.3750) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/23] time 0.161 (0.180) data 0.084 (0.102) loss_x loss_x 0.7529 (0.7863) acc_x 78.1250 (78.7500) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/27] time 0.165 (0.178) data 0.086 (0.100) loss_u loss_u 0.6362 (0.8247) acc_u 43.7500 (20.0000) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/27] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.9199 (0.8502) acc_u 6.2500 (17.1875) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/27] time 0.185 (0.180) data 0.107 (0.102) loss_u loss_u 0.8672 (0.8546) acc_u 21.8750 (17.5000) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/27] time 0.187 (0.181) data 0.109 (0.103) loss_u loss_u 0.7754 (0.8412) acc_u 25.0000 (19.0625) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [25/27] time 0.189 (0.181) data 0.110 (0.104) loss_u loss_u 0.7642 (0.8446) acc_u 28.1250 (18.8750) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.4635, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 749
clean true:729
clean false:20
clean_rate:0.9732977303070761
noisy true:387
noisy false:480
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 867
epoch [47/200] batch [5/23] time 0.189 (0.179) data 0.112 (0.102) loss_x loss_x 0.6377 (0.7527) acc_x 90.6250 (80.6250) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/23] time 0.179 (0.179) data 0.101 (0.102) loss_x loss_x 0.8755 (0.7408) acc_x 75.0000 (79.3750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/23] time 0.170 (0.178) data 0.093 (0.100) loss_x loss_x 0.6045 (0.6943) acc_x 78.1250 (80.6250) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/23] time 0.164 (0.174) data 0.086 (0.097) loss_x loss_x 0.7188 (0.7005) acc_x 81.2500 (81.0938) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/27] time 0.164 (0.172) data 0.086 (0.094) loss_u loss_u 0.7891 (0.8487) acc_u 25.0000 (16.8750) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/27] time 0.184 (0.173) data 0.106 (0.095) loss_u loss_u 0.9048 (0.8546) acc_u 18.7500 (16.8750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/27] time 0.185 (0.175) data 0.108 (0.097) loss_u loss_u 0.8701 (0.8454) acc_u 15.6250 (17.5000) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/27] time 0.186 (0.176) data 0.107 (0.098) loss_u loss_u 0.8350 (0.8468) acc_u 18.7500 (17.3438) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [25/27] time 0.187 (0.177) data 0.109 (0.099) loss_u loss_u 0.8823 (0.8485) acc_u 12.5000 (17.1250) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.4573, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 739
clean true:717
clean false:22
clean_rate:0.9702300405953992
noisy true:382
noisy false:495
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 877
epoch [48/200] batch [5/23] time 0.169 (0.169) data 0.091 (0.092) loss_x loss_x 0.9536 (0.5522) acc_x 75.0000 (85.6250) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/23] time 0.172 (0.170) data 0.094 (0.092) loss_x loss_x 0.7456 (0.6876) acc_x 81.2500 (81.2500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/23] time 0.164 (0.170) data 0.087 (0.092) loss_x loss_x 0.8003 (0.7000) acc_x 84.3750 (81.0417) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/23] time 0.188 (0.173) data 0.111 (0.095) loss_x loss_x 0.6030 (0.7244) acc_x 78.1250 (80.0000) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/27] time 0.165 (0.174) data 0.087 (0.096) loss_u loss_u 0.8843 (0.8420) acc_u 15.6250 (20.0000) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/27] time 0.171 (0.173) data 0.092 (0.095) loss_u loss_u 0.7817 (0.8308) acc_u 28.1250 (22.5000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/27] time 0.166 (0.173) data 0.089 (0.095) loss_u loss_u 0.8057 (0.8237) acc_u 25.0000 (22.2917) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/27] time 0.165 (0.173) data 0.088 (0.095) loss_u loss_u 0.7500 (0.8283) acc_u 31.2500 (21.4062) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [25/27] time 0.162 (0.174) data 0.084 (0.096) loss_u loss_u 0.8662 (0.8387) acc_u 12.5000 (19.7500) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.4703, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 760
clean true:736
clean false:24
clean_rate:0.968421052631579
noisy true:375
noisy false:481
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 856
epoch [49/200] batch [5/23] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 0.6665 (0.6720) acc_x 81.2500 (81.8750) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/23] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.8262 (0.6766) acc_x 71.8750 (81.5625) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/23] time 0.182 (0.183) data 0.104 (0.106) loss_x loss_x 0.8218 (0.6731) acc_x 84.3750 (82.5000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/23] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 1.0137 (0.6927) acc_x 75.0000 (81.7188) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/26] time 0.186 (0.184) data 0.109 (0.106) loss_u loss_u 0.8164 (0.8778) acc_u 18.7500 (13.1250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/26] time 0.186 (0.184) data 0.108 (0.106) loss_u loss_u 0.8501 (0.8584) acc_u 18.7500 (16.8750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/26] time 0.187 (0.184) data 0.110 (0.107) loss_u loss_u 0.8511 (0.8481) acc_u 15.6250 (17.5000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [20/26] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.8857 (0.8511) acc_u 15.6250 (17.0312) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [25/26] time 0.188 (0.185) data 0.109 (0.107) loss_u loss_u 0.8774 (0.8579) acc_u 12.5000 (16.2500) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 514
confident_label rate tensor(0.4610, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 745
clean true:726
clean false:19
clean_rate:0.974496644295302
noisy true:376
noisy false:495
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 871
epoch [50/200] batch [5/23] time 0.163 (0.181) data 0.085 (0.104) loss_x loss_x 0.4839 (0.7264) acc_x 90.6250 (82.5000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/23] time 0.167 (0.174) data 0.090 (0.096) loss_x loss_x 0.6626 (0.7718) acc_x 71.8750 (80.3125) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/23] time 0.173 (0.173) data 0.095 (0.095) loss_x loss_x 0.5112 (0.7107) acc_x 87.5000 (81.6667) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/23] time 0.162 (0.172) data 0.085 (0.095) loss_x loss_x 0.5127 (0.7268) acc_x 81.2500 (80.7812) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/27] time 0.184 (0.176) data 0.107 (0.098) loss_u loss_u 0.7109 (0.8449) acc_u 37.5000 (20.0000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/27] time 0.188 (0.177) data 0.110 (0.099) loss_u loss_u 0.8081 (0.8513) acc_u 18.7500 (17.8125) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/27] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.8687 (0.8505) acc_u 12.5000 (17.2917) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [20/27] time 0.185 (0.180) data 0.108 (0.102) loss_u loss_u 0.8354 (0.8472) acc_u 18.7500 (17.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [25/27] time 0.186 (0.181) data 0.108 (0.103) loss_u loss_u 0.7788 (0.8544) acc_u 28.1250 (16.7500) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.4598, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 743
clean true:721
clean false:22
clean_rate:0.9703903095558546
noisy true:371
noisy false:502
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 873
epoch [51/200] batch [5/23] time 0.163 (0.177) data 0.086 (0.099) loss_x loss_x 1.3213 (0.8317) acc_x 62.5000 (76.8750) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/23] time 0.166 (0.169) data 0.087 (0.092) loss_x loss_x 0.6743 (0.7548) acc_x 78.1250 (79.0625) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/23] time 0.167 (0.168) data 0.089 (0.090) loss_x loss_x 0.7725 (0.7266) acc_x 81.2500 (81.0417) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/23] time 0.187 (0.170) data 0.109 (0.092) loss_x loss_x 0.5547 (0.7020) acc_x 84.3750 (81.7188) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/27] time 0.182 (0.174) data 0.104 (0.096) loss_u loss_u 0.8896 (0.8715) acc_u 12.5000 (14.3750) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/27] time 0.185 (0.176) data 0.107 (0.098) loss_u loss_u 0.8408 (0.8461) acc_u 15.6250 (17.8125) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/27] time 0.184 (0.177) data 0.107 (0.099) loss_u loss_u 0.8867 (0.8481) acc_u 12.5000 (17.7083) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [20/27] time 0.183 (0.178) data 0.105 (0.100) loss_u loss_u 0.7920 (0.8422) acc_u 21.8750 (18.5938) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [25/27] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.8491 (0.8480) acc_u 15.6250 (17.5000) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.4734, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 765
clean true:745
clean false:20
clean_rate:0.9738562091503268
noisy true:387
noisy false:464
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 851
epoch [52/200] batch [5/23] time 0.175 (0.171) data 0.097 (0.094) loss_x loss_x 0.6597 (0.6363) acc_x 87.5000 (84.3750) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/23] time 0.199 (0.179) data 0.121 (0.101) loss_x loss_x 0.9551 (0.7071) acc_x 71.8750 (82.5000) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/23] time 0.188 (0.181) data 0.110 (0.103) loss_x loss_x 0.7197 (0.7083) acc_x 81.2500 (82.2917) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/23] time 0.185 (0.182) data 0.107 (0.104) loss_x loss_x 0.5659 (0.7171) acc_x 84.3750 (81.5625) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/26] time 0.181 (0.181) data 0.102 (0.103) loss_u loss_u 0.8457 (0.8906) acc_u 18.7500 (12.5000) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/26] time 0.179 (0.179) data 0.100 (0.101) loss_u loss_u 0.9092 (0.8678) acc_u 12.5000 (15.6250) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/26] time 0.245 (0.182) data 0.168 (0.104) loss_u loss_u 0.8882 (0.8652) acc_u 12.5000 (15.6250) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/26] time 0.188 (0.183) data 0.110 (0.105) loss_u loss_u 0.7646 (0.8613) acc_u 28.1250 (16.0938) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [25/26] time 0.172 (0.183) data 0.095 (0.105) loss_u loss_u 0.7974 (0.8633) acc_u 21.8750 (15.7500) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 495
confident_label rate tensor(0.4783, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 773
clean true:754
clean false:19
clean_rate:0.9754204398447607
noisy true:367
noisy false:476
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 843
epoch [53/200] batch [5/24] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 0.4004 (0.6604) acc_x 90.6250 (85.0000) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/24] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.6016 (0.6888) acc_x 84.3750 (83.4375) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/24] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.8110 (0.6870) acc_x 84.3750 (83.3333) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/24] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 1.1055 (0.7324) acc_x 62.5000 (81.2500) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/26] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.7637 (0.7989) acc_u 25.0000 (23.1250) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/26] time 0.182 (0.184) data 0.104 (0.106) loss_u loss_u 0.7852 (0.8393) acc_u 28.1250 (17.8125) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/26] time 0.168 (0.183) data 0.090 (0.105) loss_u loss_u 0.8765 (0.8519) acc_u 12.5000 (16.6667) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [20/26] time 0.191 (0.182) data 0.112 (0.104) loss_u loss_u 0.8950 (0.8526) acc_u 9.3750 (17.1875) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [25/26] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8721 (0.8619) acc_u 15.6250 (16.0000) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 513
confident_label rate tensor(0.4629, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 748
clean true:726
clean false:22
clean_rate:0.9705882352941176
noisy true:377
noisy false:491
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 868
epoch [54/200] batch [5/23] time 0.187 (0.186) data 0.109 (0.108) loss_x loss_x 0.7871 (0.8033) acc_x 78.1250 (80.0000) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/23] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.5815 (0.7395) acc_x 84.3750 (82.5000) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/23] time 0.185 (0.181) data 0.107 (0.104) loss_x loss_x 1.1777 (0.7392) acc_x 68.7500 (81.6667) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/23] time 0.186 (0.182) data 0.108 (0.105) loss_x loss_x 1.0107 (0.7650) acc_x 68.7500 (81.4062) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/27] time 0.188 (0.184) data 0.110 (0.106) loss_u loss_u 0.8926 (0.8341) acc_u 12.5000 (18.7500) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/27] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.8877 (0.8348) acc_u 12.5000 (18.4375) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/27] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.8818 (0.8654) acc_u 15.6250 (15.2083) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/27] time 0.189 (0.185) data 0.111 (0.107) loss_u loss_u 0.7998 (0.8665) acc_u 25.0000 (15.3125) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [25/27] time 0.186 (0.185) data 0.108 (0.107) loss_u loss_u 0.8828 (0.8569) acc_u 12.5000 (16.5000) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.4796, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 775
clean true:758
clean false:17
clean_rate:0.9780645161290322
noisy true:374
noisy false:467
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 841
epoch [55/200] batch [5/24] time 0.186 (0.184) data 0.108 (0.106) loss_x loss_x 0.5264 (0.8604) acc_x 84.3750 (74.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/24] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 1.0674 (0.8179) acc_x 62.5000 (75.9375) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/24] time 0.187 (0.185) data 0.109 (0.108) loss_x loss_x 0.8511 (0.7686) acc_x 81.2500 (78.3333) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [20/24] time 0.183 (0.185) data 0.105 (0.107) loss_x loss_x 0.8696 (0.8239) acc_x 75.0000 (78.4375) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/26] time 0.177 (0.186) data 0.099 (0.108) loss_u loss_u 0.8560 (0.8410) acc_u 15.6250 (17.5000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/26] time 0.172 (0.185) data 0.093 (0.107) loss_u loss_u 0.8652 (0.8555) acc_u 15.6250 (17.5000) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/26] time 0.186 (0.185) data 0.109 (0.106) loss_u loss_u 0.9170 (0.8671) acc_u 6.2500 (15.6250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/26] time 0.189 (0.185) data 0.111 (0.106) loss_u loss_u 0.8218 (0.8633) acc_u 21.8750 (16.0938) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [25/26] time 0.188 (0.185) data 0.110 (0.107) loss_u loss_u 0.8291 (0.8631) acc_u 21.8750 (16.2500) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 520
confident_label rate tensor(0.4592, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 742
clean true:720
clean false:22
clean_rate:0.9703504043126685
noisy true:376
noisy false:498
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 874
epoch [56/200] batch [5/23] time 0.186 (0.184) data 0.108 (0.106) loss_x loss_x 0.7061 (0.7094) acc_x 81.2500 (83.1250) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/23] time 0.185 (0.183) data 0.106 (0.104) loss_x loss_x 0.6479 (0.7300) acc_x 81.2500 (81.8750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/23] time 0.160 (0.178) data 0.083 (0.100) loss_x loss_x 0.6836 (0.6707) acc_x 81.2500 (83.1250) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/23] time 0.174 (0.175) data 0.096 (0.097) loss_x loss_x 0.4417 (0.6371) acc_x 84.3750 (84.0625) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/27] time 0.172 (0.174) data 0.094 (0.096) loss_u loss_u 0.8750 (0.8544) acc_u 15.6250 (16.2500) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/27] time 0.173 (0.175) data 0.095 (0.097) loss_u loss_u 0.8516 (0.8310) acc_u 15.6250 (18.7500) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/27] time 0.179 (0.176) data 0.100 (0.098) loss_u loss_u 0.8325 (0.8439) acc_u 21.8750 (17.5000) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/27] time 0.174 (0.176) data 0.095 (0.098) loss_u loss_u 0.9385 (0.8459) acc_u 6.2500 (17.8125) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [25/27] time 0.168 (0.175) data 0.089 (0.097) loss_u loss_u 0.8657 (0.8450) acc_u 18.7500 (17.8750) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 503
confident_label rate tensor(0.4678, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 756
clean true:733
clean false:23
clean_rate:0.9695767195767195
noisy true:380
noisy false:480
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 860
epoch [57/200] batch [5/23] time 0.186 (0.173) data 0.108 (0.095) loss_x loss_x 1.0010 (0.7840) acc_x 75.0000 (80.0000) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/23] time 0.166 (0.170) data 0.089 (0.093) loss_x loss_x 0.9028 (0.8564) acc_x 78.1250 (78.7500) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/23] time 0.191 (0.170) data 0.112 (0.092) loss_x loss_x 0.6245 (0.7916) acc_x 84.3750 (80.2083) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/23] time 0.179 (0.174) data 0.102 (0.096) loss_x loss_x 0.8784 (0.7672) acc_x 81.2500 (80.7812) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/26] time 0.188 (0.175) data 0.109 (0.098) loss_u loss_u 0.8745 (0.8785) acc_u 18.7500 (15.0000) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/26] time 0.184 (0.177) data 0.107 (0.099) loss_u loss_u 0.8403 (0.8402) acc_u 15.6250 (17.8125) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/26] time 0.186 (0.178) data 0.107 (0.100) loss_u loss_u 0.8564 (0.8419) acc_u 15.6250 (17.9167) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/26] time 0.173 (0.178) data 0.094 (0.100) loss_u loss_u 0.8359 (0.8424) acc_u 21.8750 (18.4375) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [25/26] time 0.182 (0.178) data 0.102 (0.101) loss_u loss_u 0.8232 (0.8535) acc_u 25.0000 (17.1250) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 496
confident_label rate tensor(0.4790, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 774
clean true:748
clean false:26
clean_rate:0.9664082687338501
noisy true:372
noisy false:470
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 842
epoch [58/200] batch [5/24] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.3147 (0.5768) acc_x 90.6250 (81.8750) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/24] time 0.187 (0.185) data 0.108 (0.108) loss_x loss_x 0.7490 (0.5968) acc_x 78.1250 (83.4375) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/24] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 1.1162 (0.7071) acc_x 78.1250 (80.8333) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/24] time 0.186 (0.186) data 0.109 (0.108) loss_x loss_x 0.6987 (0.6821) acc_x 81.2500 (81.2500) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/26] time 0.187 (0.186) data 0.108 (0.108) loss_u loss_u 0.8442 (0.8684) acc_u 15.6250 (14.3750) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/26] time 0.168 (0.185) data 0.090 (0.107) loss_u loss_u 0.9712 (0.8860) acc_u 6.2500 (13.1250) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/26] time 0.183 (0.184) data 0.104 (0.106) loss_u loss_u 0.8799 (0.8851) acc_u 12.5000 (13.3333) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [20/26] time 0.165 (0.183) data 0.087 (0.105) loss_u loss_u 0.7754 (0.8741) acc_u 25.0000 (14.5312) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [25/26] time 0.173 (0.183) data 0.095 (0.105) loss_u loss_u 0.8774 (0.8703) acc_u 9.3750 (14.8750) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.4672, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 755
clean true:735
clean false:20
clean_rate:0.9735099337748344
noisy true:375
noisy false:486
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 861
epoch [59/200] batch [5/23] time 0.180 (0.186) data 0.102 (0.109) loss_x loss_x 0.3721 (0.6813) acc_x 90.6250 (81.8750) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/23] time 0.180 (0.179) data 0.103 (0.102) loss_x loss_x 0.5874 (0.7251) acc_x 87.5000 (81.5625) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/23] time 0.169 (0.178) data 0.091 (0.100) loss_x loss_x 0.5986 (0.7052) acc_x 87.5000 (82.7083) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/23] time 0.188 (0.178) data 0.110 (0.101) loss_x loss_x 0.6470 (0.6627) acc_x 75.0000 (82.9688) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/26] time 0.183 (0.177) data 0.106 (0.099) loss_u loss_u 0.8169 (0.8303) acc_u 28.1250 (20.6250) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/26] time 0.188 (0.178) data 0.110 (0.101) loss_u loss_u 0.9199 (0.8563) acc_u 9.3750 (16.8750) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/26] time 0.169 (0.178) data 0.091 (0.100) loss_u loss_u 0.8462 (0.8448) acc_u 15.6250 (18.7500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/26] time 0.175 (0.179) data 0.096 (0.101) loss_u loss_u 0.8462 (0.8415) acc_u 15.6250 (18.5938) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [25/26] time 0.179 (0.179) data 0.100 (0.101) loss_u loss_u 0.8105 (0.8485) acc_u 18.7500 (17.5000) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.4678, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 756
clean true:735
clean false:21
clean_rate:0.9722222222222222
noisy true:370
noisy false:490
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 860
epoch [60/200] batch [5/23] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 0.9761 (0.7815) acc_x 75.0000 (75.0000) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/23] time 0.188 (0.187) data 0.110 (0.109) loss_x loss_x 1.0039 (0.8017) acc_x 81.2500 (76.8750) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/23] time 0.187 (0.187) data 0.110 (0.109) loss_x loss_x 0.4709 (0.7504) acc_x 87.5000 (79.5833) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/23] time 0.184 (0.187) data 0.106 (0.109) loss_x loss_x 0.9639 (0.7916) acc_x 75.0000 (78.5938) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/26] time 0.190 (0.187) data 0.111 (0.109) loss_u loss_u 0.8506 (0.8886) acc_u 15.6250 (11.2500) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/26] time 0.188 (0.187) data 0.111 (0.109) loss_u loss_u 0.9062 (0.8669) acc_u 9.3750 (14.6875) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/26] time 0.185 (0.187) data 0.108 (0.109) loss_u loss_u 0.8804 (0.8735) acc_u 15.6250 (14.7917) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/26] time 0.179 (0.186) data 0.101 (0.108) loss_u loss_u 0.8652 (0.8708) acc_u 15.6250 (15.1562) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [25/26] time 0.172 (0.185) data 0.094 (0.107) loss_u loss_u 0.8428 (0.8611) acc_u 15.6250 (16.3750) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.4722, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 763
clean true:741
clean false:22
clean_rate:0.9711664482306684
noisy true:393
noisy false:460
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 853
epoch [61/200] batch [5/23] time 0.173 (0.181) data 0.096 (0.103) loss_x loss_x 0.6743 (0.6160) acc_x 81.2500 (81.8750) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/23] time 0.163 (0.173) data 0.085 (0.095) loss_x loss_x 0.6733 (0.6367) acc_x 87.5000 (83.1250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/23] time 0.190 (0.175) data 0.111 (0.097) loss_x loss_x 0.8164 (0.6496) acc_x 81.2500 (83.1250) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/23] time 0.183 (0.176) data 0.106 (0.098) loss_x loss_x 0.7144 (0.6802) acc_x 78.1250 (81.5625) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/26] time 0.171 (0.177) data 0.094 (0.099) loss_u loss_u 0.7871 (0.8245) acc_u 21.8750 (17.5000) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/26] time 0.178 (0.178) data 0.101 (0.100) loss_u loss_u 0.7915 (0.8351) acc_u 25.0000 (19.0625) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/26] time 0.188 (0.179) data 0.110 (0.101) loss_u loss_u 0.8467 (0.8451) acc_u 18.7500 (18.3333) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/26] time 0.185 (0.180) data 0.108 (0.102) loss_u loss_u 0.8999 (0.8522) acc_u 12.5000 (17.6562) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [25/26] time 0.171 (0.181) data 0.092 (0.103) loss_u loss_u 0.9116 (0.8511) acc_u 15.6250 (17.8750) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 501
confident_label rate tensor(0.4790, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 774
clean true:746
clean false:28
clean_rate:0.9638242894056848
noisy true:369
noisy false:473
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 842
epoch [62/200] batch [5/24] time 0.188 (0.182) data 0.109 (0.104) loss_x loss_x 0.3130 (0.8857) acc_x 96.8750 (78.7500) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/24] time 0.185 (0.185) data 0.106 (0.107) loss_x loss_x 0.7354 (0.7767) acc_x 84.3750 (79.6875) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/24] time 0.189 (0.186) data 0.110 (0.108) loss_x loss_x 0.7114 (0.7971) acc_x 78.1250 (78.5417) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/24] time 0.177 (0.185) data 0.100 (0.107) loss_x loss_x 0.6035 (0.7617) acc_x 78.1250 (79.2188) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/26] time 0.168 (0.184) data 0.090 (0.106) loss_u loss_u 0.8755 (0.8430) acc_u 15.6250 (17.5000) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/26] time 0.173 (0.182) data 0.095 (0.104) loss_u loss_u 0.8154 (0.8425) acc_u 25.0000 (17.8125) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/26] time 0.158 (0.181) data 0.080 (0.103) loss_u loss_u 0.8252 (0.8458) acc_u 25.0000 (17.7083) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/26] time 0.186 (0.180) data 0.107 (0.102) loss_u loss_u 0.8252 (0.8482) acc_u 21.8750 (17.5000) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [25/26] time 0.171 (0.179) data 0.093 (0.101) loss_u loss_u 0.9922 (0.8560) acc_u 0.0000 (16.6250) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 474
confident_label rate tensor(0.4821, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 779
clean true:756
clean false:23
clean_rate:0.9704749679075738
noisy true:386
noisy false:451
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 837
epoch [63/200] batch [5/24] time 0.171 (0.167) data 0.094 (0.090) loss_x loss_x 0.7305 (0.6593) acc_x 87.5000 (86.2500) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/24] time 0.164 (0.171) data 0.086 (0.093) loss_x loss_x 0.7207 (0.7395) acc_x 81.2500 (80.9375) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/24] time 0.171 (0.172) data 0.093 (0.095) loss_x loss_x 0.3752 (0.6386) acc_x 90.6250 (82.9167) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/24] time 0.171 (0.172) data 0.092 (0.095) loss_x loss_x 0.3865 (0.6118) acc_x 90.6250 (84.0625) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/26] time 0.194 (0.176) data 0.116 (0.099) loss_u loss_u 0.7539 (0.8167) acc_u 25.0000 (21.8750) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/26] time 0.188 (0.178) data 0.109 (0.100) loss_u loss_u 0.8506 (0.8308) acc_u 18.7500 (20.9375) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/26] time 0.171 (0.178) data 0.092 (0.101) loss_u loss_u 0.8740 (0.8375) acc_u 15.6250 (20.0000) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/26] time 0.177 (0.178) data 0.097 (0.100) loss_u loss_u 0.8481 (0.8342) acc_u 21.8750 (20.3125) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/26] time 0.162 (0.178) data 0.083 (0.100) loss_u loss_u 0.8936 (0.8447) acc_u 9.3750 (19.0000) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.4777, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 772
clean true:751
clean false:21
clean_rate:0.9727979274611399
noisy true:381
noisy false:463
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 844
epoch [64/200] batch [5/24] time 0.165 (0.164) data 0.088 (0.086) loss_x loss_x 0.5996 (0.7271) acc_x 84.3750 (84.3750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/24] time 0.199 (0.167) data 0.121 (0.090) loss_x loss_x 1.1084 (0.8211) acc_x 68.7500 (79.6875) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/24] time 0.159 (0.165) data 0.081 (0.088) loss_x loss_x 0.4905 (0.7907) acc_x 84.3750 (80.0000) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/24] time 0.168 (0.166) data 0.090 (0.088) loss_x loss_x 0.7485 (0.7773) acc_x 75.0000 (79.8438) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/26] time 0.171 (0.169) data 0.092 (0.091) loss_u loss_u 0.8955 (0.8657) acc_u 9.3750 (16.2500) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/26] time 0.178 (0.170) data 0.100 (0.092) loss_u loss_u 0.8413 (0.8444) acc_u 21.8750 (18.1250) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/26] time 0.178 (0.171) data 0.099 (0.094) loss_u loss_u 0.8496 (0.8472) acc_u 21.8750 (18.7500) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/26] time 0.174 (0.171) data 0.096 (0.093) loss_u loss_u 0.8535 (0.8500) acc_u 18.7500 (18.1250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [25/26] time 0.179 (0.172) data 0.101 (0.094) loss_u loss_u 0.8599 (0.8516) acc_u 18.7500 (18.2500) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.4901, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 792
clean true:765
clean false:27
clean_rate:0.9659090909090909
noisy true:365
noisy false:459
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 824
epoch [65/200] batch [5/24] time 0.180 (0.185) data 0.103 (0.107) loss_x loss_x 0.8179 (0.6340) acc_x 78.1250 (82.5000) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/24] time 0.161 (0.178) data 0.083 (0.100) loss_x loss_x 0.7158 (0.6240) acc_x 84.3750 (83.7500) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/24] time 0.168 (0.173) data 0.091 (0.095) loss_x loss_x 0.7695 (0.6630) acc_x 75.0000 (81.8750) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/24] time 0.174 (0.173) data 0.097 (0.095) loss_x loss_x 0.5562 (0.6868) acc_x 84.3750 (80.7812) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/25] time 0.168 (0.174) data 0.091 (0.096) loss_u loss_u 0.8716 (0.8475) acc_u 15.6250 (18.1250) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/25] time 0.188 (0.174) data 0.110 (0.097) loss_u loss_u 0.8291 (0.8735) acc_u 18.7500 (14.0625) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/25] time 0.169 (0.175) data 0.091 (0.097) loss_u loss_u 0.8252 (0.8535) acc_u 21.8750 (16.2500) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/25] time 0.172 (0.174) data 0.094 (0.096) loss_u loss_u 0.7603 (0.8476) acc_u 28.1250 (17.0312) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [25/25] time 0.178 (0.175) data 0.100 (0.097) loss_u loss_u 0.8105 (0.8507) acc_u 28.1250 (17.0000) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.4728, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 764
clean true:740
clean false:24
clean_rate:0.9685863874345549
noisy true:383
noisy false:469
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 852
epoch [66/200] batch [5/23] time 0.186 (0.176) data 0.109 (0.098) loss_x loss_x 0.6089 (0.6798) acc_x 84.3750 (82.5000) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/23] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 0.9160 (0.7144) acc_x 84.3750 (82.1875) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/23] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 1.1885 (0.7145) acc_x 75.0000 (81.4583) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/23] time 0.185 (0.179) data 0.108 (0.101) loss_x loss_x 0.8486 (0.6921) acc_x 75.0000 (81.4062) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/26] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.8477 (0.8460) acc_u 15.6250 (17.5000) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/26] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8691 (0.8231) acc_u 15.6250 (21.2500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/26] time 0.186 (0.182) data 0.109 (0.104) loss_u loss_u 0.7964 (0.8356) acc_u 28.1250 (20.6250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/26] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.8994 (0.8453) acc_u 12.5000 (19.2188) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [25/26] time 0.191 (0.183) data 0.113 (0.105) loss_u loss_u 0.9199 (0.8501) acc_u 9.3750 (18.6250) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.4666, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 754
clean true:735
clean false:19
clean_rate:0.9748010610079576
noisy true:391
noisy false:471
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 862
epoch [67/200] batch [5/23] time 0.169 (0.178) data 0.092 (0.100) loss_x loss_x 0.8984 (0.6814) acc_x 78.1250 (83.7500) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/23] time 0.167 (0.177) data 0.090 (0.100) loss_x loss_x 0.7349 (0.6910) acc_x 81.2500 (83.4375) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/23] time 0.187 (0.177) data 0.110 (0.100) loss_x loss_x 0.4463 (0.6445) acc_x 87.5000 (85.0000) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [20/23] time 0.199 (0.181) data 0.121 (0.104) loss_x loss_x 0.5889 (0.6403) acc_x 87.5000 (84.6875) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/26] time 0.176 (0.180) data 0.098 (0.103) loss_u loss_u 0.6572 (0.8187) acc_u 37.5000 (22.5000) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/26] time 0.176 (0.180) data 0.097 (0.103) loss_u loss_u 0.8291 (0.8369) acc_u 18.7500 (19.0625) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/26] time 0.170 (0.179) data 0.092 (0.101) loss_u loss_u 0.8896 (0.8349) acc_u 9.3750 (19.3750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [20/26] time 0.170 (0.178) data 0.092 (0.100) loss_u loss_u 0.8354 (0.8463) acc_u 18.7500 (18.2812) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [25/26] time 0.175 (0.177) data 0.097 (0.099) loss_u loss_u 0.9468 (0.8523) acc_u 6.2500 (17.6250) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.4833, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 781
clean true:752
clean false:29
clean_rate:0.9628681177976952
noisy true:378
noisy false:457
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 835
epoch [68/200] batch [5/24] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.4873 (0.7257) acc_x 87.5000 (80.6250) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/24] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 1.1953 (0.7887) acc_x 65.6250 (77.8125) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/24] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.9365 (0.7830) acc_x 71.8750 (77.5000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/24] time 0.179 (0.183) data 0.101 (0.106) loss_x loss_x 0.8911 (0.7530) acc_x 81.2500 (78.9062) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/26] time 0.168 (0.180) data 0.090 (0.103) loss_u loss_u 0.8491 (0.8427) acc_u 15.6250 (18.7500) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/26] time 0.178 (0.180) data 0.100 (0.102) loss_u loss_u 0.9092 (0.8780) acc_u 15.6250 (14.3750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/26] time 0.187 (0.179) data 0.108 (0.102) loss_u loss_u 0.8521 (0.8677) acc_u 18.7500 (15.2083) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/26] time 0.161 (0.179) data 0.084 (0.102) loss_u loss_u 0.9199 (0.8646) acc_u 6.2500 (15.1562) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [25/26] time 0.175 (0.179) data 0.097 (0.101) loss_u loss_u 0.8906 (0.8599) acc_u 12.5000 (15.7500) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 492
confident_label rate tensor(0.4790, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 774
clean true:746
clean false:28
clean_rate:0.9638242894056848
noisy true:378
noisy false:464
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 842
epoch [69/200] batch [5/24] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.5581 (0.6287) acc_x 87.5000 (82.5000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/24] time 0.176 (0.182) data 0.097 (0.105) loss_x loss_x 0.8066 (0.7260) acc_x 78.1250 (80.6250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/24] time 0.158 (0.181) data 0.080 (0.103) loss_x loss_x 0.4268 (0.7314) acc_x 84.3750 (80.2083) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/24] time 0.187 (0.179) data 0.108 (0.101) loss_x loss_x 0.4561 (0.7307) acc_x 93.7500 (80.6250) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/26] time 0.160 (0.179) data 0.082 (0.101) loss_u loss_u 0.9434 (0.8473) acc_u 6.2500 (20.0000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/26] time 0.162 (0.177) data 0.083 (0.100) loss_u loss_u 0.8979 (0.8605) acc_u 6.2500 (16.5625) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/26] time 0.166 (0.176) data 0.086 (0.098) loss_u loss_u 0.7363 (0.8525) acc_u 31.2500 (16.8750) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/26] time 0.166 (0.176) data 0.088 (0.098) loss_u loss_u 0.9106 (0.8537) acc_u 15.6250 (17.0312) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [25/26] time 0.165 (0.175) data 0.088 (0.097) loss_u loss_u 0.9106 (0.8496) acc_u 9.3750 (17.6250) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 463
confident_label rate tensor(0.4864, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 786
clean true:758
clean false:28
clean_rate:0.9643765903307888
noisy true:395
noisy false:435
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 830
epoch [70/200] batch [5/24] time 0.163 (0.177) data 0.085 (0.099) loss_x loss_x 0.5815 (0.6399) acc_x 81.2500 (83.7500) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/24] time 0.179 (0.179) data 0.101 (0.101) loss_x loss_x 0.7300 (0.6491) acc_x 71.8750 (81.8750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/24] time 0.162 (0.177) data 0.084 (0.099) loss_x loss_x 0.9043 (0.7155) acc_x 78.1250 (79.3750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/24] time 0.172 (0.177) data 0.094 (0.099) loss_x loss_x 0.6519 (0.7396) acc_x 81.2500 (79.2188) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/25] time 0.188 (0.179) data 0.110 (0.102) loss_u loss_u 0.8545 (0.8337) acc_u 18.7500 (21.2500) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/25] time 0.183 (0.181) data 0.105 (0.103) loss_u loss_u 0.8569 (0.8479) acc_u 15.6250 (18.7500) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/25] time 0.186 (0.182) data 0.108 (0.104) loss_u loss_u 0.9136 (0.8533) acc_u 12.5000 (17.9167) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/25] time 0.184 (0.182) data 0.106 (0.104) loss_u loss_u 0.8906 (0.8527) acc_u 12.5000 (17.9688) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [25/25] time 0.183 (0.182) data 0.105 (0.104) loss_u loss_u 0.8232 (0.8529) acc_u 18.7500 (17.7500) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 485
confident_label rate tensor(0.4827, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 780
clean true:747
clean false:33
clean_rate:0.9576923076923077
noisy true:384
noisy false:452
after delete: len(clean_dataset) 780
after delete: len(noisy_dataset) 836
epoch [71/200] batch [5/24] time 0.172 (0.168) data 0.094 (0.091) loss_x loss_x 0.9756 (0.7657) acc_x 78.1250 (78.7500) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/24] time 0.174 (0.170) data 0.095 (0.092) loss_x loss_x 0.4595 (0.6822) acc_x 93.7500 (82.1875) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/24] time 0.167 (0.169) data 0.090 (0.092) loss_x loss_x 0.4592 (0.6465) acc_x 90.6250 (82.7083) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [20/24] time 0.185 (0.170) data 0.107 (0.093) loss_x loss_x 0.7949 (0.6628) acc_x 78.1250 (82.9688) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/26] time 0.185 (0.172) data 0.108 (0.094) loss_u loss_u 0.7959 (0.8395) acc_u 25.0000 (19.3750) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/26] time 0.170 (0.173) data 0.092 (0.095) loss_u loss_u 0.9355 (0.8485) acc_u 9.3750 (17.8125) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/26] time 0.184 (0.173) data 0.106 (0.095) loss_u loss_u 0.8994 (0.8501) acc_u 9.3750 (17.2917) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [20/26] time 0.170 (0.174) data 0.092 (0.096) loss_u loss_u 0.7622 (0.8504) acc_u 28.1250 (16.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [25/26] time 0.174 (0.174) data 0.096 (0.096) loss_u loss_u 0.8696 (0.8552) acc_u 15.6250 (16.1250) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 473
confident_label rate tensor(0.4932, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 797
clean true:771
clean false:26
clean_rate:0.9673776662484316
noisy true:372
noisy false:447
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 819
epoch [72/200] batch [5/24] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 0.4312 (0.7398) acc_x 87.5000 (78.1250) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/24] time 0.173 (0.174) data 0.095 (0.096) loss_x loss_x 0.3376 (0.6464) acc_x 87.5000 (82.8125) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/24] time 0.175 (0.176) data 0.097 (0.098) loss_x loss_x 0.6602 (0.6669) acc_x 81.2500 (82.2917) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/24] time 0.172 (0.174) data 0.094 (0.097) loss_x loss_x 0.6382 (0.6625) acc_x 78.1250 (82.1875) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/25] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.9180 (0.8286) acc_u 6.2500 (19.3750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/25] time 0.175 (0.174) data 0.096 (0.097) loss_u loss_u 0.9043 (0.8402) acc_u 9.3750 (19.0625) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/25] time 0.179 (0.174) data 0.101 (0.096) loss_u loss_u 0.7900 (0.8538) acc_u 28.1250 (17.0833) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/25] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.8608 (0.8633) acc_u 15.6250 (15.9375) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [25/25] time 0.175 (0.175) data 0.097 (0.097) loss_u loss_u 0.8477 (0.8595) acc_u 18.7500 (16.2500) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.4796, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 775
clean true:745
clean false:30
clean_rate:0.9612903225806452
noisy true:400
noisy false:441
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 841
epoch [73/200] batch [5/24] time 0.169 (0.176) data 0.092 (0.098) loss_x loss_x 0.8062 (0.8965) acc_x 81.2500 (78.1250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/24] time 0.184 (0.182) data 0.107 (0.104) loss_x loss_x 0.5273 (0.7089) acc_x 84.3750 (81.5625) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/24] time 0.185 (0.181) data 0.107 (0.104) loss_x loss_x 0.6641 (0.6850) acc_x 84.3750 (81.0417) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [20/24] time 0.235 (0.184) data 0.157 (0.107) loss_x loss_x 0.8809 (0.6887) acc_x 81.2500 (81.5625) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/26] time 0.190 (0.185) data 0.111 (0.107) loss_u loss_u 0.8662 (0.8055) acc_u 12.5000 (21.2500) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/26] time 0.170 (0.184) data 0.091 (0.107) loss_u loss_u 0.9673 (0.8308) acc_u 6.2500 (19.3750) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/26] time 0.180 (0.182) data 0.102 (0.104) loss_u loss_u 0.9058 (0.8415) acc_u 9.3750 (18.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/26] time 0.184 (0.182) data 0.106 (0.104) loss_u loss_u 0.8066 (0.8390) acc_u 21.8750 (18.7500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [25/26] time 0.172 (0.181) data 0.094 (0.103) loss_u loss_u 0.9067 (0.8378) acc_u 9.3750 (18.7500) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.4765, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 770
clean true:739
clean false:31
clean_rate:0.9597402597402598
noisy true:393
noisy false:453
after delete: len(clean_dataset) 770
after delete: len(noisy_dataset) 846
epoch [74/200] batch [5/24] time 0.190 (0.184) data 0.113 (0.107) loss_x loss_x 0.6606 (0.8455) acc_x 81.2500 (80.0000) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/24] time 0.186 (0.191) data 0.109 (0.114) loss_x loss_x 0.5967 (0.8435) acc_x 78.1250 (78.4375) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/24] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.4392 (0.7739) acc_x 81.2500 (80.0000) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [20/24] time 0.180 (0.185) data 0.103 (0.108) loss_x loss_x 0.4575 (0.7258) acc_x 87.5000 (81.2500) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/26] time 0.185 (0.183) data 0.105 (0.106) loss_u loss_u 0.8442 (0.8447) acc_u 18.7500 (18.7500) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/26] time 0.189 (0.184) data 0.111 (0.106) loss_u loss_u 0.7661 (0.8334) acc_u 28.1250 (20.0000) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/26] time 0.185 (0.184) data 0.108 (0.106) loss_u loss_u 0.8755 (0.8303) acc_u 15.6250 (21.0417) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/26] time 0.162 (0.184) data 0.085 (0.107) loss_u loss_u 0.8276 (0.8369) acc_u 18.7500 (19.8438) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [25/26] time 0.186 (0.183) data 0.107 (0.106) loss_u loss_u 0.8115 (0.8410) acc_u 21.8750 (18.8750) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 454
confident_label rate tensor(0.4901, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 792
clean true:776
clean false:16
clean_rate:0.9797979797979798
noisy true:386
noisy false:438
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 824
epoch [75/200] batch [5/24] time 0.159 (0.170) data 0.082 (0.093) loss_x loss_x 0.8247 (0.7346) acc_x 65.6250 (77.5000) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/24] time 0.176 (0.170) data 0.098 (0.093) loss_x loss_x 0.5103 (0.6993) acc_x 87.5000 (79.0625) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/24] time 0.187 (0.176) data 0.110 (0.098) loss_x loss_x 0.6211 (0.6492) acc_x 84.3750 (80.4167) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/24] time 0.174 (0.178) data 0.096 (0.100) loss_x loss_x 0.7383 (0.6236) acc_x 65.6250 (80.7812) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/25] time 0.170 (0.177) data 0.093 (0.099) loss_u loss_u 0.6655 (0.8294) acc_u 37.5000 (19.3750) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/25] time 0.163 (0.175) data 0.084 (0.097) loss_u loss_u 0.9224 (0.8441) acc_u 9.3750 (18.4375) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/25] time 0.173 (0.174) data 0.095 (0.096) loss_u loss_u 0.7998 (0.8455) acc_u 21.8750 (18.1250) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/25] time 0.188 (0.176) data 0.110 (0.098) loss_u loss_u 0.8306 (0.8512) acc_u 21.8750 (17.8125) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [25/25] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.8193 (0.8534) acc_u 18.7500 (17.6250) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 481
confident_label rate tensor(0.4981, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 805
clean true:778
clean false:27
clean_rate:0.9664596273291925
noisy true:357
noisy false:454
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 811
epoch [76/200] batch [5/25] time 0.185 (0.190) data 0.109 (0.112) loss_x loss_x 0.5698 (0.8451) acc_x 81.2500 (75.6250) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/25] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.6323 (0.6855) acc_x 84.3750 (81.8750) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/25] time 0.163 (0.180) data 0.084 (0.103) loss_x loss_x 0.3462 (0.6339) acc_x 93.7500 (83.7500) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/25] time 0.173 (0.179) data 0.096 (0.102) loss_x loss_x 0.5913 (0.7180) acc_x 78.1250 (81.0938) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [25/25] time 0.178 (0.179) data 0.100 (0.102) loss_x loss_x 0.7163 (0.6962) acc_x 84.3750 (81.8750) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/25] time 0.171 (0.178) data 0.093 (0.100) loss_u loss_u 0.7871 (0.8605) acc_u 25.0000 (16.2500) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/25] time 0.188 (0.178) data 0.110 (0.100) loss_u loss_u 0.8677 (0.8635) acc_u 12.5000 (15.6250) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/25] time 0.172 (0.177) data 0.093 (0.100) loss_u loss_u 0.8843 (0.8693) acc_u 15.6250 (15.2083) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/25] time 0.192 (0.178) data 0.112 (0.100) loss_u loss_u 0.8931 (0.8680) acc_u 15.6250 (15.6250) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [25/25] time 0.188 (0.179) data 0.110 (0.101) loss_u loss_u 0.9043 (0.8612) acc_u 9.3750 (16.5000) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 489
confident_label rate tensor(0.4653, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 752
clean true:728
clean false:24
clean_rate:0.9680851063829787
noisy true:399
noisy false:465
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 864
epoch [77/200] batch [5/23] time 0.191 (0.186) data 0.113 (0.108) loss_x loss_x 0.9829 (0.6864) acc_x 68.7500 (82.5000) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/23] time 0.168 (0.183) data 0.089 (0.106) loss_x loss_x 0.5938 (0.6296) acc_x 84.3750 (84.3750) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/23] time 0.195 (0.182) data 0.116 (0.105) loss_x loss_x 0.7236 (0.6577) acc_x 75.0000 (83.9583) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [20/23] time 0.178 (0.180) data 0.100 (0.103) loss_x loss_x 0.7617 (0.6518) acc_x 81.2500 (83.5938) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/27] time 0.181 (0.180) data 0.103 (0.102) loss_u loss_u 0.7739 (0.8377) acc_u 28.1250 (19.3750) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/27] time 0.188 (0.180) data 0.110 (0.102) loss_u loss_u 0.8789 (0.8317) acc_u 12.5000 (19.0625) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/27] time 0.191 (0.180) data 0.113 (0.102) loss_u loss_u 0.8584 (0.8327) acc_u 12.5000 (18.7500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/27] time 0.170 (0.179) data 0.093 (0.101) loss_u loss_u 0.8887 (0.8373) acc_u 15.6250 (18.9062) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [25/27] time 0.179 (0.178) data 0.101 (0.100) loss_u loss_u 0.8599 (0.8348) acc_u 18.7500 (19.1250) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 475
confident_label rate tensor(0.4876, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 788
clean true:764
clean false:24
clean_rate:0.9695431472081218
noisy true:377
noisy false:451
after delete: len(clean_dataset) 788
after delete: len(noisy_dataset) 828
epoch [78/200] batch [5/24] time 0.194 (0.194) data 0.117 (0.116) loss_x loss_x 0.5205 (0.6010) acc_x 84.3750 (84.3750) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/24] time 0.191 (0.190) data 0.114 (0.112) loss_x loss_x 0.1475 (0.6539) acc_x 100.0000 (83.7500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/24] time 0.189 (0.188) data 0.112 (0.111) loss_x loss_x 0.9463 (0.6715) acc_x 75.0000 (81.8750) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/24] time 0.187 (0.187) data 0.110 (0.109) loss_x loss_x 0.2155 (0.6760) acc_x 93.7500 (82.0312) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/25] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.8701 (0.8603) acc_u 12.5000 (15.6250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/25] time 0.195 (0.184) data 0.117 (0.106) loss_u loss_u 0.8975 (0.8631) acc_u 12.5000 (15.9375) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/25] time 0.193 (0.183) data 0.115 (0.106) loss_u loss_u 0.8970 (0.8579) acc_u 15.6250 (16.8750) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/25] time 0.173 (0.182) data 0.095 (0.105) loss_u loss_u 0.7715 (0.8509) acc_u 31.2500 (17.6562) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [25/25] time 0.181 (0.182) data 0.103 (0.104) loss_u loss_u 0.8354 (0.8470) acc_u 21.8750 (18.0000) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 443
confident_label rate tensor(0.4895, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 791
clean true:770
clean false:21
clean_rate:0.9734513274336283
noisy true:403
noisy false:422
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 825
epoch [79/200] batch [5/24] time 0.183 (0.186) data 0.106 (0.108) loss_x loss_x 0.9146 (0.5572) acc_x 81.2500 (85.6250) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/24] time 0.160 (0.179) data 0.082 (0.102) loss_x loss_x 0.7637 (0.6351) acc_x 75.0000 (82.8125) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/24] time 0.182 (0.185) data 0.104 (0.107) loss_x loss_x 1.1270 (0.6484) acc_x 68.7500 (82.0833) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/24] time 0.174 (0.184) data 0.097 (0.106) loss_x loss_x 0.6636 (0.6209) acc_x 84.3750 (83.2812) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/25] time 0.169 (0.182) data 0.092 (0.105) loss_u loss_u 0.8594 (0.8641) acc_u 18.7500 (16.2500) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/25] time 0.163 (0.180) data 0.085 (0.102) loss_u loss_u 0.8813 (0.8581) acc_u 15.6250 (17.1875) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/25] time 0.188 (0.180) data 0.110 (0.102) loss_u loss_u 0.9556 (0.8652) acc_u 3.1250 (15.8333) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/25] time 0.169 (0.179) data 0.091 (0.101) loss_u loss_u 0.8584 (0.8633) acc_u 15.6250 (15.7812) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [25/25] time 0.178 (0.178) data 0.100 (0.100) loss_u loss_u 0.8516 (0.8605) acc_u 15.6250 (16.2500) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.4895, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 791
clean true:766
clean false:25
clean_rate:0.9683944374209861
noisy true:386
noisy false:439
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 825
epoch [80/200] batch [5/24] time 0.181 (0.179) data 0.102 (0.102) loss_x loss_x 1.2773 (0.7289) acc_x 75.0000 (81.8750) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/24] time 0.175 (0.178) data 0.096 (0.100) loss_x loss_x 0.7476 (0.7028) acc_x 81.2500 (81.8750) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/24] time 0.167 (0.174) data 0.088 (0.096) loss_x loss_x 0.3098 (0.6211) acc_x 90.6250 (83.7500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [20/24] time 0.169 (0.174) data 0.092 (0.096) loss_x loss_x 0.9736 (0.6653) acc_x 75.0000 (82.1875) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/25] time 0.176 (0.175) data 0.098 (0.097) loss_u loss_u 0.8340 (0.8562) acc_u 21.8750 (16.2500) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/25] time 0.166 (0.174) data 0.088 (0.096) loss_u loss_u 0.8726 (0.8576) acc_u 12.5000 (16.2500) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/25] time 0.178 (0.174) data 0.101 (0.096) loss_u loss_u 0.8770 (0.8657) acc_u 9.3750 (15.8333) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [20/25] time 0.186 (0.176) data 0.109 (0.098) loss_u loss_u 0.9092 (0.8602) acc_u 9.3750 (15.7812) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [25/25] time 0.170 (0.176) data 0.092 (0.098) loss_u loss_u 0.8877 (0.8546) acc_u 12.5000 (16.5000) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 475
confident_label rate tensor(0.4932, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 797
clean true:772
clean false:25
clean_rate:0.9686323713927227
noisy true:369
noisy false:450
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 819
epoch [81/200] batch [5/24] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 0.5430 (0.6127) acc_x 78.1250 (80.0000) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/24] time 0.164 (0.180) data 0.086 (0.102) loss_x loss_x 0.5508 (0.5935) acc_x 84.3750 (82.1875) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/24] time 0.181 (0.177) data 0.103 (0.100) loss_x loss_x 0.6611 (0.5943) acc_x 87.5000 (82.2917) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [20/24] time 0.161 (0.176) data 0.083 (0.099) loss_x loss_x 0.6172 (0.6021) acc_x 78.1250 (81.8750) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/25] time 0.172 (0.178) data 0.094 (0.100) loss_u loss_u 0.8281 (0.8728) acc_u 15.6250 (12.5000) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/25] time 0.183 (0.178) data 0.104 (0.100) loss_u loss_u 0.7627 (0.8547) acc_u 25.0000 (15.6250) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/25] time 0.173 (0.177) data 0.094 (0.099) loss_u loss_u 0.8286 (0.8602) acc_u 21.8750 (15.2083) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [20/25] time 0.191 (0.178) data 0.113 (0.100) loss_u loss_u 0.7998 (0.8592) acc_u 18.7500 (15.1562) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [25/25] time 0.169 (0.177) data 0.091 (0.099) loss_u loss_u 0.8745 (0.8620) acc_u 12.5000 (14.8750) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 807
clean true:778
clean false:29
clean_rate:0.9640644361833953
noisy true:379
noisy false:430
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 809
epoch [82/200] batch [5/25] time 0.184 (0.189) data 0.106 (0.111) loss_x loss_x 0.4924 (0.7011) acc_x 87.5000 (83.7500) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/25] time 0.166 (0.184) data 0.089 (0.106) loss_x loss_x 0.5444 (0.6352) acc_x 84.3750 (83.4375) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/25] time 0.166 (0.179) data 0.088 (0.101) loss_x loss_x 1.1729 (0.6762) acc_x 65.6250 (81.2500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/25] time 0.165 (0.175) data 0.088 (0.098) loss_x loss_x 0.4456 (0.6646) acc_x 87.5000 (81.5625) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [25/25] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.8584 (0.6575) acc_x 78.1250 (82.6250) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/25] time 0.178 (0.176) data 0.100 (0.099) loss_u loss_u 0.8994 (0.8834) acc_u 12.5000 (12.5000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/25] time 0.168 (0.178) data 0.090 (0.100) loss_u loss_u 0.8462 (0.8726) acc_u 18.7500 (14.0625) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/25] time 0.172 (0.177) data 0.093 (0.099) loss_u loss_u 0.8589 (0.8704) acc_u 15.6250 (14.1667) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/25] time 0.180 (0.177) data 0.102 (0.100) loss_u loss_u 0.9346 (0.8819) acc_u 6.2500 (12.5000) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [25/25] time 0.171 (0.177) data 0.093 (0.099) loss_u loss_u 0.9141 (0.8673) acc_u 6.2500 (14.3750) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4765, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 770
clean true:744
clean false:26
clean_rate:0.9662337662337662
noisy true:378
noisy false:468
after delete: len(clean_dataset) 770
after delete: len(noisy_dataset) 846
epoch [83/200] batch [5/24] time 0.179 (0.176) data 0.101 (0.098) loss_x loss_x 0.8833 (0.7511) acc_x 75.0000 (80.6250) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/24] time 0.173 (0.179) data 0.095 (0.101) loss_x loss_x 0.3987 (0.6979) acc_x 84.3750 (81.2500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/24] time 0.187 (0.184) data 0.110 (0.106) loss_x loss_x 0.3713 (0.6578) acc_x 93.7500 (82.7083) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/24] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.8989 (0.6599) acc_x 78.1250 (82.5000) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/26] time 0.169 (0.181) data 0.091 (0.103) loss_u loss_u 0.9341 (0.8375) acc_u 9.3750 (18.7500) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/26] time 0.171 (0.180) data 0.092 (0.102) loss_u loss_u 0.8008 (0.8412) acc_u 21.8750 (18.4375) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/26] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.8799 (0.8364) acc_u 15.6250 (18.7500) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/26] time 0.170 (0.179) data 0.092 (0.102) loss_u loss_u 0.8032 (0.8315) acc_u 18.7500 (19.0625) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [25/26] time 0.170 (0.179) data 0.093 (0.101) loss_u loss_u 0.8188 (0.8392) acc_u 18.7500 (18.6250) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 458
confident_label rate tensor(0.4926, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 796
clean true:773
clean false:23
clean_rate:0.9711055276381909
noisy true:385
noisy false:435
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 820
epoch [84/200] batch [5/24] time 0.188 (0.185) data 0.110 (0.108) loss_x loss_x 0.6865 (0.6489) acc_x 87.5000 (88.1250) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/24] time 0.178 (0.184) data 0.100 (0.106) loss_x loss_x 1.0889 (0.6656) acc_x 71.8750 (85.9375) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/24] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.2698 (0.6791) acc_x 90.6250 (84.5833) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/24] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 1.2285 (0.6860) acc_x 68.7500 (84.2188) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/25] time 0.188 (0.182) data 0.110 (0.104) loss_u loss_u 0.8501 (0.8591) acc_u 15.6250 (14.3750) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/25] time 0.185 (0.182) data 0.108 (0.104) loss_u loss_u 0.8818 (0.8631) acc_u 12.5000 (14.6875) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/25] time 0.170 (0.180) data 0.092 (0.102) loss_u loss_u 0.8228 (0.8481) acc_u 21.8750 (16.6667) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/25] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.8037 (0.8474) acc_u 25.0000 (16.5625) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [25/25] time 0.168 (0.179) data 0.091 (0.102) loss_u loss_u 0.8252 (0.8482) acc_u 18.7500 (16.7500) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 457
confident_label rate tensor(0.4950, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 800
clean true:780
clean false:20
clean_rate:0.975
noisy true:379
noisy false:437
after delete: len(clean_dataset) 800
after delete: len(noisy_dataset) 816
epoch [85/200] batch [5/25] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 0.7769 (0.6885) acc_x 78.1250 (81.8750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/25] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.4426 (0.6409) acc_x 96.8750 (83.1250) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/25] time 0.190 (0.183) data 0.113 (0.106) loss_x loss_x 0.8394 (0.6656) acc_x 84.3750 (83.3333) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/25] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.6743 (0.6676) acc_x 75.0000 (82.8125) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [25/25] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.4456 (0.6442) acc_x 87.5000 (82.6250) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/25] time 0.175 (0.182) data 0.097 (0.105) loss_u loss_u 0.8652 (0.8054) acc_u 15.6250 (21.2500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/25] time 0.168 (0.180) data 0.090 (0.103) loss_u loss_u 0.9170 (0.8405) acc_u 12.5000 (19.0625) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/25] time 0.190 (0.181) data 0.111 (0.103) loss_u loss_u 0.9658 (0.8538) acc_u 6.2500 (17.5000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/25] time 0.171 (0.180) data 0.093 (0.102) loss_u loss_u 0.9141 (0.8618) acc_u 9.3750 (16.5625) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [25/25] time 0.174 (0.179) data 0.096 (0.101) loss_u loss_u 0.8364 (0.8602) acc_u 21.8750 (16.7500) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 478
confident_label rate tensor(0.4889, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 790
clean true:768
clean false:22
clean_rate:0.9721518987341772
noisy true:370
noisy false:456
after delete: len(clean_dataset) 790
after delete: len(noisy_dataset) 826
epoch [86/200] batch [5/24] time 0.190 (0.181) data 0.113 (0.104) loss_x loss_x 1.0801 (0.7532) acc_x 71.8750 (81.2500) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/24] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 1.1826 (0.6946) acc_x 75.0000 (82.5000) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/24] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4939 (0.6550) acc_x 87.5000 (83.3333) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/24] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.8423 (0.6598) acc_x 71.8750 (82.1875) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/25] time 0.176 (0.180) data 0.097 (0.103) loss_u loss_u 0.8486 (0.8866) acc_u 18.7500 (13.1250) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/25] time 0.167 (0.180) data 0.089 (0.102) loss_u loss_u 0.7583 (0.8548) acc_u 34.3750 (18.1250) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/25] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.8608 (0.8595) acc_u 15.6250 (17.2917) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/25] time 0.168 (0.180) data 0.090 (0.102) loss_u loss_u 0.8838 (0.8498) acc_u 15.6250 (18.4375) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [25/25] time 0.185 (0.179) data 0.106 (0.101) loss_u loss_u 0.8706 (0.8561) acc_u 12.5000 (17.3750) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.4920, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 795
clean true:768
clean false:27
clean_rate:0.9660377358490566
noisy true:377
noisy false:444
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 821
epoch [87/200] batch [5/24] time 0.159 (0.162) data 0.082 (0.084) loss_x loss_x 0.4187 (0.5805) acc_x 87.5000 (83.1250) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/24] time 0.174 (0.169) data 0.096 (0.092) loss_x loss_x 0.4685 (0.6001) acc_x 90.6250 (83.4375) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/24] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.4272 (0.5690) acc_x 87.5000 (84.7917) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/24] time 0.163 (0.171) data 0.086 (0.094) loss_x loss_x 0.4307 (0.6270) acc_x 87.5000 (82.9688) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/25] time 0.160 (0.171) data 0.083 (0.093) loss_u loss_u 0.8779 (0.8293) acc_u 15.6250 (18.1250) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/25] time 0.195 (0.173) data 0.118 (0.095) loss_u loss_u 0.8892 (0.8430) acc_u 18.7500 (17.1875) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/25] time 0.184 (0.175) data 0.106 (0.097) loss_u loss_u 0.8301 (0.8475) acc_u 15.6250 (16.8750) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/25] time 0.177 (0.175) data 0.098 (0.097) loss_u loss_u 0.8687 (0.8494) acc_u 15.6250 (17.1875) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [25/25] time 0.167 (0.175) data 0.089 (0.097) loss_u loss_u 0.7979 (0.8498) acc_u 21.8750 (16.8750) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 809
clean true:782
clean false:27
clean_rate:0.9666254635352287
noisy true:392
noisy false:415
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 807
epoch [88/200] batch [5/25] time 0.173 (0.171) data 0.095 (0.093) loss_x loss_x 0.6138 (0.6669) acc_x 81.2500 (81.8750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/25] time 0.169 (0.174) data 0.091 (0.097) loss_x loss_x 0.5249 (0.6599) acc_x 84.3750 (81.5625) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/25] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.7393 (0.6207) acc_x 84.3750 (83.3333) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/25] time 0.182 (0.173) data 0.104 (0.095) loss_x loss_x 0.4343 (0.6175) acc_x 87.5000 (82.9688) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [25/25] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.5674 (0.5873) acc_x 87.5000 (83.8750) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/25] time 0.163 (0.175) data 0.084 (0.097) loss_u loss_u 0.9585 (0.8727) acc_u 3.1250 (14.3750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/25] time 0.169 (0.174) data 0.091 (0.096) loss_u loss_u 0.8677 (0.8800) acc_u 18.7500 (13.7500) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/25] time 0.189 (0.174) data 0.110 (0.096) loss_u loss_u 0.9492 (0.8812) acc_u 6.2500 (13.7500) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/25] time 0.187 (0.175) data 0.109 (0.097) loss_u loss_u 0.8315 (0.8698) acc_u 15.6250 (14.6875) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [25/25] time 0.186 (0.176) data 0.108 (0.098) loss_u loss_u 0.8853 (0.8688) acc_u 12.5000 (15.1250) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.4895, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 791
clean true:769
clean false:22
clean_rate:0.9721871049304678
noisy true:394
noisy false:431
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 825
epoch [89/200] batch [5/24] time 0.160 (0.178) data 0.083 (0.101) loss_x loss_x 0.5024 (0.6923) acc_x 84.3750 (81.8750) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/24] time 0.170 (0.175) data 0.093 (0.097) loss_x loss_x 0.6191 (0.6162) acc_x 81.2500 (84.0625) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/24] time 0.167 (0.173) data 0.090 (0.096) loss_x loss_x 0.9375 (0.6224) acc_x 78.1250 (84.1667) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/24] time 0.164 (0.172) data 0.086 (0.095) loss_x loss_x 0.4919 (0.6240) acc_x 84.3750 (84.3750) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/25] time 0.171 (0.171) data 0.092 (0.093) loss_u loss_u 0.8765 (0.8372) acc_u 15.6250 (19.3750) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/25] time 0.167 (0.170) data 0.090 (0.093) loss_u loss_u 0.8262 (0.8339) acc_u 25.0000 (20.3125) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/25] time 0.169 (0.171) data 0.091 (0.094) loss_u loss_u 0.8477 (0.8339) acc_u 18.7500 (20.2083) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/25] time 0.184 (0.171) data 0.106 (0.094) loss_u loss_u 0.7451 (0.8351) acc_u 31.2500 (19.5312) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [25/25] time 0.176 (0.172) data 0.097 (0.094) loss_u loss_u 0.8721 (0.8386) acc_u 12.5000 (18.8750) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 438
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 802
clean true:773
clean false:29
clean_rate:0.9638403990024937
noisy true:405
noisy false:409
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 814
epoch [90/200] batch [5/25] time 0.171 (0.168) data 0.094 (0.090) loss_x loss_x 0.4001 (0.6815) acc_x 90.6250 (81.8750) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/25] time 0.174 (0.171) data 0.096 (0.093) loss_x loss_x 0.8730 (0.6815) acc_x 81.2500 (81.8750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/25] time 0.163 (0.169) data 0.086 (0.092) loss_x loss_x 1.0137 (0.7303) acc_x 75.0000 (80.8333) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/25] time 0.168 (0.170) data 0.091 (0.093) loss_x loss_x 0.2181 (0.7345) acc_x 96.8750 (80.4688) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [25/25] time 0.168 (0.169) data 0.091 (0.091) loss_x loss_x 0.8501 (0.7192) acc_x 84.3750 (81.0000) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/25] time 0.190 (0.171) data 0.111 (0.094) loss_u loss_u 0.8057 (0.8563) acc_u 21.8750 (16.2500) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/25] time 0.169 (0.171) data 0.090 (0.094) loss_u loss_u 0.7764 (0.8560) acc_u 28.1250 (16.2500) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/25] time 0.161 (0.171) data 0.084 (0.093) loss_u loss_u 0.8623 (0.8521) acc_u 15.6250 (16.8750) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/25] time 0.175 (0.173) data 0.098 (0.095) loss_u loss_u 0.8472 (0.8587) acc_u 18.7500 (16.5625) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [25/25] time 0.168 (0.173) data 0.090 (0.095) loss_u loss_u 0.7891 (0.8546) acc_u 25.0000 (16.8750) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 447
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 804
clean true:777
clean false:27
clean_rate:0.9664179104477612
noisy true:392
noisy false:420
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 812
epoch [91/200] batch [5/25] time 0.190 (0.186) data 0.113 (0.109) loss_x loss_x 0.4851 (0.7002) acc_x 81.2500 (81.8750) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/25] time 0.173 (0.185) data 0.095 (0.107) loss_x loss_x 0.6714 (0.6402) acc_x 78.1250 (83.1250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/25] time 0.174 (0.181) data 0.097 (0.103) loss_x loss_x 0.5532 (0.6815) acc_x 84.3750 (81.6667) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/25] time 0.174 (0.179) data 0.096 (0.102) loss_x loss_x 0.5278 (0.6617) acc_x 81.2500 (82.0312) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [25/25] time 0.166 (0.177) data 0.088 (0.099) loss_x loss_x 0.6616 (0.6572) acc_x 81.2500 (82.5000) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/25] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.8687 (0.8585) acc_u 12.5000 (15.6250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/25] time 0.199 (0.175) data 0.121 (0.097) loss_u loss_u 0.8306 (0.8448) acc_u 18.7500 (17.5000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/25] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.7583 (0.8390) acc_u 25.0000 (17.9167) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/25] time 0.187 (0.179) data 0.109 (0.101) loss_u loss_u 0.8364 (0.8438) acc_u 21.8750 (17.9688) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [25/25] time 0.191 (0.180) data 0.111 (0.102) loss_u loss_u 0.8882 (0.8507) acc_u 15.6250 (17.3750) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 463
confident_label rate tensor(0.4882, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 789
clean true:758
clean false:31
clean_rate:0.9607097591888466
noisy true:395
noisy false:432
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 827
epoch [92/200] batch [5/24] time 0.164 (0.178) data 0.085 (0.101) loss_x loss_x 0.7222 (0.5780) acc_x 81.2500 (85.6250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/24] time 0.175 (0.176) data 0.097 (0.098) loss_x loss_x 0.3376 (0.6233) acc_x 90.6250 (85.3125) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/24] time 0.168 (0.177) data 0.091 (0.099) loss_x loss_x 0.5991 (0.6000) acc_x 75.0000 (85.4167) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/24] time 0.166 (0.174) data 0.088 (0.097) loss_x loss_x 0.5625 (0.6185) acc_x 81.2500 (84.0625) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/25] time 0.172 (0.174) data 0.092 (0.096) loss_u loss_u 0.8154 (0.8047) acc_u 21.8750 (21.8750) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/25] time 0.170 (0.174) data 0.092 (0.096) loss_u loss_u 0.9111 (0.8368) acc_u 9.3750 (18.4375) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/25] time 0.159 (0.173) data 0.081 (0.095) loss_u loss_u 0.8867 (0.8328) acc_u 12.5000 (18.9583) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/25] time 0.172 (0.173) data 0.095 (0.095) loss_u loss_u 0.7881 (0.8320) acc_u 21.8750 (18.9062) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [25/25] time 0.199 (0.174) data 0.122 (0.096) loss_u loss_u 0.8672 (0.8361) acc_u 15.6250 (18.1250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 461
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:780
clean false:28
clean_rate:0.9653465346534653
noisy true:375
noisy false:433
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [93/200] batch [5/25] time 0.177 (0.172) data 0.099 (0.094) loss_x loss_x 0.7881 (0.5709) acc_x 71.8750 (85.0000) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/25] time 0.175 (0.176) data 0.097 (0.099) loss_x loss_x 1.0684 (0.6798) acc_x 75.0000 (83.1250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/25] time 0.184 (0.178) data 0.106 (0.101) loss_x loss_x 0.3677 (0.6355) acc_x 93.7500 (83.3333) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/25] time 0.184 (0.179) data 0.106 (0.101) loss_x loss_x 0.6982 (0.6297) acc_x 81.2500 (82.8125) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [25/25] time 0.184 (0.180) data 0.106 (0.102) loss_x loss_x 0.5459 (0.6304) acc_x 87.5000 (82.6250) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/25] time 0.186 (0.181) data 0.107 (0.103) loss_u loss_u 0.6465 (0.8021) acc_u 40.6250 (23.1250) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/25] time 0.168 (0.180) data 0.089 (0.102) loss_u loss_u 0.8354 (0.8499) acc_u 15.6250 (16.5625) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/25] time 0.189 (0.179) data 0.111 (0.101) loss_u loss_u 0.8423 (0.8383) acc_u 12.5000 (18.1250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/25] time 0.175 (0.179) data 0.098 (0.101) loss_u loss_u 0.8726 (0.8469) acc_u 15.6250 (17.0312) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [25/25] time 0.176 (0.179) data 0.098 (0.100) loss_u loss_u 0.7920 (0.8426) acc_u 25.0000 (17.7500) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:778
clean false:30
clean_rate:0.9628712871287128
noisy true:385
noisy false:423
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [94/200] batch [5/25] time 0.177 (0.179) data 0.100 (0.101) loss_x loss_x 0.3762 (0.5076) acc_x 90.6250 (86.8750) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/25] time 0.182 (0.180) data 0.104 (0.103) loss_x loss_x 0.6899 (0.6530) acc_x 84.3750 (84.0625) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/25] time 0.176 (0.180) data 0.098 (0.103) loss_x loss_x 1.0430 (0.6386) acc_x 78.1250 (84.5833) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/25] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.3660 (0.6269) acc_x 90.6250 (83.7500) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [25/25] time 0.179 (0.178) data 0.102 (0.100) loss_x loss_x 1.1064 (0.6449) acc_x 78.1250 (83.3750) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/25] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.9097 (0.8874) acc_u 12.5000 (12.5000) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/25] time 0.181 (0.179) data 0.104 (0.101) loss_u loss_u 0.8872 (0.8638) acc_u 12.5000 (16.2500) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/25] time 0.178 (0.179) data 0.099 (0.102) loss_u loss_u 0.8643 (0.8677) acc_u 15.6250 (16.0417) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/25] time 0.182 (0.180) data 0.103 (0.102) loss_u loss_u 0.8564 (0.8598) acc_u 15.6250 (17.0312) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [25/25] time 0.178 (0.179) data 0.100 (0.101) loss_u loss_u 0.8076 (0.8522) acc_u 18.7500 (17.7500) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 440
confident_label rate tensor(0.5043, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 815
clean true:787
clean false:28
clean_rate:0.9656441717791411
noisy true:389
noisy false:412
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 801
epoch [95/200] batch [5/25] time 0.174 (0.169) data 0.096 (0.091) loss_x loss_x 0.6201 (0.7232) acc_x 87.5000 (82.5000) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/25] time 0.182 (0.175) data 0.105 (0.097) loss_x loss_x 0.5796 (0.6265) acc_x 84.3750 (84.0625) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/25] time 0.188 (0.179) data 0.111 (0.101) loss_x loss_x 0.3779 (0.6211) acc_x 87.5000 (83.7500) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/25] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.6553 (0.6376) acc_x 81.2500 (83.1250) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [25/25] time 0.183 (0.181) data 0.105 (0.103) loss_x loss_x 0.6792 (0.6661) acc_x 84.3750 (82.7500) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/25] time 0.186 (0.181) data 0.107 (0.104) loss_u loss_u 0.9199 (0.8568) acc_u 9.3750 (16.2500) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/25] time 0.184 (0.182) data 0.105 (0.104) loss_u loss_u 0.8921 (0.8389) acc_u 18.7500 (19.6875) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/25] time 0.187 (0.182) data 0.108 (0.104) loss_u loss_u 0.9121 (0.8541) acc_u 12.5000 (17.5000) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/25] time 0.184 (0.181) data 0.106 (0.103) loss_u loss_u 0.8667 (0.8452) acc_u 15.6250 (18.4375) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [25/25] time 0.178 (0.181) data 0.101 (0.103) loss_u loss_u 0.9092 (0.8518) acc_u 9.3750 (17.5000) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 452
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 816
clean true:784
clean false:32
clean_rate:0.9607843137254902
noisy true:380
noisy false:420
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 800
epoch [96/200] batch [5/25] time 0.167 (0.181) data 0.090 (0.104) loss_x loss_x 1.1660 (0.7685) acc_x 68.7500 (80.0000) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/25] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 1.1074 (0.7347) acc_x 78.1250 (80.6250) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/25] time 0.184 (0.182) data 0.106 (0.104) loss_x loss_x 0.8281 (0.7113) acc_x 84.3750 (81.6667) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/25] time 0.178 (0.182) data 0.101 (0.105) loss_x loss_x 0.7080 (0.6959) acc_x 81.2500 (81.5625) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [25/25] time 0.178 (0.185) data 0.100 (0.107) loss_x loss_x 0.6680 (0.6713) acc_x 81.2500 (82.1250) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/25] time 0.167 (0.182) data 0.088 (0.105) loss_u loss_u 0.8730 (0.8377) acc_u 12.5000 (19.3750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/25] time 0.165 (0.180) data 0.087 (0.102) loss_u loss_u 0.8540 (0.8386) acc_u 18.7500 (19.6875) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/25] time 0.166 (0.178) data 0.087 (0.100) loss_u loss_u 0.8110 (0.8468) acc_u 21.8750 (18.3333) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/25] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.8374 (0.8499) acc_u 21.8750 (17.9688) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [25/25] time 0.178 (0.179) data 0.100 (0.101) loss_u loss_u 0.8491 (0.8510) acc_u 18.7500 (18.0000) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.5111, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 826
clean true:795
clean false:31
clean_rate:0.9624697336561744
noisy true:396
noisy false:394
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 790
epoch [97/200] batch [5/25] time 0.177 (0.171) data 0.100 (0.093) loss_x loss_x 0.5244 (0.5843) acc_x 87.5000 (85.0000) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/25] time 0.184 (0.176) data 0.106 (0.099) loss_x loss_x 1.2500 (0.7070) acc_x 62.5000 (80.6250) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/25] time 0.178 (0.174) data 0.099 (0.096) loss_x loss_x 0.2443 (0.6310) acc_x 93.7500 (81.4583) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/25] time 0.169 (0.175) data 0.092 (0.098) loss_x loss_x 0.7017 (0.6316) acc_x 78.1250 (82.1875) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [25/25] time 0.175 (0.174) data 0.097 (0.096) loss_x loss_x 0.6753 (0.6324) acc_x 81.2500 (82.3750) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/24] time 0.166 (0.174) data 0.087 (0.096) loss_u loss_u 0.9087 (0.8927) acc_u 9.3750 (13.7500) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/24] time 0.178 (0.174) data 0.100 (0.096) loss_u loss_u 0.8872 (0.8880) acc_u 12.5000 (14.0625) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/24] time 0.177 (0.175) data 0.098 (0.097) loss_u loss_u 0.8994 (0.8808) acc_u 12.5000 (14.7917) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/24] time 0.173 (0.174) data 0.095 (0.096) loss_u loss_u 0.8652 (0.8656) acc_u 18.7500 (16.2500) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 407
confident_label rate tensor(0.5093, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 823
clean true:800
clean false:23
clean_rate:0.9720534629404617
noisy true:409
noisy false:384
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 793
epoch [98/200] batch [5/25] time 0.184 (0.188) data 0.107 (0.110) loss_x loss_x 0.5229 (0.4796) acc_x 84.3750 (87.5000) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/25] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.6392 (0.5038) acc_x 75.0000 (85.9375) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/25] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.8169 (0.5515) acc_x 78.1250 (84.3750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/25] time 0.183 (0.185) data 0.106 (0.107) loss_x loss_x 0.4475 (0.5857) acc_x 93.7500 (84.3750) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [25/25] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.3621 (0.6462) acc_x 87.5000 (82.6250) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/24] time 0.185 (0.184) data 0.106 (0.107) loss_u loss_u 0.8315 (0.8230) acc_u 15.6250 (18.7500) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/24] time 0.181 (0.184) data 0.103 (0.106) loss_u loss_u 0.8750 (0.8586) acc_u 18.7500 (15.3125) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/24] time 0.182 (0.184) data 0.103 (0.106) loss_u loss_u 0.7734 (0.8583) acc_u 25.0000 (15.4167) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/24] time 0.173 (0.183) data 0.095 (0.105) loss_u loss_u 0.8345 (0.8620) acc_u 15.6250 (14.5312) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.4913, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 794
clean true:772
clean false:22
clean_rate:0.9722921914357683
noisy true:385
noisy false:437
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 822
epoch [99/200] batch [5/24] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.4255 (0.4606) acc_x 87.5000 (86.2500) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/24] time 0.187 (0.179) data 0.109 (0.101) loss_x loss_x 0.6680 (0.5267) acc_x 90.6250 (85.9375) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/24] time 0.167 (0.175) data 0.088 (0.098) loss_x loss_x 0.6289 (0.5462) acc_x 78.1250 (84.7917) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/24] time 0.172 (0.173) data 0.095 (0.095) loss_x loss_x 0.4934 (0.5423) acc_x 90.6250 (85.3125) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/25] time 0.169 (0.172) data 0.092 (0.094) loss_u loss_u 0.8057 (0.7837) acc_u 21.8750 (26.8750) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/25] time 0.169 (0.172) data 0.091 (0.094) loss_u loss_u 0.9141 (0.8166) acc_u 9.3750 (22.1875) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/25] time 0.161 (0.171) data 0.082 (0.094) loss_u loss_u 0.8506 (0.8294) acc_u 18.7500 (21.0417) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/25] time 0.187 (0.172) data 0.108 (0.094) loss_u loss_u 0.9092 (0.8447) acc_u 9.3750 (19.0625) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [25/25] time 0.184 (0.173) data 0.107 (0.096) loss_u loss_u 0.9097 (0.8421) acc_u 12.5000 (19.0000) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 807
clean true:779
clean false:28
clean_rate:0.9653035935563816
noisy true:378
noisy false:431
all clean rate:  [0.9513677811550152, 0.9656019656019657, 0.9845261121856866, 0.9793233082706767, 0.9713774597495528, 0.9803921568627451, 0.9827882960413081, 0.9750415973377704, 0.9746621621621622, 0.9739837398373984, 0.9838187702265372, 0.9724473257698542, 0.9765625, 0.9760383386581469, 0.978328173374613, 0.975, 0.9788199697428139, 0.9756838905775076, 0.9792592592592593, 0.9733542319749217, 0.9787234042553191, 0.9754977029096478, 0.9781659388646288, 0.9805097451274363, 0.976878612716763, 0.9794721407624634, 0.9737991266375546, 0.9769938650306749, 0.974512743628186, 0.9717114568599717, 0.9615384615384616, 0.9775280898876404, 0.9702970297029703, 0.9679218967921897, 0.9722222222222222, 0.9709141274238227, 0.9739010989010989, 0.9714673913043478, 0.975609756097561, 0.970873786407767, 0.98, 0.9603698811096433, 0.970108695652174, 0.9722222222222222, 0.966931216931217, 0.9741847826086957, 0.9732977303070761, 0.9702300405953992, 0.968421052631579, 0.974496644295302, 0.9703903095558546, 0.9738562091503268, 0.9754204398447607, 0.9705882352941176, 0.9780645161290322, 0.9703504043126685, 0.9695767195767195, 0.9664082687338501, 0.9735099337748344, 0.9722222222222222, 0.9711664482306684, 0.9638242894056848, 0.9704749679075738, 0.9727979274611399, 0.9659090909090909, 0.9685863874345549, 0.9748010610079576, 0.9628681177976952, 0.9638242894056848, 0.9643765903307888, 0.9576923076923077, 0.9673776662484316, 0.9612903225806452, 0.9597402597402598, 0.9797979797979798, 0.9664596273291925, 0.9680851063829787, 0.9695431472081218, 0.9734513274336283, 0.9683944374209861, 0.9686323713927227, 0.9640644361833953, 0.9662337662337662, 0.9711055276381909, 0.975, 0.9721518987341772, 0.9660377358490566, 0.9666254635352287, 0.9721871049304678, 0.9638403990024937, 0.9664179104477612, 0.9607097591888466, 0.9653465346534653, 0.9628712871287128, 0.9656441717791411, 0.9607843137254902, 0.9624697336561744, 0.9720534629404617, 0.9722921914357683, 0.9653035935563816]
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 809
epoch [100/200] batch [5/25] time 0.168 (0.174) data 0.091 (0.096) loss_x loss_x 0.6519 (0.5653) acc_x 84.3750 (86.2500) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/25] time 0.185 (0.176) data 0.107 (0.098) loss_x loss_x 0.5293 (0.6705) acc_x 87.5000 (85.3125) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/25] time 0.177 (0.178) data 0.100 (0.100) loss_x loss_x 1.0498 (0.6607) acc_x 71.8750 (83.9583) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/25] time 0.187 (0.180) data 0.110 (0.102) loss_x loss_x 0.5991 (0.6658) acc_x 75.0000 (82.1875) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [25/25] time 0.189 (0.181) data 0.111 (0.103) loss_x loss_x 0.6514 (0.6776) acc_x 81.2500 (82.0000) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/25] time 0.192 (0.182) data 0.114 (0.105) loss_u loss_u 0.8696 (0.8841) acc_u 18.7500 (15.6250) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/25] time 0.184 (0.183) data 0.107 (0.105) loss_u loss_u 0.8789 (0.8666) acc_u 15.6250 (17.1875) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/25] time 0.189 (0.183) data 0.112 (0.105) loss_u loss_u 0.8994 (0.8571) acc_u 9.3750 (17.5000) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/25] time 0.170 (0.183) data 0.092 (0.105) loss_u loss_u 0.8301 (0.8591) acc_u 18.7500 (16.5625) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [25/25] time 0.173 (0.182) data 0.095 (0.104) loss_u loss_u 0.8784 (0.8581) acc_u 15.6250 (16.8750) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 440
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 811
clean true:780
clean false:31
clean_rate:0.9617755856966708
noisy true:396
noisy false:409
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 805
epoch [101/200] batch [5/25] time 0.182 (0.180) data 0.104 (0.102) loss_x loss_x 0.5947 (0.4933) acc_x 84.3750 (87.5000) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/25] time 0.174 (0.178) data 0.096 (0.100) loss_x loss_x 0.4412 (0.5493) acc_x 90.6250 (87.1875) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/25] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.3665 (0.5594) acc_x 90.6250 (85.4167) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/25] time 0.165 (0.175) data 0.089 (0.097) loss_x loss_x 0.3083 (0.5348) acc_x 93.7500 (86.4062) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [25/25] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.7349 (0.5605) acc_x 75.0000 (85.8750) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/25] time 0.193 (0.174) data 0.116 (0.097) loss_u loss_u 0.9595 (0.8674) acc_u 3.1250 (14.3750) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/25] time 0.186 (0.176) data 0.108 (0.099) loss_u loss_u 0.8862 (0.8494) acc_u 12.5000 (17.1875) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/25] time 0.188 (0.177) data 0.111 (0.100) loss_u loss_u 0.8589 (0.8430) acc_u 15.6250 (18.3333) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/25] time 0.200 (0.179) data 0.121 (0.101) loss_u loss_u 0.8784 (0.8507) acc_u 12.5000 (17.6562) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [25/25] time 0.213 (0.180) data 0.136 (0.103) loss_u loss_u 0.8560 (0.8560) acc_u 18.7500 (17.2500) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 443
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 810
clean true:782
clean false:28
clean_rate:0.9654320987654321
noisy true:391
noisy false:415
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 806
epoch [102/200] batch [5/25] time 0.177 (0.183) data 0.099 (0.105) loss_x loss_x 0.5371 (0.5112) acc_x 78.1250 (85.0000) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/25] time 0.168 (0.177) data 0.091 (0.099) loss_x loss_x 0.4983 (0.6194) acc_x 87.5000 (83.4375) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/25] time 0.175 (0.174) data 0.097 (0.096) loss_x loss_x 0.7891 (0.5903) acc_x 84.3750 (84.1667) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/25] time 0.182 (0.176) data 0.104 (0.098) loss_x loss_x 0.3325 (0.5895) acc_x 90.6250 (84.2188) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [25/25] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 1.0801 (0.6000) acc_x 65.6250 (84.5000) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/25] time 0.184 (0.179) data 0.107 (0.101) loss_u loss_u 0.8228 (0.8435) acc_u 25.0000 (18.1250) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/25] time 0.159 (0.177) data 0.081 (0.100) loss_u loss_u 0.8921 (0.8532) acc_u 12.5000 (16.2500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/25] time 0.161 (0.176) data 0.083 (0.099) loss_u loss_u 0.8276 (0.8384) acc_u 21.8750 (17.9167) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/25] time 0.181 (0.176) data 0.103 (0.098) loss_u loss_u 0.8892 (0.8499) acc_u 15.6250 (16.8750) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [25/25] time 0.183 (0.176) data 0.104 (0.098) loss_u loss_u 0.8013 (0.8542) acc_u 28.1250 (16.6250) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 444
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 813
clean true:787
clean false:26
clean_rate:0.968019680196802
noisy true:385
noisy false:418
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 803
epoch [103/200] batch [5/25] time 0.164 (0.186) data 0.086 (0.108) loss_x loss_x 0.3982 (0.5608) acc_x 90.6250 (86.8750) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/25] time 0.159 (0.174) data 0.082 (0.097) loss_x loss_x 0.7197 (0.5876) acc_x 87.5000 (86.2500) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/25] time 0.165 (0.171) data 0.088 (0.094) loss_x loss_x 0.4917 (0.6412) acc_x 87.5000 (83.9583) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/25] time 0.166 (0.170) data 0.089 (0.092) loss_x loss_x 0.5327 (0.6505) acc_x 84.3750 (83.7500) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [25/25] time 0.166 (0.169) data 0.089 (0.092) loss_x loss_x 0.4868 (0.6428) acc_x 90.6250 (83.8750) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/25] time 0.174 (0.170) data 0.096 (0.093) loss_u loss_u 0.8853 (0.8646) acc_u 12.5000 (15.0000) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/25] time 0.163 (0.170) data 0.084 (0.093) loss_u loss_u 0.7817 (0.8518) acc_u 25.0000 (17.1875) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/25] time 0.188 (0.171) data 0.111 (0.094) loss_u loss_u 0.9038 (0.8630) acc_u 9.3750 (15.4167) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/25] time 0.179 (0.173) data 0.101 (0.095) loss_u loss_u 0.8203 (0.8581) acc_u 21.8750 (16.5625) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [25/25] time 0.178 (0.173) data 0.100 (0.095) loss_u loss_u 0.7632 (0.8528) acc_u 28.1250 (17.2500) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 454
confident_label rate tensor(0.5037, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 814
clean true:782
clean false:32
clean_rate:0.9606879606879607
noisy true:380
noisy false:422
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 802
epoch [104/200] batch [5/25] time 0.179 (0.183) data 0.102 (0.105) loss_x loss_x 0.5679 (0.6469) acc_x 81.2500 (83.1250) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/25] time 0.171 (0.182) data 0.093 (0.104) loss_x loss_x 0.4773 (0.5976) acc_x 84.3750 (84.3750) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/25] time 0.184 (0.180) data 0.106 (0.103) loss_x loss_x 0.7104 (0.6117) acc_x 75.0000 (82.9167) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/25] time 0.187 (0.183) data 0.109 (0.105) loss_x loss_x 0.8608 (0.6307) acc_x 75.0000 (82.5000) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [25/25] time 0.187 (0.184) data 0.109 (0.106) loss_x loss_x 0.4963 (0.6404) acc_x 90.6250 (82.8750) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/25] time 0.187 (0.184) data 0.109 (0.106) loss_u loss_u 0.9087 (0.8346) acc_u 9.3750 (18.7500) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/25] time 0.167 (0.184) data 0.090 (0.106) loss_u loss_u 0.9263 (0.8702) acc_u 6.2500 (14.0625) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/25] time 0.183 (0.183) data 0.106 (0.105) loss_u loss_u 0.8013 (0.8715) acc_u 25.0000 (14.1667) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/25] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.7241 (0.8660) acc_u 28.1250 (15.0000) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [25/25] time 0.189 (0.184) data 0.111 (0.106) loss_u loss_u 0.8721 (0.8549) acc_u 12.5000 (16.3750) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 433
confident_label rate tensor(0.5068, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 819
clean true:788
clean false:31
clean_rate:0.9621489621489622
noisy true:395
noisy false:402
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 797
epoch [105/200] batch [5/25] time 0.178 (0.173) data 0.098 (0.095) loss_x loss_x 0.5874 (0.6042) acc_x 87.5000 (84.3750) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/25] time 0.189 (0.179) data 0.111 (0.101) loss_x loss_x 0.8271 (0.6218) acc_x 78.1250 (84.0625) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/25] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.5845 (0.6102) acc_x 81.2500 (84.1667) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/25] time 0.185 (0.182) data 0.107 (0.104) loss_x loss_x 0.6660 (0.6375) acc_x 78.1250 (83.2812) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [25/25] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.6689 (0.6424) acc_x 81.2500 (83.2500) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/24] time 0.176 (0.182) data 0.098 (0.105) loss_u loss_u 0.8071 (0.8869) acc_u 18.7500 (11.8750) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/24] time 0.183 (0.181) data 0.105 (0.103) loss_u loss_u 0.7871 (0.8625) acc_u 21.8750 (14.6875) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/24] time 0.171 (0.180) data 0.093 (0.102) loss_u loss_u 0.8418 (0.8502) acc_u 21.8750 (16.6667) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/24] time 0.173 (0.179) data 0.094 (0.101) loss_u loss_u 0.8579 (0.8419) acc_u 18.7500 (17.9688) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 434
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 818
clean true:795
clean false:23
clean_rate:0.9718826405867971
noisy true:387
noisy false:411
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 798
epoch [106/200] batch [5/25] time 0.174 (0.186) data 0.097 (0.109) loss_x loss_x 0.6455 (0.5744) acc_x 81.2500 (86.2500) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/25] time 0.171 (0.183) data 0.094 (0.106) loss_x loss_x 0.4683 (0.6297) acc_x 90.6250 (84.0625) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/25] time 0.173 (0.179) data 0.096 (0.102) loss_x loss_x 0.6733 (0.6196) acc_x 78.1250 (83.7500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/25] time 0.175 (0.179) data 0.097 (0.102) loss_x loss_x 0.4265 (0.5687) acc_x 87.5000 (85.0000) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [25/25] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 1.0107 (0.6201) acc_x 65.6250 (83.5000) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/24] time 0.192 (0.177) data 0.113 (0.099) loss_u loss_u 0.8608 (0.8927) acc_u 12.5000 (10.6250) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/24] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.8174 (0.8660) acc_u 21.8750 (14.0625) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/24] time 0.188 (0.178) data 0.109 (0.100) loss_u loss_u 0.7993 (0.8584) acc_u 31.2500 (16.2500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/24] time 0.174 (0.178) data 0.096 (0.100) loss_u loss_u 0.8447 (0.8503) acc_u 15.6250 (17.1875) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 818
clean true:792
clean false:26
clean_rate:0.9682151589242054
noisy true:392
noisy false:406
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 798
epoch [107/200] batch [5/25] time 0.184 (0.189) data 0.107 (0.112) loss_x loss_x 0.9048 (0.5946) acc_x 71.8750 (84.3750) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/25] time 0.176 (0.185) data 0.098 (0.107) loss_x loss_x 0.7119 (0.6632) acc_x 81.2500 (82.8125) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/25] time 0.167 (0.178) data 0.090 (0.101) loss_x loss_x 0.4617 (0.6787) acc_x 84.3750 (82.2917) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/25] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.9185 (0.6613) acc_x 81.2500 (82.6562) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [25/25] time 0.168 (0.173) data 0.088 (0.095) loss_x loss_x 0.4434 (0.6688) acc_x 87.5000 (82.7500) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/24] time 0.165 (0.171) data 0.087 (0.094) loss_u loss_u 0.8281 (0.8263) acc_u 18.7500 (19.3750) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/24] time 0.167 (0.171) data 0.089 (0.093) loss_u loss_u 0.7827 (0.8173) acc_u 25.0000 (21.2500) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/24] time 0.172 (0.171) data 0.094 (0.093) loss_u loss_u 0.9106 (0.8465) acc_u 6.2500 (18.1250) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/24] time 0.170 (0.172) data 0.090 (0.094) loss_u loss_u 0.8135 (0.8423) acc_u 18.7500 (18.5938) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 421
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 809
clean true:785
clean false:24
clean_rate:0.9703337453646477
noisy true:410
noisy false:397
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 807
epoch [108/200] batch [5/25] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.2634 (0.4384) acc_x 93.7500 (87.5000) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/25] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.2024 (0.4630) acc_x 96.8750 (87.5000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/25] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.5103 (0.4992) acc_x 87.5000 (87.0833) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/25] time 0.176 (0.176) data 0.099 (0.099) loss_x loss_x 0.8027 (0.5432) acc_x 78.1250 (86.0938) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [25/25] time 0.166 (0.174) data 0.087 (0.097) loss_x loss_x 0.5796 (0.5481) acc_x 84.3750 (86.0000) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/25] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.8213 (0.8701) acc_u 25.0000 (16.2500) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/25] time 0.168 (0.174) data 0.090 (0.096) loss_u loss_u 0.9165 (0.8602) acc_u 6.2500 (16.8750) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/25] time 0.165 (0.174) data 0.086 (0.096) loss_u loss_u 0.7642 (0.8392) acc_u 25.0000 (19.5833) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/25] time 0.171 (0.174) data 0.094 (0.096) loss_u loss_u 0.8892 (0.8525) acc_u 12.5000 (17.8125) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [25/25] time 0.173 (0.174) data 0.095 (0.096) loss_u loss_u 0.8892 (0.8539) acc_u 9.3750 (17.6250) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 396
confident_label rate tensor(0.5192, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 839
clean true:813
clean false:26
clean_rate:0.9690107270560191
noisy true:407
noisy false:370
after delete: len(clean_dataset) 839
after delete: len(noisy_dataset) 777
epoch [109/200] batch [5/26] time 0.165 (0.165) data 0.087 (0.088) loss_x loss_x 0.6079 (0.5658) acc_x 81.2500 (85.6250) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/26] time 0.171 (0.167) data 0.093 (0.089) loss_x loss_x 0.7188 (0.6305) acc_x 81.2500 (84.0625) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/26] time 0.171 (0.168) data 0.093 (0.090) loss_x loss_x 0.5034 (0.6770) acc_x 84.3750 (83.3333) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/26] time 0.186 (0.170) data 0.109 (0.092) loss_x loss_x 0.5825 (0.6341) acc_x 84.3750 (84.3750) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [25/26] time 0.162 (0.171) data 0.084 (0.093) loss_x loss_x 0.5332 (0.6308) acc_x 81.2500 (84.0000) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/24] time 0.183 (0.174) data 0.105 (0.096) loss_u loss_u 0.8271 (0.8800) acc_u 15.6250 (12.5000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/24] time 0.182 (0.175) data 0.104 (0.097) loss_u loss_u 0.8804 (0.8768) acc_u 18.7500 (15.0000) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/24] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.8130 (0.8507) acc_u 18.7500 (17.7083) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/24] time 0.179 (0.175) data 0.100 (0.097) loss_u loss_u 0.9370 (0.8577) acc_u 6.2500 (16.8750) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 418
confident_label rate tensor(0.5093, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 823
clean true:798
clean false:25
clean_rate:0.9696233292831106
noisy true:400
noisy false:393
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 793
epoch [110/200] batch [5/25] time 0.192 (0.187) data 0.115 (0.109) loss_x loss_x 0.8511 (0.7752) acc_x 84.3750 (80.0000) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/25] time 0.162 (0.178) data 0.085 (0.101) loss_x loss_x 0.7070 (0.6782) acc_x 84.3750 (83.4375) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/25] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.4946 (0.6578) acc_x 87.5000 (83.7500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/25] time 0.182 (0.172) data 0.104 (0.095) loss_x loss_x 0.9673 (0.6330) acc_x 71.8750 (83.7500) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [25/25] time 0.183 (0.172) data 0.106 (0.095) loss_x loss_x 0.6016 (0.6500) acc_x 81.2500 (83.5000) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/24] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.8467 (0.8470) acc_u 21.8750 (18.7500) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/24] time 0.166 (0.178) data 0.088 (0.100) loss_u loss_u 0.8604 (0.8598) acc_u 18.7500 (17.1875) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/24] time 0.162 (0.177) data 0.084 (0.100) loss_u loss_u 0.8228 (0.8502) acc_u 25.0000 (18.5417) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/24] time 0.163 (0.177) data 0.085 (0.099) loss_u loss_u 0.8677 (0.8554) acc_u 15.6250 (17.9688) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 807
clean true:780
clean false:27
clean_rate:0.966542750929368
noisy true:395
noisy false:414
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 809
epoch [111/200] batch [5/25] time 0.176 (0.176) data 0.099 (0.098) loss_x loss_x 0.2532 (0.6344) acc_x 93.7500 (82.5000) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/25] time 0.179 (0.177) data 0.102 (0.099) loss_x loss_x 0.3823 (0.5862) acc_x 87.5000 (85.0000) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/25] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 0.9580 (0.5837) acc_x 71.8750 (84.3750) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/25] time 0.183 (0.178) data 0.105 (0.101) loss_x loss_x 0.3164 (0.5542) acc_x 90.6250 (84.8438) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [25/25] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.4319 (0.5429) acc_x 90.6250 (85.0000) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/25] time 0.173 (0.176) data 0.095 (0.099) loss_u loss_u 0.9033 (0.8493) acc_u 12.5000 (18.1250) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/25] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.8286 (0.8502) acc_u 21.8750 (17.8125) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/25] time 0.172 (0.175) data 0.095 (0.097) loss_u loss_u 0.8433 (0.8530) acc_u 15.6250 (17.9167) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/25] time 0.161 (0.175) data 0.083 (0.097) loss_u loss_u 0.7896 (0.8483) acc_u 31.2500 (18.9062) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [25/25] time 0.169 (0.174) data 0.091 (0.096) loss_u loss_u 0.8477 (0.8433) acc_u 15.6250 (18.8750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 460
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 804
clean true:780
clean false:24
clean_rate:0.9701492537313433
noisy true:376
noisy false:436
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 812
epoch [112/200] batch [5/25] time 0.174 (0.173) data 0.096 (0.096) loss_x loss_x 0.7754 (0.7477) acc_x 84.3750 (80.6250) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/25] time 0.183 (0.177) data 0.105 (0.099) loss_x loss_x 0.3467 (0.6928) acc_x 90.6250 (81.5625) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/25] time 0.184 (0.179) data 0.106 (0.101) loss_x loss_x 0.8315 (0.6840) acc_x 78.1250 (82.0833) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/25] time 0.183 (0.180) data 0.106 (0.102) loss_x loss_x 0.6201 (0.6604) acc_x 78.1250 (82.6562) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [25/25] time 0.183 (0.181) data 0.105 (0.104) loss_x loss_x 0.7202 (0.6487) acc_x 87.5000 (83.1250) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/25] time 0.167 (0.182) data 0.087 (0.104) loss_u loss_u 0.8447 (0.8292) acc_u 15.6250 (20.0000) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/25] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.8477 (0.8364) acc_u 18.7500 (18.7500) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/25] time 0.172 (0.181) data 0.094 (0.104) loss_u loss_u 0.8062 (0.8344) acc_u 25.0000 (18.9583) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/25] time 0.173 (0.181) data 0.095 (0.103) loss_u loss_u 0.7744 (0.8320) acc_u 31.2500 (19.6875) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [25/25] time 0.171 (0.181) data 0.093 (0.104) loss_u loss_u 0.8857 (0.8357) acc_u 15.6250 (19.5000) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 412
confident_label rate tensor(0.5142, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 831
clean true:803
clean false:28
clean_rate:0.9663056558363418
noisy true:401
noisy false:384
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 785
epoch [113/200] batch [5/25] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.5430 (0.6318) acc_x 87.5000 (81.2500) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/25] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.4707 (0.6128) acc_x 84.3750 (82.1875) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/25] time 0.191 (0.176) data 0.114 (0.099) loss_x loss_x 0.5068 (0.6200) acc_x 87.5000 (82.9167) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/25] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 0.9707 (0.6701) acc_x 78.1250 (81.0938) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [25/25] time 0.184 (0.179) data 0.106 (0.101) loss_x loss_x 0.6060 (0.6482) acc_x 90.6250 (82.3750) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/24] time 0.177 (0.179) data 0.099 (0.102) loss_u loss_u 0.8579 (0.8460) acc_u 12.5000 (17.5000) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/24] time 0.173 (0.179) data 0.095 (0.101) loss_u loss_u 0.8374 (0.8554) acc_u 18.7500 (16.8750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/24] time 0.171 (0.177) data 0.093 (0.100) loss_u loss_u 0.8008 (0.8564) acc_u 25.0000 (17.7083) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/24] time 0.164 (0.177) data 0.084 (0.099) loss_u loss_u 0.9043 (0.8600) acc_u 9.3750 (16.7188) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 451
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 811
clean true:778
clean false:33
clean_rate:0.9593094944512947
noisy true:387
noisy false:418
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 805
epoch [114/200] batch [5/25] time 0.190 (0.188) data 0.112 (0.110) loss_x loss_x 0.6123 (0.5158) acc_x 84.3750 (87.5000) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/25] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 0.6045 (0.5655) acc_x 84.3750 (84.3750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/25] time 0.165 (0.180) data 0.087 (0.102) loss_x loss_x 0.3555 (0.5602) acc_x 87.5000 (84.5833) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/25] time 0.180 (0.179) data 0.102 (0.101) loss_x loss_x 0.5356 (0.5699) acc_x 84.3750 (84.8438) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [25/25] time 0.183 (0.180) data 0.106 (0.102) loss_x loss_x 0.7148 (0.6099) acc_x 87.5000 (84.1250) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/25] time 0.186 (0.181) data 0.107 (0.103) loss_u loss_u 0.7319 (0.8441) acc_u 31.2500 (18.1250) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/25] time 0.185 (0.182) data 0.107 (0.104) loss_u loss_u 0.8809 (0.8495) acc_u 12.5000 (17.8125) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/25] time 0.186 (0.183) data 0.108 (0.105) loss_u loss_u 0.9326 (0.8477) acc_u 6.2500 (17.5000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/25] time 0.162 (0.183) data 0.084 (0.105) loss_u loss_u 0.8970 (0.8483) acc_u 12.5000 (17.5000) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [25/25] time 0.188 (0.183) data 0.109 (0.105) loss_u loss_u 0.8823 (0.8503) acc_u 15.6250 (17.6250) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 462
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 802
clean true:773
clean false:29
clean_rate:0.9638403990024937
noisy true:381
noisy false:433
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 814
epoch [115/200] batch [5/25] time 0.164 (0.164) data 0.087 (0.087) loss_x loss_x 0.5659 (0.5544) acc_x 81.2500 (83.7500) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/25] time 0.186 (0.167) data 0.109 (0.089) loss_x loss_x 0.7070 (0.6301) acc_x 81.2500 (83.1250) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/25] time 0.168 (0.169) data 0.091 (0.091) loss_x loss_x 0.7720 (0.5813) acc_x 81.2500 (84.3750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/25] time 0.167 (0.168) data 0.090 (0.091) loss_x loss_x 0.7295 (0.5896) acc_x 84.3750 (83.5938) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [25/25] time 0.171 (0.169) data 0.094 (0.091) loss_x loss_x 0.5835 (0.6039) acc_x 84.3750 (83.7500) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/25] time 0.184 (0.170) data 0.106 (0.093) loss_u loss_u 0.9507 (0.8507) acc_u 3.1250 (18.1250) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/25] time 0.164 (0.170) data 0.085 (0.092) loss_u loss_u 0.8501 (0.8525) acc_u 15.6250 (17.1875) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/25] time 0.184 (0.171) data 0.107 (0.093) loss_u loss_u 0.7812 (0.8467) acc_u 25.0000 (17.9167) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/25] time 0.170 (0.171) data 0.092 (0.094) loss_u loss_u 0.8506 (0.8422) acc_u 25.0000 (18.4375) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [25/25] time 0.172 (0.172) data 0.095 (0.094) loss_u loss_u 0.8169 (0.8400) acc_u 18.7500 (18.7500) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.5198, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 840
clean true:808
clean false:32
clean_rate:0.9619047619047619
noisy true:382
noisy false:394
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 776
epoch [116/200] batch [5/26] time 0.159 (0.185) data 0.082 (0.108) loss_x loss_x 0.8794 (0.5274) acc_x 75.0000 (84.3750) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/26] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.4180 (0.6040) acc_x 84.3750 (82.8125) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/26] time 0.186 (0.183) data 0.108 (0.106) loss_x loss_x 0.4395 (0.6180) acc_x 87.5000 (82.0833) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [20/26] time 0.185 (0.184) data 0.107 (0.106) loss_x loss_x 0.4058 (0.6215) acc_x 90.6250 (82.3438) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [25/26] time 0.169 (0.183) data 0.091 (0.106) loss_x loss_x 0.6597 (0.6268) acc_x 84.3750 (82.6250) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/24] time 0.171 (0.181) data 0.093 (0.103) loss_u loss_u 0.9370 (0.8995) acc_u 6.2500 (11.8750) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/24] time 0.176 (0.180) data 0.099 (0.102) loss_u loss_u 0.7441 (0.8755) acc_u 31.2500 (14.0625) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/24] time 0.178 (0.180) data 0.098 (0.103) loss_u loss_u 0.9023 (0.8631) acc_u 15.6250 (15.8333) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/24] time 0.171 (0.179) data 0.092 (0.101) loss_u loss_u 0.8003 (0.8615) acc_u 21.8750 (15.6250) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 440
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 803
clean true:779
clean false:24
clean_rate:0.9701120797011208
noisy true:397
noisy false:416
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 813
epoch [117/200] batch [5/25] time 0.175 (0.175) data 0.098 (0.097) loss_x loss_x 0.3774 (0.6554) acc_x 90.6250 (81.8750) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/25] time 0.165 (0.173) data 0.087 (0.095) loss_x loss_x 1.0039 (0.6299) acc_x 81.2500 (84.3750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/25] time 0.180 (0.173) data 0.103 (0.096) loss_x loss_x 0.2361 (0.5702) acc_x 96.8750 (85.4167) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/25] time 0.182 (0.175) data 0.104 (0.098) loss_x loss_x 0.6235 (0.6117) acc_x 87.5000 (84.5312) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [25/25] time 0.182 (0.177) data 0.105 (0.099) loss_x loss_x 0.5649 (0.6095) acc_x 81.2500 (84.1250) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/25] time 0.187 (0.179) data 0.108 (0.101) loss_u loss_u 0.7705 (0.8332) acc_u 31.2500 (21.2500) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/25] time 0.173 (0.178) data 0.095 (0.101) loss_u loss_u 0.8965 (0.8327) acc_u 12.5000 (20.6250) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/25] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.7822 (0.8317) acc_u 21.8750 (20.0000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/25] time 0.181 (0.176) data 0.103 (0.099) loss_u loss_u 0.8486 (0.8340) acc_u 18.7500 (19.6875) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [25/25] time 0.187 (0.177) data 0.107 (0.099) loss_u loss_u 0.7842 (0.8387) acc_u 25.0000 (18.6250) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 813
clean true:779
clean false:34
clean_rate:0.958179581795818
noisy true:396
noisy false:407
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 803
epoch [118/200] batch [5/25] time 0.180 (0.182) data 0.102 (0.104) loss_x loss_x 0.5483 (0.5171) acc_x 81.2500 (88.7500) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/25] time 0.192 (0.181) data 0.115 (0.104) loss_x loss_x 0.6929 (0.5321) acc_x 81.2500 (86.2500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/25] time 0.174 (0.183) data 0.096 (0.105) loss_x loss_x 0.7910 (0.5587) acc_x 81.2500 (85.4167) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/25] time 0.170 (0.180) data 0.092 (0.102) loss_x loss_x 0.7246 (0.5694) acc_x 78.1250 (85.4688) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [25/25] time 0.161 (0.177) data 0.083 (0.099) loss_x loss_x 0.7241 (0.5904) acc_x 84.3750 (85.3750) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/25] time 0.160 (0.177) data 0.081 (0.099) loss_u loss_u 0.8096 (0.8631) acc_u 21.8750 (15.6250) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/25] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.8525 (0.8611) acc_u 15.6250 (16.2500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/25] time 0.191 (0.178) data 0.110 (0.100) loss_u loss_u 0.8281 (0.8446) acc_u 18.7500 (17.9167) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/25] time 0.176 (0.177) data 0.098 (0.099) loss_u loss_u 0.8311 (0.8478) acc_u 25.0000 (17.9688) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [25/25] time 0.172 (0.177) data 0.094 (0.099) loss_u loss_u 0.7261 (0.8361) acc_u 31.2500 (19.2500) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 423
confident_label rate tensor(0.5111, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 826
clean true:796
clean false:30
clean_rate:0.9636803874092009
noisy true:397
noisy false:393
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 790
epoch [119/200] batch [5/25] time 0.173 (0.177) data 0.095 (0.099) loss_x loss_x 0.4304 (0.5899) acc_x 90.6250 (85.6250) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/25] time 0.177 (0.177) data 0.098 (0.099) loss_x loss_x 0.4360 (0.6182) acc_x 87.5000 (84.3750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/25] time 0.178 (0.178) data 0.100 (0.099) loss_x loss_x 1.1514 (0.6722) acc_x 78.1250 (83.9583) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/25] time 0.183 (0.179) data 0.104 (0.100) loss_x loss_x 0.8354 (0.6999) acc_x 81.2500 (83.2812) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [25/25] time 0.173 (0.178) data 0.095 (0.099) loss_x loss_x 0.4717 (0.6920) acc_x 90.6250 (83.2500) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/24] time 0.168 (0.177) data 0.090 (0.099) loss_u loss_u 0.9019 (0.8438) acc_u 9.3750 (17.5000) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/24] time 0.175 (0.176) data 0.095 (0.098) loss_u loss_u 0.8623 (0.8602) acc_u 15.6250 (15.9375) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/24] time 0.173 (0.177) data 0.095 (0.098) loss_u loss_u 0.7993 (0.8505) acc_u 25.0000 (16.8750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/24] time 0.177 (0.176) data 0.097 (0.097) loss_u loss_u 0.9517 (0.8504) acc_u 6.2500 (16.4062) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 439
confident_label rate tensor(0.5025, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 812
clean true:784
clean false:28
clean_rate:0.9655172413793104
noisy true:393
noisy false:411
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 804
epoch [120/200] batch [5/25] time 0.166 (0.182) data 0.089 (0.105) loss_x loss_x 0.5337 (0.5718) acc_x 87.5000 (84.3750) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/25] time 0.187 (0.185) data 0.109 (0.107) loss_x loss_x 0.4646 (0.5857) acc_x 87.5000 (85.0000) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/25] time 0.186 (0.185) data 0.109 (0.107) loss_x loss_x 0.5796 (0.6495) acc_x 90.6250 (84.5833) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/25] time 0.160 (0.182) data 0.082 (0.105) loss_x loss_x 0.3765 (0.5816) acc_x 90.6250 (86.0938) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [25/25] time 0.163 (0.180) data 0.085 (0.102) loss_x loss_x 0.2661 (0.5807) acc_x 93.7500 (85.7500) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/25] time 0.172 (0.178) data 0.094 (0.100) loss_u loss_u 0.8418 (0.8397) acc_u 15.6250 (17.5000) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/25] time 0.189 (0.178) data 0.110 (0.100) loss_u loss_u 0.8076 (0.8397) acc_u 21.8750 (17.8125) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/25] time 0.171 (0.177) data 0.093 (0.100) loss_u loss_u 0.7671 (0.8352) acc_u 25.0000 (18.1250) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/25] time 0.170 (0.177) data 0.092 (0.099) loss_u loss_u 0.7422 (0.8340) acc_u 28.1250 (18.5938) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [25/25] time 0.174 (0.176) data 0.095 (0.098) loss_u loss_u 0.9326 (0.8442) acc_u 6.2500 (17.6250) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 420
confident_label rate tensor(0.5210, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 842
clean true:808
clean false:34
clean_rate:0.9596199524940617
noisy true:388
noisy false:386
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 774
epoch [121/200] batch [5/26] time 0.182 (0.182) data 0.104 (0.104) loss_x loss_x 0.7104 (0.7084) acc_x 81.2500 (81.2500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/26] time 0.184 (0.183) data 0.107 (0.105) loss_x loss_x 0.4548 (0.5702) acc_x 87.5000 (84.6875) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/26] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.4092 (0.6060) acc_x 90.6250 (83.9583) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [20/26] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.5781 (0.6078) acc_x 90.6250 (84.3750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [25/26] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.6504 (0.6408) acc_x 81.2500 (83.2500) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/24] time 0.178 (0.184) data 0.099 (0.107) loss_u loss_u 0.7065 (0.8123) acc_u 31.2500 (22.5000) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/24] time 0.177 (0.183) data 0.099 (0.106) loss_u loss_u 0.8818 (0.8560) acc_u 15.6250 (17.1875) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/24] time 0.172 (0.183) data 0.094 (0.105) loss_u loss_u 0.9390 (0.8601) acc_u 9.3750 (16.4583) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/24] time 0.177 (0.182) data 0.097 (0.104) loss_u loss_u 0.8633 (0.8594) acc_u 21.8750 (17.0312) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 434
confident_label rate tensor(0.5198, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 840
clean true:809
clean false:31
clean_rate:0.9630952380952381
noisy true:373
noisy false:403
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 776
epoch [122/200] batch [5/26] time 0.182 (0.176) data 0.104 (0.099) loss_x loss_x 0.4272 (0.6005) acc_x 90.6250 (86.8750) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/26] time 0.161 (0.175) data 0.083 (0.097) loss_x loss_x 0.5796 (0.5900) acc_x 84.3750 (85.9375) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/26] time 0.184 (0.175) data 0.106 (0.098) loss_x loss_x 0.5308 (0.5797) acc_x 87.5000 (86.0417) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/26] time 0.186 (0.176) data 0.108 (0.099) loss_x loss_x 0.9658 (0.6269) acc_x 75.0000 (84.6875) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [25/26] time 0.190 (0.178) data 0.112 (0.101) loss_x loss_x 0.5791 (0.6295) acc_x 93.7500 (84.8750) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/24] time 0.180 (0.179) data 0.102 (0.101) loss_u loss_u 0.8276 (0.8373) acc_u 15.6250 (18.7500) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/24] time 0.168 (0.178) data 0.090 (0.100) loss_u loss_u 0.8818 (0.8286) acc_u 15.6250 (20.0000) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/24] time 0.185 (0.177) data 0.108 (0.099) loss_u loss_u 0.8184 (0.8317) acc_u 18.7500 (19.5833) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/24] time 0.172 (0.177) data 0.093 (0.099) loss_u loss_u 0.7437 (0.8285) acc_u 28.1250 (19.6875) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 446
confident_label rate tensor(0.5167, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 835
clean true:803
clean false:32
clean_rate:0.9616766467065868
noisy true:367
noisy false:414
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 781
epoch [123/200] batch [5/26] time 0.164 (0.169) data 0.086 (0.091) loss_x loss_x 0.8838 (0.6240) acc_x 71.8750 (82.5000) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/26] time 0.174 (0.169) data 0.097 (0.091) loss_x loss_x 0.6826 (0.5743) acc_x 81.2500 (84.6875) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/26] time 0.181 (0.172) data 0.104 (0.094) loss_x loss_x 0.4695 (0.5868) acc_x 87.5000 (84.7917) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/26] time 0.184 (0.175) data 0.106 (0.098) loss_x loss_x 0.7388 (0.5863) acc_x 84.3750 (84.8438) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [25/26] time 0.185 (0.178) data 0.108 (0.100) loss_x loss_x 0.3228 (0.5702) acc_x 93.7500 (85.8750) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/24] time 0.167 (0.177) data 0.088 (0.099) loss_u loss_u 0.9053 (0.8558) acc_u 9.3750 (15.0000) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/24] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.8613 (0.8481) acc_u 12.5000 (15.9375) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/24] time 0.181 (0.175) data 0.102 (0.097) loss_u loss_u 0.8398 (0.8556) acc_u 18.7500 (15.4167) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/24] time 0.172 (0.175) data 0.093 (0.097) loss_u loss_u 0.7686 (0.8500) acc_u 28.1250 (16.2500) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 450
confident_label rate tensor(0.5074, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 820
clean true:793
clean false:27
clean_rate:0.9670731707317073
noisy true:373
noisy false:423
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 796
epoch [124/200] batch [5/25] time 0.176 (0.189) data 0.097 (0.112) loss_x loss_x 0.4878 (0.6339) acc_x 84.3750 (85.0000) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/25] time 0.180 (0.185) data 0.102 (0.108) loss_x loss_x 0.7383 (0.7219) acc_x 78.1250 (81.5625) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/25] time 0.181 (0.185) data 0.104 (0.107) loss_x loss_x 0.8174 (0.6750) acc_x 75.0000 (81.8750) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/25] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.8179 (0.6585) acc_x 75.0000 (82.3438) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [25/25] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.6577 (0.6476) acc_x 84.3750 (82.5000) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/24] time 0.187 (0.185) data 0.108 (0.107) loss_u loss_u 0.9102 (0.8590) acc_u 9.3750 (15.6250) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/24] time 0.191 (0.185) data 0.112 (0.107) loss_u loss_u 0.7896 (0.8476) acc_u 25.0000 (17.8125) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/24] time 0.166 (0.185) data 0.086 (0.107) loss_u loss_u 0.8911 (0.8602) acc_u 12.5000 (16.0417) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/24] time 0.187 (0.185) data 0.109 (0.107) loss_u loss_u 0.8486 (0.8549) acc_u 18.7500 (17.3438) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 403
confident_label rate tensor(0.5278, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 853
clean true:819
clean false:34
clean_rate:0.9601406799531067
noisy true:394
noisy false:369
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 763
epoch [125/200] batch [5/26] time 0.180 (0.179) data 0.102 (0.101) loss_x loss_x 0.7500 (0.4793) acc_x 78.1250 (87.5000) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/26] time 0.182 (0.181) data 0.105 (0.103) loss_x loss_x 0.5581 (0.5411) acc_x 84.3750 (86.8750) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/26] time 0.184 (0.182) data 0.107 (0.104) loss_x loss_x 0.6387 (0.6022) acc_x 81.2500 (84.5833) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/26] time 0.184 (0.183) data 0.107 (0.105) loss_x loss_x 0.4126 (0.5806) acc_x 87.5000 (84.8438) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [25/26] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.5630 (0.5786) acc_x 81.2500 (84.8750) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/23] time 0.187 (0.184) data 0.108 (0.106) loss_u loss_u 0.8721 (0.8781) acc_u 12.5000 (13.1250) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/23] time 0.188 (0.184) data 0.108 (0.106) loss_u loss_u 0.8770 (0.8692) acc_u 12.5000 (14.0625) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/23] time 0.164 (0.184) data 0.085 (0.106) loss_u loss_u 0.8989 (0.8757) acc_u 12.5000 (14.3750) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/23] time 0.169 (0.183) data 0.092 (0.105) loss_u loss_u 0.8657 (0.8726) acc_u 15.6250 (14.5312) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.5124, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 828
clean true:792
clean false:36
clean_rate:0.9565217391304348
noisy true:399
noisy false:389
after delete: len(clean_dataset) 828
after delete: len(noisy_dataset) 788
epoch [126/200] batch [5/25] time 0.182 (0.186) data 0.105 (0.108) loss_x loss_x 0.8169 (0.5042) acc_x 78.1250 (85.6250) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/25] time 0.173 (0.181) data 0.095 (0.103) loss_x loss_x 0.4514 (0.5833) acc_x 90.6250 (84.3750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/25] time 0.159 (0.175) data 0.082 (0.098) loss_x loss_x 0.5132 (0.6047) acc_x 87.5000 (83.9583) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/25] time 0.166 (0.173) data 0.089 (0.095) loss_x loss_x 0.7666 (0.6485) acc_x 78.1250 (82.1875) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [25/25] time 0.169 (0.172) data 0.091 (0.095) loss_x loss_x 0.5854 (0.6408) acc_x 84.3750 (82.5000) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/24] time 0.187 (0.174) data 0.109 (0.096) loss_u loss_u 0.7373 (0.8464) acc_u 31.2500 (18.7500) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/24] time 0.188 (0.176) data 0.110 (0.098) loss_u loss_u 0.8740 (0.8312) acc_u 15.6250 (20.9375) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/24] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8848 (0.8288) acc_u 12.5000 (20.8333) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/24] time 0.167 (0.177) data 0.089 (0.099) loss_u loss_u 0.8809 (0.8336) acc_u 15.6250 (20.0000) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 414
confident_label rate tensor(0.5186, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 838
clean true:807
clean false:31
clean_rate:0.9630071599045346
noisy true:395
noisy false:383
after delete: len(clean_dataset) 838
after delete: len(noisy_dataset) 778
epoch [127/200] batch [5/26] time 0.172 (0.174) data 0.095 (0.096) loss_x loss_x 0.3853 (0.4844) acc_x 93.7500 (88.1250) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/26] time 0.178 (0.173) data 0.101 (0.095) loss_x loss_x 0.4124 (0.4959) acc_x 90.6250 (87.1875) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/26] time 0.187 (0.175) data 0.109 (0.098) loss_x loss_x 0.6860 (0.5604) acc_x 84.3750 (85.8333) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/26] time 0.181 (0.177) data 0.103 (0.099) loss_x loss_x 0.4800 (0.5640) acc_x 81.2500 (86.0938) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [25/26] time 0.182 (0.178) data 0.104 (0.100) loss_x loss_x 0.4395 (0.5749) acc_x 93.7500 (85.8750) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/24] time 0.182 (0.179) data 0.103 (0.101) loss_u loss_u 0.8159 (0.8483) acc_u 18.7500 (16.8750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/24] time 0.178 (0.179) data 0.098 (0.101) loss_u loss_u 0.9170 (0.8468) acc_u 12.5000 (17.8125) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/24] time 0.170 (0.178) data 0.092 (0.100) loss_u loss_u 0.8281 (0.8595) acc_u 21.8750 (16.6667) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/24] time 0.172 (0.178) data 0.095 (0.100) loss_u loss_u 0.8086 (0.8536) acc_u 21.8750 (17.6562) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.5105, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 825
clean true:798
clean false:27
clean_rate:0.9672727272727273
noisy true:396
noisy false:395
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 791
epoch [128/200] batch [5/25] time 0.185 (0.184) data 0.108 (0.105) loss_x loss_x 0.2134 (0.5033) acc_x 93.7500 (88.7500) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/25] time 0.185 (0.184) data 0.107 (0.106) loss_x loss_x 0.3030 (0.5796) acc_x 96.8750 (87.8125) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/25] time 0.187 (0.184) data 0.109 (0.107) loss_x loss_x 0.4812 (0.6017) acc_x 90.6250 (86.0417) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/25] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.3088 (0.5977) acc_x 93.7500 (85.3125) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [25/25] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.6250 (0.6182) acc_x 87.5000 (85.0000) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/24] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.8491 (0.8557) acc_u 12.5000 (15.6250) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/24] time 0.160 (0.183) data 0.082 (0.106) loss_u loss_u 0.8228 (0.8404) acc_u 18.7500 (17.5000) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/24] time 0.161 (0.182) data 0.082 (0.104) loss_u loss_u 0.8174 (0.8425) acc_u 21.8750 (17.5000) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/24] time 0.179 (0.181) data 0.101 (0.103) loss_u loss_u 0.9038 (0.8417) acc_u 9.3750 (17.6562) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 420
confident_label rate tensor(0.5186, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 838
clean true:810
clean false:28
clean_rate:0.9665871121718377
noisy true:386
noisy false:392
after delete: len(clean_dataset) 838
after delete: len(noisy_dataset) 778
epoch [129/200] batch [5/26] time 0.158 (0.175) data 0.081 (0.098) loss_x loss_x 1.0146 (0.6614) acc_x 71.8750 (83.7500) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/26] time 0.184 (0.180) data 0.106 (0.102) loss_x loss_x 0.6318 (0.6079) acc_x 78.1250 (84.3750) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/26] time 0.172 (0.180) data 0.094 (0.102) loss_x loss_x 0.3174 (0.5395) acc_x 96.8750 (86.6667) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/26] time 0.180 (0.180) data 0.102 (0.103) loss_x loss_x 0.8037 (0.5594) acc_x 75.0000 (85.0000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [25/26] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.3105 (0.5701) acc_x 90.6250 (84.8750) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/24] time 0.190 (0.181) data 0.113 (0.103) loss_u loss_u 0.8882 (0.8697) acc_u 18.7500 (16.8750) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/24] time 0.190 (0.182) data 0.112 (0.104) loss_u loss_u 0.7754 (0.8637) acc_u 25.0000 (16.5625) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/24] time 0.169 (0.182) data 0.091 (0.104) loss_u loss_u 0.8467 (0.8546) acc_u 18.7500 (17.5000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/24] time 0.177 (0.181) data 0.099 (0.103) loss_u loss_u 0.7837 (0.8582) acc_u 21.8750 (16.5625) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 401
confident_label rate tensor(0.5161, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 834
clean true:808
clean false:26
clean_rate:0.9688249400479616
noisy true:407
noisy false:375
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 782
epoch [130/200] batch [5/26] time 0.196 (0.183) data 0.118 (0.105) loss_x loss_x 0.6592 (0.5684) acc_x 84.3750 (85.0000) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/26] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.2786 (0.5844) acc_x 93.7500 (86.2500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/26] time 0.159 (0.178) data 0.081 (0.100) loss_x loss_x 0.5200 (0.6017) acc_x 87.5000 (85.4167) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/26] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 0.7734 (0.5914) acc_x 81.2500 (85.6250) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [25/26] time 0.179 (0.178) data 0.102 (0.100) loss_x loss_x 0.6382 (0.6023) acc_x 81.2500 (84.7500) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/24] time 0.183 (0.179) data 0.104 (0.101) loss_u loss_u 0.8799 (0.8857) acc_u 12.5000 (12.5000) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/24] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.8271 (0.8542) acc_u 18.7500 (15.9375) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/24] time 0.182 (0.180) data 0.103 (0.102) loss_u loss_u 0.8687 (0.8514) acc_u 15.6250 (16.6667) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/24] time 0.226 (0.180) data 0.148 (0.102) loss_u loss_u 0.7275 (0.8385) acc_u 31.2500 (17.9688) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 429
confident_label rate tensor(0.5136, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 830
clean true:794
clean false:36
clean_rate:0.9566265060240964
noisy true:393
noisy false:393
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 786
epoch [131/200] batch [5/25] time 0.165 (0.167) data 0.088 (0.089) loss_x loss_x 0.7529 (0.6675) acc_x 87.5000 (86.8750) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/25] time 0.165 (0.167) data 0.087 (0.090) loss_x loss_x 0.8003 (0.6794) acc_x 78.1250 (84.3750) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/25] time 0.162 (0.167) data 0.085 (0.090) loss_x loss_x 0.7896 (0.6374) acc_x 81.2500 (85.2083) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/25] time 0.169 (0.166) data 0.091 (0.089) loss_x loss_x 0.7935 (0.6163) acc_x 84.3750 (85.7812) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [25/25] time 0.175 (0.168) data 0.097 (0.090) loss_x loss_x 0.4773 (0.6066) acc_x 81.2500 (85.7500) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/24] time 0.176 (0.170) data 0.097 (0.092) loss_u loss_u 0.8755 (0.8502) acc_u 12.5000 (17.5000) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/24] time 0.183 (0.171) data 0.105 (0.094) loss_u loss_u 0.7715 (0.8479) acc_u 28.1250 (17.1875) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/24] time 0.171 (0.172) data 0.092 (0.094) loss_u loss_u 0.7876 (0.8394) acc_u 21.8750 (17.2917) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/24] time 0.185 (0.172) data 0.108 (0.094) loss_u loss_u 0.8765 (0.8467) acc_u 18.7500 (16.8750) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.5217, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 843
clean true:811
clean false:32
clean_rate:0.9620403321470937
noisy true:380
noisy false:393
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 773
epoch [132/200] batch [5/26] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.3547 (0.6025) acc_x 90.6250 (81.8750) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/26] time 0.179 (0.185) data 0.101 (0.107) loss_x loss_x 0.4021 (0.6406) acc_x 93.7500 (83.7500) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/26] time 0.161 (0.180) data 0.084 (0.102) loss_x loss_x 0.7939 (0.6366) acc_x 81.2500 (84.1667) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/26] time 0.170 (0.177) data 0.093 (0.099) loss_x loss_x 0.3018 (0.6211) acc_x 100.0000 (84.2188) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [25/26] time 0.183 (0.177) data 0.106 (0.099) loss_x loss_x 0.4829 (0.6087) acc_x 87.5000 (84.0000) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/24] time 0.180 (0.179) data 0.102 (0.101) loss_u loss_u 0.8037 (0.8771) acc_u 18.7500 (13.7500) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/24] time 0.196 (0.180) data 0.118 (0.102) loss_u loss_u 0.8262 (0.8502) acc_u 18.7500 (16.8750) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/24] time 0.198 (0.181) data 0.120 (0.103) loss_u loss_u 0.8735 (0.8588) acc_u 15.6250 (16.0417) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/24] time 0.178 (0.181) data 0.101 (0.102) loss_u loss_u 0.8535 (0.8568) acc_u 18.7500 (16.4062) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 402
confident_label rate tensor(0.5204, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 841
clean true:814
clean false:27
clean_rate:0.9678953626634959
noisy true:400
noisy false:375
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 775
epoch [133/200] batch [5/26] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.2749 (0.4800) acc_x 90.6250 (88.7500) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/26] time 0.183 (0.175) data 0.106 (0.097) loss_x loss_x 0.3201 (0.5233) acc_x 93.7500 (85.9375) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/26] time 0.186 (0.177) data 0.108 (0.100) loss_x loss_x 0.6904 (0.5110) acc_x 78.1250 (85.8333) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/26] time 0.181 (0.180) data 0.103 (0.102) loss_x loss_x 0.7266 (0.5494) acc_x 84.3750 (85.7812) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [25/26] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.4780 (0.5479) acc_x 81.2500 (85.2500) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/24] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.8247 (0.8224) acc_u 21.8750 (21.2500) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/24] time 0.219 (0.185) data 0.141 (0.107) loss_u loss_u 0.8311 (0.8563) acc_u 18.7500 (16.2500) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/24] time 0.170 (0.183) data 0.092 (0.106) loss_u loss_u 0.9136 (0.8611) acc_u 9.3750 (15.4167) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/24] time 0.178 (0.183) data 0.100 (0.105) loss_u loss_u 0.8696 (0.8621) acc_u 15.6250 (15.7812) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.5186, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 838
clean true:807
clean false:31
clean_rate:0.9630071599045346
noisy true:368
noisy false:410
after delete: len(clean_dataset) 838
after delete: len(noisy_dataset) 778
epoch [134/200] batch [5/26] time 0.185 (0.188) data 0.107 (0.110) loss_x loss_x 0.7793 (0.5744) acc_x 81.2500 (85.6250) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/26] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.4697 (0.6108) acc_x 90.6250 (84.0625) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/26] time 0.187 (0.186) data 0.109 (0.108) loss_x loss_x 0.3374 (0.5896) acc_x 90.6250 (84.5833) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/26] time 0.181 (0.186) data 0.103 (0.108) loss_x loss_x 0.3533 (0.5887) acc_x 93.7500 (84.8438) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [25/26] time 0.174 (0.184) data 0.096 (0.107) loss_x loss_x 0.5488 (0.5998) acc_x 84.3750 (84.7500) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/24] time 0.185 (0.183) data 0.105 (0.105) loss_u loss_u 0.7446 (0.8508) acc_u 28.1250 (16.2500) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/24] time 0.218 (0.185) data 0.139 (0.107) loss_u loss_u 0.8457 (0.8553) acc_u 18.7500 (15.3125) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/24] time 0.166 (0.183) data 0.088 (0.105) loss_u loss_u 0.9155 (0.8536) acc_u 12.5000 (15.8333) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/24] time 0.162 (0.182) data 0.083 (0.103) loss_u loss_u 0.8027 (0.8514) acc_u 21.8750 (16.7188) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 399
confident_label rate tensor(0.5248, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 848
clean true:823
clean false:25
clean_rate:0.9705188679245284
noisy true:394
noisy false:374
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 768
epoch [135/200] batch [5/26] time 0.177 (0.171) data 0.100 (0.093) loss_x loss_x 0.8237 (0.7337) acc_x 81.2500 (82.5000) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/26] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.4985 (0.7435) acc_x 87.5000 (80.3125) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/26] time 0.191 (0.177) data 0.113 (0.099) loss_x loss_x 0.9507 (0.7470) acc_x 75.0000 (80.4167) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/26] time 0.175 (0.176) data 0.097 (0.098) loss_x loss_x 0.2932 (0.6826) acc_x 93.7500 (81.2500) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [25/26] time 0.167 (0.177) data 0.090 (0.100) loss_x loss_x 0.3923 (0.6591) acc_x 84.3750 (82.0000) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/24] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.9136 (0.8759) acc_u 9.3750 (14.3750) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/24] time 0.176 (0.176) data 0.097 (0.098) loss_u loss_u 0.8916 (0.8858) acc_u 12.5000 (13.4375) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/24] time 0.170 (0.176) data 0.091 (0.098) loss_u loss_u 0.8379 (0.8524) acc_u 18.7500 (17.2917) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/24] time 0.167 (0.176) data 0.089 (0.099) loss_u loss_u 0.9526 (0.8627) acc_u 3.1250 (15.6250) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 403
confident_label rate tensor(0.5204, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 841
clean true:815
clean false:26
clean_rate:0.9690844233055886
noisy true:398
noisy false:377
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 775
epoch [136/200] batch [5/26] time 0.167 (0.170) data 0.089 (0.093) loss_x loss_x 0.5986 (0.7454) acc_x 78.1250 (76.8750) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/26] time 0.163 (0.168) data 0.085 (0.090) loss_x loss_x 1.2402 (0.7261) acc_x 68.7500 (79.0625) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/26] time 0.166 (0.167) data 0.089 (0.090) loss_x loss_x 0.6504 (0.7561) acc_x 84.3750 (80.2083) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/26] time 0.169 (0.167) data 0.092 (0.089) loss_x loss_x 0.3625 (0.7294) acc_x 90.6250 (81.5625) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [25/26] time 0.158 (0.167) data 0.081 (0.089) loss_x loss_x 0.6304 (0.7104) acc_x 87.5000 (82.6250) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/24] time 0.175 (0.169) data 0.097 (0.092) loss_u loss_u 0.8901 (0.8548) acc_u 15.6250 (17.5000) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/24] time 0.183 (0.171) data 0.106 (0.093) loss_u loss_u 0.8149 (0.8592) acc_u 21.8750 (16.5625) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/24] time 0.184 (0.173) data 0.106 (0.095) loss_u loss_u 0.8374 (0.8604) acc_u 21.8750 (16.8750) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/24] time 0.181 (0.173) data 0.102 (0.096) loss_u loss_u 0.8208 (0.8637) acc_u 21.8750 (16.4062) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.5124, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 828
clean true:796
clean false:32
clean_rate:0.961352657004831
noisy true:388
noisy false:400
after delete: len(clean_dataset) 828
after delete: len(noisy_dataset) 788
epoch [137/200] batch [5/25] time 0.178 (0.171) data 0.101 (0.094) loss_x loss_x 0.5688 (0.5689) acc_x 81.2500 (86.8750) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/25] time 0.172 (0.172) data 0.094 (0.094) loss_x loss_x 0.9268 (0.6201) acc_x 84.3750 (85.3125) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/25] time 0.178 (0.173) data 0.101 (0.096) loss_x loss_x 0.3276 (0.5781) acc_x 90.6250 (85.8333) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/25] time 0.178 (0.175) data 0.098 (0.097) loss_x loss_x 0.4758 (0.5524) acc_x 93.7500 (87.1875) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [25/25] time 0.184 (0.175) data 0.106 (0.098) loss_x loss_x 0.3091 (0.5500) acc_x 90.6250 (86.5000) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/24] time 0.185 (0.176) data 0.107 (0.098) loss_u loss_u 0.8887 (0.8518) acc_u 12.5000 (17.5000) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/24] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.8765 (0.8490) acc_u 15.6250 (18.1250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/24] time 0.180 (0.175) data 0.102 (0.098) loss_u loss_u 0.8745 (0.8438) acc_u 18.7500 (18.9583) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/24] time 0.179 (0.175) data 0.101 (0.098) loss_u loss_u 0.8472 (0.8393) acc_u 15.6250 (19.8438) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 418
confident_label rate tensor(0.5198, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 840
clean true:808
clean false:32
clean_rate:0.9619047619047619
noisy true:390
noisy false:386
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 776
epoch [138/200] batch [5/26] time 0.184 (0.168) data 0.106 (0.090) loss_x loss_x 0.7764 (0.6554) acc_x 78.1250 (81.8750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/26] time 0.180 (0.175) data 0.102 (0.097) loss_x loss_x 0.5264 (0.6311) acc_x 87.5000 (83.4375) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/26] time 0.172 (0.177) data 0.093 (0.099) loss_x loss_x 0.4976 (0.5786) acc_x 87.5000 (84.7917) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/26] time 0.163 (0.174) data 0.086 (0.097) loss_x loss_x 0.5957 (0.6225) acc_x 84.3750 (83.7500) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [25/26] time 0.168 (0.174) data 0.091 (0.096) loss_x loss_x 0.4216 (0.6274) acc_x 90.6250 (84.2500) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/24] time 0.174 (0.173) data 0.096 (0.095) loss_u loss_u 0.8804 (0.8619) acc_u 12.5000 (16.8750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/24] time 0.173 (0.173) data 0.095 (0.095) loss_u loss_u 0.8691 (0.8736) acc_u 18.7500 (15.9375) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/24] time 0.167 (0.173) data 0.089 (0.095) loss_u loss_u 0.8574 (0.8713) acc_u 18.7500 (16.0417) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/24] time 0.180 (0.173) data 0.101 (0.095) loss_u loss_u 0.8472 (0.8611) acc_u 21.8750 (17.0312) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 414
confident_label rate tensor(0.5179, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 837
clean true:809
clean false:28
clean_rate:0.966547192353644
noisy true:393
noisy false:386
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 779
epoch [139/200] batch [5/26] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 0.5874 (0.4441) acc_x 84.3750 (88.1250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/26] time 0.167 (0.171) data 0.090 (0.093) loss_x loss_x 0.5791 (0.4446) acc_x 93.7500 (90.0000) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/26] time 0.166 (0.169) data 0.088 (0.091) loss_x loss_x 0.6904 (0.5128) acc_x 81.2500 (87.7083) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/26] time 0.167 (0.168) data 0.090 (0.090) loss_x loss_x 0.7144 (0.5363) acc_x 84.3750 (87.1875) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [25/26] time 0.181 (0.168) data 0.103 (0.090) loss_x loss_x 0.4749 (0.5515) acc_x 87.5000 (86.8750) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/24] time 0.165 (0.169) data 0.088 (0.091) loss_u loss_u 0.8472 (0.8395) acc_u 15.6250 (17.5000) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/24] time 0.208 (0.171) data 0.130 (0.093) loss_u loss_u 0.9434 (0.8490) acc_u 6.2500 (16.8750) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/24] time 0.172 (0.171) data 0.094 (0.093) loss_u loss_u 0.8213 (0.8414) acc_u 18.7500 (17.7083) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/24] time 0.162 (0.171) data 0.085 (0.093) loss_u loss_u 0.9302 (0.8539) acc_u 9.3750 (16.4062) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 410
confident_label rate tensor(0.5241, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 847
clean true:820
clean false:27
clean_rate:0.9681227863046045
noisy true:386
noisy false:383
after delete: len(clean_dataset) 847
after delete: len(noisy_dataset) 769
epoch [140/200] batch [5/26] time 0.165 (0.172) data 0.087 (0.094) loss_x loss_x 0.6504 (0.4908) acc_x 81.2500 (85.6250) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/26] time 0.170 (0.170) data 0.093 (0.092) loss_x loss_x 0.3384 (0.5337) acc_x 93.7500 (84.6875) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/26] time 0.181 (0.172) data 0.104 (0.095) loss_x loss_x 0.5366 (0.5377) acc_x 84.3750 (84.1667) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/26] time 0.184 (0.175) data 0.105 (0.098) loss_x loss_x 0.5830 (0.5261) acc_x 87.5000 (85.0000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [25/26] time 0.186 (0.177) data 0.108 (0.100) loss_x loss_x 0.8569 (0.5497) acc_x 81.2500 (85.0000) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/24] time 0.188 (0.179) data 0.109 (0.101) loss_u loss_u 0.8618 (0.8720) acc_u 15.6250 (15.0000) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/24] time 0.184 (0.180) data 0.106 (0.102) loss_u loss_u 0.7871 (0.8649) acc_u 21.8750 (15.6250) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/24] time 0.194 (0.181) data 0.117 (0.103) loss_u loss_u 0.8618 (0.8649) acc_u 21.8750 (16.4583) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/24] time 0.180 (0.180) data 0.102 (0.102) loss_u loss_u 0.8193 (0.8644) acc_u 25.0000 (17.0312) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.5179, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 837
clean true:808
clean false:29
clean_rate:0.965352449223417
noisy true:382
noisy false:397
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 779
epoch [141/200] batch [5/26] time 0.161 (0.177) data 0.084 (0.099) loss_x loss_x 0.3870 (0.4729) acc_x 93.7500 (86.2500) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/26] time 0.179 (0.175) data 0.101 (0.097) loss_x loss_x 0.1650 (0.5269) acc_x 100.0000 (85.3125) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/26] time 0.186 (0.178) data 0.108 (0.100) loss_x loss_x 0.3010 (0.5173) acc_x 93.7500 (86.4583) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/26] time 0.184 (0.179) data 0.106 (0.101) loss_x loss_x 0.6406 (0.5537) acc_x 81.2500 (84.8438) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [25/26] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.6279 (0.5654) acc_x 84.3750 (84.5000) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/24] time 0.186 (0.181) data 0.108 (0.104) loss_u loss_u 0.8950 (0.8626) acc_u 9.3750 (15.6250) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/24] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9204 (0.8794) acc_u 15.6250 (14.0625) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/24] time 0.187 (0.183) data 0.110 (0.105) loss_u loss_u 0.8516 (0.8683) acc_u 15.6250 (15.6250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/24] time 0.185 (0.183) data 0.107 (0.105) loss_u loss_u 0.8193 (0.8553) acc_u 21.8750 (16.8750) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 416
confident_label rate tensor(0.5235, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 846
clean true:816
clean false:30
clean_rate:0.9645390070921985
noisy true:384
noisy false:386
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 770
epoch [142/200] batch [5/26] time 0.187 (0.183) data 0.109 (0.106) loss_x loss_x 0.6016 (0.5641) acc_x 71.8750 (85.6250) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/26] time 0.172 (0.182) data 0.095 (0.105) loss_x loss_x 0.6631 (0.5995) acc_x 81.2500 (84.0625) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/26] time 0.187 (0.180) data 0.108 (0.102) loss_x loss_x 0.7749 (0.6297) acc_x 81.2500 (83.3333) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/26] time 0.178 (0.180) data 0.100 (0.102) loss_x loss_x 0.4666 (0.6226) acc_x 84.3750 (83.2812) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [25/26] time 0.189 (0.182) data 0.111 (0.104) loss_x loss_x 0.4102 (0.6056) acc_x 90.6250 (83.6250) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/24] time 0.185 (0.183) data 0.106 (0.105) loss_u loss_u 0.8208 (0.8688) acc_u 18.7500 (13.1250) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/24] time 0.185 (0.183) data 0.106 (0.105) loss_u loss_u 0.9517 (0.8724) acc_u 6.2500 (13.4375) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/24] time 0.185 (0.183) data 0.106 (0.105) loss_u loss_u 0.9199 (0.8576) acc_u 9.3750 (15.6250) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/24] time 0.182 (0.184) data 0.105 (0.106) loss_u loss_u 0.8501 (0.8547) acc_u 15.6250 (16.4062) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.5217, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 843
clean true:812
clean false:31
clean_rate:0.963226571767497
noisy true:378
noisy false:395
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 773
epoch [143/200] batch [5/26] time 0.159 (0.180) data 0.081 (0.102) loss_x loss_x 0.6299 (0.5895) acc_x 81.2500 (83.1250) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/26] time 0.170 (0.182) data 0.093 (0.104) loss_x loss_x 0.4753 (0.5388) acc_x 93.7500 (86.5625) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/26] time 0.187 (0.181) data 0.110 (0.103) loss_x loss_x 0.6196 (0.5517) acc_x 81.2500 (85.4167) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/26] time 0.171 (0.180) data 0.093 (0.102) loss_x loss_x 0.6548 (0.5464) acc_x 78.1250 (85.4688) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [25/26] time 0.187 (0.180) data 0.109 (0.102) loss_x loss_x 0.4556 (0.5274) acc_x 87.5000 (86.5000) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/24] time 0.165 (0.178) data 0.088 (0.100) loss_u loss_u 0.8638 (0.8398) acc_u 15.6250 (16.8750) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/24] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.8843 (0.8441) acc_u 18.7500 (18.1250) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/24] time 0.172 (0.179) data 0.095 (0.101) loss_u loss_u 0.9272 (0.8634) acc_u 9.3750 (16.0417) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/24] time 0.180 (0.179) data 0.102 (0.101) loss_u loss_u 0.7505 (0.8499) acc_u 31.2500 (17.5000) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 406
confident_label rate tensor(0.5223, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 844
clean true:815
clean false:29
clean_rate:0.9656398104265402
noisy true:395
noisy false:377
after delete: len(clean_dataset) 844
after delete: len(noisy_dataset) 772
epoch [144/200] batch [5/26] time 0.171 (0.173) data 0.093 (0.095) loss_x loss_x 0.5522 (0.4977) acc_x 84.3750 (88.1250) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/26] time 0.173 (0.168) data 0.095 (0.091) loss_x loss_x 0.7803 (0.5614) acc_x 81.2500 (84.0625) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/26] time 0.176 (0.169) data 0.098 (0.091) loss_x loss_x 0.5913 (0.5599) acc_x 81.2500 (85.4167) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/26] time 0.182 (0.175) data 0.105 (0.097) loss_x loss_x 0.8096 (0.6136) acc_x 75.0000 (83.7500) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [25/26] time 0.177 (0.174) data 0.099 (0.097) loss_x loss_x 0.7217 (0.6041) acc_x 81.2500 (84.6250) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/24] time 0.188 (0.176) data 0.111 (0.098) loss_u loss_u 0.8682 (0.8558) acc_u 12.5000 (16.8750) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/24] time 0.176 (0.175) data 0.097 (0.098) loss_u loss_u 0.8203 (0.8444) acc_u 21.8750 (18.1250) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/24] time 0.182 (0.176) data 0.104 (0.098) loss_u loss_u 0.7710 (0.8541) acc_u 28.1250 (17.0833) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/24] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.8525 (0.8544) acc_u 15.6250 (16.8750) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 414
confident_label rate tensor(0.5210, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 842
clean true:814
clean false:28
clean_rate:0.9667458432304038
noisy true:388
noisy false:386
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 774
epoch [145/200] batch [5/26] time 0.173 (0.175) data 0.095 (0.097) loss_x loss_x 0.3992 (0.5521) acc_x 90.6250 (87.5000) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/26] time 0.162 (0.177) data 0.084 (0.099) loss_x loss_x 0.4275 (0.5843) acc_x 90.6250 (87.8125) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/26] time 0.188 (0.177) data 0.109 (0.099) loss_x loss_x 0.3469 (0.5860) acc_x 93.7500 (87.2917) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/26] time 0.184 (0.179) data 0.106 (0.102) loss_x loss_x 0.3677 (0.5641) acc_x 90.6250 (87.1875) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [25/26] time 0.182 (0.180) data 0.105 (0.102) loss_x loss_x 0.5820 (0.5567) acc_x 84.3750 (86.8750) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/24] time 0.184 (0.181) data 0.105 (0.103) loss_u loss_u 0.9014 (0.8675) acc_u 9.3750 (13.7500) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/24] time 0.185 (0.182) data 0.106 (0.104) loss_u loss_u 0.8735 (0.8726) acc_u 12.5000 (14.0625) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/24] time 0.186 (0.182) data 0.107 (0.104) loss_u loss_u 0.8311 (0.8564) acc_u 15.6250 (16.0417) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/24] time 0.180 (0.182) data 0.101 (0.104) loss_u loss_u 0.8198 (0.8558) acc_u 18.7500 (15.9375) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 420
confident_label rate tensor(0.5198, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 840
clean true:808
clean false:32
clean_rate:0.9619047619047619
noisy true:388
noisy false:388
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 776
epoch [146/200] batch [5/26] time 0.198 (0.191) data 0.118 (0.113) loss_x loss_x 0.1407 (0.5373) acc_x 93.7500 (84.3750) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/26] time 0.182 (0.187) data 0.104 (0.110) loss_x loss_x 0.5913 (0.5493) acc_x 78.1250 (84.3750) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/26] time 0.174 (0.185) data 0.097 (0.107) loss_x loss_x 0.3916 (0.5305) acc_x 90.6250 (85.8333) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/26] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 0.3328 (0.5188) acc_x 90.6250 (85.7812) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [25/26] time 0.163 (0.178) data 0.086 (0.101) loss_x loss_x 0.4648 (0.5294) acc_x 84.3750 (85.2500) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/24] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.7944 (0.8366) acc_u 25.0000 (19.3750) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/24] time 0.190 (0.179) data 0.111 (0.101) loss_u loss_u 0.8623 (0.8554) acc_u 15.6250 (16.5625) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/24] time 0.183 (0.179) data 0.105 (0.101) loss_u loss_u 0.8799 (0.8577) acc_u 12.5000 (16.4583) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/24] time 0.184 (0.180) data 0.105 (0.102) loss_u loss_u 0.8242 (0.8508) acc_u 25.0000 (17.1875) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 404
confident_label rate tensor(0.5278, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 853
clean true:820
clean false:33
clean_rate:0.9613130128956624
noisy true:392
noisy false:371
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 763
epoch [147/200] batch [5/26] time 0.167 (0.171) data 0.090 (0.093) loss_x loss_x 0.2690 (0.6742) acc_x 93.7500 (84.3750) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/26] time 0.159 (0.173) data 0.081 (0.095) loss_x loss_x 0.5205 (0.6845) acc_x 81.2500 (84.3750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/26] time 0.185 (0.175) data 0.106 (0.098) loss_x loss_x 0.6313 (0.6478) acc_x 90.6250 (84.7917) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/26] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 0.6162 (0.6216) acc_x 78.1250 (85.0000) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [25/26] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.5767 (0.6161) acc_x 81.2500 (84.6250) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/23] time 0.175 (0.173) data 0.095 (0.096) loss_u loss_u 0.7886 (0.8252) acc_u 21.8750 (16.8750) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/23] time 0.184 (0.174) data 0.105 (0.097) loss_u loss_u 0.9316 (0.8283) acc_u 9.3750 (17.8125) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/23] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.9048 (0.8447) acc_u 9.3750 (16.2500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/23] time 0.184 (0.176) data 0.105 (0.098) loss_u loss_u 0.9131 (0.8513) acc_u 9.3750 (15.9375) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 419
confident_label rate tensor(0.5198, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 840
clean true:810
clean false:30
clean_rate:0.9642857142857143
noisy true:387
noisy false:389
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 776
epoch [148/200] batch [5/26] time 0.182 (0.178) data 0.104 (0.100) loss_x loss_x 0.5791 (0.6563) acc_x 84.3750 (83.1250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/26] time 0.159 (0.177) data 0.082 (0.099) loss_x loss_x 0.8667 (0.6605) acc_x 81.2500 (83.4375) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/26] time 0.187 (0.174) data 0.110 (0.096) loss_x loss_x 0.4849 (0.6618) acc_x 87.5000 (82.5000) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/26] time 0.178 (0.175) data 0.100 (0.097) loss_x loss_x 0.6724 (0.5977) acc_x 78.1250 (84.0625) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [25/26] time 0.177 (0.175) data 0.100 (0.098) loss_x loss_x 0.5620 (0.5964) acc_x 87.5000 (83.8750) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/24] time 0.173 (0.175) data 0.094 (0.097) loss_u loss_u 0.8364 (0.8220) acc_u 15.6250 (19.3750) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/24] time 0.191 (0.177) data 0.111 (0.099) loss_u loss_u 0.8545 (0.8358) acc_u 18.7500 (18.4375) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/24] time 0.171 (0.178) data 0.093 (0.100) loss_u loss_u 0.8633 (0.8432) acc_u 15.6250 (17.7083) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/24] time 0.172 (0.177) data 0.093 (0.099) loss_u loss_u 0.8667 (0.8393) acc_u 15.6250 (18.5938) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 382
confident_label rate tensor(0.5427, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 877
clean true:845
clean false:32
clean_rate:0.9635119726339795
noisy true:389
noisy false:350
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 739
epoch [149/200] batch [5/27] time 0.161 (0.177) data 0.083 (0.099) loss_x loss_x 0.6470 (0.5467) acc_x 90.6250 (90.0000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/27] time 0.184 (0.176) data 0.106 (0.099) loss_x loss_x 0.2494 (0.5815) acc_x 96.8750 (87.8125) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/27] time 0.173 (0.173) data 0.096 (0.095) loss_x loss_x 0.3765 (0.5885) acc_x 87.5000 (86.8750) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/27] time 0.178 (0.174) data 0.100 (0.096) loss_x loss_x 1.1055 (0.6186) acc_x 78.1250 (85.9375) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [25/27] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.3867 (0.5980) acc_x 87.5000 (86.2500) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/23] time 0.177 (0.175) data 0.098 (0.097) loss_u loss_u 0.8135 (0.8511) acc_u 18.7500 (16.8750) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/23] time 0.175 (0.175) data 0.098 (0.097) loss_u loss_u 0.8198 (0.8577) acc_u 28.1250 (17.5000) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/23] time 0.163 (0.174) data 0.085 (0.096) loss_u loss_u 0.8096 (0.8626) acc_u 25.0000 (16.8750) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/23] time 0.186 (0.175) data 0.108 (0.097) loss_u loss_u 0.9160 (0.8684) acc_u 12.5000 (15.9375) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 408
confident_label rate tensor(0.5285, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 854
clean true:828
clean false:26
clean_rate:0.9695550351288056
noisy true:380
noisy false:382
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 762
epoch [150/200] batch [5/26] time 0.188 (0.185) data 0.111 (0.107) loss_x loss_x 0.2957 (0.5702) acc_x 93.7500 (85.6250) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/26] time 0.178 (0.177) data 0.100 (0.099) loss_x loss_x 0.8442 (0.6038) acc_x 78.1250 (85.3125) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/26] time 0.183 (0.178) data 0.106 (0.100) loss_x loss_x 0.7021 (0.5776) acc_x 78.1250 (85.2083) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/26] time 0.190 (0.180) data 0.113 (0.102) loss_x loss_x 0.6060 (0.5657) acc_x 87.5000 (84.6875) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [25/26] time 0.186 (0.180) data 0.108 (0.103) loss_x loss_x 0.2239 (0.5428) acc_x 96.8750 (85.3750) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/23] time 0.189 (0.181) data 0.111 (0.103) loss_u loss_u 0.7832 (0.8167) acc_u 25.0000 (22.5000) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/23] time 0.191 (0.182) data 0.112 (0.104) loss_u loss_u 0.8970 (0.8499) acc_u 12.5000 (17.5000) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/23] time 0.183 (0.182) data 0.105 (0.104) loss_u loss_u 0.8169 (0.8487) acc_u 18.7500 (17.5000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/23] time 0.175 (0.182) data 0.097 (0.104) loss_u loss_u 0.8354 (0.8408) acc_u 21.8750 (18.2812) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 395
confident_label rate tensor(0.5248, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 848
clean true:819
clean false:29
clean_rate:0.9658018867924528
noisy true:402
noisy false:366
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 768
epoch [151/200] batch [5/26] time 0.181 (0.168) data 0.102 (0.090) loss_x loss_x 0.5972 (0.5197) acc_x 87.5000 (85.6250) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/26] time 0.170 (0.171) data 0.093 (0.093) loss_x loss_x 0.6841 (0.5849) acc_x 78.1250 (85.0000) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/26] time 0.186 (0.172) data 0.107 (0.095) loss_x loss_x 0.7119 (0.5541) acc_x 81.2500 (86.2500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/26] time 0.170 (0.174) data 0.093 (0.096) loss_x loss_x 0.6313 (0.5628) acc_x 81.2500 (86.0938) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [25/26] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.4497 (0.5399) acc_x 93.7500 (87.2500) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/24] time 0.180 (0.174) data 0.102 (0.096) loss_u loss_u 0.8223 (0.8676) acc_u 21.8750 (17.5000) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/24] time 0.187 (0.176) data 0.109 (0.098) loss_u loss_u 0.8716 (0.8607) acc_u 12.5000 (17.1875) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/24] time 0.185 (0.177) data 0.108 (0.099) loss_u loss_u 0.8462 (0.8513) acc_u 18.7500 (17.9167) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/24] time 0.180 (0.177) data 0.102 (0.099) loss_u loss_u 0.8472 (0.8544) acc_u 21.8750 (17.9688) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 404
confident_label rate tensor(0.5303, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 857
clean true:828
clean false:29
clean_rate:0.9661610268378062
noisy true:384
noisy false:375
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 759
epoch [152/200] batch [5/26] time 0.174 (0.180) data 0.096 (0.103) loss_x loss_x 0.6099 (0.6464) acc_x 81.2500 (82.5000) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/26] time 0.159 (0.174) data 0.081 (0.096) loss_x loss_x 0.2439 (0.5738) acc_x 96.8750 (84.6875) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/26] time 0.192 (0.173) data 0.114 (0.095) loss_x loss_x 0.6309 (0.5739) acc_x 81.2500 (85.2083) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/26] time 0.192 (0.174) data 0.114 (0.097) loss_x loss_x 0.4807 (0.5961) acc_x 87.5000 (85.0000) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [25/26] time 0.177 (0.175) data 0.098 (0.097) loss_x loss_x 0.6050 (0.5966) acc_x 87.5000 (84.8750) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/23] time 0.187 (0.177) data 0.109 (0.099) loss_u loss_u 0.8657 (0.8581) acc_u 12.5000 (15.6250) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/23] time 0.191 (0.179) data 0.113 (0.101) loss_u loss_u 0.9004 (0.8798) acc_u 12.5000 (13.4375) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/23] time 0.189 (0.180) data 0.111 (0.102) loss_u loss_u 0.8403 (0.8662) acc_u 18.7500 (15.4167) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/23] time 0.183 (0.180) data 0.105 (0.103) loss_u loss_u 0.8862 (0.8619) acc_u 12.5000 (15.4688) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 405
confident_label rate tensor(0.5291, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 855
clean true:827
clean false:28
clean_rate:0.9672514619883041
noisy true:384
noisy false:377
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 761
epoch [153/200] batch [5/26] time 0.189 (0.186) data 0.111 (0.108) loss_x loss_x 0.3901 (0.5730) acc_x 90.6250 (85.6250) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/26] time 0.188 (0.193) data 0.111 (0.115) loss_x loss_x 0.2834 (0.5080) acc_x 96.8750 (87.5000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [15/26] time 0.180 (0.185) data 0.103 (0.107) loss_x loss_x 0.4780 (0.5120) acc_x 84.3750 (87.2917) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/26] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 1.0645 (0.5176) acc_x 68.7500 (86.8750) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [25/26] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.8223 (0.5492) acc_x 87.5000 (86.3750) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/23] time 0.183 (0.183) data 0.105 (0.105) loss_u loss_u 0.8105 (0.8545) acc_u 21.8750 (16.2500) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/23] time 0.182 (0.183) data 0.104 (0.105) loss_u loss_u 0.8794 (0.8560) acc_u 15.6250 (15.9375) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/23] time 0.193 (0.183) data 0.112 (0.105) loss_u loss_u 0.8413 (0.8617) acc_u 18.7500 (15.4167) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/23] time 0.180 (0.183) data 0.102 (0.105) loss_u loss_u 0.8623 (0.8594) acc_u 18.7500 (15.9375) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 381
confident_label rate tensor(0.5347, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 864
clean true:831
clean false:33
clean_rate:0.9618055555555556
noisy true:404
noisy false:348
after delete: len(clean_dataset) 864
after delete: len(noisy_dataset) 752
epoch [154/200] batch [5/27] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 1.2295 (0.7016) acc_x 78.1250 (85.6250) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/27] time 0.178 (0.176) data 0.101 (0.099) loss_x loss_x 0.5288 (0.6043) acc_x 87.5000 (86.5625) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/27] time 0.175 (0.176) data 0.098 (0.098) loss_x loss_x 0.4011 (0.6106) acc_x 84.3750 (86.6667) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/27] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.4902 (0.6153) acc_x 87.5000 (85.6250) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [25/27] time 0.170 (0.175) data 0.092 (0.097) loss_x loss_x 0.8032 (0.5970) acc_x 81.2500 (85.6250) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/23] time 0.187 (0.176) data 0.109 (0.099) loss_u loss_u 0.9106 (0.8871) acc_u 15.6250 (14.3750) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/23] time 0.180 (0.178) data 0.103 (0.100) loss_u loss_u 0.7256 (0.8506) acc_u 31.2500 (17.1875) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/23] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.8706 (0.8498) acc_u 15.6250 (17.5000) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/23] time 0.190 (0.179) data 0.111 (0.102) loss_u loss_u 0.9551 (0.8550) acc_u 3.1250 (16.4062) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 414
confident_label rate tensor(0.5204, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 841
clean true:809
clean false:32
clean_rate:0.9619500594530321
noisy true:393
noisy false:382
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 775
epoch [155/200] batch [5/26] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.7251 (0.6611) acc_x 81.2500 (82.5000) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/26] time 0.171 (0.173) data 0.094 (0.095) loss_x loss_x 0.6064 (0.6709) acc_x 81.2500 (82.1875) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/26] time 0.161 (0.169) data 0.084 (0.091) loss_x loss_x 0.5674 (0.6292) acc_x 81.2500 (83.5417) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/26] time 0.193 (0.173) data 0.116 (0.095) loss_x loss_x 0.5317 (0.6216) acc_x 90.6250 (84.5312) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [25/26] time 0.185 (0.175) data 0.106 (0.098) loss_x loss_x 1.1074 (0.6123) acc_x 75.0000 (84.8750) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/24] time 0.182 (0.177) data 0.105 (0.099) loss_u loss_u 0.8877 (0.8489) acc_u 12.5000 (17.5000) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/24] time 0.184 (0.178) data 0.105 (0.100) loss_u loss_u 0.8408 (0.8442) acc_u 15.6250 (17.8125) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/24] time 0.183 (0.178) data 0.104 (0.101) loss_u loss_u 0.7749 (0.8458) acc_u 28.1250 (17.7083) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/24] time 0.183 (0.179) data 0.105 (0.101) loss_u loss_u 0.7529 (0.8438) acc_u 28.1250 (18.1250) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 414
confident_label rate tensor(0.5155, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 833
clean true:802
clean false:31
clean_rate:0.9627851140456183
noisy true:400
noisy false:383
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 783
epoch [156/200] batch [5/26] time 0.190 (0.187) data 0.113 (0.109) loss_x loss_x 0.4751 (0.5257) acc_x 90.6250 (88.1250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/26] time 0.174 (0.182) data 0.097 (0.104) loss_x loss_x 0.8687 (0.5671) acc_x 71.8750 (85.3125) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/26] time 0.180 (0.178) data 0.103 (0.100) loss_x loss_x 0.2539 (0.5278) acc_x 90.6250 (86.4583) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/26] time 0.185 (0.179) data 0.107 (0.101) loss_x loss_x 0.4175 (0.5219) acc_x 84.3750 (87.1875) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [25/26] time 0.170 (0.179) data 0.092 (0.101) loss_x loss_x 0.4253 (0.5245) acc_x 87.5000 (86.8750) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/24] time 0.174 (0.178) data 0.095 (0.100) loss_u loss_u 0.8208 (0.8037) acc_u 21.8750 (23.7500) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/24] time 0.183 (0.178) data 0.105 (0.100) loss_u loss_u 0.8354 (0.8132) acc_u 18.7500 (22.1875) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/24] time 0.185 (0.179) data 0.106 (0.101) loss_u loss_u 0.7676 (0.8280) acc_u 25.0000 (19.3750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/24] time 0.193 (0.180) data 0.115 (0.102) loss_u loss_u 0.8740 (0.8347) acc_u 12.5000 (18.7500) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 412
confident_label rate tensor(0.5217, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 843
clean true:816
clean false:27
clean_rate:0.9679715302491103
noisy true:388
noisy false:385
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 773
epoch [157/200] batch [5/26] time 0.186 (0.184) data 0.108 (0.106) loss_x loss_x 0.6631 (0.6420) acc_x 81.2500 (80.6250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/26] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 0.6606 (0.6252) acc_x 84.3750 (81.8750) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/26] time 0.162 (0.182) data 0.085 (0.105) loss_x loss_x 0.4751 (0.6000) acc_x 87.5000 (82.7083) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/26] time 0.170 (0.178) data 0.092 (0.101) loss_x loss_x 0.3845 (0.5890) acc_x 90.6250 (83.4375) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [25/26] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.4263 (0.5666) acc_x 90.6250 (84.1250) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/24] time 0.169 (0.174) data 0.089 (0.097) loss_u loss_u 0.8042 (0.8680) acc_u 18.7500 (14.3750) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/24] time 0.165 (0.173) data 0.087 (0.096) loss_u loss_u 0.9175 (0.8732) acc_u 9.3750 (15.0000) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/24] time 0.169 (0.173) data 0.091 (0.095) loss_u loss_u 0.7842 (0.8550) acc_u 25.0000 (17.0833) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/24] time 0.185 (0.173) data 0.107 (0.096) loss_u loss_u 0.8599 (0.8581) acc_u 15.6250 (16.7188) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 389
confident_label rate tensor(0.5285, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 854
clean true:817
clean false:37
clean_rate:0.9566744730679156
noisy true:410
noisy false:352
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 762
epoch [158/200] batch [5/26] time 0.170 (0.182) data 0.092 (0.104) loss_x loss_x 0.4546 (0.6220) acc_x 87.5000 (86.8750) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/26] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.7930 (0.6001) acc_x 81.2500 (85.9375) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/26] time 0.162 (0.178) data 0.085 (0.101) loss_x loss_x 0.5122 (0.5567) acc_x 87.5000 (86.8750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/26] time 0.187 (0.177) data 0.109 (0.100) loss_x loss_x 0.4490 (0.5504) acc_x 87.5000 (87.1875) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [25/26] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.5435 (0.5303) acc_x 81.2500 (87.3750) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/23] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.9312 (0.8631) acc_u 6.2500 (14.3750) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/23] time 0.172 (0.178) data 0.093 (0.101) loss_u loss_u 0.8853 (0.8522) acc_u 12.5000 (16.2500) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/23] time 0.167 (0.178) data 0.089 (0.101) loss_u loss_u 0.8281 (0.8455) acc_u 18.7500 (17.2917) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/23] time 0.196 (0.179) data 0.118 (0.101) loss_u loss_u 0.7881 (0.8387) acc_u 28.1250 (18.2812) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 427
confident_label rate tensor(0.5223, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 844
clean true:813
clean false:31
clean_rate:0.9632701421800948
noisy true:376
noisy false:396
after delete: len(clean_dataset) 844
after delete: len(noisy_dataset) 772
epoch [159/200] batch [5/26] time 0.182 (0.199) data 0.105 (0.121) loss_x loss_x 0.8003 (0.5705) acc_x 81.2500 (85.0000) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/26] time 0.176 (0.191) data 0.098 (0.113) loss_x loss_x 0.4348 (0.5249) acc_x 84.3750 (87.1875) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [15/26] time 0.164 (0.184) data 0.085 (0.106) loss_x loss_x 0.6670 (0.5328) acc_x 81.2500 (86.4583) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/26] time 0.178 (0.183) data 0.100 (0.105) loss_x loss_x 0.5698 (0.5417) acc_x 87.5000 (86.7188) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [25/26] time 0.176 (0.180) data 0.099 (0.102) loss_x loss_x 0.4546 (0.5294) acc_x 90.6250 (87.1250) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/24] time 0.173 (0.179) data 0.094 (0.101) loss_u loss_u 0.8408 (0.8225) acc_u 18.7500 (21.8750) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/24] time 0.163 (0.178) data 0.085 (0.101) loss_u loss_u 0.8794 (0.8461) acc_u 12.5000 (18.4375) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/24] time 0.161 (0.177) data 0.083 (0.099) loss_u loss_u 0.8945 (0.8481) acc_u 9.3750 (17.9167) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/24] time 0.186 (0.177) data 0.108 (0.099) loss_u loss_u 0.9526 (0.8519) acc_u 6.2500 (17.3438) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 418
confident_label rate tensor(0.5241, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 847
clean true:818
clean false:29
clean_rate:0.9657615112160567
noisy true:380
noisy false:389
after delete: len(clean_dataset) 847
after delete: len(noisy_dataset) 769
epoch [160/200] batch [5/26] time 0.190 (0.189) data 0.112 (0.111) loss_x loss_x 0.5625 (0.6830) acc_x 78.1250 (81.2500) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/26] time 0.184 (0.187) data 0.107 (0.109) loss_x loss_x 0.8340 (0.6652) acc_x 75.0000 (81.2500) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/26] time 0.167 (0.182) data 0.089 (0.104) loss_x loss_x 0.6035 (0.6473) acc_x 87.5000 (82.2917) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/26] time 0.172 (0.179) data 0.094 (0.101) loss_x loss_x 0.9878 (0.6478) acc_x 71.8750 (82.6562) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [25/26] time 0.167 (0.177) data 0.089 (0.099) loss_x loss_x 0.2269 (0.5820) acc_x 100.0000 (84.5000) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/24] time 0.170 (0.175) data 0.093 (0.097) loss_u loss_u 0.8540 (0.8529) acc_u 15.6250 (16.8750) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/24] time 0.161 (0.174) data 0.083 (0.096) loss_u loss_u 0.8589 (0.8649) acc_u 12.5000 (15.0000) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/24] time 0.160 (0.172) data 0.082 (0.095) loss_u loss_u 0.8496 (0.8552) acc_u 15.6250 (16.0417) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/24] time 0.164 (0.171) data 0.086 (0.094) loss_u loss_u 0.8223 (0.8499) acc_u 21.8750 (16.5625) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 384
confident_label rate tensor(0.5340, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 863
clean true:833
clean false:30
clean_rate:0.9652375434530707
noisy true:399
noisy false:354
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 753
epoch [161/200] batch [5/26] time 0.184 (0.190) data 0.106 (0.113) loss_x loss_x 0.6987 (0.4459) acc_x 87.5000 (89.3750) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/26] time 0.162 (0.185) data 0.084 (0.107) loss_x loss_x 0.5503 (0.4481) acc_x 81.2500 (88.4375) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/26] time 0.183 (0.185) data 0.104 (0.107) loss_x loss_x 0.6558 (0.5319) acc_x 84.3750 (87.2917) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/26] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.6611 (0.5004) acc_x 81.2500 (87.8125) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [25/26] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.7886 (0.5113) acc_x 81.2500 (87.3750) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/23] time 0.184 (0.185) data 0.106 (0.107) loss_u loss_u 0.8096 (0.8353) acc_u 18.7500 (20.0000) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/23] time 0.183 (0.185) data 0.105 (0.107) loss_u loss_u 0.9312 (0.8609) acc_u 9.3750 (15.9375) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/23] time 0.184 (0.185) data 0.106 (0.107) loss_u loss_u 0.9175 (0.8641) acc_u 12.5000 (16.0417) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/23] time 0.181 (0.184) data 0.103 (0.106) loss_u loss_u 0.8447 (0.8640) acc_u 18.7500 (15.9375) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 410
confident_label rate tensor(0.5229, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 845
clean true:813
clean false:32
clean_rate:0.9621301775147929
noisy true:393
noisy false:378
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 771
epoch [162/200] batch [5/26] time 0.179 (0.185) data 0.102 (0.108) loss_x loss_x 0.4536 (0.3763) acc_x 93.7500 (91.8750) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/26] time 0.158 (0.181) data 0.081 (0.104) loss_x loss_x 0.3372 (0.4226) acc_x 90.6250 (89.3750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/26] time 0.168 (0.177) data 0.090 (0.099) loss_x loss_x 0.3218 (0.4347) acc_x 90.6250 (89.3750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/26] time 0.177 (0.176) data 0.099 (0.098) loss_x loss_x 0.8398 (0.4523) acc_x 71.8750 (88.5938) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [25/26] time 0.182 (0.177) data 0.104 (0.099) loss_x loss_x 0.2246 (0.4485) acc_x 93.7500 (88.5000) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/24] time 0.188 (0.178) data 0.109 (0.101) loss_u loss_u 0.8203 (0.8354) acc_u 18.7500 (19.3750) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/24] time 0.184 (0.179) data 0.106 (0.101) loss_u loss_u 0.9033 (0.8538) acc_u 12.5000 (17.1875) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/24] time 0.188 (0.180) data 0.110 (0.102) loss_u loss_u 0.8359 (0.8598) acc_u 15.6250 (16.0417) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/24] time 0.186 (0.181) data 0.108 (0.103) loss_u loss_u 0.7461 (0.8425) acc_u 28.1250 (17.5000) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 390
confident_label rate tensor(0.5278, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 853
clean true:827
clean false:26
clean_rate:0.9695193434935522
noisy true:399
noisy false:364
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 763
epoch [163/200] batch [5/26] time 0.182 (0.168) data 0.104 (0.090) loss_x loss_x 0.5659 (0.6417) acc_x 81.2500 (81.8750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/26] time 0.179 (0.175) data 0.102 (0.097) loss_x loss_x 0.5161 (0.5419) acc_x 87.5000 (85.3125) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/26] time 0.189 (0.177) data 0.110 (0.099) loss_x loss_x 0.4353 (0.5613) acc_x 93.7500 (85.0000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/26] time 0.160 (0.173) data 0.082 (0.096) loss_x loss_x 0.5732 (0.5630) acc_x 87.5000 (85.7812) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [25/26] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.7480 (0.5626) acc_x 78.1250 (85.6250) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/23] time 0.179 (0.172) data 0.101 (0.095) loss_u loss_u 0.8286 (0.8444) acc_u 18.7500 (15.6250) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/23] time 0.173 (0.175) data 0.095 (0.097) loss_u loss_u 0.8804 (0.8318) acc_u 12.5000 (18.1250) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/23] time 0.181 (0.176) data 0.101 (0.098) loss_u loss_u 0.8809 (0.8373) acc_u 12.5000 (17.5000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/23] time 0.167 (0.176) data 0.089 (0.098) loss_u loss_u 0.8765 (0.8471) acc_u 18.7500 (17.0312) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 413
confident_label rate tensor(0.5260, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 850
clean true:821
clean false:29
clean_rate:0.9658823529411765
noisy true:382
noisy false:384
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 766
epoch [164/200] batch [5/26] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.4543 (0.5527) acc_x 90.6250 (85.6250) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/26] time 0.165 (0.171) data 0.088 (0.093) loss_x loss_x 0.5605 (0.5309) acc_x 87.5000 (86.2500) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/26] time 0.167 (0.170) data 0.090 (0.092) loss_x loss_x 0.6318 (0.5359) acc_x 81.2500 (86.6667) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/26] time 0.159 (0.170) data 0.081 (0.093) loss_x loss_x 0.6152 (0.5252) acc_x 81.2500 (86.4062) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [25/26] time 0.171 (0.168) data 0.093 (0.091) loss_x loss_x 0.7593 (0.5327) acc_x 81.2500 (86.3750) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/23] time 0.183 (0.170) data 0.104 (0.093) loss_u loss_u 0.9453 (0.8753) acc_u 6.2500 (15.0000) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/23] time 0.192 (0.173) data 0.113 (0.095) loss_u loss_u 0.8354 (0.8763) acc_u 21.8750 (14.6875) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/23] time 0.181 (0.174) data 0.103 (0.096) loss_u loss_u 0.9067 (0.8671) acc_u 12.5000 (16.0417) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/23] time 0.183 (0.175) data 0.105 (0.097) loss_u loss_u 0.8252 (0.8609) acc_u 18.7500 (16.5625) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 395
confident_label rate tensor(0.5334, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 862
clean true:836
clean false:26
clean_rate:0.9698375870069605
noisy true:385
noisy false:369
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 754
epoch [165/200] batch [5/26] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.5776 (0.6577) acc_x 84.3750 (85.0000) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/26] time 0.182 (0.185) data 0.105 (0.107) loss_x loss_x 0.4365 (0.5931) acc_x 90.6250 (86.8750) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/26] time 0.207 (0.186) data 0.130 (0.109) loss_x loss_x 0.2527 (0.6020) acc_x 90.6250 (85.6250) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/26] time 0.186 (0.187) data 0.108 (0.109) loss_x loss_x 0.3972 (0.5993) acc_x 90.6250 (85.9375) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [25/26] time 0.183 (0.186) data 0.105 (0.108) loss_x loss_x 0.4753 (0.6225) acc_x 87.5000 (85.5000) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/23] time 0.177 (0.184) data 0.098 (0.107) loss_u loss_u 0.8105 (0.8597) acc_u 21.8750 (15.6250) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/23] time 0.164 (0.182) data 0.086 (0.104) loss_u loss_u 0.8184 (0.8537) acc_u 21.8750 (16.5625) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/23] time 0.182 (0.182) data 0.105 (0.104) loss_u loss_u 0.8125 (0.8481) acc_u 21.8750 (17.2917) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/23] time 0.172 (0.182) data 0.094 (0.104) loss_u loss_u 0.8735 (0.8554) acc_u 15.6250 (16.8750) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 403
confident_label rate tensor(0.5272, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 852
clean true:827
clean false:25
clean_rate:0.9706572769953051
noisy true:386
noisy false:378
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 764
epoch [166/200] batch [5/26] time 0.184 (0.186) data 0.106 (0.109) loss_x loss_x 0.8076 (0.4971) acc_x 78.1250 (87.5000) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/26] time 0.173 (0.184) data 0.095 (0.107) loss_x loss_x 0.7119 (0.4965) acc_x 81.2500 (87.1875) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/26] time 0.192 (0.185) data 0.114 (0.108) loss_x loss_x 0.5898 (0.5133) acc_x 87.5000 (86.6667) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/26] time 0.167 (0.181) data 0.090 (0.104) loss_x loss_x 0.7876 (0.5323) acc_x 81.2500 (86.4062) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [25/26] time 0.160 (0.177) data 0.083 (0.100) loss_x loss_x 0.4814 (0.5268) acc_x 87.5000 (86.3750) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/23] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.8271 (0.8479) acc_u 18.7500 (16.2500) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/23] time 0.184 (0.180) data 0.106 (0.102) loss_u loss_u 0.9229 (0.8544) acc_u 6.2500 (15.3125) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/23] time 0.185 (0.180) data 0.107 (0.102) loss_u loss_u 0.9126 (0.8579) acc_u 12.5000 (16.6667) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/23] time 0.185 (0.181) data 0.107 (0.103) loss_u loss_u 0.8535 (0.8668) acc_u 18.7500 (15.7812) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 389
confident_label rate tensor(0.5322, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 860
clean true:831
clean false:29
clean_rate:0.9662790697674418
noisy true:396
noisy false:360
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 756
epoch [167/200] batch [5/26] time 0.172 (0.174) data 0.094 (0.096) loss_x loss_x 0.9956 (0.7032) acc_x 71.8750 (81.8750) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/26] time 0.188 (0.180) data 0.110 (0.102) loss_x loss_x 0.5068 (0.5970) acc_x 90.6250 (85.6250) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/26] time 0.176 (0.180) data 0.099 (0.102) loss_x loss_x 0.4609 (0.6192) acc_x 87.5000 (85.0000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/26] time 0.170 (0.179) data 0.093 (0.101) loss_x loss_x 0.5278 (0.5924) acc_x 87.5000 (85.7812) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [25/26] time 0.164 (0.176) data 0.086 (0.098) loss_x loss_x 0.7393 (0.6083) acc_x 78.1250 (85.0000) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/23] time 0.180 (0.178) data 0.102 (0.100) loss_u loss_u 0.8833 (0.8559) acc_u 15.6250 (16.2500) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/23] time 0.174 (0.178) data 0.096 (0.100) loss_u loss_u 0.8384 (0.8536) acc_u 21.8750 (17.1875) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/23] time 0.170 (0.176) data 0.093 (0.098) loss_u loss_u 0.8506 (0.8390) acc_u 18.7500 (18.5417) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/23] time 0.179 (0.177) data 0.102 (0.099) loss_u loss_u 0.8877 (0.8554) acc_u 12.5000 (17.0312) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 417
confident_label rate tensor(0.5272, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 852
clean true:819
clean false:33
clean_rate:0.9612676056338029
noisy true:380
noisy false:384
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 764
epoch [168/200] batch [5/26] time 0.178 (0.184) data 0.100 (0.107) loss_x loss_x 0.5254 (0.7034) acc_x 87.5000 (80.6250) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/26] time 0.171 (0.177) data 0.093 (0.099) loss_x loss_x 0.3447 (0.5668) acc_x 93.7500 (83.7500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/26] time 0.185 (0.177) data 0.108 (0.099) loss_x loss_x 0.6187 (0.5469) acc_x 84.3750 (84.5833) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/26] time 0.172 (0.176) data 0.095 (0.098) loss_x loss_x 0.3074 (0.5371) acc_x 90.6250 (84.5312) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [25/26] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.5557 (0.5630) acc_x 81.2500 (83.8750) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/23] time 0.175 (0.177) data 0.097 (0.099) loss_u loss_u 0.7891 (0.7962) acc_u 21.8750 (22.5000) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/23] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.9614 (0.8413) acc_u 3.1250 (17.8125) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/23] time 0.186 (0.179) data 0.107 (0.101) loss_u loss_u 0.8071 (0.8444) acc_u 25.0000 (18.7500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/23] time 0.181 (0.180) data 0.102 (0.102) loss_u loss_u 0.8467 (0.8440) acc_u 21.8750 (18.9062) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 399
confident_label rate tensor(0.5278, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 853
clean true:826
clean false:27
clean_rate:0.9683470105509965
noisy true:391
noisy false:372
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 763
epoch [169/200] batch [5/26] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.6978 (0.4947) acc_x 81.2500 (88.1250) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/26] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.3921 (0.4913) acc_x 90.6250 (88.1250) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/26] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.5068 (0.5035) acc_x 90.6250 (87.5000) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/26] time 0.185 (0.187) data 0.108 (0.109) loss_x loss_x 0.8765 (0.5131) acc_x 75.0000 (87.0312) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [25/26] time 0.209 (0.188) data 0.131 (0.110) loss_x loss_x 0.5996 (0.5130) acc_x 87.5000 (86.7500) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/23] time 0.180 (0.186) data 0.102 (0.108) loss_u loss_u 0.8530 (0.8457) acc_u 18.7500 (16.8750) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/23] time 0.162 (0.184) data 0.084 (0.107) loss_u loss_u 0.8608 (0.8545) acc_u 15.6250 (16.2500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/23] time 0.166 (0.183) data 0.088 (0.105) loss_u loss_u 0.8003 (0.8618) acc_u 25.0000 (16.0417) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/23] time 0.167 (0.182) data 0.089 (0.104) loss_u loss_u 0.7979 (0.8563) acc_u 21.8750 (16.7188) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 416
confident_label rate tensor(0.5217, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 843
clean true:816
clean false:27
clean_rate:0.9679715302491103
noisy true:384
noisy false:389
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 773
epoch [170/200] batch [5/26] time 0.170 (0.179) data 0.092 (0.101) loss_x loss_x 0.6772 (0.6444) acc_x 78.1250 (83.1250) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/26] time 0.176 (0.181) data 0.098 (0.103) loss_x loss_x 0.4792 (0.5750) acc_x 87.5000 (85.0000) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/26] time 0.176 (0.180) data 0.099 (0.102) loss_x loss_x 0.5112 (0.5709) acc_x 90.6250 (85.4167) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/26] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.7046 (0.5674) acc_x 75.0000 (85.0000) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [25/26] time 0.159 (0.182) data 0.082 (0.105) loss_x loss_x 0.5469 (0.5529) acc_x 84.3750 (85.3750) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/24] time 0.186 (0.180) data 0.107 (0.102) loss_u loss_u 0.7998 (0.8405) acc_u 18.7500 (17.5000) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/24] time 0.189 (0.182) data 0.112 (0.104) loss_u loss_u 0.8354 (0.8414) acc_u 18.7500 (18.1250) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/24] time 0.168 (0.181) data 0.089 (0.103) loss_u loss_u 0.8599 (0.8392) acc_u 15.6250 (18.5417) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/24] time 0.178 (0.181) data 0.099 (0.103) loss_u loss_u 0.8916 (0.8391) acc_u 12.5000 (18.5938) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 379
confident_label rate tensor(0.5328, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 861
clean true:832
clean false:29
clean_rate:0.9663182346109176
noisy true:405
noisy false:350
after delete: len(clean_dataset) 861
after delete: len(noisy_dataset) 755
epoch [171/200] batch [5/26] time 0.174 (0.172) data 0.097 (0.094) loss_x loss_x 0.5889 (0.5549) acc_x 78.1250 (85.6250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/26] time 0.169 (0.177) data 0.092 (0.099) loss_x loss_x 1.0479 (0.6062) acc_x 84.3750 (85.6250) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/26] time 0.165 (0.174) data 0.088 (0.097) loss_x loss_x 0.4988 (0.5380) acc_x 84.3750 (85.8333) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/26] time 0.186 (0.175) data 0.108 (0.097) loss_x loss_x 0.4636 (0.5629) acc_x 87.5000 (85.3125) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [25/26] time 0.167 (0.175) data 0.089 (0.097) loss_x loss_x 0.3843 (0.5608) acc_x 93.7500 (85.3750) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/23] time 0.182 (0.175) data 0.103 (0.098) loss_u loss_u 0.9185 (0.8417) acc_u 6.2500 (17.5000) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/23] time 0.184 (0.176) data 0.105 (0.099) loss_u loss_u 0.8188 (0.8513) acc_u 18.7500 (17.1875) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/23] time 0.183 (0.175) data 0.106 (0.097) loss_u loss_u 0.8330 (0.8572) acc_u 18.7500 (16.4583) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/23] time 0.166 (0.176) data 0.088 (0.098) loss_u loss_u 0.8110 (0.8614) acc_u 21.8750 (16.5625) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 411
confident_label rate tensor(0.5297, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 856
clean true:827
clean false:29
clean_rate:0.9661214953271028
noisy true:378
noisy false:382
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 760
epoch [172/200] batch [5/26] time 0.167 (0.185) data 0.090 (0.107) loss_x loss_x 0.5605 (0.4294) acc_x 84.3750 (89.3750) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/26] time 0.192 (0.184) data 0.115 (0.107) loss_x loss_x 0.3804 (0.4727) acc_x 90.6250 (89.0625) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/26] time 0.172 (0.180) data 0.094 (0.103) loss_x loss_x 0.2491 (0.4767) acc_x 96.8750 (88.1250) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/26] time 0.184 (0.180) data 0.106 (0.103) loss_x loss_x 0.4851 (0.4926) acc_x 87.5000 (87.5000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [25/26] time 0.160 (0.180) data 0.083 (0.102) loss_x loss_x 0.4878 (0.4824) acc_x 87.5000 (88.1250) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/23] time 0.164 (0.178) data 0.086 (0.101) loss_u loss_u 0.7583 (0.8693) acc_u 31.2500 (18.1250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/23] time 0.182 (0.178) data 0.103 (0.100) loss_u loss_u 0.8237 (0.8498) acc_u 18.7500 (18.7500) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/23] time 0.192 (0.179) data 0.113 (0.101) loss_u loss_u 0.8242 (0.8628) acc_u 18.7500 (16.6667) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/23] time 0.165 (0.180) data 0.086 (0.102) loss_u loss_u 0.8423 (0.8577) acc_u 15.6250 (16.7188) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 389
confident_label rate tensor(0.5347, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 864
clean true:839
clean false:25
clean_rate:0.9710648148148148
noisy true:388
noisy false:364
after delete: len(clean_dataset) 864
after delete: len(noisy_dataset) 752
epoch [173/200] batch [5/27] time 0.180 (0.173) data 0.102 (0.095) loss_x loss_x 1.1074 (0.6993) acc_x 78.1250 (83.1250) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/27] time 0.183 (0.181) data 0.105 (0.103) loss_x loss_x 0.5137 (0.6089) acc_x 84.3750 (84.3750) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [15/27] time 0.179 (0.181) data 0.102 (0.103) loss_x loss_x 0.7485 (0.6053) acc_x 87.5000 (85.4167) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/27] time 0.172 (0.180) data 0.093 (0.102) loss_x loss_x 0.8496 (0.6178) acc_x 71.8750 (84.5312) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [25/27] time 0.168 (0.179) data 0.090 (0.101) loss_x loss_x 0.6270 (0.5822) acc_x 87.5000 (85.6250) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/23] time 0.174 (0.177) data 0.097 (0.099) loss_u loss_u 0.8237 (0.8535) acc_u 21.8750 (15.6250) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/23] time 0.175 (0.177) data 0.096 (0.099) loss_u loss_u 0.8506 (0.8595) acc_u 18.7500 (15.6250) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/23] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.7910 (0.8607) acc_u 21.8750 (15.6250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/23] time 0.170 (0.176) data 0.093 (0.098) loss_u loss_u 0.8750 (0.8598) acc_u 15.6250 (15.7812) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 392
confident_label rate tensor(0.5353, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 865
clean true:834
clean false:31
clean_rate:0.9641618497109826
noisy true:390
noisy false:361
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 751
epoch [174/200] batch [5/27] time 0.188 (0.181) data 0.111 (0.104) loss_x loss_x 0.5381 (0.6078) acc_x 84.3750 (85.6250) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/27] time 0.171 (0.179) data 0.093 (0.101) loss_x loss_x 0.5400 (0.5066) acc_x 87.5000 (87.5000) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [15/27] time 0.176 (0.176) data 0.099 (0.099) loss_x loss_x 0.3110 (0.5115) acc_x 93.7500 (86.8750) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/27] time 0.187 (0.177) data 0.109 (0.099) loss_x loss_x 0.6729 (0.5080) acc_x 81.2500 (86.8750) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [25/27] time 0.160 (0.176) data 0.082 (0.099) loss_x loss_x 0.5391 (0.5449) acc_x 84.3750 (85.7500) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/23] time 0.184 (0.175) data 0.107 (0.097) loss_u loss_u 0.8774 (0.8865) acc_u 9.3750 (13.1250) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/23] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.9048 (0.8748) acc_u 12.5000 (14.3750) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/23] time 0.186 (0.177) data 0.108 (0.099) loss_u loss_u 0.8062 (0.8623) acc_u 21.8750 (15.8333) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/23] time 0.166 (0.176) data 0.088 (0.098) loss_u loss_u 0.9028 (0.8637) acc_u 9.3750 (15.4688) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 389
confident_label rate tensor(0.5235, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 846
clean true:818
clean false:28
clean_rate:0.966903073286052
noisy true:409
noisy false:361
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 770
epoch [175/200] batch [5/26] time 0.169 (0.178) data 0.092 (0.100) loss_x loss_x 0.5757 (0.5835) acc_x 84.3750 (86.8750) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/26] time 0.168 (0.181) data 0.091 (0.103) loss_x loss_x 0.7983 (0.6226) acc_x 87.5000 (86.8750) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/26] time 0.171 (0.176) data 0.094 (0.098) loss_x loss_x 0.6836 (0.5755) acc_x 93.7500 (88.1250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/26] time 0.175 (0.177) data 0.098 (0.099) loss_x loss_x 0.7500 (0.6082) acc_x 87.5000 (87.5000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [25/26] time 0.186 (0.179) data 0.108 (0.101) loss_x loss_x 0.5181 (0.5954) acc_x 81.2500 (87.0000) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/24] time 0.192 (0.180) data 0.114 (0.102) loss_u loss_u 0.8472 (0.8592) acc_u 15.6250 (18.1250) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/24] time 0.171 (0.181) data 0.093 (0.103) loss_u loss_u 0.8799 (0.8459) acc_u 15.6250 (19.3750) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/24] time 0.169 (0.179) data 0.091 (0.101) loss_u loss_u 0.8159 (0.8624) acc_u 21.8750 (17.2917) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/24] time 0.171 (0.179) data 0.094 (0.101) loss_u loss_u 0.7798 (0.8550) acc_u 21.8750 (17.8125) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 384
confident_label rate tensor(0.5384, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 870
clean true:837
clean false:33
clean_rate:0.9620689655172414
noisy true:395
noisy false:351
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 746
epoch [176/200] batch [5/27] time 0.185 (0.196) data 0.107 (0.118) loss_x loss_x 0.8999 (0.6011) acc_x 87.5000 (85.0000) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/27] time 0.161 (0.184) data 0.084 (0.107) loss_x loss_x 0.7256 (0.6003) acc_x 81.2500 (85.3125) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/27] time 0.168 (0.184) data 0.091 (0.107) loss_x loss_x 0.6885 (0.6290) acc_x 78.1250 (83.5417) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/27] time 0.161 (0.179) data 0.084 (0.101) loss_x loss_x 0.7651 (0.6507) acc_x 81.2500 (82.9688) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [25/27] time 0.164 (0.176) data 0.087 (0.098) loss_x loss_x 0.2573 (0.5971) acc_x 96.8750 (84.8750) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/23] time 0.186 (0.176) data 0.109 (0.098) loss_u loss_u 0.8159 (0.8482) acc_u 18.7500 (18.1250) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/23] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.9102 (0.8591) acc_u 9.3750 (16.2500) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/23] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.8760 (0.8552) acc_u 12.5000 (16.6667) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/23] time 0.170 (0.177) data 0.093 (0.099) loss_u loss_u 0.9326 (0.8639) acc_u 6.2500 (15.9375) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 409
confident_label rate tensor(0.5384, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 870
clean true:837
clean false:33
clean_rate:0.9620689655172414
noisy true:370
noisy false:376
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 746
epoch [177/200] batch [5/27] time 0.165 (0.175) data 0.088 (0.097) loss_x loss_x 0.9365 (0.6341) acc_x 75.0000 (83.1250) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/27] time 0.183 (0.176) data 0.105 (0.098) loss_x loss_x 0.6714 (0.5739) acc_x 87.5000 (84.6875) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/27] time 0.171 (0.179) data 0.094 (0.101) loss_x loss_x 0.5903 (0.5509) acc_x 81.2500 (86.0417) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/27] time 0.183 (0.179) data 0.105 (0.101) loss_x loss_x 0.5024 (0.5218) acc_x 87.5000 (87.0312) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [25/27] time 0.169 (0.178) data 0.091 (0.100) loss_x loss_x 0.9717 (0.5328) acc_x 75.0000 (86.1250) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/23] time 0.169 (0.175) data 0.089 (0.098) loss_u loss_u 0.8496 (0.8500) acc_u 15.6250 (16.8750) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/23] time 0.184 (0.175) data 0.106 (0.098) loss_u loss_u 0.9468 (0.8452) acc_u 6.2500 (17.1875) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/23] time 0.183 (0.176) data 0.106 (0.098) loss_u loss_u 0.7910 (0.8443) acc_u 21.8750 (17.2917) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/23] time 0.183 (0.177) data 0.106 (0.099) loss_u loss_u 0.8276 (0.8495) acc_u 18.7500 (16.4062) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 404
confident_label rate tensor(0.5322, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 860
clean true:829
clean false:31
clean_rate:0.963953488372093
noisy true:383
noisy false:373
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 756
epoch [178/200] batch [5/26] time 0.190 (0.187) data 0.113 (0.109) loss_x loss_x 0.5815 (0.5903) acc_x 84.3750 (83.7500) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/26] time 0.195 (0.188) data 0.117 (0.110) loss_x loss_x 0.3020 (0.5830) acc_x 93.7500 (85.3125) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/26] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.2969 (0.5474) acc_x 90.6250 (86.0417) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/26] time 0.186 (0.187) data 0.109 (0.109) loss_x loss_x 0.4792 (0.5411) acc_x 90.6250 (86.7188) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [25/26] time 0.206 (0.187) data 0.128 (0.110) loss_x loss_x 0.5435 (0.5661) acc_x 81.2500 (85.8750) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/23] time 0.173 (0.186) data 0.095 (0.109) loss_u loss_u 0.8848 (0.8428) acc_u 12.5000 (16.8750) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/23] time 0.182 (0.186) data 0.104 (0.108) loss_u loss_u 0.8613 (0.8450) acc_u 12.5000 (16.5625) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/23] time 0.184 (0.186) data 0.107 (0.108) loss_u loss_u 0.7974 (0.8457) acc_u 18.7500 (16.4583) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/23] time 0.177 (0.185) data 0.097 (0.107) loss_u loss_u 0.8457 (0.8471) acc_u 15.6250 (17.0312) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 404
confident_label rate tensor(0.5285, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 854
clean true:821
clean false:33
clean_rate:0.9613583138173302
noisy true:391
noisy false:371
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 762
epoch [179/200] batch [5/26] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.2441 (0.6373) acc_x 96.8750 (86.8750) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/26] time 0.186 (0.189) data 0.109 (0.111) loss_x loss_x 0.6025 (0.6979) acc_x 84.3750 (84.0625) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/26] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.9248 (0.6563) acc_x 81.2500 (84.1667) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/26] time 0.188 (0.188) data 0.111 (0.110) loss_x loss_x 0.3491 (0.6133) acc_x 93.7500 (84.6875) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [25/26] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.3127 (0.5978) acc_x 87.5000 (85.8750) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/23] time 0.162 (0.184) data 0.085 (0.107) loss_u loss_u 0.9224 (0.9005) acc_u 9.3750 (8.7500) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/23] time 0.182 (0.183) data 0.104 (0.105) loss_u loss_u 0.8779 (0.8754) acc_u 12.5000 (13.4375) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/23] time 0.164 (0.182) data 0.086 (0.104) loss_u loss_u 0.8599 (0.8693) acc_u 15.6250 (14.3750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/23] time 0.192 (0.183) data 0.114 (0.105) loss_u loss_u 0.8643 (0.8710) acc_u 12.5000 (14.0625) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 393
confident_label rate tensor(0.5377, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 869
clean true:836
clean false:33
clean_rate:0.9620253164556962
noisy true:387
noisy false:360
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 747
epoch [180/200] batch [5/27] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.7676 (0.4600) acc_x 81.2500 (88.7500) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/27] time 0.172 (0.180) data 0.093 (0.103) loss_x loss_x 0.4146 (0.4343) acc_x 90.6250 (89.0625) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/27] time 0.186 (0.179) data 0.109 (0.102) loss_x loss_x 0.8281 (0.4431) acc_x 78.1250 (88.5417) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/27] time 0.178 (0.178) data 0.100 (0.100) loss_x loss_x 0.5591 (0.4442) acc_x 81.2500 (88.4375) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [25/27] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.5547 (0.4966) acc_x 90.6250 (87.5000) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/23] time 0.187 (0.179) data 0.109 (0.101) loss_u loss_u 0.7949 (0.8855) acc_u 25.0000 (13.1250) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/23] time 0.173 (0.180) data 0.094 (0.103) loss_u loss_u 0.8501 (0.8693) acc_u 18.7500 (14.3750) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/23] time 0.195 (0.180) data 0.117 (0.102) loss_u loss_u 0.8667 (0.8632) acc_u 15.6250 (15.6250) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/23] time 0.181 (0.181) data 0.103 (0.103) loss_u loss_u 0.8970 (0.8683) acc_u 12.5000 (15.0000) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 382
confident_label rate tensor(0.5390, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 871
clean true:838
clean false:33
clean_rate:0.9621125143513203
noisy true:396
noisy false:349
after delete: len(clean_dataset) 871
after delete: len(noisy_dataset) 745
epoch [181/200] batch [5/27] time 0.170 (0.176) data 0.091 (0.097) loss_x loss_x 0.5220 (0.5938) acc_x 84.3750 (86.2500) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/27] time 0.186 (0.175) data 0.108 (0.097) loss_x loss_x 0.8647 (0.5629) acc_x 78.1250 (87.5000) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/27] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.6040 (0.5246) acc_x 81.2500 (87.5000) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/27] time 0.174 (0.177) data 0.097 (0.099) loss_x loss_x 0.5615 (0.5438) acc_x 90.6250 (86.8750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [25/27] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 0.7339 (0.5598) acc_x 81.2500 (86.3750) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/23] time 0.165 (0.177) data 0.088 (0.099) loss_u loss_u 0.9180 (0.8421) acc_u 9.3750 (18.1250) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/23] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.9272 (0.8382) acc_u 9.3750 (18.7500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/23] time 0.164 (0.175) data 0.086 (0.097) loss_u loss_u 0.8486 (0.8435) acc_u 15.6250 (17.9167) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/23] time 0.174 (0.175) data 0.097 (0.097) loss_u loss_u 0.8496 (0.8494) acc_u 18.7500 (17.5000) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 403
confident_label rate tensor(0.5272, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 852
clean true:823
clean false:29
clean_rate:0.965962441314554
noisy true:390
noisy false:374
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 764
epoch [182/200] batch [5/26] time 0.181 (0.173) data 0.103 (0.096) loss_x loss_x 0.3501 (0.4756) acc_x 90.6250 (86.8750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/26] time 0.169 (0.176) data 0.092 (0.098) loss_x loss_x 0.3245 (0.4413) acc_x 90.6250 (88.4375) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/26] time 0.179 (0.177) data 0.101 (0.100) loss_x loss_x 0.3972 (0.4665) acc_x 84.3750 (87.7083) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/26] time 0.169 (0.176) data 0.092 (0.098) loss_x loss_x 0.4946 (0.4885) acc_x 87.5000 (87.5000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [25/26] time 0.170 (0.177) data 0.093 (0.099) loss_x loss_x 0.6426 (0.5007) acc_x 78.1250 (86.8750) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/23] time 0.171 (0.177) data 0.093 (0.099) loss_u loss_u 0.8599 (0.8977) acc_u 18.7500 (13.1250) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/23] time 0.211 (0.176) data 0.133 (0.099) loss_u loss_u 0.8682 (0.8715) acc_u 15.6250 (15.9375) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/23] time 0.163 (0.175) data 0.084 (0.097) loss_u loss_u 0.8486 (0.8600) acc_u 18.7500 (17.7083) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/23] time 0.173 (0.176) data 0.096 (0.098) loss_u loss_u 0.7471 (0.8533) acc_u 25.0000 (17.8125) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 389
confident_label rate tensor(0.5309, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 858
clean true:829
clean false:29
clean_rate:0.9662004662004662
noisy true:398
noisy false:360
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 758
epoch [183/200] batch [5/26] time 0.227 (0.200) data 0.149 (0.122) loss_x loss_x 0.2925 (0.4600) acc_x 90.6250 (87.5000) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/26] time 0.189 (0.192) data 0.111 (0.114) loss_x loss_x 0.5977 (0.4958) acc_x 87.5000 (86.5625) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/26] time 0.178 (0.185) data 0.100 (0.107) loss_x loss_x 0.2827 (0.5293) acc_x 90.6250 (85.6250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/26] time 0.169 (0.183) data 0.092 (0.105) loss_x loss_x 0.6333 (0.4955) acc_x 81.2500 (86.7188) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [25/26] time 0.171 (0.180) data 0.094 (0.102) loss_x loss_x 0.6641 (0.4939) acc_x 87.5000 (87.0000) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/23] time 0.168 (0.179) data 0.091 (0.101) loss_u loss_u 0.8105 (0.8380) acc_u 21.8750 (19.3750) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/23] time 0.168 (0.179) data 0.090 (0.101) loss_u loss_u 0.7954 (0.8271) acc_u 21.8750 (20.3125) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/23] time 0.163 (0.177) data 0.084 (0.099) loss_u loss_u 0.9609 (0.8565) acc_u 9.3750 (17.5000) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/23] time 0.178 (0.177) data 0.099 (0.099) loss_u loss_u 0.8369 (0.8523) acc_u 18.7500 (17.9688) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 402
confident_label rate tensor(0.5272, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 852
clean true:822
clean false:30
clean_rate:0.9647887323943662
noisy true:392
noisy false:372
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 764
epoch [184/200] batch [5/26] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.6523 (0.4947) acc_x 84.3750 (88.7500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/26] time 0.181 (0.183) data 0.103 (0.105) loss_x loss_x 0.2307 (0.4770) acc_x 93.7500 (88.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/26] time 0.169 (0.179) data 0.091 (0.102) loss_x loss_x 0.6987 (0.5055) acc_x 84.3750 (87.0833) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/26] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.5190 (0.4922) acc_x 84.3750 (87.1875) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [25/26] time 0.200 (0.179) data 0.121 (0.101) loss_x loss_x 0.6011 (0.5019) acc_x 87.5000 (87.3750) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/23] time 0.171 (0.177) data 0.093 (0.100) loss_u loss_u 0.8403 (0.8386) acc_u 18.7500 (19.3750) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/23] time 0.183 (0.178) data 0.105 (0.100) loss_u loss_u 0.8242 (0.8439) acc_u 18.7500 (18.7500) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/23] time 0.186 (0.178) data 0.107 (0.100) loss_u loss_u 0.8926 (0.8521) acc_u 12.5000 (17.7083) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/23] time 0.187 (0.178) data 0.109 (0.100) loss_u loss_u 0.8467 (0.8515) acc_u 15.6250 (17.0312) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 409
confident_label rate tensor(0.5248, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 848
clean true:815
clean false:33
clean_rate:0.9610849056603774
noisy true:392
noisy false:376
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 768
epoch [185/200] batch [5/26] time 0.195 (0.175) data 0.117 (0.097) loss_x loss_x 0.2576 (0.3824) acc_x 93.7500 (91.2500) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/26] time 0.192 (0.180) data 0.114 (0.103) loss_x loss_x 0.9829 (0.5046) acc_x 78.1250 (87.1875) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/26] time 0.167 (0.177) data 0.090 (0.100) loss_x loss_x 0.5747 (0.5321) acc_x 87.5000 (86.0417) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/26] time 0.169 (0.176) data 0.091 (0.098) loss_x loss_x 0.9058 (0.5794) acc_x 71.8750 (85.1562) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [25/26] time 0.183 (0.177) data 0.105 (0.099) loss_x loss_x 0.3865 (0.5759) acc_x 87.5000 (85.5000) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/24] time 0.173 (0.177) data 0.095 (0.099) loss_u loss_u 0.8096 (0.8517) acc_u 21.8750 (17.5000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/24] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.7222 (0.8495) acc_u 28.1250 (17.1875) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/24] time 0.171 (0.177) data 0.093 (0.099) loss_u loss_u 0.8462 (0.8493) acc_u 15.6250 (17.0833) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/24] time 0.196 (0.177) data 0.118 (0.100) loss_u loss_u 0.8145 (0.8492) acc_u 18.7500 (17.0312) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 384
confident_label rate tensor(0.5359, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 866
clean true:834
clean false:32
clean_rate:0.9630484988452656
noisy true:398
noisy false:352
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 750
epoch [186/200] batch [5/27] time 0.189 (0.178) data 0.111 (0.100) loss_x loss_x 0.4360 (0.5562) acc_x 90.6250 (85.0000) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/27] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.3430 (0.5503) acc_x 90.6250 (84.3750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/27] time 0.188 (0.176) data 0.111 (0.098) loss_x loss_x 0.1725 (0.5282) acc_x 96.8750 (85.0000) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/27] time 0.186 (0.177) data 0.108 (0.099) loss_x loss_x 0.2012 (0.5180) acc_x 93.7500 (85.0000) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [25/27] time 0.186 (0.179) data 0.108 (0.101) loss_x loss_x 0.5146 (0.5424) acc_x 84.3750 (85.2500) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/23] time 0.174 (0.177) data 0.096 (0.099) loss_u loss_u 0.7891 (0.8338) acc_u 25.0000 (20.0000) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/23] time 0.175 (0.178) data 0.098 (0.100) loss_u loss_u 0.9189 (0.8374) acc_u 9.3750 (18.7500) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/23] time 0.173 (0.177) data 0.095 (0.100) loss_u loss_u 0.8154 (0.8419) acc_u 18.7500 (18.1250) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/23] time 0.178 (0.178) data 0.100 (0.100) loss_u loss_u 0.8555 (0.8486) acc_u 15.6250 (17.5000) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 416
confident_label rate tensor(0.5248, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 848
clean true:819
clean false:29
clean_rate:0.9658018867924528
noisy true:381
noisy false:387
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 768
epoch [187/200] batch [5/26] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 0.3425 (0.5305) acc_x 87.5000 (86.2500) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/26] time 0.162 (0.179) data 0.084 (0.101) loss_x loss_x 0.4102 (0.4375) acc_x 87.5000 (88.7500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/26] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.5254 (0.4748) acc_x 90.6250 (88.1250) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/26] time 0.172 (0.174) data 0.094 (0.096) loss_x loss_x 0.5083 (0.4757) acc_x 87.5000 (87.9688) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [25/26] time 0.174 (0.175) data 0.097 (0.097) loss_x loss_x 0.4385 (0.4863) acc_x 84.3750 (87.7500) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/24] time 0.167 (0.173) data 0.089 (0.096) loss_u loss_u 0.9746 (0.8220) acc_u 3.1250 (20.6250) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/24] time 0.194 (0.175) data 0.116 (0.097) loss_u loss_u 0.8745 (0.8240) acc_u 15.6250 (20.9375) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/24] time 0.188 (0.176) data 0.110 (0.098) loss_u loss_u 0.7534 (0.8191) acc_u 31.2500 (21.4583) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/24] time 0.186 (0.177) data 0.109 (0.099) loss_u loss_u 0.9331 (0.8289) acc_u 9.3750 (20.1562) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 403
confident_label rate tensor(0.5278, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 853
clean true:822
clean false:31
clean_rate:0.9636576787807737
noisy true:391
noisy false:372
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 763
epoch [188/200] batch [5/26] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.2424 (0.5325) acc_x 93.7500 (85.0000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/26] time 0.220 (0.190) data 0.143 (0.112) loss_x loss_x 0.7017 (0.4969) acc_x 78.1250 (86.2500) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/26] time 0.189 (0.187) data 0.112 (0.110) loss_x loss_x 0.2407 (0.4922) acc_x 90.6250 (86.8750) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/26] time 0.186 (0.187) data 0.107 (0.109) loss_x loss_x 0.4941 (0.4794) acc_x 87.5000 (87.6562) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [25/26] time 0.180 (0.186) data 0.103 (0.109) loss_x loss_x 0.7437 (0.5086) acc_x 81.2500 (86.5000) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/23] time 0.182 (0.184) data 0.104 (0.106) loss_u loss_u 0.8867 (0.8782) acc_u 9.3750 (12.5000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/23] time 0.197 (0.184) data 0.120 (0.106) loss_u loss_u 0.8057 (0.8609) acc_u 25.0000 (15.6250) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/23] time 0.181 (0.184) data 0.103 (0.106) loss_u loss_u 0.8535 (0.8494) acc_u 18.7500 (17.0833) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/23] time 0.200 (0.183) data 0.123 (0.105) loss_u loss_u 0.8784 (0.8487) acc_u 15.6250 (17.3438) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 415
confident_label rate tensor(0.5149, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 832
clean true:804
clean false:28
clean_rate:0.9663461538461539
noisy true:397
noisy false:387
after delete: len(clean_dataset) 832
after delete: len(noisy_dataset) 784
epoch [189/200] batch [5/26] time 0.175 (0.168) data 0.096 (0.091) loss_x loss_x 0.7456 (0.5568) acc_x 78.1250 (85.6250) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/26] time 0.169 (0.171) data 0.091 (0.093) loss_x loss_x 0.7793 (0.5571) acc_x 78.1250 (85.3125) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/26] time 0.170 (0.173) data 0.093 (0.095) loss_x loss_x 0.4128 (0.5336) acc_x 87.5000 (86.2500) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/26] time 0.187 (0.176) data 0.109 (0.098) loss_x loss_x 0.3738 (0.5422) acc_x 93.7500 (85.6250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [25/26] time 0.180 (0.175) data 0.103 (0.097) loss_x loss_x 0.5562 (0.5510) acc_x 81.2500 (85.1250) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/24] time 0.188 (0.177) data 0.110 (0.099) loss_u loss_u 0.7324 (0.8196) acc_u 31.2500 (20.6250) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/24] time 0.179 (0.178) data 0.101 (0.100) loss_u loss_u 0.7275 (0.8177) acc_u 28.1250 (21.2500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/24] time 0.171 (0.177) data 0.093 (0.099) loss_u loss_u 0.9019 (0.8174) acc_u 9.3750 (20.8333) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/24] time 0.177 (0.177) data 0.099 (0.099) loss_u loss_u 0.8848 (0.8250) acc_u 9.3750 (19.6875) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 407
confident_label rate tensor(0.5266, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 851
clean true:821
clean false:30
clean_rate:0.9647473560517039
noisy true:388
noisy false:377
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 765
epoch [190/200] batch [5/26] time 0.174 (0.178) data 0.096 (0.100) loss_x loss_x 0.5425 (0.5148) acc_x 87.5000 (86.2500) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/26] time 0.161 (0.179) data 0.084 (0.101) loss_x loss_x 0.4653 (0.5371) acc_x 78.1250 (85.3125) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/26] time 0.178 (0.178) data 0.099 (0.100) loss_x loss_x 0.2844 (0.5560) acc_x 96.8750 (86.0417) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/26] time 0.173 (0.178) data 0.096 (0.100) loss_x loss_x 0.4207 (0.5452) acc_x 81.2500 (85.6250) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [25/26] time 0.170 (0.178) data 0.092 (0.101) loss_x loss_x 0.6689 (0.5130) acc_x 81.2500 (86.6250) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/23] time 0.182 (0.178) data 0.104 (0.100) loss_u loss_u 0.8774 (0.8182) acc_u 15.6250 (21.2500) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/23] time 0.185 (0.178) data 0.108 (0.100) loss_u loss_u 0.8975 (0.8419) acc_u 9.3750 (17.8125) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/23] time 0.172 (0.178) data 0.095 (0.100) loss_u loss_u 0.9092 (0.8468) acc_u 9.3750 (16.8750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/23] time 0.171 (0.177) data 0.093 (0.099) loss_u loss_u 0.7749 (0.8418) acc_u 25.0000 (17.9688) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 414
confident_label rate tensor(0.5161, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 834
clean true:805
clean false:29
clean_rate:0.9652278177458034
noisy true:397
noisy false:385
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 782
epoch [191/200] batch [5/26] time 0.183 (0.185) data 0.105 (0.108) loss_x loss_x 0.7241 (0.6090) acc_x 81.2500 (83.1250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/26] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 0.8438 (0.6056) acc_x 75.0000 (83.1250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/26] time 0.187 (0.185) data 0.110 (0.107) loss_x loss_x 0.7847 (0.6314) acc_x 87.5000 (83.5417) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/26] time 0.185 (0.185) data 0.106 (0.107) loss_x loss_x 0.2598 (0.6160) acc_x 90.6250 (84.0625) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [25/26] time 0.175 (0.184) data 0.098 (0.107) loss_x loss_x 0.3032 (0.5846) acc_x 87.5000 (84.6250) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/24] time 0.185 (0.184) data 0.106 (0.106) loss_u loss_u 0.7271 (0.8184) acc_u 31.2500 (21.8750) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/24] time 0.188 (0.183) data 0.110 (0.106) loss_u loss_u 0.8447 (0.8335) acc_u 15.6250 (19.3750) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/24] time 0.198 (0.184) data 0.120 (0.106) loss_u loss_u 0.7603 (0.8303) acc_u 28.1250 (20.0000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/24] time 0.182 (0.183) data 0.103 (0.105) loss_u loss_u 0.8042 (0.8253) acc_u 25.0000 (20.3125) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 419
confident_label rate tensor(0.5322, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 860
clean true:823
clean false:37
clean_rate:0.9569767441860465
noisy true:374
noisy false:382
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 756
epoch [192/200] batch [5/26] time 0.164 (0.167) data 0.087 (0.090) loss_x loss_x 0.4062 (0.4448) acc_x 90.6250 (89.3750) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/26] time 0.184 (0.171) data 0.105 (0.094) loss_x loss_x 0.4946 (0.5292) acc_x 84.3750 (86.5625) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/26] time 0.160 (0.169) data 0.082 (0.091) loss_x loss_x 0.4890 (0.5194) acc_x 87.5000 (86.6667) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/26] time 0.171 (0.172) data 0.094 (0.094) loss_x loss_x 0.9390 (0.5666) acc_x 78.1250 (85.9375) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [25/26] time 0.187 (0.173) data 0.110 (0.095) loss_x loss_x 0.7544 (0.5646) acc_x 75.0000 (85.7500) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/23] time 0.171 (0.173) data 0.092 (0.095) loss_u loss_u 0.8228 (0.8799) acc_u 25.0000 (14.3750) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/23] time 0.177 (0.173) data 0.099 (0.095) loss_u loss_u 0.7871 (0.8600) acc_u 25.0000 (15.9375) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/23] time 0.186 (0.174) data 0.107 (0.097) loss_u loss_u 0.9165 (0.8633) acc_u 9.3750 (15.2083) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/23] time 0.182 (0.175) data 0.104 (0.097) loss_u loss_u 0.9165 (0.8659) acc_u 9.3750 (14.8438) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 415
confident_label rate tensor(0.5291, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 855
clean true:819
clean false:36
clean_rate:0.9578947368421052
noisy true:382
noisy false:379
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 761
epoch [193/200] batch [5/26] time 0.181 (0.183) data 0.103 (0.106) loss_x loss_x 0.3315 (0.4906) acc_x 90.6250 (88.7500) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/26] time 0.167 (0.176) data 0.089 (0.098) loss_x loss_x 0.3689 (0.5327) acc_x 87.5000 (86.2500) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/26] time 0.179 (0.176) data 0.101 (0.099) loss_x loss_x 0.7476 (0.5683) acc_x 71.8750 (85.2083) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/26] time 0.178 (0.175) data 0.099 (0.098) loss_x loss_x 0.7056 (0.5812) acc_x 81.2500 (84.6875) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [25/26] time 0.171 (0.176) data 0.093 (0.099) loss_x loss_x 1.1094 (0.5796) acc_x 75.0000 (84.6250) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/23] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.7964 (0.8455) acc_u 21.8750 (18.1250) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/23] time 0.172 (0.177) data 0.094 (0.099) loss_u loss_u 0.8618 (0.8552) acc_u 15.6250 (16.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/23] time 0.176 (0.176) data 0.098 (0.099) loss_u loss_u 0.7373 (0.8465) acc_u 28.1250 (17.7083) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/23] time 0.171 (0.177) data 0.093 (0.099) loss_u loss_u 0.9082 (0.8564) acc_u 12.5000 (16.5625) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 404
confident_label rate tensor(0.5340, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 863
clean true:831
clean false:32
clean_rate:0.9629200463499421
noisy true:381
noisy false:372
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 753
epoch [194/200] batch [5/26] time 0.186 (0.187) data 0.108 (0.109) loss_x loss_x 0.4355 (0.4423) acc_x 93.7500 (89.3750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/26] time 0.185 (0.186) data 0.108 (0.108) loss_x loss_x 0.7256 (0.5003) acc_x 81.2500 (87.8125) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/26] time 0.180 (0.186) data 0.103 (0.108) loss_x loss_x 0.6582 (0.5020) acc_x 78.1250 (86.8750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/26] time 0.167 (0.185) data 0.090 (0.108) loss_x loss_x 0.5859 (0.5000) acc_x 81.2500 (86.2500) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [25/26] time 0.190 (0.184) data 0.113 (0.106) loss_x loss_x 0.3169 (0.4907) acc_x 90.6250 (86.3750) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/23] time 0.176 (0.182) data 0.098 (0.105) loss_u loss_u 0.7837 (0.8593) acc_u 25.0000 (17.5000) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/23] time 0.177 (0.181) data 0.098 (0.104) loss_u loss_u 0.8301 (0.8707) acc_u 15.6250 (15.0000) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/23] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8501 (0.8708) acc_u 18.7500 (15.2083) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/23] time 0.172 (0.181) data 0.095 (0.104) loss_u loss_u 0.8789 (0.8666) acc_u 15.6250 (15.7812) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 389
confident_label rate tensor(0.5303, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 857
clean true:828
clean false:29
clean_rate:0.9661610268378062
noisy true:399
noisy false:360
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 759
epoch [195/200] batch [5/26] time 0.179 (0.170) data 0.101 (0.093) loss_x loss_x 0.7139 (0.5756) acc_x 84.3750 (84.3750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/26] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.3464 (0.5364) acc_x 93.7500 (85.3125) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/26] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.4900 (0.4909) acc_x 90.6250 (86.8750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/26] time 0.161 (0.179) data 0.083 (0.101) loss_x loss_x 0.7192 (0.5649) acc_x 87.5000 (85.4688) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [25/26] time 0.168 (0.178) data 0.091 (0.100) loss_x loss_x 0.3638 (0.5345) acc_x 96.8750 (87.0000) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/23] time 0.173 (0.176) data 0.095 (0.098) loss_u loss_u 0.8936 (0.8776) acc_u 9.3750 (12.5000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/23] time 0.176 (0.177) data 0.098 (0.099) loss_u loss_u 0.7876 (0.8704) acc_u 25.0000 (14.0625) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/23] time 0.170 (0.176) data 0.092 (0.099) loss_u loss_u 0.9111 (0.8665) acc_u 9.3750 (14.3750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/23] time 0.186 (0.177) data 0.107 (0.099) loss_u loss_u 0.7710 (0.8531) acc_u 28.1250 (15.9375) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 400
confident_label rate tensor(0.5297, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 856
clean true:824
clean false:32
clean_rate:0.9626168224299065
noisy true:392
noisy false:368
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 760
epoch [196/200] batch [5/26] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.6021 (0.5009) acc_x 78.1250 (85.6250) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/26] time 0.182 (0.175) data 0.104 (0.098) loss_x loss_x 0.3486 (0.4882) acc_x 87.5000 (86.2500) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/26] time 0.183 (0.178) data 0.106 (0.100) loss_x loss_x 0.6533 (0.5136) acc_x 84.3750 (85.6250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/26] time 0.185 (0.180) data 0.107 (0.102) loss_x loss_x 0.4207 (0.4938) acc_x 84.3750 (85.6250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [25/26] time 0.185 (0.180) data 0.108 (0.102) loss_x loss_x 0.2213 (0.4868) acc_x 93.7500 (86.6250) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/23] time 0.189 (0.179) data 0.109 (0.102) loss_u loss_u 0.9067 (0.8907) acc_u 9.3750 (13.1250) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/23] time 0.173 (0.179) data 0.094 (0.101) loss_u loss_u 0.7275 (0.8594) acc_u 28.1250 (15.6250) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/23] time 0.170 (0.179) data 0.092 (0.101) loss_u loss_u 0.9131 (0.8548) acc_u 9.3750 (16.2500) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/23] time 0.182 (0.179) data 0.104 (0.101) loss_u loss_u 0.8027 (0.8518) acc_u 31.2500 (17.1875) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 399
confident_label rate tensor(0.5303, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 857
clean true:824
clean false:33
clean_rate:0.9614935822637106
noisy true:393
noisy false:366
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 759
epoch [197/200] batch [5/26] time 0.179 (0.172) data 0.101 (0.094) loss_x loss_x 0.3606 (0.6065) acc_x 96.8750 (88.1250) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/26] time 0.182 (0.179) data 0.104 (0.101) loss_x loss_x 0.2913 (0.5970) acc_x 90.6250 (87.1875) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/26] time 0.176 (0.181) data 0.098 (0.103) loss_x loss_x 0.9917 (0.6025) acc_x 75.0000 (86.0417) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/26] time 0.184 (0.180) data 0.106 (0.103) loss_x loss_x 0.4131 (0.5906) acc_x 87.5000 (85.4688) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [25/26] time 0.184 (0.181) data 0.106 (0.103) loss_x loss_x 0.8418 (0.5968) acc_x 81.2500 (85.5000) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/23] time 0.173 (0.180) data 0.096 (0.102) loss_u loss_u 0.8394 (0.8508) acc_u 18.7500 (15.0000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/23] time 0.176 (0.180) data 0.098 (0.103) loss_u loss_u 0.8408 (0.8424) acc_u 18.7500 (17.8125) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/23] time 0.175 (0.180) data 0.097 (0.102) loss_u loss_u 0.9077 (0.8553) acc_u 9.3750 (16.0417) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/23] time 0.168 (0.179) data 0.091 (0.101) loss_u loss_u 0.8442 (0.8499) acc_u 18.7500 (16.8750) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 431
confident_label rate tensor(0.5179, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 837
clean true:805
clean false:32
clean_rate:0.961768219832736
noisy true:380
noisy false:399
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 779
epoch [198/200] batch [5/26] time 0.181 (0.168) data 0.104 (0.091) loss_x loss_x 0.2585 (0.4584) acc_x 96.8750 (88.1250) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/26] time 0.183 (0.178) data 0.105 (0.100) loss_x loss_x 0.5781 (0.5343) acc_x 87.5000 (86.5625) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/26] time 0.176 (0.179) data 0.098 (0.102) loss_x loss_x 0.4399 (0.5537) acc_x 90.6250 (86.4583) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/26] time 0.175 (0.179) data 0.097 (0.101) loss_x loss_x 0.2166 (0.5262) acc_x 93.7500 (86.7188) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [25/26] time 0.178 (0.178) data 0.100 (0.101) loss_x loss_x 0.2971 (0.5301) acc_x 96.8750 (86.8750) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/24] time 0.175 (0.178) data 0.097 (0.101) loss_u loss_u 0.8130 (0.8291) acc_u 21.8750 (18.7500) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/24] time 0.170 (0.177) data 0.092 (0.100) loss_u loss_u 0.9292 (0.8279) acc_u 9.3750 (19.0625) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/24] time 0.180 (0.177) data 0.102 (0.099) loss_u loss_u 0.8984 (0.8368) acc_u 12.5000 (17.9167) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/24] time 0.186 (0.178) data 0.108 (0.100) loss_u loss_u 0.8320 (0.8245) acc_u 25.0000 (20.0000) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 388
confident_label rate tensor(0.5278, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 853
clean true:824
clean false:29
clean_rate:0.9660023446658851
noisy true:404
noisy false:359
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 763
epoch [199/200] batch [5/26] time 0.177 (0.169) data 0.099 (0.091) loss_x loss_x 0.6772 (0.6408) acc_x 81.2500 (78.1250) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/26] time 0.183 (0.176) data 0.105 (0.098) loss_x loss_x 0.9595 (0.6548) acc_x 84.3750 (81.5625) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/26] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 0.5137 (0.6099) acc_x 87.5000 (83.5417) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/26] time 0.234 (0.184) data 0.156 (0.107) loss_x loss_x 0.5928 (0.5937) acc_x 81.2500 (83.7500) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [25/26] time 0.198 (0.190) data 0.121 (0.112) loss_x loss_x 0.6533 (0.5702) acc_x 87.5000 (84.8750) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/23] time 0.177 (0.187) data 0.099 (0.110) loss_u loss_u 0.8828 (0.8393) acc_u 12.5000 (19.3750) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/23] time 0.192 (0.187) data 0.113 (0.109) loss_u loss_u 0.8369 (0.8461) acc_u 18.7500 (18.4375) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/23] time 0.176 (0.186) data 0.098 (0.108) loss_u loss_u 0.8252 (0.8551) acc_u 21.8750 (17.0833) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/23] time 0.176 (0.184) data 0.098 (0.106) loss_u loss_u 0.8477 (0.8558) acc_u 18.7500 (17.5000) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 404
confident_label rate tensor(0.5260, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 850
clean true:817
clean false:33
clean_rate:0.9611764705882353
noisy true:395
noisy false:371
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 766
epoch [200/200] batch [5/26] time 0.168 (0.165) data 0.091 (0.088) loss_x loss_x 0.6445 (0.5307) acc_x 78.1250 (85.6250) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/26] time 0.158 (0.164) data 0.080 (0.086) loss_x loss_x 0.5312 (0.4831) acc_x 81.2500 (86.8750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/26] time 0.159 (0.162) data 0.082 (0.085) loss_x loss_x 0.5205 (0.5189) acc_x 93.7500 (87.0833) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/26] time 0.174 (0.162) data 0.097 (0.085) loss_x loss_x 0.5273 (0.5376) acc_x 87.5000 (86.0938) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [25/26] time 0.157 (0.162) data 0.080 (0.085) loss_x loss_x 0.8110 (0.5748) acc_x 81.2500 (85.5000) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/23] time 0.159 (0.162) data 0.080 (0.084) loss_u loss_u 0.7886 (0.8404) acc_u 28.1250 (20.0000) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/23] time 0.159 (0.162) data 0.082 (0.084) loss_u loss_u 0.8330 (0.8326) acc_u 18.7500 (20.3125) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/23] time 0.164 (0.162) data 0.085 (0.084) loss_u loss_u 0.9077 (0.8362) acc_u 9.3750 (20.0000) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/23] time 0.161 (0.162) data 0.084 (0.085) loss_u loss_u 0.9067 (0.8435) acc_u 15.6250 (19.2188) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,772
* accuracy: 73.3%
* error: 26.7%
* macro_f1: 71.9%
Elapsed: 0:58:51
