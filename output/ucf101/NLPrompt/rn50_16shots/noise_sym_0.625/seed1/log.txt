***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.625/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.1281, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 207
clean true:189
clean false:18
clean_rate:0.9130434782608695
noisy true:323
noisy false:1086
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 1409
epoch [1/200] batch [5/6] time 0.197 (0.209) data 0.120 (0.110) loss_x loss_x 2.4766 (2.6504) acc_x 43.7500 (50.6250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/44] time 0.202 (0.202) data 0.124 (0.113) loss_u loss_u 0.9839 (0.9689) acc_u 0.0000 (6.2500) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [10/44] time 0.197 (0.200) data 0.118 (0.115) loss_u loss_u 0.9648 (0.9720) acc_u 12.5000 (5.9375) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [15/44] time 0.195 (0.200) data 0.116 (0.116) loss_u loss_u 0.9604 (0.9692) acc_u 6.2500 (7.0833) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [20/44] time 0.197 (0.199) data 0.119 (0.116) loss_u loss_u 0.9507 (0.9691) acc_u 12.5000 (7.0312) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [25/44] time 0.189 (0.197) data 0.111 (0.115) loss_u loss_u 0.9731 (0.9677) acc_u 9.3750 (7.7500) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [30/44] time 0.171 (0.195) data 0.093 (0.114) loss_u loss_u 0.9678 (0.9680) acc_u 3.1250 (7.6042) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [35/44] time 0.178 (0.192) data 0.100 (0.111) loss_u loss_u 0.9629 (0.9686) acc_u 21.8750 (7.8571) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [40/44] time 0.183 (0.191) data 0.104 (0.111) loss_u loss_u 0.9766 (0.9703) acc_u 6.2500 (7.2656) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1025
confident_label rate tensor(0.1442, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 233
clean true:225
clean false:8
clean_rate:0.9656652360515021
noisy true:366
noisy false:1017
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 1383
epoch [2/200] batch [5/7] time 0.176 (0.188) data 0.097 (0.110) loss_x loss_x 1.2266 (1.6006) acc_x 71.8750 (66.8750) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/43] time 0.189 (0.185) data 0.112 (0.108) loss_u loss_u 0.8789 (0.9321) acc_u 21.8750 (10.6250) lr 2.0000e-03 eta 0:00:07
epoch [2/200] batch [10/43] time 0.191 (0.186) data 0.113 (0.108) loss_u loss_u 0.9707 (0.9290) acc_u 3.1250 (10.0000) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [15/43] time 0.187 (0.186) data 0.109 (0.108) loss_u loss_u 0.9204 (0.9273) acc_u 12.5000 (10.0000) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [20/43] time 0.187 (0.187) data 0.110 (0.109) loss_u loss_u 0.9873 (0.9291) acc_u 0.0000 (9.6875) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [25/43] time 0.168 (0.185) data 0.090 (0.108) loss_u loss_u 0.9697 (0.9240) acc_u 3.1250 (10.2500) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [30/43] time 0.166 (0.184) data 0.088 (0.106) loss_u loss_u 0.9883 (0.9254) acc_u 0.0000 (10.0000) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [35/43] time 0.164 (0.181) data 0.085 (0.104) loss_u loss_u 0.9482 (0.9287) acc_u 6.2500 (9.5536) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [40/43] time 0.172 (0.180) data 0.094 (0.103) loss_u loss_u 0.9331 (0.9293) acc_u 9.3750 (9.4531) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 822
confident_label rate tensor(0.1999, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 323
clean true:318
clean false:5
clean_rate:0.9845201238390093
noisy true:476
noisy false:817
after delete: len(clean_dataset) 323
after delete: len(noisy_dataset) 1293
epoch [3/200] batch [5/10] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 1.6631 (1.4020) acc_x 53.1250 (63.1250) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [10/10] time 0.186 (0.187) data 0.107 (0.110) loss_x loss_x 0.9653 (1.2443) acc_x 78.1250 (70.6250) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/40] time 0.189 (0.188) data 0.111 (0.110) loss_u loss_u 0.9600 (0.9436) acc_u 6.2500 (5.6250) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [10/40] time 0.177 (0.189) data 0.098 (0.111) loss_u loss_u 0.9365 (0.9464) acc_u 6.2500 (6.2500) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [15/40] time 0.177 (0.185) data 0.100 (0.108) loss_u loss_u 0.9019 (0.9386) acc_u 18.7500 (8.1250) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [20/40] time 0.186 (0.184) data 0.109 (0.106) loss_u loss_u 0.9800 (0.9373) acc_u 3.1250 (7.8125) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [25/40] time 0.159 (0.181) data 0.081 (0.103) loss_u loss_u 0.9619 (0.9397) acc_u 6.2500 (7.5000) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [30/40] time 0.180 (0.180) data 0.102 (0.102) loss_u loss_u 0.9668 (0.9424) acc_u 3.1250 (7.1875) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [35/40] time 0.178 (0.180) data 0.101 (0.102) loss_u loss_u 0.9946 (0.9462) acc_u 0.0000 (6.8750) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [40/40] time 0.191 (0.180) data 0.113 (0.103) loss_u loss_u 0.9331 (0.9462) acc_u 12.5000 (7.0312) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 772
confident_label rate tensor(0.2098, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 339
clean true:336
clean false:3
clean_rate:0.9911504424778761
noisy true:508
noisy false:769
after delete: len(clean_dataset) 339
after delete: len(noisy_dataset) 1277
epoch [4/200] batch [5/10] time 0.194 (0.191) data 0.116 (0.113) loss_x loss_x 1.3477 (1.2192) acc_x 62.5000 (67.5000) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [10/10] time 0.188 (0.193) data 0.110 (0.116) loss_x loss_x 1.7168 (1.2669) acc_x 59.3750 (68.4375) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/39] time 0.214 (0.194) data 0.135 (0.117) loss_u loss_u 0.9565 (0.9489) acc_u 6.2500 (7.5000) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [10/39] time 0.182 (0.193) data 0.105 (0.115) loss_u loss_u 0.9375 (0.9538) acc_u 6.2500 (5.9375) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [15/39] time 0.186 (0.191) data 0.109 (0.112) loss_u loss_u 0.9819 (0.9564) acc_u 0.0000 (5.4167) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [20/39] time 0.184 (0.190) data 0.106 (0.112) loss_u loss_u 0.9458 (0.9531) acc_u 9.3750 (6.0938) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [25/39] time 0.187 (0.189) data 0.109 (0.111) loss_u loss_u 0.8867 (0.9500) acc_u 12.5000 (6.2500) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [30/39] time 0.185 (0.190) data 0.107 (0.112) loss_u loss_u 0.9312 (0.9493) acc_u 12.5000 (6.5625) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [35/39] time 0.167 (0.189) data 0.090 (0.110) loss_u loss_u 0.9531 (0.9480) acc_u 6.2500 (6.8750) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 770
confident_label rate tensor(0.2085, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 337
clean true:331
clean false:6
clean_rate:0.9821958456973294
noisy true:515
noisy false:764
after delete: len(clean_dataset) 337
after delete: len(noisy_dataset) 1279
epoch [5/200] batch [5/10] time 0.185 (0.190) data 0.108 (0.113) loss_x loss_x 1.2793 (1.1571) acc_x 68.7500 (76.2500) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [10/10] time 0.176 (0.181) data 0.098 (0.103) loss_x loss_x 0.8882 (1.0556) acc_x 71.8750 (74.3750) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/39] time 0.180 (0.180) data 0.102 (0.102) loss_u loss_u 0.9648 (0.9412) acc_u 3.1250 (6.2500) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [10/39] time 0.187 (0.182) data 0.108 (0.104) loss_u loss_u 0.9458 (0.9503) acc_u 6.2500 (5.3125) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [15/39] time 0.191 (0.184) data 0.113 (0.106) loss_u loss_u 0.9180 (0.9461) acc_u 9.3750 (6.0417) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [20/39] time 0.187 (0.185) data 0.104 (0.106) loss_u loss_u 0.9258 (0.9439) acc_u 9.3750 (6.5625) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [25/39] time 0.178 (0.185) data 0.099 (0.106) loss_u loss_u 0.9453 (0.9405) acc_u 6.2500 (6.8750) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [30/39] time 0.161 (0.184) data 0.083 (0.106) loss_u loss_u 0.9902 (0.9438) acc_u 0.0000 (6.6667) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [35/39] time 0.177 (0.184) data 0.099 (0.105) loss_u loss_u 0.9473 (0.9431) acc_u 6.2500 (6.7857) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 777
confident_label rate tensor(0.1986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 321
clean true:318
clean false:3
clean_rate:0.9906542056074766
noisy true:521
noisy false:774
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 1295
epoch [6/200] batch [5/10] time 0.183 (0.186) data 0.105 (0.109) loss_x loss_x 0.9526 (0.9207) acc_x 78.1250 (76.2500) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [10/10] time 0.188 (0.191) data 0.110 (0.113) loss_x loss_x 1.4287 (0.9206) acc_x 68.7500 (75.0000) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/40] time 0.186 (0.189) data 0.109 (0.112) loss_u loss_u 0.8960 (0.9301) acc_u 9.3750 (7.5000) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [10/40] time 0.189 (0.189) data 0.111 (0.111) loss_u loss_u 0.9634 (0.9403) acc_u 6.2500 (6.8750) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [15/40] time 0.171 (0.185) data 0.092 (0.107) loss_u loss_u 0.8545 (0.9350) acc_u 15.6250 (7.9167) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [20/40] time 0.162 (0.182) data 0.083 (0.103) loss_u loss_u 0.9336 (0.9351) acc_u 9.3750 (7.8125) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [25/40] time 0.183 (0.181) data 0.105 (0.102) loss_u loss_u 0.9419 (0.9312) acc_u 6.2500 (8.3750) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [30/40] time 0.180 (0.181) data 0.103 (0.102) loss_u loss_u 0.9507 (0.9318) acc_u 6.2500 (8.5417) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [35/40] time 0.176 (0.180) data 0.098 (0.102) loss_u loss_u 0.9165 (0.9344) acc_u 12.5000 (8.3929) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [40/40] time 0.174 (0.180) data 0.096 (0.102) loss_u loss_u 0.9067 (0.9333) acc_u 15.6250 (8.4375) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 747
confident_label rate tensor(0.2147, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 347
clean true:342
clean false:5
clean_rate:0.9855907780979827
noisy true:527
noisy false:742
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1269
epoch [7/200] batch [5/10] time 0.161 (0.182) data 0.083 (0.105) loss_x loss_x 1.1631 (0.8998) acc_x 75.0000 (76.2500) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [10/10] time 0.175 (0.173) data 0.098 (0.095) loss_x loss_x 1.2070 (1.0161) acc_x 68.7500 (73.7500) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/39] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.9307 (0.9495) acc_u 6.2500 (5.6250) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [10/39] time 0.171 (0.176) data 0.094 (0.098) loss_u loss_u 0.9668 (0.9433) acc_u 6.2500 (5.9375) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [15/39] time 0.179 (0.176) data 0.102 (0.098) loss_u loss_u 0.8550 (0.9386) acc_u 18.7500 (6.6667) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [20/39] time 0.186 (0.178) data 0.107 (0.100) loss_u loss_u 0.9170 (0.9387) acc_u 9.3750 (7.1875) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [25/39] time 0.185 (0.179) data 0.106 (0.101) loss_u loss_u 0.9302 (0.9396) acc_u 9.3750 (6.8750) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [30/39] time 0.184 (0.180) data 0.106 (0.102) loss_u loss_u 0.9346 (0.9340) acc_u 6.2500 (7.5000) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [35/39] time 0.185 (0.180) data 0.106 (0.102) loss_u loss_u 0.9663 (0.9391) acc_u 3.1250 (7.0536) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 727
confident_label rate tensor(0.2166, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 350
clean true:347
clean false:3
clean_rate:0.9914285714285714
noisy true:542
noisy false:724
after delete: len(clean_dataset) 350
after delete: len(noisy_dataset) 1266
epoch [8/200] batch [5/10] time 0.187 (0.183) data 0.109 (0.105) loss_x loss_x 1.0420 (0.9576) acc_x 75.0000 (75.0000) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [10/10] time 0.162 (0.172) data 0.084 (0.095) loss_x loss_x 1.5273 (1.0693) acc_x 62.5000 (73.7500) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/39] time 0.162 (0.170) data 0.085 (0.092) loss_u loss_u 0.9551 (0.9253) acc_u 6.2500 (8.1250) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [10/39] time 0.173 (0.171) data 0.094 (0.093) loss_u loss_u 0.9443 (0.9269) acc_u 6.2500 (7.8125) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [15/39] time 0.200 (0.174) data 0.122 (0.096) loss_u loss_u 0.9678 (0.9408) acc_u 6.2500 (6.6667) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [20/39] time 0.162 (0.171) data 0.084 (0.093) loss_u loss_u 0.9253 (0.9405) acc_u 12.5000 (7.3438) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [25/39] time 0.184 (0.173) data 0.105 (0.095) loss_u loss_u 0.9639 (0.9421) acc_u 3.1250 (7.0000) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [30/39] time 0.163 (0.172) data 0.085 (0.094) loss_u loss_u 0.9756 (0.9443) acc_u 3.1250 (6.6667) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [35/39] time 0.184 (0.171) data 0.106 (0.093) loss_u loss_u 0.9175 (0.9427) acc_u 12.5000 (7.0536) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 740
confident_label rate tensor(0.2184, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 353
clean true:349
clean false:4
clean_rate:0.9886685552407932
noisy true:527
noisy false:736
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1263
epoch [9/200] batch [5/11] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 1.6045 (1.0933) acc_x 71.8750 (72.5000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [10/11] time 0.187 (0.187) data 0.109 (0.110) loss_x loss_x 0.9443 (1.0469) acc_x 68.7500 (72.5000) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/39] time 0.190 (0.187) data 0.112 (0.110) loss_u loss_u 0.9912 (0.9479) acc_u 3.1250 (6.2500) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [10/39] time 0.173 (0.188) data 0.095 (0.111) loss_u loss_u 0.9956 (0.9586) acc_u 0.0000 (4.3750) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [15/39] time 0.180 (0.186) data 0.102 (0.108) loss_u loss_u 0.9307 (0.9502) acc_u 9.3750 (6.2500) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [20/39] time 0.184 (0.185) data 0.105 (0.108) loss_u loss_u 0.9370 (0.9462) acc_u 6.2500 (6.5625) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [25/39] time 0.183 (0.185) data 0.105 (0.107) loss_u loss_u 0.9526 (0.9445) acc_u 3.1250 (6.6250) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [30/39] time 0.185 (0.185) data 0.107 (0.107) loss_u loss_u 0.9282 (0.9447) acc_u 9.3750 (6.4583) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [35/39] time 0.180 (0.185) data 0.101 (0.107) loss_u loss_u 0.9287 (0.9408) acc_u 9.3750 (6.7857) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 714
confident_label rate tensor(0.2222, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 359
clean true:354
clean false:5
clean_rate:0.9860724233983287
noisy true:548
noisy false:709
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1257
epoch [10/200] batch [5/11] time 0.184 (0.182) data 0.105 (0.104) loss_x loss_x 0.9453 (1.0107) acc_x 78.1250 (78.1250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/11] time 0.172 (0.181) data 0.095 (0.103) loss_x loss_x 0.7207 (0.9683) acc_x 81.2500 (77.8125) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/39] time 0.176 (0.175) data 0.098 (0.097) loss_u loss_u 0.9404 (0.9455) acc_u 6.2500 (6.8750) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [10/39] time 0.178 (0.177) data 0.100 (0.099) loss_u loss_u 0.9468 (0.9440) acc_u 6.2500 (7.1875) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [15/39] time 0.168 (0.179) data 0.090 (0.101) loss_u loss_u 0.9287 (0.9440) acc_u 6.2500 (6.4583) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [20/39] time 0.176 (0.178) data 0.097 (0.100) loss_u loss_u 0.8950 (0.9428) acc_u 15.6250 (6.7188) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [25/39] time 0.188 (0.180) data 0.111 (0.102) loss_u loss_u 0.9575 (0.9434) acc_u 6.2500 (7.0000) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [30/39] time 0.177 (0.180) data 0.099 (0.102) loss_u loss_u 0.9224 (0.9467) acc_u 12.5000 (6.4583) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [35/39] time 0.186 (0.179) data 0.107 (0.101) loss_u loss_u 0.9360 (0.9456) acc_u 9.3750 (6.6964) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 731
confident_label rate tensor(0.2215, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 358
clean true:353
clean false:5
clean_rate:0.9860335195530726
noisy true:532
noisy false:726
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1258
epoch [11/200] batch [5/11] time 0.184 (0.187) data 0.106 (0.109) loss_x loss_x 1.5029 (1.1750) acc_x 65.6250 (73.7500) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [10/11] time 0.178 (0.185) data 0.101 (0.108) loss_x loss_x 0.8950 (1.0116) acc_x 75.0000 (75.9375) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/39] time 0.166 (0.182) data 0.087 (0.104) loss_u loss_u 0.9155 (0.9397) acc_u 12.5000 (7.5000) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [10/39] time 0.178 (0.181) data 0.101 (0.104) loss_u loss_u 0.9297 (0.9431) acc_u 6.2500 (6.5625) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [15/39] time 0.176 (0.179) data 0.097 (0.101) loss_u loss_u 0.9292 (0.9425) acc_u 6.2500 (6.6667) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [20/39] time 0.168 (0.178) data 0.090 (0.100) loss_u loss_u 0.9360 (0.9447) acc_u 9.3750 (6.7188) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [25/39] time 0.176 (0.177) data 0.099 (0.099) loss_u loss_u 0.9570 (0.9463) acc_u 6.2500 (6.7500) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [30/39] time 0.178 (0.176) data 0.099 (0.099) loss_u loss_u 0.9243 (0.9444) acc_u 6.2500 (7.0833) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [35/39] time 0.187 (0.177) data 0.109 (0.099) loss_u loss_u 0.9688 (0.9455) acc_u 3.1250 (6.8750) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 726
confident_label rate tensor(0.2277, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 368
clean true:361
clean false:7
clean_rate:0.9809782608695652
noisy true:529
noisy false:719
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1248
epoch [12/200] batch [5/11] time 0.181 (0.186) data 0.103 (0.108) loss_x loss_x 1.0938 (1.0764) acc_x 75.0000 (70.6250) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [10/11] time 0.174 (0.182) data 0.096 (0.104) loss_x loss_x 1.0840 (0.9868) acc_x 68.7500 (74.6875) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/39] time 0.169 (0.181) data 0.092 (0.103) loss_u loss_u 0.9287 (0.9278) acc_u 9.3750 (7.5000) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [10/39] time 0.161 (0.176) data 0.084 (0.098) loss_u loss_u 0.9424 (0.9418) acc_u 9.3750 (6.8750) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [15/39] time 0.172 (0.176) data 0.094 (0.098) loss_u loss_u 0.8931 (0.9385) acc_u 15.6250 (7.2917) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [20/39] time 0.174 (0.176) data 0.096 (0.098) loss_u loss_u 0.9248 (0.9362) acc_u 9.3750 (7.6562) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [25/39] time 0.173 (0.175) data 0.096 (0.097) loss_u loss_u 0.9980 (0.9446) acc_u 0.0000 (6.7500) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [30/39] time 0.179 (0.175) data 0.101 (0.097) loss_u loss_u 0.9580 (0.9442) acc_u 3.1250 (6.5625) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [35/39] time 0.184 (0.176) data 0.106 (0.098) loss_u loss_u 0.8579 (0.9403) acc_u 15.6250 (7.0536) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 733
confident_label rate tensor(0.2209, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 357
clean true:352
clean false:5
clean_rate:0.9859943977591037
noisy true:531
noisy false:728
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1259
epoch [13/200] batch [5/11] time 0.185 (0.181) data 0.107 (0.104) loss_x loss_x 1.8545 (1.1031) acc_x 50.0000 (73.1250) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [10/11] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.8535 (1.0437) acc_x 78.1250 (74.3750) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/39] time 0.180 (0.179) data 0.103 (0.101) loss_u loss_u 0.9199 (0.9368) acc_u 12.5000 (8.1250) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [10/39] time 0.167 (0.175) data 0.089 (0.097) loss_u loss_u 0.9902 (0.9351) acc_u 0.0000 (8.1250) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [15/39] time 0.197 (0.177) data 0.119 (0.099) loss_u loss_u 0.9346 (0.9369) acc_u 9.3750 (7.9167) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [20/39] time 0.193 (0.178) data 0.115 (0.100) loss_u loss_u 0.9341 (0.9385) acc_u 9.3750 (7.6562) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [25/39] time 0.163 (0.176) data 0.085 (0.098) loss_u loss_u 0.9565 (0.9365) acc_u 3.1250 (7.8750) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [30/39] time 0.166 (0.176) data 0.088 (0.098) loss_u loss_u 0.9043 (0.9388) acc_u 9.3750 (7.5000) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [35/39] time 0.195 (0.177) data 0.117 (0.099) loss_u loss_u 0.9629 (0.9397) acc_u 6.2500 (7.3214) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 713
confident_label rate tensor(0.2265, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 366
clean true:361
clean false:5
clean_rate:0.9863387978142076
noisy true:542
noisy false:708
after delete: len(clean_dataset) 366
after delete: len(noisy_dataset) 1250
epoch [14/200] batch [5/11] time 0.271 (0.212) data 0.193 (0.134) loss_x loss_x 1.1602 (1.0277) acc_x 75.0000 (73.7500) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [10/11] time 0.168 (0.193) data 0.090 (0.115) loss_x loss_x 1.2939 (1.0125) acc_x 68.7500 (74.0625) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/39] time 0.164 (0.188) data 0.086 (0.110) loss_u loss_u 0.9521 (0.9483) acc_u 6.2500 (5.0000) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [10/39] time 0.173 (0.186) data 0.095 (0.108) loss_u loss_u 0.9116 (0.9363) acc_u 9.3750 (7.5000) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [15/39] time 0.175 (0.183) data 0.097 (0.105) loss_u loss_u 0.9009 (0.9355) acc_u 9.3750 (7.7083) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [20/39] time 0.163 (0.180) data 0.086 (0.103) loss_u loss_u 0.9263 (0.9399) acc_u 9.3750 (7.1875) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [25/39] time 0.170 (0.178) data 0.090 (0.100) loss_u loss_u 0.8486 (0.9364) acc_u 18.7500 (7.8750) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [30/39] time 0.175 (0.177) data 0.097 (0.099) loss_u loss_u 0.9458 (0.9364) acc_u 9.3750 (7.9167) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [35/39] time 0.172 (0.177) data 0.093 (0.099) loss_u loss_u 0.9346 (0.9366) acc_u 6.2500 (8.0357) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 688
confident_label rate tensor(0.2382, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 385
clean true:377
clean false:8
clean_rate:0.9792207792207792
noisy true:551
noisy false:680
after delete: len(clean_dataset) 385
after delete: len(noisy_dataset) 1231
epoch [15/200] batch [5/12] time 0.199 (0.192) data 0.120 (0.114) loss_x loss_x 0.9731 (0.9108) acc_x 75.0000 (77.5000) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [10/12] time 0.202 (0.193) data 0.124 (0.115) loss_x loss_x 1.0605 (0.9958) acc_x 68.7500 (75.0000) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/38] time 0.215 (0.191) data 0.136 (0.113) loss_u loss_u 0.9346 (0.9523) acc_u 9.3750 (6.2500) lr 1.9792e-03 eta 0:00:06
epoch [15/200] batch [10/38] time 0.190 (0.191) data 0.109 (0.113) loss_u loss_u 0.8535 (0.9331) acc_u 15.6250 (8.1250) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [15/38] time 0.164 (0.187) data 0.086 (0.109) loss_u loss_u 0.9312 (0.9249) acc_u 6.2500 (8.9583) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [20/38] time 0.187 (0.186) data 0.109 (0.107) loss_u loss_u 0.9014 (0.9279) acc_u 9.3750 (8.5938) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [25/38] time 0.186 (0.185) data 0.108 (0.107) loss_u loss_u 0.8535 (0.9298) acc_u 18.7500 (8.2500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [30/38] time 0.173 (0.184) data 0.094 (0.106) loss_u loss_u 0.9678 (0.9320) acc_u 6.2500 (8.2292) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [35/38] time 0.180 (0.183) data 0.101 (0.105) loss_u loss_u 0.9121 (0.9348) acc_u 9.3750 (7.7679) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 711
confident_label rate tensor(0.2265, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 366
clean true:359
clean false:7
clean_rate:0.9808743169398907
noisy true:546
noisy false:704
after delete: len(clean_dataset) 366
after delete: len(noisy_dataset) 1250
epoch [16/200] batch [5/11] time 0.189 (0.180) data 0.112 (0.102) loss_x loss_x 0.6245 (0.8467) acc_x 81.2500 (76.2500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [10/11] time 0.181 (0.178) data 0.103 (0.101) loss_x loss_x 0.9058 (0.8692) acc_x 71.8750 (76.5625) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/39] time 0.178 (0.179) data 0.100 (0.101) loss_u loss_u 0.9194 (0.9428) acc_u 9.3750 (7.5000) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [10/39] time 0.173 (0.179) data 0.095 (0.102) loss_u loss_u 0.9302 (0.9439) acc_u 6.2500 (6.8750) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [15/39] time 0.168 (0.178) data 0.090 (0.100) loss_u loss_u 0.9302 (0.9451) acc_u 9.3750 (6.4583) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [20/39] time 0.187 (0.177) data 0.109 (0.099) loss_u loss_u 0.9629 (0.9415) acc_u 6.2500 (7.1875) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [25/39] time 0.164 (0.177) data 0.086 (0.099) loss_u loss_u 0.9375 (0.9449) acc_u 6.2500 (6.6250) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [30/39] time 0.179 (0.176) data 0.101 (0.098) loss_u loss_u 0.9849 (0.9449) acc_u 0.0000 (6.7708) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [35/39] time 0.182 (0.177) data 0.103 (0.099) loss_u loss_u 0.9116 (0.9435) acc_u 6.2500 (6.8750) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 391
clean true:388
clean false:3
clean_rate:0.9923273657289002
noisy true:538
noisy false:687
after delete: len(clean_dataset) 391
after delete: len(noisy_dataset) 1225
epoch [17/200] batch [5/12] time 0.172 (0.172) data 0.094 (0.095) loss_x loss_x 1.2627 (1.0773) acc_x 71.8750 (70.0000) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [10/12] time 0.162 (0.175) data 0.084 (0.097) loss_x loss_x 0.4954 (0.9099) acc_x 84.3750 (75.6250) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/38] time 0.177 (0.174) data 0.100 (0.096) loss_u loss_u 0.9561 (0.9502) acc_u 3.1250 (5.6250) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/38] time 0.168 (0.175) data 0.091 (0.097) loss_u loss_u 0.9492 (0.9492) acc_u 6.2500 (5.9375) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [15/38] time 0.173 (0.176) data 0.095 (0.098) loss_u loss_u 0.9619 (0.9560) acc_u 6.2500 (5.6250) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [20/38] time 0.164 (0.174) data 0.085 (0.096) loss_u loss_u 0.9688 (0.9478) acc_u 3.1250 (6.5625) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [25/38] time 0.177 (0.175) data 0.099 (0.097) loss_u loss_u 0.9375 (0.9438) acc_u 12.5000 (7.1250) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [30/38] time 0.177 (0.175) data 0.099 (0.097) loss_u loss_u 0.9370 (0.9468) acc_u 9.3750 (6.7708) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [35/38] time 0.179 (0.175) data 0.101 (0.097) loss_u loss_u 0.9155 (0.9479) acc_u 12.5000 (6.6071) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 695
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 374
clean true:372
clean false:2
clean_rate:0.9946524064171123
noisy true:549
noisy false:693
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1242
epoch [18/200] batch [5/11] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.4512 (0.7988) acc_x 93.7500 (80.6250) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [10/11] time 0.178 (0.172) data 0.101 (0.095) loss_x loss_x 0.4136 (0.7594) acc_x 93.7500 (80.0000) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/38] time 0.179 (0.176) data 0.100 (0.098) loss_u loss_u 0.9551 (0.9509) acc_u 3.1250 (6.2500) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [10/38] time 0.183 (0.176) data 0.106 (0.098) loss_u loss_u 0.9624 (0.9538) acc_u 3.1250 (5.3125) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [15/38] time 0.182 (0.177) data 0.104 (0.099) loss_u loss_u 0.9380 (0.9492) acc_u 3.1250 (5.8333) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [20/38] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.9512 (0.9433) acc_u 6.2500 (6.2500) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [25/38] time 0.183 (0.175) data 0.106 (0.097) loss_u loss_u 0.9805 (0.9468) acc_u 0.0000 (5.7500) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [30/38] time 0.188 (0.176) data 0.111 (0.098) loss_u loss_u 0.9077 (0.9422) acc_u 9.3750 (6.1458) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [35/38] time 0.186 (0.177) data 0.108 (0.100) loss_u loss_u 0.9590 (0.9434) acc_u 3.1250 (6.0714) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 662
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 391
clean true:387
clean false:4
clean_rate:0.989769820971867
noisy true:567
noisy false:658
after delete: len(clean_dataset) 391
after delete: len(noisy_dataset) 1225
epoch [19/200] batch [5/12] time 0.173 (0.185) data 0.095 (0.107) loss_x loss_x 0.8086 (0.9288) acc_x 78.1250 (75.6250) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/12] time 0.189 (0.186) data 0.111 (0.108) loss_x loss_x 0.6406 (0.8964) acc_x 78.1250 (75.6250) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/38] time 0.185 (0.182) data 0.108 (0.104) loss_u loss_u 0.9512 (0.9386) acc_u 9.3750 (6.8750) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [10/38] time 0.178 (0.182) data 0.100 (0.105) loss_u loss_u 0.9385 (0.9387) acc_u 6.2500 (7.1875) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [15/38] time 0.185 (0.181) data 0.106 (0.103) loss_u loss_u 0.9980 (0.9461) acc_u 0.0000 (6.6667) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [20/38] time 0.163 (0.180) data 0.085 (0.102) loss_u loss_u 0.9492 (0.9450) acc_u 6.2500 (7.0312) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [25/38] time 0.160 (0.178) data 0.082 (0.100) loss_u loss_u 0.9302 (0.9437) acc_u 6.2500 (6.8750) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [30/38] time 0.160 (0.176) data 0.082 (0.098) loss_u loss_u 0.9546 (0.9438) acc_u 6.2500 (6.8750) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [35/38] time 0.162 (0.175) data 0.085 (0.097) loss_u loss_u 0.9673 (0.9425) acc_u 3.1250 (7.0536) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 669
confident_label rate tensor(0.2364, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 382
clean true:379
clean false:3
clean_rate:0.9921465968586387
noisy true:568
noisy false:666
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1234
epoch [20/200] batch [5/11] time 0.172 (0.175) data 0.095 (0.097) loss_x loss_x 0.5239 (0.7766) acc_x 84.3750 (78.7500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [10/11] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 1.0029 (0.8417) acc_x 78.1250 (77.5000) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/38] time 0.161 (0.178) data 0.082 (0.100) loss_u loss_u 0.9302 (0.9090) acc_u 6.2500 (11.8750) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [10/38] time 0.169 (0.174) data 0.091 (0.097) loss_u loss_u 0.9351 (0.9313) acc_u 6.2500 (8.1250) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/38] time 0.180 (0.176) data 0.102 (0.099) loss_u loss_u 0.9380 (0.9420) acc_u 9.3750 (6.6667) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [20/38] time 0.182 (0.177) data 0.105 (0.099) loss_u loss_u 0.9707 (0.9397) acc_u 3.1250 (6.8750) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [25/38] time 0.167 (0.178) data 0.090 (0.100) loss_u loss_u 0.9370 (0.9395) acc_u 6.2500 (6.7500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [30/38] time 0.180 (0.178) data 0.102 (0.100) loss_u loss_u 0.9194 (0.9422) acc_u 9.3750 (6.3542) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [35/38] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.8750 (0.9417) acc_u 15.6250 (6.6071) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 679
confident_label rate tensor(0.2519, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 407
clean true:402
clean false:5
clean_rate:0.9877149877149877
noisy true:535
noisy false:674
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1209
epoch [21/200] batch [5/12] time 0.177 (0.180) data 0.099 (0.102) loss_x loss_x 0.5859 (0.7784) acc_x 90.6250 (79.3750) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [10/12] time 0.172 (0.180) data 0.095 (0.102) loss_x loss_x 0.6475 (0.7429) acc_x 75.0000 (80.6250) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/37] time 0.174 (0.176) data 0.097 (0.099) loss_u loss_u 0.9404 (0.9641) acc_u 6.2500 (3.7500) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [10/37] time 0.160 (0.176) data 0.082 (0.099) loss_u loss_u 0.9854 (0.9682) acc_u 3.1250 (3.7500) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [15/37] time 0.171 (0.175) data 0.094 (0.097) loss_u loss_u 0.9551 (0.9610) acc_u 6.2500 (5.0000) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/37] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.8877 (0.9561) acc_u 12.5000 (5.4688) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [25/37] time 0.186 (0.176) data 0.107 (0.098) loss_u loss_u 0.9512 (0.9566) acc_u 6.2500 (5.1250) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [30/37] time 0.185 (0.177) data 0.107 (0.099) loss_u loss_u 0.9312 (0.9541) acc_u 6.2500 (5.4167) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [35/37] time 0.186 (0.178) data 0.108 (0.100) loss_u loss_u 0.9307 (0.9528) acc_u 6.2500 (5.5357) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.2376, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 384
clean true:379
clean false:5
clean_rate:0.9869791666666666
noisy true:551
noisy false:681
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1232
epoch [22/200] batch [5/12] time 0.169 (0.175) data 0.092 (0.098) loss_x loss_x 0.4822 (0.8835) acc_x 87.5000 (76.8750) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [10/12] time 0.183 (0.178) data 0.105 (0.101) loss_x loss_x 0.9429 (0.8437) acc_x 81.2500 (79.0625) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/38] time 0.167 (0.175) data 0.089 (0.098) loss_u loss_u 0.9409 (0.9144) acc_u 9.3750 (11.2500) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [10/38] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.9434 (0.9318) acc_u 3.1250 (7.8125) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [15/38] time 0.158 (0.175) data 0.080 (0.097) loss_u loss_u 0.9653 (0.9388) acc_u 3.1250 (7.0833) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [20/38] time 0.171 (0.175) data 0.092 (0.098) loss_u loss_u 0.9409 (0.9405) acc_u 6.2500 (6.7188) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [25/38] time 0.161 (0.174) data 0.083 (0.096) loss_u loss_u 0.9077 (0.9403) acc_u 12.5000 (6.6250) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [30/38] time 0.177 (0.174) data 0.099 (0.096) loss_u loss_u 0.8696 (0.9394) acc_u 21.8750 (6.8750) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [35/38] time 0.170 (0.174) data 0.093 (0.096) loss_u loss_u 0.9785 (0.9426) acc_u 3.1250 (6.6071) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 672
confident_label rate tensor(0.2444, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 395
clean true:390
clean false:5
clean_rate:0.9873417721518988
noisy true:554
noisy false:667
after delete: len(clean_dataset) 395
after delete: len(noisy_dataset) 1221
epoch [23/200] batch [5/12] time 0.234 (0.193) data 0.157 (0.115) loss_x loss_x 0.6201 (0.7886) acc_x 84.3750 (78.7500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/12] time 0.169 (0.182) data 0.092 (0.104) loss_x loss_x 0.7290 (0.7656) acc_x 78.1250 (80.3125) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/38] time 0.174 (0.181) data 0.097 (0.103) loss_u loss_u 0.9072 (0.9307) acc_u 9.3750 (6.8750) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [10/38] time 0.185 (0.186) data 0.107 (0.108) loss_u loss_u 0.9106 (0.9288) acc_u 15.6250 (7.8125) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [15/38] time 0.179 (0.185) data 0.100 (0.107) loss_u loss_u 0.8179 (0.9266) acc_u 21.8750 (8.3333) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [20/38] time 0.164 (0.185) data 0.086 (0.107) loss_u loss_u 0.9570 (0.9326) acc_u 6.2500 (7.6562) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [25/38] time 0.167 (0.182) data 0.089 (0.104) loss_u loss_u 0.9956 (0.9348) acc_u 0.0000 (7.5000) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [30/38] time 0.172 (0.181) data 0.094 (0.103) loss_u loss_u 0.9185 (0.9344) acc_u 6.2500 (7.2917) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [35/38] time 0.167 (0.179) data 0.089 (0.101) loss_u loss_u 0.9824 (0.9404) acc_u 3.1250 (6.6071) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 701
confident_label rate tensor(0.2407, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 389
clean true:381
clean false:8
clean_rate:0.9794344473007712
noisy true:534
noisy false:693
after delete: len(clean_dataset) 389
after delete: len(noisy_dataset) 1227
epoch [24/200] batch [5/12] time 0.177 (0.189) data 0.100 (0.112) loss_x loss_x 0.9268 (0.8918) acc_x 81.2500 (79.3750) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [10/12] time 0.170 (0.182) data 0.093 (0.105) loss_x loss_x 1.0635 (0.9269) acc_x 81.2500 (78.4375) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/38] time 0.173 (0.180) data 0.095 (0.102) loss_u loss_u 0.9956 (0.9585) acc_u 0.0000 (4.3750) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/38] time 0.168 (0.180) data 0.091 (0.102) loss_u loss_u 0.9658 (0.9540) acc_u 3.1250 (5.3125) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [15/38] time 0.222 (0.178) data 0.145 (0.101) loss_u loss_u 0.9077 (0.9450) acc_u 12.5000 (6.2500) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [20/38] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.9033 (0.9406) acc_u 12.5000 (6.8750) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [25/38] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9629 (0.9446) acc_u 3.1250 (6.3750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [30/38] time 0.166 (0.178) data 0.088 (0.100) loss_u loss_u 0.9741 (0.9417) acc_u 3.1250 (6.5625) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [35/38] time 0.181 (0.178) data 0.103 (0.100) loss_u loss_u 0.9985 (0.9423) acc_u 0.0000 (6.4286) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.2450, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 396
clean true:389
clean false:7
clean_rate:0.9823232323232324
noisy true:537
noisy false:683
after delete: len(clean_dataset) 396
after delete: len(noisy_dataset) 1220
epoch [25/200] batch [5/12] time 0.166 (0.178) data 0.089 (0.101) loss_x loss_x 0.5073 (0.7642) acc_x 90.6250 (79.3750) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [10/12] time 0.181 (0.176) data 0.103 (0.098) loss_x loss_x 0.8467 (0.8590) acc_x 78.1250 (76.5625) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/38] time 0.188 (0.179) data 0.111 (0.101) loss_u loss_u 0.9634 (0.9232) acc_u 3.1250 (8.1250) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [10/38] time 0.184 (0.181) data 0.106 (0.103) loss_u loss_u 0.9214 (0.9332) acc_u 6.2500 (7.1875) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [15/38] time 0.159 (0.180) data 0.080 (0.102) loss_u loss_u 0.9517 (0.9309) acc_u 6.2500 (7.5000) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [20/38] time 0.177 (0.179) data 0.100 (0.101) loss_u loss_u 0.9824 (0.9397) acc_u 3.1250 (6.7188) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [25/38] time 0.185 (0.179) data 0.106 (0.102) loss_u loss_u 0.9790 (0.9402) acc_u 3.1250 (7.0000) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [30/38] time 0.182 (0.180) data 0.105 (0.102) loss_u loss_u 0.8804 (0.9397) acc_u 9.3750 (6.6667) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [35/38] time 0.180 (0.180) data 0.103 (0.102) loss_u loss_u 0.9863 (0.9387) acc_u 0.0000 (6.6964) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 681
confident_label rate tensor(0.2463, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 398
clean true:387
clean false:11
clean_rate:0.9723618090452262
noisy true:548
noisy false:670
after delete: len(clean_dataset) 398
after delete: len(noisy_dataset) 1218
epoch [26/200] batch [5/12] time 0.186 (0.183) data 0.108 (0.105) loss_x loss_x 0.7476 (0.7396) acc_x 84.3750 (85.6250) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/12] time 0.180 (0.183) data 0.102 (0.105) loss_x loss_x 0.9292 (0.8518) acc_x 71.8750 (80.6250) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/38] time 0.166 (0.181) data 0.088 (0.103) loss_u loss_u 0.9424 (0.9527) acc_u 6.2500 (8.1250) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [10/38] time 0.162 (0.178) data 0.084 (0.100) loss_u loss_u 0.9429 (0.9449) acc_u 6.2500 (7.8125) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [15/38] time 0.164 (0.177) data 0.086 (0.100) loss_u loss_u 0.8628 (0.9317) acc_u 18.7500 (8.9583) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [20/38] time 0.181 (0.177) data 0.101 (0.099) loss_u loss_u 0.9561 (0.9335) acc_u 6.2500 (8.2812) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [25/38] time 0.177 (0.177) data 0.099 (0.099) loss_u loss_u 0.9517 (0.9368) acc_u 6.2500 (7.8750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [30/38] time 0.192 (0.178) data 0.112 (0.100) loss_u loss_u 0.9536 (0.9380) acc_u 6.2500 (7.3958) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [35/38] time 0.188 (0.179) data 0.110 (0.101) loss_u loss_u 0.8354 (0.9384) acc_u 21.8750 (7.5000) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 675
confident_label rate tensor(0.2457, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 397
clean true:388
clean false:9
clean_rate:0.9773299748110831
noisy true:553
noisy false:666
after delete: len(clean_dataset) 397
after delete: len(noisy_dataset) 1219
epoch [27/200] batch [5/12] time 0.180 (0.184) data 0.101 (0.107) loss_x loss_x 0.9497 (1.2409) acc_x 71.8750 (70.6250) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [10/12] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.9053 (1.0674) acc_x 84.3750 (75.6250) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/38] time 0.232 (0.178) data 0.154 (0.100) loss_u loss_u 0.9385 (0.9427) acc_u 12.5000 (7.5000) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [10/38] time 0.167 (0.177) data 0.089 (0.099) loss_u loss_u 0.9272 (0.9434) acc_u 9.3750 (6.8750) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/38] time 0.163 (0.175) data 0.085 (0.097) loss_u loss_u 0.9741 (0.9492) acc_u 3.1250 (6.0417) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [20/38] time 0.169 (0.174) data 0.090 (0.096) loss_u loss_u 0.9360 (0.9483) acc_u 6.2500 (5.9375) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/38] time 0.181 (0.174) data 0.101 (0.096) loss_u loss_u 0.9619 (0.9451) acc_u 3.1250 (6.5000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [30/38] time 0.173 (0.174) data 0.095 (0.096) loss_u loss_u 0.9497 (0.9465) acc_u 6.2500 (6.2500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [35/38] time 0.162 (0.173) data 0.083 (0.095) loss_u loss_u 0.9585 (0.9452) acc_u 3.1250 (6.3393) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 388
clean true:383
clean false:5
clean_rate:0.9871134020618557
noisy true:543
noisy false:685
after delete: len(clean_dataset) 388
after delete: len(noisy_dataset) 1228
epoch [28/200] batch [5/12] time 0.182 (0.181) data 0.103 (0.103) loss_x loss_x 0.7134 (0.8723) acc_x 84.3750 (78.1250) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [10/12] time 0.178 (0.181) data 0.100 (0.104) loss_x loss_x 1.0234 (0.9660) acc_x 78.1250 (75.9375) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/38] time 0.171 (0.178) data 0.093 (0.100) loss_u loss_u 0.9917 (0.9235) acc_u 0.0000 (9.3750) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [10/38] time 0.169 (0.179) data 0.092 (0.101) loss_u loss_u 0.9053 (0.9310) acc_u 9.3750 (7.8125) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [15/38] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.8682 (0.9331) acc_u 12.5000 (7.2917) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [20/38] time 0.183 (0.178) data 0.105 (0.100) loss_u loss_u 0.9424 (0.9299) acc_u 6.2500 (7.6562) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [25/38] time 0.190 (0.179) data 0.111 (0.101) loss_u loss_u 0.9194 (0.9307) acc_u 9.3750 (7.7500) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [30/38] time 0.183 (0.180) data 0.105 (0.102) loss_u loss_u 0.8716 (0.9317) acc_u 15.6250 (7.8125) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [35/38] time 0.187 (0.181) data 0.109 (0.103) loss_u loss_u 0.9297 (0.9330) acc_u 9.3750 (7.8571) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 715
confident_label rate tensor(0.2370, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 383
clean true:375
clean false:8
clean_rate:0.97911227154047
noisy true:526
noisy false:707
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1233
epoch [29/200] batch [5/11] time 0.162 (0.177) data 0.085 (0.099) loss_x loss_x 0.5698 (0.6638) acc_x 90.6250 (83.1250) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/11] time 0.168 (0.170) data 0.090 (0.093) loss_x loss_x 0.5903 (0.7130) acc_x 84.3750 (80.3125) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/38] time 0.168 (0.169) data 0.091 (0.092) loss_u loss_u 0.9053 (0.9352) acc_u 12.5000 (8.1250) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [10/38] time 0.185 (0.171) data 0.107 (0.094) loss_u loss_u 0.9248 (0.9370) acc_u 9.3750 (7.5000) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [15/38] time 0.170 (0.172) data 0.092 (0.094) loss_u loss_u 0.9805 (0.9342) acc_u 3.1250 (7.5000) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [20/38] time 0.162 (0.171) data 0.084 (0.093) loss_u loss_u 0.8989 (0.9356) acc_u 9.3750 (7.1875) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [25/38] time 0.174 (0.172) data 0.096 (0.094) loss_u loss_u 0.9912 (0.9364) acc_u 0.0000 (7.0000) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [30/38] time 0.174 (0.171) data 0.095 (0.093) loss_u loss_u 0.9390 (0.9318) acc_u 6.2500 (7.7083) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [35/38] time 0.185 (0.171) data 0.107 (0.093) loss_u loss_u 0.8555 (0.9315) acc_u 12.5000 (7.7679) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 662
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 403
clean true:393
clean false:10
clean_rate:0.9751861042183623
noisy true:561
noisy false:652
after delete: len(clean_dataset) 403
after delete: len(noisy_dataset) 1213
epoch [30/200] batch [5/12] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.8950 (0.8141) acc_x 78.1250 (78.7500) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [10/12] time 0.174 (0.180) data 0.097 (0.102) loss_x loss_x 0.9136 (0.7281) acc_x 81.2500 (81.5625) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/37] time 0.176 (0.176) data 0.098 (0.099) loss_u loss_u 0.9043 (0.9429) acc_u 9.3750 (6.2500) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/37] time 0.165 (0.176) data 0.085 (0.098) loss_u loss_u 0.9507 (0.9421) acc_u 6.2500 (6.2500) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/37] time 0.166 (0.174) data 0.089 (0.096) loss_u loss_u 0.9502 (0.9397) acc_u 6.2500 (6.4583) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [20/37] time 0.178 (0.173) data 0.099 (0.095) loss_u loss_u 0.9795 (0.9373) acc_u 3.1250 (7.0312) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [25/37] time 0.165 (0.173) data 0.088 (0.095) loss_u loss_u 0.9697 (0.9376) acc_u 3.1250 (7.0000) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [30/37] time 0.165 (0.172) data 0.087 (0.094) loss_u loss_u 0.9556 (0.9367) acc_u 3.1250 (6.9792) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [35/37] time 0.181 (0.173) data 0.103 (0.095) loss_u loss_u 0.9028 (0.9355) acc_u 9.3750 (7.2321) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 702
confident_label rate tensor(0.2345, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 379
clean true:373
clean false:6
clean_rate:0.9841688654353562
noisy true:541
noisy false:696
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1237
epoch [31/200] batch [5/11] time 0.168 (0.168) data 0.091 (0.091) loss_x loss_x 0.7310 (0.8489) acc_x 71.8750 (76.2500) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [10/11] time 0.172 (0.169) data 0.094 (0.091) loss_x loss_x 0.5889 (0.7732) acc_x 81.2500 (78.4375) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/38] time 0.180 (0.173) data 0.103 (0.095) loss_u loss_u 0.9443 (0.9023) acc_u 9.3750 (11.8750) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [10/38] time 0.172 (0.172) data 0.095 (0.095) loss_u loss_u 0.9321 (0.9085) acc_u 9.3750 (10.6250) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [15/38] time 0.180 (0.173) data 0.102 (0.095) loss_u loss_u 0.9111 (0.9157) acc_u 12.5000 (10.4167) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [20/38] time 0.162 (0.173) data 0.083 (0.095) loss_u loss_u 0.8862 (0.9137) acc_u 12.5000 (10.9375) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [25/38] time 0.159 (0.172) data 0.080 (0.094) loss_u loss_u 0.9189 (0.9184) acc_u 9.3750 (10.2500) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [30/38] time 0.166 (0.172) data 0.087 (0.094) loss_u loss_u 0.9966 (0.9205) acc_u 0.0000 (9.8958) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [35/38] time 0.171 (0.172) data 0.091 (0.093) loss_u loss_u 0.9678 (0.9187) acc_u 3.1250 (10.1786) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 661
confident_label rate tensor(0.2568, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 415
clean true:408
clean false:7
clean_rate:0.983132530120482
noisy true:547
noisy false:654
after delete: len(clean_dataset) 415
after delete: len(noisy_dataset) 1201
epoch [32/200] batch [5/12] time 0.179 (0.180) data 0.101 (0.103) loss_x loss_x 0.9712 (0.8562) acc_x 81.2500 (82.5000) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [10/12] time 0.186 (0.179) data 0.108 (0.101) loss_x loss_x 1.0322 (0.8186) acc_x 78.1250 (82.5000) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/37] time 0.177 (0.179) data 0.099 (0.101) loss_u loss_u 0.9673 (0.9079) acc_u 3.1250 (10.0000) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [10/37] time 0.195 (0.178) data 0.116 (0.101) loss_u loss_u 0.9048 (0.9217) acc_u 12.5000 (8.4375) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/37] time 0.162 (0.177) data 0.084 (0.099) loss_u loss_u 0.9150 (0.9269) acc_u 9.3750 (8.1250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [20/37] time 0.170 (0.175) data 0.093 (0.097) loss_u loss_u 0.9531 (0.9269) acc_u 6.2500 (8.1250) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [25/37] time 0.171 (0.174) data 0.093 (0.096) loss_u loss_u 0.9600 (0.9319) acc_u 6.2500 (7.7500) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [30/37] time 0.170 (0.174) data 0.093 (0.096) loss_u loss_u 0.9966 (0.9357) acc_u 0.0000 (7.2917) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [35/37] time 0.170 (0.173) data 0.092 (0.096) loss_u loss_u 0.9761 (0.9409) acc_u 3.1250 (6.8750) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.2568, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 415
clean true:409
clean false:6
clean_rate:0.9855421686746988
noisy true:579
noisy false:622
after delete: len(clean_dataset) 415
after delete: len(noisy_dataset) 1201
epoch [33/200] batch [5/12] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.5220 (0.7272) acc_x 87.5000 (82.5000) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [10/12] time 0.177 (0.178) data 0.099 (0.101) loss_x loss_x 1.5342 (0.8185) acc_x 62.5000 (79.6875) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/37] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.9053 (0.9528) acc_u 9.3750 (4.3750) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/37] time 0.168 (0.175) data 0.089 (0.098) loss_u loss_u 0.8359 (0.9347) acc_u 21.8750 (7.1875) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [15/37] time 0.172 (0.176) data 0.093 (0.098) loss_u loss_u 0.9277 (0.9334) acc_u 6.2500 (7.0833) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [20/37] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.8882 (0.9348) acc_u 12.5000 (7.1875) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [25/37] time 0.170 (0.174) data 0.091 (0.096) loss_u loss_u 0.9565 (0.9400) acc_u 6.2500 (6.6250) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [30/37] time 0.166 (0.173) data 0.087 (0.095) loss_u loss_u 0.9487 (0.9403) acc_u 6.2500 (6.8750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [35/37] time 0.173 (0.174) data 0.096 (0.096) loss_u loss_u 0.9932 (0.9431) acc_u 0.0000 (6.5179) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.2550, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 412
clean true:405
clean false:7
clean_rate:0.9830097087378641
noisy true:565
noisy false:639
after delete: len(clean_dataset) 412
after delete: len(noisy_dataset) 1204
epoch [34/200] batch [5/12] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.8843 (0.7347) acc_x 68.7500 (80.6250) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/12] time 0.168 (0.184) data 0.090 (0.106) loss_x loss_x 0.6440 (0.6736) acc_x 84.3750 (83.1250) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/37] time 0.204 (0.181) data 0.125 (0.103) loss_u loss_u 0.9111 (0.9354) acc_u 12.5000 (10.0000) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [10/37] time 0.171 (0.181) data 0.093 (0.103) loss_u loss_u 0.9023 (0.9167) acc_u 12.5000 (10.9375) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/37] time 0.168 (0.178) data 0.090 (0.101) loss_u loss_u 0.9341 (0.9201) acc_u 9.3750 (10.2083) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/37] time 0.176 (0.177) data 0.098 (0.099) loss_u loss_u 0.9600 (0.9294) acc_u 3.1250 (8.5938) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [25/37] time 0.161 (0.176) data 0.082 (0.098) loss_u loss_u 0.9473 (0.9320) acc_u 3.1250 (8.0000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [30/37] time 0.160 (0.175) data 0.082 (0.097) loss_u loss_u 0.8970 (0.9330) acc_u 12.5000 (8.0208) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [35/37] time 0.182 (0.175) data 0.104 (0.097) loss_u loss_u 0.9551 (0.9337) acc_u 3.1250 (7.7679) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.2475, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 400
clean true:392
clean false:8
clean_rate:0.98
noisy true:538
noisy false:678
after delete: len(clean_dataset) 400
after delete: len(noisy_dataset) 1216
epoch [35/200] batch [5/12] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.8394 (0.9396) acc_x 71.8750 (78.1250) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [10/12] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 1.1123 (0.9505) acc_x 75.0000 (77.8125) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/38] time 0.174 (0.180) data 0.096 (0.102) loss_u loss_u 0.9126 (0.9317) acc_u 9.3750 (8.1250) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [10/38] time 0.186 (0.180) data 0.107 (0.102) loss_u loss_u 0.9702 (0.9372) acc_u 3.1250 (7.1875) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [15/38] time 0.173 (0.180) data 0.093 (0.102) loss_u loss_u 0.9585 (0.9397) acc_u 3.1250 (7.0833) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [20/38] time 0.189 (0.180) data 0.110 (0.102) loss_u loss_u 0.9434 (0.9390) acc_u 6.2500 (7.5000) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [25/38] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.9033 (0.9398) acc_u 12.5000 (7.7500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [30/38] time 0.171 (0.179) data 0.094 (0.101) loss_u loss_u 0.8633 (0.9351) acc_u 12.5000 (8.0208) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [35/38] time 0.190 (0.179) data 0.112 (0.101) loss_u loss_u 0.9678 (0.9363) acc_u 3.1250 (7.6786) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 663
confident_label rate tensor(0.2475, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 400
clean true:391
clean false:9
clean_rate:0.9775
noisy true:562
noisy false:654
after delete: len(clean_dataset) 400
after delete: len(noisy_dataset) 1216
epoch [36/200] batch [5/12] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.9995 (0.7367) acc_x 75.0000 (83.7500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [10/12] time 0.170 (0.180) data 0.092 (0.102) loss_x loss_x 1.2734 (0.8440) acc_x 71.8750 (78.7500) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/38] time 0.182 (0.177) data 0.104 (0.099) loss_u loss_u 0.9116 (0.9068) acc_u 12.5000 (11.2500) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/38] time 0.173 (0.178) data 0.094 (0.100) loss_u loss_u 0.8984 (0.9095) acc_u 12.5000 (10.6250) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/38] time 0.166 (0.177) data 0.088 (0.099) loss_u loss_u 0.9307 (0.9126) acc_u 6.2500 (9.7917) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [20/38] time 0.173 (0.176) data 0.095 (0.098) loss_u loss_u 0.9355 (0.9157) acc_u 6.2500 (9.2188) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [25/38] time 0.184 (0.177) data 0.104 (0.098) loss_u loss_u 0.9072 (0.9189) acc_u 9.3750 (9.0000) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [30/38] time 0.163 (0.176) data 0.085 (0.097) loss_u loss_u 0.9712 (0.9219) acc_u 3.1250 (8.6458) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [35/38] time 0.184 (0.176) data 0.106 (0.098) loss_u loss_u 0.9663 (0.9259) acc_u 3.1250 (8.3036) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 683
confident_label rate tensor(0.2512, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 406
clean true:398
clean false:8
clean_rate:0.9802955665024631
noisy true:535
noisy false:675
after delete: len(clean_dataset) 406
after delete: len(noisy_dataset) 1210
epoch [37/200] batch [5/12] time 0.169 (0.181) data 0.091 (0.103) loss_x loss_x 0.9121 (0.8077) acc_x 78.1250 (81.2500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [10/12] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.8770 (0.7582) acc_x 78.1250 (81.2500) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/37] time 0.168 (0.177) data 0.091 (0.099) loss_u loss_u 0.9111 (0.9374) acc_u 9.3750 (6.8750) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [10/37] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.9570 (0.9357) acc_u 3.1250 (6.8750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/37] time 0.180 (0.176) data 0.102 (0.098) loss_u loss_u 0.9438 (0.9381) acc_u 6.2500 (6.8750) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [20/37] time 0.186 (0.177) data 0.108 (0.099) loss_u loss_u 0.9653 (0.9423) acc_u 3.1250 (6.2500) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [25/37] time 0.183 (0.179) data 0.106 (0.101) loss_u loss_u 0.8574 (0.9423) acc_u 15.6250 (6.2500) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [30/37] time 0.167 (0.179) data 0.090 (0.101) loss_u loss_u 0.9316 (0.9455) acc_u 9.3750 (6.0417) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [35/37] time 0.180 (0.179) data 0.103 (0.101) loss_u loss_u 0.9736 (0.9435) acc_u 3.1250 (6.3393) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 641
confident_label rate tensor(0.2562, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 414
clean true:407
clean false:7
clean_rate:0.9830917874396136
noisy true:568
noisy false:634
after delete: len(clean_dataset) 414
after delete: len(noisy_dataset) 1202
epoch [38/200] batch [5/12] time 0.167 (0.180) data 0.090 (0.102) loss_x loss_x 0.7324 (0.7106) acc_x 78.1250 (82.5000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [10/12] time 0.168 (0.174) data 0.090 (0.096) loss_x loss_x 0.9487 (0.7003) acc_x 75.0000 (82.8125) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/37] time 0.187 (0.175) data 0.109 (0.097) loss_u loss_u 0.9561 (0.9441) acc_u 6.2500 (6.2500) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [10/37] time 0.174 (0.175) data 0.096 (0.097) loss_u loss_u 0.9731 (0.9521) acc_u 6.2500 (6.2500) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/37] time 0.203 (0.176) data 0.124 (0.098) loss_u loss_u 0.9224 (0.9567) acc_u 9.3750 (5.8333) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [20/37] time 0.186 (0.177) data 0.108 (0.099) loss_u loss_u 0.9375 (0.9523) acc_u 6.2500 (6.2500) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [25/37] time 0.193 (0.178) data 0.115 (0.100) loss_u loss_u 0.9678 (0.9486) acc_u 3.1250 (6.6250) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [30/37] time 0.166 (0.179) data 0.088 (0.101) loss_u loss_u 0.8970 (0.9439) acc_u 12.5000 (6.9792) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [35/37] time 0.161 (0.178) data 0.083 (0.100) loss_u loss_u 0.9170 (0.9421) acc_u 12.5000 (7.2321) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 604
confident_label rate tensor(0.2667, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 431
clean true:423
clean false:8
clean_rate:0.9814385150812065
noisy true:589
noisy false:596
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1185
epoch [39/200] batch [5/13] time 0.189 (0.181) data 0.112 (0.104) loss_x loss_x 0.9658 (0.8544) acc_x 87.5000 (77.5000) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [10/13] time 0.187 (0.188) data 0.109 (0.111) loss_x loss_x 0.6387 (0.8898) acc_x 84.3750 (76.8750) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/37] time 0.172 (0.184) data 0.094 (0.107) loss_u loss_u 0.9116 (0.9464) acc_u 9.3750 (6.2500) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [10/37] time 0.197 (0.184) data 0.117 (0.107) loss_u loss_u 0.9419 (0.9498) acc_u 6.2500 (5.6250) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/37] time 0.169 (0.185) data 0.091 (0.107) loss_u loss_u 0.9814 (0.9514) acc_u 3.1250 (5.8333) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [20/37] time 0.189 (0.185) data 0.111 (0.107) loss_u loss_u 0.9395 (0.9480) acc_u 6.2500 (6.0938) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [25/37] time 0.184 (0.187) data 0.106 (0.110) loss_u loss_u 0.9629 (0.9460) acc_u 3.1250 (6.3750) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [30/37] time 0.166 (0.186) data 0.088 (0.109) loss_u loss_u 0.9653 (0.9451) acc_u 3.1250 (6.4583) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [35/37] time 0.189 (0.184) data 0.111 (0.106) loss_u loss_u 0.8965 (0.9430) acc_u 9.3750 (6.6071) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 666
confident_label rate tensor(0.2512, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 406
clean true:398
clean false:8
clean_rate:0.9802955665024631
noisy true:552
noisy false:658
after delete: len(clean_dataset) 406
after delete: len(noisy_dataset) 1210
epoch [40/200] batch [5/12] time 0.173 (0.177) data 0.095 (0.099) loss_x loss_x 0.6514 (0.9848) acc_x 75.0000 (75.6250) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [10/12] time 0.178 (0.179) data 0.100 (0.101) loss_x loss_x 0.6646 (0.9140) acc_x 90.6250 (79.6875) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/37] time 0.192 (0.179) data 0.113 (0.101) loss_u loss_u 0.9790 (0.9476) acc_u 3.1250 (6.2500) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [10/37] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.8735 (0.9395) acc_u 15.6250 (7.1875) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/37] time 0.171 (0.178) data 0.093 (0.100) loss_u loss_u 0.9346 (0.9391) acc_u 9.3750 (7.2917) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/37] time 0.169 (0.178) data 0.091 (0.100) loss_u loss_u 0.9570 (0.9371) acc_u 9.3750 (7.8125) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [25/37] time 0.179 (0.177) data 0.102 (0.099) loss_u loss_u 0.9390 (0.9361) acc_u 6.2500 (8.0000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [30/37] time 0.180 (0.178) data 0.102 (0.100) loss_u loss_u 0.9634 (0.9352) acc_u 3.1250 (8.1250) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [35/37] time 0.167 (0.177) data 0.089 (0.099) loss_u loss_u 0.9004 (0.9321) acc_u 12.5000 (8.3929) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.2605, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 421
clean true:409
clean false:12
clean_rate:0.9714964370546318
noisy true:584
noisy false:611
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1195
epoch [41/200] batch [5/13] time 0.174 (0.172) data 0.097 (0.094) loss_x loss_x 0.5410 (0.7896) acc_x 84.3750 (76.8750) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [10/13] time 0.175 (0.179) data 0.097 (0.101) loss_x loss_x 0.8125 (0.8022) acc_x 81.2500 (77.1875) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/37] time 0.188 (0.182) data 0.109 (0.104) loss_u loss_u 0.9155 (0.9091) acc_u 9.3750 (10.0000) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [10/37] time 0.185 (0.181) data 0.108 (0.103) loss_u loss_u 0.9609 (0.9326) acc_u 6.2500 (7.8125) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/37] time 0.185 (0.182) data 0.107 (0.104) loss_u loss_u 0.9810 (0.9421) acc_u 3.1250 (6.6667) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [20/37] time 0.206 (0.182) data 0.127 (0.105) loss_u loss_u 0.9702 (0.9355) acc_u 3.1250 (7.5000) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [25/37] time 0.187 (0.183) data 0.108 (0.105) loss_u loss_u 0.9248 (0.9337) acc_u 6.2500 (7.5000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [30/37] time 0.168 (0.182) data 0.090 (0.104) loss_u loss_u 0.9497 (0.9387) acc_u 6.2500 (7.0833) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [35/37] time 0.178 (0.181) data 0.098 (0.103) loss_u loss_u 0.9482 (0.9397) acc_u 6.2500 (6.9643) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 636
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 409
clean true:402
clean false:7
clean_rate:0.9828850855745721
noisy true:578
noisy false:629
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1207
epoch [42/200] batch [5/12] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.7007 (0.7250) acc_x 81.2500 (81.2500) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [10/12] time 0.183 (0.178) data 0.105 (0.100) loss_x loss_x 0.5869 (0.7427) acc_x 84.3750 (81.5625) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/37] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.8872 (0.9311) acc_u 12.5000 (8.1250) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [10/37] time 0.162 (0.178) data 0.084 (0.101) loss_u loss_u 0.9224 (0.9336) acc_u 6.2500 (7.5000) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [15/37] time 0.182 (0.178) data 0.104 (0.100) loss_u loss_u 0.9590 (0.9434) acc_u 6.2500 (6.4583) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [20/37] time 0.190 (0.179) data 0.111 (0.101) loss_u loss_u 0.9048 (0.9305) acc_u 6.2500 (8.1250) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [25/37] time 0.190 (0.180) data 0.113 (0.102) loss_u loss_u 0.9604 (0.9311) acc_u 6.2500 (8.1250) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [30/37] time 0.170 (0.180) data 0.092 (0.102) loss_u loss_u 0.9014 (0.9314) acc_u 9.3750 (7.9167) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [35/37] time 0.166 (0.178) data 0.089 (0.101) loss_u loss_u 0.9971 (0.9352) acc_u 0.0000 (7.4107) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.2723, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 440
clean true:432
clean false:8
clean_rate:0.9818181818181818
noisy true:547
noisy false:629
after delete: len(clean_dataset) 440
after delete: len(noisy_dataset) 1176
epoch [43/200] batch [5/13] time 0.186 (0.186) data 0.109 (0.108) loss_x loss_x 0.8003 (0.6493) acc_x 78.1250 (82.5000) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/13] time 0.183 (0.189) data 0.105 (0.111) loss_x loss_x 0.7612 (0.6760) acc_x 87.5000 (80.9375) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/36] time 0.162 (0.183) data 0.083 (0.105) loss_u loss_u 0.9658 (0.9467) acc_u 3.1250 (7.5000) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/36] time 0.172 (0.180) data 0.094 (0.102) loss_u loss_u 0.9507 (0.9351) acc_u 3.1250 (8.1250) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [15/36] time 0.184 (0.179) data 0.105 (0.101) loss_u loss_u 0.9160 (0.9299) acc_u 9.3750 (8.3333) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/36] time 0.166 (0.178) data 0.089 (0.100) loss_u loss_u 0.9668 (0.9375) acc_u 3.1250 (7.3438) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [25/36] time 0.159 (0.176) data 0.080 (0.098) loss_u loss_u 0.9277 (0.9401) acc_u 6.2500 (6.7500) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [30/36] time 0.176 (0.175) data 0.097 (0.097) loss_u loss_u 0.9507 (0.9394) acc_u 6.2500 (6.7708) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [35/36] time 0.160 (0.173) data 0.081 (0.095) loss_u loss_u 0.9751 (0.9401) acc_u 3.1250 (6.6964) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 643
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 437
clean true:429
clean false:8
clean_rate:0.9816933638443935
noisy true:544
noisy false:635
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1179
epoch [44/200] batch [5/13] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.5488 (0.7673) acc_x 87.5000 (78.7500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [10/13] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.7407 (0.7647) acc_x 81.2500 (80.6250) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/36] time 0.188 (0.182) data 0.110 (0.104) loss_u loss_u 0.9834 (0.9437) acc_u 0.0000 (6.8750) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/36] time 0.172 (0.182) data 0.094 (0.104) loss_u loss_u 0.9023 (0.9437) acc_u 12.5000 (6.8750) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [15/36] time 0.201 (0.184) data 0.123 (0.106) loss_u loss_u 0.9043 (0.9370) acc_u 12.5000 (7.7083) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/36] time 0.194 (0.184) data 0.116 (0.106) loss_u loss_u 0.8760 (0.9346) acc_u 15.6250 (8.1250) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [25/36] time 0.180 (0.184) data 0.102 (0.107) loss_u loss_u 0.9707 (0.9425) acc_u 3.1250 (7.1250) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [30/36] time 0.165 (0.183) data 0.087 (0.105) loss_u loss_u 0.9653 (0.9398) acc_u 3.1250 (7.1875) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [35/36] time 0.178 (0.182) data 0.101 (0.104) loss_u loss_u 0.8882 (0.9406) acc_u 12.5000 (7.1429) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.2605, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 421
clean true:409
clean false:12
clean_rate:0.9714964370546318
noisy true:570
noisy false:625
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1195
epoch [45/200] batch [5/13] time 0.165 (0.174) data 0.087 (0.096) loss_x loss_x 0.5718 (0.6267) acc_x 84.3750 (80.0000) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [10/13] time 0.168 (0.172) data 0.091 (0.094) loss_x loss_x 0.6318 (0.6566) acc_x 87.5000 (81.8750) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/37] time 0.176 (0.175) data 0.097 (0.097) loss_u loss_u 0.9312 (0.9246) acc_u 9.3750 (8.7500) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [10/37] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.9673 (0.9271) acc_u 3.1250 (8.4375) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/37] time 0.173 (0.176) data 0.093 (0.098) loss_u loss_u 0.9453 (0.9247) acc_u 6.2500 (8.7500) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/37] time 0.172 (0.176) data 0.094 (0.098) loss_u loss_u 0.9585 (0.9343) acc_u 6.2500 (7.5000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [25/37] time 0.172 (0.176) data 0.095 (0.098) loss_u loss_u 0.8936 (0.9300) acc_u 15.6250 (8.1250) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [30/37] time 0.160 (0.175) data 0.083 (0.097) loss_u loss_u 0.8955 (0.9308) acc_u 9.3750 (8.0208) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [35/37] time 0.188 (0.176) data 0.110 (0.098) loss_u loss_u 0.9609 (0.9336) acc_u 3.1250 (7.7679) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.2661, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 430
clean true:422
clean false:8
clean_rate:0.9813953488372092
noisy true:576
noisy false:610
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1186
epoch [46/200] batch [5/13] time 0.169 (0.168) data 0.092 (0.091) loss_x loss_x 0.4282 (0.5995) acc_x 93.7500 (85.0000) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/13] time 0.169 (0.170) data 0.091 (0.092) loss_x loss_x 0.5918 (0.6504) acc_x 87.5000 (84.0625) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/37] time 0.187 (0.174) data 0.110 (0.096) loss_u loss_u 0.9150 (0.9423) acc_u 9.3750 (6.2500) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/37] time 0.183 (0.177) data 0.106 (0.099) loss_u loss_u 0.9395 (0.9317) acc_u 6.2500 (7.1875) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/37] time 0.189 (0.179) data 0.110 (0.101) loss_u loss_u 0.9204 (0.9284) acc_u 9.3750 (7.9167) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/37] time 0.189 (0.180) data 0.111 (0.102) loss_u loss_u 0.9448 (0.9323) acc_u 6.2500 (7.5000) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [25/37] time 0.161 (0.179) data 0.083 (0.101) loss_u loss_u 0.9414 (0.9319) acc_u 6.2500 (7.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [30/37] time 0.193 (0.178) data 0.114 (0.100) loss_u loss_u 0.9731 (0.9371) acc_u 6.2500 (7.1875) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [35/37] time 0.188 (0.179) data 0.109 (0.100) loss_u loss_u 0.9580 (0.9398) acc_u 3.1250 (6.9643) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 640
confident_label rate tensor(0.2630, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 425
clean true:414
clean false:11
clean_rate:0.9741176470588235
noisy true:562
noisy false:629
after delete: len(clean_dataset) 425
after delete: len(noisy_dataset) 1191
epoch [47/200] batch [5/13] time 0.174 (0.179) data 0.097 (0.101) loss_x loss_x 0.4954 (0.6699) acc_x 87.5000 (83.1250) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/13] time 0.185 (0.175) data 0.106 (0.097) loss_x loss_x 0.5444 (0.6918) acc_x 81.2500 (82.5000) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/37] time 0.173 (0.177) data 0.094 (0.099) loss_u loss_u 0.8711 (0.9352) acc_u 18.7500 (8.7500) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/37] time 0.185 (0.177) data 0.105 (0.099) loss_u loss_u 0.9707 (0.9407) acc_u 3.1250 (7.5000) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [15/37] time 0.177 (0.177) data 0.099 (0.099) loss_u loss_u 0.9556 (0.9435) acc_u 3.1250 (6.8750) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/37] time 0.174 (0.177) data 0.095 (0.099) loss_u loss_u 0.9399 (0.9425) acc_u 6.2500 (7.0312) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/37] time 0.169 (0.178) data 0.092 (0.100) loss_u loss_u 0.9648 (0.9456) acc_u 6.2500 (6.6250) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [30/37] time 0.170 (0.177) data 0.093 (0.099) loss_u loss_u 0.9404 (0.9417) acc_u 3.1250 (6.8750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [35/37] time 0.185 (0.177) data 0.107 (0.099) loss_u loss_u 0.8887 (0.9398) acc_u 9.3750 (6.8750) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 636
confident_label rate tensor(0.2611, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 422
clean true:414
clean false:8
clean_rate:0.981042654028436
noisy true:566
noisy false:628
after delete: len(clean_dataset) 422
after delete: len(noisy_dataset) 1194
epoch [48/200] batch [5/13] time 0.173 (0.166) data 0.095 (0.088) loss_x loss_x 0.2316 (0.5992) acc_x 93.7500 (85.0000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [10/13] time 0.183 (0.171) data 0.105 (0.093) loss_x loss_x 1.5566 (0.7892) acc_x 56.2500 (79.6875) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/37] time 0.191 (0.173) data 0.113 (0.095) loss_u loss_u 0.9741 (0.9132) acc_u 3.1250 (9.3750) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [10/37] time 0.165 (0.172) data 0.087 (0.094) loss_u loss_u 0.8555 (0.9124) acc_u 18.7500 (10.0000) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/37] time 0.169 (0.173) data 0.091 (0.095) loss_u loss_u 0.8926 (0.9200) acc_u 15.6250 (9.3750) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [20/37] time 0.193 (0.175) data 0.114 (0.097) loss_u loss_u 0.8823 (0.9280) acc_u 15.6250 (8.4375) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [25/37] time 0.168 (0.176) data 0.088 (0.098) loss_u loss_u 0.9229 (0.9280) acc_u 6.2500 (8.3750) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [30/37] time 0.172 (0.176) data 0.094 (0.098) loss_u loss_u 0.9121 (0.9291) acc_u 9.3750 (8.2292) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [35/37] time 0.170 (0.176) data 0.093 (0.098) loss_u loss_u 0.9458 (0.9323) acc_u 6.2500 (7.8571) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 434
clean true:423
clean false:11
clean_rate:0.9746543778801844
noisy true:569
noisy false:613
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1182
epoch [49/200] batch [5/13] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 1.0742 (0.8627) acc_x 81.2500 (75.0000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [10/13] time 0.183 (0.186) data 0.105 (0.108) loss_x loss_x 0.7681 (0.7906) acc_x 81.2500 (79.0625) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/36] time 0.172 (0.184) data 0.093 (0.107) loss_u loss_u 0.9453 (0.9203) acc_u 3.1250 (8.7500) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/36] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.8833 (0.9282) acc_u 12.5000 (7.5000) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/36] time 0.171 (0.181) data 0.094 (0.103) loss_u loss_u 0.9414 (0.9312) acc_u 9.3750 (7.9167) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/36] time 0.172 (0.180) data 0.093 (0.102) loss_u loss_u 0.9731 (0.9345) acc_u 3.1250 (7.5000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [25/36] time 0.169 (0.179) data 0.092 (0.101) loss_u loss_u 0.9541 (0.9409) acc_u 6.2500 (6.8750) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/36] time 0.186 (0.179) data 0.107 (0.101) loss_u loss_u 0.8989 (0.9417) acc_u 15.6250 (6.9792) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [35/36] time 0.179 (0.179) data 0.102 (0.101) loss_u loss_u 0.9961 (0.9437) acc_u 0.0000 (6.7857) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 619
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 447
clean true:436
clean false:11
clean_rate:0.9753914988814317
noisy true:561
noisy false:608
after delete: len(clean_dataset) 447
after delete: len(noisy_dataset) 1169
epoch [50/200] batch [5/13] time 0.182 (0.176) data 0.104 (0.098) loss_x loss_x 0.9712 (0.7887) acc_x 78.1250 (82.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [10/13] time 0.188 (0.180) data 0.111 (0.103) loss_x loss_x 0.9360 (0.7422) acc_x 87.5000 (83.7500) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/36] time 0.187 (0.182) data 0.108 (0.104) loss_u loss_u 0.9214 (0.9424) acc_u 9.3750 (6.8750) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/36] time 0.192 (0.181) data 0.114 (0.103) loss_u loss_u 0.8696 (0.9357) acc_u 15.6250 (7.8125) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/36] time 0.161 (0.179) data 0.083 (0.101) loss_u loss_u 0.9453 (0.9451) acc_u 6.2500 (6.6667) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/36] time 0.162 (0.177) data 0.082 (0.099) loss_u loss_u 0.9395 (0.9446) acc_u 6.2500 (6.7188) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [25/36] time 0.188 (0.177) data 0.109 (0.099) loss_u loss_u 0.9458 (0.9424) acc_u 6.2500 (7.0000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/36] time 0.168 (0.177) data 0.090 (0.099) loss_u loss_u 0.9092 (0.9433) acc_u 9.3750 (6.7708) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [35/36] time 0.174 (0.177) data 0.096 (0.099) loss_u loss_u 0.8955 (0.9448) acc_u 9.3750 (6.4286) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 627
confident_label rate tensor(0.2710, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 438
clean true:429
clean false:9
clean_rate:0.9794520547945206
noisy true:560
noisy false:618
after delete: len(clean_dataset) 438
after delete: len(noisy_dataset) 1178
epoch [51/200] batch [5/13] time 0.163 (0.169) data 0.086 (0.092) loss_x loss_x 0.8745 (0.7819) acc_x 84.3750 (79.3750) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/13] time 0.209 (0.183) data 0.131 (0.105) loss_x loss_x 1.0811 (0.7692) acc_x 75.0000 (81.5625) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/36] time 0.193 (0.181) data 0.115 (0.103) loss_u loss_u 0.9595 (0.9513) acc_u 3.1250 (6.2500) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/36] time 0.184 (0.183) data 0.105 (0.105) loss_u loss_u 0.9614 (0.9487) acc_u 3.1250 (5.9375) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [15/36] time 0.174 (0.183) data 0.095 (0.105) loss_u loss_u 0.9395 (0.9451) acc_u 6.2500 (6.4583) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/36] time 0.183 (0.182) data 0.104 (0.104) loss_u loss_u 0.9600 (0.9461) acc_u 3.1250 (5.9375) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [25/36] time 0.172 (0.181) data 0.094 (0.103) loss_u loss_u 0.9038 (0.9423) acc_u 9.3750 (6.3750) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [30/36] time 0.181 (0.180) data 0.103 (0.102) loss_u loss_u 0.9360 (0.9405) acc_u 6.2500 (6.5625) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [35/36] time 0.172 (0.180) data 0.094 (0.102) loss_u loss_u 0.8794 (0.9398) acc_u 12.5000 (6.6964) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.2593, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 419
clean true:415
clean false:4
clean_rate:0.9904534606205251
noisy true:564
noisy false:633
after delete: len(clean_dataset) 419
after delete: len(noisy_dataset) 1197
epoch [52/200] batch [5/13] time 0.172 (0.170) data 0.095 (0.092) loss_x loss_x 0.5059 (0.6246) acc_x 90.6250 (85.6250) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/13] time 0.176 (0.172) data 0.097 (0.095) loss_x loss_x 0.8535 (0.6139) acc_x 75.0000 (84.6875) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/37] time 0.183 (0.177) data 0.106 (0.099) loss_u loss_u 0.9468 (0.9349) acc_u 6.2500 (7.5000) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [10/37] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.9458 (0.9477) acc_u 6.2500 (5.9375) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/37] time 0.181 (0.177) data 0.103 (0.100) loss_u loss_u 0.9658 (0.9307) acc_u 3.1250 (7.9167) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/37] time 0.181 (0.179) data 0.103 (0.101) loss_u loss_u 0.9502 (0.9282) acc_u 6.2500 (8.7500) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [25/37] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.9658 (0.9309) acc_u 3.1250 (8.1250) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [30/37] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.8706 (0.9258) acc_u 15.6250 (8.8542) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [35/37] time 0.186 (0.181) data 0.108 (0.103) loss_u loss_u 0.9224 (0.9247) acc_u 6.2500 (9.0179) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 615
confident_label rate tensor(0.2772, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 448
clean true:435
clean false:13
clean_rate:0.9709821428571429
noisy true:566
noisy false:602
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1168
epoch [53/200] batch [5/14] time 0.159 (0.165) data 0.082 (0.087) loss_x loss_x 1.6221 (0.8885) acc_x 75.0000 (81.2500) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/14] time 0.175 (0.165) data 0.097 (0.088) loss_x loss_x 1.0029 (0.8208) acc_x 75.0000 (81.2500) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/36] time 0.199 (0.171) data 0.120 (0.094) loss_u loss_u 0.9927 (0.9419) acc_u 0.0000 (5.6250) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/36] time 0.169 (0.175) data 0.091 (0.097) loss_u loss_u 0.9507 (0.9411) acc_u 6.2500 (6.8750) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/36] time 0.190 (0.176) data 0.111 (0.098) loss_u loss_u 0.9336 (0.9314) acc_u 6.2500 (7.9167) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/36] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.9487 (0.9359) acc_u 6.2500 (7.5000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [25/36] time 0.173 (0.175) data 0.095 (0.097) loss_u loss_u 0.9360 (0.9365) acc_u 9.3750 (7.3750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/36] time 0.175 (0.175) data 0.097 (0.097) loss_u loss_u 0.9648 (0.9391) acc_u 3.1250 (6.9792) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [35/36] time 0.173 (0.175) data 0.095 (0.097) loss_u loss_u 0.8911 (0.9389) acc_u 12.5000 (6.9643) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 615
confident_label rate tensor(0.2735, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 442
clean true:433
clean false:9
clean_rate:0.9796380090497737
noisy true:568
noisy false:606
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 1174
epoch [54/200] batch [5/13] time 0.174 (0.175) data 0.097 (0.097) loss_x loss_x 0.3604 (0.8740) acc_x 90.6250 (80.6250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/13] time 0.177 (0.180) data 0.099 (0.102) loss_x loss_x 0.8242 (0.7762) acc_x 84.3750 (80.9375) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/36] time 0.171 (0.176) data 0.093 (0.098) loss_u loss_u 0.9419 (0.9313) acc_u 9.3750 (9.3750) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [10/36] time 0.174 (0.177) data 0.093 (0.099) loss_u loss_u 0.9634 (0.9301) acc_u 3.1250 (9.3750) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [15/36] time 0.174 (0.176) data 0.095 (0.098) loss_u loss_u 0.9731 (0.9334) acc_u 3.1250 (8.5417) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/36] time 0.173 (0.176) data 0.093 (0.098) loss_u loss_u 0.9702 (0.9342) acc_u 3.1250 (8.2812) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [25/36] time 0.184 (0.176) data 0.103 (0.098) loss_u loss_u 0.9600 (0.9363) acc_u 6.2500 (7.7500) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/36] time 0.185 (0.176) data 0.107 (0.098) loss_u loss_u 0.8965 (0.9330) acc_u 12.5000 (8.1250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [35/36] time 0.174 (0.176) data 0.096 (0.098) loss_u loss_u 0.9385 (0.9376) acc_u 9.3750 (7.5000) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.2741, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 443
clean true:436
clean false:7
clean_rate:0.9841986455981941
noisy true:598
noisy false:575
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1173
epoch [55/200] batch [5/13] time 0.191 (0.196) data 0.113 (0.119) loss_x loss_x 0.6143 (0.5219) acc_x 84.3750 (88.1250) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/13] time 0.174 (0.191) data 0.097 (0.113) loss_x loss_x 0.8418 (0.6388) acc_x 87.5000 (84.0625) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/36] time 0.172 (0.184) data 0.095 (0.106) loss_u loss_u 0.9761 (0.9492) acc_u 3.1250 (6.2500) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/36] time 0.182 (0.181) data 0.103 (0.104) loss_u loss_u 0.9204 (0.9442) acc_u 9.3750 (6.2500) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/36] time 0.182 (0.181) data 0.104 (0.103) loss_u loss_u 0.9316 (0.9432) acc_u 9.3750 (6.8750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/36] time 0.167 (0.180) data 0.090 (0.102) loss_u loss_u 0.9395 (0.9387) acc_u 6.2500 (7.5000) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/36] time 0.181 (0.180) data 0.103 (0.102) loss_u loss_u 0.9287 (0.9375) acc_u 12.5000 (7.7500) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/36] time 0.179 (0.179) data 0.100 (0.101) loss_u loss_u 0.9453 (0.9381) acc_u 6.2500 (7.5000) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [35/36] time 0.171 (0.178) data 0.093 (0.100) loss_u loss_u 0.9204 (0.9371) acc_u 9.3750 (7.6786) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 587
confident_label rate tensor(0.2741, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 443
clean true:435
clean false:8
clean_rate:0.981941309255079
noisy true:594
noisy false:579
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1173
epoch [56/200] batch [5/13] time 0.182 (0.187) data 0.106 (0.110) loss_x loss_x 0.6753 (0.7332) acc_x 78.1250 (78.1250) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/13] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.9824 (0.6878) acc_x 75.0000 (80.6250) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/36] time 0.177 (0.183) data 0.099 (0.106) loss_u loss_u 0.9727 (0.9260) acc_u 3.1250 (7.5000) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [10/36] time 0.175 (0.181) data 0.097 (0.104) loss_u loss_u 0.9058 (0.9309) acc_u 12.5000 (7.5000) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/36] time 0.180 (0.182) data 0.101 (0.104) loss_u loss_u 0.9517 (0.9407) acc_u 6.2500 (6.2500) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/36] time 0.186 (0.182) data 0.108 (0.104) loss_u loss_u 0.9092 (0.9404) acc_u 9.3750 (6.4062) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [25/36] time 0.168 (0.182) data 0.091 (0.104) loss_u loss_u 0.9199 (0.9379) acc_u 9.3750 (6.6250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/36] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9990 (0.9402) acc_u 0.0000 (6.3542) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [35/36] time 0.163 (0.182) data 0.085 (0.104) loss_u loss_u 0.9658 (0.9394) acc_u 3.1250 (6.6071) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.2717, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 439
clean true:432
clean false:7
clean_rate:0.9840546697038725
noisy true:558
noisy false:619
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1177
epoch [57/200] batch [5/13] time 0.165 (0.169) data 0.087 (0.091) loss_x loss_x 0.4167 (0.6842) acc_x 87.5000 (81.8750) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/13] time 0.184 (0.174) data 0.106 (0.096) loss_x loss_x 0.9800 (0.7419) acc_x 81.2500 (82.5000) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/36] time 0.168 (0.174) data 0.090 (0.097) loss_u loss_u 0.9321 (0.9223) acc_u 6.2500 (8.7500) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [10/36] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.9688 (0.9474) acc_u 3.1250 (5.6250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/36] time 0.182 (0.175) data 0.104 (0.097) loss_u loss_u 0.9165 (0.9495) acc_u 9.3750 (5.8333) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/36] time 0.161 (0.175) data 0.083 (0.097) loss_u loss_u 0.9668 (0.9513) acc_u 3.1250 (5.6250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/36] time 0.163 (0.173) data 0.085 (0.095) loss_u loss_u 0.9678 (0.9491) acc_u 3.1250 (5.7500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [30/36] time 0.180 (0.173) data 0.102 (0.095) loss_u loss_u 0.9932 (0.9421) acc_u 0.0000 (6.7708) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [35/36] time 0.188 (0.175) data 0.111 (0.097) loss_u loss_u 0.9219 (0.9402) acc_u 9.3750 (6.9643) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 629
confident_label rate tensor(0.2692, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 435
clean true:427
clean false:8
clean_rate:0.9816091954022989
noisy true:560
noisy false:621
after delete: len(clean_dataset) 435
after delete: len(noisy_dataset) 1181
epoch [58/200] batch [5/13] time 0.189 (0.180) data 0.112 (0.102) loss_x loss_x 0.5996 (0.6543) acc_x 78.1250 (82.5000) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/13] time 0.192 (0.187) data 0.114 (0.110) loss_x loss_x 0.9326 (0.6394) acc_x 71.8750 (84.0625) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/36] time 0.173 (0.186) data 0.095 (0.108) loss_u loss_u 0.9619 (0.9463) acc_u 3.1250 (6.8750) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/36] time 0.166 (0.184) data 0.088 (0.106) loss_u loss_u 0.9985 (0.9535) acc_u 0.0000 (5.6250) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [15/36] time 0.176 (0.182) data 0.097 (0.104) loss_u loss_u 0.9502 (0.9420) acc_u 6.2500 (6.8750) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/36] time 0.170 (0.180) data 0.091 (0.102) loss_u loss_u 0.9844 (0.9400) acc_u 0.0000 (7.0312) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/36] time 0.169 (0.180) data 0.090 (0.102) loss_u loss_u 0.9102 (0.9402) acc_u 12.5000 (7.1250) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/36] time 0.203 (0.181) data 0.125 (0.102) loss_u loss_u 0.8770 (0.9364) acc_u 15.6250 (7.6042) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [35/36] time 0.190 (0.180) data 0.112 (0.101) loss_u loss_u 0.9087 (0.9379) acc_u 12.5000 (7.4107) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 622
confident_label rate tensor(0.2692, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 435
clean true:425
clean false:10
clean_rate:0.9770114942528736
noisy true:569
noisy false:612
after delete: len(clean_dataset) 435
after delete: len(noisy_dataset) 1181
epoch [59/200] batch [5/13] time 0.168 (0.167) data 0.091 (0.089) loss_x loss_x 0.7036 (0.6624) acc_x 84.3750 (84.3750) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/13] time 0.172 (0.170) data 0.095 (0.092) loss_x loss_x 0.7080 (0.6205) acc_x 75.0000 (83.1250) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/36] time 0.174 (0.172) data 0.096 (0.094) loss_u loss_u 0.9004 (0.9196) acc_u 15.6250 (10.0000) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/36] time 0.176 (0.173) data 0.097 (0.095) loss_u loss_u 0.9082 (0.9172) acc_u 9.3750 (10.6250) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/36] time 0.184 (0.173) data 0.105 (0.095) loss_u loss_u 0.9141 (0.9232) acc_u 9.3750 (9.5833) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/36] time 0.166 (0.173) data 0.088 (0.095) loss_u loss_u 0.9688 (0.9257) acc_u 3.1250 (9.0625) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [25/36] time 0.167 (0.173) data 0.089 (0.095) loss_u loss_u 0.9302 (0.9296) acc_u 6.2500 (8.5000) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/36] time 0.169 (0.172) data 0.091 (0.094) loss_u loss_u 0.9673 (0.9339) acc_u 3.1250 (7.9167) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [35/36] time 0.179 (0.173) data 0.100 (0.095) loss_u loss_u 0.9917 (0.9340) acc_u 0.0000 (7.7679) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.2642, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 427
clean true:417
clean false:10
clean_rate:0.9765807962529274
noisy true:571
noisy false:618
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1189
epoch [60/200] batch [5/13] time 0.160 (0.165) data 0.082 (0.087) loss_x loss_x 0.5864 (0.6761) acc_x 84.3750 (85.6250) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/13] time 0.182 (0.169) data 0.104 (0.091) loss_x loss_x 0.9854 (0.7143) acc_x 75.0000 (83.1250) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/37] time 0.181 (0.176) data 0.103 (0.098) loss_u loss_u 0.8984 (0.9453) acc_u 12.5000 (6.2500) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [10/37] time 0.212 (0.178) data 0.132 (0.100) loss_u loss_u 0.9849 (0.9459) acc_u 0.0000 (5.9375) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/37] time 0.184 (0.180) data 0.107 (0.101) loss_u loss_u 0.9541 (0.9446) acc_u 9.3750 (6.6667) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [20/37] time 0.158 (0.178) data 0.079 (0.100) loss_u loss_u 0.9453 (0.9398) acc_u 6.2500 (6.8750) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [25/37] time 0.159 (0.177) data 0.082 (0.099) loss_u loss_u 0.9199 (0.9379) acc_u 9.3750 (7.0000) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [30/37] time 0.175 (0.177) data 0.097 (0.098) loss_u loss_u 0.9468 (0.9328) acc_u 6.2500 (7.7083) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [35/37] time 0.189 (0.177) data 0.112 (0.099) loss_u loss_u 0.9424 (0.9338) acc_u 9.3750 (7.6786) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 615
confident_label rate tensor(0.2729, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 441
clean true:429
clean false:12
clean_rate:0.9727891156462585
noisy true:572
noisy false:603
after delete: len(clean_dataset) 441
after delete: len(noisy_dataset) 1175
epoch [61/200] batch [5/13] time 0.188 (0.186) data 0.111 (0.109) loss_x loss_x 0.5591 (0.7090) acc_x 84.3750 (83.7500) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/13] time 0.183 (0.186) data 0.106 (0.108) loss_x loss_x 0.3662 (0.6418) acc_x 87.5000 (84.3750) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/36] time 0.186 (0.185) data 0.109 (0.108) loss_u loss_u 0.9639 (0.9486) acc_u 6.2500 (7.5000) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [10/36] time 0.174 (0.185) data 0.095 (0.108) loss_u loss_u 0.9844 (0.9438) acc_u 3.1250 (7.5000) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [15/36] time 0.177 (0.183) data 0.099 (0.105) loss_u loss_u 0.9639 (0.9452) acc_u 3.1250 (6.8750) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/36] time 0.159 (0.182) data 0.080 (0.104) loss_u loss_u 0.9370 (0.9450) acc_u 6.2500 (6.7188) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [25/36] time 0.172 (0.181) data 0.094 (0.103) loss_u loss_u 0.9521 (0.9450) acc_u 6.2500 (6.5000) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/36] time 0.185 (0.181) data 0.107 (0.103) loss_u loss_u 0.9966 (0.9470) acc_u 0.0000 (6.2500) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [35/36] time 0.171 (0.180) data 0.092 (0.102) loss_u loss_u 0.8857 (0.9421) acc_u 12.5000 (6.9643) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.2791, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 451
clean true:439
clean false:12
clean_rate:0.9733924611973392
noisy true:578
noisy false:587
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1165
epoch [62/200] batch [5/14] time 0.187 (0.178) data 0.110 (0.101) loss_x loss_x 0.9536 (0.7922) acc_x 68.7500 (78.1250) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [10/14] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 0.3789 (0.7564) acc_x 90.6250 (79.0625) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/36] time 0.173 (0.177) data 0.095 (0.099) loss_u loss_u 0.9819 (0.9399) acc_u 3.1250 (7.5000) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/36] time 0.164 (0.175) data 0.086 (0.097) loss_u loss_u 0.9575 (0.9569) acc_u 6.2500 (5.0000) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [15/36] time 0.175 (0.174) data 0.096 (0.096) loss_u loss_u 0.9995 (0.9482) acc_u 0.0000 (6.4583) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/36] time 0.168 (0.176) data 0.090 (0.098) loss_u loss_u 0.9683 (0.9426) acc_u 3.1250 (6.8750) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/36] time 0.171 (0.175) data 0.092 (0.097) loss_u loss_u 0.9346 (0.9458) acc_u 9.3750 (6.5000) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/36] time 0.177 (0.175) data 0.100 (0.097) loss_u loss_u 0.8999 (0.9430) acc_u 15.6250 (6.8750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [35/36] time 0.175 (0.176) data 0.097 (0.097) loss_u loss_u 0.8989 (0.9411) acc_u 9.3750 (7.0536) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 635
confident_label rate tensor(0.2760, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 446
clean true:437
clean false:9
clean_rate:0.9798206278026906
noisy true:544
noisy false:626
after delete: len(clean_dataset) 446
after delete: len(noisy_dataset) 1170
epoch [63/200] batch [5/13] time 0.182 (0.175) data 0.104 (0.097) loss_x loss_x 0.7437 (0.7638) acc_x 75.0000 (80.6250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/13] time 0.181 (0.181) data 0.103 (0.103) loss_x loss_x 0.5581 (0.6770) acc_x 84.3750 (83.1250) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/36] time 0.186 (0.182) data 0.109 (0.104) loss_u loss_u 0.9336 (0.9453) acc_u 9.3750 (5.6250) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/36] time 0.184 (0.183) data 0.106 (0.105) loss_u loss_u 0.9316 (0.9428) acc_u 6.2500 (5.9375) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/36] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9019 (0.9359) acc_u 12.5000 (6.8750) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/36] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.9902 (0.9383) acc_u 3.1250 (7.0312) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [25/36] time 0.217 (0.186) data 0.138 (0.108) loss_u loss_u 0.9673 (0.9376) acc_u 3.1250 (7.1250) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [30/36] time 0.161 (0.184) data 0.083 (0.106) loss_u loss_u 0.9688 (0.9431) acc_u 3.1250 (6.6667) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [35/36] time 0.172 (0.183) data 0.094 (0.105) loss_u loss_u 0.9741 (0.9428) acc_u 3.1250 (6.6964) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.2809, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 454
clean true:443
clean false:11
clean_rate:0.9757709251101322
noisy true:553
noisy false:609
after delete: len(clean_dataset) 454
after delete: len(noisy_dataset) 1162
epoch [64/200] batch [5/14] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.3257 (0.5024) acc_x 90.6250 (86.8750) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/14] time 0.171 (0.181) data 0.093 (0.104) loss_x loss_x 1.1084 (0.6048) acc_x 78.1250 (85.3125) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/36] time 0.198 (0.180) data 0.121 (0.102) loss_u loss_u 0.9888 (0.9394) acc_u 0.0000 (6.8750) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [10/36] time 0.170 (0.181) data 0.092 (0.103) loss_u loss_u 0.9688 (0.9466) acc_u 3.1250 (5.9375) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [15/36] time 0.217 (0.182) data 0.139 (0.105) loss_u loss_u 0.9272 (0.9403) acc_u 9.3750 (6.8750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/36] time 0.178 (0.183) data 0.100 (0.105) loss_u loss_u 0.9961 (0.9452) acc_u 0.0000 (6.2500) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/36] time 0.182 (0.183) data 0.105 (0.105) loss_u loss_u 0.9653 (0.9412) acc_u 3.1250 (6.7500) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [30/36] time 0.171 (0.182) data 0.093 (0.104) loss_u loss_u 0.9644 (0.9381) acc_u 3.1250 (6.9792) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [35/36] time 0.215 (0.182) data 0.137 (0.105) loss_u loss_u 0.9497 (0.9418) acc_u 6.2500 (6.6071) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 619
confident_label rate tensor(0.2772, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 448
clean true:441
clean false:7
clean_rate:0.984375
noisy true:556
noisy false:612
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1168
epoch [65/200] batch [5/14] time 0.163 (0.168) data 0.085 (0.091) loss_x loss_x 0.4888 (0.6132) acc_x 84.3750 (83.7500) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [10/14] time 0.163 (0.165) data 0.085 (0.088) loss_x loss_x 0.5000 (0.6314) acc_x 90.6250 (82.5000) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/36] time 0.183 (0.171) data 0.105 (0.093) loss_u loss_u 0.9683 (0.9371) acc_u 3.1250 (6.8750) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/36] time 0.184 (0.173) data 0.107 (0.096) loss_u loss_u 0.9307 (0.9330) acc_u 12.5000 (8.1250) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/36] time 0.188 (0.175) data 0.109 (0.098) loss_u loss_u 0.9082 (0.9357) acc_u 9.3750 (7.5000) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/36] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.9380 (0.9418) acc_u 6.2500 (6.7188) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/36] time 0.167 (0.177) data 0.089 (0.099) loss_u loss_u 0.8735 (0.9357) acc_u 12.5000 (7.1250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [30/36] time 0.189 (0.176) data 0.110 (0.098) loss_u loss_u 0.9565 (0.9390) acc_u 3.1250 (6.7708) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [35/36] time 0.167 (0.176) data 0.089 (0.098) loss_u loss_u 0.8687 (0.9388) acc_u 12.5000 (6.6964) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 644
confident_label rate tensor(0.2778, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 449
clean true:438
clean false:11
clean_rate:0.9755011135857461
noisy true:534
noisy false:633
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 1167
epoch [66/200] batch [5/14] time 0.174 (0.176) data 0.096 (0.098) loss_x loss_x 1.1572 (1.0951) acc_x 75.0000 (76.2500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/14] time 0.199 (0.182) data 0.121 (0.104) loss_x loss_x 0.8647 (0.8630) acc_x 78.1250 (79.6875) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/36] time 0.187 (0.183) data 0.109 (0.105) loss_u loss_u 0.9390 (0.9251) acc_u 6.2500 (7.5000) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/36] time 0.178 (0.184) data 0.098 (0.106) loss_u loss_u 0.9355 (0.9310) acc_u 6.2500 (7.1875) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/36] time 0.191 (0.184) data 0.113 (0.106) loss_u loss_u 0.9873 (0.9411) acc_u 0.0000 (6.2500) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/36] time 0.170 (0.184) data 0.092 (0.106) loss_u loss_u 0.9092 (0.9365) acc_u 9.3750 (6.8750) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/36] time 0.167 (0.182) data 0.089 (0.103) loss_u loss_u 0.9663 (0.9350) acc_u 3.1250 (7.1250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/36] time 0.169 (0.180) data 0.091 (0.102) loss_u loss_u 0.9668 (0.9348) acc_u 3.1250 (7.1875) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [35/36] time 0.175 (0.180) data 0.097 (0.102) loss_u loss_u 0.8936 (0.9359) acc_u 15.6250 (6.8750) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 612
confident_label rate tensor(0.2822, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 456
clean true:443
clean false:13
clean_rate:0.9714912280701754
noisy true:561
noisy false:599
after delete: len(clean_dataset) 456
after delete: len(noisy_dataset) 1160
epoch [67/200] batch [5/14] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.2881 (0.6817) acc_x 96.8750 (81.8750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/14] time 0.167 (0.180) data 0.090 (0.102) loss_x loss_x 0.4946 (0.6664) acc_x 87.5000 (83.1250) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/36] time 0.166 (0.180) data 0.088 (0.102) loss_u loss_u 0.9941 (0.9463) acc_u 0.0000 (5.6250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/36] time 0.160 (0.175) data 0.081 (0.098) loss_u loss_u 0.9741 (0.9412) acc_u 3.1250 (6.5625) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/36] time 0.172 (0.174) data 0.093 (0.096) loss_u loss_u 0.9775 (0.9492) acc_u 3.1250 (5.8333) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/36] time 0.169 (0.173) data 0.090 (0.096) loss_u loss_u 0.9927 (0.9563) acc_u 0.0000 (4.8438) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [25/36] time 0.161 (0.174) data 0.082 (0.096) loss_u loss_u 0.9282 (0.9516) acc_u 6.2500 (5.3750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/36] time 0.173 (0.174) data 0.095 (0.096) loss_u loss_u 0.9482 (0.9469) acc_u 6.2500 (6.1458) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [35/36] time 0.158 (0.174) data 0.080 (0.096) loss_u loss_u 0.9590 (0.9446) acc_u 6.2500 (6.3393) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.2785, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 450
clean true:438
clean false:12
clean_rate:0.9733333333333334
noisy true:553
noisy false:613
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1166
epoch [68/200] batch [5/14] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.8794 (0.7028) acc_x 68.7500 (80.0000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/14] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.4775 (0.6622) acc_x 84.3750 (80.0000) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/36] time 0.189 (0.183) data 0.111 (0.105) loss_u loss_u 0.9521 (0.9559) acc_u 6.2500 (5.0000) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/36] time 0.182 (0.183) data 0.104 (0.105) loss_u loss_u 0.9385 (0.9481) acc_u 6.2500 (6.2500) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/36] time 0.183 (0.183) data 0.104 (0.105) loss_u loss_u 0.9258 (0.9446) acc_u 6.2500 (6.6667) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [20/36] time 0.183 (0.183) data 0.105 (0.105) loss_u loss_u 0.9390 (0.9435) acc_u 6.2500 (6.4062) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/36] time 0.185 (0.183) data 0.107 (0.105) loss_u loss_u 0.9702 (0.9428) acc_u 3.1250 (6.5000) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [30/36] time 0.182 (0.182) data 0.104 (0.104) loss_u loss_u 0.9199 (0.9426) acc_u 6.2500 (6.4583) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [35/36] time 0.184 (0.182) data 0.106 (0.104) loss_u loss_u 0.9360 (0.9414) acc_u 6.2500 (6.5179) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 592
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 453
clean true:443
clean false:10
clean_rate:0.977924944812362
noisy true:581
noisy false:582
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1163
epoch [69/200] batch [5/14] time 0.182 (0.174) data 0.104 (0.096) loss_x loss_x 0.5796 (0.7394) acc_x 90.6250 (83.7500) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/14] time 0.191 (0.184) data 0.113 (0.106) loss_x loss_x 0.9126 (0.7846) acc_x 78.1250 (80.6250) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/36] time 0.188 (0.185) data 0.108 (0.107) loss_u loss_u 0.8794 (0.9519) acc_u 12.5000 (5.0000) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/36] time 0.190 (0.185) data 0.110 (0.107) loss_u loss_u 0.9351 (0.9452) acc_u 9.3750 (6.2500) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [15/36] time 0.176 (0.185) data 0.098 (0.107) loss_u loss_u 0.9922 (0.9515) acc_u 0.0000 (5.2083) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [20/36] time 0.163 (0.182) data 0.086 (0.104) loss_u loss_u 0.9307 (0.9497) acc_u 6.2500 (5.3125) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [25/36] time 0.182 (0.182) data 0.105 (0.104) loss_u loss_u 0.9243 (0.9475) acc_u 9.3750 (5.6250) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [30/36] time 0.178 (0.181) data 0.100 (0.103) loss_u loss_u 0.9727 (0.9405) acc_u 3.1250 (6.6667) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [35/36] time 0.190 (0.180) data 0.111 (0.102) loss_u loss_u 0.9688 (0.9448) acc_u 3.1250 (6.0714) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.2828, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 457
clean true:446
clean false:11
clean_rate:0.975929978118162
noisy true:586
noisy false:573
after delete: len(clean_dataset) 457
after delete: len(noisy_dataset) 1159
epoch [70/200] batch [5/14] time 0.181 (0.170) data 0.103 (0.092) loss_x loss_x 0.8159 (0.5911) acc_x 75.0000 (83.7500) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/14] time 0.173 (0.174) data 0.095 (0.096) loss_x loss_x 0.3003 (0.5012) acc_x 90.6250 (86.5625) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/36] time 0.163 (0.173) data 0.084 (0.095) loss_u loss_u 0.9199 (0.9271) acc_u 9.3750 (8.1250) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/36] time 0.181 (0.176) data 0.103 (0.098) loss_u loss_u 0.9619 (0.9422) acc_u 3.1250 (6.5625) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/36] time 0.190 (0.178) data 0.110 (0.100) loss_u loss_u 0.9419 (0.9303) acc_u 9.3750 (7.7083) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/36] time 0.181 (0.183) data 0.103 (0.104) loss_u loss_u 0.9448 (0.9363) acc_u 6.2500 (7.0312) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/36] time 0.209 (0.183) data 0.129 (0.105) loss_u loss_u 0.9551 (0.9376) acc_u 6.2500 (7.1250) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [30/36] time 0.185 (0.183) data 0.107 (0.105) loss_u loss_u 0.9717 (0.9398) acc_u 3.1250 (6.8750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [35/36] time 0.164 (0.182) data 0.087 (0.104) loss_u loss_u 0.9355 (0.9401) acc_u 6.2500 (6.6964) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 594
confident_label rate tensor(0.2828, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 457
clean true:444
clean false:13
clean_rate:0.9715536105032823
noisy true:578
noisy false:581
after delete: len(clean_dataset) 457
after delete: len(noisy_dataset) 1159
epoch [71/200] batch [5/14] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.4980 (0.7936) acc_x 90.6250 (81.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [10/14] time 0.183 (0.188) data 0.105 (0.111) loss_x loss_x 0.4924 (0.7156) acc_x 87.5000 (82.8125) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/36] time 0.187 (0.185) data 0.110 (0.108) loss_u loss_u 0.9600 (0.9179) acc_u 3.1250 (8.7500) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/36] time 0.169 (0.184) data 0.091 (0.107) loss_u loss_u 0.9233 (0.9301) acc_u 6.2500 (7.5000) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [15/36] time 0.168 (0.182) data 0.090 (0.105) loss_u loss_u 0.9668 (0.9396) acc_u 6.2500 (6.6667) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [20/36] time 0.167 (0.180) data 0.089 (0.102) loss_u loss_u 0.8813 (0.9369) acc_u 12.5000 (7.0312) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/36] time 0.168 (0.179) data 0.090 (0.101) loss_u loss_u 0.9053 (0.9361) acc_u 12.5000 (7.5000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [30/36] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.8716 (0.9361) acc_u 12.5000 (7.2917) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [35/36] time 0.182 (0.177) data 0.104 (0.099) loss_u loss_u 0.9419 (0.9391) acc_u 6.2500 (6.8750) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 604
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 453
clean true:444
clean false:9
clean_rate:0.9801324503311258
noisy true:568
noisy false:595
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1163
epoch [72/200] batch [5/14] time 0.210 (0.180) data 0.133 (0.102) loss_x loss_x 0.6978 (0.6996) acc_x 87.5000 (81.8750) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/14] time 0.206 (0.189) data 0.129 (0.111) loss_x loss_x 0.2411 (0.6803) acc_x 96.8750 (83.7500) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/36] time 0.174 (0.180) data 0.089 (0.102) loss_u loss_u 0.9653 (0.9328) acc_u 3.1250 (7.5000) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/36] time 0.177 (0.187) data 0.100 (0.104) loss_u loss_u 0.9331 (0.9360) acc_u 6.2500 (7.1875) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/36] time 0.185 (0.186) data 0.107 (0.104) loss_u loss_u 0.9136 (0.9337) acc_u 9.3750 (7.5000) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [20/36] time 0.206 (0.202) data 0.129 (0.121) loss_u loss_u 0.9165 (0.9355) acc_u 9.3750 (7.3438) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [25/36] time 0.172 (0.198) data 0.095 (0.117) loss_u loss_u 0.9766 (0.9343) acc_u 3.1250 (7.5000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [30/36] time 0.167 (0.195) data 0.089 (0.114) loss_u loss_u 0.9312 (0.9392) acc_u 6.2500 (6.9792) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [35/36] time 0.158 (0.192) data 0.079 (0.111) loss_u loss_u 0.9829 (0.9429) acc_u 3.1250 (6.6071) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.2822, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 456
clean true:447
clean false:9
clean_rate:0.9802631578947368
noisy true:608
noisy false:552
after delete: len(clean_dataset) 456
after delete: len(noisy_dataset) 1160
epoch [73/200] batch [5/14] time 0.208 (0.188) data 0.131 (0.111) loss_x loss_x 0.8730 (0.8957) acc_x 90.6250 (81.2500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/14] time 0.182 (0.186) data 0.104 (0.108) loss_x loss_x 0.8276 (0.7979) acc_x 81.2500 (82.5000) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/36] time 0.162 (0.181) data 0.084 (0.103) loss_u loss_u 0.9873 (0.9555) acc_u 0.0000 (5.0000) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/36] time 0.179 (0.185) data 0.101 (0.108) loss_u loss_u 0.8984 (0.9361) acc_u 12.5000 (7.1875) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [15/36] time 0.234 (0.187) data 0.093 (0.107) loss_u loss_u 0.9546 (0.9354) acc_u 6.2500 (7.5000) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/36] time 0.183 (0.191) data 0.104 (0.108) loss_u loss_u 0.8086 (0.9326) acc_u 25.0000 (8.2812) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [25/36] time 0.213 (0.192) data 0.134 (0.110) loss_u loss_u 0.9058 (0.9350) acc_u 12.5000 (8.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [30/36] time 0.161 (0.190) data 0.084 (0.108) loss_u loss_u 0.9990 (0.9330) acc_u 0.0000 (8.4375) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [35/36] time 0.162 (0.187) data 0.085 (0.106) loss_u loss_u 0.9790 (0.9358) acc_u 3.1250 (7.8571) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 591
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 453
clean true:445
clean false:8
clean_rate:0.9823399558498896
noisy true:580
noisy false:583
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1163
epoch [74/200] batch [5/14] time 0.159 (0.185) data 0.082 (0.082) loss_x loss_x 0.9595 (0.7569) acc_x 78.1250 (81.8750) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/14] time 0.171 (0.177) data 0.093 (0.087) loss_x loss_x 0.6641 (0.6901) acc_x 87.5000 (84.0625) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/36] time 0.161 (0.177) data 0.083 (0.092) loss_u loss_u 0.9014 (0.9194) acc_u 9.3750 (9.3750) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/36] time 0.182 (0.177) data 0.105 (0.094) loss_u loss_u 0.8691 (0.9235) acc_u 15.6250 (9.6875) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/36] time 0.225 (0.177) data 0.148 (0.095) loss_u loss_u 0.9731 (0.9344) acc_u 3.1250 (7.9167) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/36] time 0.161 (0.176) data 0.084 (0.095) loss_u loss_u 0.9429 (0.9325) acc_u 3.1250 (7.8125) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/36] time 0.171 (0.179) data 0.093 (0.095) loss_u loss_u 0.8921 (0.9286) acc_u 12.5000 (8.2500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [30/36] time 0.165 (0.179) data 0.087 (0.095) loss_u loss_u 0.9297 (0.9290) acc_u 6.2500 (8.1250) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [35/36] time 0.172 (0.179) data 0.094 (0.096) loss_u loss_u 0.9946 (0.9341) acc_u 3.1250 (7.5000) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.2871, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 464
clean true:450
clean false:14
clean_rate:0.9698275862068966
noisy true:597
noisy false:555
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1152
epoch [75/200] batch [5/14] time 0.158 (0.163) data 0.080 (0.085) loss_x loss_x 0.6128 (0.6009) acc_x 93.7500 (88.7500) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/14] time 0.164 (0.164) data 0.087 (0.086) loss_x loss_x 0.3928 (0.5833) acc_x 87.5000 (86.5625) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/36] time 0.175 (0.171) data 0.097 (0.087) loss_u loss_u 0.9712 (0.9536) acc_u 3.1250 (6.2500) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [10/36] time 0.170 (0.170) data 0.092 (0.087) loss_u loss_u 0.9922 (0.9463) acc_u 0.0000 (6.5625) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/36] time 0.169 (0.171) data 0.091 (0.089) loss_u loss_u 0.9072 (0.9421) acc_u 12.5000 (7.0833) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/36] time 0.162 (0.170) data 0.084 (0.088) loss_u loss_u 0.9370 (0.9422) acc_u 6.2500 (6.7188) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/36] time 0.166 (0.170) data 0.088 (0.088) loss_u loss_u 0.9302 (0.9434) acc_u 9.3750 (6.7500) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [30/36] time 0.165 (0.169) data 0.085 (0.088) loss_u loss_u 0.9297 (0.9444) acc_u 9.3750 (6.6667) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [35/36] time 0.305 (0.172) data 0.113 (0.089) loss_u loss_u 0.9629 (0.9440) acc_u 6.2500 (6.7857) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 608
confident_label rate tensor(0.2908, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 470
clean true:456
clean false:14
clean_rate:0.9702127659574468
noisy true:552
noisy false:594
after delete: len(clean_dataset) 470
after delete: len(noisy_dataset) 1146
epoch [76/200] batch [5/14] time 0.177 (0.198) data 0.101 (0.119) loss_x loss_x 0.5376 (0.6946) acc_x 84.3750 (81.8750) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [10/14] time 0.167 (0.190) data 0.090 (0.112) loss_x loss_x 0.9282 (0.7527) acc_x 71.8750 (80.9375) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/35] time 0.192 (0.193) data 0.114 (0.110) loss_u loss_u 0.9834 (0.9605) acc_u 0.0000 (4.3750) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/35] time 0.213 (0.193) data 0.136 (0.110) loss_u loss_u 0.9707 (0.9471) acc_u 3.1250 (5.9375) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [15/35] time 0.181 (0.191) data 0.103 (0.109) loss_u loss_u 0.9028 (0.9472) acc_u 12.5000 (5.6250) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/35] time 0.177 (0.190) data 0.099 (0.109) loss_u loss_u 0.9702 (0.9449) acc_u 6.2500 (5.9375) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/35] time 0.178 (0.189) data 0.100 (0.109) loss_u loss_u 0.9663 (0.9443) acc_u 6.2500 (6.1250) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [30/35] time 0.178 (0.189) data 0.099 (0.109) loss_u loss_u 0.9536 (0.9452) acc_u 6.2500 (6.0417) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [35/35] time 0.190 (0.192) data 0.112 (0.109) loss_u loss_u 0.9639 (0.9465) acc_u 3.1250 (5.8036) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.2840, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 459
clean true:449
clean false:10
clean_rate:0.9782135076252724
noisy true:569
noisy false:588
after delete: len(clean_dataset) 459
after delete: len(noisy_dataset) 1157
epoch [77/200] batch [5/14] time 0.157 (0.162) data 0.079 (0.085) loss_x loss_x 0.8628 (0.8843) acc_x 81.2500 (80.0000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/14] time 0.178 (0.169) data 0.101 (0.091) loss_x loss_x 0.7969 (0.7214) acc_x 78.1250 (84.3750) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/36] time 0.163 (0.179) data 0.085 (0.094) loss_u loss_u 0.9712 (0.9532) acc_u 3.1250 (4.3750) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/36] time 0.163 (0.179) data 0.086 (0.096) loss_u loss_u 0.8784 (0.9312) acc_u 15.6250 (7.1875) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/36] time 0.178 (0.177) data 0.100 (0.095) loss_u loss_u 0.9321 (0.9332) acc_u 6.2500 (6.8750) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/36] time 0.164 (0.178) data 0.086 (0.096) loss_u loss_u 0.9307 (0.9385) acc_u 6.2500 (6.2500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/36] time 0.187 (0.177) data 0.109 (0.096) loss_u loss_u 0.9385 (0.9373) acc_u 9.3750 (6.7500) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/36] time 0.182 (0.178) data 0.105 (0.097) loss_u loss_u 0.9370 (0.9399) acc_u 6.2500 (6.5625) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [35/36] time 0.183 (0.180) data 0.105 (0.098) loss_u loss_u 0.9941 (0.9408) acc_u 0.0000 (6.6071) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.2840, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 459
clean true:449
clean false:10
clean_rate:0.9782135076252724
noisy true:583
noisy false:574
after delete: len(clean_dataset) 459
after delete: len(noisy_dataset) 1157
epoch [78/200] batch [5/14] time 0.174 (0.180) data 0.096 (0.102) loss_x loss_x 0.7734 (0.7078) acc_x 81.2500 (79.3750) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/14] time 0.186 (0.177) data 0.108 (0.100) loss_x loss_x 0.5312 (0.6730) acc_x 75.0000 (80.3125) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/36] time 0.170 (0.185) data 0.093 (0.102) loss_u loss_u 0.9438 (0.9539) acc_u 6.2500 (5.0000) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/36] time 0.159 (0.183) data 0.081 (0.101) loss_u loss_u 0.9385 (0.9556) acc_u 6.2500 (5.0000) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/36] time 0.165 (0.183) data 0.088 (0.102) loss_u loss_u 0.9678 (0.9505) acc_u 3.1250 (5.4167) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/36] time 0.159 (0.181) data 0.081 (0.101) loss_u loss_u 0.9673 (0.9400) acc_u 3.1250 (6.8750) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/36] time 0.158 (0.178) data 0.081 (0.098) loss_u loss_u 0.9258 (0.9385) acc_u 9.3750 (7.0000) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [30/36] time 0.160 (0.176) data 0.082 (0.096) loss_u loss_u 0.9497 (0.9359) acc_u 6.2500 (7.2917) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [35/36] time 0.156 (0.174) data 0.078 (0.094) loss_u loss_u 0.9365 (0.9333) acc_u 6.2500 (7.5893) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 600
confident_label rate tensor(0.2772, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 448
clean true:437
clean false:11
clean_rate:0.9754464285714286
noisy true:579
noisy false:589
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1168
epoch [79/200] batch [5/14] time 0.165 (0.198) data 0.088 (0.120) loss_x loss_x 0.7446 (0.5203) acc_x 68.7500 (86.2500) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/14] time 0.164 (0.180) data 0.087 (0.103) loss_x loss_x 0.5840 (0.5565) acc_x 78.1250 (83.4375) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/36] time 0.169 (0.184) data 0.091 (0.100) loss_u loss_u 0.9751 (0.9440) acc_u 3.1250 (6.2500) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/36] time 0.190 (0.182) data 0.112 (0.100) loss_u loss_u 0.9487 (0.9414) acc_u 6.2500 (6.5625) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/36] time 0.180 (0.181) data 0.103 (0.099) loss_u loss_u 0.9331 (0.9298) acc_u 9.3750 (8.3333) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [20/36] time 0.178 (0.180) data 0.101 (0.098) loss_u loss_u 0.8989 (0.9307) acc_u 9.3750 (7.6562) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/36] time 0.180 (0.179) data 0.101 (0.099) loss_u loss_u 0.9946 (0.9321) acc_u 0.0000 (7.5000) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [30/36] time 0.189 (0.181) data 0.111 (0.100) loss_u loss_u 0.9790 (0.9363) acc_u 3.1250 (7.0833) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [35/36] time 0.185 (0.181) data 0.108 (0.100) loss_u loss_u 0.9419 (0.9302) acc_u 9.3750 (8.0357) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 565
confident_label rate tensor(0.2890, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 467
clean true:456
clean false:11
clean_rate:0.9764453961456103
noisy true:595
noisy false:554
after delete: len(clean_dataset) 467
after delete: len(noisy_dataset) 1149
epoch [80/200] batch [5/14] time 0.164 (0.167) data 0.086 (0.089) loss_x loss_x 1.2695 (0.9307) acc_x 78.1250 (77.5000) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [10/14] time 0.158 (0.165) data 0.080 (0.087) loss_x loss_x 0.6221 (0.7326) acc_x 84.3750 (81.8750) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/35] time 0.159 (0.162) data 0.081 (0.084) loss_u loss_u 0.9404 (0.9568) acc_u 9.3750 (5.6250) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [10/35] time 0.156 (0.161) data 0.079 (0.084) loss_u loss_u 0.9229 (0.9529) acc_u 9.3750 (5.9375) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/35] time 0.156 (0.160) data 0.079 (0.083) loss_u loss_u 0.9702 (0.9494) acc_u 3.1250 (6.2500) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/35] time 0.160 (0.164) data 0.082 (0.083) loss_u loss_u 0.9136 (0.9491) acc_u 12.5000 (6.2500) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/35] time 0.187 (0.167) data 0.109 (0.086) loss_u loss_u 0.9097 (0.9468) acc_u 12.5000 (6.3750) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [30/35] time 0.172 (0.167) data 0.094 (0.087) loss_u loss_u 0.9355 (0.9433) acc_u 9.3750 (7.0833) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [35/35] time 0.167 (0.168) data 0.089 (0.087) loss_u loss_u 0.9209 (0.9425) acc_u 9.3750 (7.1429) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 594
confident_label rate tensor(0.2828, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 457
clean true:449
clean false:8
clean_rate:0.9824945295404814
noisy true:573
noisy false:586
after delete: len(clean_dataset) 457
after delete: len(noisy_dataset) 1159
epoch [81/200] batch [5/14] time 0.177 (0.208) data 0.100 (0.115) loss_x loss_x 0.7749 (0.7252) acc_x 78.1250 (83.1250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/14] time 0.161 (0.187) data 0.083 (0.101) loss_x loss_x 0.2627 (0.5704) acc_x 93.7500 (85.0000) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/36] time 0.182 (0.181) data 0.103 (0.099) loss_u loss_u 0.9390 (0.9058) acc_u 6.2500 (10.6250) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [10/36] time 0.168 (0.178) data 0.090 (0.097) loss_u loss_u 0.9146 (0.9183) acc_u 12.5000 (9.6875) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [15/36] time 0.187 (0.181) data 0.109 (0.100) loss_u loss_u 0.9395 (0.9217) acc_u 6.2500 (9.3750) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/36] time 0.167 (0.179) data 0.089 (0.099) loss_u loss_u 0.9341 (0.9207) acc_u 6.2500 (9.2188) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/36] time 0.167 (0.179) data 0.089 (0.099) loss_u loss_u 0.9390 (0.9239) acc_u 6.2500 (8.8750) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [30/36] time 0.186 (0.182) data 0.109 (0.100) loss_u loss_u 0.9683 (0.9304) acc_u 3.1250 (8.1250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [35/36] time 0.174 (0.184) data 0.095 (0.102) loss_u loss_u 0.9243 (0.9332) acc_u 9.3750 (7.8571) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 609
confident_label rate tensor(0.2847, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 460
clean true:449
clean false:11
clean_rate:0.9760869565217392
noisy true:558
noisy false:598
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1156
epoch [82/200] batch [5/14] time 0.157 (0.160) data 0.080 (0.082) loss_x loss_x 0.6592 (0.6276) acc_x 81.2500 (83.7500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [10/14] time 0.188 (0.167) data 0.110 (0.090) loss_x loss_x 0.7148 (0.5701) acc_x 81.2500 (85.3125) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/36] time 0.239 (0.183) data 0.161 (0.099) loss_u loss_u 0.9941 (0.9673) acc_u 0.0000 (3.1250) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/36] time 0.161 (0.180) data 0.082 (0.097) loss_u loss_u 0.9175 (0.9388) acc_u 9.3750 (6.8750) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/36] time 0.164 (0.179) data 0.086 (0.097) loss_u loss_u 0.8706 (0.9310) acc_u 15.6250 (8.1250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/36] time 0.166 (0.178) data 0.088 (0.096) loss_u loss_u 0.9126 (0.9317) acc_u 9.3750 (8.1250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/36] time 0.169 (0.177) data 0.091 (0.096) loss_u loss_u 0.8701 (0.9298) acc_u 15.6250 (8.2500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [30/36] time 0.248 (0.178) data 0.170 (0.097) loss_u loss_u 0.9214 (0.9324) acc_u 9.3750 (7.9167) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [35/36] time 0.205 (0.178) data 0.089 (0.097) loss_u loss_u 0.9795 (0.9340) acc_u 3.1250 (7.8571) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.2865, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 463
clean true:447
clean false:16
clean_rate:0.9654427645788337
noisy true:546
noisy false:607
after delete: len(clean_dataset) 463
after delete: len(noisy_dataset) 1153
epoch [83/200] batch [5/14] time 0.188 (0.175) data 0.110 (0.098) loss_x loss_x 0.8999 (0.6978) acc_x 78.1250 (81.8750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/14] time 0.204 (0.176) data 0.126 (0.098) loss_x loss_x 0.9126 (0.5978) acc_x 78.1250 (85.6250) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/36] time 0.185 (0.180) data 0.107 (0.102) loss_u loss_u 0.8867 (0.9201) acc_u 12.5000 (9.3750) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/36] time 0.213 (0.181) data 0.134 (0.103) loss_u loss_u 0.9214 (0.9135) acc_u 6.2500 (9.3750) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/36] time 0.177 (0.186) data 0.098 (0.104) loss_u loss_u 0.8623 (0.9245) acc_u 15.6250 (8.3333) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [20/36] time 0.183 (0.186) data 0.106 (0.105) loss_u loss_u 0.9863 (0.9304) acc_u 0.0000 (7.6562) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/36] time 0.179 (0.186) data 0.101 (0.105) loss_u loss_u 0.9580 (0.9356) acc_u 3.1250 (7.0000) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [30/36] time 0.156 (0.184) data 0.078 (0.103) loss_u loss_u 0.9722 (0.9386) acc_u 3.1250 (6.9792) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [35/36] time 0.161 (0.181) data 0.083 (0.101) loss_u loss_u 0.9766 (0.9434) acc_u 3.1250 (6.4286) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 462
clean true:450
clean false:12
clean_rate:0.974025974025974
noisy true:569
noisy false:585
after delete: len(clean_dataset) 462
after delete: len(noisy_dataset) 1154
epoch [84/200] batch [5/14] time 0.183 (0.170) data 0.106 (0.093) loss_x loss_x 1.2764 (0.6984) acc_x 75.0000 (85.0000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/14] time 0.162 (0.172) data 0.083 (0.095) loss_x loss_x 0.5317 (0.6773) acc_x 84.3750 (83.1250) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/36] time 0.172 (0.177) data 0.095 (0.099) loss_u loss_u 0.9561 (0.9536) acc_u 6.2500 (6.2500) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/36] time 0.212 (0.177) data 0.133 (0.099) loss_u loss_u 0.8643 (0.9407) acc_u 18.7500 (7.5000) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/36] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.8467 (0.9392) acc_u 15.6250 (7.2917) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/36] time 0.170 (0.176) data 0.092 (0.098) loss_u loss_u 0.8809 (0.9360) acc_u 15.6250 (7.8125) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/36] time 0.187 (0.178) data 0.108 (0.098) loss_u loss_u 0.9307 (0.9381) acc_u 6.2500 (7.2500) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [30/36] time 0.181 (0.178) data 0.103 (0.098) loss_u loss_u 0.9551 (0.9347) acc_u 6.2500 (7.7083) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [35/36] time 0.185 (0.179) data 0.106 (0.099) loss_u loss_u 0.9287 (0.9382) acc_u 9.3750 (7.3214) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.2853, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 461
clean true:450
clean false:11
clean_rate:0.9761388286334056
noisy true:567
noisy false:588
after delete: len(clean_dataset) 461
after delete: len(noisy_dataset) 1155
epoch [85/200] batch [5/14] time 0.201 (0.180) data 0.124 (0.102) loss_x loss_x 0.4089 (0.4974) acc_x 90.6250 (87.5000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/14] time 0.163 (0.184) data 0.085 (0.095) loss_x loss_x 0.3457 (0.4798) acc_x 87.5000 (86.8750) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/36] time 0.158 (0.176) data 0.080 (0.092) loss_u loss_u 0.9253 (0.9292) acc_u 9.3750 (9.3750) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/36] time 0.160 (0.173) data 0.081 (0.090) loss_u loss_u 0.9937 (0.9428) acc_u 0.0000 (6.8750) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [15/36] time 0.160 (0.170) data 0.082 (0.088) loss_u loss_u 0.9316 (0.9408) acc_u 6.2500 (7.0833) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/36] time 0.162 (0.169) data 0.084 (0.088) loss_u loss_u 0.9531 (0.9383) acc_u 6.2500 (7.3438) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/36] time 0.185 (0.172) data 0.106 (0.088) loss_u loss_u 0.9795 (0.9379) acc_u 0.0000 (7.1250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [30/36] time 0.175 (0.172) data 0.097 (0.089) loss_u loss_u 0.9688 (0.9411) acc_u 3.1250 (6.7708) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [35/36] time 0.182 (0.173) data 0.104 (0.090) loss_u loss_u 0.8823 (0.9394) acc_u 12.5000 (6.8750) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.2884, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 466
clean true:455
clean false:11
clean_rate:0.9763948497854077
noisy true:592
noisy false:558
after delete: len(clean_dataset) 466
after delete: len(noisy_dataset) 1150
epoch [86/200] batch [5/14] time 0.224 (0.206) data 0.147 (0.106) loss_x loss_x 0.3110 (0.6411) acc_x 93.7500 (86.2500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [10/14] time 0.171 (0.196) data 0.094 (0.108) loss_x loss_x 0.4358 (0.6206) acc_x 93.7500 (85.9375) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/35] time 0.171 (0.186) data 0.093 (0.102) loss_u loss_u 0.9009 (0.9442) acc_u 12.5000 (6.2500) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/35] time 0.187 (0.187) data 0.109 (0.104) loss_u loss_u 0.9565 (0.9451) acc_u 9.3750 (6.5625) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/35] time 0.179 (0.186) data 0.101 (0.104) loss_u loss_u 0.9312 (0.9381) acc_u 6.2500 (7.0833) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [20/35] time 0.167 (0.186) data 0.089 (0.105) loss_u loss_u 0.9805 (0.9383) acc_u 3.1250 (7.1875) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/35] time 0.165 (0.190) data 0.086 (0.104) loss_u loss_u 0.9424 (0.9374) acc_u 6.2500 (7.2500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [30/35] time 0.166 (0.188) data 0.089 (0.102) loss_u loss_u 0.9521 (0.9371) acc_u 6.2500 (7.3958) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [35/35] time 0.195 (0.187) data 0.118 (0.102) loss_u loss_u 0.9072 (0.9384) acc_u 9.3750 (7.3214) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.2816, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 455
clean true:442
clean false:13
clean_rate:0.9714285714285714
noisy true:549
noisy false:612
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1161
epoch [87/200] batch [5/14] time 0.174 (0.174) data 0.097 (0.096) loss_x loss_x 0.6997 (0.6973) acc_x 75.0000 (80.6250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/14] time 0.167 (0.174) data 0.090 (0.096) loss_x loss_x 0.2544 (0.6406) acc_x 93.7500 (83.1250) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/36] time 0.159 (0.188) data 0.082 (0.100) loss_u loss_u 0.9438 (0.9406) acc_u 6.2500 (6.2500) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/36] time 0.166 (0.185) data 0.089 (0.100) loss_u loss_u 0.9087 (0.9324) acc_u 9.3750 (7.5000) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/36] time 0.192 (0.184) data 0.114 (0.100) loss_u loss_u 0.9980 (0.9331) acc_u 0.0000 (7.5000) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/36] time 0.180 (0.183) data 0.101 (0.100) loss_u loss_u 0.9365 (0.9315) acc_u 6.2500 (7.3438) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/36] time 0.182 (0.183) data 0.103 (0.100) loss_u loss_u 0.9595 (0.9345) acc_u 6.2500 (7.1250) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [30/36] time 0.191 (0.183) data 0.113 (0.101) loss_u loss_u 0.8872 (0.9365) acc_u 15.6250 (7.0833) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [35/36] time 0.183 (0.183) data 0.105 (0.101) loss_u loss_u 0.9106 (0.9333) acc_u 12.5000 (7.5893) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.2816, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 455
clean true:445
clean false:10
clean_rate:0.978021978021978
noisy true:593
noisy false:568
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1161
epoch [88/200] batch [5/14] time 0.223 (0.198) data 0.145 (0.120) loss_x loss_x 0.6660 (0.6044) acc_x 87.5000 (87.5000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/14] time 0.156 (0.195) data 0.078 (0.118) loss_x loss_x 0.3635 (0.4634) acc_x 93.7500 (90.6250) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/36] time 0.170 (0.183) data 0.091 (0.106) loss_u loss_u 0.9722 (0.9557) acc_u 3.1250 (5.0000) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [10/36] time 0.168 (0.185) data 0.090 (0.103) loss_u loss_u 0.9741 (0.9431) acc_u 3.1250 (6.5625) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/36] time 0.167 (0.181) data 0.089 (0.099) loss_u loss_u 0.9985 (0.9467) acc_u 0.0000 (6.0417) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/36] time 0.181 (0.181) data 0.103 (0.099) loss_u loss_u 0.9604 (0.9411) acc_u 6.2500 (6.8750) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/36] time 0.248 (0.183) data 0.171 (0.102) loss_u loss_u 0.9648 (0.9436) acc_u 3.1250 (6.3750) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [30/36] time 0.162 (0.182) data 0.084 (0.101) loss_u loss_u 0.9692 (0.9439) acc_u 3.1250 (6.5625) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [35/36] time 0.169 (0.181) data 0.090 (0.100) loss_u loss_u 0.9917 (0.9428) acc_u 0.0000 (6.6071) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 462
clean true:449
clean false:13
clean_rate:0.9718614718614719
noisy true:570
noisy false:584
after delete: len(clean_dataset) 462
after delete: len(noisy_dataset) 1154
epoch [89/200] batch [5/14] time 0.185 (0.180) data 0.107 (0.102) loss_x loss_x 0.7549 (0.5884) acc_x 84.3750 (85.6250) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [10/14] time 0.157 (0.172) data 0.079 (0.094) loss_x loss_x 1.0127 (0.6212) acc_x 75.0000 (84.6875) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/36] time 0.165 (0.173) data 0.088 (0.095) loss_u loss_u 0.8711 (0.9063) acc_u 15.6250 (10.6250) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/36] time 0.166 (0.174) data 0.087 (0.096) loss_u loss_u 0.9175 (0.9166) acc_u 9.3750 (10.0000) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/36] time 0.169 (0.174) data 0.090 (0.096) loss_u loss_u 0.8794 (0.9246) acc_u 15.6250 (9.3750) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/36] time 0.169 (0.177) data 0.091 (0.096) loss_u loss_u 0.9185 (0.9242) acc_u 9.3750 (9.2188) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/36] time 0.173 (0.176) data 0.094 (0.096) loss_u loss_u 0.9712 (0.9310) acc_u 3.1250 (8.3750) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [30/36] time 0.181 (0.177) data 0.103 (0.096) loss_u loss_u 0.8696 (0.9326) acc_u 12.5000 (8.0208) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [35/36] time 0.197 (0.177) data 0.118 (0.097) loss_u loss_u 0.9712 (0.9343) acc_u 3.1250 (7.8571) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 580
confident_label rate tensor(0.2884, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 466
clean true:453
clean false:13
clean_rate:0.9721030042918455
noisy true:583
noisy false:567
after delete: len(clean_dataset) 466
after delete: len(noisy_dataset) 1150
epoch [90/200] batch [5/14] time 0.178 (0.170) data 0.100 (0.093) loss_x loss_x 0.6206 (0.7086) acc_x 84.3750 (82.5000) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [10/14] time 0.168 (0.168) data 0.090 (0.090) loss_x loss_x 0.7349 (0.7376) acc_x 81.2500 (80.6250) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/35] time 0.169 (0.172) data 0.091 (0.095) loss_u loss_u 0.9185 (0.9420) acc_u 9.3750 (6.8750) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/35] time 0.171 (0.174) data 0.093 (0.096) loss_u loss_u 0.9429 (0.9559) acc_u 6.2500 (5.3125) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/35] time 0.162 (0.173) data 0.085 (0.095) loss_u loss_u 0.9497 (0.9563) acc_u 6.2500 (5.2083) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/35] time 0.171 (0.173) data 0.093 (0.096) loss_u loss_u 0.9194 (0.9509) acc_u 9.3750 (5.9375) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/35] time 0.193 (0.179) data 0.113 (0.098) loss_u loss_u 0.9907 (0.9487) acc_u 3.1250 (6.2500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [30/35] time 0.211 (0.180) data 0.132 (0.099) loss_u loss_u 0.9697 (0.9475) acc_u 3.1250 (6.5625) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [35/35] time 0.179 (0.180) data 0.101 (0.100) loss_u loss_u 0.9111 (0.9429) acc_u 9.3750 (7.1429) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 587
confident_label rate tensor(0.2952, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 477
clean true:461
clean false:16
clean_rate:0.9664570230607966
noisy true:568
noisy false:571
after delete: len(clean_dataset) 477
after delete: len(noisy_dataset) 1139
epoch [91/200] batch [5/14] time 0.163 (0.174) data 0.085 (0.096) loss_x loss_x 0.5371 (0.6953) acc_x 84.3750 (79.3750) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [10/14] time 0.283 (0.207) data 0.095 (0.107) loss_x loss_x 1.1582 (0.6544) acc_x 68.7500 (82.5000) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/35] time 0.157 (0.188) data 0.079 (0.098) loss_u loss_u 0.9990 (0.9344) acc_u 0.0000 (8.1250) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/35] time 0.160 (0.182) data 0.082 (0.095) loss_u loss_u 0.9199 (0.9375) acc_u 9.3750 (7.5000) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/35] time 0.159 (0.178) data 0.082 (0.092) loss_u loss_u 0.9766 (0.9357) acc_u 3.1250 (8.1250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/35] time 0.163 (0.175) data 0.085 (0.091) loss_u loss_u 0.9673 (0.9381) acc_u 6.2500 (7.6562) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/35] time 0.183 (0.177) data 0.105 (0.093) loss_u loss_u 0.9385 (0.9380) acc_u 6.2500 (7.5000) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [30/35] time 0.256 (0.179) data 0.103 (0.094) loss_u loss_u 0.9570 (0.9395) acc_u 6.2500 (7.1875) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [35/35] time 0.186 (0.181) data 0.108 (0.095) loss_u loss_u 0.9365 (0.9418) acc_u 6.2500 (6.7857) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.2853, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 461
clean true:449
clean false:12
clean_rate:0.9739696312364425
noisy true:583
noisy false:572
after delete: len(clean_dataset) 461
after delete: len(noisy_dataset) 1155
epoch [92/200] batch [5/14] time 0.173 (0.178) data 0.096 (0.100) loss_x loss_x 0.7300 (0.7810) acc_x 81.2500 (81.2500) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/14] time 0.210 (0.190) data 0.132 (0.112) loss_x loss_x 0.2335 (0.7587) acc_x 96.8750 (82.1875) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/36] time 0.183 (0.185) data 0.105 (0.107) loss_u loss_u 0.9668 (0.9424) acc_u 6.2500 (7.5000) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/36] time 0.211 (0.193) data 0.133 (0.107) loss_u loss_u 0.9668 (0.9289) acc_u 3.1250 (8.7500) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [15/36] time 0.174 (0.192) data 0.094 (0.107) loss_u loss_u 0.9829 (0.9333) acc_u 3.1250 (7.9167) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [20/36] time 0.160 (0.190) data 0.082 (0.105) loss_u loss_u 0.9692 (0.9376) acc_u 3.1250 (7.5000) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [25/36] time 0.166 (0.187) data 0.088 (0.104) loss_u loss_u 0.9243 (0.9379) acc_u 9.3750 (7.3750) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [30/36] time 0.168 (0.184) data 0.089 (0.101) loss_u loss_u 0.9395 (0.9346) acc_u 9.3750 (7.8125) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [35/36] time 0.192 (0.184) data 0.113 (0.102) loss_u loss_u 0.9302 (0.9338) acc_u 9.3750 (7.8571) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 583
confident_label rate tensor(0.2871, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 464
clean true:455
clean false:9
clean_rate:0.9806034482758621
noisy true:578
noisy false:574
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1152
epoch [93/200] batch [5/14] time 0.167 (0.187) data 0.090 (0.109) loss_x loss_x 0.5801 (0.6294) acc_x 84.3750 (85.6250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [10/14] time 0.160 (0.175) data 0.082 (0.098) loss_x loss_x 0.8203 (0.5602) acc_x 78.1250 (86.2500) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/36] time 0.163 (0.184) data 0.085 (0.099) loss_u loss_u 0.9707 (0.9437) acc_u 3.1250 (6.2500) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/36] time 0.190 (0.181) data 0.113 (0.098) loss_u loss_u 0.9985 (0.9386) acc_u 0.0000 (7.1875) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/36] time 0.179 (0.180) data 0.101 (0.098) loss_u loss_u 0.9360 (0.9347) acc_u 6.2500 (7.2917) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/36] time 0.187 (0.181) data 0.109 (0.099) loss_u loss_u 0.9292 (0.9322) acc_u 9.3750 (7.5000) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/36] time 0.183 (0.181) data 0.104 (0.100) loss_u loss_u 0.9756 (0.9362) acc_u 3.1250 (7.2500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [30/36] time 0.185 (0.181) data 0.107 (0.100) loss_u loss_u 0.9409 (0.9360) acc_u 6.2500 (7.2917) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [35/36] time 0.184 (0.182) data 0.106 (0.101) loss_u loss_u 0.9814 (0.9369) acc_u 3.1250 (7.2321) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.2921, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 472
clean true:459
clean false:13
clean_rate:0.972457627118644
noisy true:571
noisy false:573
after delete: len(clean_dataset) 472
after delete: len(noisy_dataset) 1144
epoch [94/200] batch [5/14] time 0.171 (0.186) data 0.093 (0.108) loss_x loss_x 0.6670 (0.6145) acc_x 78.1250 (81.2500) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [10/14] time 0.158 (0.177) data 0.081 (0.099) loss_x loss_x 0.4373 (0.6358) acc_x 87.5000 (81.2500) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/35] time 0.183 (0.179) data 0.105 (0.101) loss_u loss_u 0.9468 (0.9377) acc_u 6.2500 (8.1250) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/35] time 0.181 (0.180) data 0.104 (0.102) loss_u loss_u 0.8853 (0.9277) acc_u 15.6250 (8.4375) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/35] time 0.158 (0.184) data 0.081 (0.100) loss_u loss_u 0.9033 (0.9310) acc_u 12.5000 (7.7083) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/35] time 0.232 (0.183) data 0.154 (0.100) loss_u loss_u 0.9443 (0.9323) acc_u 6.2500 (7.8125) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/35] time 0.180 (0.184) data 0.102 (0.101) loss_u loss_u 0.8862 (0.9348) acc_u 12.5000 (7.6250) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [30/35] time 0.161 (0.183) data 0.083 (0.101) loss_u loss_u 0.9048 (0.9349) acc_u 9.3750 (7.6042) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [35/35] time 0.169 (0.185) data 0.091 (0.103) loss_u loss_u 0.9688 (0.9372) acc_u 3.1250 (7.3214) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:468
clean false:12
clean_rate:0.975
noisy true:577
noisy false:559
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [95/200] batch [5/15] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.6562 (0.5392) acc_x 81.2500 (85.6250) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/15] time 0.167 (0.178) data 0.090 (0.100) loss_x loss_x 0.5571 (0.5093) acc_x 87.5000 (86.8750) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [15/15] time 0.202 (0.183) data 0.125 (0.105) loss_x loss_x 0.7754 (0.5496) acc_x 84.3750 (85.6250) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/35] time 0.167 (0.183) data 0.087 (0.105) loss_u loss_u 0.9766 (0.9609) acc_u 0.0000 (3.7500) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/35] time 0.177 (0.183) data 0.099 (0.105) loss_u loss_u 0.9849 (0.9478) acc_u 0.0000 (5.3125) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/35] time 0.183 (0.185) data 0.104 (0.103) loss_u loss_u 0.9941 (0.9496) acc_u 0.0000 (5.2083) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [20/35] time 0.170 (0.183) data 0.091 (0.102) loss_u loss_u 0.9038 (0.9503) acc_u 15.6250 (5.6250) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/35] time 0.170 (0.183) data 0.091 (0.102) loss_u loss_u 0.9668 (0.9476) acc_u 3.1250 (5.7500) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [30/35] time 0.196 (0.184) data 0.118 (0.103) loss_u loss_u 0.9976 (0.9503) acc_u 0.0000 (5.4167) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [35/35] time 0.165 (0.183) data 0.086 (0.102) loss_u loss_u 0.9722 (0.9441) acc_u 6.2500 (6.1607) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 595
confident_label rate tensor(0.2871, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 464
clean true:454
clean false:10
clean_rate:0.978448275862069
noisy true:567
noisy false:585
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1152
epoch [96/200] batch [5/14] time 0.177 (0.190) data 0.098 (0.090) loss_x loss_x 0.4766 (0.3997) acc_x 90.6250 (90.0000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [10/14] time 0.184 (0.180) data 0.105 (0.091) loss_x loss_x 0.9194 (0.5797) acc_x 84.3750 (86.5625) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/36] time 0.173 (0.177) data 0.094 (0.093) loss_u loss_u 0.9155 (0.9272) acc_u 9.3750 (7.5000) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/36] time 0.160 (0.175) data 0.081 (0.092) loss_u loss_u 0.9360 (0.9318) acc_u 9.3750 (7.5000) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/36] time 0.188 (0.176) data 0.109 (0.094) loss_u loss_u 0.9985 (0.9327) acc_u 0.0000 (7.0833) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/36] time 0.156 (0.179) data 0.077 (0.094) loss_u loss_u 0.9341 (0.9344) acc_u 9.3750 (7.1875) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/36] time 0.164 (0.177) data 0.086 (0.093) loss_u loss_u 0.9502 (0.9355) acc_u 6.2500 (7.1250) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [30/36] time 0.164 (0.176) data 0.086 (0.093) loss_u loss_u 0.9067 (0.9315) acc_u 9.3750 (7.5000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [35/36] time 0.160 (0.176) data 0.083 (0.093) loss_u loss_u 0.9131 (0.9317) acc_u 9.3750 (7.5000) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.2933, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 474
clean true:462
clean false:12
clean_rate:0.9746835443037974
noisy true:609
noisy false:533
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1142
epoch [97/200] batch [5/14] time 0.168 (0.174) data 0.090 (0.096) loss_x loss_x 0.7568 (0.6147) acc_x 81.2500 (85.6250) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [10/14] time 0.189 (0.192) data 0.111 (0.098) loss_x loss_x 0.6387 (0.5632) acc_x 81.2500 (86.2500) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/35] time 0.189 (0.188) data 0.112 (0.101) loss_u loss_u 0.9121 (0.9332) acc_u 9.3750 (7.5000) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [10/35] time 0.209 (0.192) data 0.130 (0.107) loss_u loss_u 0.9663 (0.9380) acc_u 3.1250 (6.8750) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/35] time 0.184 (0.191) data 0.106 (0.107) loss_u loss_u 0.9995 (0.9328) acc_u 0.0000 (7.5000) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/35] time 0.173 (0.189) data 0.095 (0.107) loss_u loss_u 0.9478 (0.9429) acc_u 6.2500 (6.2500) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/35] time 0.183 (0.188) data 0.105 (0.106) loss_u loss_u 0.9375 (0.9395) acc_u 6.2500 (6.5000) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [30/35] time 0.169 (0.189) data 0.091 (0.105) loss_u loss_u 0.9521 (0.9402) acc_u 6.2500 (6.4583) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [35/35] time 0.184 (0.188) data 0.106 (0.104) loss_u loss_u 0.9985 (0.9401) acc_u 0.0000 (6.6071) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 546
confident_label rate tensor(0.3020, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 488
clean true:478
clean false:10
clean_rate:0.9795081967213115
noisy true:592
noisy false:536
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1128
epoch [98/200] batch [5/15] time 0.293 (0.201) data 0.106 (0.098) loss_x loss_x 0.7476 (0.6414) acc_x 78.1250 (82.5000) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/15] time 0.165 (0.185) data 0.088 (0.095) loss_x loss_x 0.5552 (0.6344) acc_x 84.3750 (82.5000) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [15/15] time 0.179 (0.180) data 0.101 (0.094) loss_x loss_x 0.5688 (0.6256) acc_x 84.3750 (83.1250) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/35] time 0.159 (0.181) data 0.081 (0.097) loss_u loss_u 0.9888 (0.9461) acc_u 0.0000 (5.6250) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/35] time 0.175 (0.179) data 0.097 (0.097) loss_u loss_u 0.9390 (0.9393) acc_u 6.2500 (6.2500) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/35] time 0.190 (0.180) data 0.113 (0.098) loss_u loss_u 0.9922 (0.9487) acc_u 0.0000 (5.2083) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/35] time 0.199 (0.179) data 0.121 (0.098) loss_u loss_u 0.9199 (0.9464) acc_u 9.3750 (5.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/35] time 0.165 (0.179) data 0.086 (0.098) loss_u loss_u 0.9736 (0.9487) acc_u 3.1250 (5.5000) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [30/35] time 0.201 (0.183) data 0.122 (0.099) loss_u loss_u 0.9565 (0.9477) acc_u 6.2500 (5.7292) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [35/35] time 0.176 (0.183) data 0.096 (0.100) loss_u loss_u 0.9292 (0.9452) acc_u 9.3750 (5.9821) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:464
clean false:16
clean_rate:0.9666666666666667
noisy true:580
noisy false:556
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [99/200] batch [5/15] time 0.182 (0.164) data 0.104 (0.087) loss_x loss_x 0.3889 (0.8548) acc_x 87.5000 (81.8750) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [10/15] time 0.159 (0.164) data 0.081 (0.086) loss_x loss_x 0.5513 (0.7909) acc_x 84.3750 (81.8750) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [15/15] time 0.268 (0.169) data 0.082 (0.085) loss_x loss_x 0.3484 (0.7078) acc_x 90.6250 (83.3333) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/35] time 0.167 (0.173) data 0.090 (0.086) loss_u loss_u 0.9297 (0.9494) acc_u 6.2500 (5.0000) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [10/35] time 0.193 (0.176) data 0.116 (0.091) loss_u loss_u 0.9419 (0.9516) acc_u 6.2500 (5.0000) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/35] time 0.182 (0.174) data 0.104 (0.090) loss_u loss_u 0.9502 (0.9484) acc_u 3.1250 (5.6250) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [20/35] time 0.182 (0.176) data 0.104 (0.092) loss_u loss_u 0.8975 (0.9419) acc_u 9.3750 (6.2500) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/35] time 0.161 (0.174) data 0.083 (0.091) loss_u loss_u 0.9658 (0.9391) acc_u 3.1250 (6.7500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [30/35] time 0.164 (0.172) data 0.084 (0.090) loss_u loss_u 0.9341 (0.9412) acc_u 6.2500 (6.4583) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [35/35] time 0.159 (0.174) data 0.081 (0.090) loss_u loss_u 0.9946 (0.9420) acc_u 0.0000 (6.3393) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 573
confident_label rate tensor(0.2958, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 478
clean true:463
clean false:15
clean_rate:0.9686192468619247
noisy true:580
noisy false:558
all clean rate:  [0.9130434782608695, 0.9656652360515021, 0.9845201238390093, 0.9911504424778761, 0.9821958456973294, 0.9906542056074766, 0.9855907780979827, 0.9914285714285714, 0.9886685552407932, 0.9860724233983287, 0.9860335195530726, 0.9809782608695652, 0.9859943977591037, 0.9863387978142076, 0.9792207792207792, 0.9808743169398907, 0.9923273657289002, 0.9946524064171123, 0.989769820971867, 0.9921465968586387, 0.9877149877149877, 0.9869791666666666, 0.9873417721518988, 0.9794344473007712, 0.9823232323232324, 0.9723618090452262, 0.9773299748110831, 0.9871134020618557, 0.97911227154047, 0.9751861042183623, 0.9841688654353562, 0.983132530120482, 0.9855421686746988, 0.9830097087378641, 0.98, 0.9775, 0.9802955665024631, 0.9830917874396136, 0.9814385150812065, 0.9802955665024631, 0.9714964370546318, 0.9828850855745721, 0.9818181818181818, 0.9816933638443935, 0.9714964370546318, 0.9813953488372092, 0.9741176470588235, 0.981042654028436, 0.9746543778801844, 0.9753914988814317, 0.9794520547945206, 0.9904534606205251, 0.9709821428571429, 0.9796380090497737, 0.9841986455981941, 0.981941309255079, 0.9840546697038725, 0.9816091954022989, 0.9770114942528736, 0.9765807962529274, 0.9727891156462585, 0.9733924611973392, 0.9798206278026906, 0.9757709251101322, 0.984375, 0.9755011135857461, 0.9714912280701754, 0.9733333333333334, 0.977924944812362, 0.975929978118162, 0.9715536105032823, 0.9801324503311258, 0.9802631578947368, 0.9823399558498896, 0.9698275862068966, 0.9702127659574468, 0.9782135076252724, 0.9782135076252724, 0.9754464285714286, 0.9764453961456103, 0.9824945295404814, 0.9760869565217392, 0.9654427645788337, 0.974025974025974, 0.9761388286334056, 0.9763948497854077, 0.9714285714285714, 0.978021978021978, 0.9718614718614719, 0.9721030042918455, 0.9664570230607966, 0.9739696312364425, 0.9806034482758621, 0.972457627118644, 0.975, 0.978448275862069, 0.9746835443037974, 0.9795081967213115, 0.9666666666666667, 0.9686192468619247]
after delete: len(clean_dataset) 478
after delete: len(noisy_dataset) 1138
epoch [100/200] batch [5/14] time 0.162 (0.172) data 0.085 (0.094) loss_x loss_x 0.5161 (0.5570) acc_x 84.3750 (84.3750) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [10/14] time 0.162 (0.170) data 0.084 (0.092) loss_x loss_x 0.7759 (0.6549) acc_x 87.5000 (84.6875) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/35] time 0.164 (0.181) data 0.086 (0.103) loss_u loss_u 0.9351 (0.9411) acc_u 9.3750 (6.8750) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/35] time 0.178 (0.187) data 0.100 (0.103) loss_u loss_u 0.9263 (0.9211) acc_u 12.5000 (10.0000) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/35] time 0.168 (0.184) data 0.090 (0.101) loss_u loss_u 0.9453 (0.9249) acc_u 9.3750 (9.1667) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/35] time 0.180 (0.185) data 0.103 (0.102) loss_u loss_u 0.9136 (0.9323) acc_u 9.3750 (8.1250) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/35] time 0.204 (0.185) data 0.126 (0.103) loss_u loss_u 0.9609 (0.9384) acc_u 6.2500 (7.5000) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [30/35] time 0.171 (0.183) data 0.093 (0.102) loss_u loss_u 0.9536 (0.9401) acc_u 6.2500 (7.3958) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [35/35] time 0.175 (0.183) data 0.097 (0.102) loss_u loss_u 0.9668 (0.9398) acc_u 6.2500 (7.5000) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 557
confident_label rate tensor(0.2964, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 479
clean true:469
clean false:10
clean_rate:0.9791231732776617
noisy true:590
noisy false:547
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1137
epoch [101/200] batch [5/14] time 0.164 (0.167) data 0.087 (0.090) loss_x loss_x 0.5454 (0.5451) acc_x 84.3750 (85.6250) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/14] time 0.176 (0.169) data 0.097 (0.091) loss_x loss_x 0.2998 (0.5636) acc_x 90.6250 (84.0625) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/35] time 0.171 (0.169) data 0.093 (0.092) loss_u loss_u 0.9673 (0.9273) acc_u 3.1250 (8.1250) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [10/35] time 0.168 (0.170) data 0.090 (0.093) loss_u loss_u 0.8608 (0.9229) acc_u 15.6250 (8.4375) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/35] time 0.184 (0.177) data 0.106 (0.095) loss_u loss_u 0.9546 (0.9312) acc_u 6.2500 (7.5000) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [20/35] time 0.167 (0.177) data 0.089 (0.096) loss_u loss_u 0.9331 (0.9365) acc_u 6.2500 (7.0312) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/35] time 0.174 (0.177) data 0.097 (0.097) loss_u loss_u 0.9644 (0.9416) acc_u 6.2500 (6.6250) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [30/35] time 0.177 (0.177) data 0.099 (0.097) loss_u loss_u 0.8672 (0.9369) acc_u 15.6250 (7.1875) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [35/35] time 0.204 (0.179) data 0.127 (0.098) loss_u loss_u 0.9644 (0.9394) acc_u 3.1250 (6.9643) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 574
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:464
clean false:16
clean_rate:0.9666666666666667
noisy true:578
noisy false:558
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [102/200] batch [5/15] time 0.159 (0.160) data 0.081 (0.083) loss_x loss_x 0.8237 (0.6521) acc_x 78.1250 (85.0000) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/15] time 0.159 (0.160) data 0.081 (0.082) loss_x loss_x 0.8066 (0.6164) acc_x 84.3750 (85.6250) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [15/15] time 0.157 (0.159) data 0.080 (0.081) loss_x loss_x 0.7114 (0.6700) acc_x 78.1250 (83.5417) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/35] time 0.159 (0.159) data 0.080 (0.081) loss_u loss_u 0.8306 (0.9033) acc_u 18.7500 (10.6250) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/35] time 0.169 (0.162) data 0.091 (0.084) loss_u loss_u 0.8784 (0.9219) acc_u 12.5000 (8.4375) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/35] time 0.182 (0.172) data 0.103 (0.090) loss_u loss_u 0.9331 (0.9223) acc_u 9.3750 (8.5417) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/35] time 0.168 (0.173) data 0.090 (0.091) loss_u loss_u 0.9634 (0.9304) acc_u 3.1250 (7.6562) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/35] time 0.160 (0.172) data 0.082 (0.091) loss_u loss_u 0.9434 (0.9328) acc_u 6.2500 (7.3750) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [30/35] time 0.167 (0.172) data 0.089 (0.091) loss_u loss_u 0.9302 (0.9347) acc_u 9.3750 (7.1875) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [35/35] time 0.186 (0.172) data 0.108 (0.092) loss_u loss_u 0.9404 (0.9361) acc_u 9.3750 (7.3214) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.3020, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 488
clean true:476
clean false:12
clean_rate:0.9754098360655737
noisy true:577
noisy false:551
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1128
epoch [103/200] batch [5/15] time 0.173 (0.175) data 0.095 (0.097) loss_x loss_x 0.5459 (0.7644) acc_x 87.5000 (85.6250) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [10/15] time 0.199 (0.176) data 0.122 (0.099) loss_x loss_x 0.1504 (0.6220) acc_x 96.8750 (87.1875) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [15/15] time 0.165 (0.177) data 0.087 (0.099) loss_x loss_x 0.5571 (0.6417) acc_x 84.3750 (84.7917) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/35] time 0.207 (0.178) data 0.129 (0.101) loss_u loss_u 0.9565 (0.9101) acc_u 6.2500 (10.0000) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/35] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.9370 (0.9364) acc_u 6.2500 (6.8750) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/35] time 0.182 (0.183) data 0.104 (0.105) loss_u loss_u 0.9683 (0.9422) acc_u 3.1250 (6.4583) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/35] time 0.178 (0.182) data 0.100 (0.104) loss_u loss_u 0.8379 (0.9413) acc_u 18.7500 (6.5625) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/35] time 0.180 (0.186) data 0.102 (0.105) loss_u loss_u 0.9697 (0.9466) acc_u 0.0000 (5.7500) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [30/35] time 0.209 (0.186) data 0.132 (0.105) loss_u loss_u 0.9365 (0.9481) acc_u 6.2500 (5.4167) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [35/35] time 0.172 (0.184) data 0.093 (0.104) loss_u loss_u 0.9214 (0.9447) acc_u 9.3750 (5.8036) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.2983, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 482
clean true:466
clean false:16
clean_rate:0.966804979253112
noisy true:601
noisy false:533
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1134
epoch [104/200] batch [5/15] time 0.169 (0.176) data 0.092 (0.098) loss_x loss_x 0.8413 (0.6597) acc_x 75.0000 (84.3750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/15] time 0.183 (0.190) data 0.105 (0.099) loss_x loss_x 0.5444 (0.6731) acc_x 84.3750 (82.8125) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [15/15] time 0.158 (0.184) data 0.080 (0.098) loss_x loss_x 1.0547 (0.6954) acc_x 81.2500 (83.3333) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/35] time 0.190 (0.182) data 0.112 (0.097) loss_u loss_u 0.9180 (0.9210) acc_u 9.3750 (9.3750) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [10/35] time 0.182 (0.187) data 0.105 (0.104) loss_u loss_u 0.9937 (0.9442) acc_u 0.0000 (6.8750) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/35] time 0.187 (0.186) data 0.110 (0.104) loss_u loss_u 0.9941 (0.9495) acc_u 0.0000 (6.2500) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/35] time 0.199 (0.186) data 0.122 (0.105) loss_u loss_u 0.9536 (0.9524) acc_u 6.2500 (5.9375) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/35] time 0.181 (0.186) data 0.103 (0.105) loss_u loss_u 0.9282 (0.9501) acc_u 9.3750 (6.3750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [30/35] time 0.186 (0.188) data 0.108 (0.105) loss_u loss_u 0.9829 (0.9495) acc_u 3.1250 (6.3542) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [35/35] time 0.219 (0.188) data 0.141 (0.105) loss_u loss_u 0.9419 (0.9453) acc_u 9.3750 (6.6964) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.2927, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 473
clean true:460
clean false:13
clean_rate:0.9725158562367865
noisy true:587
noisy false:556
after delete: len(clean_dataset) 473
after delete: len(noisy_dataset) 1143
epoch [105/200] batch [5/14] time 0.202 (0.188) data 0.124 (0.110) loss_x loss_x 0.5781 (0.5896) acc_x 90.6250 (85.6250) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/14] time 0.159 (0.176) data 0.082 (0.099) loss_x loss_x 0.6323 (0.5795) acc_x 81.2500 (85.3125) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/35] time 0.160 (0.180) data 0.082 (0.091) loss_u loss_u 0.9277 (0.9498) acc_u 12.5000 (6.2500) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [10/35] time 0.164 (0.176) data 0.085 (0.089) loss_u loss_u 0.8203 (0.9340) acc_u 21.8750 (7.8125) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/35] time 0.186 (0.176) data 0.108 (0.090) loss_u loss_u 0.9355 (0.9357) acc_u 6.2500 (7.2917) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/35] time 0.167 (0.176) data 0.089 (0.092) loss_u loss_u 0.9951 (0.9345) acc_u 0.0000 (7.3438) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/35] time 0.168 (0.175) data 0.090 (0.092) loss_u loss_u 0.9434 (0.9391) acc_u 6.2500 (6.7500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [30/35] time 0.160 (0.176) data 0.082 (0.093) loss_u loss_u 0.8906 (0.9375) acc_u 15.6250 (7.0833) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [35/35] time 0.156 (0.175) data 0.078 (0.093) loss_u loss_u 0.9214 (0.9347) acc_u 6.2500 (7.4107) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.3007, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 486
clean true:474
clean false:12
clean_rate:0.9753086419753086
noisy true:581
noisy false:549
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1130
epoch [106/200] batch [5/15] time 0.170 (0.171) data 0.093 (0.094) loss_x loss_x 0.6689 (0.5366) acc_x 84.3750 (86.2500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [10/15] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.5098 (0.5038) acc_x 87.5000 (87.8125) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [15/15] time 0.187 (0.183) data 0.108 (0.106) loss_x loss_x 0.4746 (0.4998) acc_x 84.3750 (87.7083) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/35] time 0.178 (0.191) data 0.101 (0.114) loss_u loss_u 0.8892 (0.9503) acc_u 15.6250 (5.6250) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/35] time 0.168 (0.187) data 0.090 (0.109) loss_u loss_u 0.9365 (0.9421) acc_u 9.3750 (6.5625) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/35] time 0.273 (0.186) data 0.083 (0.105) loss_u loss_u 0.9385 (0.9485) acc_u 6.2500 (5.8333) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/35] time 0.186 (0.186) data 0.108 (0.105) loss_u loss_u 0.8906 (0.9452) acc_u 12.5000 (6.4062) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/35] time 0.186 (0.187) data 0.108 (0.106) loss_u loss_u 0.9272 (0.9452) acc_u 6.2500 (6.3750) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [30/35] time 0.182 (0.186) data 0.103 (0.105) loss_u loss_u 0.9375 (0.9504) acc_u 6.2500 (5.8333) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [35/35] time 0.172 (0.185) data 0.094 (0.104) loss_u loss_u 0.9126 (0.9448) acc_u 9.3750 (6.3393) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.2933, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 474
clean true:461
clean false:13
clean_rate:0.9725738396624473
noisy true:566
noisy false:576
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1142
epoch [107/200] batch [5/14] time 0.173 (0.170) data 0.096 (0.093) loss_x loss_x 0.2996 (0.5011) acc_x 90.6250 (85.0000) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [10/14] time 0.173 (0.175) data 0.096 (0.097) loss_x loss_x 0.6982 (0.6438) acc_x 81.2500 (82.5000) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/35] time 0.183 (0.174) data 0.105 (0.096) loss_u loss_u 0.8438 (0.9241) acc_u 15.6250 (8.1250) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/35] time 0.200 (0.175) data 0.122 (0.098) loss_u loss_u 0.9688 (0.9257) acc_u 3.1250 (7.5000) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/35] time 0.160 (0.175) data 0.082 (0.098) loss_u loss_u 0.9673 (0.9219) acc_u 3.1250 (8.1250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/35] time 0.164 (0.185) data 0.086 (0.104) loss_u loss_u 0.9106 (0.9249) acc_u 9.3750 (8.1250) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/35] time 0.161 (0.185) data 0.084 (0.104) loss_u loss_u 0.9146 (0.9273) acc_u 9.3750 (8.0000) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [30/35] time 0.167 (0.183) data 0.090 (0.103) loss_u loss_u 0.8950 (0.9292) acc_u 12.5000 (7.8125) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [35/35] time 0.169 (0.185) data 0.090 (0.105) loss_u loss_u 0.9731 (0.9306) acc_u 3.1250 (7.5000) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 556
confident_label rate tensor(0.2983, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 482
clean true:473
clean false:9
clean_rate:0.9813278008298755
noisy true:587
noisy false:547
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1134
epoch [108/200] batch [5/15] time 0.163 (0.185) data 0.086 (0.107) loss_x loss_x 0.0996 (0.4808) acc_x 100.0000 (90.6250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/15] time 0.224 (0.202) data 0.090 (0.107) loss_x loss_x 0.2917 (0.5152) acc_x 93.7500 (87.8125) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/15] time 0.188 (0.199) data 0.109 (0.111) loss_x loss_x 1.0322 (0.5714) acc_x 78.1250 (85.4167) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/35] time 0.166 (0.194) data 0.087 (0.108) loss_u loss_u 0.9458 (0.9492) acc_u 9.3750 (6.2500) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/35] time 0.167 (0.189) data 0.090 (0.105) loss_u loss_u 0.8809 (0.9476) acc_u 15.6250 (6.8750) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/35] time 0.165 (0.186) data 0.088 (0.103) loss_u loss_u 0.9683 (0.9394) acc_u 3.1250 (7.2917) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/35] time 0.158 (0.183) data 0.080 (0.100) loss_u loss_u 0.9209 (0.9384) acc_u 9.3750 (7.3438) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/35] time 0.159 (0.180) data 0.080 (0.098) loss_u loss_u 0.9712 (0.9405) acc_u 3.1250 (7.1250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [30/35] time 0.162 (0.179) data 0.084 (0.098) loss_u loss_u 0.9883 (0.9424) acc_u 0.0000 (6.7708) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [35/35] time 0.210 (0.182) data 0.132 (0.098) loss_u loss_u 0.9204 (0.9426) acc_u 9.3750 (6.8750) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 585
confident_label rate tensor(0.3057, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 494
clean true:475
clean false:19
clean_rate:0.9615384615384616
noisy true:556
noisy false:566
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1122
epoch [109/200] batch [5/15] time 0.174 (0.196) data 0.096 (0.118) loss_x loss_x 0.7051 (0.8394) acc_x 81.2500 (76.2500) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/15] time 0.169 (0.183) data 0.091 (0.105) loss_x loss_x 0.6543 (0.7310) acc_x 78.1250 (80.6250) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [15/15] time 0.181 (0.179) data 0.104 (0.101) loss_x loss_x 0.5508 (0.6503) acc_x 84.3750 (82.5000) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/35] time 0.176 (0.186) data 0.097 (0.101) loss_u loss_u 0.9673 (0.9554) acc_u 3.1250 (4.3750) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/35] time 0.174 (0.185) data 0.095 (0.101) loss_u loss_u 0.9624 (0.9461) acc_u 6.2500 (5.9375) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/35] time 0.196 (0.185) data 0.117 (0.102) loss_u loss_u 0.9668 (0.9467) acc_u 6.2500 (6.2500) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/35] time 0.203 (0.187) data 0.126 (0.104) loss_u loss_u 0.9766 (0.9499) acc_u 3.1250 (5.9375) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/35] time 0.163 (0.186) data 0.086 (0.104) loss_u loss_u 0.8110 (0.9415) acc_u 18.7500 (6.8750) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [30/35] time 0.169 (0.186) data 0.091 (0.105) loss_u loss_u 0.9902 (0.9462) acc_u 0.0000 (6.2500) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [35/35] time 0.191 (0.185) data 0.114 (0.104) loss_u loss_u 0.8467 (0.9438) acc_u 15.6250 (6.3393) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:464
clean false:16
clean_rate:0.9666666666666667
noisy true:589
noisy false:547
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [110/200] batch [5/15] time 0.169 (0.173) data 0.091 (0.095) loss_x loss_x 0.6445 (0.5092) acc_x 84.3750 (85.6250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/15] time 0.185 (0.180) data 0.107 (0.103) loss_x loss_x 0.2515 (0.5465) acc_x 96.8750 (87.5000) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [15/15] time 0.172 (0.177) data 0.094 (0.099) loss_x loss_x 0.6025 (0.5634) acc_x 84.3750 (87.0833) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/35] time 0.163 (0.175) data 0.084 (0.098) loss_u loss_u 0.9565 (0.9302) acc_u 6.2500 (7.5000) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/35] time 0.190 (0.180) data 0.112 (0.098) loss_u loss_u 0.9292 (0.9219) acc_u 6.2500 (8.1250) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/35] time 0.163 (0.178) data 0.084 (0.097) loss_u loss_u 0.8896 (0.9231) acc_u 12.5000 (8.3333) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/35] time 0.165 (0.178) data 0.086 (0.096) loss_u loss_u 0.9688 (0.9263) acc_u 3.1250 (7.9688) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/35] time 0.162 (0.176) data 0.084 (0.096) loss_u loss_u 0.9341 (0.9312) acc_u 6.2500 (7.5000) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [30/35] time 0.171 (0.177) data 0.093 (0.096) loss_u loss_u 0.9336 (0.9298) acc_u 6.2500 (7.7083) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [35/35] time 0.189 (0.177) data 0.110 (0.097) loss_u loss_u 0.9985 (0.9331) acc_u 0.0000 (7.3214) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.2995, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 484
clean true:468
clean false:16
clean_rate:0.9669421487603306
noisy true:585
noisy false:547
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1132
epoch [111/200] batch [5/15] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 0.4250 (0.6291) acc_x 90.6250 (88.1250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/15] time 0.184 (0.192) data 0.107 (0.115) loss_x loss_x 0.6436 (0.5669) acc_x 78.1250 (87.8125) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [15/15] time 0.184 (0.190) data 0.107 (0.112) loss_x loss_x 0.7764 (0.6314) acc_x 87.5000 (86.0417) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/35] time 0.186 (0.189) data 0.108 (0.112) loss_u loss_u 0.8555 (0.9387) acc_u 15.6250 (6.2500) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/35] time 0.199 (0.190) data 0.121 (0.112) loss_u loss_u 0.9399 (0.9376) acc_u 6.2500 (6.8750) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/35] time 0.167 (0.192) data 0.089 (0.110) loss_u loss_u 0.9785 (0.9425) acc_u 3.1250 (6.2500) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/35] time 0.187 (0.190) data 0.108 (0.108) loss_u loss_u 0.9629 (0.9417) acc_u 3.1250 (6.4062) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/35] time 0.161 (0.186) data 0.083 (0.105) loss_u loss_u 0.8774 (0.9404) acc_u 12.5000 (6.6250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [30/35] time 0.161 (0.183) data 0.083 (0.103) loss_u loss_u 0.9419 (0.9380) acc_u 6.2500 (7.0833) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [35/35] time 0.159 (0.181) data 0.082 (0.101) loss_u loss_u 0.9404 (0.9405) acc_u 6.2500 (6.8750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 538
confident_label rate tensor(0.3038, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 491
clean true:479
clean false:12
clean_rate:0.9755600814663951
noisy true:599
noisy false:526
after delete: len(clean_dataset) 491
after delete: len(noisy_dataset) 1125
epoch [112/200] batch [5/15] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6279 (0.4901) acc_x 87.5000 (87.5000) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/15] time 0.165 (0.176) data 0.088 (0.099) loss_x loss_x 0.4521 (0.5208) acc_x 84.3750 (85.0000) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [15/15] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.4739 (0.5205) acc_x 87.5000 (85.0000) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/35] time 0.161 (0.180) data 0.084 (0.103) loss_u loss_u 0.9092 (0.9319) acc_u 9.3750 (7.5000) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [10/35] time 0.161 (0.176) data 0.083 (0.099) loss_u loss_u 0.9536 (0.9355) acc_u 3.1250 (6.8750) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/35] time 0.158 (0.174) data 0.080 (0.096) loss_u loss_u 0.9565 (0.9317) acc_u 3.1250 (7.2917) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/35] time 0.174 (0.177) data 0.096 (0.095) loss_u loss_u 0.9478 (0.9355) acc_u 3.1250 (6.7188) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/35] time 0.160 (0.176) data 0.083 (0.095) loss_u loss_u 0.9604 (0.9363) acc_u 6.2500 (6.8750) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [30/35] time 0.184 (0.176) data 0.105 (0.095) loss_u loss_u 0.9980 (0.9359) acc_u 0.0000 (6.8750) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [35/35] time 0.181 (0.177) data 0.103 (0.096) loss_u loss_u 0.9985 (0.9398) acc_u 0.0000 (6.4286) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.2896, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 468
clean true:456
clean false:12
clean_rate:0.9743589743589743
noisy true:576
noisy false:572
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1148
epoch [113/200] batch [5/14] time 0.261 (0.205) data 0.107 (0.106) loss_x loss_x 0.2781 (0.5458) acc_x 93.7500 (87.5000) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/14] time 0.185 (0.194) data 0.107 (0.106) loss_x loss_x 0.7393 (0.5856) acc_x 71.8750 (84.0625) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/35] time 0.184 (0.189) data 0.105 (0.105) loss_u loss_u 0.9385 (0.9611) acc_u 6.2500 (3.7500) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [10/35] time 0.161 (0.185) data 0.082 (0.103) loss_u loss_u 0.9575 (0.9519) acc_u 3.1250 (5.0000) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/35] time 0.162 (0.183) data 0.083 (0.101) loss_u loss_u 0.9834 (0.9483) acc_u 0.0000 (5.4167) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [20/35] time 0.188 (0.182) data 0.110 (0.100) loss_u loss_u 0.9224 (0.9417) acc_u 9.3750 (6.4062) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/35] time 0.164 (0.183) data 0.086 (0.099) loss_u loss_u 0.9087 (0.9363) acc_u 9.3750 (6.8750) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [30/35] time 0.187 (0.182) data 0.109 (0.098) loss_u loss_u 0.9678 (0.9369) acc_u 3.1250 (6.8750) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [35/35] time 0.185 (0.182) data 0.107 (0.099) loss_u loss_u 0.9160 (0.9341) acc_u 12.5000 (7.4107) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.3001, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 485
clean true:473
clean false:12
clean_rate:0.9752577319587629
noisy true:577
noisy false:554
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1131
epoch [114/200] batch [5/15] time 0.162 (0.186) data 0.085 (0.084) loss_x loss_x 0.6079 (0.4510) acc_x 84.3750 (90.6250) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [10/15] time 0.231 (0.184) data 0.154 (0.095) loss_x loss_x 0.4883 (0.4837) acc_x 87.5000 (89.3750) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [15/15] time 0.188 (0.185) data 0.111 (0.099) loss_x loss_x 0.3530 (0.5245) acc_x 90.6250 (87.9167) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/35] time 0.185 (0.187) data 0.108 (0.104) loss_u loss_u 0.9937 (0.9458) acc_u 0.0000 (6.2500) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [10/35] time 0.205 (0.190) data 0.128 (0.108) loss_u loss_u 0.9727 (0.9392) acc_u 3.1250 (6.8750) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/35] time 0.211 (0.190) data 0.133 (0.109) loss_u loss_u 0.9683 (0.9481) acc_u 3.1250 (6.0417) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/35] time 0.186 (0.190) data 0.108 (0.109) loss_u loss_u 0.8301 (0.9359) acc_u 18.7500 (7.3438) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/35] time 0.182 (0.194) data 0.105 (0.110) loss_u loss_u 0.9541 (0.9417) acc_u 6.2500 (6.3750) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [30/35] time 0.186 (0.193) data 0.109 (0.110) loss_u loss_u 0.9741 (0.9427) acc_u 3.1250 (6.3542) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [35/35] time 0.183 (0.191) data 0.105 (0.108) loss_u loss_u 0.9956 (0.9447) acc_u 0.0000 (5.9821) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.2958, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 478
clean true:468
clean false:10
clean_rate:0.9790794979079498
noisy true:581
noisy false:557
after delete: len(clean_dataset) 478
after delete: len(noisy_dataset) 1138
epoch [115/200] batch [5/14] time 0.158 (0.169) data 0.081 (0.091) loss_x loss_x 0.4312 (0.4818) acc_x 93.7500 (88.1250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/14] time 0.161 (0.181) data 0.084 (0.093) loss_x loss_x 0.9736 (0.5747) acc_x 78.1250 (86.5625) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/35] time 0.162 (0.176) data 0.085 (0.093) loss_u loss_u 0.9312 (0.9221) acc_u 6.2500 (8.7500) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/35] time 0.172 (0.175) data 0.094 (0.093) loss_u loss_u 0.9331 (0.9251) acc_u 12.5000 (9.0625) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/35] time 0.162 (0.173) data 0.083 (0.092) loss_u loss_u 0.9087 (0.9216) acc_u 12.5000 (9.3750) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/35] time 0.159 (0.171) data 0.082 (0.091) loss_u loss_u 0.9673 (0.9217) acc_u 3.1250 (9.0625) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/35] time 0.187 (0.172) data 0.109 (0.092) loss_u loss_u 0.9629 (0.9254) acc_u 3.1250 (8.6250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [30/35] time 0.182 (0.176) data 0.105 (0.093) loss_u loss_u 0.9673 (0.9309) acc_u 3.1250 (7.8125) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [35/35] time 0.184 (0.177) data 0.107 (0.094) loss_u loss_u 0.9995 (0.9333) acc_u 0.0000 (7.5000) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 559
confident_label rate tensor(0.3020, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 488
clean true:474
clean false:14
clean_rate:0.9713114754098361
noisy true:583
noisy false:545
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1128
epoch [116/200] batch [5/15] time 0.168 (0.179) data 0.090 (0.102) loss_x loss_x 0.5308 (0.6320) acc_x 87.5000 (84.3750) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/15] time 0.234 (0.184) data 0.156 (0.106) loss_x loss_x 0.3667 (0.5770) acc_x 90.6250 (86.5625) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [15/15] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 0.9263 (0.5795) acc_x 78.1250 (86.6667) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/35] time 0.174 (0.189) data 0.096 (0.105) loss_u loss_u 0.9570 (0.9440) acc_u 3.1250 (5.6250) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [10/35] time 0.199 (0.190) data 0.121 (0.107) loss_u loss_u 0.9297 (0.9405) acc_u 9.3750 (6.5625) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/35] time 0.170 (0.187) data 0.092 (0.104) loss_u loss_u 0.9390 (0.9448) acc_u 6.2500 (6.2500) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/35] time 0.158 (0.183) data 0.080 (0.101) loss_u loss_u 0.8579 (0.9430) acc_u 15.6250 (6.2500) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/35] time 0.160 (0.180) data 0.082 (0.099) loss_u loss_u 0.9360 (0.9431) acc_u 6.2500 (6.5000) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [30/35] time 0.162 (0.178) data 0.084 (0.097) loss_u loss_u 0.9399 (0.9405) acc_u 6.2500 (6.8750) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [35/35] time 0.171 (0.176) data 0.093 (0.096) loss_u loss_u 0.9087 (0.9395) acc_u 9.3750 (6.9643) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 595
confident_label rate tensor(0.2834, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 458
clean true:444
clean false:14
clean_rate:0.9694323144104804
noisy true:577
noisy false:581
after delete: len(clean_dataset) 458
after delete: len(noisy_dataset) 1158
epoch [117/200] batch [5/14] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.2781 (0.4413) acc_x 93.7500 (87.5000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/14] time 0.176 (0.172) data 0.099 (0.095) loss_x loss_x 0.9570 (0.5028) acc_x 78.1250 (87.5000) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/36] time 0.170 (0.171) data 0.092 (0.093) loss_u loss_u 0.8975 (0.9255) acc_u 12.5000 (8.7500) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/36] time 0.159 (0.176) data 0.082 (0.092) loss_u loss_u 0.9414 (0.9217) acc_u 6.2500 (8.7500) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/36] time 0.158 (0.175) data 0.081 (0.092) loss_u loss_u 0.9561 (0.9310) acc_u 3.1250 (7.5000) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/36] time 0.161 (0.175) data 0.083 (0.092) loss_u loss_u 0.9448 (0.9279) acc_u 3.1250 (7.6562) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/36] time 0.158 (0.174) data 0.081 (0.093) loss_u loss_u 0.8726 (0.9220) acc_u 15.6250 (8.5000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [30/36] time 0.163 (0.174) data 0.085 (0.092) loss_u loss_u 0.9302 (0.9207) acc_u 9.3750 (8.6458) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [35/36] time 0.199 (0.175) data 0.121 (0.094) loss_u loss_u 0.8652 (0.9198) acc_u 15.6250 (8.8393) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 552
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 505
clean true:490
clean false:15
clean_rate:0.9702970297029703
noisy true:574
noisy false:537
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1111
epoch [118/200] batch [5/15] time 0.185 (0.179) data 0.107 (0.101) loss_x loss_x 0.4790 (0.5401) acc_x 84.3750 (85.0000) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [10/15] time 0.181 (0.181) data 0.103 (0.103) loss_x loss_x 0.4126 (0.5725) acc_x 90.6250 (86.2500) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [15/15] time 0.182 (0.182) data 0.104 (0.104) loss_x loss_x 0.4216 (0.5371) acc_x 90.6250 (86.6667) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/34] time 0.184 (0.183) data 0.105 (0.105) loss_u loss_u 0.9355 (0.9697) acc_u 6.2500 (2.5000) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/34] time 0.181 (0.183) data 0.103 (0.105) loss_u loss_u 0.9443 (0.9463) acc_u 6.2500 (5.6250) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/34] time 0.158 (0.179) data 0.081 (0.101) loss_u loss_u 0.9902 (0.9566) acc_u 3.1250 (4.7917) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/34] time 0.224 (0.185) data 0.145 (0.104) loss_u loss_u 0.9082 (0.9541) acc_u 9.3750 (5.0000) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/34] time 0.161 (0.184) data 0.082 (0.103) loss_u loss_u 0.9668 (0.9543) acc_u 3.1250 (5.0000) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [30/34] time 0.187 (0.182) data 0.110 (0.102) loss_u loss_u 0.8828 (0.9499) acc_u 18.7500 (5.7292) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 557
confident_label rate tensor(0.3001, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 485
clean true:476
clean false:9
clean_rate:0.9814432989690721
noisy true:583
noisy false:548
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1131
epoch [119/200] batch [5/15] time 0.161 (0.183) data 0.082 (0.106) loss_x loss_x 0.7007 (0.5709) acc_x 71.8750 (82.5000) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/15] time 0.170 (0.182) data 0.091 (0.105) loss_x loss_x 0.6841 (0.6068) acc_x 84.3750 (83.7500) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [15/15] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.1617 (0.5900) acc_x 100.0000 (84.3750) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/35] time 0.176 (0.182) data 0.099 (0.104) loss_u loss_u 0.8833 (0.9479) acc_u 12.5000 (6.2500) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [10/35] time 0.188 (0.181) data 0.109 (0.103) loss_u loss_u 0.9058 (0.9241) acc_u 9.3750 (8.4375) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/35] time 0.183 (0.186) data 0.104 (0.104) loss_u loss_u 0.9668 (0.9289) acc_u 3.1250 (7.9167) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/35] time 0.164 (0.184) data 0.085 (0.103) loss_u loss_u 0.8823 (0.9276) acc_u 18.7500 (8.2812) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/35] time 0.160 (0.181) data 0.083 (0.100) loss_u loss_u 0.9995 (0.9315) acc_u 0.0000 (7.7500) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [30/35] time 0.167 (0.180) data 0.090 (0.100) loss_u loss_u 0.9253 (0.9336) acc_u 9.3750 (7.3958) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [35/35] time 0.183 (0.180) data 0.105 (0.100) loss_u loss_u 0.9570 (0.9357) acc_u 6.2500 (7.3214) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 550
confident_label rate tensor(0.3001, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 485
clean true:474
clean false:11
clean_rate:0.977319587628866
noisy true:592
noisy false:539
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1131
epoch [120/200] batch [5/15] time 0.185 (0.215) data 0.107 (0.117) loss_x loss_x 0.8667 (0.5533) acc_x 81.2500 (83.7500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/15] time 0.175 (0.198) data 0.098 (0.111) loss_x loss_x 0.6748 (0.5984) acc_x 87.5000 (83.4375) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [15/15] time 0.164 (0.189) data 0.086 (0.104) loss_x loss_x 0.3499 (0.5579) acc_x 93.7500 (84.5833) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/35] time 0.168 (0.186) data 0.090 (0.103) loss_u loss_u 0.9614 (0.9305) acc_u 3.1250 (7.5000) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [10/35] time 0.182 (0.184) data 0.103 (0.102) loss_u loss_u 0.9722 (0.9371) acc_u 3.1250 (6.8750) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/35] time 0.191 (0.182) data 0.112 (0.101) loss_u loss_u 0.9360 (0.9362) acc_u 6.2500 (7.2917) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/35] time 0.160 (0.183) data 0.082 (0.099) loss_u loss_u 0.9453 (0.9420) acc_u 9.3750 (6.8750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/35] time 0.181 (0.182) data 0.101 (0.098) loss_u loss_u 0.8945 (0.9390) acc_u 12.5000 (7.1250) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [30/35] time 0.163 (0.180) data 0.085 (0.097) loss_u loss_u 0.9307 (0.9392) acc_u 6.2500 (6.9792) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [35/35] time 0.185 (0.179) data 0.108 (0.097) loss_u loss_u 0.9326 (0.9352) acc_u 6.2500 (7.4107) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 492
clean true:484
clean false:8
clean_rate:0.983739837398374
noisy true:587
noisy false:537
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1124
epoch [121/200] batch [5/15] time 0.179 (0.177) data 0.101 (0.099) loss_x loss_x 0.5854 (0.5279) acc_x 81.2500 (85.0000) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/15] time 0.193 (0.181) data 0.115 (0.103) loss_x loss_x 0.6445 (0.5261) acc_x 81.2500 (85.3125) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [15/15] time 0.185 (0.180) data 0.107 (0.102) loss_x loss_x 0.5059 (0.4880) acc_x 81.2500 (86.6667) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/35] time 0.182 (0.179) data 0.104 (0.101) loss_u loss_u 0.9316 (0.9296) acc_u 9.3750 (7.5000) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [10/35] time 0.185 (0.180) data 0.106 (0.102) loss_u loss_u 0.9995 (0.9587) acc_u 0.0000 (4.0625) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/35] time 0.187 (0.182) data 0.109 (0.102) loss_u loss_u 0.9536 (0.9446) acc_u 6.2500 (5.8333) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [20/35] time 0.186 (0.184) data 0.107 (0.105) loss_u loss_u 0.9829 (0.9454) acc_u 0.0000 (5.7812) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/35] time 0.190 (0.185) data 0.112 (0.105) loss_u loss_u 0.8779 (0.9425) acc_u 15.6250 (6.5000) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [30/35] time 0.164 (0.185) data 0.086 (0.106) loss_u loss_u 0.9463 (0.9432) acc_u 6.2500 (6.3542) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [35/35] time 0.178 (0.184) data 0.100 (0.104) loss_u loss_u 0.9189 (0.9439) acc_u 9.3750 (6.4286) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 495
clean true:482
clean false:13
clean_rate:0.9737373737373738
noisy true:585
noisy false:536
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1121
epoch [122/200] batch [5/15] time 0.172 (0.167) data 0.094 (0.090) loss_x loss_x 0.5117 (0.5602) acc_x 87.5000 (86.2500) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/15] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.1350 (0.4723) acc_x 100.0000 (88.1250) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [15/15] time 0.174 (0.170) data 0.096 (0.093) loss_x loss_x 0.7295 (0.5557) acc_x 78.1250 (86.0417) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/35] time 0.184 (0.172) data 0.106 (0.094) loss_u loss_u 0.8848 (0.9233) acc_u 15.6250 (10.0000) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [10/35] time 0.163 (0.172) data 0.085 (0.095) loss_u loss_u 0.9390 (0.9358) acc_u 6.2500 (7.8125) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/35] time 0.274 (0.178) data 0.083 (0.093) loss_u loss_u 0.9629 (0.9413) acc_u 3.1250 (7.2917) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/35] time 0.199 (0.178) data 0.122 (0.094) loss_u loss_u 0.9385 (0.9471) acc_u 6.2500 (6.4062) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/35] time 0.183 (0.180) data 0.106 (0.097) loss_u loss_u 0.9082 (0.9470) acc_u 9.3750 (6.2500) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [30/35] time 0.179 (0.180) data 0.101 (0.097) loss_u loss_u 0.9985 (0.9474) acc_u 0.0000 (6.2500) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [35/35] time 0.224 (0.181) data 0.145 (0.099) loss_u loss_u 0.8921 (0.9466) acc_u 12.5000 (6.2500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 558
confident_label rate tensor(0.3007, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 486
clean true:478
clean false:8
clean_rate:0.9835390946502057
noisy true:580
noisy false:550
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1130
epoch [123/200] batch [5/15] time 0.184 (0.170) data 0.107 (0.093) loss_x loss_x 0.6963 (0.4932) acc_x 87.5000 (88.1250) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/15] time 0.256 (0.188) data 0.082 (0.090) loss_x loss_x 0.4082 (0.4944) acc_x 93.7500 (88.1250) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [15/15] time 0.206 (0.182) data 0.128 (0.091) loss_x loss_x 0.5151 (0.5218) acc_x 87.5000 (88.1250) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/35] time 0.176 (0.180) data 0.098 (0.093) loss_u loss_u 0.9619 (0.9607) acc_u 6.2500 (5.0000) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [10/35] time 0.160 (0.178) data 0.083 (0.092) loss_u loss_u 0.9673 (0.9542) acc_u 3.1250 (5.3125) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/35] time 0.167 (0.177) data 0.089 (0.092) loss_u loss_u 0.9717 (0.9523) acc_u 3.1250 (5.4167) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/35] time 0.203 (0.180) data 0.125 (0.096) loss_u loss_u 0.9243 (0.9451) acc_u 9.3750 (6.5625) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/35] time 0.186 (0.180) data 0.108 (0.097) loss_u loss_u 0.9961 (0.9433) acc_u 0.0000 (6.5000) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [30/35] time 0.278 (0.184) data 0.139 (0.100) loss_u loss_u 0.9468 (0.9397) acc_u 9.3750 (6.8750) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [35/35] time 0.184 (0.184) data 0.106 (0.101) loss_u loss_u 0.9028 (0.9404) acc_u 12.5000 (6.7857) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.2989, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 483
clean true:474
clean false:9
clean_rate:0.9813664596273292
noisy true:594
noisy false:539
after delete: len(clean_dataset) 483
after delete: len(noisy_dataset) 1133
epoch [124/200] batch [5/15] time 0.185 (0.170) data 0.107 (0.092) loss_x loss_x 0.6875 (0.7084) acc_x 81.2500 (82.5000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/15] time 0.327 (0.184) data 0.143 (0.096) loss_x loss_x 0.4978 (0.6011) acc_x 87.5000 (84.6875) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [15/15] time 0.184 (0.186) data 0.106 (0.098) loss_x loss_x 0.7925 (0.6020) acc_x 71.8750 (83.9583) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/35] time 0.266 (0.191) data 0.187 (0.106) loss_u loss_u 0.9639 (0.9559) acc_u 3.1250 (5.0000) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/35] time 0.159 (0.187) data 0.081 (0.103) loss_u loss_u 0.9883 (0.9444) acc_u 0.0000 (5.9375) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/35] time 0.163 (0.183) data 0.084 (0.100) loss_u loss_u 0.9927 (0.9451) acc_u 0.0000 (6.0417) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/35] time 0.159 (0.180) data 0.081 (0.097) loss_u loss_u 0.9038 (0.9479) acc_u 12.5000 (5.9375) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/35] time 0.158 (0.177) data 0.080 (0.095) loss_u loss_u 0.9272 (0.9444) acc_u 9.3750 (6.2500) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [30/35] time 0.162 (0.176) data 0.084 (0.094) loss_u loss_u 0.9434 (0.9408) acc_u 6.2500 (6.6667) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [35/35] time 0.180 (0.177) data 0.101 (0.093) loss_u loss_u 0.9546 (0.9395) acc_u 3.1250 (6.7857) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 509
clean true:492
clean false:17
clean_rate:0.9666011787819253
noisy true:591
noisy false:516
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1107
epoch [125/200] batch [5/15] time 0.182 (0.170) data 0.105 (0.093) loss_x loss_x 1.3721 (0.7436) acc_x 56.2500 (76.8750) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/15] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 0.8828 (0.7007) acc_x 84.3750 (80.9375) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [15/15] time 0.182 (0.173) data 0.105 (0.095) loss_x loss_x 0.3142 (0.6284) acc_x 93.7500 (82.7083) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/34] time 0.161 (0.172) data 0.083 (0.095) loss_u loss_u 0.9399 (0.9572) acc_u 6.2500 (4.3750) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/34] time 0.276 (0.181) data 0.084 (0.096) loss_u loss_u 0.9526 (0.9439) acc_u 6.2500 (5.9375) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/34] time 0.162 (0.181) data 0.085 (0.097) loss_u loss_u 0.9351 (0.9452) acc_u 6.2500 (5.8333) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/34] time 0.163 (0.181) data 0.084 (0.097) loss_u loss_u 0.9644 (0.9484) acc_u 3.1250 (5.4688) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/34] time 0.187 (0.180) data 0.109 (0.097) loss_u loss_u 0.9668 (0.9488) acc_u 3.1250 (5.5000) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [30/34] time 0.163 (0.179) data 0.086 (0.096) loss_u loss_u 0.9849 (0.9499) acc_u 0.0000 (5.4167) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.3020, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 488
clean true:475
clean false:13
clean_rate:0.9733606557377049
noisy true:605
noisy false:523
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1128
epoch [126/200] batch [5/15] time 0.187 (0.177) data 0.108 (0.099) loss_x loss_x 0.5737 (0.4132) acc_x 84.3750 (92.5000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/15] time 0.181 (0.181) data 0.104 (0.103) loss_x loss_x 0.8452 (0.4860) acc_x 81.2500 (89.0625) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [15/15] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.7603 (0.5428) acc_x 81.2500 (87.9167) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/35] time 0.218 (0.188) data 0.141 (0.110) loss_u loss_u 0.9844 (0.9396) acc_u 3.1250 (6.2500) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/35] time 0.161 (0.185) data 0.082 (0.107) loss_u loss_u 0.9956 (0.9430) acc_u 0.0000 (5.9375) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/35] time 0.195 (0.185) data 0.097 (0.106) loss_u loss_u 0.9663 (0.9359) acc_u 6.2500 (7.0833) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/35] time 0.166 (0.187) data 0.088 (0.104) loss_u loss_u 0.9268 (0.9349) acc_u 6.2500 (7.3438) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/35] time 0.176 (0.186) data 0.099 (0.104) loss_u loss_u 0.9990 (0.9345) acc_u 0.0000 (7.2500) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [30/35] time 0.195 (0.185) data 0.117 (0.104) loss_u loss_u 0.9434 (0.9322) acc_u 6.2500 (7.6042) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [35/35] time 0.162 (0.184) data 0.085 (0.103) loss_u loss_u 0.9609 (0.9319) acc_u 3.1250 (7.5893) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.3014, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 487
clean true:477
clean false:10
clean_rate:0.9794661190965093
noisy true:597
noisy false:532
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1129
epoch [127/200] batch [5/15] time 0.268 (0.194) data 0.082 (0.095) loss_x loss_x 0.4258 (0.5229) acc_x 93.7500 (88.1250) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/15] time 0.158 (0.192) data 0.081 (0.096) loss_x loss_x 0.2554 (0.5138) acc_x 93.7500 (87.8125) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [15/15] time 0.171 (0.187) data 0.094 (0.097) loss_x loss_x 0.2427 (0.5234) acc_x 96.8750 (87.5000) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/35] time 0.209 (0.184) data 0.130 (0.098) loss_u loss_u 0.9399 (0.9500) acc_u 6.2500 (5.6250) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [10/35] time 0.181 (0.181) data 0.103 (0.096) loss_u loss_u 0.9639 (0.9377) acc_u 3.1250 (6.8750) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/35] time 0.179 (0.180) data 0.100 (0.096) loss_u loss_u 0.9565 (0.9391) acc_u 3.1250 (6.6667) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/35] time 0.162 (0.177) data 0.084 (0.094) loss_u loss_u 0.9302 (0.9416) acc_u 6.2500 (6.4062) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/35] time 0.160 (0.175) data 0.083 (0.092) loss_u loss_u 0.9385 (0.9371) acc_u 6.2500 (7.0000) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [30/35] time 0.161 (0.178) data 0.084 (0.091) loss_u loss_u 0.9707 (0.9352) acc_u 6.2500 (7.1875) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [35/35] time 0.164 (0.177) data 0.086 (0.091) loss_u loss_u 0.9336 (0.9362) acc_u 9.3750 (7.1429) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 541
confident_label rate tensor(0.3038, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 491
clean true:481
clean false:10
clean_rate:0.9796334012219959
noisy true:594
noisy false:531
after delete: len(clean_dataset) 491
after delete: len(noisy_dataset) 1125
epoch [128/200] batch [5/15] time 0.209 (0.181) data 0.132 (0.103) loss_x loss_x 0.6333 (0.5827) acc_x 78.1250 (85.0000) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/15] time 0.182 (0.180) data 0.104 (0.103) loss_x loss_x 0.6880 (0.6060) acc_x 81.2500 (85.6250) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [15/15] time 0.163 (0.177) data 0.084 (0.099) loss_x loss_x 0.5928 (0.6327) acc_x 84.3750 (84.7917) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/35] time 0.274 (0.183) data 0.083 (0.098) loss_u loss_u 0.8848 (0.9328) acc_u 12.5000 (8.1250) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [10/35] time 0.162 (0.181) data 0.085 (0.097) loss_u loss_u 0.9629 (0.9378) acc_u 6.2500 (7.5000) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/35] time 0.220 (0.182) data 0.141 (0.099) loss_u loss_u 0.9014 (0.9253) acc_u 9.3750 (8.9583) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [20/35] time 0.166 (0.181) data 0.087 (0.099) loss_u loss_u 0.9722 (0.9325) acc_u 3.1250 (7.9688) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/35] time 0.185 (0.181) data 0.107 (0.099) loss_u loss_u 0.9736 (0.9370) acc_u 3.1250 (7.6250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [30/35] time 0.184 (0.182) data 0.106 (0.100) loss_u loss_u 0.9365 (0.9348) acc_u 6.2500 (7.8125) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [35/35] time 0.168 (0.182) data 0.090 (0.101) loss_u loss_u 0.9956 (0.9382) acc_u 0.0000 (7.4107) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 564
confident_label rate tensor(0.2908, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 470
clean true:459
clean false:11
clean_rate:0.9765957446808511
noisy true:593
noisy false:553
after delete: len(clean_dataset) 470
after delete: len(noisy_dataset) 1146
epoch [129/200] batch [5/14] time 0.159 (0.161) data 0.082 (0.084) loss_x loss_x 0.4487 (0.4176) acc_x 87.5000 (90.0000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/14] time 0.188 (0.169) data 0.110 (0.091) loss_x loss_x 0.6138 (0.4662) acc_x 81.2500 (88.4375) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/35] time 0.160 (0.173) data 0.081 (0.094) loss_u loss_u 0.8359 (0.9246) acc_u 21.8750 (9.3750) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [10/35] time 0.184 (0.173) data 0.105 (0.095) loss_u loss_u 0.9526 (0.9381) acc_u 3.1250 (7.5000) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/35] time 0.200 (0.181) data 0.121 (0.098) loss_u loss_u 0.9678 (0.9313) acc_u 6.2500 (7.9167) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/35] time 0.184 (0.182) data 0.106 (0.100) loss_u loss_u 0.9209 (0.9331) acc_u 9.3750 (7.5000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/35] time 0.186 (0.183) data 0.107 (0.102) loss_u loss_u 0.9517 (0.9334) acc_u 6.2500 (7.7500) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/35] time 0.172 (0.182) data 0.093 (0.101) loss_u loss_u 0.9385 (0.9310) acc_u 6.2500 (7.9167) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [35/35] time 0.168 (0.180) data 0.088 (0.100) loss_u loss_u 0.9746 (0.9286) acc_u 3.1250 (8.3036) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 495
clean true:478
clean false:17
clean_rate:0.9656565656565657
noisy true:577
noisy false:544
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1121
epoch [130/200] batch [5/15] time 0.189 (0.181) data 0.111 (0.103) loss_x loss_x 0.6826 (0.5870) acc_x 81.2500 (85.0000) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/15] time 0.179 (0.184) data 0.101 (0.106) loss_x loss_x 0.5723 (0.5921) acc_x 90.6250 (87.1875) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [15/15] time 0.160 (0.178) data 0.082 (0.100) loss_x loss_x 0.5078 (0.6036) acc_x 84.3750 (86.4583) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/35] time 0.173 (0.176) data 0.094 (0.098) loss_u loss_u 0.9111 (0.9280) acc_u 9.3750 (8.1250) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [10/35] time 0.174 (0.176) data 0.095 (0.098) loss_u loss_u 0.8716 (0.9262) acc_u 15.6250 (8.7500) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/35] time 0.192 (0.176) data 0.115 (0.098) loss_u loss_u 0.9980 (0.9343) acc_u 0.0000 (7.7083) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/35] time 0.183 (0.181) data 0.105 (0.100) loss_u loss_u 0.9805 (0.9330) acc_u 3.1250 (7.9688) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/35] time 0.188 (0.182) data 0.110 (0.101) loss_u loss_u 0.9917 (0.9358) acc_u 0.0000 (7.5000) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [30/35] time 0.185 (0.182) data 0.107 (0.102) loss_u loss_u 0.9561 (0.9392) acc_u 6.2500 (7.2917) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [35/35] time 0.184 (0.183) data 0.107 (0.102) loss_u loss_u 0.9741 (0.9397) acc_u 6.2500 (7.3214) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 516
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:499
clean false:12
clean_rate:0.9765166340508806
noisy true:601
noisy false:504
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [131/200] batch [5/15] time 0.184 (0.216) data 0.106 (0.122) loss_x loss_x 0.6753 (0.6222) acc_x 81.2500 (83.1250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/15] time 0.184 (0.202) data 0.106 (0.116) loss_x loss_x 0.7700 (0.5717) acc_x 78.1250 (85.9375) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [15/15] time 0.216 (0.198) data 0.139 (0.115) loss_x loss_x 0.5083 (0.5754) acc_x 90.6250 (85.8333) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/34] time 0.184 (0.195) data 0.106 (0.113) loss_u loss_u 0.9429 (0.9603) acc_u 6.2500 (4.3750) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [10/34] time 0.167 (0.190) data 0.087 (0.109) loss_u loss_u 0.9111 (0.9476) acc_u 12.5000 (5.9375) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [15/34] time 0.172 (0.186) data 0.093 (0.106) loss_u loss_u 0.9639 (0.9534) acc_u 3.1250 (5.2083) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [20/34] time 0.167 (0.184) data 0.088 (0.104) loss_u loss_u 0.9375 (0.9540) acc_u 6.2500 (5.1562) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/34] time 0.184 (0.186) data 0.107 (0.104) loss_u loss_u 0.9146 (0.9525) acc_u 9.3750 (5.3750) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [30/34] time 0.189 (0.187) data 0.109 (0.105) loss_u loss_u 0.9990 (0.9537) acc_u 0.0000 (5.2083) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 543
confident_label rate tensor(0.3038, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 491
clean true:476
clean false:15
clean_rate:0.9694501018329938
noisy true:597
noisy false:528
after delete: len(clean_dataset) 491
after delete: len(noisy_dataset) 1125
epoch [132/200] batch [5/15] time 0.173 (0.178) data 0.094 (0.100) loss_x loss_x 0.6626 (0.5213) acc_x 90.6250 (87.5000) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [10/15] time 0.162 (0.172) data 0.084 (0.094) loss_x loss_x 0.5342 (0.5788) acc_x 87.5000 (85.6250) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [15/15] time 0.161 (0.169) data 0.083 (0.091) loss_x loss_x 0.3462 (0.5325) acc_x 90.6250 (86.4583) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/35] time 0.162 (0.167) data 0.083 (0.089) loss_u loss_u 0.9985 (0.9567) acc_u 0.0000 (4.3750) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [10/35] time 0.164 (0.166) data 0.086 (0.088) loss_u loss_u 0.8594 (0.9442) acc_u 15.6250 (5.9375) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/35] time 0.264 (0.172) data 0.090 (0.088) loss_u loss_u 0.9521 (0.9387) acc_u 6.2500 (6.6667) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/35] time 0.161 (0.170) data 0.083 (0.087) loss_u loss_u 0.8779 (0.9371) acc_u 12.5000 (6.7188) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/35] time 0.177 (0.170) data 0.099 (0.088) loss_u loss_u 0.9224 (0.9382) acc_u 6.2500 (6.6250) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [30/35] time 0.184 (0.171) data 0.106 (0.089) loss_u loss_u 0.9595 (0.9394) acc_u 6.2500 (6.3542) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [35/35] time 0.186 (0.171) data 0.107 (0.089) loss_u loss_u 0.9766 (0.9393) acc_u 3.1250 (6.4286) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 526
confident_label rate tensor(0.3094, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 500
clean true:489
clean false:11
clean_rate:0.978
noisy true:601
noisy false:515
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1116
epoch [133/200] batch [5/15] time 0.192 (0.210) data 0.115 (0.110) loss_x loss_x 0.3752 (0.3660) acc_x 90.6250 (90.0000) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/15] time 0.194 (0.193) data 0.116 (0.104) loss_x loss_x 1.0146 (0.4264) acc_x 71.8750 (89.0625) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [15/15] time 0.165 (0.186) data 0.088 (0.100) loss_x loss_x 0.3296 (0.4406) acc_x 90.6250 (89.1667) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/34] time 0.203 (0.187) data 0.125 (0.104) loss_u loss_u 0.9326 (0.9453) acc_u 6.2500 (5.6250) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [10/34] time 0.210 (0.187) data 0.131 (0.104) loss_u loss_u 0.9468 (0.9499) acc_u 6.2500 (5.3125) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/34] time 0.185 (0.184) data 0.108 (0.102) loss_u loss_u 0.9175 (0.9444) acc_u 9.3750 (6.0417) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [20/34] time 0.210 (0.189) data 0.131 (0.105) loss_u loss_u 0.9551 (0.9418) acc_u 3.1250 (6.2500) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/34] time 0.162 (0.187) data 0.084 (0.104) loss_u loss_u 0.9360 (0.9392) acc_u 6.2500 (6.6250) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [30/34] time 0.178 (0.188) data 0.098 (0.105) loss_u loss_u 0.9624 (0.9420) acc_u 3.1250 (6.3542) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 509
clean true:490
clean false:19
clean_rate:0.962671905697446
noisy true:590
noisy false:517
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1107
epoch [134/200] batch [5/15] time 0.162 (0.198) data 0.085 (0.085) loss_x loss_x 0.4600 (0.5910) acc_x 87.5000 (82.5000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/15] time 0.205 (0.197) data 0.127 (0.101) loss_x loss_x 0.8169 (0.5624) acc_x 78.1250 (85.0000) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [15/15] time 0.186 (0.195) data 0.109 (0.105) loss_x loss_x 0.5044 (0.5704) acc_x 84.3750 (85.2083) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/34] time 0.193 (0.192) data 0.114 (0.105) loss_u loss_u 0.9243 (0.9497) acc_u 9.3750 (5.6250) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [10/34] time 0.185 (0.190) data 0.108 (0.105) loss_u loss_u 0.9507 (0.9362) acc_u 6.2500 (8.1250) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/34] time 0.209 (0.191) data 0.131 (0.107) loss_u loss_u 0.9165 (0.9438) acc_u 9.3750 (7.0833) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/34] time 0.184 (0.189) data 0.104 (0.106) loss_u loss_u 0.9692 (0.9479) acc_u 3.1250 (6.4062) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/34] time 0.277 (0.190) data 0.086 (0.105) loss_u loss_u 0.9561 (0.9520) acc_u 3.1250 (5.7500) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/34] time 0.176 (0.190) data 0.098 (0.105) loss_u loss_u 0.9956 (0.9529) acc_u 0.0000 (5.7292) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.3168, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 512
clean true:496
clean false:16
clean_rate:0.96875
noisy true:586
noisy false:518
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1104
epoch [135/200] batch [5/16] time 0.191 (0.188) data 0.114 (0.110) loss_x loss_x 0.7002 (0.6186) acc_x 84.3750 (85.0000) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [10/16] time 0.172 (0.196) data 0.095 (0.103) loss_x loss_x 0.7310 (0.6288) acc_x 87.5000 (84.6875) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [15/16] time 0.158 (0.188) data 0.080 (0.101) loss_x loss_x 0.3931 (0.5862) acc_x 93.7500 (86.0417) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/34] time 0.187 (0.186) data 0.107 (0.101) loss_u loss_u 0.9351 (0.9654) acc_u 6.2500 (3.1250) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/34] time 0.170 (0.184) data 0.092 (0.100) loss_u loss_u 0.9980 (0.9637) acc_u 0.0000 (3.4375) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/34] time 0.205 (0.184) data 0.127 (0.101) loss_u loss_u 0.8838 (0.9590) acc_u 12.5000 (3.9583) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/34] time 0.161 (0.182) data 0.082 (0.100) loss_u loss_u 0.9995 (0.9650) acc_u 0.0000 (3.2812) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/34] time 0.160 (0.179) data 0.081 (0.098) loss_u loss_u 0.9619 (0.9602) acc_u 9.3750 (4.1250) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/34] time 0.160 (0.177) data 0.082 (0.096) loss_u loss_u 0.9482 (0.9537) acc_u 6.2500 (4.8958) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 513
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 502
clean true:488
clean false:14
clean_rate:0.9721115537848606
noisy true:615
noisy false:499
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1114
epoch [136/200] batch [5/15] time 0.171 (0.193) data 0.094 (0.116) loss_x loss_x 0.4968 (0.6052) acc_x 84.3750 (85.0000) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/15] time 0.185 (0.184) data 0.108 (0.106) loss_x loss_x 0.5029 (0.5196) acc_x 87.5000 (86.8750) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [15/15] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.8120 (0.5417) acc_x 81.2500 (86.4583) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/34] time 0.190 (0.187) data 0.112 (0.109) loss_u loss_u 0.9219 (0.9218) acc_u 9.3750 (9.3750) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [10/34] time 0.162 (0.189) data 0.084 (0.108) loss_u loss_u 0.9844 (0.9470) acc_u 0.0000 (6.5625) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/34] time 0.168 (0.187) data 0.090 (0.106) loss_u loss_u 0.9331 (0.9448) acc_u 9.3750 (6.8750) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [20/34] time 0.174 (0.185) data 0.096 (0.105) loss_u loss_u 0.9341 (0.9470) acc_u 6.2500 (6.4062) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/34] time 0.169 (0.183) data 0.090 (0.103) loss_u loss_u 0.9414 (0.9431) acc_u 6.2500 (7.0000) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [30/34] time 0.158 (0.182) data 0.081 (0.102) loss_u loss_u 0.8955 (0.9445) acc_u 12.5000 (6.8750) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.2933, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 474
clean true:464
clean false:10
clean_rate:0.9789029535864979
noisy true:566
noisy false:576
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1142
epoch [137/200] batch [5/14] time 0.173 (0.171) data 0.093 (0.093) loss_x loss_x 0.6895 (0.5496) acc_x 81.2500 (85.0000) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/14] time 0.163 (0.173) data 0.084 (0.095) loss_x loss_x 0.1710 (0.5299) acc_x 96.8750 (85.6250) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/35] time 0.160 (0.167) data 0.082 (0.089) loss_u loss_u 0.9287 (0.9176) acc_u 9.3750 (8.7500) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/35] time 0.158 (0.165) data 0.080 (0.087) loss_u loss_u 0.9351 (0.9142) acc_u 6.2500 (9.3750) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/35] time 0.158 (0.168) data 0.080 (0.086) loss_u loss_u 0.9404 (0.9225) acc_u 6.2500 (8.7500) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/35] time 0.159 (0.167) data 0.080 (0.085) loss_u loss_u 1.0000 (0.9317) acc_u 0.0000 (7.8125) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/35] time 0.161 (0.167) data 0.082 (0.086) loss_u loss_u 0.8213 (0.9317) acc_u 21.8750 (8.2500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [30/35] time 0.184 (0.169) data 0.104 (0.089) loss_u loss_u 0.9399 (0.9259) acc_u 9.3750 (8.9583) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [35/35] time 0.190 (0.170) data 0.112 (0.090) loss_u loss_u 0.8423 (0.9266) acc_u 18.7500 (8.7500) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3032, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 490
clean true:474
clean false:16
clean_rate:0.9673469387755103
noisy true:591
noisy false:535
after delete: len(clean_dataset) 490
after delete: len(noisy_dataset) 1126
epoch [138/200] batch [5/15] time 0.177 (0.169) data 0.099 (0.091) loss_x loss_x 0.3894 (0.4018) acc_x 87.5000 (88.7500) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/15] time 0.158 (0.167) data 0.081 (0.089) loss_x loss_x 0.6426 (0.4598) acc_x 87.5000 (87.8125) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [15/15] time 0.171 (0.169) data 0.093 (0.091) loss_x loss_x 0.3586 (0.4373) acc_x 90.6250 (88.3333) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/35] time 0.207 (0.171) data 0.128 (0.093) loss_u loss_u 0.9478 (0.9417) acc_u 9.3750 (7.5000) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [10/35] time 0.164 (0.172) data 0.086 (0.094) loss_u loss_u 0.9307 (0.9387) acc_u 9.3750 (7.8125) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/35] time 0.158 (0.173) data 0.080 (0.095) loss_u loss_u 0.9126 (0.9428) acc_u 12.5000 (7.0833) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/35] time 0.192 (0.177) data 0.113 (0.096) loss_u loss_u 0.8745 (0.9412) acc_u 12.5000 (7.0312) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/35] time 0.189 (0.177) data 0.111 (0.096) loss_u loss_u 0.8750 (0.9346) acc_u 15.6250 (8.0000) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/35] time 0.184 (0.177) data 0.106 (0.096) loss_u loss_u 0.9697 (0.9364) acc_u 3.1250 (7.8125) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [35/35] time 0.182 (0.177) data 0.105 (0.097) loss_u loss_u 0.9614 (0.9382) acc_u 6.2500 (7.5000) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 531
confident_label rate tensor(0.3094, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 500
clean true:485
clean false:15
clean_rate:0.97
noisy true:600
noisy false:516
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1116
epoch [139/200] batch [5/15] time 0.161 (0.189) data 0.084 (0.090) loss_x loss_x 0.2842 (0.4412) acc_x 93.7500 (89.3750) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/15] time 0.168 (0.183) data 0.090 (0.094) loss_x loss_x 0.4080 (0.4471) acc_x 90.6250 (88.4375) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [15/15] time 0.175 (0.181) data 0.098 (0.096) loss_x loss_x 0.4792 (0.4552) acc_x 87.5000 (88.3333) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/34] time 0.180 (0.180) data 0.102 (0.096) loss_u loss_u 0.9912 (0.9512) acc_u 3.1250 (5.6250) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [10/34] time 0.187 (0.178) data 0.109 (0.096) loss_u loss_u 0.8979 (0.9416) acc_u 12.5000 (6.8750) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/34] time 0.189 (0.178) data 0.110 (0.097) loss_u loss_u 0.9629 (0.9462) acc_u 3.1250 (6.2500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [20/34] time 0.160 (0.178) data 0.083 (0.096) loss_u loss_u 0.9688 (0.9450) acc_u 3.1250 (6.2500) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/34] time 0.196 (0.181) data 0.119 (0.097) loss_u loss_u 0.9697 (0.9447) acc_u 3.1250 (6.2500) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [30/34] time 0.183 (0.180) data 0.104 (0.097) loss_u loss_u 0.9419 (0.9443) acc_u 6.2500 (6.2500) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.2989, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 483
clean true:471
clean false:12
clean_rate:0.9751552795031055
noisy true:612
noisy false:521
after delete: len(clean_dataset) 483
after delete: len(noisy_dataset) 1133
epoch [140/200] batch [5/15] time 0.295 (0.209) data 0.108 (0.109) loss_x loss_x 0.3657 (0.4774) acc_x 93.7500 (88.7500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/15] time 0.185 (0.202) data 0.107 (0.108) loss_x loss_x 0.5815 (0.5533) acc_x 81.2500 (85.6250) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/15] time 0.183 (0.197) data 0.105 (0.108) loss_x loss_x 0.6362 (0.5262) acc_x 84.3750 (86.4583) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/35] time 0.174 (0.192) data 0.095 (0.106) loss_u loss_u 0.8901 (0.9167) acc_u 12.5000 (10.6250) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/35] time 0.188 (0.189) data 0.110 (0.105) loss_u loss_u 0.9126 (0.9077) acc_u 9.3750 (10.9375) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/35] time 0.365 (0.193) data 0.287 (0.109) loss_u loss_u 0.9482 (0.9150) acc_u 9.3750 (10.4167) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/35] time 0.198 (0.199) data 0.120 (0.111) loss_u loss_u 0.9702 (0.9236) acc_u 3.1250 (9.0625) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/35] time 0.159 (0.194) data 0.081 (0.108) loss_u loss_u 0.9604 (0.9270) acc_u 6.2500 (8.7500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [30/35] time 0.162 (0.190) data 0.083 (0.105) loss_u loss_u 0.9502 (0.9306) acc_u 6.2500 (8.3333) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [35/35] time 0.166 (0.188) data 0.087 (0.103) loss_u loss_u 0.9390 (0.9328) acc_u 9.3750 (8.0357) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 547
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:489
clean false:12
clean_rate:0.9760479041916168
noisy true:580
noisy false:535
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [141/200] batch [5/15] time 0.185 (0.175) data 0.107 (0.098) loss_x loss_x 0.3945 (0.4406) acc_x 90.6250 (89.3750) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/15] time 0.162 (0.171) data 0.085 (0.094) loss_x loss_x 0.5728 (0.4625) acc_x 87.5000 (88.4375) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [15/15] time 0.184 (0.181) data 0.107 (0.093) loss_x loss_x 0.5249 (0.4773) acc_x 90.6250 (87.7083) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/34] time 0.158 (0.178) data 0.081 (0.093) loss_u loss_u 0.9604 (0.9790) acc_u 3.1250 (1.8750) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [10/34] time 0.167 (0.178) data 0.089 (0.094) loss_u loss_u 0.9839 (0.9667) acc_u 3.1250 (3.7500) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/34] time 0.198 (0.177) data 0.120 (0.094) loss_u loss_u 0.9194 (0.9539) acc_u 9.3750 (5.0000) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/34] time 0.182 (0.178) data 0.104 (0.096) loss_u loss_u 0.9116 (0.9516) acc_u 9.3750 (5.1562) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/34] time 0.181 (0.178) data 0.103 (0.096) loss_u loss_u 0.8403 (0.9471) acc_u 21.8750 (5.7500) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/34] time 0.160 (0.177) data 0.082 (0.096) loss_u loss_u 0.9658 (0.9438) acc_u 3.1250 (6.1458) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 518
clean true:505
clean false:13
clean_rate:0.974903474903475
noisy true:611
noisy false:487
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1098
epoch [142/200] batch [5/16] time 0.186 (0.175) data 0.108 (0.097) loss_x loss_x 0.7617 (0.5464) acc_x 78.1250 (85.0000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/16] time 0.168 (0.175) data 0.090 (0.098) loss_x loss_x 0.5864 (0.5269) acc_x 87.5000 (86.8750) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [15/16] time 0.185 (0.176) data 0.106 (0.098) loss_x loss_x 0.5742 (0.5822) acc_x 87.5000 (86.6667) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/34] time 0.163 (0.179) data 0.084 (0.095) loss_u loss_u 0.9692 (0.9757) acc_u 3.1250 (3.1250) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/34] time 0.161 (0.176) data 0.083 (0.093) loss_u loss_u 0.9946 (0.9630) acc_u 0.0000 (4.6875) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/34] time 0.161 (0.174) data 0.083 (0.092) loss_u loss_u 0.9868 (0.9607) acc_u 0.0000 (4.7917) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/34] time 0.163 (0.172) data 0.085 (0.091) loss_u loss_u 0.9717 (0.9591) acc_u 3.1250 (5.0000) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/34] time 0.161 (0.171) data 0.083 (0.090) loss_u loss_u 0.9487 (0.9609) acc_u 6.2500 (4.7500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [30/34] time 0.165 (0.170) data 0.086 (0.089) loss_u loss_u 0.9648 (0.9584) acc_u 3.1250 (5.0000) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 497
clean true:485
clean false:12
clean_rate:0.9758551307847082
noisy true:594
noisy false:525
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1119
epoch [143/200] batch [5/15] time 0.161 (0.172) data 0.083 (0.094) loss_x loss_x 0.3484 (0.4455) acc_x 96.8750 (91.2500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/15] time 0.186 (0.174) data 0.108 (0.096) loss_x loss_x 0.3792 (0.5383) acc_x 93.7500 (87.1875) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [15/15] time 0.161 (0.172) data 0.083 (0.095) loss_x loss_x 0.4077 (0.4762) acc_x 93.7500 (89.1667) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/34] time 0.185 (0.174) data 0.107 (0.096) loss_u loss_u 0.9941 (0.9630) acc_u 0.0000 (4.3750) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [10/34] time 0.193 (0.182) data 0.115 (0.099) loss_u loss_u 0.9839 (0.9395) acc_u 3.1250 (7.8125) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/34] time 0.255 (0.189) data 0.177 (0.107) loss_u loss_u 0.9980 (0.9373) acc_u 0.0000 (7.7083) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/34] time 0.200 (0.189) data 0.123 (0.107) loss_u loss_u 0.9028 (0.9439) acc_u 12.5000 (6.7188) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/34] time 0.235 (0.190) data 0.158 (0.109) loss_u loss_u 0.9678 (0.9430) acc_u 3.1250 (6.8750) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/34] time 0.171 (0.189) data 0.094 (0.108) loss_u loss_u 0.8535 (0.9392) acc_u 15.6250 (7.2917) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:484
clean false:15
clean_rate:0.969939879759519
noisy true:597
noisy false:520
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [144/200] batch [5/15] time 0.158 (0.174) data 0.081 (0.097) loss_x loss_x 0.4543 (0.6286) acc_x 93.7500 (85.6250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/15] time 0.176 (0.173) data 0.099 (0.095) loss_x loss_x 0.6499 (0.5594) acc_x 87.5000 (87.1875) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [15/15] time 0.176 (0.172) data 0.099 (0.095) loss_x loss_x 0.6143 (0.5146) acc_x 81.2500 (87.2917) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/34] time 0.164 (0.171) data 0.086 (0.094) loss_u loss_u 0.9111 (0.9523) acc_u 12.5000 (5.6250) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/34] time 0.184 (0.171) data 0.105 (0.094) loss_u loss_u 0.8838 (0.9338) acc_u 12.5000 (7.5000) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [15/34] time 0.172 (0.172) data 0.094 (0.094) loss_u loss_u 0.9492 (0.9313) acc_u 6.2500 (7.9167) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/34] time 0.194 (0.172) data 0.116 (0.095) loss_u loss_u 0.9663 (0.9353) acc_u 3.1250 (7.1875) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/34] time 0.178 (0.176) data 0.100 (0.094) loss_u loss_u 0.8936 (0.9368) acc_u 12.5000 (7.1250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/34] time 0.187 (0.175) data 0.108 (0.094) loss_u loss_u 0.9585 (0.9415) acc_u 6.2500 (6.6667) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 526
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 495
clean true:486
clean false:9
clean_rate:0.9818181818181818
noisy true:604
noisy false:517
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1121
epoch [145/200] batch [5/15] time 0.160 (0.202) data 0.082 (0.101) loss_x loss_x 0.3044 (0.3675) acc_x 90.6250 (90.0000) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/15] time 0.179 (0.191) data 0.101 (0.101) loss_x loss_x 0.6245 (0.3831) acc_x 84.3750 (89.6875) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [15/15] time 0.174 (0.185) data 0.096 (0.099) loss_x loss_x 0.5088 (0.4126) acc_x 90.6250 (89.3750) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/35] time 0.170 (0.182) data 0.093 (0.098) loss_u loss_u 0.9673 (0.9331) acc_u 3.1250 (7.5000) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [10/35] time 0.188 (0.181) data 0.109 (0.098) loss_u loss_u 0.9658 (0.9459) acc_u 3.1250 (6.2500) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/35] time 0.165 (0.179) data 0.086 (0.097) loss_u loss_u 0.9316 (0.9398) acc_u 6.2500 (6.6667) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [20/35] time 0.166 (0.177) data 0.088 (0.095) loss_u loss_u 0.9219 (0.9484) acc_u 9.3750 (5.7812) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/35] time 0.166 (0.175) data 0.088 (0.094) loss_u loss_u 0.9800 (0.9512) acc_u 3.1250 (5.3750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [30/35] time 0.167 (0.177) data 0.089 (0.093) loss_u loss_u 0.8506 (0.9454) acc_u 18.7500 (6.1458) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [35/35] time 0.161 (0.175) data 0.083 (0.093) loss_u loss_u 0.9429 (0.9420) acc_u 6.2500 (6.5179) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 502
clean true:490
clean false:12
clean_rate:0.9760956175298805
noisy true:593
noisy false:521
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1114
epoch [146/200] batch [5/15] time 0.185 (0.186) data 0.108 (0.108) loss_x loss_x 0.6064 (0.5951) acc_x 81.2500 (85.6250) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/15] time 0.264 (0.193) data 0.107 (0.108) loss_x loss_x 0.6777 (0.5287) acc_x 81.2500 (86.2500) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [15/15] time 0.183 (0.202) data 0.106 (0.117) loss_x loss_x 0.4424 (0.4942) acc_x 90.6250 (87.7083) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/34] time 0.183 (0.198) data 0.104 (0.116) loss_u loss_u 0.9478 (0.9363) acc_u 6.2500 (8.1250) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [10/34] time 0.186 (0.196) data 0.108 (0.114) loss_u loss_u 1.0000 (0.9524) acc_u 0.0000 (5.6250) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/34] time 0.185 (0.194) data 0.108 (0.113) loss_u loss_u 0.9731 (0.9568) acc_u 3.1250 (5.2083) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/34] time 0.185 (0.193) data 0.106 (0.112) loss_u loss_u 0.9858 (0.9531) acc_u 0.0000 (5.4688) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/34] time 0.186 (0.194) data 0.107 (0.111) loss_u loss_u 0.9570 (0.9519) acc_u 3.1250 (5.5000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [30/34] time 0.184 (0.193) data 0.106 (0.110) loss_u loss_u 0.9038 (0.9488) acc_u 12.5000 (5.9375) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 520
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:492
clean false:15
clean_rate:0.9704142011834319
noisy true:604
noisy false:505
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [147/200] batch [5/15] time 0.160 (0.160) data 0.083 (0.082) loss_x loss_x 0.1022 (0.5696) acc_x 100.0000 (88.7500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/15] time 0.160 (0.161) data 0.082 (0.083) loss_x loss_x 0.2413 (0.5915) acc_x 93.7500 (88.4375) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [15/15] time 0.161 (0.161) data 0.083 (0.083) loss_x loss_x 0.3755 (0.5312) acc_x 90.6250 (88.5417) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/34] time 0.182 (0.169) data 0.103 (0.086) loss_u loss_u 0.9580 (0.9334) acc_u 6.2500 (7.5000) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/34] time 0.161 (0.169) data 0.084 (0.087) loss_u loss_u 0.9453 (0.9224) acc_u 6.2500 (9.3750) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/34] time 0.193 (0.171) data 0.116 (0.089) loss_u loss_u 0.9482 (0.9337) acc_u 6.2500 (7.9167) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/34] time 0.198 (0.171) data 0.120 (0.090) loss_u loss_u 0.9438 (0.9416) acc_u 6.2500 (6.8750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/34] time 0.160 (0.172) data 0.081 (0.091) loss_u loss_u 0.9619 (0.9434) acc_u 6.2500 (6.6250) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [30/34] time 0.184 (0.172) data 0.104 (0.091) loss_u loss_u 0.9751 (0.9465) acc_u 3.1250 (6.2500) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 520
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 502
clean true:488
clean false:14
clean_rate:0.9721115537848606
noisy true:608
noisy false:506
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1114
epoch [148/200] batch [5/15] time 0.170 (0.165) data 0.093 (0.088) loss_x loss_x 0.9507 (0.8063) acc_x 78.1250 (81.8750) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/15] time 0.170 (0.170) data 0.093 (0.092) loss_x loss_x 0.5776 (0.6747) acc_x 90.6250 (84.6875) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [15/15] time 0.186 (0.176) data 0.109 (0.099) loss_x loss_x 0.4468 (0.6688) acc_x 84.3750 (85.0000) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/34] time 0.192 (0.179) data 0.114 (0.101) loss_u loss_u 0.9883 (0.9683) acc_u 3.1250 (3.1250) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [10/34] time 0.187 (0.185) data 0.109 (0.104) loss_u loss_u 0.8799 (0.9361) acc_u 15.6250 (6.8750) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/34] time 0.187 (0.186) data 0.108 (0.104) loss_u loss_u 0.9629 (0.9422) acc_u 3.1250 (6.4583) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/34] time 0.200 (0.186) data 0.123 (0.105) loss_u loss_u 0.9365 (0.9416) acc_u 6.2500 (6.5625) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/34] time 0.187 (0.186) data 0.109 (0.105) loss_u loss_u 0.9268 (0.9375) acc_u 12.5000 (7.1250) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [30/34] time 0.164 (0.184) data 0.085 (0.104) loss_u loss_u 0.9834 (0.9407) acc_u 3.1250 (6.6667) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 506
clean true:493
clean false:13
clean_rate:0.974308300395257
noisy true:595
noisy false:515
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1110
epoch [149/200] batch [5/15] time 0.169 (0.173) data 0.091 (0.096) loss_x loss_x 0.3843 (0.4392) acc_x 93.7500 (90.0000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/15] time 0.207 (0.185) data 0.130 (0.107) loss_x loss_x 0.6577 (0.4683) acc_x 81.2500 (88.1250) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [15/15] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 0.6836 (0.4500) acc_x 84.3750 (88.9583) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/34] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.9883 (0.9548) acc_u 3.1250 (5.0000) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [10/34] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.9546 (0.9489) acc_u 9.3750 (5.9375) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/34] time 0.202 (0.185) data 0.125 (0.107) loss_u loss_u 0.9551 (0.9547) acc_u 3.1250 (5.2083) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/34] time 0.185 (0.188) data 0.108 (0.107) loss_u loss_u 0.9600 (0.9546) acc_u 6.2500 (5.3125) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/34] time 0.161 (0.187) data 0.082 (0.106) loss_u loss_u 0.9292 (0.9444) acc_u 6.2500 (6.6250) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [30/34] time 0.186 (0.187) data 0.106 (0.107) loss_u loss_u 0.9277 (0.9437) acc_u 6.2500 (6.5625) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 503
clean true:492
clean false:11
clean_rate:0.9781312127236581
noisy true:590
noisy false:523
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1113
epoch [150/200] batch [5/15] time 0.186 (0.178) data 0.109 (0.100) loss_x loss_x 0.3982 (0.5221) acc_x 90.6250 (87.5000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/15] time 0.184 (0.180) data 0.106 (0.103) loss_x loss_x 0.1505 (0.4868) acc_x 100.0000 (88.1250) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [15/15] time 0.185 (0.182) data 0.107 (0.104) loss_x loss_x 0.3831 (0.4761) acc_x 87.5000 (87.5000) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/34] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9380 (0.9698) acc_u 6.2500 (3.1250) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [10/34] time 0.186 (0.183) data 0.107 (0.105) loss_u loss_u 0.9995 (0.9437) acc_u 0.0000 (6.2500) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/34] time 0.183 (0.184) data 0.106 (0.106) loss_u loss_u 0.9795 (0.9526) acc_u 3.1250 (5.4167) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/34] time 0.187 (0.187) data 0.109 (0.106) loss_u loss_u 0.9600 (0.9567) acc_u 3.1250 (5.0000) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/34] time 0.183 (0.187) data 0.104 (0.107) loss_u loss_u 0.8394 (0.9539) acc_u 18.7500 (5.2500) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [30/34] time 0.190 (0.187) data 0.111 (0.107) loss_u loss_u 0.9058 (0.9490) acc_u 9.3750 (5.7292) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.3057, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 494
clean true:478
clean false:16
clean_rate:0.9676113360323887
noisy true:604
noisy false:518
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1122
epoch [151/200] batch [5/15] time 0.172 (0.181) data 0.094 (0.103) loss_x loss_x 0.5518 (0.4226) acc_x 87.5000 (88.7500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/15] time 0.186 (0.177) data 0.108 (0.099) loss_x loss_x 0.6172 (0.4086) acc_x 87.5000 (90.0000) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [15/15] time 0.182 (0.174) data 0.104 (0.096) loss_x loss_x 0.5747 (0.4259) acc_x 84.3750 (89.3750) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/35] time 0.160 (0.173) data 0.082 (0.094) loss_u loss_u 0.9995 (0.9472) acc_u 0.0000 (5.6250) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [10/35] time 0.174 (0.174) data 0.095 (0.095) loss_u loss_u 0.9736 (0.9461) acc_u 3.1250 (5.9375) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/35] time 0.237 (0.177) data 0.082 (0.094) loss_u loss_u 0.9160 (0.9426) acc_u 9.3750 (6.6667) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/35] time 0.175 (0.176) data 0.096 (0.093) loss_u loss_u 0.9604 (0.9429) acc_u 3.1250 (6.7188) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/35] time 0.176 (0.176) data 0.097 (0.094) loss_u loss_u 0.8848 (0.9365) acc_u 12.5000 (7.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [30/35] time 0.176 (0.176) data 0.098 (0.094) loss_u loss_u 0.9775 (0.9331) acc_u 3.1250 (7.6042) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [35/35] time 0.211 (0.177) data 0.132 (0.096) loss_u loss_u 0.9600 (0.9373) acc_u 6.2500 (7.2321) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 503
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:488
clean false:13
clean_rate:0.9740518962075848
noisy true:625
noisy false:490
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [152/200] batch [5/15] time 0.172 (0.196) data 0.095 (0.093) loss_x loss_x 0.5337 (0.4586) acc_x 90.6250 (89.3750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/15] time 0.166 (0.190) data 0.088 (0.100) loss_x loss_x 0.2939 (0.4226) acc_x 90.6250 (88.7500) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [15/15] time 0.184 (0.188) data 0.107 (0.102) loss_x loss_x 0.3647 (0.4085) acc_x 90.6250 (89.5833) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/34] time 0.183 (0.188) data 0.105 (0.104) loss_u loss_u 0.8994 (0.9303) acc_u 12.5000 (8.1250) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [10/34] time 0.257 (0.191) data 0.179 (0.108) loss_u loss_u 0.9395 (0.9288) acc_u 6.2500 (8.4375) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/34] time 0.186 (0.190) data 0.109 (0.108) loss_u loss_u 0.9072 (0.9311) acc_u 12.5000 (8.3333) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [20/34] time 0.183 (0.189) data 0.105 (0.108) loss_u loss_u 0.9707 (0.9310) acc_u 3.1250 (8.1250) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/34] time 0.188 (0.192) data 0.109 (0.108) loss_u loss_u 0.9282 (0.9334) acc_u 9.3750 (7.8750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [30/34] time 0.201 (0.192) data 0.123 (0.108) loss_u loss_u 0.9980 (0.9366) acc_u 0.0000 (7.3958) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 506
clean true:491
clean false:15
clean_rate:0.9703557312252964
noisy true:620
noisy false:490
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1110
epoch [153/200] batch [5/15] time 0.166 (0.194) data 0.089 (0.089) loss_x loss_x 0.4114 (0.5072) acc_x 93.7500 (88.1250) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/15] time 0.185 (0.188) data 0.107 (0.096) loss_x loss_x 0.5615 (0.4796) acc_x 87.5000 (87.1875) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [15/15] time 0.159 (0.178) data 0.082 (0.091) loss_x loss_x 0.2524 (0.4510) acc_x 93.7500 (88.5417) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/34] time 0.185 (0.178) data 0.107 (0.094) loss_u loss_u 0.9292 (0.9259) acc_u 6.2500 (7.5000) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [10/34] time 0.182 (0.179) data 0.104 (0.096) loss_u loss_u 0.9038 (0.9373) acc_u 9.3750 (6.2500) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/34] time 0.181 (0.180) data 0.104 (0.097) loss_u loss_u 0.8857 (0.9314) acc_u 12.5000 (7.0833) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/34] time 0.182 (0.180) data 0.103 (0.099) loss_u loss_u 0.9761 (0.9389) acc_u 3.1250 (6.5625) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/34] time 0.181 (0.181) data 0.103 (0.099) loss_u loss_u 1.0000 (0.9417) acc_u 0.0000 (6.2500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [30/34] time 0.186 (0.184) data 0.106 (0.100) loss_u loss_u 0.9648 (0.9392) acc_u 3.1250 (6.5625) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 540
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 506
clean true:487
clean false:19
clean_rate:0.9624505928853755
noisy true:589
noisy false:521
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1110
epoch [154/200] batch [5/15] time 0.186 (0.189) data 0.108 (0.111) loss_x loss_x 0.5962 (0.5000) acc_x 87.5000 (88.1250) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/15] time 0.186 (0.188) data 0.108 (0.110) loss_x loss_x 0.5903 (0.4752) acc_x 81.2500 (87.8125) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [15/15] time 0.196 (0.187) data 0.118 (0.110) loss_x loss_x 0.4343 (0.5071) acc_x 87.5000 (86.0417) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/34] time 0.188 (0.193) data 0.109 (0.108) loss_u loss_u 0.9961 (0.9504) acc_u 0.0000 (5.0000) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [10/34] time 0.177 (0.190) data 0.100 (0.106) loss_u loss_u 0.8462 (0.9340) acc_u 15.6250 (7.1875) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/34] time 0.178 (0.189) data 0.101 (0.106) loss_u loss_u 0.9106 (0.9392) acc_u 9.3750 (6.4583) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/34] time 0.185 (0.189) data 0.107 (0.107) loss_u loss_u 0.9058 (0.9371) acc_u 9.3750 (6.8750) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/34] time 0.186 (0.188) data 0.107 (0.107) loss_u loss_u 0.9038 (0.9434) acc_u 12.5000 (6.3750) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/34] time 0.186 (0.188) data 0.108 (0.107) loss_u loss_u 0.9077 (0.9426) acc_u 9.3750 (6.3542) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.3193, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 516
clean true:503
clean false:13
clean_rate:0.9748062015503876
noisy true:574
noisy false:526
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1100
epoch [155/200] batch [5/16] time 0.178 (0.188) data 0.100 (0.111) loss_x loss_x 0.5063 (0.4542) acc_x 90.6250 (90.0000) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/16] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.4846 (0.5870) acc_x 84.3750 (84.6875) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [15/16] time 0.159 (0.177) data 0.082 (0.099) loss_x loss_x 0.6514 (0.5496) acc_x 84.3750 (86.2500) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/34] time 0.176 (0.178) data 0.099 (0.098) loss_u loss_u 0.9194 (0.9332) acc_u 6.2500 (8.1250) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [10/34] time 0.185 (0.177) data 0.107 (0.097) loss_u loss_u 0.9692 (0.9455) acc_u 3.1250 (6.2500) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/34] time 0.169 (0.177) data 0.091 (0.097) loss_u loss_u 0.8408 (0.9370) acc_u 18.7500 (7.0833) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/34] time 0.170 (0.176) data 0.093 (0.097) loss_u loss_u 0.9229 (0.9375) acc_u 9.3750 (7.0312) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/34] time 0.165 (0.177) data 0.086 (0.098) loss_u loss_u 0.9370 (0.9434) acc_u 6.2500 (6.5000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [30/34] time 0.181 (0.178) data 0.104 (0.099) loss_u loss_u 0.9141 (0.9449) acc_u 9.3750 (6.2500) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 546
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 497
clean true:482
clean false:15
clean_rate:0.9698189134808853
noisy true:588
noisy false:531
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1119
epoch [156/200] batch [5/15] time 0.161 (0.186) data 0.084 (0.109) loss_x loss_x 0.6826 (0.5109) acc_x 81.2500 (90.0000) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/15] time 0.183 (0.188) data 0.106 (0.106) loss_x loss_x 0.4331 (0.4734) acc_x 84.3750 (89.0625) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [15/15] time 0.185 (0.187) data 0.107 (0.107) loss_x loss_x 0.5024 (0.4952) acc_x 87.5000 (88.1250) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/34] time 0.170 (0.183) data 0.091 (0.103) loss_u loss_u 0.9434 (0.9219) acc_u 6.2500 (9.3750) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/34] time 0.185 (0.182) data 0.107 (0.102) loss_u loss_u 0.9956 (0.9351) acc_u 0.0000 (7.8125) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/34] time 0.166 (0.179) data 0.087 (0.100) loss_u loss_u 0.9697 (0.9389) acc_u 3.1250 (7.2917) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/34] time 0.166 (0.177) data 0.088 (0.098) loss_u loss_u 0.9053 (0.9348) acc_u 9.3750 (7.5000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/34] time 0.166 (0.179) data 0.087 (0.097) loss_u loss_u 0.9141 (0.9284) acc_u 12.5000 (8.2500) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [30/34] time 0.161 (0.178) data 0.083 (0.096) loss_u loss_u 0.9473 (0.9297) acc_u 6.2500 (8.0208) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 543
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 495
clean true:483
clean false:12
clean_rate:0.9757575757575757
noisy true:590
noisy false:531
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1121
epoch [157/200] batch [5/15] time 0.183 (0.191) data 0.106 (0.113) loss_x loss_x 0.6631 (0.5029) acc_x 81.2500 (86.2500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/15] time 0.178 (0.181) data 0.100 (0.103) loss_x loss_x 0.4270 (0.5180) acc_x 90.6250 (87.5000) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [15/15] time 0.291 (0.187) data 0.106 (0.103) loss_x loss_x 0.1349 (0.5049) acc_x 100.0000 (88.1250) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/35] time 0.179 (0.187) data 0.100 (0.103) loss_u loss_u 0.9375 (0.9270) acc_u 6.2500 (8.1250) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/35] time 0.162 (0.183) data 0.083 (0.100) loss_u loss_u 0.9653 (0.9280) acc_u 3.1250 (7.8125) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/35] time 0.160 (0.179) data 0.081 (0.097) loss_u loss_u 0.9834 (0.9266) acc_u 0.0000 (7.9167) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/35] time 0.185 (0.180) data 0.106 (0.099) loss_u loss_u 0.9976 (0.9305) acc_u 0.0000 (7.6562) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/35] time 0.218 (0.182) data 0.139 (0.101) loss_u loss_u 0.9502 (0.9345) acc_u 6.2500 (7.2500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/35] time 0.186 (0.184) data 0.108 (0.103) loss_u loss_u 0.9785 (0.9346) acc_u 3.1250 (7.2917) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [35/35] time 0.295 (0.188) data 0.105 (0.105) loss_u loss_u 0.9053 (0.9325) acc_u 9.3750 (7.5893) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.3057, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 494
clean true:484
clean false:10
clean_rate:0.979757085020243
noisy true:608
noisy false:514
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1122
epoch [158/200] batch [5/15] time 0.160 (0.161) data 0.083 (0.084) loss_x loss_x 0.6265 (0.4091) acc_x 78.1250 (89.3750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/15] time 0.197 (0.165) data 0.119 (0.087) loss_x loss_x 0.5767 (0.4116) acc_x 87.5000 (89.6875) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [15/15] time 0.188 (0.171) data 0.106 (0.093) loss_x loss_x 0.4692 (0.4815) acc_x 93.7500 (88.5417) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/35] time 0.185 (0.180) data 0.106 (0.097) loss_u loss_u 0.9683 (0.9129) acc_u 3.1250 (10.0000) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [10/35] time 0.191 (0.182) data 0.113 (0.099) loss_u loss_u 0.9590 (0.9296) acc_u 6.2500 (8.1250) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/35] time 0.184 (0.183) data 0.105 (0.101) loss_u loss_u 0.9868 (0.9344) acc_u 0.0000 (7.0833) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/35] time 0.186 (0.183) data 0.108 (0.102) loss_u loss_u 0.8760 (0.9256) acc_u 12.5000 (8.1250) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/35] time 0.209 (0.184) data 0.130 (0.103) loss_u loss_u 0.9102 (0.9292) acc_u 12.5000 (8.0000) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [30/35] time 0.184 (0.185) data 0.107 (0.104) loss_u loss_u 0.9204 (0.9318) acc_u 9.3750 (7.7083) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [35/35] time 0.161 (0.184) data 0.083 (0.104) loss_u loss_u 0.9072 (0.9336) acc_u 12.5000 (7.5000) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.3057, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 494
clean true:482
clean false:12
clean_rate:0.9757085020242915
noisy true:612
noisy false:510
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1122
epoch [159/200] batch [5/15] time 0.178 (0.183) data 0.100 (0.106) loss_x loss_x 0.8496 (0.6393) acc_x 75.0000 (84.3750) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/15] time 0.201 (0.185) data 0.124 (0.107) loss_x loss_x 0.3428 (0.5149) acc_x 90.6250 (87.5000) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [15/15] time 0.194 (0.186) data 0.116 (0.108) loss_x loss_x 0.4990 (0.4696) acc_x 87.5000 (88.3333) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/35] time 0.192 (0.186) data 0.115 (0.109) loss_u loss_u 0.9087 (0.9219) acc_u 9.3750 (8.7500) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [10/35] time 0.165 (0.192) data 0.086 (0.110) loss_u loss_u 0.9600 (0.9402) acc_u 3.1250 (6.5625) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/35] time 0.172 (0.193) data 0.094 (0.112) loss_u loss_u 0.8564 (0.9362) acc_u 18.7500 (7.2917) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/35] time 0.190 (0.195) data 0.111 (0.114) loss_u loss_u 0.9131 (0.9396) acc_u 9.3750 (6.8750) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/35] time 0.170 (0.192) data 0.093 (0.111) loss_u loss_u 0.9683 (0.9400) acc_u 3.1250 (6.5000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [30/35] time 0.163 (0.189) data 0.084 (0.108) loss_u loss_u 0.9146 (0.9328) acc_u 9.3750 (7.1875) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [35/35] time 0.160 (0.186) data 0.082 (0.106) loss_u loss_u 0.9805 (0.9354) acc_u 3.1250 (6.8750) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3057, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 494
clean true:481
clean false:13
clean_rate:0.9736842105263158
noisy true:584
noisy false:538
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1122
epoch [160/200] batch [5/15] time 0.186 (0.191) data 0.109 (0.113) loss_x loss_x 0.4878 (0.5173) acc_x 84.3750 (87.5000) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/15] time 0.182 (0.187) data 0.105 (0.109) loss_x loss_x 0.6919 (0.5362) acc_x 84.3750 (86.5625) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [15/15] time 0.185 (0.186) data 0.106 (0.109) loss_x loss_x 0.2874 (0.4955) acc_x 96.8750 (87.9167) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/35] time 0.183 (0.186) data 0.104 (0.108) loss_u loss_u 0.9634 (0.9532) acc_u 6.2500 (5.6250) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [10/35] time 0.185 (0.190) data 0.107 (0.108) loss_u loss_u 0.8555 (0.9337) acc_u 15.6250 (7.8125) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/35] time 0.188 (0.187) data 0.110 (0.106) loss_u loss_u 0.9043 (0.9311) acc_u 9.3750 (7.9167) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/35] time 0.221 (0.189) data 0.142 (0.108) loss_u loss_u 0.8984 (0.9353) acc_u 9.3750 (7.3438) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/35] time 0.204 (0.189) data 0.125 (0.108) loss_u loss_u 0.9609 (0.9364) acc_u 6.2500 (7.3750) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [30/35] time 0.172 (0.189) data 0.093 (0.108) loss_u loss_u 0.8779 (0.9354) acc_u 12.5000 (7.3958) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [35/35] time 0.169 (0.187) data 0.091 (0.106) loss_u loss_u 0.9629 (0.9371) acc_u 3.1250 (7.2321) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.3168, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 512
clean true:499
clean false:13
clean_rate:0.974609375
noisy true:599
noisy false:505
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1104
epoch [161/200] batch [5/16] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.4990 (0.5094) acc_x 87.5000 (87.5000) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/16] time 0.185 (0.184) data 0.106 (0.107) loss_x loss_x 0.3743 (0.5023) acc_x 90.6250 (87.1875) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [15/16] time 0.188 (0.184) data 0.112 (0.107) loss_x loss_x 0.3921 (0.4889) acc_x 93.7500 (87.7083) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/34] time 0.161 (0.178) data 0.084 (0.100) loss_u loss_u 0.9976 (0.9630) acc_u 0.0000 (3.7500) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [10/34] time 0.183 (0.176) data 0.105 (0.098) loss_u loss_u 0.9526 (0.9436) acc_u 6.2500 (6.2500) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/34] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.9419 (0.9457) acc_u 6.2500 (5.8333) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/34] time 0.194 (0.182) data 0.115 (0.100) loss_u loss_u 0.9253 (0.9411) acc_u 6.2500 (6.2500) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/34] time 0.201 (0.182) data 0.124 (0.101) loss_u loss_u 0.9629 (0.9460) acc_u 6.2500 (5.8750) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [30/34] time 0.189 (0.183) data 0.109 (0.103) loss_u loss_u 0.8804 (0.9414) acc_u 12.5000 (6.3542) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 564
confident_label rate tensor(0.3069, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 496
clean true:478
clean false:18
clean_rate:0.9637096774193549
noisy true:574
noisy false:546
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1120
epoch [162/200] batch [5/15] time 0.185 (0.186) data 0.108 (0.108) loss_x loss_x 0.3030 (0.4775) acc_x 90.6250 (86.2500) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [10/15] time 0.163 (0.182) data 0.086 (0.104) loss_x loss_x 0.3845 (0.5121) acc_x 93.7500 (87.1875) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [15/15] time 0.169 (0.189) data 0.092 (0.102) loss_x loss_x 0.5361 (0.4992) acc_x 90.6250 (87.9167) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/35] time 0.190 (0.188) data 0.111 (0.104) loss_u loss_u 0.9683 (0.9358) acc_u 3.1250 (8.1250) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [10/35] time 0.215 (0.190) data 0.138 (0.107) loss_u loss_u 0.9854 (0.9255) acc_u 3.1250 (8.7500) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/35] time 0.166 (0.190) data 0.088 (0.108) loss_u loss_u 0.9336 (0.9271) acc_u 6.2500 (8.5417) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/35] time 0.195 (0.189) data 0.116 (0.107) loss_u loss_u 0.9688 (0.9314) acc_u 3.1250 (7.8125) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/35] time 0.185 (0.188) data 0.106 (0.106) loss_u loss_u 0.9116 (0.9305) acc_u 12.5000 (7.8750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [30/35] time 0.291 (0.189) data 0.099 (0.105) loss_u loss_u 0.9248 (0.9298) acc_u 9.3750 (8.0208) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [35/35] time 0.179 (0.188) data 0.100 (0.104) loss_u loss_u 0.9692 (0.9317) acc_u 3.1250 (7.6786) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 531
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:492
clean false:16
clean_rate:0.968503937007874
noisy true:593
noisy false:515
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [163/200] batch [5/15] time 0.179 (0.188) data 0.102 (0.111) loss_x loss_x 0.6099 (0.5114) acc_x 84.3750 (88.1250) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [10/15] time 0.184 (0.203) data 0.107 (0.109) loss_x loss_x 0.3826 (0.5041) acc_x 90.6250 (88.7500) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/15] time 0.183 (0.197) data 0.105 (0.108) loss_x loss_x 0.5781 (0.4898) acc_x 81.2500 (89.1667) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/34] time 0.181 (0.193) data 0.103 (0.107) loss_u loss_u 0.9854 (0.9490) acc_u 3.1250 (5.6250) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [10/34] time 0.187 (0.188) data 0.109 (0.103) loss_u loss_u 0.9463 (0.9438) acc_u 6.2500 (6.8750) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/34] time 0.183 (0.189) data 0.105 (0.105) loss_u loss_u 0.9678 (0.9458) acc_u 3.1250 (6.4583) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/34] time 0.184 (0.188) data 0.106 (0.105) loss_u loss_u 0.8843 (0.9426) acc_u 15.6250 (7.0312) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/34] time 0.187 (0.188) data 0.109 (0.106) loss_u loss_u 0.9087 (0.9379) acc_u 9.3750 (7.2500) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [30/34] time 0.170 (0.192) data 0.092 (0.106) loss_u loss_u 0.9692 (0.9429) acc_u 3.1250 (6.5625) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:490
clean false:17
clean_rate:0.9664694280078896
noisy true:593
noisy false:516
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [164/200] batch [5/15] time 0.166 (0.179) data 0.088 (0.102) loss_x loss_x 0.6001 (0.4683) acc_x 78.1250 (86.8750) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [10/15] time 0.159 (0.187) data 0.082 (0.092) loss_x loss_x 0.6875 (0.4701) acc_x 81.2500 (87.5000) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [15/15] time 0.161 (0.178) data 0.084 (0.089) loss_x loss_x 0.4578 (0.4685) acc_x 90.6250 (88.3333) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/34] time 0.162 (0.174) data 0.083 (0.087) loss_u loss_u 0.9263 (0.9452) acc_u 6.2500 (6.2500) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [10/34] time 0.159 (0.172) data 0.080 (0.087) loss_u loss_u 0.9639 (0.9481) acc_u 3.1250 (5.6250) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/34] time 0.159 (0.170) data 0.080 (0.086) loss_u loss_u 0.9673 (0.9417) acc_u 3.1250 (6.4583) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/34] time 0.221 (0.170) data 0.142 (0.087) loss_u loss_u 0.9287 (0.9439) acc_u 9.3750 (6.2500) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/34] time 0.161 (0.170) data 0.083 (0.087) loss_u loss_u 0.9468 (0.9442) acc_u 6.2500 (6.1250) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [30/34] time 0.221 (0.171) data 0.144 (0.089) loss_u loss_u 0.9336 (0.9418) acc_u 9.3750 (6.4583) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 544
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 506
clean true:492
clean false:14
clean_rate:0.9723320158102767
noisy true:580
noisy false:530
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1110
epoch [165/200] batch [5/15] time 0.171 (0.196) data 0.093 (0.118) loss_x loss_x 0.4690 (0.6065) acc_x 84.3750 (83.1250) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/15] time 0.165 (0.185) data 0.087 (0.107) loss_x loss_x 0.8291 (0.5884) acc_x 78.1250 (83.4375) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [15/15] time 0.167 (0.181) data 0.089 (0.103) loss_x loss_x 0.3306 (0.5950) acc_x 90.6250 (84.1667) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/34] time 0.199 (0.182) data 0.121 (0.104) loss_u loss_u 0.9268 (0.9276) acc_u 9.3750 (8.7500) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [10/34] time 0.164 (0.185) data 0.085 (0.103) loss_u loss_u 0.9878 (0.9412) acc_u 3.1250 (7.1875) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/34] time 0.182 (0.185) data 0.105 (0.103) loss_u loss_u 0.9409 (0.9448) acc_u 9.3750 (6.6667) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/34] time 0.187 (0.185) data 0.107 (0.104) loss_u loss_u 0.9517 (0.9385) acc_u 6.2500 (7.5000) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/34] time 0.172 (0.186) data 0.093 (0.104) loss_u loss_u 0.9995 (0.9387) acc_u 0.0000 (7.3750) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [30/34] time 0.170 (0.185) data 0.091 (0.104) loss_u loss_u 0.9688 (0.9425) acc_u 3.1250 (6.8750) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 531
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:488
clean false:13
clean_rate:0.9740518962075848
noisy true:597
noisy false:518
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [166/200] batch [5/15] time 0.185 (0.189) data 0.107 (0.111) loss_x loss_x 0.4563 (0.4596) acc_x 87.5000 (88.7500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/15] time 0.178 (0.189) data 0.101 (0.112) loss_x loss_x 0.3921 (0.4495) acc_x 93.7500 (89.0625) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [15/15] time 0.181 (0.186) data 0.103 (0.108) loss_x loss_x 0.5698 (0.5025) acc_x 87.5000 (86.8750) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/34] time 0.185 (0.185) data 0.107 (0.107) loss_u loss_u 0.9365 (0.9122) acc_u 6.2500 (9.3750) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [10/34] time 0.299 (0.192) data 0.108 (0.110) loss_u loss_u 0.9541 (0.9238) acc_u 6.2500 (8.4375) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/34] time 0.187 (0.193) data 0.109 (0.112) loss_u loss_u 0.9639 (0.9347) acc_u 3.1250 (7.0833) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/34] time 0.168 (0.191) data 0.089 (0.110) loss_u loss_u 0.9478 (0.9324) acc_u 6.2500 (7.3438) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/34] time 0.162 (0.188) data 0.084 (0.108) loss_u loss_u 0.8389 (0.9347) acc_u 15.6250 (7.0000) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [30/34] time 0.162 (0.187) data 0.084 (0.106) loss_u loss_u 0.9365 (0.9362) acc_u 6.2500 (6.8750) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 526
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:496
clean false:15
clean_rate:0.9706457925636007
noisy true:594
noisy false:511
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [167/200] batch [5/15] time 0.164 (0.173) data 0.086 (0.096) loss_x loss_x 0.5781 (0.5539) acc_x 84.3750 (85.6250) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/15] time 0.160 (0.173) data 0.082 (0.095) loss_x loss_x 0.5449 (0.6072) acc_x 84.3750 (85.0000) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [15/15] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.6436 (0.5564) acc_x 81.2500 (86.2500) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/34] time 0.164 (0.173) data 0.085 (0.095) loss_u loss_u 0.9277 (0.9556) acc_u 9.3750 (5.6250) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [10/34] time 0.164 (0.171) data 0.086 (0.093) loss_u loss_u 0.8706 (0.9397) acc_u 12.5000 (6.8750) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/34] time 0.161 (0.175) data 0.083 (0.091) loss_u loss_u 0.9102 (0.9363) acc_u 9.3750 (7.0833) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/34] time 0.161 (0.173) data 0.082 (0.090) loss_u loss_u 0.9990 (0.9423) acc_u 0.0000 (6.2500) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/34] time 0.175 (0.173) data 0.095 (0.091) loss_u loss_u 0.9570 (0.9381) acc_u 6.2500 (6.7500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/34] time 0.181 (0.173) data 0.102 (0.091) loss_u loss_u 0.9741 (0.9401) acc_u 3.1250 (6.4583) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 521
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 524
clean true:510
clean false:14
clean_rate:0.9732824427480916
noisy true:585
noisy false:507
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1092
epoch [168/200] batch [5/16] time 0.299 (0.210) data 0.112 (0.108) loss_x loss_x 0.3025 (0.4749) acc_x 96.8750 (88.7500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/16] time 0.184 (0.198) data 0.106 (0.108) loss_x loss_x 0.5884 (0.4669) acc_x 90.6250 (89.3750) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/16] time 0.185 (0.194) data 0.106 (0.108) loss_x loss_x 0.8145 (0.4905) acc_x 84.3750 (88.3333) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/34] time 0.192 (0.190) data 0.114 (0.107) loss_u loss_u 0.9937 (0.9583) acc_u 0.0000 (4.3750) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [10/34] time 0.182 (0.190) data 0.104 (0.107) loss_u loss_u 0.9600 (0.9594) acc_u 3.1250 (4.0625) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [15/34] time 0.184 (0.192) data 0.105 (0.110) loss_u loss_u 0.9600 (0.9620) acc_u 3.1250 (3.7500) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/34] time 0.176 (0.191) data 0.098 (0.109) loss_u loss_u 0.9282 (0.9559) acc_u 6.2500 (4.8438) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/34] time 0.182 (0.194) data 0.103 (0.109) loss_u loss_u 0.9741 (0.9577) acc_u 3.1250 (4.7500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [30/34] time 0.191 (0.194) data 0.112 (0.110) loss_u loss_u 0.9331 (0.9577) acc_u 6.2500 (4.5833) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.3057, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 494
clean true:474
clean false:20
clean_rate:0.9595141700404858
noisy true:575
noisy false:547
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1122
epoch [169/200] batch [5/15] time 0.161 (0.161) data 0.083 (0.083) loss_x loss_x 0.6133 (0.4576) acc_x 84.3750 (87.5000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/15] time 0.294 (0.183) data 0.109 (0.095) loss_x loss_x 0.5093 (0.4628) acc_x 81.2500 (86.2500) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [15/15] time 0.181 (0.185) data 0.103 (0.100) loss_x loss_x 0.6016 (0.4805) acc_x 87.5000 (87.0833) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/35] time 0.179 (0.186) data 0.101 (0.103) loss_u loss_u 0.8979 (0.9193) acc_u 12.5000 (8.7500) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [10/35] time 0.252 (0.191) data 0.174 (0.108) loss_u loss_u 0.9414 (0.9252) acc_u 6.2500 (8.4375) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/35] time 0.191 (0.188) data 0.113 (0.106) loss_u loss_u 0.9365 (0.9377) acc_u 6.2500 (6.6667) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [20/35] time 0.230 (0.188) data 0.152 (0.107) loss_u loss_u 0.9976 (0.9446) acc_u 0.0000 (6.0938) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/35] time 0.209 (0.187) data 0.131 (0.106) loss_u loss_u 0.8892 (0.9405) acc_u 12.5000 (6.5000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [30/35] time 0.186 (0.189) data 0.107 (0.108) loss_u loss_u 0.9678 (0.9393) acc_u 3.1250 (6.6667) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [35/35] time 0.186 (0.191) data 0.107 (0.108) loss_u loss_u 0.9062 (0.9322) acc_u 9.3750 (7.4107) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 497
clean true:482
clean false:15
clean_rate:0.9698189134808853
noisy true:585
noisy false:534
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1119
epoch [170/200] batch [5/15] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.1842 (0.4900) acc_x 96.8750 (90.6250) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/15] time 0.193 (0.186) data 0.116 (0.108) loss_x loss_x 0.5103 (0.4735) acc_x 87.5000 (88.7500) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [15/15] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.5269 (0.5201) acc_x 84.3750 (87.0833) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/34] time 0.186 (0.193) data 0.108 (0.106) loss_u loss_u 0.9673 (0.9528) acc_u 3.1250 (5.6250) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [10/34] time 0.185 (0.190) data 0.105 (0.104) loss_u loss_u 0.9741 (0.9520) acc_u 3.1250 (5.9375) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/34] time 0.178 (0.188) data 0.099 (0.103) loss_u loss_u 0.9150 (0.9419) acc_u 9.3750 (6.8750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/34] time 0.170 (0.186) data 0.092 (0.102) loss_u loss_u 0.9629 (0.9383) acc_u 3.1250 (7.3438) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/34] time 0.183 (0.186) data 0.106 (0.103) loss_u loss_u 0.9873 (0.9367) acc_u 3.1250 (7.5000) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [30/34] time 0.272 (0.188) data 0.106 (0.103) loss_u loss_u 0.9277 (0.9385) acc_u 9.3750 (7.2917) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.3224, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 521
clean true:508
clean false:13
clean_rate:0.9750479846449136
noisy true:591
noisy false:504
after delete: len(clean_dataset) 521
after delete: len(noisy_dataset) 1095
epoch [171/200] batch [5/16] time 0.217 (0.191) data 0.140 (0.114) loss_x loss_x 0.7373 (0.3977) acc_x 81.2500 (88.7500) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/16] time 0.185 (0.200) data 0.106 (0.123) loss_x loss_x 0.7500 (0.4980) acc_x 71.8750 (85.6250) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [15/16] time 0.182 (0.195) data 0.105 (0.118) loss_x loss_x 0.5415 (0.5067) acc_x 84.3750 (85.6250) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/34] time 0.195 (0.197) data 0.117 (0.115) loss_u loss_u 0.9766 (0.9608) acc_u 3.1250 (5.0000) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [10/34] time 0.189 (0.198) data 0.111 (0.117) loss_u loss_u 0.9473 (0.9593) acc_u 6.2500 (4.6875) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/34] time 0.188 (0.198) data 0.109 (0.118) loss_u loss_u 0.9810 (0.9604) acc_u 3.1250 (4.5833) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [20/34] time 0.170 (0.196) data 0.092 (0.116) loss_u loss_u 0.8652 (0.9587) acc_u 15.6250 (4.6875) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/34] time 0.195 (0.196) data 0.117 (0.116) loss_u loss_u 0.9478 (0.9524) acc_u 6.2500 (5.2500) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [30/34] time 0.182 (0.193) data 0.103 (0.114) loss_u loss_u 0.9458 (0.9513) acc_u 6.2500 (5.3125) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 530
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 505
clean true:491
clean false:14
clean_rate:0.9722772277227723
noisy true:595
noisy false:516
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1111
epoch [172/200] batch [5/15] time 0.163 (0.163) data 0.085 (0.085) loss_x loss_x 0.2102 (0.4238) acc_x 96.8750 (89.3750) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [10/15] time 0.162 (0.162) data 0.085 (0.085) loss_x loss_x 0.4165 (0.4385) acc_x 90.6250 (88.4375) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [15/15] time 0.188 (0.166) data 0.111 (0.089) loss_x loss_x 0.5234 (0.4753) acc_x 93.7500 (88.1250) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/34] time 0.185 (0.169) data 0.107 (0.091) loss_u loss_u 0.9595 (0.9430) acc_u 3.1250 (5.6250) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/34] time 0.175 (0.176) data 0.098 (0.095) loss_u loss_u 0.9634 (0.9398) acc_u 3.1250 (5.9375) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/34] time 0.176 (0.176) data 0.099 (0.095) loss_u loss_u 0.9131 (0.9361) acc_u 9.3750 (6.6667) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [20/34] time 0.161 (0.175) data 0.083 (0.094) loss_u loss_u 0.9297 (0.9342) acc_u 6.2500 (6.8750) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/34] time 0.165 (0.174) data 0.087 (0.094) loss_u loss_u 0.9805 (0.9358) acc_u 3.1250 (6.7500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [30/34] time 0.196 (0.174) data 0.118 (0.094) loss_u loss_u 0.9507 (0.9403) acc_u 6.2500 (6.4583) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 510
clean true:494
clean false:16
clean_rate:0.9686274509803922
noisy true:612
noisy false:494
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1106
epoch [173/200] batch [5/15] time 0.177 (0.180) data 0.097 (0.102) loss_x loss_x 0.3379 (0.5342) acc_x 90.6250 (85.6250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/15] time 0.168 (0.174) data 0.091 (0.096) loss_x loss_x 0.6885 (0.4956) acc_x 78.1250 (86.5625) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [15/15] time 0.180 (0.176) data 0.103 (0.098) loss_x loss_x 0.4788 (0.4908) acc_x 81.2500 (86.6667) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/34] time 0.183 (0.178) data 0.104 (0.100) loss_u loss_u 0.9092 (0.9313) acc_u 9.3750 (8.1250) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [10/34] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.9497 (0.9295) acc_u 6.2500 (7.8125) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/34] time 0.182 (0.178) data 0.103 (0.101) loss_u loss_u 0.9966 (0.9422) acc_u 0.0000 (6.4583) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/34] time 0.160 (0.180) data 0.081 (0.099) loss_u loss_u 0.9951 (0.9464) acc_u 0.0000 (5.9375) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/34] time 0.160 (0.179) data 0.081 (0.098) loss_u loss_u 0.8838 (0.9468) acc_u 12.5000 (6.0000) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/34] time 0.162 (0.179) data 0.083 (0.098) loss_u loss_u 0.9365 (0.9464) acc_u 6.2500 (5.9375) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 530
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:496
clean false:15
clean_rate:0.9706457925636007
noisy true:590
noisy false:515
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [174/200] batch [5/15] time 0.184 (0.173) data 0.106 (0.096) loss_x loss_x 0.4045 (0.5140) acc_x 90.6250 (87.5000) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/15] time 0.193 (0.188) data 0.114 (0.096) loss_x loss_x 0.2252 (0.4451) acc_x 96.8750 (88.4375) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [15/15] time 0.188 (0.202) data 0.110 (0.114) loss_x loss_x 0.4314 (0.4590) acc_x 87.5000 (89.1667) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/34] time 0.188 (0.195) data 0.110 (0.110) loss_u loss_u 0.9448 (0.9458) acc_u 6.2500 (6.2500) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [10/34] time 0.175 (0.190) data 0.097 (0.106) loss_u loss_u 0.9219 (0.9409) acc_u 9.3750 (7.1875) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/34] time 0.164 (0.187) data 0.086 (0.104) loss_u loss_u 0.9531 (0.9433) acc_u 3.1250 (6.4583) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/34] time 0.187 (0.186) data 0.109 (0.104) loss_u loss_u 0.8662 (0.9415) acc_u 15.6250 (6.7188) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/34] time 0.184 (0.186) data 0.106 (0.104) loss_u loss_u 0.9893 (0.9460) acc_u 3.1250 (6.2500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [30/34] time 0.184 (0.190) data 0.105 (0.104) loss_u loss_u 0.9668 (0.9465) acc_u 3.1250 (6.3542) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:489
clean false:10
clean_rate:0.9799599198396793
noisy true:594
noisy false:523
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [175/200] batch [5/15] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.4683 (0.4038) acc_x 84.3750 (88.1250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [10/15] time 0.184 (0.199) data 0.105 (0.107) loss_x loss_x 0.6802 (0.4534) acc_x 81.2500 (87.8125) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [15/15] time 0.184 (0.195) data 0.106 (0.107) loss_x loss_x 0.5820 (0.4897) acc_x 87.5000 (88.1250) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/34] time 0.173 (0.189) data 0.094 (0.104) loss_u loss_u 0.8335 (0.9205) acc_u 18.7500 (8.7500) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [10/34] time 0.180 (0.186) data 0.103 (0.103) loss_u loss_u 0.9688 (0.9352) acc_u 3.1250 (7.1875) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/34] time 0.158 (0.184) data 0.080 (0.101) loss_u loss_u 0.9683 (0.9447) acc_u 6.2500 (6.2500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/34] time 0.159 (0.181) data 0.082 (0.098) loss_u loss_u 0.8657 (0.9380) acc_u 15.6250 (7.0312) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/34] time 0.313 (0.183) data 0.123 (0.098) loss_u loss_u 0.7876 (0.9292) acc_u 25.0000 (8.0000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [30/34] time 0.185 (0.184) data 0.107 (0.099) loss_u loss_u 0.9146 (0.9320) acc_u 9.3750 (7.6042) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:485
clean false:16
clean_rate:0.9680638722554891
noisy true:582
noisy false:533
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [176/200] batch [5/15] time 0.224 (0.199) data 0.146 (0.122) loss_x loss_x 0.4038 (0.4717) acc_x 84.3750 (88.7500) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [10/15] time 0.185 (0.193) data 0.106 (0.115) loss_x loss_x 0.5947 (0.4322) acc_x 90.6250 (90.0000) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [15/15] time 0.162 (0.196) data 0.084 (0.111) loss_x loss_x 0.6030 (0.4400) acc_x 81.2500 (90.0000) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/34] time 0.202 (0.195) data 0.124 (0.112) loss_u loss_u 0.9854 (0.9451) acc_u 3.1250 (7.5000) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [10/34] time 0.173 (0.194) data 0.094 (0.112) loss_u loss_u 0.8154 (0.9247) acc_u 18.7500 (9.0625) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/34] time 0.187 (0.195) data 0.109 (0.114) loss_u loss_u 0.9028 (0.9308) acc_u 12.5000 (8.3333) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/34] time 0.188 (0.194) data 0.110 (0.112) loss_u loss_u 0.9067 (0.9347) acc_u 9.3750 (7.8125) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/34] time 0.205 (0.192) data 0.127 (0.111) loss_u loss_u 0.9165 (0.9377) acc_u 9.3750 (7.2500) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [30/34] time 0.181 (0.190) data 0.103 (0.109) loss_u loss_u 0.9678 (0.9319) acc_u 3.1250 (7.8125) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 564
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 502
clean true:487
clean false:15
clean_rate:0.9701195219123506
noisy true:565
noisy false:549
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1114
epoch [177/200] batch [5/15] time 0.169 (0.173) data 0.091 (0.095) loss_x loss_x 0.5688 (0.5292) acc_x 84.3750 (89.3750) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/15] time 0.190 (0.179) data 0.111 (0.101) loss_x loss_x 0.2527 (0.5128) acc_x 93.7500 (88.1250) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [15/15] time 0.226 (0.189) data 0.102 (0.102) loss_x loss_x 0.4216 (0.4993) acc_x 87.5000 (88.1250) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/34] time 0.185 (0.186) data 0.106 (0.101) loss_u loss_u 0.9438 (0.9478) acc_u 6.2500 (6.2500) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [10/34] time 0.161 (0.183) data 0.083 (0.099) loss_u loss_u 0.9248 (0.9381) acc_u 12.5000 (7.5000) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/34] time 0.183 (0.181) data 0.105 (0.099) loss_u loss_u 0.9727 (0.9419) acc_u 3.1250 (6.8750) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/34] time 0.186 (0.182) data 0.108 (0.100) loss_u loss_u 0.9126 (0.9411) acc_u 9.3750 (7.0312) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/34] time 0.181 (0.181) data 0.103 (0.100) loss_u loss_u 0.9937 (0.9453) acc_u 0.0000 (6.3750) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [30/34] time 0.161 (0.181) data 0.083 (0.100) loss_u loss_u 0.9683 (0.9412) acc_u 3.1250 (6.7708) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:497
clean false:17
clean_rate:0.9669260700389105
noisy true:592
noisy false:510
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [178/200] batch [5/16] time 0.187 (0.184) data 0.109 (0.106) loss_x loss_x 0.2671 (0.4274) acc_x 87.5000 (88.7500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/16] time 0.159 (0.175) data 0.082 (0.097) loss_x loss_x 0.4805 (0.4311) acc_x 90.6250 (89.0625) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/16] time 0.184 (0.172) data 0.106 (0.095) loss_x loss_x 0.5474 (0.4447) acc_x 87.5000 (89.5833) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/34] time 0.184 (0.181) data 0.107 (0.098) loss_u loss_u 0.9185 (0.9565) acc_u 9.3750 (4.3750) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [10/34] time 0.177 (0.181) data 0.099 (0.099) loss_u loss_u 0.9536 (0.9544) acc_u 6.2500 (5.3125) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/34] time 0.181 (0.181) data 0.103 (0.100) loss_u loss_u 0.9155 (0.9401) acc_u 9.3750 (6.8750) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/34] time 0.175 (0.180) data 0.098 (0.099) loss_u loss_u 0.9663 (0.9426) acc_u 3.1250 (6.4062) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/34] time 0.187 (0.180) data 0.110 (0.100) loss_u loss_u 0.8555 (0.9415) acc_u 15.6250 (6.5000) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [30/34] time 0.182 (0.180) data 0.104 (0.100) loss_u loss_u 0.9966 (0.9430) acc_u 0.0000 (6.3542) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 530
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:489
clean false:18
clean_rate:0.9644970414201184
noisy true:597
noisy false:512
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [179/200] batch [5/15] time 0.167 (0.178) data 0.090 (0.100) loss_x loss_x 0.7515 (0.5184) acc_x 84.3750 (86.2500) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/15] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 0.5215 (0.5138) acc_x 81.2500 (86.2500) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [15/15] time 0.183 (0.176) data 0.105 (0.098) loss_x loss_x 0.2969 (0.4792) acc_x 93.7500 (87.7083) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/34] time 0.169 (0.174) data 0.091 (0.096) loss_u loss_u 0.9663 (0.9347) acc_u 3.1250 (7.5000) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [10/34] time 0.164 (0.174) data 0.087 (0.096) loss_u loss_u 0.9985 (0.9317) acc_u 0.0000 (8.1250) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/34] time 0.218 (0.178) data 0.087 (0.095) loss_u loss_u 0.9321 (0.9346) acc_u 6.2500 (7.5000) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [20/34] time 0.175 (0.177) data 0.097 (0.095) loss_u loss_u 0.9727 (0.9392) acc_u 3.1250 (7.0312) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/34] time 0.180 (0.177) data 0.102 (0.094) loss_u loss_u 0.8940 (0.9384) acc_u 12.5000 (7.1250) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [30/34] time 0.183 (0.177) data 0.105 (0.095) loss_u loss_u 0.9287 (0.9331) acc_u 6.2500 (7.5000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:497
clean false:14
clean_rate:0.9726027397260274
noisy true:607
noisy false:498
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [180/200] batch [5/15] time 0.183 (0.188) data 0.106 (0.110) loss_x loss_x 0.3367 (0.4303) acc_x 93.7500 (88.7500) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/15] time 0.163 (0.176) data 0.085 (0.099) loss_x loss_x 0.1260 (0.3805) acc_x 100.0000 (91.5625) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [15/15] time 0.163 (0.172) data 0.085 (0.094) loss_x loss_x 0.4646 (0.4086) acc_x 81.2500 (90.4167) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/34] time 0.163 (0.169) data 0.084 (0.092) loss_u loss_u 0.9297 (0.9404) acc_u 9.3750 (6.2500) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/34] time 0.162 (0.168) data 0.084 (0.090) loss_u loss_u 0.9375 (0.9492) acc_u 6.2500 (5.0000) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/34] time 0.165 (0.167) data 0.087 (0.088) loss_u loss_u 0.9141 (0.9532) acc_u 12.5000 (5.0000) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/34] time 0.203 (0.167) data 0.090 (0.088) loss_u loss_u 0.8770 (0.9489) acc_u 15.6250 (5.4688) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/34] time 0.251 (0.174) data 0.173 (0.093) loss_u loss_u 0.9487 (0.9530) acc_u 6.2500 (5.1250) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [30/34] time 0.168 (0.173) data 0.089 (0.093) loss_u loss_u 0.9014 (0.9531) acc_u 9.3750 (5.3125) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.3168, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 512
clean true:500
clean false:12
clean_rate:0.9765625
noisy true:598
noisy false:506
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1104
epoch [181/200] batch [5/16] time 0.195 (0.178) data 0.117 (0.100) loss_x loss_x 0.7119 (0.5556) acc_x 81.2500 (85.6250) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [10/16] time 0.193 (0.176) data 0.115 (0.099) loss_x loss_x 0.1432 (0.5430) acc_x 96.8750 (86.2500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/16] time 0.170 (0.182) data 0.091 (0.098) loss_x loss_x 0.2133 (0.5064) acc_x 90.6250 (86.2500) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/34] time 0.189 (0.182) data 0.112 (0.099) loss_u loss_u 0.9995 (0.9339) acc_u 0.0000 (8.1250) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [10/34] time 0.240 (0.184) data 0.162 (0.102) loss_u loss_u 0.9409 (0.9484) acc_u 9.3750 (6.5625) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/34] time 0.199 (0.185) data 0.121 (0.104) loss_u loss_u 0.9893 (0.9416) acc_u 0.0000 (7.0833) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/34] time 0.179 (0.188) data 0.102 (0.107) loss_u loss_u 0.9985 (0.9459) acc_u 0.0000 (6.4062) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/34] time 0.173 (0.187) data 0.095 (0.106) loss_u loss_u 1.0000 (0.9475) acc_u 0.0000 (6.2500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [30/34] time 0.162 (0.188) data 0.084 (0.105) loss_u loss_u 0.9087 (0.9453) acc_u 9.3750 (6.3542) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 523
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 517
clean true:498
clean false:19
clean_rate:0.9632495164410058
noisy true:595
noisy false:504
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1099
epoch [182/200] batch [5/16] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.4998 (0.5667) acc_x 87.5000 (85.0000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/16] time 0.159 (0.175) data 0.082 (0.097) loss_x loss_x 0.9600 (0.5324) acc_x 68.7500 (85.0000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/16] time 0.162 (0.175) data 0.085 (0.097) loss_x loss_x 0.1508 (0.4674) acc_x 96.8750 (87.5000) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/34] time 0.186 (0.181) data 0.108 (0.097) loss_u loss_u 0.9199 (0.9618) acc_u 9.3750 (4.3750) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [10/34] time 0.184 (0.181) data 0.105 (0.099) loss_u loss_u 0.9502 (0.9586) acc_u 6.2500 (4.6875) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/34] time 0.189 (0.182) data 0.111 (0.101) loss_u loss_u 0.9194 (0.9440) acc_u 9.3750 (6.2500) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [20/34] time 0.166 (0.180) data 0.087 (0.099) loss_u loss_u 0.9873 (0.9444) acc_u 0.0000 (6.2500) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/34] time 0.166 (0.179) data 0.088 (0.098) loss_u loss_u 0.9268 (0.9459) acc_u 9.3750 (6.1250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [30/34] time 0.173 (0.178) data 0.095 (0.098) loss_u loss_u 0.9976 (0.9480) acc_u 0.0000 (5.9375) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 540
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 506
clean true:492
clean false:14
clean_rate:0.9723320158102767
noisy true:584
noisy false:526
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1110
epoch [183/200] batch [5/15] time 0.174 (0.174) data 0.097 (0.096) loss_x loss_x 0.3391 (0.4226) acc_x 90.6250 (91.8750) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/15] time 0.183 (0.179) data 0.106 (0.101) loss_x loss_x 0.4500 (0.4208) acc_x 87.5000 (90.9375) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [15/15] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.7700 (0.4750) acc_x 84.3750 (88.9583) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/34] time 0.182 (0.181) data 0.105 (0.103) loss_u loss_u 0.9375 (0.9470) acc_u 6.2500 (5.6250) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [10/34] time 0.161 (0.184) data 0.084 (0.101) loss_u loss_u 0.9990 (0.9552) acc_u 0.0000 (4.6875) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/34] time 0.174 (0.180) data 0.097 (0.099) loss_u loss_u 0.9302 (0.9551) acc_u 6.2500 (4.7917) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [20/34] time 0.160 (0.180) data 0.082 (0.099) loss_u loss_u 0.9707 (0.9551) acc_u 3.1250 (5.1562) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/34] time 0.160 (0.177) data 0.082 (0.097) loss_u loss_u 0.9316 (0.9484) acc_u 9.3750 (5.8750) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [30/34] time 0.159 (0.176) data 0.082 (0.095) loss_u loss_u 0.9390 (0.9458) acc_u 9.3750 (6.3542) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 520
clean true:504
clean false:16
clean_rate:0.9692307692307692
noisy true:576
noisy false:520
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1096
epoch [184/200] batch [5/16] time 0.166 (0.177) data 0.088 (0.100) loss_x loss_x 0.6675 (0.5087) acc_x 81.2500 (88.7500) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [10/16] time 0.174 (0.177) data 0.097 (0.099) loss_x loss_x 0.5869 (0.5260) acc_x 87.5000 (86.8750) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/16] time 0.169 (0.176) data 0.092 (0.098) loss_x loss_x 0.2009 (0.4862) acc_x 100.0000 (87.9167) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/34] time 0.162 (0.178) data 0.085 (0.100) loss_u loss_u 0.9092 (0.9315) acc_u 12.5000 (8.7500) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [10/34] time 0.204 (0.183) data 0.125 (0.105) loss_u loss_u 0.9966 (0.9337) acc_u 0.0000 (7.8125) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/34] time 0.184 (0.189) data 0.106 (0.108) loss_u loss_u 0.9644 (0.9362) acc_u 3.1250 (7.7083) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [20/34] time 0.204 (0.190) data 0.126 (0.109) loss_u loss_u 0.9385 (0.9438) acc_u 6.2500 (6.8750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/34] time 0.184 (0.190) data 0.106 (0.109) loss_u loss_u 0.9546 (0.9463) acc_u 6.2500 (6.5000) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [30/34] time 0.185 (0.189) data 0.105 (0.109) loss_u loss_u 0.9365 (0.9462) acc_u 6.2500 (6.3542) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.3094, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 500
clean true:488
clean false:12
clean_rate:0.976
noisy true:592
noisy false:524
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1116
epoch [185/200] batch [5/15] time 0.159 (0.160) data 0.081 (0.082) loss_x loss_x 0.4534 (0.5765) acc_x 81.2500 (87.5000) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/15] time 0.160 (0.160) data 0.082 (0.082) loss_x loss_x 0.5537 (0.5615) acc_x 87.5000 (86.8750) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [15/15] time 0.159 (0.160) data 0.082 (0.082) loss_x loss_x 0.2040 (0.5143) acc_x 96.8750 (88.3333) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/34] time 0.159 (0.160) data 0.081 (0.082) loss_u loss_u 0.9795 (0.9475) acc_u 3.1250 (6.8750) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/34] time 0.159 (0.160) data 0.080 (0.082) loss_u loss_u 0.9521 (0.9546) acc_u 6.2500 (5.9375) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/34] time 0.222 (0.162) data 0.082 (0.082) loss_u loss_u 0.8823 (0.9516) acc_u 12.5000 (6.0417) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [20/34] time 0.159 (0.164) data 0.081 (0.082) loss_u loss_u 0.9146 (0.9463) acc_u 9.3750 (6.2500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/34] time 0.160 (0.164) data 0.082 (0.082) loss_u loss_u 0.9385 (0.9425) acc_u 6.2500 (6.5000) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [30/34] time 0.160 (0.163) data 0.082 (0.082) loss_u loss_u 0.9443 (0.9415) acc_u 6.2500 (6.5625) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 505
clean true:491
clean false:14
clean_rate:0.9722772277227723
noisy true:592
noisy false:519
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1111
epoch [186/200] batch [5/15] time 0.173 (0.210) data 0.094 (0.111) loss_x loss_x 0.4080 (0.4152) acc_x 87.5000 (88.7500) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/15] time 0.169 (0.194) data 0.091 (0.106) loss_x loss_x 0.8208 (0.4489) acc_x 87.5000 (89.0625) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [15/15] time 0.184 (0.187) data 0.106 (0.102) loss_x loss_x 0.2725 (0.4529) acc_x 93.7500 (88.7500) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/34] time 0.162 (0.182) data 0.083 (0.099) loss_u loss_u 0.9556 (0.9550) acc_u 6.2500 (5.0000) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [10/34] time 0.186 (0.182) data 0.108 (0.100) loss_u loss_u 0.9150 (0.9544) acc_u 9.3750 (4.6875) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/34] time 0.161 (0.181) data 0.083 (0.099) loss_u loss_u 0.9438 (0.9556) acc_u 6.2500 (4.5833) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [20/34] time 0.194 (0.180) data 0.116 (0.099) loss_u loss_u 0.9375 (0.9501) acc_u 6.2500 (5.3125) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/34] time 0.162 (0.181) data 0.083 (0.097) loss_u loss_u 0.9756 (0.9456) acc_u 3.1250 (6.0000) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [30/34] time 0.209 (0.182) data 0.132 (0.099) loss_u loss_u 0.9663 (0.9428) acc_u 3.1250 (6.5625) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.3187, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 515
clean true:500
clean false:15
clean_rate:0.970873786407767
noisy true:610
noisy false:491
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1101
epoch [187/200] batch [5/16] time 0.185 (0.206) data 0.107 (0.107) loss_x loss_x 0.3108 (0.5531) acc_x 93.7500 (84.3750) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/16] time 0.182 (0.195) data 0.104 (0.106) loss_x loss_x 0.4463 (0.5111) acc_x 90.6250 (87.1875) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/16] time 0.184 (0.191) data 0.107 (0.106) loss_x loss_x 0.5815 (0.4894) acc_x 75.0000 (86.4583) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/34] time 0.183 (0.190) data 0.106 (0.107) loss_u loss_u 0.9536 (0.9654) acc_u 3.1250 (3.1250) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [10/34] time 0.182 (0.188) data 0.104 (0.106) loss_u loss_u 0.9355 (0.9520) acc_u 6.2500 (5.3125) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/34] time 0.181 (0.188) data 0.103 (0.106) loss_u loss_u 0.9434 (0.9545) acc_u 6.2500 (5.0000) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/34] time 0.184 (0.187) data 0.104 (0.106) loss_u loss_u 0.9185 (0.9553) acc_u 9.3750 (5.0000) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/34] time 0.181 (0.190) data 0.104 (0.106) loss_u loss_u 0.9360 (0.9534) acc_u 6.2500 (5.1250) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [30/34] time 0.184 (0.190) data 0.106 (0.106) loss_u loss_u 0.9312 (0.9539) acc_u 9.3750 (5.2083) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 544
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 506
clean true:491
clean false:15
clean_rate:0.9703557312252964
noisy true:581
noisy false:529
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1110
epoch [188/200] batch [5/15] time 0.194 (0.183) data 0.117 (0.106) loss_x loss_x 0.3196 (0.4905) acc_x 93.7500 (86.2500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/15] time 0.299 (0.201) data 0.113 (0.113) loss_x loss_x 0.8320 (0.4718) acc_x 87.5000 (87.5000) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/15] time 0.190 (0.195) data 0.113 (0.110) loss_x loss_x 0.4387 (0.5247) acc_x 87.5000 (86.0417) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/34] time 0.184 (0.193) data 0.107 (0.110) loss_u loss_u 0.9458 (0.9546) acc_u 6.2500 (6.8750) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [10/34] time 0.162 (0.191) data 0.083 (0.109) loss_u loss_u 0.9673 (0.9529) acc_u 6.2500 (6.5625) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/34] time 0.180 (0.189) data 0.102 (0.107) loss_u loss_u 0.9116 (0.9506) acc_u 9.3750 (6.4583) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/34] time 0.194 (0.188) data 0.116 (0.107) loss_u loss_u 0.9043 (0.9385) acc_u 9.3750 (7.3438) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/34] time 0.169 (0.187) data 0.090 (0.106) loss_u loss_u 0.9995 (0.9417) acc_u 0.0000 (6.7500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [30/34] time 0.175 (0.189) data 0.097 (0.105) loss_u loss_u 0.9751 (0.9444) acc_u 3.1250 (6.5625) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 543
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:485
clean false:14
clean_rate:0.9719438877755511
noisy true:588
noisy false:529
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [189/200] batch [5/15] time 0.183 (0.186) data 0.106 (0.108) loss_x loss_x 0.5596 (0.5065) acc_x 81.2500 (85.6250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/15] time 0.177 (0.190) data 0.099 (0.113) loss_x loss_x 1.1328 (0.5534) acc_x 84.3750 (86.8750) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [15/15] time 0.185 (0.188) data 0.107 (0.110) loss_x loss_x 0.5293 (0.5319) acc_x 84.3750 (87.2917) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/34] time 0.300 (0.194) data 0.109 (0.110) loss_u loss_u 0.8647 (0.9223) acc_u 15.6250 (8.7500) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [10/34] time 0.186 (0.192) data 0.108 (0.109) loss_u loss_u 0.9419 (0.9285) acc_u 9.3750 (8.1250) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/34] time 0.186 (0.192) data 0.108 (0.109) loss_u loss_u 0.9966 (0.9359) acc_u 0.0000 (6.8750) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/34] time 0.171 (0.188) data 0.092 (0.106) loss_u loss_u 0.9116 (0.9333) acc_u 9.3750 (7.1875) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/34] time 0.160 (0.186) data 0.082 (0.105) loss_u loss_u 0.8887 (0.9344) acc_u 12.5000 (7.0000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [30/34] time 0.179 (0.185) data 0.099 (0.104) loss_u loss_u 0.9492 (0.9395) acc_u 6.2500 (6.4583) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:495
clean false:13
clean_rate:0.9744094488188977
noisy true:587
noisy false:521
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [190/200] batch [5/15] time 0.163 (0.163) data 0.085 (0.085) loss_x loss_x 0.3816 (0.4843) acc_x 90.6250 (91.8750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/15] time 0.170 (0.167) data 0.091 (0.089) loss_x loss_x 0.3474 (0.4470) acc_x 90.6250 (91.2500) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [15/15] time 0.183 (0.170) data 0.105 (0.092) loss_x loss_x 0.3188 (0.4127) acc_x 87.5000 (91.0417) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/34] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.9673 (0.9279) acc_u 3.1250 (8.1250) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [10/34] time 0.276 (0.183) data 0.106 (0.101) loss_u loss_u 0.9678 (0.9460) acc_u 3.1250 (5.9375) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/34] time 0.188 (0.183) data 0.109 (0.102) loss_u loss_u 0.9453 (0.9499) acc_u 6.2500 (5.4167) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/34] time 0.185 (0.184) data 0.107 (0.103) loss_u loss_u 0.8843 (0.9401) acc_u 15.6250 (6.7188) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/34] time 0.182 (0.185) data 0.105 (0.104) loss_u loss_u 0.9834 (0.9398) acc_u 3.1250 (6.8750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [30/34] time 0.184 (0.185) data 0.107 (0.104) loss_u loss_u 0.9727 (0.9388) acc_u 3.1250 (6.9792) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 543
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:493
clean false:15
clean_rate:0.9704724409448819
noisy true:580
noisy false:528
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [191/200] batch [5/15] time 0.187 (0.187) data 0.110 (0.109) loss_x loss_x 0.5918 (0.4806) acc_x 90.6250 (87.5000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/15] time 0.184 (0.192) data 0.106 (0.115) loss_x loss_x 0.5679 (0.4882) acc_x 90.6250 (88.4375) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [15/15] time 0.184 (0.195) data 0.106 (0.118) loss_x loss_x 0.4878 (0.4857) acc_x 90.6250 (88.9583) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/34] time 0.197 (0.194) data 0.120 (0.117) loss_u loss_u 0.9531 (0.9398) acc_u 6.2500 (6.2500) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [10/34] time 0.194 (0.194) data 0.114 (0.116) loss_u loss_u 0.9365 (0.9377) acc_u 6.2500 (6.5625) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/34] time 0.249 (0.197) data 0.170 (0.117) loss_u loss_u 0.9116 (0.9342) acc_u 9.3750 (7.0833) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/34] time 0.186 (0.195) data 0.108 (0.116) loss_u loss_u 0.9531 (0.9402) acc_u 3.1250 (6.2500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/34] time 0.183 (0.194) data 0.105 (0.115) loss_u loss_u 0.8926 (0.9419) acc_u 12.5000 (6.0000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [30/34] time 0.182 (0.193) data 0.104 (0.114) loss_u loss_u 0.9648 (0.9451) acc_u 3.1250 (5.7292) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:496
clean false:12
clean_rate:0.9763779527559056
noisy true:588
noisy false:520
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [192/200] batch [5/15] time 0.189 (0.186) data 0.111 (0.108) loss_x loss_x 0.3457 (0.4045) acc_x 90.6250 (87.5000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [10/15] time 0.192 (0.186) data 0.114 (0.109) loss_x loss_x 0.3677 (0.4188) acc_x 93.7500 (89.6875) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [15/15] time 0.185 (0.186) data 0.106 (0.109) loss_x loss_x 0.9009 (0.4481) acc_x 84.3750 (88.9583) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/34] time 0.184 (0.186) data 0.107 (0.108) loss_u loss_u 0.9160 (0.9370) acc_u 9.3750 (6.8750) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [10/34] time 0.276 (0.189) data 0.084 (0.106) loss_u loss_u 0.9473 (0.9468) acc_u 6.2500 (5.9375) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/34] time 0.181 (0.188) data 0.103 (0.105) loss_u loss_u 0.9365 (0.9439) acc_u 6.2500 (6.0417) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [20/34] time 0.185 (0.187) data 0.107 (0.105) loss_u loss_u 0.9697 (0.9393) acc_u 3.1250 (6.5625) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/34] time 0.186 (0.187) data 0.108 (0.105) loss_u loss_u 0.9741 (0.9432) acc_u 6.2500 (6.2500) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [30/34] time 0.184 (0.186) data 0.106 (0.104) loss_u loss_u 0.9443 (0.9452) acc_u 6.2500 (6.0417) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 564
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:484
clean false:17
clean_rate:0.9660678642714571
noisy true:568
noisy false:547
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [193/200] batch [5/15] time 0.159 (0.164) data 0.082 (0.087) loss_x loss_x 0.5854 (0.3803) acc_x 90.6250 (93.1250) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/15] time 0.159 (0.161) data 0.082 (0.084) loss_x loss_x 0.3059 (0.3765) acc_x 93.7500 (91.5625) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [15/15] time 0.158 (0.161) data 0.081 (0.084) loss_x loss_x 0.3108 (0.4031) acc_x 93.7500 (90.8333) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/34] time 0.159 (0.160) data 0.081 (0.083) loss_u loss_u 0.9170 (0.9493) acc_u 9.3750 (5.6250) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/34] time 0.184 (0.163) data 0.105 (0.086) loss_u loss_u 0.9512 (0.9406) acc_u 6.2500 (6.2500) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/34] time 0.184 (0.172) data 0.106 (0.089) loss_u loss_u 0.8789 (0.9309) acc_u 12.5000 (7.7083) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/34] time 0.172 (0.175) data 0.094 (0.093) loss_u loss_u 0.9980 (0.9351) acc_u 0.0000 (7.3438) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/34] time 0.177 (0.174) data 0.099 (0.093) loss_u loss_u 0.8848 (0.9290) acc_u 12.5000 (8.0000) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [30/34] time 0.180 (0.174) data 0.101 (0.093) loss_u loss_u 0.9165 (0.9326) acc_u 9.3750 (7.6042) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 503
clean true:490
clean false:13
clean_rate:0.974155069582505
noisy true:594
noisy false:519
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1113
epoch [194/200] batch [5/15] time 0.162 (0.177) data 0.085 (0.099) loss_x loss_x 0.2988 (0.5070) acc_x 90.6250 (86.8750) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/15] time 0.213 (0.182) data 0.135 (0.104) loss_x loss_x 0.7310 (0.6201) acc_x 75.0000 (84.3750) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [15/15] time 0.178 (0.180) data 0.100 (0.102) loss_x loss_x 0.8008 (0.5709) acc_x 78.1250 (85.4167) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/34] time 0.167 (0.178) data 0.088 (0.100) loss_u loss_u 0.8965 (0.9267) acc_u 12.5000 (8.1250) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [10/34] time 0.160 (0.178) data 0.083 (0.100) loss_u loss_u 0.9585 (0.9400) acc_u 3.1250 (6.8750) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/34] time 0.163 (0.179) data 0.085 (0.101) loss_u loss_u 0.9097 (0.9383) acc_u 9.3750 (7.0833) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [20/34] time 0.188 (0.183) data 0.110 (0.101) loss_u loss_u 0.9434 (0.9381) acc_u 6.2500 (7.0312) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/34] time 0.184 (0.183) data 0.106 (0.102) loss_u loss_u 0.9375 (0.9334) acc_u 6.2500 (7.5000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [30/34] time 0.159 (0.182) data 0.081 (0.102) loss_u loss_u 0.8970 (0.9369) acc_u 12.5000 (7.0833) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 538
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:483
clean false:16
clean_rate:0.9679358717434869
noisy true:595
noisy false:522
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [195/200] batch [5/15] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.3303 (0.3614) acc_x 93.7500 (89.3750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/15] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.5190 (0.4377) acc_x 87.5000 (87.1875) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [15/15] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.9546 (0.4596) acc_x 75.0000 (86.2500) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/34] time 0.183 (0.185) data 0.105 (0.107) loss_u loss_u 0.9653 (0.8933) acc_u 3.1250 (11.2500) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [10/34] time 0.184 (0.185) data 0.107 (0.107) loss_u loss_u 0.9385 (0.9129) acc_u 6.2500 (9.0625) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/34] time 0.164 (0.182) data 0.086 (0.104) loss_u loss_u 0.9688 (0.9202) acc_u 3.1250 (8.5417) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/34] time 0.163 (0.185) data 0.084 (0.101) loss_u loss_u 0.9268 (0.9251) acc_u 9.3750 (8.2812) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/34] time 0.183 (0.184) data 0.105 (0.101) loss_u loss_u 0.9971 (0.9318) acc_u 0.0000 (7.5000) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [30/34] time 0.191 (0.184) data 0.112 (0.101) loss_u loss_u 0.9443 (0.9342) acc_u 6.2500 (7.2917) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:499
clean false:15
clean_rate:0.9708171206225681
noisy true:585
noisy false:517
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [196/200] batch [5/16] time 0.184 (0.175) data 0.106 (0.097) loss_x loss_x 0.2822 (0.3886) acc_x 90.6250 (90.0000) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/16] time 0.215 (0.194) data 0.082 (0.100) loss_x loss_x 0.2042 (0.3874) acc_x 96.8750 (90.6250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/16] time 0.157 (0.185) data 0.080 (0.096) loss_x loss_x 0.4475 (0.4181) acc_x 87.5000 (89.5833) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/34] time 0.183 (0.180) data 0.105 (0.095) loss_u loss_u 0.8843 (0.9475) acc_u 12.5000 (6.2500) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [10/34] time 0.179 (0.179) data 0.102 (0.095) loss_u loss_u 0.9990 (0.9529) acc_u 0.0000 (5.3125) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/34] time 0.184 (0.178) data 0.105 (0.095) loss_u loss_u 0.8779 (0.9437) acc_u 12.5000 (6.2500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/34] time 0.183 (0.177) data 0.105 (0.095) loss_u loss_u 0.9663 (0.9433) acc_u 6.2500 (6.5625) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/34] time 0.185 (0.182) data 0.108 (0.095) loss_u loss_u 0.9385 (0.9351) acc_u 6.2500 (7.3750) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [30/34] time 0.183 (0.183) data 0.104 (0.097) loss_u loss_u 0.9448 (0.9375) acc_u 6.2500 (7.0833) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 538
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:494
clean false:17
clean_rate:0.9667318982387475
noisy true:584
noisy false:521
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [197/200] batch [5/15] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4854 (0.4760) acc_x 87.5000 (88.1250) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [10/15] time 0.157 (0.190) data 0.080 (0.100) loss_x loss_x 0.4082 (0.5491) acc_x 87.5000 (86.5625) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [15/15] time 0.222 (0.191) data 0.145 (0.104) loss_x loss_x 0.4651 (0.5505) acc_x 87.5000 (86.4583) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/34] time 0.202 (0.193) data 0.124 (0.109) loss_u loss_u 0.9658 (0.9430) acc_u 3.1250 (6.8750) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [10/34] time 0.178 (0.188) data 0.100 (0.106) loss_u loss_u 0.9292 (0.9489) acc_u 9.3750 (5.9375) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [15/34] time 0.190 (0.187) data 0.113 (0.105) loss_u loss_u 0.9307 (0.9370) acc_u 6.2500 (7.0833) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/34] time 0.204 (0.186) data 0.126 (0.104) loss_u loss_u 0.9082 (0.9358) acc_u 9.3750 (7.1875) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/34] time 0.183 (0.186) data 0.104 (0.105) loss_u loss_u 0.9434 (0.9346) acc_u 6.2500 (7.3750) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [30/34] time 0.314 (0.189) data 0.125 (0.106) loss_u loss_u 0.9351 (0.9368) acc_u 6.2500 (7.1875) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 509
clean true:495
clean false:14
clean_rate:0.9724950884086444
noisy true:592
noisy false:515
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1107
epoch [198/200] batch [5/15] time 0.162 (0.171) data 0.084 (0.094) loss_x loss_x 0.4629 (0.4562) acc_x 87.5000 (90.6250) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/15] time 0.196 (0.192) data 0.118 (0.103) loss_x loss_x 0.4514 (0.5010) acc_x 90.6250 (88.7500) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [15/15] time 0.163 (0.185) data 0.086 (0.100) loss_x loss_x 0.5908 (0.5032) acc_x 84.3750 (88.3333) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/34] time 0.209 (0.187) data 0.132 (0.104) loss_u loss_u 0.9805 (0.9563) acc_u 3.1250 (5.0000) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [10/34] time 0.185 (0.184) data 0.107 (0.102) loss_u loss_u 0.9580 (0.9571) acc_u 6.2500 (5.0000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/34] time 0.159 (0.181) data 0.080 (0.100) loss_u loss_u 0.9663 (0.9582) acc_u 3.1250 (4.5833) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [20/34] time 0.158 (0.180) data 0.080 (0.099) loss_u loss_u 0.9531 (0.9560) acc_u 3.1250 (5.0000) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/34] time 0.207 (0.182) data 0.083 (0.097) loss_u loss_u 0.9194 (0.9448) acc_u 9.3750 (6.2500) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [30/34] time 0.160 (0.182) data 0.082 (0.097) loss_u loss_u 0.9136 (0.9435) acc_u 9.3750 (6.3542) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 554
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 506
clean true:488
clean false:18
clean_rate:0.9644268774703557
noisy true:574
noisy false:536
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1110
epoch [199/200] batch [5/15] time 0.164 (0.168) data 0.086 (0.091) loss_x loss_x 0.1843 (0.4805) acc_x 96.8750 (89.3750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/15] time 0.168 (0.169) data 0.089 (0.091) loss_x loss_x 0.2915 (0.4658) acc_x 96.8750 (88.7500) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [15/15] time 0.190 (0.170) data 0.112 (0.093) loss_x loss_x 0.4292 (0.5389) acc_x 87.5000 (88.1250) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/34] time 0.174 (0.179) data 0.096 (0.092) loss_u loss_u 0.9829 (0.9269) acc_u 3.1250 (7.5000) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [10/34] time 0.174 (0.180) data 0.096 (0.095) loss_u loss_u 0.9731 (0.9410) acc_u 3.1250 (6.2500) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [15/34] time 0.180 (0.179) data 0.101 (0.096) loss_u loss_u 0.9258 (0.9407) acc_u 9.3750 (6.4583) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [20/34] time 0.171 (0.179) data 0.093 (0.096) loss_u loss_u 0.9624 (0.9385) acc_u 3.1250 (6.7188) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/34] time 0.160 (0.177) data 0.081 (0.094) loss_u loss_u 0.8291 (0.9316) acc_u 18.7500 (7.5000) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [30/34] time 0.161 (0.175) data 0.081 (0.093) loss_u loss_u 0.9678 (0.9354) acc_u 3.1250 (7.0833) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.3175, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 513
clean true:496
clean false:17
clean_rate:0.9668615984405458
noisy true:583
noisy false:520
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1103
epoch [200/200] batch [5/16] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.3279 (0.4160) acc_x 93.7500 (91.8750) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/16] time 0.158 (0.179) data 0.081 (0.102) loss_x loss_x 0.4211 (0.4112) acc_x 90.6250 (91.8750) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/16] time 0.191 (0.180) data 0.113 (0.102) loss_x loss_x 0.6167 (0.4466) acc_x 84.3750 (90.8333) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/34] time 0.187 (0.180) data 0.108 (0.102) loss_u loss_u 0.9678 (0.9514) acc_u 3.1250 (5.0000) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [10/34] time 0.187 (0.181) data 0.109 (0.103) loss_u loss_u 0.9375 (0.9480) acc_u 6.2500 (5.0000) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/34] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.9556 (0.9505) acc_u 6.2500 (5.2083) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [20/34] time 0.184 (0.185) data 0.106 (0.104) loss_u loss_u 0.9346 (0.9494) acc_u 6.2500 (5.4688) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/34] time 0.205 (0.185) data 0.126 (0.105) loss_u loss_u 0.9453 (0.9480) acc_u 6.2500 (5.7500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [30/34] time 0.178 (0.184) data 0.100 (0.104) loss_u loss_u 0.8906 (0.9429) acc_u 12.5000 (6.2500) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,619
* accuracy: 69.2%
* error: 30.8%
* macro_f1: 66.9%
Elapsed: 0:59:38
