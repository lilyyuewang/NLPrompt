***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.125', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.125
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Splitting trainval into 80% train and 20% val
Saved split to /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Creating a 16-shot dataset
Creating a 4-shot dataset
Saving preprocessed few-shot data to /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 437
clean true:436
clean false:1
clean_rate:0.9977116704805492
noisy true:76
noisy false:1103
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1179
epoch [1/200] batch [5/13] time 0.168 (0.203) data 0.091 (0.106) loss_x loss_x 2.6094 (2.7398) acc_x 53.1250 (48.1250) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/13] time 0.182 (0.190) data 0.104 (0.102) loss_x loss_x 2.0488 (2.5084) acc_x 62.5000 (53.7500) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/36] time 0.194 (0.192) data 0.116 (0.107) loss_u loss_u 0.9395 (0.9358) acc_u 18.7500 (17.5000) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [10/36] time 0.190 (0.192) data 0.113 (0.109) loss_u loss_u 0.8892 (0.9225) acc_u 21.8750 (19.3750) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [15/36] time 0.192 (0.192) data 0.114 (0.110) loss_u loss_u 0.8936 (0.9148) acc_u 18.7500 (20.6250) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [20/36] time 0.191 (0.192) data 0.112 (0.111) loss_u loss_u 0.9102 (0.9155) acc_u 31.2500 (20.1562) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [25/36] time 0.200 (0.193) data 0.122 (0.112) loss_u loss_u 0.9331 (0.9137) acc_u 25.0000 (20.2500) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [30/36] time 0.182 (0.192) data 0.103 (0.112) loss_u loss_u 0.8618 (0.9135) acc_u 37.5000 (20.0000) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [35/36] time 0.184 (0.192) data 0.105 (0.111) loss_u loss_u 0.8755 (0.9123) acc_u 31.2500 (20.0000) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 973
confident_label rate tensor(0.3416, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 552
clean true:550
clean false:2
clean_rate:0.9963768115942029
noisy true:93
noisy false:971
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 1064
epoch [2/200] batch [5/17] time 0.192 (0.197) data 0.114 (0.119) loss_x loss_x 1.1357 (1.5846) acc_x 59.3750 (58.7500) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [10/17] time 0.171 (0.186) data 0.094 (0.109) loss_x loss_x 1.3721 (1.3676) acc_x 68.7500 (65.3125) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [15/17] time 0.167 (0.183) data 0.090 (0.106) loss_x loss_x 1.2725 (1.2924) acc_x 65.6250 (66.0417) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/33] time 0.184 (0.181) data 0.106 (0.103) loss_u loss_u 0.8389 (0.8059) acc_u 21.8750 (26.8750) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [10/33] time 0.184 (0.182) data 0.105 (0.104) loss_u loss_u 0.8115 (0.8023) acc_u 21.8750 (26.8750) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [15/33] time 0.187 (0.183) data 0.108 (0.105) loss_u loss_u 0.7998 (0.7933) acc_u 31.2500 (28.9583) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [20/33] time 0.186 (0.184) data 0.109 (0.106) loss_u loss_u 0.8301 (0.7902) acc_u 28.1250 (28.7500) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [25/33] time 0.204 (0.185) data 0.126 (0.107) loss_u loss_u 0.8359 (0.7900) acc_u 25.0000 (28.5000) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [30/33] time 0.192 (0.185) data 0.114 (0.108) loss_u loss_u 0.8110 (0.7916) acc_u 21.8750 (28.0208) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 807
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 706
clean true:703
clean false:3
clean_rate:0.9957507082152974
noisy true:106
noisy false:804
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 910
epoch [3/200] batch [5/22] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.8110 (1.0740) acc_x 68.7500 (71.8750) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [10/22] time 0.156 (0.175) data 0.079 (0.098) loss_x loss_x 0.9043 (1.1173) acc_x 81.2500 (69.0625) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [15/22] time 0.158 (0.173) data 0.081 (0.095) loss_x loss_x 0.7559 (1.0860) acc_x 84.3750 (69.3750) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [20/22] time 0.164 (0.170) data 0.087 (0.093) loss_x loss_x 1.2656 (1.0770) acc_x 68.7500 (69.5312) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/28] time 0.176 (0.170) data 0.098 (0.092) loss_u loss_u 0.7646 (0.8044) acc_u 28.1250 (22.5000) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [10/28] time 0.184 (0.172) data 0.107 (0.095) loss_u loss_u 0.8335 (0.8035) acc_u 21.8750 (22.8125) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/28] time 0.214 (0.175) data 0.137 (0.097) loss_u loss_u 0.8750 (0.8170) acc_u 18.7500 (21.8750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/28] time 0.180 (0.175) data 0.102 (0.098) loss_u loss_u 0.8311 (0.8082) acc_u 21.8750 (23.2812) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [25/28] time 0.189 (0.176) data 0.111 (0.099) loss_u loss_u 0.7183 (0.8160) acc_u 37.5000 (22.6250) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 760
confident_label rate tensor(0.4585, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 741
clean true:740
clean false:1
clean_rate:0.9986504723346828
noisy true:116
noisy false:759
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 875
epoch [4/200] batch [5/23] time 0.165 (0.178) data 0.088 (0.101) loss_x loss_x 0.7378 (1.0882) acc_x 90.6250 (73.7500) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [10/23] time 0.177 (0.178) data 0.099 (0.100) loss_x loss_x 0.6099 (1.0629) acc_x 87.5000 (75.3125) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/23] time 0.175 (0.179) data 0.097 (0.102) loss_x loss_x 0.7627 (1.0073) acc_x 81.2500 (76.0417) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [20/23] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 1.3652 (1.0247) acc_x 62.5000 (74.5312) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/27] time 0.168 (0.175) data 0.090 (0.098) loss_u loss_u 0.7739 (0.8116) acc_u 25.0000 (22.5000) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [10/27] time 0.167 (0.174) data 0.090 (0.096) loss_u loss_u 0.7632 (0.8050) acc_u 34.3750 (23.4375) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/27] time 0.186 (0.176) data 0.109 (0.098) loss_u loss_u 0.7988 (0.8002) acc_u 28.1250 (24.3750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/27] time 0.163 (0.176) data 0.086 (0.098) loss_u loss_u 0.8730 (0.8101) acc_u 15.6250 (22.8125) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [25/27] time 0.177 (0.176) data 0.099 (0.098) loss_u loss_u 0.8516 (0.8073) acc_u 18.7500 (22.8750) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 764
confident_label rate tensor(0.4610, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 745
clean true:743
clean false:2
clean_rate:0.9973154362416108
noisy true:109
noisy false:762
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 871
epoch [5/200] batch [5/23] time 0.176 (0.179) data 0.098 (0.101) loss_x loss_x 0.9897 (0.8908) acc_x 78.1250 (76.8750) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [10/23] time 0.242 (0.180) data 0.165 (0.102) loss_x loss_x 1.1299 (0.9113) acc_x 68.7500 (75.9375) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [15/23] time 0.165 (0.176) data 0.088 (0.098) loss_x loss_x 1.0205 (0.9759) acc_x 75.0000 (75.0000) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/23] time 0.182 (0.172) data 0.105 (0.095) loss_x loss_x 1.3604 (0.9410) acc_x 62.5000 (75.6250) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/27] time 0.183 (0.172) data 0.105 (0.094) loss_u loss_u 0.8320 (0.8081) acc_u 18.7500 (22.5000) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [10/27] time 0.191 (0.172) data 0.114 (0.094) loss_u loss_u 0.7969 (0.8054) acc_u 28.1250 (23.7500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [15/27] time 0.183 (0.174) data 0.105 (0.096) loss_u loss_u 0.8745 (0.8023) acc_u 18.7500 (24.5833) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/27] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.9126 (0.8129) acc_u 9.3750 (23.2812) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [25/27] time 0.191 (0.175) data 0.113 (0.098) loss_u loss_u 0.8052 (0.8130) acc_u 25.0000 (23.1250) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 711
confident_label rate tensor(0.4821, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 779
clean true:779
clean false:0
clean_rate:1.0
noisy true:126
noisy false:711
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 837
epoch [6/200] batch [5/24] time 0.167 (0.179) data 0.089 (0.101) loss_x loss_x 0.5903 (0.8882) acc_x 84.3750 (78.1250) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/24] time 0.180 (0.178) data 0.103 (0.100) loss_x loss_x 0.6602 (0.9305) acc_x 81.2500 (75.6250) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/24] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 1.1973 (0.9104) acc_x 78.1250 (76.0417) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [20/24] time 0.170 (0.176) data 0.093 (0.098) loss_x loss_x 1.0811 (0.9482) acc_x 81.2500 (75.3125) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/26] time 0.186 (0.179) data 0.107 (0.102) loss_u loss_u 0.8569 (0.8185) acc_u 21.8750 (22.5000) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/26] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8013 (0.8130) acc_u 21.8750 (22.5000) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/26] time 0.180 (0.181) data 0.101 (0.103) loss_u loss_u 0.7598 (0.8091) acc_u 25.0000 (22.5000) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [20/26] time 0.182 (0.181) data 0.103 (0.103) loss_u loss_u 0.8330 (0.8063) acc_u 25.0000 (23.4375) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [25/26] time 0.178 (0.181) data 0.100 (0.103) loss_u loss_u 0.8291 (0.8069) acc_u 25.0000 (23.2500) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 692
confident_label rate tensor(0.4907, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 793
clean true:792
clean false:1
clean_rate:0.9987389659520807
noisy true:132
noisy false:691
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 823
epoch [7/200] batch [5/24] time 0.160 (0.175) data 0.081 (0.098) loss_x loss_x 0.6333 (0.8166) acc_x 87.5000 (80.6250) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/24] time 0.171 (0.176) data 0.094 (0.098) loss_x loss_x 0.8760 (0.9408) acc_x 75.0000 (76.5625) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/24] time 0.165 (0.172) data 0.087 (0.094) loss_x loss_x 1.0156 (0.9177) acc_x 71.8750 (75.6250) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/24] time 0.177 (0.171) data 0.099 (0.093) loss_x loss_x 1.3477 (0.9386) acc_x 56.2500 (73.5938) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/25] time 0.168 (0.172) data 0.090 (0.095) loss_u loss_u 0.7939 (0.7752) acc_u 21.8750 (26.8750) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/25] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.7412 (0.7804) acc_u 25.0000 (26.2500) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/25] time 0.190 (0.176) data 0.113 (0.098) loss_u loss_u 0.7456 (0.7810) acc_u 34.3750 (26.4583) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/25] time 0.163 (0.175) data 0.086 (0.097) loss_u loss_u 0.8359 (0.7849) acc_u 12.5000 (25.4688) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [25/25] time 0.186 (0.176) data 0.108 (0.098) loss_u loss_u 0.7275 (0.7816) acc_u 28.1250 (25.8750) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.5037, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 814
clean true:812
clean false:2
clean_rate:0.9975429975429976
noisy true:136
noisy false:666
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 802
epoch [8/200] batch [5/25] time 0.186 (0.187) data 0.108 (0.109) loss_x loss_x 0.6309 (1.0858) acc_x 78.1250 (71.8750) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/25] time 0.169 (0.188) data 0.092 (0.110) loss_x loss_x 0.5049 (0.9802) acc_x 81.2500 (72.8125) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/25] time 0.164 (0.181) data 0.087 (0.104) loss_x loss_x 1.0078 (1.0280) acc_x 75.0000 (73.1250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [20/25] time 0.180 (0.178) data 0.102 (0.101) loss_x loss_x 0.5723 (0.9742) acc_x 90.6250 (74.5312) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [25/25] time 0.180 (0.178) data 0.102 (0.101) loss_x loss_x 0.4370 (0.9653) acc_x 87.5000 (74.1250) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/25] time 0.186 (0.180) data 0.109 (0.102) loss_u loss_u 0.8008 (0.7464) acc_u 28.1250 (31.8750) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/25] time 0.187 (0.181) data 0.108 (0.103) loss_u loss_u 0.8916 (0.7767) acc_u 15.6250 (26.8750) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/25] time 0.181 (0.181) data 0.104 (0.103) loss_u loss_u 0.8896 (0.7940) acc_u 15.6250 (24.5833) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [20/25] time 0.183 (0.181) data 0.106 (0.103) loss_u loss_u 0.8135 (0.7964) acc_u 18.7500 (23.5938) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [25/25] time 0.197 (0.182) data 0.120 (0.104) loss_u loss_u 0.8340 (0.8041) acc_u 21.8750 (23.0000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 701
confident_label rate tensor(0.4920, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 795
clean true:794
clean false:1
clean_rate:0.9987421383647799
noisy true:121
noisy false:700
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 821
epoch [9/200] batch [5/24] time 0.177 (0.184) data 0.100 (0.106) loss_x loss_x 1.1826 (1.0399) acc_x 68.7500 (73.7500) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/24] time 0.166 (0.175) data 0.089 (0.097) loss_x loss_x 1.0869 (0.9706) acc_x 68.7500 (74.0625) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/24] time 0.180 (0.175) data 0.102 (0.097) loss_x loss_x 0.7075 (0.9793) acc_x 78.1250 (72.5000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/24] time 0.164 (0.174) data 0.086 (0.096) loss_x loss_x 1.1338 (0.9958) acc_x 71.8750 (72.6562) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/25] time 0.171 (0.173) data 0.091 (0.095) loss_u loss_u 0.8022 (0.7654) acc_u 21.8750 (27.5000) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/25] time 0.165 (0.171) data 0.088 (0.094) loss_u loss_u 0.7666 (0.7657) acc_u 28.1250 (27.5000) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/25] time 0.164 (0.171) data 0.087 (0.093) loss_u loss_u 0.7959 (0.7746) acc_u 25.0000 (26.2500) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/25] time 0.163 (0.170) data 0.086 (0.092) loss_u loss_u 0.8662 (0.7838) acc_u 21.8750 (26.4062) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [25/25] time 0.164 (0.169) data 0.086 (0.092) loss_u loss_u 0.7690 (0.7851) acc_u 31.2500 (26.1250) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 803
clean true:803
clean false:0
clean_rate:1.0
noisy true:129
noisy false:684
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 813
epoch [10/200] batch [5/25] time 0.169 (0.174) data 0.091 (0.096) loss_x loss_x 1.1367 (0.9693) acc_x 71.8750 (75.6250) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/25] time 0.169 (0.171) data 0.092 (0.094) loss_x loss_x 0.8198 (1.0024) acc_x 75.0000 (73.1250) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/25] time 0.184 (0.169) data 0.107 (0.092) loss_x loss_x 1.2256 (0.9756) acc_x 75.0000 (74.3750) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/25] time 0.184 (0.175) data 0.107 (0.097) loss_x loss_x 0.8706 (0.9701) acc_x 71.8750 (73.9062) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [25/25] time 0.166 (0.176) data 0.087 (0.098) loss_x loss_x 1.1748 (0.9853) acc_x 71.8750 (73.7500) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/25] time 0.175 (0.174) data 0.096 (0.096) loss_u loss_u 0.8320 (0.8283) acc_u 21.8750 (18.7500) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/25] time 0.167 (0.174) data 0.090 (0.096) loss_u loss_u 0.7739 (0.8079) acc_u 21.8750 (21.8750) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/25] time 0.188 (0.175) data 0.109 (0.097) loss_u loss_u 0.8481 (0.8027) acc_u 18.7500 (22.9167) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/25] time 0.187 (0.177) data 0.109 (0.099) loss_u loss_u 0.8232 (0.7993) acc_u 25.0000 (23.9062) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [25/25] time 0.186 (0.178) data 0.108 (0.100) loss_u loss_u 0.7402 (0.7896) acc_u 34.3750 (25.3750) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 644
confident_label rate tensor(0.5204, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 841
clean true:838
clean false:3
clean_rate:0.9964328180737217
noisy true:134
noisy false:641
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 775
epoch [11/200] batch [5/26] time 0.190 (0.187) data 0.112 (0.109) loss_x loss_x 0.9512 (0.9691) acc_x 75.0000 (76.8750) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/26] time 0.168 (0.185) data 0.085 (0.106) loss_x loss_x 1.0381 (0.9467) acc_x 71.8750 (77.5000) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/26] time 0.181 (0.184) data 0.104 (0.106) loss_x loss_x 0.9551 (0.9476) acc_x 75.0000 (77.2917) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/26] time 0.189 (0.183) data 0.112 (0.105) loss_x loss_x 0.8198 (0.9824) acc_x 78.1250 (76.8750) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [25/26] time 0.156 (0.181) data 0.079 (0.103) loss_x loss_x 0.8560 (0.9625) acc_x 75.0000 (76.8750) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/24] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.7329 (0.8008) acc_u 31.2500 (23.7500) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/24] time 0.159 (0.177) data 0.081 (0.099) loss_u loss_u 0.7788 (0.7846) acc_u 25.0000 (25.6250) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/24] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.8647 (0.7913) acc_u 12.5000 (24.5833) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/24] time 0.168 (0.175) data 0.089 (0.098) loss_u loss_u 0.7578 (0.7927) acc_u 28.1250 (23.9062) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 648
confident_label rate tensor(0.5217, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 843
clean true:841
clean false:2
clean_rate:0.9976275207591934
noisy true:127
noisy false:646
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 773
epoch [12/200] batch [5/26] time 0.161 (0.186) data 0.084 (0.109) loss_x loss_x 0.9673 (0.8460) acc_x 75.0000 (81.2500) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/26] time 0.163 (0.176) data 0.085 (0.099) loss_x loss_x 0.8608 (1.0311) acc_x 71.8750 (73.7500) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/26] time 0.183 (0.174) data 0.106 (0.096) loss_x loss_x 0.6055 (0.9462) acc_x 84.3750 (75.8333) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/26] time 0.171 (0.173) data 0.094 (0.095) loss_x loss_x 1.2734 (0.9172) acc_x 65.6250 (76.2500) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [25/26] time 0.178 (0.174) data 0.101 (0.096) loss_x loss_x 1.1191 (0.9111) acc_x 68.7500 (76.8750) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/24] time 0.188 (0.174) data 0.109 (0.096) loss_u loss_u 0.7661 (0.8021) acc_u 25.0000 (23.1250) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/24] time 0.176 (0.175) data 0.098 (0.097) loss_u loss_u 0.7065 (0.7835) acc_u 37.5000 (25.3125) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/24] time 0.165 (0.174) data 0.088 (0.097) loss_u loss_u 0.7383 (0.7916) acc_u 34.3750 (24.7917) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/24] time 0.183 (0.174) data 0.104 (0.096) loss_u loss_u 0.8188 (0.8007) acc_u 18.7500 (23.5938) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 640
confident_label rate tensor(0.5278, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 853
clean true:852
clean false:1
clean_rate:0.9988276670574443
noisy true:124
noisy false:639
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 763
epoch [13/200] batch [5/26] time 0.173 (0.171) data 0.094 (0.093) loss_x loss_x 0.7412 (0.8007) acc_x 78.1250 (78.7500) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/26] time 0.167 (0.169) data 0.089 (0.091) loss_x loss_x 0.7803 (0.8430) acc_x 81.2500 (78.1250) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/26] time 0.176 (0.172) data 0.099 (0.094) loss_x loss_x 0.4490 (0.8321) acc_x 90.6250 (76.8750) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/26] time 0.175 (0.173) data 0.098 (0.095) loss_x loss_x 0.9033 (0.9134) acc_x 78.1250 (75.0000) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [25/26] time 0.174 (0.174) data 0.096 (0.096) loss_x loss_x 1.0850 (0.9496) acc_x 71.8750 (74.2500) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/23] time 0.167 (0.173) data 0.088 (0.095) loss_u loss_u 0.7422 (0.7842) acc_u 31.2500 (27.5000) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/23] time 0.166 (0.172) data 0.089 (0.094) loss_u loss_u 0.9253 (0.7865) acc_u 6.2500 (26.8750) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/23] time 0.171 (0.172) data 0.093 (0.095) loss_u loss_u 0.8696 (0.8002) acc_u 15.6250 (24.7917) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/23] time 0.182 (0.173) data 0.104 (0.096) loss_u loss_u 0.7983 (0.7861) acc_u 28.1250 (26.4062) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 630
confident_label rate tensor(0.5272, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 852
clean true:851
clean false:1
clean_rate:0.9988262910798122
noisy true:135
noisy false:629
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 764
epoch [14/200] batch [5/26] time 0.167 (0.171) data 0.089 (0.093) loss_x loss_x 1.2324 (0.8662) acc_x 65.6250 (76.8750) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/26] time 0.172 (0.173) data 0.094 (0.095) loss_x loss_x 0.6284 (0.9022) acc_x 84.3750 (77.1875) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/26] time 0.169 (0.175) data 0.091 (0.097) loss_x loss_x 1.1387 (0.9537) acc_x 75.0000 (75.0000) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/26] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.9575 (0.9086) acc_x 78.1250 (76.7188) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [25/26] time 0.182 (0.175) data 0.104 (0.097) loss_x loss_x 0.6294 (0.9043) acc_x 84.3750 (76.1250) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/23] time 0.162 (0.175) data 0.085 (0.097) loss_u loss_u 0.7891 (0.7615) acc_u 21.8750 (25.6250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/23] time 0.190 (0.175) data 0.112 (0.098) loss_u loss_u 0.7520 (0.7666) acc_u 28.1250 (27.1875) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/23] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.7983 (0.7635) acc_u 25.0000 (27.5000) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/23] time 0.169 (0.177) data 0.091 (0.099) loss_u loss_u 0.7900 (0.7773) acc_u 25.0000 (26.2500) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 612
confident_label rate tensor(0.5408, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 874
clean true:872
clean false:2
clean_rate:0.9977116704805492
noisy true:132
noisy false:610
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 742
epoch [15/200] batch [5/27] time 0.171 (0.173) data 0.093 (0.096) loss_x loss_x 0.5801 (0.8390) acc_x 84.3750 (75.0000) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/27] time 0.172 (0.172) data 0.093 (0.094) loss_x loss_x 1.1855 (0.8480) acc_x 71.8750 (75.6250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/27] time 0.181 (0.175) data 0.104 (0.097) loss_x loss_x 0.5986 (0.8753) acc_x 84.3750 (75.4167) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/27] time 0.169 (0.175) data 0.091 (0.097) loss_x loss_x 0.7422 (0.8803) acc_x 87.5000 (75.9375) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [25/27] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.7578 (0.8704) acc_x 84.3750 (77.0000) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/23] time 0.161 (0.177) data 0.083 (0.099) loss_u loss_u 0.7437 (0.7828) acc_u 31.2500 (26.2500) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/23] time 0.178 (0.176) data 0.100 (0.098) loss_u loss_u 0.8057 (0.7961) acc_u 25.0000 (24.3750) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/23] time 0.167 (0.175) data 0.089 (0.097) loss_u loss_u 0.8452 (0.7892) acc_u 15.6250 (24.3750) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/23] time 0.168 (0.175) data 0.090 (0.097) loss_u loss_u 0.8511 (0.7923) acc_u 18.7500 (24.0625) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 655
confident_label rate tensor(0.5173, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 836
clean true:835
clean false:1
clean_rate:0.9988038277511961
noisy true:126
noisy false:654
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 780
epoch [16/200] batch [5/26] time 0.181 (0.186) data 0.103 (0.108) loss_x loss_x 0.7715 (0.6828) acc_x 84.3750 (82.5000) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/26] time 0.188 (0.183) data 0.110 (0.106) loss_x loss_x 0.8271 (0.7365) acc_x 78.1250 (81.5625) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/26] time 0.187 (0.186) data 0.109 (0.108) loss_x loss_x 1.1328 (0.7122) acc_x 68.7500 (80.6250) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/26] time 0.188 (0.187) data 0.109 (0.109) loss_x loss_x 1.0195 (0.7711) acc_x 75.0000 (78.7500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [25/26] time 0.178 (0.185) data 0.101 (0.107) loss_x loss_x 1.1260 (0.7965) acc_x 75.0000 (78.7500) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/24] time 0.185 (0.184) data 0.105 (0.106) loss_u loss_u 0.8628 (0.8133) acc_u 15.6250 (19.3750) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/24] time 0.182 (0.184) data 0.103 (0.106) loss_u loss_u 0.8096 (0.7845) acc_u 21.8750 (24.6875) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/24] time 0.182 (0.184) data 0.104 (0.105) loss_u loss_u 0.7666 (0.7848) acc_u 25.0000 (24.7917) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/24] time 0.181 (0.184) data 0.102 (0.105) loss_u loss_u 0.7485 (0.7779) acc_u 25.0000 (25.6250) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.5408, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 874
clean true:874
clean false:0
clean_rate:1.0
noisy true:129
noisy false:613
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 742
epoch [17/200] batch [5/27] time 0.180 (0.182) data 0.103 (0.104) loss_x loss_x 1.2666 (1.0277) acc_x 56.2500 (73.1250) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/27] time 0.172 (0.175) data 0.094 (0.097) loss_x loss_x 0.4727 (0.8721) acc_x 90.6250 (77.8125) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/27] time 0.175 (0.173) data 0.097 (0.095) loss_x loss_x 0.5073 (0.8279) acc_x 87.5000 (78.1250) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/27] time 0.177 (0.173) data 0.099 (0.094) loss_x loss_x 0.5386 (0.8737) acc_x 84.3750 (77.3438) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [25/27] time 0.180 (0.174) data 0.102 (0.096) loss_x loss_x 0.7847 (0.8328) acc_x 78.1250 (78.6250) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/23] time 0.176 (0.174) data 0.097 (0.096) loss_u loss_u 0.7461 (0.7781) acc_u 28.1250 (25.6250) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/23] time 0.162 (0.173) data 0.082 (0.095) loss_u loss_u 0.7031 (0.7690) acc_u 34.3750 (26.8750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/23] time 0.177 (0.173) data 0.099 (0.094) loss_u loss_u 0.7783 (0.7772) acc_u 28.1250 (26.8750) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/23] time 0.177 (0.173) data 0.098 (0.094) loss_u loss_u 0.7803 (0.7800) acc_u 25.0000 (26.0938) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 622
confident_label rate tensor(0.5377, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 869
clean true:866
clean false:3
clean_rate:0.996547756041427
noisy true:128
noisy false:619
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 747
epoch [18/200] batch [5/27] time 0.187 (0.181) data 0.110 (0.103) loss_x loss_x 0.6333 (0.7201) acc_x 84.3750 (85.0000) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/27] time 0.168 (0.178) data 0.090 (0.101) loss_x loss_x 0.6343 (0.7541) acc_x 75.0000 (80.6250) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/27] time 0.171 (0.178) data 0.093 (0.101) loss_x loss_x 0.9219 (0.8150) acc_x 75.0000 (80.2083) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/27] time 0.163 (0.176) data 0.085 (0.098) loss_x loss_x 0.5005 (0.8072) acc_x 90.6250 (80.0000) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [25/27] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.9194 (0.8144) acc_x 78.1250 (79.3750) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/23] time 0.173 (0.176) data 0.095 (0.098) loss_u loss_u 0.8628 (0.7743) acc_u 21.8750 (26.8750) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/23] time 0.185 (0.176) data 0.107 (0.098) loss_u loss_u 0.7090 (0.7723) acc_u 40.6250 (27.8125) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/23] time 0.162 (0.174) data 0.084 (0.096) loss_u loss_u 0.7959 (0.7698) acc_u 25.0000 (27.7083) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/23] time 0.173 (0.175) data 0.096 (0.097) loss_u loss_u 0.8682 (0.7738) acc_u 12.5000 (26.5625) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 607
confident_label rate tensor(0.5396, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 872
clean true:871
clean false:1
clean_rate:0.9988532110091743
noisy true:138
noisy false:606
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 744
epoch [19/200] batch [5/27] time 0.190 (0.181) data 0.113 (0.103) loss_x loss_x 0.7334 (0.8627) acc_x 87.5000 (77.5000) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/27] time 0.192 (0.181) data 0.114 (0.103) loss_x loss_x 0.7017 (0.7756) acc_x 81.2500 (79.6875) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/27] time 0.173 (0.180) data 0.094 (0.102) loss_x loss_x 1.2021 (0.8007) acc_x 75.0000 (78.9583) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [20/27] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 0.7026 (0.8289) acc_x 81.2500 (78.2812) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [25/27] time 0.169 (0.179) data 0.091 (0.101) loss_x loss_x 1.2109 (0.8551) acc_x 75.0000 (77.7500) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/23] time 0.175 (0.178) data 0.097 (0.100) loss_u loss_u 0.8394 (0.8029) acc_u 18.7500 (21.8750) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/23] time 0.159 (0.177) data 0.080 (0.099) loss_u loss_u 0.8013 (0.7858) acc_u 25.0000 (24.6875) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/23] time 0.171 (0.177) data 0.093 (0.099) loss_u loss_u 0.8193 (0.7570) acc_u 15.6250 (28.1250) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/23] time 0.173 (0.176) data 0.095 (0.098) loss_u loss_u 0.8501 (0.7552) acc_u 15.6250 (28.4375) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.5545, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 896
clean true:896
clean false:0
clean_rate:1.0
noisy true:134
noisy false:586
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 720
epoch [20/200] batch [5/28] time 0.186 (0.186) data 0.109 (0.108) loss_x loss_x 0.7397 (0.6632) acc_x 84.3750 (83.1250) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/28] time 0.195 (0.187) data 0.117 (0.110) loss_x loss_x 1.4180 (0.7927) acc_x 68.7500 (80.3125) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/28] time 0.188 (0.187) data 0.109 (0.109) loss_x loss_x 1.0273 (0.8160) acc_x 75.0000 (79.3750) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/28] time 0.187 (0.186) data 0.110 (0.108) loss_x loss_x 0.8408 (0.8241) acc_x 84.3750 (78.4375) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [25/28] time 0.169 (0.183) data 0.092 (0.106) loss_x loss_x 0.8789 (0.8334) acc_x 75.0000 (77.8750) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/22] time 0.165 (0.180) data 0.087 (0.102) loss_u loss_u 0.8350 (0.7657) acc_u 18.7500 (28.1250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/22] time 0.160 (0.177) data 0.082 (0.099) loss_u loss_u 0.8213 (0.7884) acc_u 18.7500 (24.6875) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/22] time 0.166 (0.177) data 0.086 (0.099) loss_u loss_u 0.7451 (0.7760) acc_u 28.1250 (25.8333) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/22] time 0.162 (0.176) data 0.084 (0.098) loss_u loss_u 0.7754 (0.7799) acc_u 21.8750 (25.6250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 601
confident_label rate tensor(0.5501, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 889
clean true:888
clean false:1
clean_rate:0.9988751406074241
noisy true:127
noisy false:600
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 727
epoch [21/200] batch [5/27] time 0.180 (0.177) data 0.102 (0.100) loss_x loss_x 0.5732 (0.8257) acc_x 84.3750 (81.8750) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/27] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.7402 (0.8178) acc_x 78.1250 (80.0000) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [15/27] time 0.187 (0.182) data 0.108 (0.104) loss_x loss_x 0.7798 (0.7559) acc_x 78.1250 (80.8333) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [20/27] time 0.188 (0.183) data 0.111 (0.106) loss_x loss_x 0.8662 (0.8071) acc_x 75.0000 (79.3750) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [25/27] time 0.175 (0.184) data 0.097 (0.106) loss_x loss_x 1.0078 (0.8270) acc_x 75.0000 (78.7500) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/22] time 0.178 (0.183) data 0.100 (0.105) loss_u loss_u 0.8037 (0.7731) acc_u 25.0000 (28.7500) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/22] time 0.176 (0.182) data 0.098 (0.104) loss_u loss_u 0.7534 (0.7626) acc_u 31.2500 (29.0625) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/22] time 0.163 (0.181) data 0.084 (0.103) loss_u loss_u 0.8208 (0.7599) acc_u 15.6250 (28.1250) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/22] time 0.203 (0.180) data 0.125 (0.103) loss_u loss_u 0.7642 (0.7709) acc_u 28.1250 (26.7188) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 603
confident_label rate tensor(0.5439, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 879
clean true:878
clean false:1
clean_rate:0.9988623435722411
noisy true:135
noisy false:602
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 737
epoch [22/200] batch [5/27] time 0.170 (0.173) data 0.093 (0.095) loss_x loss_x 0.4900 (0.6958) acc_x 87.5000 (81.8750) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/27] time 0.194 (0.176) data 0.116 (0.098) loss_x loss_x 0.4836 (0.7401) acc_x 87.5000 (79.6875) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/27] time 0.159 (0.175) data 0.081 (0.098) loss_x loss_x 1.2559 (0.7756) acc_x 71.8750 (79.1667) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/27] time 0.184 (0.175) data 0.107 (0.097) loss_x loss_x 0.8623 (0.7756) acc_x 71.8750 (78.5938) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [25/27] time 0.188 (0.177) data 0.110 (0.099) loss_x loss_x 0.4150 (0.7133) acc_x 93.7500 (80.3750) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/23] time 0.195 (0.180) data 0.117 (0.102) loss_u loss_u 0.7012 (0.7664) acc_u 31.2500 (26.2500) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/23] time 0.190 (0.182) data 0.112 (0.104) loss_u loss_u 0.8726 (0.7620) acc_u 12.5000 (26.5625) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/23] time 0.160 (0.181) data 0.082 (0.103) loss_u loss_u 0.6787 (0.7651) acc_u 34.3750 (27.0833) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/23] time 0.172 (0.180) data 0.094 (0.102) loss_u loss_u 0.7651 (0.7550) acc_u 34.3750 (28.9062) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.5520, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 892
clean true:891
clean false:1
clean_rate:0.9988789237668162
noisy true:147
noisy false:577
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 724
epoch [23/200] batch [5/27] time 0.173 (0.180) data 0.095 (0.103) loss_x loss_x 0.4690 (0.6542) acc_x 87.5000 (83.1250) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/27] time 0.181 (0.181) data 0.103 (0.103) loss_x loss_x 0.7358 (0.7573) acc_x 84.3750 (81.5625) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/27] time 0.178 (0.181) data 0.100 (0.103) loss_x loss_x 0.7856 (0.7806) acc_x 62.5000 (79.5833) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [20/27] time 0.169 (0.181) data 0.091 (0.103) loss_x loss_x 1.3271 (0.8043) acc_x 68.7500 (78.5938) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [25/27] time 0.184 (0.180) data 0.106 (0.103) loss_x loss_x 0.5527 (0.7780) acc_x 84.3750 (79.1250) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/22] time 0.177 (0.178) data 0.099 (0.101) loss_u loss_u 0.7036 (0.7549) acc_u 37.5000 (28.7500) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/22] time 0.194 (0.178) data 0.116 (0.100) loss_u loss_u 0.7710 (0.7681) acc_u 28.1250 (28.1250) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/22] time 0.167 (0.177) data 0.090 (0.099) loss_u loss_u 0.7925 (0.7625) acc_u 25.0000 (28.9583) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/22] time 0.168 (0.176) data 0.090 (0.099) loss_u loss_u 0.7109 (0.7563) acc_u 31.2500 (29.3750) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 595
confident_label rate tensor(0.5520, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 892
clean true:890
clean false:2
clean_rate:0.9977578475336323
noisy true:131
noisy false:593
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 724
epoch [24/200] batch [5/27] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 1.0117 (1.0427) acc_x 71.8750 (75.0000) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [10/27] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.9102 (1.0024) acc_x 81.2500 (75.3125) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [15/27] time 0.163 (0.178) data 0.086 (0.100) loss_x loss_x 0.7939 (0.9388) acc_x 75.0000 (76.8750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/27] time 0.178 (0.177) data 0.100 (0.100) loss_x loss_x 0.8965 (0.9185) acc_x 78.1250 (76.7188) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [25/27] time 0.181 (0.178) data 0.104 (0.100) loss_x loss_x 1.3936 (0.9228) acc_x 65.6250 (76.7500) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/22] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.7666 (0.7725) acc_u 28.1250 (26.2500) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/22] time 0.185 (0.180) data 0.107 (0.102) loss_u loss_u 0.8042 (0.7537) acc_u 21.8750 (29.3750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/22] time 0.168 (0.178) data 0.090 (0.101) loss_u loss_u 0.7368 (0.7586) acc_u 28.1250 (28.3333) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [20/22] time 0.176 (0.178) data 0.098 (0.100) loss_u loss_u 0.7871 (0.7564) acc_u 25.0000 (28.9062) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 577
confident_label rate tensor(0.5631, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 910
clean true:909
clean false:1
clean_rate:0.9989010989010989
noisy true:130
noisy false:576
after delete: len(clean_dataset) 910
after delete: len(noisy_dataset) 706
epoch [25/200] batch [5/28] time 0.185 (0.187) data 0.107 (0.110) loss_x loss_x 1.1201 (1.0023) acc_x 65.6250 (75.6250) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [10/28] time 0.172 (0.181) data 0.094 (0.103) loss_x loss_x 0.6221 (0.8721) acc_x 87.5000 (77.5000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/28] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 0.5850 (0.8453) acc_x 78.1250 (77.7083) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [20/28] time 0.172 (0.179) data 0.095 (0.101) loss_x loss_x 0.5518 (0.7870) acc_x 87.5000 (79.8438) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [25/28] time 0.189 (0.181) data 0.112 (0.104) loss_x loss_x 1.1943 (0.8375) acc_x 62.5000 (78.8750) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/22] time 0.180 (0.179) data 0.102 (0.101) loss_u loss_u 0.7100 (0.7426) acc_u 34.3750 (30.0000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/22] time 0.180 (0.179) data 0.102 (0.101) loss_u loss_u 0.7144 (0.7415) acc_u 43.7500 (32.1875) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/22] time 0.160 (0.177) data 0.082 (0.100) loss_u loss_u 0.8506 (0.7566) acc_u 25.0000 (30.4167) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/22] time 0.170 (0.177) data 0.092 (0.099) loss_u loss_u 0.7686 (0.7618) acc_u 28.1250 (29.2188) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 590
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 903
clean true:903
clean false:0
clean_rate:1.0
noisy true:123
noisy false:590
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 713
epoch [26/200] batch [5/28] time 0.187 (0.180) data 0.110 (0.103) loss_x loss_x 0.7822 (0.7831) acc_x 81.2500 (81.2500) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/28] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.6245 (0.7517) acc_x 81.2500 (81.2500) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [15/28] time 0.178 (0.181) data 0.100 (0.103) loss_x loss_x 0.5312 (0.7431) acc_x 84.3750 (81.0417) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/28] time 0.166 (0.181) data 0.089 (0.103) loss_x loss_x 0.7808 (0.7499) acc_x 81.2500 (81.0938) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [25/28] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.4863 (0.7461) acc_x 87.5000 (80.7500) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/22] time 0.172 (0.178) data 0.094 (0.100) loss_u loss_u 0.7339 (0.7790) acc_u 34.3750 (27.5000) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [10/22] time 0.169 (0.177) data 0.091 (0.099) loss_u loss_u 0.8174 (0.7736) acc_u 18.7500 (26.5625) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/22] time 0.162 (0.176) data 0.083 (0.098) loss_u loss_u 0.7075 (0.7607) acc_u 34.3750 (28.3333) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/22] time 0.184 (0.176) data 0.106 (0.098) loss_u loss_u 0.7510 (0.7490) acc_u 21.8750 (29.2188) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 550
confident_label rate tensor(0.5811, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 939
clean true:936
clean false:3
clean_rate:0.9968051118210862
noisy true:130
noisy false:547
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 677
epoch [27/200] batch [5/29] time 0.172 (0.178) data 0.095 (0.100) loss_x loss_x 0.5234 (0.7986) acc_x 84.3750 (78.1250) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/29] time 0.158 (0.173) data 0.081 (0.095) loss_x loss_x 0.7544 (0.7589) acc_x 87.5000 (79.0625) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [15/29] time 0.175 (0.174) data 0.098 (0.097) loss_x loss_x 1.1191 (0.7756) acc_x 75.0000 (79.1667) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/29] time 0.166 (0.181) data 0.088 (0.103) loss_x loss_x 1.0547 (0.8042) acc_x 75.0000 (77.5000) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [25/29] time 0.169 (0.179) data 0.091 (0.101) loss_x loss_x 0.6367 (0.8091) acc_x 75.0000 (77.0000) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/21] time 0.188 (0.179) data 0.110 (0.101) loss_u loss_u 0.7183 (0.6982) acc_u 31.2500 (36.2500) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/21] time 0.177 (0.179) data 0.099 (0.102) loss_u loss_u 0.6636 (0.7215) acc_u 43.7500 (33.7500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/21] time 0.191 (0.180) data 0.112 (0.102) loss_u loss_u 0.7036 (0.7235) acc_u 31.2500 (33.3333) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/21] time 0.165 (0.180) data 0.088 (0.102) loss_u loss_u 0.7827 (0.7343) acc_u 25.0000 (31.7188) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.5730, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 926
clean true:925
clean false:1
clean_rate:0.9989200863930886
noisy true:146
noisy false:544
after delete: len(clean_dataset) 926
after delete: len(noisy_dataset) 690
epoch [28/200] batch [5/28] time 0.170 (0.169) data 0.093 (0.091) loss_x loss_x 0.7588 (0.8675) acc_x 87.5000 (81.2500) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [10/28] time 0.163 (0.168) data 0.086 (0.090) loss_x loss_x 0.9014 (0.9489) acc_x 75.0000 (75.9375) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/28] time 0.180 (0.172) data 0.103 (0.095) loss_x loss_x 1.1826 (0.9563) acc_x 68.7500 (75.6250) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/28] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 1.3301 (0.9182) acc_x 71.8750 (76.7188) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [25/28] time 0.175 (0.175) data 0.097 (0.097) loss_x loss_x 0.6094 (0.8273) acc_x 84.3750 (79.1250) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/21] time 0.206 (0.177) data 0.127 (0.100) loss_u loss_u 0.8154 (0.7521) acc_u 28.1250 (31.2500) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/21] time 0.181 (0.178) data 0.103 (0.100) loss_u loss_u 0.7881 (0.7654) acc_u 18.7500 (27.5000) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/21] time 0.186 (0.179) data 0.108 (0.101) loss_u loss_u 0.5898 (0.7715) acc_u 46.8750 (26.4583) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/21] time 0.186 (0.179) data 0.108 (0.101) loss_u loss_u 0.6924 (0.7636) acc_u 34.3750 (26.7188) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.5736, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 927
clean true:927
clean false:0
clean_rate:1.0
noisy true:136
noisy false:553
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 689
epoch [29/200] batch [5/28] time 0.189 (0.187) data 0.111 (0.109) loss_x loss_x 0.9316 (1.0213) acc_x 81.2500 (72.5000) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/28] time 0.162 (0.177) data 0.083 (0.099) loss_x loss_x 0.5869 (0.9116) acc_x 78.1250 (75.3125) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [15/28] time 0.172 (0.174) data 0.094 (0.096) loss_x loss_x 0.8667 (0.8914) acc_x 75.0000 (75.4167) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/28] time 0.163 (0.172) data 0.086 (0.094) loss_x loss_x 0.8301 (0.8625) acc_x 75.0000 (76.2500) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [25/28] time 0.169 (0.171) data 0.092 (0.093) loss_x loss_x 0.5269 (0.8287) acc_x 84.3750 (77.0000) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/21] time 0.177 (0.172) data 0.099 (0.094) loss_u loss_u 0.7109 (0.7320) acc_u 31.2500 (31.8750) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/21] time 0.178 (0.172) data 0.101 (0.094) loss_u loss_u 0.7915 (0.7356) acc_u 28.1250 (31.8750) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/21] time 0.175 (0.173) data 0.098 (0.095) loss_u loss_u 0.8052 (0.7304) acc_u 25.0000 (32.0833) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/21] time 0.177 (0.173) data 0.099 (0.095) loss_u loss_u 0.8564 (0.7473) acc_u 12.5000 (29.6875) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.5811, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 939
clean true:939
clean false:0
clean_rate:1.0
noisy true:142
noisy false:535
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 677
epoch [30/200] batch [5/29] time 0.158 (0.169) data 0.080 (0.091) loss_x loss_x 0.5664 (0.7192) acc_x 84.3750 (80.6250) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [10/29] time 0.175 (0.169) data 0.098 (0.091) loss_x loss_x 0.9072 (0.7398) acc_x 78.1250 (79.0625) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [15/29] time 0.172 (0.168) data 0.095 (0.091) loss_x loss_x 0.8647 (0.7629) acc_x 75.0000 (78.9583) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [20/29] time 0.171 (0.170) data 0.094 (0.092) loss_x loss_x 1.1729 (0.7723) acc_x 75.0000 (79.3750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [25/29] time 0.175 (0.171) data 0.098 (0.094) loss_x loss_x 1.0205 (0.7857) acc_x 81.2500 (79.2500) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/21] time 0.177 (0.173) data 0.097 (0.095) loss_u loss_u 0.8105 (0.7807) acc_u 21.8750 (27.5000) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/21] time 0.165 (0.174) data 0.087 (0.096) loss_u loss_u 0.7363 (0.7672) acc_u 28.1250 (29.3750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/21] time 0.168 (0.172) data 0.090 (0.095) loss_u loss_u 0.7666 (0.7595) acc_u 25.0000 (29.1667) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/21] time 0.187 (0.173) data 0.110 (0.095) loss_u loss_u 0.7817 (0.7510) acc_u 21.8750 (29.8438) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.5736, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 927
clean true:927
clean false:0
clean_rate:1.0
noisy true:136
noisy false:553
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 689
epoch [31/200] batch [5/28] time 0.188 (0.185) data 0.109 (0.107) loss_x loss_x 0.2896 (0.8500) acc_x 90.6250 (77.5000) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/28] time 0.172 (0.181) data 0.093 (0.103) loss_x loss_x 0.8623 (0.8544) acc_x 78.1250 (79.3750) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/28] time 0.171 (0.180) data 0.093 (0.102) loss_x loss_x 0.6206 (0.8686) acc_x 90.6250 (78.5417) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/28] time 0.170 (0.179) data 0.093 (0.101) loss_x loss_x 0.5234 (0.8341) acc_x 87.5000 (78.5938) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [25/28] time 0.172 (0.179) data 0.094 (0.101) loss_x loss_x 0.4575 (0.8326) acc_x 90.6250 (78.7500) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/21] time 0.169 (0.178) data 0.091 (0.100) loss_u loss_u 0.7007 (0.7354) acc_u 37.5000 (31.8750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/21] time 0.171 (0.179) data 0.094 (0.101) loss_u loss_u 0.7109 (0.7478) acc_u 34.3750 (30.3125) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/21] time 0.158 (0.177) data 0.080 (0.099) loss_u loss_u 0.7793 (0.7516) acc_u 31.2500 (30.6250) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/21] time 0.177 (0.177) data 0.100 (0.099) loss_u loss_u 0.8203 (0.7463) acc_u 18.7500 (30.4688) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.5866, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 948
clean true:947
clean false:1
clean_rate:0.9989451476793249
noisy true:140
noisy false:528
after delete: len(clean_dataset) 948
after delete: len(noisy_dataset) 668
epoch [32/200] batch [5/29] time 0.159 (0.171) data 0.082 (0.093) loss_x loss_x 1.0176 (0.9107) acc_x 71.8750 (80.0000) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/29] time 0.159 (0.166) data 0.081 (0.088) loss_x loss_x 0.6284 (0.8005) acc_x 87.5000 (81.5625) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [15/29] time 0.170 (0.169) data 0.092 (0.091) loss_x loss_x 0.7236 (0.7639) acc_x 71.8750 (81.8750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/29] time 0.168 (0.180) data 0.091 (0.102) loss_x loss_x 1.4434 (0.7733) acc_x 62.5000 (80.0000) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [25/29] time 0.170 (0.178) data 0.092 (0.100) loss_x loss_x 0.9263 (0.7908) acc_x 78.1250 (79.0000) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/20] time 0.179 (0.178) data 0.101 (0.100) loss_u loss_u 0.7188 (0.7456) acc_u 34.3750 (29.3750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/20] time 0.171 (0.177) data 0.093 (0.099) loss_u loss_u 0.6733 (0.7462) acc_u 40.6250 (30.3125) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/20] time 0.184 (0.178) data 0.107 (0.100) loss_u loss_u 0.8257 (0.7744) acc_u 15.6250 (26.0417) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [20/20] time 0.171 (0.176) data 0.093 (0.098) loss_u loss_u 0.7734 (0.7679) acc_u 28.1250 (27.5000) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 503
confident_label rate tensor(0.6089, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 984
clean true:983
clean false:1
clean_rate:0.9989837398373984
noisy true:130
noisy false:502
after delete: len(clean_dataset) 984
after delete: len(noisy_dataset) 632
epoch [33/200] batch [5/30] time 0.183 (0.177) data 0.105 (0.100) loss_x loss_x 1.1094 (0.8378) acc_x 71.8750 (77.5000) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/30] time 0.183 (0.181) data 0.104 (0.103) loss_x loss_x 0.5747 (0.7322) acc_x 84.3750 (80.6250) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/30] time 0.167 (0.180) data 0.088 (0.102) loss_x loss_x 0.7285 (0.7746) acc_x 81.2500 (79.3750) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/30] time 0.180 (0.179) data 0.103 (0.101) loss_x loss_x 0.3477 (0.7677) acc_x 93.7500 (79.5312) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [25/30] time 0.182 (0.179) data 0.104 (0.102) loss_x loss_x 0.6406 (0.7240) acc_x 84.3750 (80.7500) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [30/30] time 0.186 (0.181) data 0.108 (0.103) loss_x loss_x 0.9775 (0.7386) acc_x 65.6250 (80.1042) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/19] time 0.189 (0.182) data 0.110 (0.104) loss_u loss_u 0.8120 (0.7516) acc_u 25.0000 (29.3750) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/19] time 0.171 (0.181) data 0.093 (0.103) loss_u loss_u 0.8418 (0.7565) acc_u 15.6250 (29.3750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/19] time 0.171 (0.181) data 0.092 (0.103) loss_u loss_u 0.8003 (0.7641) acc_u 25.0000 (28.1250) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.5780, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 934
clean true:933
clean false:1
clean_rate:0.9989293361884368
noisy true:149
noisy false:533
after delete: len(clean_dataset) 934
after delete: len(noisy_dataset) 682
epoch [34/200] batch [5/29] time 0.167 (0.195) data 0.090 (0.118) loss_x loss_x 1.2998 (0.7199) acc_x 75.0000 (84.3750) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/29] time 0.164 (0.184) data 0.086 (0.106) loss_x loss_x 0.4868 (0.6127) acc_x 81.2500 (84.0625) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [15/29] time 0.173 (0.177) data 0.096 (0.099) loss_x loss_x 0.8174 (0.6181) acc_x 78.1250 (83.7500) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/29] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 0.8857 (0.6702) acc_x 78.1250 (82.5000) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [25/29] time 0.188 (0.176) data 0.111 (0.098) loss_x loss_x 0.7925 (0.7030) acc_x 78.1250 (81.5000) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/21] time 0.167 (0.175) data 0.089 (0.097) loss_u loss_u 0.8271 (0.7645) acc_u 18.7500 (30.0000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/21] time 0.188 (0.177) data 0.110 (0.099) loss_u loss_u 0.7041 (0.7291) acc_u 28.1250 (31.5625) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/21] time 0.175 (0.178) data 0.097 (0.101) loss_u loss_u 0.8584 (0.7399) acc_u 18.7500 (31.0417) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/21] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.8535 (0.7518) acc_u 15.6250 (29.2188) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 498
confident_label rate tensor(0.6009, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 971
clean true:970
clean false:1
clean_rate:0.9989701338825953
noisy true:148
noisy false:497
after delete: len(clean_dataset) 971
after delete: len(noisy_dataset) 645
epoch [35/200] batch [5/30] time 0.170 (0.170) data 0.092 (0.092) loss_x loss_x 0.9043 (0.8286) acc_x 81.2500 (79.3750) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/30] time 0.160 (0.173) data 0.083 (0.096) loss_x loss_x 0.9409 (0.7907) acc_x 68.7500 (78.1250) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/30] time 0.167 (0.171) data 0.090 (0.093) loss_x loss_x 0.9341 (0.7987) acc_x 75.0000 (77.9167) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/30] time 0.185 (0.173) data 0.108 (0.096) loss_x loss_x 0.5952 (0.8173) acc_x 81.2500 (77.5000) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [25/30] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 0.7437 (0.8019) acc_x 78.1250 (77.3750) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [30/30] time 0.186 (0.175) data 0.108 (0.098) loss_x loss_x 0.7275 (0.7886) acc_x 84.3750 (78.3333) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/20] time 0.187 (0.177) data 0.108 (0.099) loss_u loss_u 0.6875 (0.7601) acc_u 34.3750 (27.5000) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/20] time 0.190 (0.178) data 0.111 (0.100) loss_u loss_u 0.5786 (0.7558) acc_u 53.1250 (28.7500) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/20] time 0.188 (0.179) data 0.109 (0.101) loss_u loss_u 0.6377 (0.7565) acc_u 43.7500 (28.9583) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [20/20] time 0.188 (0.180) data 0.109 (0.102) loss_u loss_u 0.7573 (0.7524) acc_u 31.2500 (29.3750) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 519
confident_label rate tensor(0.5922, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 957
clean true:956
clean false:1
clean_rate:0.9989550679205852
noisy true:141
noisy false:518
after delete: len(clean_dataset) 957
after delete: len(noisy_dataset) 659
epoch [36/200] batch [5/29] time 0.167 (0.178) data 0.090 (0.100) loss_x loss_x 0.9839 (0.8405) acc_x 71.8750 (80.0000) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [10/29] time 0.159 (0.177) data 0.082 (0.099) loss_x loss_x 0.4846 (0.8120) acc_x 84.3750 (79.6875) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [15/29] time 0.180 (0.176) data 0.102 (0.098) loss_x loss_x 0.7437 (0.8202) acc_x 78.1250 (78.3333) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [20/29] time 0.178 (0.176) data 0.101 (0.098) loss_x loss_x 1.0293 (0.8109) acc_x 75.0000 (78.4375) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [25/29] time 0.176 (0.178) data 0.098 (0.100) loss_x loss_x 0.6226 (0.8014) acc_x 84.3750 (78.8750) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/20] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.8076 (0.7340) acc_u 25.0000 (31.2500) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/20] time 0.196 (0.179) data 0.117 (0.101) loss_u loss_u 0.8262 (0.7559) acc_u 21.8750 (29.3750) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/20] time 0.173 (0.179) data 0.095 (0.101) loss_u loss_u 0.7661 (0.7571) acc_u 28.1250 (28.9583) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [20/20] time 0.189 (0.179) data 0.111 (0.101) loss_u loss_u 0.8394 (0.7573) acc_u 21.8750 (29.3750) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 513
confident_label rate tensor(0.5984, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 967
clean true:966
clean false:1
clean_rate:0.9989658738366081
noisy true:137
noisy false:512
after delete: len(clean_dataset) 967
after delete: len(noisy_dataset) 649
epoch [37/200] batch [5/30] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.8105 (0.7846) acc_x 75.0000 (78.1250) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/30] time 0.185 (0.184) data 0.108 (0.106) loss_x loss_x 0.8525 (0.7481) acc_x 75.0000 (79.0625) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/30] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.7075 (0.7601) acc_x 81.2500 (78.9583) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/30] time 0.188 (0.185) data 0.111 (0.107) loss_x loss_x 0.6201 (0.7701) acc_x 90.6250 (80.1562) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [25/30] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.4678 (0.7639) acc_x 87.5000 (80.0000) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [30/30] time 0.190 (0.186) data 0.112 (0.108) loss_x loss_x 0.4746 (0.7198) acc_x 84.3750 (80.9375) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/20] time 0.186 (0.187) data 0.109 (0.110) loss_u loss_u 0.7886 (0.7729) acc_u 28.1250 (28.1250) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/20] time 0.186 (0.187) data 0.109 (0.110) loss_u loss_u 0.7197 (0.7647) acc_u 40.6250 (28.7500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/20] time 0.187 (0.187) data 0.110 (0.110) loss_u loss_u 0.7769 (0.7660) acc_u 28.1250 (28.1250) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [20/20] time 0.186 (0.187) data 0.108 (0.109) loss_u loss_u 0.7939 (0.7687) acc_u 25.0000 (28.1250) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.6089, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 984
clean true:984
clean false:0
clean_rate:1.0
noisy true:141
noisy false:491
after delete: len(clean_dataset) 984
after delete: len(noisy_dataset) 632
epoch [38/200] batch [5/30] time 0.159 (0.171) data 0.082 (0.093) loss_x loss_x 0.8296 (0.5766) acc_x 78.1250 (85.0000) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [10/30] time 0.179 (0.173) data 0.102 (0.095) loss_x loss_x 0.6055 (0.6768) acc_x 81.2500 (81.2500) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/30] time 0.178 (0.174) data 0.101 (0.097) loss_x loss_x 1.0547 (0.7216) acc_x 75.0000 (80.6250) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [20/30] time 0.179 (0.176) data 0.101 (0.098) loss_x loss_x 0.6499 (0.6984) acc_x 75.0000 (80.1562) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [25/30] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 0.8179 (0.7299) acc_x 84.3750 (79.8750) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [30/30] time 0.173 (0.175) data 0.095 (0.098) loss_x loss_x 0.4961 (0.7327) acc_x 81.2500 (79.5833) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/19] time 0.173 (0.175) data 0.095 (0.097) loss_u loss_u 0.6636 (0.7550) acc_u 40.6250 (29.3750) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/19] time 0.170 (0.175) data 0.092 (0.097) loss_u loss_u 0.8037 (0.7500) acc_u 18.7500 (28.4375) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/19] time 0.165 (0.175) data 0.087 (0.097) loss_u loss_u 0.8550 (0.7685) acc_u 18.7500 (26.6667) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 473
confident_label rate tensor(0.6188, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1000
clean true:998
clean false:2
clean_rate:0.998
noisy true:145
noisy false:471
after delete: len(clean_dataset) 1000
after delete: len(noisy_dataset) 616
epoch [39/200] batch [5/31] time 0.186 (0.174) data 0.108 (0.097) loss_x loss_x 0.6123 (0.7764) acc_x 81.2500 (79.3750) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [10/31] time 0.159 (0.172) data 0.080 (0.094) loss_x loss_x 0.5430 (0.7849) acc_x 87.5000 (80.0000) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [15/31] time 0.181 (0.171) data 0.103 (0.093) loss_x loss_x 0.3179 (0.7000) acc_x 90.6250 (82.2917) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [20/31] time 0.186 (0.173) data 0.107 (0.096) loss_x loss_x 0.6060 (0.6976) acc_x 78.1250 (81.7188) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [25/31] time 0.185 (0.176) data 0.108 (0.098) loss_x loss_x 0.9697 (0.7155) acc_x 75.0000 (81.0000) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [30/31] time 0.189 (0.177) data 0.110 (0.100) loss_x loss_x 0.6953 (0.7050) acc_x 75.0000 (81.4583) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/19] time 0.182 (0.179) data 0.104 (0.101) loss_u loss_u 0.8237 (0.7992) acc_u 18.7500 (23.1250) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/19] time 0.181 (0.178) data 0.103 (0.100) loss_u loss_u 0.7725 (0.8000) acc_u 21.8750 (22.1875) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/19] time 0.177 (0.178) data 0.099 (0.101) loss_u loss_u 0.7759 (0.7900) acc_u 21.8750 (23.7500) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 526
confident_label rate tensor(0.5903, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 954
clean true:953
clean false:1
clean_rate:0.9989517819706499
noisy true:137
noisy false:525
after delete: len(clean_dataset) 954
after delete: len(noisy_dataset) 662
epoch [40/200] batch [5/29] time 0.170 (0.179) data 0.093 (0.101) loss_x loss_x 1.2881 (0.8415) acc_x 71.8750 (78.7500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/29] time 0.169 (0.177) data 0.091 (0.099) loss_x loss_x 1.0898 (0.8460) acc_x 71.8750 (78.1250) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [15/29] time 0.182 (0.177) data 0.103 (0.099) loss_x loss_x 0.4475 (0.7605) acc_x 90.6250 (79.7917) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [20/29] time 0.170 (0.176) data 0.090 (0.098) loss_x loss_x 0.9458 (0.7673) acc_x 75.0000 (79.2188) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [25/29] time 0.172 (0.176) data 0.093 (0.098) loss_x loss_x 0.8140 (0.7841) acc_x 75.0000 (77.7500) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/20] time 0.208 (0.178) data 0.130 (0.100) loss_u loss_u 0.7422 (0.7430) acc_u 25.0000 (29.3750) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/20] time 0.166 (0.180) data 0.088 (0.102) loss_u loss_u 0.8301 (0.7514) acc_u 18.7500 (29.6875) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/20] time 0.170 (0.179) data 0.092 (0.101) loss_u loss_u 0.7666 (0.7463) acc_u 25.0000 (29.7917) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [20/20] time 0.166 (0.178) data 0.088 (0.100) loss_u loss_u 0.7925 (0.7470) acc_u 25.0000 (29.6875) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.5916, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 956
clean true:955
clean false:1
clean_rate:0.9989539748953975
noisy true:132
noisy false:528
after delete: len(clean_dataset) 956
after delete: len(noisy_dataset) 660
epoch [41/200] batch [5/29] time 0.218 (0.197) data 0.141 (0.119) loss_x loss_x 0.7725 (0.6944) acc_x 75.0000 (80.0000) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [10/29] time 0.171 (0.192) data 0.092 (0.114) loss_x loss_x 0.7725 (0.7097) acc_x 78.1250 (79.3750) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [15/29] time 0.179 (0.184) data 0.101 (0.107) loss_x loss_x 1.1484 (0.7223) acc_x 71.8750 (79.5833) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [20/29] time 0.178 (0.184) data 0.100 (0.106) loss_x loss_x 0.9253 (0.7941) acc_x 68.7500 (78.2812) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [25/29] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.5361 (0.7556) acc_x 84.3750 (79.5000) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/20] time 0.183 (0.184) data 0.105 (0.106) loss_u loss_u 0.6973 (0.7205) acc_u 34.3750 (32.5000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/20] time 0.185 (0.184) data 0.108 (0.106) loss_u loss_u 0.6875 (0.7185) acc_u 46.8750 (34.6875) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/20] time 0.178 (0.183) data 0.100 (0.105) loss_u loss_u 0.7261 (0.7226) acc_u 28.1250 (33.5417) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [20/20] time 0.160 (0.182) data 0.083 (0.104) loss_u loss_u 0.8042 (0.7328) acc_u 25.0000 (32.8125) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 489
confident_label rate tensor(0.6015, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 972
clean true:971
clean false:1
clean_rate:0.9989711934156379
noisy true:156
noisy false:488
after delete: len(clean_dataset) 972
after delete: len(noisy_dataset) 644
epoch [42/200] batch [5/30] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 1.1924 (0.7966) acc_x 75.0000 (81.8750) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/30] time 0.186 (0.182) data 0.107 (0.104) loss_x loss_x 0.5898 (0.7403) acc_x 84.3750 (80.9375) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/30] time 0.179 (0.180) data 0.102 (0.102) loss_x loss_x 0.8853 (0.7444) acc_x 75.0000 (80.4167) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/30] time 0.190 (0.180) data 0.113 (0.102) loss_x loss_x 0.7231 (0.7448) acc_x 84.3750 (79.2188) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [25/30] time 0.183 (0.179) data 0.105 (0.101) loss_x loss_x 0.6079 (0.7177) acc_x 87.5000 (80.0000) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [30/30] time 0.178 (0.179) data 0.100 (0.102) loss_x loss_x 0.6641 (0.6912) acc_x 84.3750 (81.0417) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/20] time 0.179 (0.179) data 0.101 (0.101) loss_u loss_u 0.7305 (0.7790) acc_u 34.3750 (28.7500) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/20] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.6108 (0.7608) acc_u 37.5000 (29.0625) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/20] time 0.175 (0.179) data 0.097 (0.101) loss_u loss_u 0.6895 (0.7494) acc_u 37.5000 (30.0000) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [20/20] time 0.160 (0.177) data 0.083 (0.100) loss_u loss_u 0.7588 (0.7602) acc_u 28.1250 (28.7500) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.6095, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 985
clean true:983
clean false:2
clean_rate:0.9979695431472081
noisy true:143
noisy false:488
after delete: len(clean_dataset) 985
after delete: len(noisy_dataset) 631
epoch [43/200] batch [5/30] time 0.197 (0.209) data 0.120 (0.131) loss_x loss_x 0.9033 (0.5956) acc_x 65.6250 (79.3750) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/30] time 0.169 (0.185) data 0.091 (0.108) loss_x loss_x 0.9058 (0.6081) acc_x 75.0000 (82.8125) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/30] time 0.159 (0.178) data 0.080 (0.100) loss_x loss_x 1.0781 (0.6985) acc_x 78.1250 (80.0000) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [20/30] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.5596 (0.6725) acc_x 81.2500 (80.6250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [25/30] time 0.171 (0.176) data 0.094 (0.098) loss_x loss_x 1.0576 (0.7425) acc_x 71.8750 (79.5000) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [30/30] time 0.169 (0.177) data 0.091 (0.099) loss_x loss_x 0.6455 (0.7557) acc_x 78.1250 (79.3750) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/19] time 0.171 (0.177) data 0.093 (0.099) loss_u loss_u 0.7471 (0.7101) acc_u 25.0000 (31.2500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/19] time 0.178 (0.176) data 0.100 (0.098) loss_u loss_u 0.7334 (0.7358) acc_u 34.3750 (30.0000) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/19] time 0.200 (0.178) data 0.122 (0.100) loss_u loss_u 0.6235 (0.7353) acc_u 40.6250 (30.2083) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 475
confident_label rate tensor(0.6145, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 993
clean true:992
clean false:1
clean_rate:0.998992950654582
noisy true:149
noisy false:474
after delete: len(clean_dataset) 993
after delete: len(noisy_dataset) 623
epoch [44/200] batch [5/31] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.6440 (0.7394) acc_x 78.1250 (78.7500) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [10/31] time 0.183 (0.185) data 0.105 (0.108) loss_x loss_x 0.4373 (0.7947) acc_x 90.6250 (77.5000) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [15/31] time 0.159 (0.183) data 0.081 (0.106) loss_x loss_x 0.6147 (0.7602) acc_x 90.6250 (79.7917) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [20/31] time 0.197 (0.182) data 0.119 (0.105) loss_x loss_x 0.4802 (0.7374) acc_x 87.5000 (80.3125) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [25/31] time 0.161 (0.180) data 0.084 (0.102) loss_x loss_x 0.4497 (0.6877) acc_x 90.6250 (81.2500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [30/31] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.7734 (0.6869) acc_x 78.1250 (81.1458) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/19] time 0.175 (0.177) data 0.097 (0.099) loss_u loss_u 0.7783 (0.7754) acc_u 25.0000 (27.5000) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/19] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.6831 (0.7760) acc_u 43.7500 (27.5000) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/19] time 0.169 (0.177) data 0.091 (0.099) loss_u loss_u 0.7666 (0.7670) acc_u 28.1250 (28.3333) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 488
confident_label rate tensor(0.6114, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 988
clean true:986
clean false:2
clean_rate:0.9979757085020243
noisy true:142
noisy false:486
after delete: len(clean_dataset) 988
after delete: len(noisy_dataset) 628
epoch [45/200] batch [5/30] time 0.162 (0.166) data 0.085 (0.089) loss_x loss_x 0.7021 (0.7720) acc_x 87.5000 (78.7500) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/30] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.9062 (0.7044) acc_x 71.8750 (80.6250) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [15/30] time 0.162 (0.170) data 0.085 (0.093) loss_x loss_x 0.7227 (0.6193) acc_x 78.1250 (82.5000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/30] time 0.166 (0.171) data 0.089 (0.093) loss_x loss_x 0.8149 (0.6293) acc_x 81.2500 (82.5000) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [25/30] time 0.180 (0.172) data 0.102 (0.094) loss_x loss_x 0.5269 (0.6338) acc_x 87.5000 (83.1250) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [30/30] time 0.182 (0.174) data 0.105 (0.096) loss_x loss_x 0.6050 (0.6405) acc_x 78.1250 (82.2917) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/19] time 0.190 (0.175) data 0.111 (0.097) loss_u loss_u 0.7598 (0.7683) acc_u 31.2500 (28.7500) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/19] time 0.181 (0.176) data 0.102 (0.098) loss_u loss_u 0.7461 (0.7478) acc_u 28.1250 (29.6875) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/19] time 0.188 (0.177) data 0.109 (0.099) loss_u loss_u 0.8037 (0.7436) acc_u 21.8750 (30.4167) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 479
confident_label rate tensor(0.6108, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 987
clean true:986
clean false:1
clean_rate:0.9989868287740629
noisy true:151
noisy false:478
after delete: len(clean_dataset) 987
after delete: len(noisy_dataset) 629
epoch [46/200] batch [5/30] time 0.164 (0.172) data 0.087 (0.094) loss_x loss_x 0.5723 (0.7651) acc_x 90.6250 (82.5000) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [10/30] time 0.158 (0.172) data 0.080 (0.094) loss_x loss_x 1.1270 (0.7685) acc_x 75.0000 (79.6875) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/30] time 0.163 (0.169) data 0.084 (0.092) loss_x loss_x 1.0156 (0.7403) acc_x 71.8750 (80.0000) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/30] time 0.169 (0.171) data 0.092 (0.093) loss_x loss_x 0.3857 (0.7276) acc_x 87.5000 (80.9375) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [25/30] time 0.171 (0.171) data 0.093 (0.093) loss_x loss_x 0.6353 (0.6939) acc_x 84.3750 (81.3750) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [30/30] time 0.175 (0.173) data 0.096 (0.095) loss_x loss_x 0.8813 (0.7005) acc_x 71.8750 (80.6250) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/19] time 0.184 (0.174) data 0.106 (0.096) loss_u loss_u 0.7920 (0.7743) acc_u 25.0000 (26.2500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/19] time 0.187 (0.174) data 0.109 (0.097) loss_u loss_u 0.7041 (0.7518) acc_u 34.3750 (29.6875) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/19] time 0.190 (0.176) data 0.112 (0.098) loss_u loss_u 0.7578 (0.7520) acc_u 31.2500 (29.7917) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.6071, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 981
clean true:980
clean false:1
clean_rate:0.9989806320081549
noisy true:143
noisy false:492
after delete: len(clean_dataset) 981
after delete: len(noisy_dataset) 635
epoch [47/200] batch [5/30] time 0.169 (0.180) data 0.092 (0.102) loss_x loss_x 0.6113 (0.5892) acc_x 75.0000 (83.7500) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [10/30] time 0.161 (0.170) data 0.083 (0.092) loss_x loss_x 0.4148 (0.5989) acc_x 87.5000 (82.1875) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/30] time 0.170 (0.174) data 0.092 (0.097) loss_x loss_x 0.3857 (0.5636) acc_x 84.3750 (82.7083) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/30] time 0.166 (0.172) data 0.088 (0.094) loss_x loss_x 0.4993 (0.5842) acc_x 84.3750 (82.9688) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [25/30] time 0.171 (0.171) data 0.093 (0.093) loss_x loss_x 0.5205 (0.5738) acc_x 87.5000 (83.5000) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [30/30] time 0.179 (0.171) data 0.102 (0.094) loss_x loss_x 0.7930 (0.5972) acc_x 78.1250 (83.4375) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/19] time 0.185 (0.171) data 0.108 (0.094) loss_u loss_u 0.7808 (0.7760) acc_u 28.1250 (28.1250) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/19] time 0.187 (0.173) data 0.108 (0.096) loss_u loss_u 0.6816 (0.7432) acc_u 34.3750 (30.6250) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/19] time 0.185 (0.175) data 0.107 (0.097) loss_u loss_u 0.6694 (0.7354) acc_u 43.7500 (31.2500) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.6058, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 979
clean true:978
clean false:1
clean_rate:0.9989785495403473
noisy true:145
noisy false:492
after delete: len(clean_dataset) 979
after delete: len(noisy_dataset) 637
epoch [48/200] batch [5/30] time 0.181 (0.181) data 0.104 (0.103) loss_x loss_x 0.4890 (0.5882) acc_x 93.7500 (84.3750) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/30] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 0.9766 (0.6761) acc_x 68.7500 (80.0000) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/30] time 0.195 (0.186) data 0.117 (0.108) loss_x loss_x 0.5371 (0.7324) acc_x 87.5000 (79.5833) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/30] time 0.185 (0.186) data 0.108 (0.108) loss_x loss_x 1.0459 (0.7415) acc_x 78.1250 (79.5312) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [25/30] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.5098 (0.7293) acc_x 90.6250 (80.1250) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [30/30] time 0.208 (0.187) data 0.131 (0.110) loss_x loss_x 0.8740 (0.7205) acc_x 75.0000 (80.2083) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/19] time 0.182 (0.187) data 0.105 (0.109) loss_u loss_u 0.7827 (0.6948) acc_u 31.2500 (37.5000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/19] time 0.187 (0.187) data 0.109 (0.109) loss_u loss_u 0.8208 (0.6924) acc_u 25.0000 (36.2500) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/19] time 0.179 (0.186) data 0.101 (0.109) loss_u loss_u 0.6826 (0.7047) acc_u 31.2500 (34.7917) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 489
confident_label rate tensor(0.6077, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 982
clean true:981
clean false:1
clean_rate:0.9989816700610998
noisy true:146
noisy false:488
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 634
epoch [49/200] batch [5/30] time 0.174 (0.176) data 0.096 (0.098) loss_x loss_x 0.8311 (0.7441) acc_x 78.1250 (80.0000) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [10/30] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.7837 (0.7158) acc_x 81.2500 (81.2500) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [15/30] time 0.183 (0.179) data 0.106 (0.101) loss_x loss_x 0.7241 (0.7190) acc_x 75.0000 (79.3750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [20/30] time 0.166 (0.178) data 0.088 (0.100) loss_x loss_x 0.3809 (0.6840) acc_x 93.7500 (80.7812) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [25/30] time 0.208 (0.179) data 0.131 (0.102) loss_x loss_x 0.5425 (0.6810) acc_x 84.3750 (80.6250) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [30/30] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.6572 (0.6927) acc_x 81.2500 (80.7292) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/19] time 0.163 (0.178) data 0.086 (0.100) loss_u loss_u 0.6997 (0.6987) acc_u 37.5000 (36.8750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/19] time 0.177 (0.178) data 0.099 (0.100) loss_u loss_u 0.7358 (0.7203) acc_u 31.2500 (33.1250) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/19] time 0.175 (0.177) data 0.097 (0.099) loss_u loss_u 0.7563 (0.7381) acc_u 28.1250 (30.8333) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.6163, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 996
clean true:995
clean false:1
clean_rate:0.998995983935743
noisy true:141
noisy false:479
after delete: len(clean_dataset) 996
after delete: len(noisy_dataset) 620
epoch [50/200] batch [5/31] time 0.162 (0.180) data 0.084 (0.103) loss_x loss_x 0.7744 (0.6603) acc_x 75.0000 (81.8750) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [10/31] time 0.175 (0.174) data 0.098 (0.096) loss_x loss_x 0.8726 (0.6992) acc_x 71.8750 (80.3125) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/31] time 0.169 (0.174) data 0.091 (0.096) loss_x loss_x 0.5698 (0.6699) acc_x 87.5000 (81.0417) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [20/31] time 0.185 (0.177) data 0.107 (0.099) loss_x loss_x 0.3826 (0.6860) acc_x 87.5000 (80.4688) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [25/31] time 0.184 (0.178) data 0.106 (0.100) loss_x loss_x 0.6992 (0.6846) acc_x 78.1250 (80.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/31] time 0.183 (0.179) data 0.106 (0.101) loss_x loss_x 0.9673 (0.6951) acc_x 75.0000 (80.6250) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/19] time 0.186 (0.180) data 0.108 (0.102) loss_u loss_u 0.6621 (0.7526) acc_u 40.6250 (29.3750) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/19] time 0.183 (0.181) data 0.106 (0.103) loss_u loss_u 0.6519 (0.7364) acc_u 43.7500 (31.2500) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/19] time 0.183 (0.181) data 0.106 (0.103) loss_u loss_u 0.7236 (0.7362) acc_u 31.2500 (31.2500) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.6046, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 977
clean true:976
clean false:1
clean_rate:0.9989764585465711
noisy true:143
noisy false:496
after delete: len(clean_dataset) 977
after delete: len(noisy_dataset) 639
epoch [51/200] batch [5/30] time 0.176 (0.177) data 0.098 (0.099) loss_x loss_x 0.7622 (0.8340) acc_x 87.5000 (80.0000) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/30] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.5996 (0.7610) acc_x 87.5000 (81.8750) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [15/30] time 0.183 (0.183) data 0.106 (0.105) loss_x loss_x 0.9072 (0.7411) acc_x 81.2500 (82.2917) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [20/30] time 0.188 (0.184) data 0.111 (0.106) loss_x loss_x 0.7695 (0.7401) acc_x 75.0000 (82.0312) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [25/30] time 0.185 (0.184) data 0.107 (0.106) loss_x loss_x 0.6553 (0.7410) acc_x 84.3750 (81.7500) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [30/30] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8994 (0.7378) acc_x 78.1250 (81.8750) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/19] time 0.185 (0.185) data 0.107 (0.107) loss_u loss_u 0.7241 (0.7646) acc_u 37.5000 (26.8750) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/19] time 0.185 (0.185) data 0.107 (0.107) loss_u loss_u 0.7246 (0.7437) acc_u 28.1250 (30.0000) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/19] time 0.184 (0.185) data 0.106 (0.107) loss_u loss_u 0.8574 (0.7599) acc_u 15.6250 (27.7083) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 487
confident_label rate tensor(0.6132, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 991
clean true:990
clean false:1
clean_rate:0.9989909182643795
noisy true:139
noisy false:486
after delete: len(clean_dataset) 991
after delete: len(noisy_dataset) 625
epoch [52/200] batch [5/30] time 0.167 (0.180) data 0.089 (0.102) loss_x loss_x 0.4333 (0.5844) acc_x 87.5000 (83.7500) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/30] time 0.218 (0.184) data 0.141 (0.106) loss_x loss_x 1.0459 (0.6136) acc_x 75.0000 (83.1250) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/30] time 0.187 (0.183) data 0.109 (0.106) loss_x loss_x 0.5020 (0.6433) acc_x 87.5000 (83.1250) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [20/30] time 0.186 (0.184) data 0.108 (0.106) loss_x loss_x 0.3328 (0.6464) acc_x 96.8750 (84.0625) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [25/30] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.7378 (0.6575) acc_x 84.3750 (83.8750) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [30/30] time 0.186 (0.185) data 0.108 (0.107) loss_x loss_x 0.7227 (0.6726) acc_x 81.2500 (83.1250) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/19] time 0.183 (0.185) data 0.105 (0.108) loss_u loss_u 0.8306 (0.7372) acc_u 15.6250 (30.0000) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/19] time 0.186 (0.186) data 0.109 (0.108) loss_u loss_u 0.6812 (0.7516) acc_u 37.5000 (28.7500) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/19] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.7695 (0.7435) acc_u 25.0000 (28.9583) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.6157, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 995
clean true:994
clean false:1
clean_rate:0.9989949748743718
noisy true:146
noisy false:475
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 621
epoch [53/200] batch [5/31] time 0.162 (0.162) data 0.084 (0.084) loss_x loss_x 0.6147 (0.7036) acc_x 84.3750 (83.1250) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/31] time 0.182 (0.169) data 0.105 (0.092) loss_x loss_x 0.3848 (0.7018) acc_x 90.6250 (82.8125) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/31] time 0.185 (0.174) data 0.108 (0.096) loss_x loss_x 1.0078 (0.7040) acc_x 75.0000 (82.7083) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [20/31] time 0.178 (0.175) data 0.098 (0.098) loss_x loss_x 0.5200 (0.6462) acc_x 81.2500 (84.2188) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [25/31] time 0.177 (0.177) data 0.099 (0.099) loss_x loss_x 0.7324 (0.6466) acc_x 78.1250 (83.8750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/31] time 0.175 (0.176) data 0.097 (0.098) loss_x loss_x 0.7012 (0.6399) acc_x 84.3750 (84.0625) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/19] time 0.183 (0.178) data 0.105 (0.100) loss_u loss_u 0.8345 (0.7745) acc_u 21.8750 (26.2500) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/19] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.8750 (0.7670) acc_u 9.3750 (27.5000) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/19] time 0.183 (0.180) data 0.103 (0.102) loss_u loss_u 0.7266 (0.7641) acc_u 28.1250 (27.5000) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 448
confident_label rate tensor(0.6324, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1022
clean true:1022
clean false:0
clean_rate:1.0
noisy true:146
noisy false:448
after delete: len(clean_dataset) 1022
after delete: len(noisy_dataset) 594
epoch [54/200] batch [5/31] time 0.184 (0.186) data 0.106 (0.108) loss_x loss_x 0.5396 (0.6339) acc_x 87.5000 (82.5000) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/31] time 0.187 (0.188) data 0.110 (0.110) loss_x loss_x 0.5454 (0.7104) acc_x 78.1250 (80.3125) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/31] time 0.171 (0.184) data 0.093 (0.106) loss_x loss_x 0.9268 (0.7118) acc_x 81.2500 (80.8333) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/31] time 0.168 (0.182) data 0.091 (0.104) loss_x loss_x 0.9639 (0.7514) acc_x 81.2500 (80.3125) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [25/31] time 0.181 (0.181) data 0.103 (0.104) loss_x loss_x 0.1970 (0.7108) acc_x 96.8750 (82.1250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/31] time 0.162 (0.179) data 0.084 (0.102) loss_x loss_x 0.6558 (0.7087) acc_x 81.2500 (81.5625) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/18] time 0.173 (0.179) data 0.095 (0.101) loss_u loss_u 0.6943 (0.7137) acc_u 37.5000 (33.1250) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/18] time 0.167 (0.178) data 0.089 (0.100) loss_u loss_u 0.7798 (0.7407) acc_u 25.0000 (28.7500) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/18] time 0.189 (0.178) data 0.112 (0.100) loss_u loss_u 0.7080 (0.7438) acc_u 28.1250 (28.5417) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.6238, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1008
clean true:1007
clean false:1
clean_rate:0.9990079365079365
noisy true:145
noisy false:463
after delete: len(clean_dataset) 1008
after delete: len(noisy_dataset) 608
epoch [55/200] batch [5/31] time 0.189 (0.172) data 0.112 (0.094) loss_x loss_x 0.3157 (0.7752) acc_x 90.6250 (76.8750) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [10/31] time 0.170 (0.171) data 0.093 (0.094) loss_x loss_x 0.9160 (0.8134) acc_x 68.7500 (77.8125) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/31] time 0.160 (0.173) data 0.083 (0.096) loss_x loss_x 0.5464 (0.8578) acc_x 78.1250 (77.0833) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/31] time 0.181 (0.176) data 0.104 (0.098) loss_x loss_x 0.8003 (0.8553) acc_x 81.2500 (77.1875) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [25/31] time 0.170 (0.175) data 0.092 (0.098) loss_x loss_x 0.5127 (0.8533) acc_x 84.3750 (76.8750) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/31] time 0.167 (0.174) data 0.090 (0.096) loss_x loss_x 0.6611 (0.8216) acc_x 84.3750 (77.6042) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/19] time 0.170 (0.174) data 0.091 (0.096) loss_u loss_u 0.6973 (0.7216) acc_u 37.5000 (33.7500) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/19] time 0.175 (0.174) data 0.097 (0.096) loss_u loss_u 0.6924 (0.7307) acc_u 37.5000 (31.2500) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/19] time 0.196 (0.174) data 0.119 (0.097) loss_u loss_u 0.7700 (0.7452) acc_u 25.0000 (29.5833) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 460
confident_label rate tensor(0.6219, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1005
clean true:1004
clean false:1
clean_rate:0.9990049751243781
noisy true:152
noisy false:459
after delete: len(clean_dataset) 1005
after delete: len(noisy_dataset) 611
epoch [56/200] batch [5/31] time 0.188 (0.172) data 0.110 (0.094) loss_x loss_x 0.4319 (0.7117) acc_x 90.6250 (80.0000) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [10/31] time 0.185 (0.179) data 0.107 (0.102) loss_x loss_x 1.1152 (0.6911) acc_x 65.6250 (79.6875) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [15/31] time 0.185 (0.182) data 0.108 (0.104) loss_x loss_x 0.5615 (0.6714) acc_x 90.6250 (80.2083) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/31] time 0.195 (0.183) data 0.117 (0.106) loss_x loss_x 0.6191 (0.6966) acc_x 78.1250 (79.2188) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [25/31] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.6953 (0.6842) acc_x 81.2500 (79.2500) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [30/31] time 0.177 (0.184) data 0.099 (0.106) loss_x loss_x 0.2374 (0.6625) acc_x 96.8750 (80.4167) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/19] time 0.173 (0.183) data 0.096 (0.106) loss_u loss_u 0.7456 (0.7247) acc_u 31.2500 (35.0000) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/19] time 0.188 (0.183) data 0.110 (0.105) loss_u loss_u 0.7812 (0.7264) acc_u 21.8750 (34.0625) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/19] time 0.160 (0.182) data 0.082 (0.104) loss_u loss_u 0.8159 (0.7343) acc_u 18.7500 (31.8750) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 456
confident_label rate tensor(0.6337, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1024
clean true:1024
clean false:0
clean_rate:1.0
noisy true:136
noisy false:456
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 592
epoch [57/200] batch [5/32] time 0.206 (0.181) data 0.128 (0.103) loss_x loss_x 0.5820 (0.6882) acc_x 78.1250 (82.5000) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/32] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.4336 (0.6820) acc_x 90.6250 (82.8125) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/32] time 0.184 (0.181) data 0.106 (0.104) loss_x loss_x 0.7671 (0.7382) acc_x 81.2500 (81.2500) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/32] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.5181 (0.7127) acc_x 84.3750 (81.4062) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/32] time 0.191 (0.179) data 0.112 (0.102) loss_x loss_x 0.9360 (0.7186) acc_x 75.0000 (81.2500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [30/32] time 0.166 (0.178) data 0.088 (0.100) loss_x loss_x 0.9741 (0.7511) acc_x 78.1250 (80.5208) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/18] time 0.182 (0.178) data 0.105 (0.100) loss_u loss_u 0.7109 (0.7515) acc_u 40.6250 (30.6250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/18] time 0.169 (0.177) data 0.091 (0.100) loss_u loss_u 0.6479 (0.7119) acc_u 43.7500 (35.6250) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/18] time 0.174 (0.177) data 0.096 (0.099) loss_u loss_u 0.7466 (0.7356) acc_u 28.1250 (32.2917) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 434
confident_label rate tensor(0.6417, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1037
clean true:1036
clean false:1
clean_rate:0.9990356798457087
noisy true:146
noisy false:433
after delete: len(clean_dataset) 1037
after delete: len(noisy_dataset) 579
epoch [58/200] batch [5/32] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.1826 (0.6603) acc_x 96.8750 (82.5000) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/32] time 0.178 (0.182) data 0.100 (0.105) loss_x loss_x 0.6475 (0.6354) acc_x 84.3750 (84.0625) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [15/32] time 0.170 (0.181) data 0.093 (0.103) loss_x loss_x 0.7793 (0.6587) acc_x 81.2500 (83.5417) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/32] time 0.161 (0.180) data 0.084 (0.102) loss_x loss_x 0.5425 (0.6870) acc_x 87.5000 (82.9688) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/32] time 0.183 (0.178) data 0.105 (0.101) loss_x loss_x 1.2285 (0.6947) acc_x 71.8750 (82.5000) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/32] time 0.170 (0.178) data 0.092 (0.100) loss_x loss_x 0.9780 (0.7108) acc_x 75.0000 (81.9792) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/18] time 0.170 (0.177) data 0.092 (0.100) loss_u loss_u 0.6816 (0.6894) acc_u 40.6250 (37.5000) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/18] time 0.171 (0.177) data 0.092 (0.099) loss_u loss_u 0.5645 (0.7067) acc_u 50.0000 (35.3125) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/18] time 0.165 (0.176) data 0.087 (0.098) loss_u loss_u 0.7773 (0.7254) acc_u 34.3750 (32.9167) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 430
confident_label rate tensor(0.6460, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1044
clean true:1043
clean false:1
clean_rate:0.9990421455938697
noisy true:143
noisy false:429
after delete: len(clean_dataset) 1044
after delete: len(noisy_dataset) 572
epoch [59/200] batch [5/32] time 0.165 (0.180) data 0.087 (0.102) loss_x loss_x 0.8516 (0.6330) acc_x 81.2500 (84.3750) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [10/32] time 0.178 (0.180) data 0.100 (0.102) loss_x loss_x 0.8086 (0.6349) acc_x 75.0000 (82.8125) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/32] time 0.179 (0.177) data 0.101 (0.100) loss_x loss_x 0.8452 (0.6568) acc_x 81.2500 (82.2917) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/32] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.8853 (0.6892) acc_x 75.0000 (81.0938) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [25/32] time 0.169 (0.176) data 0.092 (0.098) loss_x loss_x 1.0127 (0.7332) acc_x 75.0000 (79.8750) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/32] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.5327 (0.7312) acc_x 84.3750 (79.7917) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/17] time 0.167 (0.176) data 0.089 (0.098) loss_u loss_u 0.6992 (0.7336) acc_u 37.5000 (30.6250) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/17] time 0.195 (0.176) data 0.117 (0.099) loss_u loss_u 0.7778 (0.7615) acc_u 28.1250 (27.1875) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/17] time 0.186 (0.177) data 0.107 (0.100) loss_u loss_u 0.7017 (0.7529) acc_u 37.5000 (28.7500) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 446
confident_label rate tensor(0.6318, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1021
clean true:1019
clean false:2
clean_rate:0.9980411361410382
noisy true:151
noisy false:444
after delete: len(clean_dataset) 1021
after delete: len(noisy_dataset) 595
epoch [60/200] batch [5/31] time 0.215 (0.194) data 0.137 (0.117) loss_x loss_x 0.6997 (0.6486) acc_x 81.2500 (82.5000) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [10/31] time 0.184 (0.190) data 0.107 (0.113) loss_x loss_x 0.6338 (0.6633) acc_x 87.5000 (83.1250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/31] time 0.185 (0.189) data 0.108 (0.111) loss_x loss_x 0.9565 (0.6483) acc_x 81.2500 (83.1250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [20/31] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.7397 (0.6431) acc_x 81.2500 (83.1250) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/31] time 0.185 (0.188) data 0.107 (0.111) loss_x loss_x 0.7412 (0.6658) acc_x 78.1250 (82.1250) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [30/31] time 0.187 (0.188) data 0.110 (0.110) loss_x loss_x 0.5518 (0.6628) acc_x 81.2500 (82.8125) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/18] time 0.185 (0.188) data 0.108 (0.110) loss_u loss_u 0.7207 (0.7413) acc_u 37.5000 (31.8750) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/18] time 0.164 (0.186) data 0.086 (0.108) loss_u loss_u 0.8135 (0.7351) acc_u 25.0000 (32.1875) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [15/18] time 0.186 (0.185) data 0.108 (0.107) loss_u loss_u 0.7012 (0.7168) acc_u 34.3750 (33.3333) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 457
confident_label rate tensor(0.6275, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1014
clean true:1012
clean false:2
clean_rate:0.9980276134122288
noisy true:147
noisy false:455
after delete: len(clean_dataset) 1014
after delete: len(noisy_dataset) 602
epoch [61/200] batch [5/31] time 0.169 (0.180) data 0.091 (0.103) loss_x loss_x 0.5620 (0.6421) acc_x 81.2500 (81.2500) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/31] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.7295 (0.7013) acc_x 81.2500 (80.6250) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/31] time 0.187 (0.181) data 0.109 (0.103) loss_x loss_x 0.9961 (0.6991) acc_x 75.0000 (80.2083) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/31] time 0.185 (0.182) data 0.108 (0.104) loss_x loss_x 0.7275 (0.6890) acc_x 81.2500 (80.6250) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [25/31] time 0.186 (0.183) data 0.109 (0.105) loss_x loss_x 0.7451 (0.6988) acc_x 81.2500 (80.5000) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/31] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.7368 (0.6825) acc_x 84.3750 (80.9375) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/18] time 0.192 (0.185) data 0.113 (0.107) loss_u loss_u 0.5938 (0.7277) acc_u 46.8750 (31.8750) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/18] time 0.192 (0.185) data 0.114 (0.108) loss_u loss_u 0.6646 (0.7180) acc_u 31.2500 (31.2500) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/18] time 0.165 (0.185) data 0.088 (0.107) loss_u loss_u 0.7783 (0.7163) acc_u 28.1250 (31.8750) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 435
confident_label rate tensor(0.6349, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1026
clean true:1026
clean false:0
clean_rate:1.0
noisy true:155
noisy false:435
after delete: len(clean_dataset) 1026
after delete: len(noisy_dataset) 590
epoch [62/200] batch [5/32] time 0.168 (0.178) data 0.091 (0.100) loss_x loss_x 1.2793 (0.8411) acc_x 78.1250 (80.0000) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [10/32] time 0.177 (0.177) data 0.099 (0.099) loss_x loss_x 0.4407 (0.6912) acc_x 87.5000 (82.5000) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/32] time 0.185 (0.176) data 0.107 (0.099) loss_x loss_x 0.7065 (0.6911) acc_x 71.8750 (81.4583) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/32] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.4885 (0.6685) acc_x 87.5000 (82.6562) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/32] time 0.187 (0.178) data 0.109 (0.101) loss_x loss_x 0.7373 (0.6378) acc_x 78.1250 (83.6250) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/32] time 0.186 (0.180) data 0.108 (0.102) loss_x loss_x 0.7339 (0.6350) acc_x 75.0000 (83.3333) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/18] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.7378 (0.7460) acc_u 40.6250 (31.2500) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/18] time 0.165 (0.178) data 0.087 (0.100) loss_u loss_u 0.6948 (0.7246) acc_u 34.3750 (31.8750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/18] time 0.186 (0.179) data 0.107 (0.101) loss_u loss_u 0.7119 (0.7275) acc_u 37.5000 (31.8750) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.6250, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1010
clean true:1010
clean false:0
clean_rate:1.0
noisy true:142
noisy false:464
after delete: len(clean_dataset) 1010
after delete: len(noisy_dataset) 606
epoch [63/200] batch [5/31] time 0.182 (0.174) data 0.105 (0.096) loss_x loss_x 0.5361 (0.6880) acc_x 90.6250 (83.1250) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [10/31] time 0.166 (0.172) data 0.089 (0.094) loss_x loss_x 0.8164 (0.6402) acc_x 78.1250 (85.6250) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/31] time 0.172 (0.174) data 0.094 (0.097) loss_x loss_x 0.8623 (0.6550) acc_x 71.8750 (83.7500) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/31] time 0.175 (0.176) data 0.098 (0.098) loss_x loss_x 0.4844 (0.6565) acc_x 84.3750 (83.1250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/31] time 0.171 (0.175) data 0.092 (0.097) loss_x loss_x 0.6206 (0.6714) acc_x 90.6250 (82.2500) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/31] time 0.176 (0.175) data 0.097 (0.097) loss_x loss_x 0.1786 (0.6507) acc_x 93.7500 (82.3958) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/18] time 0.189 (0.176) data 0.111 (0.098) loss_u loss_u 0.7866 (0.7156) acc_u 31.2500 (35.6250) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/18] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.7510 (0.6911) acc_u 31.2500 (37.1875) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/18] time 0.174 (0.178) data 0.095 (0.100) loss_u loss_u 0.7803 (0.6962) acc_u 31.2500 (36.2500) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 435
confident_label rate tensor(0.6467, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1045
clean true:1043
clean false:2
clean_rate:0.9980861244019139
noisy true:138
noisy false:433
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 571
epoch [64/200] batch [5/32] time 0.183 (0.181) data 0.105 (0.103) loss_x loss_x 0.7417 (0.7126) acc_x 84.3750 (81.8750) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/32] time 0.170 (0.177) data 0.092 (0.100) loss_x loss_x 0.5537 (0.7026) acc_x 81.2500 (81.2500) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/32] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.6133 (0.6979) acc_x 78.1250 (80.8333) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/32] time 0.182 (0.178) data 0.104 (0.100) loss_x loss_x 0.6362 (0.7139) acc_x 84.3750 (80.9375) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/32] time 0.182 (0.177) data 0.105 (0.099) loss_x loss_x 0.9980 (0.7358) acc_x 75.0000 (80.1250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/32] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.6152 (0.7196) acc_x 81.2500 (79.7917) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/17] time 0.197 (0.176) data 0.119 (0.099) loss_u loss_u 0.6743 (0.7165) acc_u 34.3750 (30.0000) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/17] time 0.186 (0.176) data 0.108 (0.099) loss_u loss_u 0.7080 (0.7392) acc_u 31.2500 (29.6875) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/17] time 0.189 (0.177) data 0.110 (0.099) loss_u loss_u 0.8398 (0.7435) acc_u 25.0000 (30.2083) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.6368, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1029
clean true:1028
clean false:1
clean_rate:0.9990281827016521
noisy true:147
noisy false:440
after delete: len(clean_dataset) 1029
after delete: len(noisy_dataset) 587
epoch [65/200] batch [5/32] time 0.186 (0.191) data 0.109 (0.114) loss_x loss_x 0.8535 (0.6406) acc_x 78.1250 (85.0000) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/32] time 0.187 (0.189) data 0.110 (0.112) loss_x loss_x 0.5786 (0.6013) acc_x 87.5000 (86.2500) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/32] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 0.5410 (0.6081) acc_x 84.3750 (85.8333) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/32] time 0.185 (0.188) data 0.108 (0.110) loss_x loss_x 0.6260 (0.6013) acc_x 81.2500 (85.0000) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/32] time 0.191 (0.188) data 0.113 (0.110) loss_x loss_x 1.1377 (0.6382) acc_x 68.7500 (83.7500) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [30/32] time 0.269 (0.191) data 0.191 (0.114) loss_x loss_x 0.7783 (0.6817) acc_x 75.0000 (82.1875) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/18] time 0.191 (0.193) data 0.113 (0.116) loss_u loss_u 0.6470 (0.7732) acc_u 40.6250 (26.8750) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/18] time 0.549 (0.202) data 0.470 (0.124) loss_u loss_u 0.6719 (0.7540) acc_u 37.5000 (28.4375) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/18] time 0.169 (0.208) data 0.091 (0.130) loss_u loss_u 0.8794 (0.7644) acc_u 15.6250 (27.7083) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 439
confident_label rate tensor(0.6374, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1030
clean true:1029
clean false:1
clean_rate:0.9990291262135922
noisy true:148
noisy false:438
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 586
epoch [66/200] batch [5/32] time 0.177 (0.185) data 0.099 (0.107) loss_x loss_x 1.2402 (0.8088) acc_x 68.7500 (76.8750) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [10/32] time 0.203 (0.184) data 0.126 (0.107) loss_x loss_x 0.8779 (0.6843) acc_x 78.1250 (80.6250) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/32] time 0.172 (0.181) data 0.094 (0.103) loss_x loss_x 0.8921 (0.6793) acc_x 78.1250 (80.0000) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/32] time 0.164 (0.179) data 0.087 (0.101) loss_x loss_x 0.5044 (0.7071) acc_x 84.3750 (80.1562) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/32] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 1.0293 (0.6884) acc_x 71.8750 (80.3750) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/32] time 0.186 (0.179) data 0.109 (0.101) loss_x loss_x 0.8833 (0.6685) acc_x 78.1250 (81.2500) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/18] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8506 (0.7403) acc_u 21.8750 (31.8750) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/18] time 0.161 (0.179) data 0.083 (0.102) loss_u loss_u 0.6538 (0.7295) acc_u 50.0000 (33.7500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/18] time 0.217 (0.180) data 0.139 (0.102) loss_u loss_u 0.7983 (0.7387) acc_u 25.0000 (32.5000) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.6256, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1011
clean true:1011
clean false:0
clean_rate:1.0
noisy true:152
noisy false:453
after delete: len(clean_dataset) 1011
after delete: len(noisy_dataset) 605
epoch [67/200] batch [5/31] time 0.163 (0.186) data 0.086 (0.109) loss_x loss_x 0.5186 (0.6227) acc_x 84.3750 (81.2500) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/31] time 0.233 (0.184) data 0.156 (0.106) loss_x loss_x 0.3491 (0.5971) acc_x 93.7500 (82.8125) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/31] time 0.169 (0.180) data 0.092 (0.102) loss_x loss_x 0.6714 (0.7195) acc_x 78.1250 (80.6250) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/31] time 0.181 (0.178) data 0.101 (0.100) loss_x loss_x 0.7021 (0.7379) acc_x 78.1250 (80.0000) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [25/31] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.7939 (0.7409) acc_x 78.1250 (80.1250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/31] time 0.174 (0.180) data 0.097 (0.102) loss_x loss_x 0.6997 (0.7556) acc_x 78.1250 (79.8958) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/18] time 0.169 (0.179) data 0.091 (0.102) loss_u loss_u 0.6504 (0.6919) acc_u 40.6250 (35.0000) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/18] time 0.186 (0.180) data 0.108 (0.102) loss_u loss_u 0.6030 (0.6930) acc_u 50.0000 (35.3125) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/18] time 0.193 (0.180) data 0.114 (0.103) loss_u loss_u 0.8315 (0.7233) acc_u 18.7500 (31.8750) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 462
confident_label rate tensor(0.6244, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1009
clean true:1008
clean false:1
clean_rate:0.9990089197224975
noisy true:146
noisy false:461
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 607
epoch [68/200] batch [5/31] time 0.187 (0.206) data 0.109 (0.128) loss_x loss_x 0.6318 (0.7063) acc_x 87.5000 (81.8750) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/31] time 0.208 (0.198) data 0.130 (0.121) loss_x loss_x 0.7202 (0.7362) acc_x 81.2500 (81.8750) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/31] time 0.186 (0.195) data 0.109 (0.117) loss_x loss_x 0.4451 (0.7069) acc_x 90.6250 (81.6667) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [20/31] time 0.184 (0.190) data 0.107 (0.113) loss_x loss_x 0.5972 (0.6808) acc_x 87.5000 (82.5000) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/31] time 0.183 (0.189) data 0.106 (0.111) loss_x loss_x 0.4734 (0.6869) acc_x 93.7500 (82.2500) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [30/31] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.6230 (0.6755) acc_x 81.2500 (82.5000) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/18] time 0.176 (0.188) data 0.098 (0.111) loss_u loss_u 0.7500 (0.7104) acc_u 28.1250 (36.2500) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [10/18] time 0.164 (0.188) data 0.086 (0.110) loss_u loss_u 0.7285 (0.7211) acc_u 34.3750 (34.6875) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [15/18] time 0.170 (0.186) data 0.092 (0.108) loss_u loss_u 0.7588 (0.7256) acc_u 25.0000 (33.1250) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 443
confident_label rate tensor(0.6324, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1022
clean true:1020
clean false:2
clean_rate:0.9980430528375733
noisy true:153
noisy false:441
after delete: len(clean_dataset) 1022
after delete: len(noisy_dataset) 594
epoch [69/200] batch [5/31] time 0.172 (0.181) data 0.094 (0.104) loss_x loss_x 0.7417 (0.5447) acc_x 78.1250 (83.7500) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/31] time 0.201 (0.181) data 0.123 (0.103) loss_x loss_x 0.7046 (0.6182) acc_x 81.2500 (83.4375) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/31] time 0.181 (0.179) data 0.103 (0.102) loss_x loss_x 0.7378 (0.6678) acc_x 81.2500 (82.2917) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/31] time 0.162 (0.178) data 0.085 (0.100) loss_x loss_x 0.9341 (0.6987) acc_x 71.8750 (82.0312) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [25/31] time 0.174 (0.179) data 0.095 (0.101) loss_x loss_x 0.9116 (0.7322) acc_x 75.0000 (81.6250) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [30/31] time 0.165 (0.178) data 0.087 (0.100) loss_x loss_x 0.4258 (0.7033) acc_x 87.5000 (82.1875) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/18] time 0.191 (0.178) data 0.113 (0.100) loss_u loss_u 0.6411 (0.6733) acc_u 37.5000 (36.8750) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/18] time 0.194 (0.178) data 0.115 (0.100) loss_u loss_u 0.7217 (0.7051) acc_u 31.2500 (33.1250) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/18] time 0.172 (0.178) data 0.094 (0.100) loss_u loss_u 0.7280 (0.7056) acc_u 31.2500 (33.3333) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 421
confident_label rate tensor(0.6535, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1056
clean true:1054
clean false:2
clean_rate:0.9981060606060606
noisy true:141
noisy false:419
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 560
epoch [70/200] batch [5/33] time 0.187 (0.182) data 0.109 (0.104) loss_x loss_x 0.5308 (0.5979) acc_x 84.3750 (84.3750) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/33] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.4451 (0.6597) acc_x 84.3750 (82.1875) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/33] time 0.173 (0.175) data 0.096 (0.097) loss_x loss_x 0.6567 (0.6350) acc_x 84.3750 (82.7083) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/33] time 0.174 (0.175) data 0.097 (0.097) loss_x loss_x 0.3823 (0.6829) acc_x 90.6250 (81.7188) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/33] time 0.180 (0.176) data 0.102 (0.098) loss_x loss_x 0.6147 (0.6828) acc_x 81.2500 (81.5000) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [30/33] time 0.166 (0.175) data 0.088 (0.098) loss_x loss_x 0.7422 (0.6900) acc_x 71.8750 (80.7292) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/17] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.7744 (0.7693) acc_u 31.2500 (27.5000) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/17] time 0.191 (0.178) data 0.112 (0.101) loss_u loss_u 0.7754 (0.7461) acc_u 25.0000 (30.0000) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/17] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.7026 (0.7392) acc_u 37.5000 (30.4167) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 413
confident_label rate tensor(0.6597, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1066
clean true:1066
clean false:0
clean_rate:1.0
noisy true:137
noisy false:413
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 550
epoch [71/200] batch [5/33] time 0.172 (0.170) data 0.094 (0.092) loss_x loss_x 0.6338 (0.6049) acc_x 81.2500 (84.3750) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [10/33] time 0.186 (0.175) data 0.108 (0.097) loss_x loss_x 0.7295 (0.6725) acc_x 87.5000 (83.1250) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [15/33] time 0.183 (0.175) data 0.105 (0.097) loss_x loss_x 0.8413 (0.6900) acc_x 78.1250 (82.0833) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [20/33] time 0.170 (0.175) data 0.092 (0.097) loss_x loss_x 0.7935 (0.6882) acc_x 75.0000 (80.9375) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/33] time 0.168 (0.175) data 0.091 (0.097) loss_x loss_x 0.4321 (0.6597) acc_x 81.2500 (81.3750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [30/33] time 0.162 (0.173) data 0.085 (0.095) loss_x loss_x 0.9951 (0.6835) acc_x 75.0000 (81.2500) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/17] time 0.163 (0.171) data 0.083 (0.093) loss_u loss_u 0.7217 (0.7734) acc_u 37.5000 (25.6250) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/17] time 0.163 (0.170) data 0.085 (0.092) loss_u loss_u 0.7881 (0.7708) acc_u 21.8750 (26.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/17] time 0.181 (0.170) data 0.103 (0.092) loss_u loss_u 0.8105 (0.7593) acc_u 25.0000 (28.5417) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 433
confident_label rate tensor(0.6417, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1037
clean true:1035
clean false:2
clean_rate:0.9980713596914176
noisy true:148
noisy false:431
after delete: len(clean_dataset) 1037
after delete: len(noisy_dataset) 579
epoch [72/200] batch [5/32] time 0.182 (0.184) data 0.104 (0.106) loss_x loss_x 1.3672 (0.6881) acc_x 75.0000 (83.7500) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [10/32] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.7178 (0.6220) acc_x 78.1250 (82.8125) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/32] time 0.168 (0.182) data 0.090 (0.105) loss_x loss_x 0.4800 (0.6018) acc_x 90.6250 (84.1667) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [20/32] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.3708 (0.6220) acc_x 90.6250 (84.0625) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [25/32] time 0.170 (0.179) data 0.092 (0.102) loss_x loss_x 0.4968 (0.6242) acc_x 87.5000 (84.2500) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [30/32] time 0.189 (0.179) data 0.112 (0.102) loss_x loss_x 0.7397 (0.6409) acc_x 78.1250 (83.3333) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/18] time 0.188 (0.178) data 0.109 (0.101) loss_u loss_u 0.7773 (0.7744) acc_u 25.0000 (27.5000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/18] time 0.194 (0.178) data 0.117 (0.100) loss_u loss_u 0.6924 (0.7539) acc_u 37.5000 (29.6875) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/18] time 0.163 (0.176) data 0.085 (0.099) loss_u loss_u 0.6655 (0.7356) acc_u 40.6250 (31.8750) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 405
confident_label rate tensor(0.6535, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1056
clean true:1056
clean false:0
clean_rate:1.0
noisy true:155
noisy false:405
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 560
epoch [73/200] batch [5/33] time 0.182 (0.186) data 0.104 (0.108) loss_x loss_x 0.9692 (0.6757) acc_x 78.1250 (85.0000) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/33] time 0.185 (0.183) data 0.108 (0.105) loss_x loss_x 0.7793 (0.6912) acc_x 81.2500 (84.0625) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [15/33] time 0.168 (0.180) data 0.091 (0.102) loss_x loss_x 0.5947 (0.6353) acc_x 75.0000 (84.1667) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/33] time 0.173 (0.177) data 0.095 (0.100) loss_x loss_x 0.5151 (0.6314) acc_x 87.5000 (84.5312) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/33] time 0.172 (0.178) data 0.094 (0.101) loss_x loss_x 0.9009 (0.6334) acc_x 71.8750 (84.1250) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [30/33] time 0.177 (0.177) data 0.099 (0.100) loss_x loss_x 0.3904 (0.6058) acc_x 90.6250 (85.1042) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/17] time 0.167 (0.178) data 0.089 (0.100) loss_u loss_u 0.7515 (0.7345) acc_u 31.2500 (28.7500) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/17] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.6665 (0.7383) acc_u 34.3750 (29.6875) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/17] time 0.173 (0.178) data 0.095 (0.100) loss_u loss_u 0.7412 (0.7344) acc_u 31.2500 (29.7917) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 440
confident_label rate tensor(0.6374, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1030
clean true:1030
clean false:0
clean_rate:1.0
noisy true:146
noisy false:440
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 586
epoch [74/200] batch [5/32] time 0.172 (0.181) data 0.094 (0.103) loss_x loss_x 0.6680 (0.6600) acc_x 81.2500 (83.1250) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [10/32] time 0.187 (0.180) data 0.110 (0.102) loss_x loss_x 0.6045 (0.7260) acc_x 84.3750 (81.2500) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/32] time 0.170 (0.179) data 0.092 (0.101) loss_x loss_x 0.9741 (0.6982) acc_x 81.2500 (83.1250) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/32] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.8618 (0.7094) acc_x 75.0000 (82.1875) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/32] time 0.162 (0.174) data 0.085 (0.096) loss_x loss_x 0.5557 (0.6764) acc_x 84.3750 (82.8750) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [30/32] time 0.187 (0.173) data 0.108 (0.095) loss_x loss_x 0.5352 (0.6676) acc_x 75.0000 (82.9167) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/18] time 0.167 (0.173) data 0.089 (0.095) loss_u loss_u 0.6792 (0.6757) acc_u 34.3750 (36.8750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [10/18] time 0.165 (0.172) data 0.086 (0.094) loss_u loss_u 0.7095 (0.7147) acc_u 34.3750 (33.1250) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/18] time 0.168 (0.171) data 0.090 (0.093) loss_u loss_u 0.7759 (0.7177) acc_u 28.1250 (33.1250) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 424
confident_label rate tensor(0.6473, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1046
clean true:1046
clean false:0
clean_rate:1.0
noisy true:146
noisy false:424
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 570
epoch [75/200] batch [5/32] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.9653 (0.8011) acc_x 75.0000 (78.1250) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [10/32] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.5010 (0.6685) acc_x 81.2500 (81.5625) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/32] time 0.170 (0.182) data 0.093 (0.104) loss_x loss_x 0.5469 (0.6620) acc_x 84.3750 (81.8750) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/32] time 0.180 (0.181) data 0.102 (0.103) loss_x loss_x 0.8486 (0.6564) acc_x 78.1250 (82.0312) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/32] time 0.161 (0.180) data 0.084 (0.102) loss_x loss_x 0.7964 (0.6493) acc_x 81.2500 (81.8750) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [30/32] time 0.169 (0.178) data 0.092 (0.100) loss_x loss_x 0.9380 (0.6760) acc_x 84.3750 (81.9792) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/17] time 0.163 (0.177) data 0.084 (0.100) loss_u loss_u 0.6436 (0.7417) acc_u 34.3750 (28.7500) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/17] time 0.188 (0.178) data 0.110 (0.100) loss_u loss_u 0.7329 (0.7401) acc_u 28.1250 (29.3750) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/17] time 0.191 (0.179) data 0.112 (0.101) loss_u loss_u 0.6519 (0.7336) acc_u 37.5000 (30.8333) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.6429, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1039
clean true:1039
clean false:0
clean_rate:1.0
noisy true:151
noisy false:426
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 577
epoch [76/200] batch [5/32] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.7886 (0.6909) acc_x 71.8750 (79.3750) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/32] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.7656 (0.7173) acc_x 81.2500 (79.3750) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [15/32] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.7373 (0.6747) acc_x 87.5000 (81.4583) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/32] time 0.185 (0.184) data 0.106 (0.106) loss_x loss_x 0.3984 (0.6836) acc_x 90.6250 (81.8750) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/32] time 0.190 (0.184) data 0.112 (0.107) loss_x loss_x 0.5898 (0.6769) acc_x 84.3750 (82.0000) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [30/32] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.8521 (0.6687) acc_x 75.0000 (82.0833) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/18] time 0.184 (0.184) data 0.107 (0.106) loss_u loss_u 0.5869 (0.7166) acc_u 46.8750 (33.7500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/18] time 0.191 (0.182) data 0.112 (0.104) loss_u loss_u 0.6724 (0.6937) acc_u 37.5000 (37.1875) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [15/18] time 0.183 (0.183) data 0.105 (0.105) loss_u loss_u 0.7480 (0.6997) acc_u 25.0000 (35.6250) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.6417, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1037
clean true:1037
clean false:0
clean_rate:1.0
noisy true:153
noisy false:426
after delete: len(clean_dataset) 1037
after delete: len(noisy_dataset) 579
epoch [77/200] batch [5/32] time 0.188 (0.183) data 0.109 (0.105) loss_x loss_x 0.7339 (0.7530) acc_x 75.0000 (80.0000) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [10/32] time 0.178 (0.190) data 0.100 (0.112) loss_x loss_x 0.9136 (0.7326) acc_x 78.1250 (80.3125) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/32] time 0.166 (0.186) data 0.089 (0.108) loss_x loss_x 0.3423 (0.6433) acc_x 93.7500 (83.1250) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/32] time 0.179 (0.184) data 0.101 (0.106) loss_x loss_x 0.7598 (0.6384) acc_x 81.2500 (83.7500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/32] time 0.181 (0.181) data 0.103 (0.103) loss_x loss_x 0.8823 (0.6550) acc_x 71.8750 (82.1250) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/32] time 0.170 (0.180) data 0.092 (0.102) loss_x loss_x 0.7842 (0.6610) acc_x 75.0000 (81.9792) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/18] time 0.170 (0.179) data 0.091 (0.101) loss_u loss_u 0.6499 (0.6924) acc_u 43.7500 (35.6250) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/18] time 0.188 (0.179) data 0.110 (0.101) loss_u loss_u 0.7993 (0.7008) acc_u 25.0000 (35.0000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/18] time 0.188 (0.180) data 0.111 (0.102) loss_u loss_u 0.8086 (0.7157) acc_u 28.1250 (33.9583) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 420
confident_label rate tensor(0.6510, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1052
clean true:1050
clean false:2
clean_rate:0.9980988593155894
noisy true:146
noisy false:418
after delete: len(clean_dataset) 1052
after delete: len(noisy_dataset) 564
epoch [78/200] batch [5/32] time 0.170 (0.172) data 0.092 (0.094) loss_x loss_x 0.4658 (0.7460) acc_x 84.3750 (81.8750) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [10/32] time 0.161 (0.168) data 0.083 (0.090) loss_x loss_x 0.6333 (0.7609) acc_x 75.0000 (80.6250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/32] time 0.187 (0.170) data 0.109 (0.092) loss_x loss_x 0.7090 (0.6876) acc_x 81.2500 (82.5000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/32] time 0.165 (0.169) data 0.086 (0.091) loss_x loss_x 0.4907 (0.6794) acc_x 84.3750 (82.1875) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/32] time 0.172 (0.169) data 0.095 (0.091) loss_x loss_x 0.3296 (0.6488) acc_x 87.5000 (82.6250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [30/32] time 0.172 (0.169) data 0.094 (0.092) loss_x loss_x 0.6572 (0.6885) acc_x 87.5000 (81.6667) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/17] time 0.165 (0.170) data 0.086 (0.092) loss_u loss_u 0.8296 (0.7301) acc_u 18.7500 (31.2500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/17] time 0.168 (0.170) data 0.089 (0.092) loss_u loss_u 0.7095 (0.7216) acc_u 31.2500 (32.8125) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/17] time 0.188 (0.171) data 0.111 (0.093) loss_u loss_u 0.6406 (0.7301) acc_u 37.5000 (31.4583) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 411
confident_label rate tensor(0.6572, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1062
clean true:1061
clean false:1
clean_rate:0.9990583804143126
noisy true:144
noisy false:410
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 554
epoch [79/200] batch [5/33] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.6265 (0.7953) acc_x 78.1250 (80.0000) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/33] time 0.163 (0.178) data 0.085 (0.101) loss_x loss_x 0.6069 (0.6945) acc_x 84.3750 (81.8750) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/33] time 0.186 (0.180) data 0.109 (0.102) loss_x loss_x 0.5029 (0.6894) acc_x 81.2500 (81.8750) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [20/33] time 0.166 (0.178) data 0.088 (0.100) loss_x loss_x 0.8491 (0.6848) acc_x 68.7500 (81.8750) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/33] time 0.204 (0.179) data 0.126 (0.101) loss_x loss_x 0.6187 (0.6944) acc_x 84.3750 (82.1250) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [30/33] time 0.180 (0.179) data 0.103 (0.101) loss_x loss_x 0.6816 (0.6954) acc_x 81.2500 (82.5000) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/17] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.7598 (0.7405) acc_u 28.1250 (30.0000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/17] time 0.165 (0.179) data 0.086 (0.102) loss_u loss_u 0.6440 (0.7236) acc_u 43.7500 (33.4375) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/17] time 0.172 (0.178) data 0.093 (0.100) loss_u loss_u 0.6841 (0.7200) acc_u 37.5000 (34.1667) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 409
confident_label rate tensor(0.6590, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1065
clean true:1065
clean false:0
clean_rate:1.0
noisy true:142
noisy false:409
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 551
epoch [80/200] batch [5/33] time 0.190 (0.189) data 0.112 (0.110) loss_x loss_x 0.5845 (0.6843) acc_x 84.3750 (83.7500) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/33] time 0.183 (0.188) data 0.106 (0.110) loss_x loss_x 0.3071 (0.6683) acc_x 93.7500 (82.8125) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/33] time 0.180 (0.187) data 0.103 (0.110) loss_x loss_x 0.6870 (0.6610) acc_x 81.2500 (83.1250) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/33] time 0.183 (0.186) data 0.105 (0.109) loss_x loss_x 0.3728 (0.6915) acc_x 84.3750 (80.6250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/33] time 0.179 (0.185) data 0.101 (0.108) loss_x loss_x 0.8799 (0.6702) acc_x 84.3750 (81.6250) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [30/33] time 0.190 (0.185) data 0.113 (0.107) loss_x loss_x 0.8901 (0.6444) acc_x 78.1250 (82.6042) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/17] time 0.179 (0.185) data 0.101 (0.107) loss_u loss_u 0.6084 (0.6950) acc_u 50.0000 (35.6250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/17] time 0.162 (0.183) data 0.082 (0.105) loss_u loss_u 0.7119 (0.7230) acc_u 28.1250 (32.8125) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/17] time 0.176 (0.182) data 0.098 (0.105) loss_u loss_u 0.6890 (0.7274) acc_u 40.6250 (32.0833) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 418
confident_label rate tensor(0.6479, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1047
clean true:1047
clean false:0
clean_rate:1.0
noisy true:151
noisy false:418
after delete: len(clean_dataset) 1047
after delete: len(noisy_dataset) 569
epoch [81/200] batch [5/32] time 0.187 (0.173) data 0.110 (0.095) loss_x loss_x 0.6489 (0.6924) acc_x 81.2500 (80.6250) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/32] time 0.177 (0.175) data 0.099 (0.097) loss_x loss_x 0.5205 (0.6693) acc_x 81.2500 (80.0000) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/32] time 0.173 (0.176) data 0.095 (0.098) loss_x loss_x 0.6885 (0.6638) acc_x 81.2500 (81.4583) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/32] time 0.166 (0.176) data 0.089 (0.098) loss_x loss_x 0.6582 (0.6638) acc_x 87.5000 (81.2500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/32] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.7480 (0.6611) acc_x 78.1250 (81.8750) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [30/32] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 1.1270 (0.6502) acc_x 68.7500 (82.2917) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/17] time 0.194 (0.177) data 0.116 (0.099) loss_u loss_u 0.6821 (0.6885) acc_u 37.5000 (36.8750) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/17] time 0.176 (0.176) data 0.098 (0.098) loss_u loss_u 0.6914 (0.6928) acc_u 37.5000 (35.0000) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/17] time 0.191 (0.177) data 0.113 (0.099) loss_u loss_u 0.6782 (0.6924) acc_u 37.5000 (35.4167) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 400
confident_label rate tensor(0.6634, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1072
clean true:1072
clean false:0
clean_rate:1.0
noisy true:144
noisy false:400
after delete: len(clean_dataset) 1072
after delete: len(noisy_dataset) 544
epoch [82/200] batch [5/33] time 0.179 (0.177) data 0.102 (0.099) loss_x loss_x 0.8618 (0.7495) acc_x 75.0000 (84.3750) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [10/33] time 0.167 (0.175) data 0.089 (0.098) loss_x loss_x 0.7231 (0.7496) acc_x 78.1250 (81.2500) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/33] time 0.169 (0.176) data 0.092 (0.098) loss_x loss_x 0.7065 (0.7108) acc_x 81.2500 (81.0417) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/33] time 0.190 (0.176) data 0.112 (0.098) loss_x loss_x 0.3848 (0.6984) acc_x 96.8750 (82.0312) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/33] time 0.171 (0.175) data 0.093 (0.097) loss_x loss_x 0.4744 (0.7034) acc_x 81.2500 (81.6250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [30/33] time 0.190 (0.176) data 0.112 (0.098) loss_x loss_x 0.5112 (0.6676) acc_x 81.2500 (82.6042) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/17] time 0.171 (0.175) data 0.093 (0.098) loss_u loss_u 0.6792 (0.7000) acc_u 31.2500 (34.3750) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/17] time 0.166 (0.174) data 0.085 (0.097) loss_u loss_u 0.7427 (0.7272) acc_u 31.2500 (31.5625) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/17] time 0.163 (0.174) data 0.086 (0.096) loss_u loss_u 0.7593 (0.7306) acc_u 28.1250 (31.6667) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 409
confident_label rate tensor(0.6510, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1052
clean true:1052
clean false:0
clean_rate:1.0
noisy true:155
noisy false:409
after delete: len(clean_dataset) 1052
after delete: len(noisy_dataset) 564
epoch [83/200] batch [5/32] time 0.170 (0.170) data 0.093 (0.092) loss_x loss_x 0.6826 (0.6880) acc_x 84.3750 (80.6250) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [10/32] time 0.160 (0.174) data 0.082 (0.097) loss_x loss_x 1.2842 (0.7297) acc_x 68.7500 (80.3125) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/32] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.7065 (0.6827) acc_x 81.2500 (81.6667) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/32] time 0.165 (0.173) data 0.088 (0.096) loss_x loss_x 0.5942 (0.7117) acc_x 81.2500 (81.2500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/32] time 0.169 (0.174) data 0.090 (0.097) loss_x loss_x 0.6680 (0.6833) acc_x 78.1250 (81.8750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [30/32] time 0.163 (0.172) data 0.084 (0.095) loss_x loss_x 0.9512 (0.6843) acc_x 75.0000 (82.0833) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/17] time 0.165 (0.173) data 0.087 (0.096) loss_u loss_u 0.7690 (0.7445) acc_u 25.0000 (28.7500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/17] time 0.158 (0.173) data 0.081 (0.096) loss_u loss_u 0.8057 (0.7469) acc_u 25.0000 (28.7500) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/17] time 0.179 (0.173) data 0.102 (0.095) loss_u loss_u 0.7007 (0.7301) acc_u 34.3750 (31.0417) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 399
confident_label rate tensor(0.6597, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1066
clean true:1065
clean false:1
clean_rate:0.99906191369606
noisy true:152
noisy false:398
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 550
epoch [84/200] batch [5/33] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.6929 (0.8206) acc_x 75.0000 (78.1250) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/33] time 0.171 (0.177) data 0.093 (0.099) loss_x loss_x 0.5679 (0.6958) acc_x 84.3750 (82.5000) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/33] time 0.189 (0.177) data 0.109 (0.099) loss_x loss_x 0.3850 (0.6547) acc_x 87.5000 (83.3333) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/33] time 0.172 (0.177) data 0.095 (0.099) loss_x loss_x 0.5854 (0.6691) acc_x 81.2500 (83.2812) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/33] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.4790 (0.6460) acc_x 87.5000 (84.2500) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [30/33] time 0.172 (0.175) data 0.095 (0.097) loss_x loss_x 0.3503 (0.6200) acc_x 93.7500 (85.0000) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/17] time 0.158 (0.175) data 0.080 (0.098) loss_u loss_u 0.8071 (0.7338) acc_u 28.1250 (31.8750) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [10/17] time 0.173 (0.175) data 0.094 (0.097) loss_u loss_u 0.8320 (0.7480) acc_u 15.6250 (29.0625) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/17] time 0.167 (0.174) data 0.089 (0.096) loss_u loss_u 0.7603 (0.7494) acc_u 31.2500 (28.9583) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 406
confident_label rate tensor(0.6584, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1064
clean true:1064
clean false:0
clean_rate:1.0
noisy true:146
noisy false:406
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 552
epoch [85/200] batch [5/33] time 0.168 (0.171) data 0.091 (0.094) loss_x loss_x 0.4580 (0.4766) acc_x 87.5000 (86.8750) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [10/33] time 0.190 (0.173) data 0.112 (0.095) loss_x loss_x 0.7148 (0.5917) acc_x 84.3750 (84.3750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [15/33] time 0.182 (0.174) data 0.104 (0.096) loss_x loss_x 0.5444 (0.5938) acc_x 81.2500 (83.7500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/33] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.8247 (0.6228) acc_x 78.1250 (82.6562) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/33] time 0.178 (0.177) data 0.101 (0.099) loss_x loss_x 1.0020 (0.6439) acc_x 71.8750 (82.2500) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [30/33] time 0.176 (0.177) data 0.099 (0.099) loss_x loss_x 0.6743 (0.6504) acc_x 84.3750 (82.8125) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/17] time 0.175 (0.178) data 0.097 (0.100) loss_u loss_u 0.6992 (0.7199) acc_u 37.5000 (33.7500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [10/17] time 0.174 (0.177) data 0.096 (0.099) loss_u loss_u 0.7495 (0.7053) acc_u 28.1250 (35.3125) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/17] time 0.167 (0.176) data 0.089 (0.099) loss_u loss_u 0.7563 (0.7155) acc_u 28.1250 (33.5417) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 402
confident_label rate tensor(0.6584, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1064
clean true:1063
clean false:1
clean_rate:0.9990601503759399
noisy true:151
noisy false:401
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 552
epoch [86/200] batch [5/33] time 0.185 (0.181) data 0.107 (0.103) loss_x loss_x 0.4722 (0.6647) acc_x 90.6250 (85.0000) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/33] time 0.186 (0.182) data 0.108 (0.104) loss_x loss_x 0.7148 (0.6820) acc_x 81.2500 (83.7500) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/33] time 0.172 (0.179) data 0.094 (0.101) loss_x loss_x 0.5889 (0.6572) acc_x 81.2500 (82.7083) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [20/33] time 0.220 (0.181) data 0.141 (0.104) loss_x loss_x 0.7729 (0.6502) acc_x 71.8750 (82.1875) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/33] time 0.194 (0.183) data 0.116 (0.105) loss_x loss_x 0.5630 (0.6499) acc_x 90.6250 (83.2500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [30/33] time 0.195 (0.183) data 0.118 (0.105) loss_x loss_x 0.6577 (0.6469) acc_x 84.3750 (83.6458) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/17] time 0.166 (0.181) data 0.088 (0.103) loss_u loss_u 0.7051 (0.7250) acc_u 34.3750 (33.1250) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/17] time 0.173 (0.182) data 0.093 (0.104) loss_u loss_u 0.6997 (0.7227) acc_u 34.3750 (33.4375) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/17] time 0.169 (0.181) data 0.090 (0.103) loss_u loss_u 0.7354 (0.7210) acc_u 28.1250 (33.3333) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 400
confident_label rate tensor(0.6665, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1077
clean true:1073
clean false:4
clean_rate:0.9962859795728877
noisy true:143
noisy false:396
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 539
epoch [87/200] batch [5/33] time 0.176 (0.167) data 0.098 (0.089) loss_x loss_x 0.3474 (0.4792) acc_x 90.6250 (88.7500) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [10/33] time 0.170 (0.168) data 0.092 (0.090) loss_x loss_x 0.4814 (0.5583) acc_x 93.7500 (85.9375) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [15/33] time 0.196 (0.173) data 0.119 (0.095) loss_x loss_x 0.5508 (0.5555) acc_x 81.2500 (85.6250) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/33] time 0.175 (0.174) data 0.097 (0.096) loss_x loss_x 0.5020 (0.6013) acc_x 81.2500 (85.1562) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/33] time 0.186 (0.176) data 0.108 (0.099) loss_x loss_x 0.7866 (0.6145) acc_x 87.5000 (84.7500) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [30/33] time 0.186 (0.178) data 0.109 (0.100) loss_x loss_x 0.9092 (0.6202) acc_x 75.0000 (84.3750) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/16] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.7412 (0.7384) acc_u 28.1250 (29.3750) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/16] time 0.180 (0.180) data 0.102 (0.103) loss_u loss_u 0.7676 (0.7297) acc_u 21.8750 (30.9375) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/16] time 0.167 (0.180) data 0.089 (0.102) loss_u loss_u 0.6509 (0.7188) acc_u 37.5000 (31.8750) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 404
confident_label rate tensor(0.6522, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1054
clean true:1054
clean false:0
clean_rate:1.0
noisy true:158
noisy false:404
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 562
epoch [88/200] batch [5/32] time 0.176 (0.172) data 0.098 (0.094) loss_x loss_x 0.4475 (0.4860) acc_x 93.7500 (86.2500) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/32] time 0.185 (0.174) data 0.108 (0.096) loss_x loss_x 0.6699 (0.6051) acc_x 84.3750 (81.5625) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [15/32] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.6836 (0.5967) acc_x 75.0000 (82.2917) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/32] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.5396 (0.6436) acc_x 87.5000 (82.0312) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/32] time 0.173 (0.180) data 0.094 (0.102) loss_x loss_x 0.8994 (0.6427) acc_x 78.1250 (82.5000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [30/32] time 0.162 (0.178) data 0.085 (0.100) loss_x loss_x 0.7769 (0.6465) acc_x 81.2500 (82.6042) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/17] time 0.166 (0.175) data 0.087 (0.097) loss_u loss_u 0.7793 (0.7346) acc_u 28.1250 (34.3750) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/17] time 0.169 (0.174) data 0.091 (0.096) loss_u loss_u 0.5684 (0.7272) acc_u 53.1250 (32.5000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [15/17] time 0.182 (0.174) data 0.103 (0.096) loss_u loss_u 0.7529 (0.6953) acc_u 28.1250 (36.0417) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 408
confident_label rate tensor(0.6590, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1065
clean true:1065
clean false:0
clean_rate:1.0
noisy true:143
noisy false:408
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 551
epoch [89/200] batch [5/33] time 0.160 (0.190) data 0.083 (0.112) loss_x loss_x 0.5146 (0.5460) acc_x 84.3750 (87.5000) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/33] time 0.172 (0.181) data 0.094 (0.103) loss_x loss_x 0.5190 (0.5284) acc_x 84.3750 (87.5000) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/33] time 0.169 (0.179) data 0.092 (0.101) loss_x loss_x 0.5127 (0.5315) acc_x 84.3750 (87.2917) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/33] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 0.5698 (0.5841) acc_x 84.3750 (86.0938) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/33] time 0.214 (0.182) data 0.135 (0.104) loss_x loss_x 0.5322 (0.5823) acc_x 90.6250 (86.1250) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [30/33] time 0.171 (0.182) data 0.094 (0.104) loss_x loss_x 1.1104 (0.5988) acc_x 71.8750 (85.2083) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/17] time 0.173 (0.180) data 0.095 (0.102) loss_u loss_u 0.6216 (0.7161) acc_u 40.6250 (32.5000) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/17] time 0.177 (0.179) data 0.099 (0.101) loss_u loss_u 0.7998 (0.7163) acc_u 25.0000 (33.4375) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/17] time 0.184 (0.179) data 0.106 (0.101) loss_u loss_u 0.7393 (0.7311) acc_u 31.2500 (31.6667) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 396
confident_label rate tensor(0.6590, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1065
clean true:1064
clean false:1
clean_rate:0.9990610328638497
noisy true:156
noisy false:395
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 551
epoch [90/200] batch [5/33] time 0.171 (0.171) data 0.094 (0.093) loss_x loss_x 0.3044 (0.5814) acc_x 93.7500 (85.0000) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [10/33] time 0.181 (0.173) data 0.103 (0.096) loss_x loss_x 0.8066 (0.5744) acc_x 78.1250 (84.0625) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [15/33] time 0.164 (0.174) data 0.088 (0.097) loss_x loss_x 0.5596 (0.5791) acc_x 84.3750 (84.1667) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/33] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.4958 (0.6062) acc_x 93.7500 (84.6875) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/33] time 0.179 (0.177) data 0.101 (0.100) loss_x loss_x 0.8018 (0.6055) acc_x 84.3750 (85.1250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [30/33] time 0.163 (0.176) data 0.086 (0.099) loss_x loss_x 0.9102 (0.6116) acc_x 78.1250 (84.8958) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/17] time 0.164 (0.176) data 0.086 (0.099) loss_u loss_u 0.7656 (0.7734) acc_u 31.2500 (26.8750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/17] time 0.185 (0.176) data 0.107 (0.098) loss_u loss_u 0.6538 (0.7241) acc_u 40.6250 (31.2500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/17] time 0.161 (0.175) data 0.082 (0.098) loss_u loss_u 0.7202 (0.7199) acc_u 31.2500 (32.0833) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 388
confident_label rate tensor(0.6683, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1080
clean true:1080
clean false:0
clean_rate:1.0
noisy true:148
noisy false:388
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 536
epoch [91/200] batch [5/33] time 0.177 (0.173) data 0.100 (0.096) loss_x loss_x 0.7637 (0.6556) acc_x 78.1250 (81.8750) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [10/33] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 0.2852 (0.5448) acc_x 93.7500 (85.9375) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/33] time 0.191 (0.180) data 0.114 (0.102) loss_x loss_x 0.7300 (0.5884) acc_x 81.2500 (85.0000) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/33] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.4973 (0.6101) acc_x 81.2500 (83.9062) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/33] time 0.185 (0.182) data 0.106 (0.104) loss_x loss_x 0.5518 (0.6267) acc_x 78.1250 (83.3750) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [30/33] time 0.185 (0.182) data 0.106 (0.105) loss_x loss_x 1.1426 (0.6464) acc_x 75.0000 (83.0208) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/16] time 0.179 (0.183) data 0.100 (0.105) loss_u loss_u 0.7920 (0.7631) acc_u 25.0000 (26.8750) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/16] time 0.187 (0.183) data 0.110 (0.105) loss_u loss_u 0.8032 (0.7567) acc_u 31.2500 (28.7500) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/16] time 0.164 (0.183) data 0.087 (0.105) loss_u loss_u 0.7344 (0.7390) acc_u 34.3750 (30.8333) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 387
confident_label rate tensor(0.6658, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1076
clean true:1075
clean false:1
clean_rate:0.9990706319702602
noisy true:154
noisy false:386
after delete: len(clean_dataset) 1076
after delete: len(noisy_dataset) 540
epoch [92/200] batch [5/33] time 0.173 (0.171) data 0.094 (0.092) loss_x loss_x 0.6743 (0.6002) acc_x 78.1250 (86.2500) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [10/33] time 0.166 (0.169) data 0.088 (0.091) loss_x loss_x 0.7559 (0.6018) acc_x 81.2500 (85.6250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [15/33] time 0.173 (0.169) data 0.094 (0.091) loss_x loss_x 0.7104 (0.6184) acc_x 87.5000 (85.8333) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [20/33] time 0.186 (0.171) data 0.109 (0.093) loss_x loss_x 0.7251 (0.6531) acc_x 81.2500 (83.9062) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/33] time 0.184 (0.173) data 0.107 (0.095) loss_x loss_x 0.6416 (0.6315) acc_x 87.5000 (84.2500) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [30/33] time 0.190 (0.175) data 0.112 (0.097) loss_x loss_x 0.8784 (0.6266) acc_x 71.8750 (84.2708) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/16] time 0.184 (0.179) data 0.106 (0.101) loss_u loss_u 0.7588 (0.7640) acc_u 28.1250 (27.5000) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/16] time 0.171 (0.178) data 0.093 (0.100) loss_u loss_u 0.7422 (0.7550) acc_u 28.1250 (28.1250) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [15/16] time 0.167 (0.178) data 0.087 (0.100) loss_u loss_u 0.7041 (0.7400) acc_u 31.2500 (30.0000) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 404
confident_label rate tensor(0.6547, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1058
clean true:1057
clean false:1
clean_rate:0.999054820415879
noisy true:155
noisy false:403
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 558
epoch [93/200] batch [5/33] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.7300 (0.5161) acc_x 78.1250 (84.3750) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/33] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.7842 (0.5574) acc_x 84.3750 (84.0625) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/33] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.4871 (0.5764) acc_x 87.5000 (83.5417) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/33] time 0.183 (0.185) data 0.104 (0.108) loss_x loss_x 0.5576 (0.5960) acc_x 81.2500 (82.9688) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/33] time 0.183 (0.185) data 0.105 (0.108) loss_x loss_x 0.4272 (0.6147) acc_x 93.7500 (82.7500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [30/33] time 0.160 (0.184) data 0.083 (0.106) loss_x loss_x 0.7661 (0.6035) acc_x 75.0000 (82.6042) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/17] time 0.165 (0.181) data 0.087 (0.103) loss_u loss_u 0.7271 (0.6758) acc_u 34.3750 (39.3750) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/17] time 0.173 (0.179) data 0.094 (0.102) loss_u loss_u 0.6538 (0.6799) acc_u 40.6250 (38.4375) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/17] time 0.169 (0.178) data 0.091 (0.101) loss_u loss_u 0.7158 (0.6820) acc_u 34.3750 (37.7083) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 400
confident_label rate tensor(0.6615, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1069
clean true:1068
clean false:1
clean_rate:0.9990645463049579
noisy true:148
noisy false:399
after delete: len(clean_dataset) 1069
after delete: len(noisy_dataset) 547
epoch [94/200] batch [5/33] time 0.173 (0.173) data 0.095 (0.096) loss_x loss_x 0.6841 (0.5801) acc_x 81.2500 (85.0000) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [10/33] time 0.179 (0.175) data 0.101 (0.098) loss_x loss_x 0.9341 (0.6185) acc_x 71.8750 (84.0625) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/33] time 0.170 (0.173) data 0.092 (0.096) loss_x loss_x 0.6846 (0.5937) acc_x 87.5000 (85.0000) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/33] time 0.173 (0.172) data 0.095 (0.095) loss_x loss_x 0.7969 (0.6223) acc_x 81.2500 (83.9062) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/33] time 0.178 (0.173) data 0.101 (0.096) loss_x loss_x 0.6602 (0.6056) acc_x 81.2500 (84.3750) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [30/33] time 0.169 (0.174) data 0.092 (0.096) loss_x loss_x 0.5210 (0.6192) acc_x 87.5000 (84.0625) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/17] time 0.204 (0.176) data 0.126 (0.098) loss_u loss_u 0.7651 (0.7100) acc_u 28.1250 (34.3750) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/17] time 0.173 (0.175) data 0.095 (0.098) loss_u loss_u 0.7593 (0.7149) acc_u 28.1250 (33.4375) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [15/17] time 0.187 (0.175) data 0.109 (0.098) loss_u loss_u 0.8315 (0.7174) acc_u 21.8750 (33.1250) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 373
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1099
clean true:1099
clean false:0
clean_rate:1.0
noisy true:144
noisy false:373
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 517
epoch [95/200] batch [5/34] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.7417 (0.6782) acc_x 71.8750 (80.6250) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/34] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.7427 (0.5908) acc_x 71.8750 (83.1250) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/34] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5459 (0.5721) acc_x 78.1250 (83.3333) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [20/34] time 0.190 (0.186) data 0.113 (0.108) loss_x loss_x 0.6040 (0.5853) acc_x 93.7500 (83.7500) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/34] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.5581 (0.5801) acc_x 84.3750 (84.0000) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [30/34] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.5391 (0.5904) acc_x 84.3750 (84.0625) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/16] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.5679 (0.7407) acc_u 53.1250 (33.7500) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/16] time 0.186 (0.185) data 0.107 (0.108) loss_u loss_u 0.6626 (0.7170) acc_u 34.3750 (34.6875) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [15/16] time 0.164 (0.185) data 0.085 (0.107) loss_u loss_u 0.8120 (0.7356) acc_u 21.8750 (32.2917) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 385
confident_label rate tensor(0.6671, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1078
clean true:1076
clean false:2
clean_rate:0.9981447124304267
noisy true:155
noisy false:383
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 538
epoch [96/200] batch [5/33] time 0.171 (0.172) data 0.093 (0.094) loss_x loss_x 0.7808 (0.6295) acc_x 81.2500 (85.0000) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [10/33] time 0.172 (0.171) data 0.093 (0.093) loss_x loss_x 0.9858 (0.6313) acc_x 78.1250 (84.6875) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [15/33] time 0.176 (0.172) data 0.097 (0.094) loss_x loss_x 0.7256 (0.6139) acc_x 75.0000 (83.9583) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/33] time 0.187 (0.173) data 0.109 (0.096) loss_x loss_x 0.3218 (0.6088) acc_x 93.7500 (84.6875) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/33] time 0.184 (0.176) data 0.106 (0.098) loss_x loss_x 0.5015 (0.6000) acc_x 87.5000 (84.5000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [30/33] time 0.185 (0.177) data 0.108 (0.099) loss_x loss_x 0.6831 (0.5934) acc_x 81.2500 (84.2708) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/16] time 0.186 (0.179) data 0.108 (0.101) loss_u loss_u 0.7393 (0.7246) acc_u 31.2500 (35.0000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [10/16] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.8081 (0.7251) acc_u 28.1250 (35.0000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/16] time 0.180 (0.180) data 0.102 (0.102) loss_u loss_u 0.7358 (0.7181) acc_u 28.1250 (34.7917) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 380
confident_label rate tensor(0.6702, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1083
clean true:1082
clean false:1
clean_rate:0.9990766389658357
noisy true:154
noisy false:379
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 533
epoch [97/200] batch [5/33] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.6650 (0.7503) acc_x 90.6250 (80.0000) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [10/33] time 0.183 (0.180) data 0.106 (0.102) loss_x loss_x 0.9497 (0.7212) acc_x 81.2500 (82.1875) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/33] time 0.188 (0.182) data 0.110 (0.104) loss_x loss_x 0.6191 (0.6978) acc_x 90.6250 (82.7083) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/33] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.7886 (0.7239) acc_x 78.1250 (81.7188) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/33] time 0.189 (0.183) data 0.111 (0.105) loss_x loss_x 0.3198 (0.6836) acc_x 93.7500 (82.0000) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [30/33] time 0.166 (0.182) data 0.088 (0.104) loss_x loss_x 0.6216 (0.6391) acc_x 81.2500 (83.0208) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/16] time 0.185 (0.182) data 0.107 (0.104) loss_u loss_u 0.6738 (0.6866) acc_u 37.5000 (33.7500) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/16] time 0.161 (0.180) data 0.082 (0.102) loss_u loss_u 0.7700 (0.7172) acc_u 34.3750 (31.8750) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/16] time 0.162 (0.179) data 0.084 (0.101) loss_u loss_u 0.6831 (0.7222) acc_u 37.5000 (32.9167) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 375
confident_label rate tensor(0.6714, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1085
clean true:1084
clean false:1
clean_rate:0.9990783410138249
noisy true:157
noisy false:374
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 531
epoch [98/200] batch [5/33] time 0.170 (0.184) data 0.093 (0.107) loss_x loss_x 0.6045 (0.7258) acc_x 78.1250 (80.6250) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/33] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.6064 (0.6121) acc_x 87.5000 (84.6875) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/33] time 0.168 (0.180) data 0.090 (0.102) loss_x loss_x 0.6558 (0.6025) acc_x 87.5000 (85.4167) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/33] time 0.184 (0.177) data 0.106 (0.100) loss_x loss_x 0.4348 (0.6146) acc_x 93.7500 (85.0000) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/33] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.6826 (0.6289) acc_x 84.3750 (84.6250) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [30/33] time 0.182 (0.180) data 0.105 (0.102) loss_x loss_x 0.3872 (0.6091) acc_x 84.3750 (84.5833) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/16] time 0.182 (0.181) data 0.104 (0.103) loss_u loss_u 0.7837 (0.7804) acc_u 31.2500 (26.8750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [10/16] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.5757 (0.7410) acc_u 46.8750 (30.3125) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/16] time 0.175 (0.181) data 0.097 (0.104) loss_u loss_u 0.6826 (0.7255) acc_u 37.5000 (32.7083) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 391
confident_label rate tensor(0.6603, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1067
clean true:1067
clean false:0
clean_rate:1.0
noisy true:158
noisy false:391
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 549
epoch [99/200] batch [5/33] time 0.186 (0.188) data 0.108 (0.110) loss_x loss_x 0.4626 (0.4147) acc_x 84.3750 (88.1250) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [10/33] time 0.185 (0.186) data 0.107 (0.109) loss_x loss_x 0.5835 (0.4981) acc_x 84.3750 (85.9375) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/33] time 0.184 (0.186) data 0.106 (0.108) loss_x loss_x 0.8223 (0.5502) acc_x 75.0000 (84.3750) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [20/33] time 0.187 (0.186) data 0.109 (0.108) loss_x loss_x 0.4580 (0.5336) acc_x 84.3750 (85.0000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/33] time 0.205 (0.187) data 0.127 (0.109) loss_x loss_x 0.5830 (0.5484) acc_x 93.7500 (84.5000) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [30/33] time 0.185 (0.187) data 0.108 (0.109) loss_x loss_x 0.4785 (0.5572) acc_x 84.3750 (83.6458) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/17] time 0.187 (0.186) data 0.109 (0.109) loss_u loss_u 0.5718 (0.7179) acc_u 50.0000 (32.5000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/17] time 0.186 (0.186) data 0.108 (0.109) loss_u loss_u 0.7104 (0.6979) acc_u 34.3750 (34.3750) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [15/17] time 0.175 (0.186) data 0.097 (0.108) loss_u loss_u 0.8193 (0.7115) acc_u 21.8750 (33.1250) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 409
confident_label rate tensor(0.6609, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1068
clean true:1066
clean false:2
clean_rate:0.99812734082397
noisy true:141
noisy false:407
all clean rate:  [0.9977116704805492, 0.9963768115942029, 0.9957507082152974, 0.9986504723346828, 0.9973154362416108, 1.0, 0.9987389659520807, 0.9975429975429976, 0.9987421383647799, 1.0, 0.9964328180737217, 0.9976275207591934, 0.9988276670574443, 0.9988262910798122, 0.9977116704805492, 0.9988038277511961, 1.0, 0.996547756041427, 0.9988532110091743, 1.0, 0.9988751406074241, 0.9988623435722411, 0.9988789237668162, 0.9977578475336323, 0.9989010989010989, 1.0, 0.9968051118210862, 0.9989200863930886, 1.0, 1.0, 1.0, 0.9989451476793249, 0.9989837398373984, 0.9989293361884368, 0.9989701338825953, 0.9989550679205852, 0.9989658738366081, 1.0, 0.998, 0.9989517819706499, 0.9989539748953975, 0.9989711934156379, 0.9979695431472081, 0.998992950654582, 0.9979757085020243, 0.9989868287740629, 0.9989806320081549, 0.9989785495403473, 0.9989816700610998, 0.998995983935743, 0.9989764585465711, 0.9989909182643795, 0.9989949748743718, 1.0, 0.9990079365079365, 0.9990049751243781, 1.0, 0.9990356798457087, 0.9990421455938697, 0.9980411361410382, 0.9980276134122288, 1.0, 1.0, 0.9980861244019139, 0.9990281827016521, 0.9990291262135922, 1.0, 0.9990089197224975, 0.9980430528375733, 0.9981060606060606, 1.0, 0.9980713596914176, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9980988593155894, 0.9990583804143126, 1.0, 1.0, 1.0, 1.0, 0.99906191369606, 1.0, 0.9990601503759399, 0.9962859795728877, 1.0, 1.0, 0.9990610328638497, 1.0, 0.9990706319702602, 0.999054820415879, 0.9990645463049579, 1.0, 0.9981447124304267, 0.9990766389658357, 0.9990783410138249, 1.0, 0.99812734082397]
after delete: len(clean_dataset) 1068
after delete: len(noisy_dataset) 548
epoch [100/200] batch [5/33] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.8271 (0.5683) acc_x 78.1250 (88.7500) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/33] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.6406 (0.6155) acc_x 78.1250 (85.9375) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/33] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.7852 (0.6444) acc_x 78.1250 (84.1667) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/33] time 0.163 (0.178) data 0.086 (0.100) loss_x loss_x 0.7788 (0.6271) acc_x 81.2500 (84.5312) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/33] time 0.167 (0.175) data 0.089 (0.098) loss_x loss_x 0.8174 (0.6279) acc_x 84.3750 (84.5000) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [30/33] time 0.183 (0.175) data 0.105 (0.098) loss_x loss_x 0.5039 (0.6181) acc_x 84.3750 (84.4792) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/17] time 0.161 (0.176) data 0.083 (0.098) loss_u loss_u 0.7061 (0.6963) acc_u 34.3750 (33.7500) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/17] time 0.179 (0.175) data 0.100 (0.097) loss_u loss_u 0.7520 (0.6894) acc_u 28.1250 (35.3125) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [15/17] time 0.161 (0.174) data 0.083 (0.096) loss_u loss_u 0.7832 (0.7128) acc_u 21.8750 (32.9167) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 398
confident_label rate tensor(0.6646, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1074
clean true:1070
clean false:4
clean_rate:0.9962756052141527
noisy true:148
noisy false:394
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 542
epoch [101/200] batch [5/33] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.3640 (0.6341) acc_x 87.5000 (86.2500) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [10/33] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.8154 (0.6202) acc_x 78.1250 (85.6250) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/33] time 0.185 (0.186) data 0.107 (0.108) loss_x loss_x 0.7344 (0.6255) acc_x 71.8750 (84.1667) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [20/33] time 0.184 (0.186) data 0.106 (0.109) loss_x loss_x 0.4663 (0.5779) acc_x 93.7500 (85.7812) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/33] time 0.184 (0.186) data 0.106 (0.109) loss_x loss_x 0.4661 (0.5678) acc_x 87.5000 (85.6250) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [30/33] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.6021 (0.5779) acc_x 81.2500 (85.2083) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/16] time 0.161 (0.184) data 0.083 (0.106) loss_u loss_u 0.7622 (0.6873) acc_u 31.2500 (38.7500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/16] time 0.188 (0.183) data 0.109 (0.106) loss_u loss_u 0.7217 (0.6919) acc_u 34.3750 (37.8125) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [15/16] time 0.184 (0.183) data 0.106 (0.105) loss_u loss_u 0.6670 (0.6948) acc_u 37.5000 (36.8750) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 383
confident_label rate tensor(0.6788, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1097
clean true:1092
clean false:5
clean_rate:0.9954421148587056
noisy true:141
noisy false:378
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 519
epoch [102/200] batch [5/34] time 0.172 (0.181) data 0.095 (0.103) loss_x loss_x 0.4338 (0.6745) acc_x 93.7500 (84.3750) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/34] time 0.178 (0.178) data 0.100 (0.101) loss_x loss_x 0.4954 (0.7497) acc_x 90.6250 (81.8750) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/34] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 0.6582 (0.7126) acc_x 84.3750 (82.7083) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/34] time 0.184 (0.178) data 0.108 (0.101) loss_x loss_x 0.9409 (0.7164) acc_x 78.1250 (82.3438) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/34] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.5210 (0.6901) acc_x 84.3750 (82.7500) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [30/34] time 0.175 (0.180) data 0.097 (0.102) loss_x loss_x 0.7285 (0.6917) acc_x 81.2500 (82.6042) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/16] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.7080 (0.7148) acc_u 31.2500 (34.3750) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/16] time 0.187 (0.180) data 0.109 (0.103) loss_u loss_u 0.6333 (0.7029) acc_u 43.7500 (35.3125) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/16] time 0.203 (0.181) data 0.123 (0.103) loss_u loss_u 0.8735 (0.7155) acc_u 15.6250 (34.1667) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 376
confident_label rate tensor(0.6720, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1086
clean true:1086
clean false:0
clean_rate:1.0
noisy true:154
noisy false:376
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 530
epoch [103/200] batch [5/33] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.4216 (0.5680) acc_x 93.7500 (85.6250) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/33] time 0.181 (0.182) data 0.103 (0.104) loss_x loss_x 0.4348 (0.6069) acc_x 90.6250 (84.3750) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/33] time 0.165 (0.181) data 0.088 (0.103) loss_x loss_x 0.6934 (0.6370) acc_x 81.2500 (83.1250) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/33] time 0.184 (0.182) data 0.106 (0.104) loss_x loss_x 0.8232 (0.6197) acc_x 81.2500 (83.9062) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/33] time 0.178 (0.182) data 0.101 (0.104) loss_x loss_x 0.5298 (0.6129) acc_x 84.3750 (84.5000) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [30/33] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.5913 (0.6183) acc_x 84.3750 (84.1667) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/16] time 0.184 (0.182) data 0.105 (0.105) loss_u loss_u 0.8359 (0.7240) acc_u 18.7500 (34.3750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/16] time 0.177 (0.181) data 0.098 (0.103) loss_u loss_u 0.8438 (0.7242) acc_u 15.6250 (33.4375) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [15/16] time 0.185 (0.181) data 0.107 (0.103) loss_u loss_u 0.6279 (0.7332) acc_u 37.5000 (31.4583) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 390
confident_label rate tensor(0.6646, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1074
clean true:1074
clean false:0
clean_rate:1.0
noisy true:152
noisy false:390
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 542
epoch [104/200] batch [5/33] time 0.171 (0.186) data 0.094 (0.108) loss_x loss_x 1.2471 (0.5136) acc_x 75.0000 (88.1250) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [10/33] time 0.162 (0.180) data 0.085 (0.102) loss_x loss_x 0.7324 (0.5256) acc_x 78.1250 (87.1875) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/33] time 0.177 (0.177) data 0.100 (0.100) loss_x loss_x 0.9209 (0.5493) acc_x 78.1250 (86.0417) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/33] time 0.176 (0.178) data 0.098 (0.100) loss_x loss_x 0.6416 (0.5959) acc_x 84.3750 (85.0000) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/33] time 0.185 (0.179) data 0.108 (0.101) loss_x loss_x 0.6616 (0.6135) acc_x 78.1250 (84.0000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [30/33] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.8511 (0.6233) acc_x 81.2500 (83.8542) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/16] time 0.171 (0.178) data 0.093 (0.101) loss_u loss_u 0.6919 (0.6950) acc_u 34.3750 (35.0000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/16] time 0.161 (0.177) data 0.083 (0.099) loss_u loss_u 0.6436 (0.7001) acc_u 43.7500 (35.0000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [15/16] time 0.186 (0.176) data 0.109 (0.098) loss_u loss_u 0.7861 (0.6989) acc_u 21.8750 (35.2083) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 379
confident_label rate tensor(0.6745, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1090
clean true:1090
clean false:0
clean_rate:1.0
noisy true:147
noisy false:379
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 526
epoch [105/200] batch [5/34] time 0.175 (0.183) data 0.097 (0.105) loss_x loss_x 0.7422 (0.4722) acc_x 78.1250 (86.8750) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [10/34] time 0.179 (0.184) data 0.101 (0.107) loss_x loss_x 0.6108 (0.5427) acc_x 84.3750 (84.3750) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/34] time 0.170 (0.182) data 0.093 (0.104) loss_x loss_x 0.6597 (0.5534) acc_x 81.2500 (84.3750) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/34] time 0.184 (0.181) data 0.106 (0.104) loss_x loss_x 0.4692 (0.5867) acc_x 81.2500 (83.5938) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/34] time 0.184 (0.182) data 0.107 (0.104) loss_x loss_x 0.4028 (0.5864) acc_x 93.7500 (83.8750) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [30/34] time 0.184 (0.184) data 0.104 (0.106) loss_x loss_x 0.4438 (0.5883) acc_x 84.3750 (84.3750) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/16] time 0.188 (0.181) data 0.110 (0.104) loss_u loss_u 0.7114 (0.7337) acc_u 34.3750 (32.5000) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/16] time 0.191 (0.181) data 0.114 (0.103) loss_u loss_u 0.6938 (0.7296) acc_u 34.3750 (32.1875) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [15/16] time 0.190 (0.182) data 0.112 (0.104) loss_u loss_u 0.6558 (0.7292) acc_u 40.6250 (31.6667) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 387
confident_label rate tensor(0.6714, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1085
clean true:1082
clean false:3
clean_rate:0.9972350230414746
noisy true:147
noisy false:384
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 531
epoch [106/200] batch [5/33] time 0.183 (0.182) data 0.105 (0.104) loss_x loss_x 1.0205 (0.6022) acc_x 78.1250 (86.2500) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/33] time 0.172 (0.178) data 0.093 (0.100) loss_x loss_x 0.5869 (0.5401) acc_x 87.5000 (87.1875) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/33] time 0.162 (0.178) data 0.084 (0.100) loss_x loss_x 0.6113 (0.6011) acc_x 87.5000 (85.6250) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/33] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.3765 (0.5828) acc_x 90.6250 (85.6250) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/33] time 0.167 (0.177) data 0.089 (0.099) loss_x loss_x 0.7275 (0.6082) acc_x 84.3750 (84.6250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [30/33] time 0.167 (0.178) data 0.090 (0.100) loss_x loss_x 0.6665 (0.6351) acc_x 75.0000 (84.3750) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/16] time 0.162 (0.176) data 0.083 (0.098) loss_u loss_u 0.7065 (0.6936) acc_u 34.3750 (33.1250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [10/16] time 0.175 (0.175) data 0.097 (0.098) loss_u loss_u 0.6763 (0.6729) acc_u 34.3750 (37.5000) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/16] time 0.190 (0.175) data 0.112 (0.097) loss_u loss_u 0.7227 (0.6946) acc_u 31.2500 (34.5833) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 379
confident_label rate tensor(0.6745, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1090
clean true:1089
clean false:1
clean_rate:0.9990825688073395
noisy true:148
noisy false:378
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 526
epoch [107/200] batch [5/34] time 0.187 (0.186) data 0.109 (0.108) loss_x loss_x 0.9956 (0.6978) acc_x 75.0000 (84.3750) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/34] time 0.171 (0.182) data 0.094 (0.104) loss_x loss_x 0.4482 (0.6626) acc_x 87.5000 (83.1250) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/34] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.5400 (0.6442) acc_x 75.0000 (82.9167) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/34] time 0.189 (0.180) data 0.111 (0.102) loss_x loss_x 0.8486 (0.6578) acc_x 71.8750 (82.3438) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/34] time 0.204 (0.180) data 0.126 (0.103) loss_x loss_x 0.7856 (0.6611) acc_x 84.3750 (82.2500) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [30/34] time 0.200 (0.182) data 0.123 (0.104) loss_x loss_x 0.4751 (0.6404) acc_x 90.6250 (83.0208) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/16] time 0.190 (0.184) data 0.112 (0.106) loss_u loss_u 0.7549 (0.7268) acc_u 25.0000 (31.8750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/16] time 0.213 (0.184) data 0.135 (0.107) loss_u loss_u 0.8120 (0.7446) acc_u 25.0000 (30.9375) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/16] time 0.190 (0.185) data 0.112 (0.107) loss_u loss_u 0.7070 (0.7326) acc_u 31.2500 (31.2500) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 391
confident_label rate tensor(0.6646, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1074
clean true:1072
clean false:2
clean_rate:0.9981378026070763
noisy true:153
noisy false:389
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 542
epoch [108/200] batch [5/33] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.3318 (0.6655) acc_x 90.6250 (80.6250) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/33] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.3784 (0.5952) acc_x 96.8750 (84.3750) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/33] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.5005 (0.5679) acc_x 93.7500 (85.6250) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/33] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.3074 (0.5297) acc_x 90.6250 (86.4062) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/33] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.8325 (0.5415) acc_x 78.1250 (86.0000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [30/33] time 0.166 (0.185) data 0.089 (0.107) loss_x loss_x 0.2778 (0.5332) acc_x 96.8750 (86.5625) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/16] time 0.180 (0.183) data 0.103 (0.105) loss_u loss_u 0.6909 (0.6765) acc_u 34.3750 (38.1250) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/16] time 0.185 (0.183) data 0.106 (0.105) loss_u loss_u 0.6567 (0.6837) acc_u 40.6250 (36.2500) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/16] time 0.202 (0.184) data 0.123 (0.106) loss_u loss_u 0.6553 (0.6967) acc_u 40.6250 (34.5833) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 370
confident_label rate tensor(0.6745, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1090
clean true:1089
clean false:1
clean_rate:0.9990825688073395
noisy true:157
noisy false:369
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 526
epoch [109/200] batch [5/34] time 0.176 (0.183) data 0.097 (0.105) loss_x loss_x 0.8027 (0.5761) acc_x 75.0000 (81.2500) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/34] time 0.220 (0.189) data 0.142 (0.112) loss_x loss_x 0.7251 (0.5756) acc_x 87.5000 (84.0625) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/34] time 0.189 (0.188) data 0.110 (0.111) loss_x loss_x 0.4092 (0.5433) acc_x 84.3750 (85.0000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/34] time 0.184 (0.187) data 0.106 (0.110) loss_x loss_x 0.9116 (0.6228) acc_x 78.1250 (84.3750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/34] time 0.196 (0.188) data 0.119 (0.110) loss_x loss_x 0.4473 (0.6018) acc_x 84.3750 (84.1250) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [30/34] time 0.174 (0.186) data 0.096 (0.108) loss_x loss_x 0.3113 (0.6052) acc_x 84.3750 (84.3750) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/16] time 0.166 (0.184) data 0.087 (0.106) loss_u loss_u 0.7163 (0.6612) acc_u 31.2500 (38.7500) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [10/16] time 0.171 (0.184) data 0.092 (0.106) loss_u loss_u 0.7031 (0.6896) acc_u 31.2500 (35.0000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [15/16] time 0.181 (0.183) data 0.104 (0.105) loss_u loss_u 0.7173 (0.6862) acc_u 31.2500 (34.5833) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 384
confident_label rate tensor(0.6665, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1077
clean true:1076
clean false:1
clean_rate:0.9990714948932219
noisy true:156
noisy false:383
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 539
epoch [110/200] batch [5/33] time 0.167 (0.173) data 0.090 (0.095) loss_x loss_x 0.9961 (0.7328) acc_x 78.1250 (82.5000) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/33] time 0.180 (0.174) data 0.102 (0.097) loss_x loss_x 0.2422 (0.6512) acc_x 93.7500 (83.4375) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/33] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.3398 (0.6196) acc_x 90.6250 (83.3333) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/33] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 0.5552 (0.6237) acc_x 87.5000 (84.0625) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/33] time 0.184 (0.179) data 0.107 (0.101) loss_x loss_x 0.7085 (0.6501) acc_x 81.2500 (82.7500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [30/33] time 0.181 (0.179) data 0.103 (0.101) loss_x loss_x 0.4885 (0.6242) acc_x 90.6250 (83.7500) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/16] time 0.175 (0.178) data 0.097 (0.100) loss_u loss_u 0.6514 (0.7406) acc_u 37.5000 (30.6250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/16] time 0.166 (0.177) data 0.088 (0.099) loss_u loss_u 0.5962 (0.7108) acc_u 40.6250 (33.7500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/16] time 0.170 (0.178) data 0.092 (0.100) loss_u loss_u 0.6997 (0.7195) acc_u 31.2500 (32.9167) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 390
confident_label rate tensor(0.6702, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1083
clean true:1082
clean false:1
clean_rate:0.9990766389658357
noisy true:144
noisy false:389
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 533
epoch [111/200] batch [5/33] time 0.171 (0.168) data 0.094 (0.090) loss_x loss_x 0.2396 (0.5323) acc_x 93.7500 (84.3750) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [10/33] time 0.167 (0.171) data 0.090 (0.093) loss_x loss_x 0.7236 (0.5973) acc_x 87.5000 (84.3750) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [15/33] time 0.200 (0.173) data 0.123 (0.095) loss_x loss_x 0.2742 (0.5969) acc_x 93.7500 (84.7917) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/33] time 0.188 (0.173) data 0.111 (0.096) loss_x loss_x 0.7031 (0.6026) acc_x 78.1250 (83.5938) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/33] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.8760 (0.6224) acc_x 81.2500 (83.6250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [30/33] time 0.180 (0.172) data 0.103 (0.094) loss_x loss_x 0.3706 (0.6056) acc_x 93.7500 (84.2708) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/16] time 0.208 (0.173) data 0.130 (0.095) loss_u loss_u 0.7695 (0.6848) acc_u 31.2500 (35.6250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/16] time 0.174 (0.173) data 0.096 (0.096) loss_u loss_u 0.7500 (0.7173) acc_u 31.2500 (32.8125) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/16] time 0.189 (0.175) data 0.110 (0.097) loss_u loss_u 0.6479 (0.7087) acc_u 43.7500 (34.1667) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 385
confident_label rate tensor(0.6683, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1080
clean true:1079
clean false:1
clean_rate:0.9990740740740741
noisy true:152
noisy false:384
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 536
epoch [112/200] batch [5/33] time 0.173 (0.178) data 0.094 (0.101) loss_x loss_x 0.5435 (0.5117) acc_x 87.5000 (86.2500) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/33] time 0.170 (0.178) data 0.092 (0.100) loss_x loss_x 0.4641 (0.5385) acc_x 81.2500 (85.6250) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/33] time 0.178 (0.178) data 0.100 (0.100) loss_x loss_x 0.4854 (0.5419) acc_x 93.7500 (86.6667) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/33] time 0.180 (0.176) data 0.102 (0.099) loss_x loss_x 0.2654 (0.5698) acc_x 96.8750 (85.3125) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/33] time 0.162 (0.175) data 0.084 (0.097) loss_x loss_x 0.7090 (0.6022) acc_x 78.1250 (84.0000) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [30/33] time 0.163 (0.174) data 0.086 (0.096) loss_x loss_x 0.6382 (0.5925) acc_x 81.2500 (84.0625) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/16] time 0.169 (0.172) data 0.090 (0.094) loss_u loss_u 0.8086 (0.7261) acc_u 18.7500 (35.6250) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/16] time 0.168 (0.172) data 0.089 (0.094) loss_u loss_u 0.6851 (0.7218) acc_u 37.5000 (33.7500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [15/16] time 0.177 (0.172) data 0.099 (0.094) loss_u loss_u 0.8423 (0.7179) acc_u 21.8750 (33.9583) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 393
confident_label rate tensor(0.6671, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1078
clean true:1076
clean false:2
clean_rate:0.9981447124304267
noisy true:147
noisy false:391
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 538
epoch [113/200] batch [5/33] time 0.185 (0.171) data 0.107 (0.093) loss_x loss_x 0.8208 (0.6985) acc_x 78.1250 (80.6250) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/33] time 0.159 (0.168) data 0.081 (0.090) loss_x loss_x 0.8916 (0.7071) acc_x 78.1250 (81.5625) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [15/33] time 0.164 (0.167) data 0.086 (0.089) loss_x loss_x 0.7466 (0.7066) acc_x 84.3750 (81.6667) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [20/33] time 0.166 (0.166) data 0.088 (0.089) loss_x loss_x 0.2465 (0.6306) acc_x 96.8750 (83.7500) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/33] time 0.182 (0.170) data 0.104 (0.092) loss_x loss_x 0.7168 (0.6523) acc_x 81.2500 (83.1250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [30/33] time 0.184 (0.172) data 0.106 (0.095) loss_x loss_x 1.0635 (0.6603) acc_x 71.8750 (83.2292) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/16] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.6650 (0.7017) acc_u 43.7500 (36.2500) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/16] time 0.188 (0.175) data 0.111 (0.098) loss_u loss_u 0.5771 (0.7051) acc_u 46.8750 (33.7500) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [15/16] time 0.187 (0.176) data 0.108 (0.099) loss_u loss_u 0.6274 (0.6958) acc_u 46.8750 (35.8333) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 378
confident_label rate tensor(0.6745, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1090
clean true:1089
clean false:1
clean_rate:0.9990825688073395
noisy true:149
noisy false:377
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 526
epoch [114/200] batch [5/34] time 0.181 (0.168) data 0.104 (0.091) loss_x loss_x 0.4431 (0.4428) acc_x 93.7500 (87.5000) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/34] time 0.185 (0.172) data 0.107 (0.094) loss_x loss_x 0.5566 (0.5454) acc_x 81.2500 (85.0000) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/34] time 0.187 (0.176) data 0.109 (0.099) loss_x loss_x 0.4045 (0.5257) acc_x 87.5000 (85.4167) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/34] time 0.187 (0.181) data 0.109 (0.104) loss_x loss_x 0.4880 (0.5417) acc_x 84.3750 (85.0000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/34] time 0.260 (0.186) data 0.183 (0.109) loss_x loss_x 0.6050 (0.5458) acc_x 81.2500 (85.0000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [30/34] time 0.178 (0.184) data 0.101 (0.107) loss_x loss_x 0.6572 (0.5690) acc_x 87.5000 (84.8958) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/16] time 0.184 (0.184) data 0.107 (0.106) loss_u loss_u 0.6982 (0.6996) acc_u 31.2500 (34.3750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/16] time 0.177 (0.184) data 0.099 (0.106) loss_u loss_u 0.7651 (0.7139) acc_u 28.1250 (32.1875) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [15/16] time 0.179 (0.183) data 0.101 (0.105) loss_u loss_u 0.7920 (0.7315) acc_u 25.0000 (30.8333) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 381
confident_label rate tensor(0.6683, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1080
clean true:1078
clean false:2
clean_rate:0.9981481481481481
noisy true:157
noisy false:379
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 536
epoch [115/200] batch [5/33] time 0.168 (0.180) data 0.090 (0.103) loss_x loss_x 0.6260 (0.6945) acc_x 84.3750 (81.2500) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/33] time 0.172 (0.180) data 0.094 (0.102) loss_x loss_x 0.8779 (0.6284) acc_x 81.2500 (83.1250) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/33] time 0.183 (0.178) data 0.106 (0.100) loss_x loss_x 0.7017 (0.6255) acc_x 81.2500 (83.1250) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/33] time 0.160 (0.175) data 0.083 (0.098) loss_x loss_x 0.5254 (0.6078) acc_x 84.3750 (83.1250) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/33] time 0.184 (0.174) data 0.106 (0.097) loss_x loss_x 0.7246 (0.6022) acc_x 78.1250 (83.6250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [30/33] time 0.169 (0.174) data 0.091 (0.096) loss_x loss_x 0.4514 (0.6200) acc_x 84.3750 (83.0208) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/16] time 0.163 (0.172) data 0.084 (0.094) loss_u loss_u 0.6313 (0.6830) acc_u 46.8750 (38.1250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/16] time 0.169 (0.172) data 0.092 (0.094) loss_u loss_u 0.7075 (0.6828) acc_u 34.3750 (36.2500) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [15/16] time 0.168 (0.172) data 0.090 (0.094) loss_u loss_u 0.6602 (0.6883) acc_u 34.3750 (35.0000) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 373
confident_label rate tensor(0.6782, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1096
clean true:1093
clean false:3
clean_rate:0.9972627737226277
noisy true:150
noisy false:370
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 520
epoch [116/200] batch [5/34] time 0.186 (0.186) data 0.109 (0.108) loss_x loss_x 0.6719 (0.5720) acc_x 75.0000 (85.0000) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [10/34] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.8604 (0.5952) acc_x 78.1250 (85.0000) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/34] time 0.183 (0.185) data 0.106 (0.107) loss_x loss_x 0.2932 (0.5822) acc_x 96.8750 (85.8333) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/34] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.7539 (0.5977) acc_x 84.3750 (85.4688) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/34] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 0.7314 (0.5933) acc_x 84.3750 (85.6250) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [30/34] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 0.6333 (0.5987) acc_x 78.1250 (85.0000) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/16] time 0.168 (0.183) data 0.090 (0.105) loss_u loss_u 0.7246 (0.7279) acc_u 37.5000 (33.7500) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/16] time 0.173 (0.182) data 0.095 (0.105) loss_u loss_u 0.8203 (0.7286) acc_u 18.7500 (31.5625) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [15/16] time 0.181 (0.182) data 0.102 (0.104) loss_u loss_u 0.7197 (0.7253) acc_u 34.3750 (31.6667) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 376
confident_label rate tensor(0.6683, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1080
clean true:1079
clean false:1
clean_rate:0.9990740740740741
noisy true:161
noisy false:375
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 536
epoch [117/200] batch [5/33] time 0.172 (0.181) data 0.094 (0.103) loss_x loss_x 0.2590 (0.5526) acc_x 96.8750 (87.5000) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/33] time 0.175 (0.178) data 0.097 (0.100) loss_x loss_x 0.5493 (0.5931) acc_x 84.3750 (84.0625) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/33] time 0.168 (0.176) data 0.090 (0.097) loss_x loss_x 0.6987 (0.5797) acc_x 75.0000 (84.3750) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/33] time 0.168 (0.176) data 0.091 (0.098) loss_x loss_x 0.3167 (0.5661) acc_x 90.6250 (85.0000) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/33] time 0.171 (0.174) data 0.094 (0.096) loss_x loss_x 0.5161 (0.5777) acc_x 87.5000 (84.7500) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [30/33] time 0.184 (0.175) data 0.106 (0.097) loss_x loss_x 0.3892 (0.5657) acc_x 93.7500 (85.4167) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/16] time 0.159 (0.176) data 0.081 (0.098) loss_u loss_u 0.7622 (0.6896) acc_u 28.1250 (38.7500) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/16] time 0.186 (0.175) data 0.107 (0.097) loss_u loss_u 0.6470 (0.7091) acc_u 34.3750 (34.3750) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [15/16] time 0.175 (0.175) data 0.096 (0.097) loss_u loss_u 0.7456 (0.7128) acc_u 34.3750 (33.5417) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 373
confident_label rate tensor(0.6776, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1095
clean true:1094
clean false:1
clean_rate:0.9990867579908675
noisy true:149
noisy false:372
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 521
epoch [118/200] batch [5/34] time 0.182 (0.174) data 0.104 (0.097) loss_x loss_x 0.4302 (0.5181) acc_x 87.5000 (85.0000) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/34] time 0.195 (0.181) data 0.116 (0.104) loss_x loss_x 0.7163 (0.5368) acc_x 75.0000 (85.3125) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/34] time 0.184 (0.183) data 0.107 (0.105) loss_x loss_x 0.8027 (0.5189) acc_x 81.2500 (86.0417) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/34] time 0.186 (0.183) data 0.107 (0.105) loss_x loss_x 0.4309 (0.5509) acc_x 87.5000 (85.6250) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/34] time 0.188 (0.183) data 0.110 (0.105) loss_x loss_x 0.2321 (0.5526) acc_x 96.8750 (84.7500) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [30/34] time 0.181 (0.183) data 0.103 (0.106) loss_x loss_x 0.4592 (0.5588) acc_x 84.3750 (84.4792) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/16] time 0.181 (0.183) data 0.104 (0.105) loss_u loss_u 0.7515 (0.7548) acc_u 31.2500 (29.3750) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/16] time 0.215 (0.184) data 0.136 (0.106) loss_u loss_u 0.6729 (0.7329) acc_u 34.3750 (30.6250) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [15/16] time 0.194 (0.186) data 0.116 (0.108) loss_u loss_u 0.6104 (0.7180) acc_u 50.0000 (32.9167) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 388
confident_label rate tensor(0.6708, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1084
clean true:1083
clean false:1
clean_rate:0.9990774907749077
noisy true:145
noisy false:387
after delete: len(clean_dataset) 1084
after delete: len(noisy_dataset) 532
epoch [119/200] batch [5/33] time 0.181 (0.190) data 0.104 (0.113) loss_x loss_x 0.5229 (0.4936) acc_x 84.3750 (86.2500) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [10/33] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.5283 (0.6155) acc_x 81.2500 (82.8125) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/33] time 0.182 (0.179) data 0.104 (0.102) loss_x loss_x 0.5034 (0.5682) acc_x 84.3750 (84.3750) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/33] time 0.159 (0.178) data 0.082 (0.101) loss_x loss_x 0.7773 (0.5735) acc_x 81.2500 (83.9062) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/33] time 0.164 (0.175) data 0.086 (0.098) loss_x loss_x 0.7915 (0.5766) acc_x 78.1250 (83.6250) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [30/33] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.5059 (0.6008) acc_x 90.6250 (83.4375) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/16] time 0.166 (0.173) data 0.087 (0.096) loss_u loss_u 0.7007 (0.6931) acc_u 34.3750 (37.5000) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/16] time 0.188 (0.174) data 0.109 (0.096) loss_u loss_u 0.8062 (0.7027) acc_u 21.8750 (35.3125) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [15/16] time 0.177 (0.174) data 0.099 (0.096) loss_u loss_u 0.6919 (0.7114) acc_u 40.6250 (34.5833) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 391
confident_label rate tensor(0.6652, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1075
clean true:1074
clean false:1
clean_rate:0.9990697674418605
noisy true:151
noisy false:390
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 541
epoch [120/200] batch [5/33] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.7432 (0.7021) acc_x 84.3750 (83.7500) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [10/33] time 0.189 (0.187) data 0.112 (0.109) loss_x loss_x 0.4973 (0.5633) acc_x 87.5000 (87.1875) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/33] time 0.186 (0.186) data 0.107 (0.108) loss_x loss_x 0.5869 (0.5642) acc_x 90.6250 (86.6667) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/33] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.9380 (0.6172) acc_x 68.7500 (84.5312) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/33] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.2671 (0.5790) acc_x 93.7500 (85.3750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [30/33] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.6016 (0.5693) acc_x 81.2500 (85.1042) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/16] time 0.185 (0.185) data 0.107 (0.107) loss_u loss_u 0.6484 (0.6908) acc_u 40.6250 (34.3750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/16] time 0.190 (0.185) data 0.111 (0.107) loss_u loss_u 0.5884 (0.6747) acc_u 46.8750 (35.3125) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [15/16] time 0.184 (0.185) data 0.107 (0.107) loss_u loss_u 0.6787 (0.6802) acc_u 34.3750 (35.6250) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 359
confident_label rate tensor(0.6819, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1102
clean true:1101
clean false:1
clean_rate:0.9990925589836661
noisy true:156
noisy false:358
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 514
epoch [121/200] batch [5/34] time 0.183 (0.181) data 0.104 (0.103) loss_x loss_x 0.5005 (0.5327) acc_x 93.7500 (88.1250) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [10/34] time 0.173 (0.177) data 0.094 (0.100) loss_x loss_x 0.7300 (0.5540) acc_x 78.1250 (85.0000) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/34] time 0.175 (0.177) data 0.097 (0.099) loss_x loss_x 0.5376 (0.5475) acc_x 84.3750 (85.2083) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [20/34] time 0.169 (0.175) data 0.091 (0.097) loss_x loss_x 0.5547 (0.5199) acc_x 84.3750 (85.6250) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/34] time 0.181 (0.176) data 0.104 (0.098) loss_x loss_x 0.4829 (0.5164) acc_x 87.5000 (85.5000) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [30/34] time 0.221 (0.179) data 0.142 (0.101) loss_x loss_x 0.3635 (0.5226) acc_x 90.6250 (85.3125) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/16] time 0.163 (0.180) data 0.085 (0.102) loss_u loss_u 0.8550 (0.7812) acc_u 15.6250 (25.6250) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/16] time 0.161 (0.178) data 0.083 (0.100) loss_u loss_u 0.6543 (0.7582) acc_u 40.6250 (28.4375) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [15/16] time 0.179 (0.178) data 0.100 (0.100) loss_u loss_u 0.6401 (0.7301) acc_u 46.8750 (31.6667) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 369
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1099
clean true:1097
clean false:2
clean_rate:0.9981801637852593
noisy true:150
noisy false:367
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 517
epoch [122/200] batch [5/34] time 0.180 (0.177) data 0.103 (0.099) loss_x loss_x 0.4238 (0.4731) acc_x 84.3750 (88.7500) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [10/34] time 0.200 (0.181) data 0.123 (0.104) loss_x loss_x 0.6660 (0.5720) acc_x 84.3750 (86.2500) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/34] time 0.174 (0.179) data 0.096 (0.101) loss_x loss_x 0.4873 (0.5994) acc_x 84.3750 (85.4167) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/34] time 0.165 (0.179) data 0.086 (0.101) loss_x loss_x 0.5513 (0.5618) acc_x 90.6250 (86.4062) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/34] time 0.166 (0.176) data 0.088 (0.098) loss_x loss_x 0.4812 (0.5473) acc_x 84.3750 (86.6250) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [30/34] time 0.174 (0.175) data 0.094 (0.097) loss_x loss_x 0.2378 (0.5294) acc_x 93.7500 (86.9792) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/16] time 0.186 (0.173) data 0.108 (0.095) loss_u loss_u 0.6069 (0.6979) acc_u 43.7500 (35.6250) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/16] time 0.170 (0.173) data 0.092 (0.095) loss_u loss_u 0.6567 (0.6982) acc_u 40.6250 (35.0000) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [15/16] time 0.168 (0.173) data 0.090 (0.095) loss_u loss_u 0.7075 (0.7170) acc_u 34.3750 (32.5000) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 365
confident_label rate tensor(0.6739, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1089
clean true:1089
clean false:0
clean_rate:1.0
noisy true:162
noisy false:365
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 527
epoch [123/200] batch [5/34] time 0.221 (0.209) data 0.143 (0.131) loss_x loss_x 0.8110 (0.5986) acc_x 81.2500 (85.6250) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [10/34] time 0.188 (0.198) data 0.111 (0.120) loss_x loss_x 0.4824 (0.6188) acc_x 87.5000 (83.7500) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/34] time 0.164 (0.191) data 0.086 (0.113) loss_x loss_x 0.6904 (0.6181) acc_x 81.2500 (83.7500) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/34] time 0.176 (0.186) data 0.097 (0.108) loss_x loss_x 0.5645 (0.5928) acc_x 78.1250 (84.0625) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/34] time 0.187 (0.185) data 0.110 (0.107) loss_x loss_x 0.2000 (0.5796) acc_x 96.8750 (84.3750) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [30/34] time 0.187 (0.185) data 0.109 (0.108) loss_x loss_x 0.4287 (0.6158) acc_x 90.6250 (83.5417) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/16] time 0.163 (0.185) data 0.085 (0.107) loss_u loss_u 0.8579 (0.7523) acc_u 15.6250 (26.8750) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/16] time 0.188 (0.186) data 0.110 (0.108) loss_u loss_u 0.7173 (0.7099) acc_u 31.2500 (32.8125) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [15/16] time 0.171 (0.184) data 0.092 (0.106) loss_u loss_u 0.7637 (0.7127) acc_u 31.2500 (32.9167) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 380
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1098
clean true:1096
clean false:2
clean_rate:0.9981785063752276
noisy true:140
noisy false:378
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 518
epoch [124/200] batch [5/34] time 0.190 (0.186) data 0.112 (0.108) loss_x loss_x 0.4199 (0.7311) acc_x 87.5000 (85.0000) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/34] time 0.170 (0.180) data 0.093 (0.102) loss_x loss_x 0.6274 (0.6761) acc_x 84.3750 (84.6875) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/34] time 0.168 (0.176) data 0.091 (0.098) loss_x loss_x 0.4485 (0.6435) acc_x 84.3750 (84.5833) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/34] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.6133 (0.6365) acc_x 81.2500 (83.9062) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/34] time 0.164 (0.172) data 0.087 (0.094) loss_x loss_x 0.8301 (0.6407) acc_x 71.8750 (84.0000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [30/34] time 0.189 (0.174) data 0.109 (0.096) loss_x loss_x 0.5063 (0.6459) acc_x 87.5000 (83.5417) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/16] time 0.168 (0.175) data 0.090 (0.097) loss_u loss_u 0.5854 (0.6922) acc_u 50.0000 (37.5000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/16] time 0.189 (0.176) data 0.111 (0.098) loss_u loss_u 0.7266 (0.7019) acc_u 34.3750 (36.5625) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [15/16] time 0.187 (0.177) data 0.108 (0.099) loss_u loss_u 0.6455 (0.7094) acc_u 40.6250 (35.0000) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 356
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1115
clean true:1115
clean false:0
clean_rate:1.0
noisy true:145
noisy false:356
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 501
epoch [125/200] batch [5/34] time 0.174 (0.180) data 0.096 (0.102) loss_x loss_x 0.3130 (0.5295) acc_x 90.6250 (85.6250) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [10/34] time 0.159 (0.172) data 0.082 (0.094) loss_x loss_x 0.4504 (0.5029) acc_x 87.5000 (86.2500) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/34] time 0.164 (0.171) data 0.085 (0.094) loss_x loss_x 0.6875 (0.5376) acc_x 87.5000 (85.6250) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/34] time 0.163 (0.170) data 0.086 (0.093) loss_x loss_x 0.2603 (0.5557) acc_x 93.7500 (84.5312) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/34] time 0.182 (0.170) data 0.104 (0.092) loss_x loss_x 0.6440 (0.5665) acc_x 81.2500 (84.0000) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [30/34] time 0.185 (0.172) data 0.107 (0.094) loss_x loss_x 0.4475 (0.5550) acc_x 93.7500 (84.8958) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/15] time 0.186 (0.176) data 0.107 (0.098) loss_u loss_u 0.6494 (0.7416) acc_u 40.6250 (28.7500) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/15] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.7861 (0.7612) acc_u 21.8750 (28.1250) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [15/15] time 0.167 (0.177) data 0.087 (0.099) loss_u loss_u 0.6753 (0.7513) acc_u 34.3750 (29.3750) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 367
confident_label rate tensor(0.6813, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1101
clean true:1100
clean false:1
clean_rate:0.9990917347865577
noisy true:149
noisy false:366
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 515
epoch [126/200] batch [5/34] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.5825 (0.5390) acc_x 87.5000 (86.8750) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/34] time 0.187 (0.180) data 0.109 (0.103) loss_x loss_x 0.6143 (0.5484) acc_x 78.1250 (85.0000) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/34] time 0.164 (0.176) data 0.086 (0.098) loss_x loss_x 0.4312 (0.5382) acc_x 90.6250 (85.8333) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/34] time 0.163 (0.174) data 0.086 (0.097) loss_x loss_x 0.3745 (0.5461) acc_x 87.5000 (85.6250) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/34] time 0.173 (0.175) data 0.095 (0.097) loss_x loss_x 0.8555 (0.5467) acc_x 84.3750 (86.0000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [30/34] time 0.173 (0.175) data 0.095 (0.097) loss_x loss_x 0.7310 (0.5554) acc_x 84.3750 (86.0417) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/16] time 0.190 (0.177) data 0.112 (0.099) loss_u loss_u 0.7930 (0.7277) acc_u 21.8750 (32.5000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/16] time 0.185 (0.178) data 0.107 (0.100) loss_u loss_u 0.6904 (0.7173) acc_u 37.5000 (32.5000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [15/16] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.8091 (0.7166) acc_u 21.8750 (32.9167) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 349
confident_label rate tensor(0.6918, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1118
clean true:1116
clean false:2
clean_rate:0.998211091234347
noisy true:151
noisy false:347
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 498
epoch [127/200] batch [5/34] time 0.185 (0.188) data 0.108 (0.110) loss_x loss_x 0.5845 (0.6272) acc_x 84.3750 (83.1250) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [10/34] time 0.186 (0.187) data 0.109 (0.109) loss_x loss_x 0.5464 (0.5874) acc_x 87.5000 (83.7500) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/34] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.3745 (0.5540) acc_x 93.7500 (84.5833) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/34] time 0.187 (0.187) data 0.109 (0.109) loss_x loss_x 0.5532 (0.5726) acc_x 84.3750 (84.0625) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/34] time 0.189 (0.187) data 0.111 (0.109) loss_x loss_x 0.2295 (0.5481) acc_x 93.7500 (84.8750) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [30/34] time 0.172 (0.186) data 0.095 (0.108) loss_x loss_x 0.8364 (0.5751) acc_x 78.1250 (83.9583) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/15] time 0.170 (0.185) data 0.092 (0.108) loss_u loss_u 0.7446 (0.7388) acc_u 34.3750 (31.2500) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/15] time 0.171 (0.185) data 0.091 (0.107) loss_u loss_u 0.8174 (0.7650) acc_u 21.8750 (27.8125) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [15/15] time 0.182 (0.184) data 0.104 (0.106) loss_u loss_u 0.7090 (0.7458) acc_u 40.6250 (29.7917) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 370
confident_label rate tensor(0.6832, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1104
clean true:1102
clean false:2
clean_rate:0.9981884057971014
noisy true:144
noisy false:368
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 512
epoch [128/200] batch [5/34] time 0.189 (0.191) data 0.112 (0.114) loss_x loss_x 0.5049 (0.5856) acc_x 87.5000 (81.8750) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [10/34] time 0.171 (0.181) data 0.094 (0.103) loss_x loss_x 0.8682 (0.6478) acc_x 71.8750 (81.5625) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/34] time 0.171 (0.177) data 0.092 (0.099) loss_x loss_x 0.3733 (0.6669) acc_x 93.7500 (81.8750) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [20/34] time 0.187 (0.178) data 0.109 (0.100) loss_x loss_x 0.7827 (0.6631) acc_x 78.1250 (81.7188) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/34] time 0.173 (0.179) data 0.096 (0.101) loss_x loss_x 0.7705 (0.6570) acc_x 78.1250 (82.1250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [30/34] time 0.174 (0.178) data 0.096 (0.100) loss_x loss_x 0.5444 (0.6545) acc_x 84.3750 (82.0833) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/16] time 0.185 (0.178) data 0.108 (0.100) loss_u loss_u 0.6870 (0.6975) acc_u 37.5000 (33.7500) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/16] time 0.184 (0.178) data 0.107 (0.100) loss_u loss_u 0.7510 (0.6941) acc_u 31.2500 (34.6875) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [15/16] time 0.173 (0.177) data 0.094 (0.099) loss_u loss_u 0.6753 (0.7069) acc_u 37.5000 (33.1250) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 388
confident_label rate tensor(0.6646, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1074
clean true:1073
clean false:1
clean_rate:0.9990689013035382
noisy true:155
noisy false:387
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 542
epoch [129/200] batch [5/33] time 0.167 (0.187) data 0.090 (0.109) loss_x loss_x 0.5493 (0.7228) acc_x 84.3750 (81.8750) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [10/33] time 0.171 (0.182) data 0.094 (0.104) loss_x loss_x 0.9453 (0.6779) acc_x 65.6250 (82.1875) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/33] time 0.186 (0.180) data 0.108 (0.102) loss_x loss_x 0.3733 (0.6199) acc_x 87.5000 (83.5417) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/33] time 0.178 (0.181) data 0.100 (0.103) loss_x loss_x 0.4944 (0.5836) acc_x 84.3750 (84.8438) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/33] time 0.174 (0.180) data 0.097 (0.102) loss_x loss_x 0.5264 (0.5712) acc_x 87.5000 (85.1250) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/33] time 0.172 (0.178) data 0.094 (0.101) loss_x loss_x 0.3708 (0.5787) acc_x 90.6250 (84.6875) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/16] time 0.169 (0.179) data 0.092 (0.101) loss_u loss_u 0.7031 (0.7074) acc_u 34.3750 (34.3750) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/16] time 0.175 (0.178) data 0.097 (0.100) loss_u loss_u 0.7783 (0.7024) acc_u 31.2500 (35.3125) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [15/16] time 0.170 (0.178) data 0.092 (0.100) loss_u loss_u 0.6309 (0.7136) acc_u 46.8750 (34.3750) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 372
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1099
clean true:1097
clean false:2
clean_rate:0.9981801637852593
noisy true:147
noisy false:370
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 517
epoch [130/200] batch [5/34] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.5459 (0.6734) acc_x 84.3750 (81.2500) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [10/34] time 0.186 (0.178) data 0.108 (0.100) loss_x loss_x 0.5757 (0.6446) acc_x 87.5000 (82.1875) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/34] time 0.175 (0.177) data 0.095 (0.099) loss_x loss_x 0.3760 (0.6289) acc_x 90.6250 (83.3333) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/34] time 0.171 (0.178) data 0.093 (0.100) loss_x loss_x 0.8672 (0.6369) acc_x 78.1250 (83.1250) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/34] time 0.169 (0.176) data 0.092 (0.098) loss_x loss_x 0.3762 (0.6376) acc_x 90.6250 (82.7500) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [30/34] time 0.172 (0.176) data 0.095 (0.098) loss_x loss_x 0.5352 (0.6530) acc_x 81.2500 (82.5000) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/16] time 0.182 (0.176) data 0.104 (0.098) loss_u loss_u 0.6768 (0.7256) acc_u 37.5000 (30.6250) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/16] time 0.179 (0.176) data 0.100 (0.098) loss_u loss_u 0.7622 (0.7402) acc_u 28.1250 (30.3125) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [15/16] time 0.165 (0.175) data 0.086 (0.097) loss_u loss_u 0.7622 (0.7258) acc_u 28.1250 (32.5000) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 375
confident_label rate tensor(0.6807, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1100
clean true:1099
clean false:1
clean_rate:0.9990909090909091
noisy true:142
noisy false:374
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 516
epoch [131/200] batch [5/34] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.6689 (0.6595) acc_x 84.3750 (82.5000) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [10/34] time 0.187 (0.185) data 0.109 (0.107) loss_x loss_x 0.5889 (0.5599) acc_x 87.5000 (86.5625) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [15/34] time 0.181 (0.181) data 0.104 (0.103) loss_x loss_x 0.7134 (0.6307) acc_x 81.2500 (85.2083) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [20/34] time 0.169 (0.179) data 0.091 (0.101) loss_x loss_x 0.7939 (0.6447) acc_x 81.2500 (84.8438) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/34] time 0.162 (0.177) data 0.084 (0.099) loss_x loss_x 0.3069 (0.6125) acc_x 90.6250 (85.2500) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [30/34] time 0.171 (0.175) data 0.091 (0.097) loss_x loss_x 0.4968 (0.6081) acc_x 90.6250 (85.5208) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/16] time 0.164 (0.176) data 0.087 (0.098) loss_u loss_u 0.5620 (0.6665) acc_u 59.3750 (40.0000) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [10/16] time 0.165 (0.174) data 0.086 (0.096) loss_u loss_u 0.7173 (0.6926) acc_u 34.3750 (37.1875) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [15/16] time 0.171 (0.174) data 0.092 (0.096) loss_u loss_u 0.6245 (0.6969) acc_u 37.5000 (35.8333) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 399
confident_label rate tensor(0.6646, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1074
clean true:1073
clean false:1
clean_rate:0.9990689013035382
noisy true:144
noisy false:398
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 542
epoch [132/200] batch [5/33] time 0.186 (0.185) data 0.109 (0.107) loss_x loss_x 0.3618 (0.4926) acc_x 93.7500 (86.8750) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [10/33] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.5181 (0.5630) acc_x 84.3750 (85.0000) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/33] time 0.190 (0.183) data 0.112 (0.106) loss_x loss_x 0.3689 (0.5867) acc_x 90.6250 (83.3333) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/33] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.6489 (0.5747) acc_x 87.5000 (84.2188) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/33] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.6353 (0.5858) acc_x 84.3750 (84.1250) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [30/33] time 0.188 (0.182) data 0.109 (0.105) loss_x loss_x 0.5811 (0.5931) acc_x 81.2500 (83.8542) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/16] time 0.188 (0.184) data 0.110 (0.106) loss_u loss_u 0.5747 (0.7104) acc_u 53.1250 (35.0000) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/16] time 0.186 (0.184) data 0.109 (0.106) loss_u loss_u 0.7534 (0.6958) acc_u 28.1250 (35.9375) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/16] time 0.183 (0.184) data 0.105 (0.106) loss_u loss_u 0.7427 (0.7035) acc_u 31.2500 (35.4167) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 337
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1125
clean true:1124
clean false:1
clean_rate:0.9991111111111111
noisy true:155
noisy false:336
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 491
epoch [133/200] batch [5/35] time 0.171 (0.166) data 0.094 (0.088) loss_x loss_x 0.4270 (0.6284) acc_x 84.3750 (81.8750) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/35] time 0.185 (0.167) data 0.108 (0.090) loss_x loss_x 0.5444 (0.5852) acc_x 84.3750 (83.1250) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/35] time 0.170 (0.171) data 0.093 (0.093) loss_x loss_x 0.7861 (0.5898) acc_x 75.0000 (82.9167) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [20/35] time 0.192 (0.173) data 0.112 (0.095) loss_x loss_x 0.8838 (0.5863) acc_x 75.0000 (82.9688) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/35] time 0.166 (0.174) data 0.089 (0.096) loss_x loss_x 0.4712 (0.5547) acc_x 90.6250 (84.3750) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [30/35] time 0.179 (0.174) data 0.101 (0.096) loss_x loss_x 0.2651 (0.5537) acc_x 93.7500 (84.4792) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [35/35] time 0.187 (0.174) data 0.109 (0.097) loss_x loss_x 0.5830 (0.5472) acc_x 81.2500 (85.0000) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/15] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.6895 (0.7092) acc_u 37.5000 (35.6250) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/15] time 0.172 (0.174) data 0.094 (0.097) loss_u loss_u 0.7207 (0.7229) acc_u 28.1250 (32.8125) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [15/15] time 0.182 (0.174) data 0.103 (0.096) loss_u loss_u 0.8198 (0.7312) acc_u 21.8750 (31.8750) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 359
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1115
clean true:1114
clean false:1
clean_rate:0.9991031390134529
noisy true:143
noisy false:358
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 501
epoch [134/200] batch [5/34] time 0.182 (0.184) data 0.105 (0.106) loss_x loss_x 0.4050 (0.5677) acc_x 93.7500 (86.2500) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [10/34] time 0.182 (0.177) data 0.104 (0.100) loss_x loss_x 0.4387 (0.5979) acc_x 87.5000 (84.6875) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/34] time 0.184 (0.179) data 0.106 (0.101) loss_x loss_x 0.5991 (0.6047) acc_x 90.6250 (84.7917) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/34] time 0.187 (0.181) data 0.110 (0.103) loss_x loss_x 0.3186 (0.5857) acc_x 90.6250 (85.0000) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/34] time 0.188 (0.182) data 0.109 (0.104) loss_x loss_x 0.3440 (0.5748) acc_x 96.8750 (85.1250) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/34] time 0.187 (0.182) data 0.109 (0.104) loss_x loss_x 0.3621 (0.5723) acc_x 90.6250 (85.2083) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/15] time 0.185 (0.183) data 0.107 (0.105) loss_u loss_u 0.6470 (0.6759) acc_u 43.7500 (38.1250) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/15] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.6855 (0.6919) acc_u 34.3750 (37.1875) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [15/15] time 0.184 (0.184) data 0.106 (0.106) loss_u loss_u 0.7310 (0.7183) acc_u 31.2500 (33.5417) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 360
confident_label rate tensor(0.6838, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1105
clean true:1103
clean false:2
clean_rate:0.9981900452488688
noisy true:153
noisy false:358
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 511
epoch [135/200] batch [5/34] time 0.173 (0.178) data 0.095 (0.100) loss_x loss_x 0.4204 (0.4060) acc_x 87.5000 (90.0000) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/34] time 0.180 (0.173) data 0.101 (0.095) loss_x loss_x 1.1104 (0.5307) acc_x 71.8750 (86.5625) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/34] time 0.178 (0.173) data 0.099 (0.095) loss_x loss_x 0.7432 (0.5686) acc_x 78.1250 (84.5833) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/34] time 0.184 (0.175) data 0.106 (0.097) loss_x loss_x 0.5825 (0.5648) acc_x 87.5000 (85.1562) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/34] time 0.186 (0.177) data 0.107 (0.099) loss_x loss_x 0.3308 (0.5645) acc_x 87.5000 (84.6250) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/34] time 0.183 (0.178) data 0.106 (0.100) loss_x loss_x 0.5884 (0.5592) acc_x 84.3750 (84.6875) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/15] time 0.183 (0.180) data 0.105 (0.102) loss_u loss_u 0.7036 (0.6842) acc_u 34.3750 (37.5000) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/15] time 0.186 (0.181) data 0.109 (0.103) loss_u loss_u 0.5981 (0.6859) acc_u 46.8750 (36.8750) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [15/15] time 0.168 (0.181) data 0.090 (0.103) loss_u loss_u 0.7349 (0.7070) acc_u 34.3750 (34.5833) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 361
confident_label rate tensor(0.6832, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1104
clean true:1101
clean false:3
clean_rate:0.9972826086956522
noisy true:154
noisy false:358
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 512
epoch [136/200] batch [5/34] time 0.162 (0.169) data 0.082 (0.092) loss_x loss_x 0.2903 (0.6974) acc_x 96.8750 (83.7500) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/34] time 0.187 (0.173) data 0.109 (0.095) loss_x loss_x 0.7192 (0.7483) acc_x 81.2500 (81.8750) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/34] time 0.170 (0.173) data 0.092 (0.095) loss_x loss_x 0.4099 (0.6876) acc_x 93.7500 (83.1250) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [20/34] time 0.205 (0.173) data 0.127 (0.095) loss_x loss_x 0.7876 (0.6948) acc_x 87.5000 (83.7500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/34] time 0.185 (0.175) data 0.108 (0.098) loss_x loss_x 0.7832 (0.6466) acc_x 75.0000 (84.6250) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [30/34] time 0.169 (0.175) data 0.091 (0.097) loss_x loss_x 0.6387 (0.6265) acc_x 78.1250 (84.5833) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/16] time 0.171 (0.176) data 0.091 (0.099) loss_u loss_u 0.6909 (0.6956) acc_u 31.2500 (34.3750) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/16] time 0.170 (0.176) data 0.090 (0.098) loss_u loss_u 0.6455 (0.6944) acc_u 37.5000 (34.3750) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [15/16] time 0.163 (0.175) data 0.085 (0.097) loss_u loss_u 0.7954 (0.7006) acc_u 18.7500 (33.5417) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 361
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1106
clean true:1104
clean false:2
clean_rate:0.9981916817359855
noisy true:151
noisy false:359
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 510
epoch [137/200] batch [5/34] time 0.174 (0.179) data 0.096 (0.101) loss_x loss_x 0.5869 (0.5069) acc_x 84.3750 (86.8750) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/34] time 0.162 (0.175) data 0.084 (0.097) loss_x loss_x 0.9399 (0.5888) acc_x 78.1250 (85.3125) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/34] time 0.178 (0.176) data 0.100 (0.098) loss_x loss_x 0.5273 (0.6173) acc_x 84.3750 (84.5833) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/34] time 0.176 (0.176) data 0.098 (0.099) loss_x loss_x 0.9067 (0.6514) acc_x 78.1250 (84.0625) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/34] time 0.174 (0.176) data 0.096 (0.098) loss_x loss_x 0.6880 (0.6538) acc_x 81.2500 (84.1250) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [30/34] time 0.175 (0.176) data 0.098 (0.098) loss_x loss_x 0.3828 (0.6376) acc_x 87.5000 (84.7917) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/15] time 0.178 (0.175) data 0.099 (0.097) loss_u loss_u 0.8809 (0.7755) acc_u 21.8750 (28.1250) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/15] time 0.170 (0.174) data 0.092 (0.097) loss_u loss_u 0.7505 (0.7415) acc_u 28.1250 (30.9375) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [15/15] time 0.169 (0.174) data 0.092 (0.097) loss_u loss_u 0.7163 (0.7147) acc_u 31.2500 (32.7083) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 376
confident_label rate tensor(0.6770, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1094
clean true:1094
clean false:0
clean_rate:1.0
noisy true:146
noisy false:376
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 522
epoch [138/200] batch [5/34] time 0.173 (0.177) data 0.095 (0.100) loss_x loss_x 0.7583 (0.5782) acc_x 78.1250 (86.2500) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [10/34] time 0.168 (0.171) data 0.089 (0.093) loss_x loss_x 0.3096 (0.5291) acc_x 96.8750 (87.5000) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/34] time 0.196 (0.173) data 0.118 (0.095) loss_x loss_x 0.5938 (0.5235) acc_x 78.1250 (87.5000) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/34] time 0.174 (0.175) data 0.097 (0.097) loss_x loss_x 0.6938 (0.5200) acc_x 71.8750 (87.1875) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/34] time 0.170 (0.174) data 0.092 (0.096) loss_x loss_x 0.9092 (0.5516) acc_x 81.2500 (86.2500) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/34] time 0.190 (0.174) data 0.112 (0.097) loss_x loss_x 0.2333 (0.5346) acc_x 93.7500 (86.6667) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/16] time 0.160 (0.174) data 0.083 (0.097) loss_u loss_u 0.6812 (0.6502) acc_u 34.3750 (40.6250) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/16] time 0.163 (0.173) data 0.085 (0.095) loss_u loss_u 0.6470 (0.6547) acc_u 40.6250 (40.0000) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/16] time 0.184 (0.173) data 0.105 (0.096) loss_u loss_u 0.8311 (0.6956) acc_u 15.6250 (35.6250) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 352
confident_label rate tensor(0.6918, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1118
clean true:1115
clean false:3
clean_rate:0.9973166368515206
noisy true:149
noisy false:349
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 498
epoch [139/200] batch [5/34] time 0.163 (0.179) data 0.085 (0.101) loss_x loss_x 0.2808 (0.4164) acc_x 90.6250 (88.7500) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [10/34] time 0.185 (0.179) data 0.108 (0.101) loss_x loss_x 0.3379 (0.5096) acc_x 93.7500 (85.9375) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/34] time 0.170 (0.178) data 0.093 (0.100) loss_x loss_x 0.3933 (0.5062) acc_x 96.8750 (86.4583) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [20/34] time 0.175 (0.176) data 0.096 (0.099) loss_x loss_x 0.8711 (0.5445) acc_x 75.0000 (85.3125) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/34] time 0.186 (0.178) data 0.108 (0.101) loss_x loss_x 0.3962 (0.5516) acc_x 93.7500 (85.6250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [30/34] time 0.168 (0.179) data 0.090 (0.101) loss_x loss_x 0.7769 (0.5733) acc_x 81.2500 (85.1042) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/15] time 0.188 (0.178) data 0.110 (0.101) loss_u loss_u 0.6450 (0.6903) acc_u 37.5000 (35.6250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/15] time 0.180 (0.179) data 0.102 (0.101) loss_u loss_u 0.6938 (0.7058) acc_u 28.1250 (33.1250) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [15/15] time 0.181 (0.178) data 0.103 (0.100) loss_u loss_u 0.6953 (0.7111) acc_u 34.3750 (32.5000) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 364
confident_label rate tensor(0.6776, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1095
clean true:1094
clean false:1
clean_rate:0.9990867579908675
noisy true:158
noisy false:363
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 521
epoch [140/200] batch [5/34] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.2913 (0.5556) acc_x 90.6250 (84.3750) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/34] time 0.210 (0.180) data 0.132 (0.103) loss_x loss_x 0.4832 (0.5393) acc_x 78.1250 (83.7500) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/34] time 0.176 (0.181) data 0.098 (0.104) loss_x loss_x 0.4026 (0.5083) acc_x 87.5000 (84.3750) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/34] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 1.3525 (0.5687) acc_x 56.2500 (82.6562) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/34] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.5381 (0.5752) acc_x 84.3750 (82.7500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [30/34] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.4265 (0.5661) acc_x 87.5000 (83.1250) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/16] time 0.183 (0.183) data 0.105 (0.105) loss_u loss_u 0.7993 (0.6788) acc_u 28.1250 (38.7500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/16] time 0.185 (0.183) data 0.106 (0.106) loss_u loss_u 0.7856 (0.6953) acc_u 21.8750 (35.9375) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/16] time 0.202 (0.184) data 0.125 (0.106) loss_u loss_u 0.7095 (0.6878) acc_u 34.3750 (37.0833) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 359
confident_label rate tensor(0.6832, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1104
clean true:1100
clean false:4
clean_rate:0.9963768115942029
noisy true:157
noisy false:355
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 512
epoch [141/200] batch [5/34] time 0.184 (0.187) data 0.106 (0.109) loss_x loss_x 1.4551 (0.7282) acc_x 71.8750 (83.7500) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [10/34] time 0.186 (0.187) data 0.108 (0.109) loss_x loss_x 0.7104 (0.6665) acc_x 84.3750 (85.6250) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/34] time 0.169 (0.184) data 0.090 (0.106) loss_x loss_x 0.3794 (0.6425) acc_x 87.5000 (85.6250) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/34] time 0.180 (0.183) data 0.102 (0.105) loss_x loss_x 0.4170 (0.6369) acc_x 90.6250 (85.7812) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/34] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.5698 (0.6284) acc_x 84.3750 (85.3750) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/34] time 0.188 (0.182) data 0.110 (0.104) loss_x loss_x 0.6689 (0.6374) acc_x 81.2500 (84.7917) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/16] time 0.169 (0.181) data 0.091 (0.103) loss_u loss_u 0.7778 (0.7122) acc_u 28.1250 (33.1250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/16] time 0.181 (0.181) data 0.103 (0.103) loss_u loss_u 0.7197 (0.7083) acc_u 28.1250 (34.6875) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [15/16] time 0.187 (0.181) data 0.109 (0.103) loss_u loss_u 0.6455 (0.6936) acc_u 37.5000 (36.2500) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 353
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1113
clean true:1113
clean false:0
clean_rate:1.0
noisy true:150
noisy false:353
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 503
epoch [142/200] batch [5/34] time 0.172 (0.181) data 0.092 (0.103) loss_x loss_x 0.4434 (0.5094) acc_x 84.3750 (85.0000) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/34] time 0.181 (0.175) data 0.103 (0.097) loss_x loss_x 0.5757 (0.5177) acc_x 87.5000 (85.3125) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/34] time 0.168 (0.174) data 0.091 (0.096) loss_x loss_x 0.6187 (0.5929) acc_x 81.2500 (83.7500) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/34] time 0.172 (0.173) data 0.095 (0.095) loss_x loss_x 0.6670 (0.5784) acc_x 84.3750 (84.6875) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/34] time 0.178 (0.172) data 0.101 (0.095) loss_x loss_x 0.5591 (0.5668) acc_x 81.2500 (85.2500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [30/34] time 0.171 (0.172) data 0.093 (0.095) loss_x loss_x 0.9355 (0.5858) acc_x 71.8750 (84.4792) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/15] time 0.187 (0.175) data 0.108 (0.097) loss_u loss_u 0.7070 (0.7220) acc_u 31.2500 (31.2500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/15] time 0.184 (0.176) data 0.106 (0.098) loss_u loss_u 0.7012 (0.7218) acc_u 34.3750 (32.5000) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [15/15] time 0.185 (0.177) data 0.106 (0.099) loss_u loss_u 0.7407 (0.7156) acc_u 31.2500 (33.3333) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 350
confident_label rate tensor(0.6856, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1108
clean true:1107
clean false:1
clean_rate:0.9990974729241877
noisy true:159
noisy false:349
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 508
epoch [143/200] batch [5/34] time 0.163 (0.167) data 0.085 (0.089) loss_x loss_x 0.6411 (0.5507) acc_x 81.2500 (85.0000) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/34] time 0.173 (0.169) data 0.096 (0.091) loss_x loss_x 0.6152 (0.5665) acc_x 75.0000 (84.6875) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/34] time 0.162 (0.172) data 0.085 (0.094) loss_x loss_x 0.8105 (0.5771) acc_x 75.0000 (84.7917) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/34] time 0.187 (0.172) data 0.109 (0.095) loss_x loss_x 0.4739 (0.6104) acc_x 87.5000 (85.0000) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/34] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.5229 (0.5764) acc_x 90.6250 (85.7500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/34] time 0.167 (0.175) data 0.090 (0.097) loss_x loss_x 0.8252 (0.5862) acc_x 78.1250 (85.6250) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/15] time 0.174 (0.175) data 0.097 (0.098) loss_u loss_u 0.6919 (0.6811) acc_u 37.5000 (38.1250) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/15] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.7876 (0.7070) acc_u 25.0000 (35.9375) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [15/15] time 0.163 (0.174) data 0.083 (0.096) loss_u loss_u 0.6548 (0.7104) acc_u 40.6250 (35.8333) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 353
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1106
clean true:1105
clean false:1
clean_rate:0.9990958408679927
noisy true:158
noisy false:352
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 510
epoch [144/200] batch [5/34] time 0.188 (0.185) data 0.110 (0.107) loss_x loss_x 0.7183 (0.4886) acc_x 87.5000 (89.3750) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [10/34] time 0.172 (0.179) data 0.094 (0.101) loss_x loss_x 0.9683 (0.5922) acc_x 81.2500 (87.1875) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [15/34] time 0.176 (0.179) data 0.098 (0.101) loss_x loss_x 0.2676 (0.6025) acc_x 93.7500 (85.6250) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/34] time 0.171 (0.177) data 0.094 (0.099) loss_x loss_x 0.2332 (0.5696) acc_x 96.8750 (86.7188) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/34] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.3865 (0.5537) acc_x 84.3750 (86.6250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/34] time 0.185 (0.176) data 0.108 (0.098) loss_x loss_x 0.6343 (0.5717) acc_x 81.2500 (86.1458) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/15] time 0.173 (0.176) data 0.095 (0.098) loss_u loss_u 0.5669 (0.6710) acc_u 50.0000 (38.1250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/15] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.6343 (0.6802) acc_u 46.8750 (36.8750) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [15/15] time 0.178 (0.178) data 0.100 (0.100) loss_u loss_u 0.7559 (0.6979) acc_u 31.2500 (34.5833) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 354
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1115
clean true:1113
clean false:2
clean_rate:0.9982062780269059
noisy true:149
noisy false:352
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 501
epoch [145/200] batch [5/34] time 0.188 (0.181) data 0.110 (0.103) loss_x loss_x 0.2269 (0.6105) acc_x 96.8750 (82.5000) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [10/34] time 0.190 (0.175) data 0.113 (0.097) loss_x loss_x 0.5503 (0.6945) acc_x 84.3750 (81.2500) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/34] time 0.171 (0.178) data 0.094 (0.100) loss_x loss_x 0.5493 (0.6788) acc_x 81.2500 (81.6667) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [20/34] time 0.171 (0.177) data 0.093 (0.100) loss_x loss_x 0.5054 (0.6597) acc_x 87.5000 (82.6562) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/34] time 0.182 (0.177) data 0.105 (0.099) loss_x loss_x 0.5269 (0.6090) acc_x 81.2500 (83.6250) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [30/34] time 0.182 (0.178) data 0.105 (0.100) loss_x loss_x 0.3914 (0.6057) acc_x 84.3750 (83.6458) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/15] time 0.171 (0.178) data 0.093 (0.101) loss_u loss_u 0.6484 (0.6654) acc_u 40.6250 (36.8750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/15] time 0.162 (0.177) data 0.084 (0.099) loss_u loss_u 0.7554 (0.6990) acc_u 25.0000 (33.1250) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [15/15] time 0.164 (0.176) data 0.085 (0.098) loss_u loss_u 0.7661 (0.7042) acc_u 25.0000 (33.1250) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 331
confident_label rate tensor(0.6968, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1126
clean true:1125
clean false:1
clean_rate:0.9991119005328597
noisy true:160
noisy false:330
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 490
epoch [146/200] batch [5/35] time 0.189 (0.181) data 0.111 (0.103) loss_x loss_x 0.5479 (0.5420) acc_x 90.6250 (85.6250) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [10/35] time 0.176 (0.178) data 0.099 (0.100) loss_x loss_x 0.2922 (0.5573) acc_x 96.8750 (85.6250) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/35] time 0.177 (0.179) data 0.100 (0.101) loss_x loss_x 0.2551 (0.5524) acc_x 96.8750 (86.0417) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/35] time 0.184 (0.179) data 0.107 (0.101) loss_x loss_x 0.6343 (0.5627) acc_x 90.6250 (86.2500) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/35] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.6616 (0.5414) acc_x 87.5000 (86.6250) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [30/35] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.7705 (0.5481) acc_x 81.2500 (86.2500) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [35/35] time 0.184 (0.183) data 0.107 (0.105) loss_x loss_x 0.9062 (0.5650) acc_x 75.0000 (85.8929) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/15] time 0.171 (0.183) data 0.093 (0.105) loss_u loss_u 0.7505 (0.7275) acc_u 28.1250 (32.5000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/15] time 0.179 (0.182) data 0.102 (0.104) loss_u loss_u 0.6831 (0.7192) acc_u 34.3750 (34.3750) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [15/15] time 0.159 (0.180) data 0.082 (0.102) loss_u loss_u 0.6890 (0.7202) acc_u 37.5000 (33.7500) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 375
confident_label rate tensor(0.6764, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1093
clean true:1090
clean false:3
clean_rate:0.9972552607502287
noisy true:151
noisy false:372
after delete: len(clean_dataset) 1093
after delete: len(noisy_dataset) 523
epoch [147/200] batch [5/34] time 0.182 (0.184) data 0.104 (0.106) loss_x loss_x 0.6304 (0.4770) acc_x 78.1250 (87.5000) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [10/34] time 0.162 (0.180) data 0.084 (0.103) loss_x loss_x 0.2756 (0.4266) acc_x 96.8750 (88.4375) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/34] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.6304 (0.5008) acc_x 78.1250 (86.6667) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/34] time 0.186 (0.182) data 0.108 (0.104) loss_x loss_x 0.8452 (0.5128) acc_x 84.3750 (86.8750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/34] time 0.193 (0.182) data 0.116 (0.104) loss_x loss_x 0.8130 (0.5380) acc_x 78.1250 (86.6250) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [30/34] time 0.170 (0.181) data 0.092 (0.103) loss_x loss_x 0.4307 (0.5285) acc_x 90.6250 (86.8750) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/16] time 0.173 (0.180) data 0.094 (0.102) loss_u loss_u 0.7441 (0.7094) acc_u 34.3750 (36.2500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/16] time 0.180 (0.180) data 0.101 (0.103) loss_u loss_u 0.7798 (0.6903) acc_u 21.8750 (36.5625) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [15/16] time 0.188 (0.181) data 0.109 (0.103) loss_u loss_u 0.7261 (0.6821) acc_u 31.2500 (36.8750) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 339
confident_label rate tensor(0.6986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1129
clean true:1128
clean false:1
clean_rate:0.9991142604074402
noisy true:149
noisy false:338
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 487
epoch [148/200] batch [5/35] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.6328 (0.5734) acc_x 87.5000 (85.6250) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [10/35] time 0.182 (0.181) data 0.105 (0.103) loss_x loss_x 0.4214 (0.5340) acc_x 87.5000 (86.5625) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/35] time 0.182 (0.181) data 0.104 (0.104) loss_x loss_x 0.5269 (0.5603) acc_x 81.2500 (85.6250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/35] time 0.184 (0.182) data 0.106 (0.104) loss_x loss_x 0.5664 (0.6152) acc_x 81.2500 (83.9062) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/35] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.7896 (0.6162) acc_x 78.1250 (84.0000) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [30/35] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.4050 (0.6096) acc_x 90.6250 (83.8542) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [35/35] time 0.176 (0.184) data 0.099 (0.106) loss_x loss_x 0.7939 (0.6064) acc_x 81.2500 (84.1964) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/15] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.6904 (0.7039) acc_u 34.3750 (35.0000) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/15] time 0.161 (0.182) data 0.083 (0.104) loss_u loss_u 0.5928 (0.6902) acc_u 46.8750 (35.6250) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [15/15] time 0.167 (0.182) data 0.088 (0.104) loss_u loss_u 0.7837 (0.7032) acc_u 25.0000 (35.0000) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 367
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1109
clean true:1109
clean false:0
clean_rate:1.0
noisy true:140
noisy false:367
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 507
epoch [149/200] batch [5/34] time 0.168 (0.184) data 0.091 (0.105) loss_x loss_x 0.9658 (0.5253) acc_x 84.3750 (88.7500) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [10/34] time 0.181 (0.183) data 0.103 (0.105) loss_x loss_x 0.5854 (0.5366) acc_x 87.5000 (87.8125) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/34] time 0.168 (0.183) data 0.090 (0.104) loss_x loss_x 0.5781 (0.5739) acc_x 84.3750 (86.2500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/34] time 0.190 (0.182) data 0.113 (0.103) loss_x loss_x 0.8887 (0.5949) acc_x 84.3750 (85.6250) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/34] time 0.183 (0.180) data 0.105 (0.102) loss_x loss_x 0.5854 (0.5907) acc_x 90.6250 (85.8750) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [30/34] time 0.173 (0.179) data 0.094 (0.101) loss_x loss_x 0.4182 (0.6068) acc_x 90.6250 (85.1042) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/15] time 0.181 (0.179) data 0.102 (0.101) loss_u loss_u 0.7534 (0.7005) acc_u 28.1250 (35.6250) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/15] time 0.162 (0.177) data 0.084 (0.099) loss_u loss_u 0.6860 (0.7079) acc_u 40.6250 (33.7500) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [15/15] time 0.177 (0.177) data 0.098 (0.099) loss_u loss_u 0.8604 (0.6977) acc_u 18.7500 (34.3750) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 366
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1106
clean true:1104
clean false:2
clean_rate:0.9981916817359855
noisy true:146
noisy false:364
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 510
epoch [150/200] batch [5/34] time 0.175 (0.180) data 0.098 (0.102) loss_x loss_x 0.1389 (0.4962) acc_x 96.8750 (86.8750) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [10/34] time 0.176 (0.176) data 0.098 (0.098) loss_x loss_x 0.4651 (0.4977) acc_x 90.6250 (86.8750) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/34] time 0.181 (0.177) data 0.104 (0.099) loss_x loss_x 0.8423 (0.5053) acc_x 75.0000 (86.6667) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/34] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.3794 (0.5380) acc_x 87.5000 (85.1562) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/34] time 0.173 (0.177) data 0.096 (0.099) loss_x loss_x 0.5630 (0.5344) acc_x 78.1250 (85.2500) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [30/34] time 0.173 (0.177) data 0.095 (0.099) loss_x loss_x 0.3850 (0.5386) acc_x 90.6250 (85.5208) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/15] time 0.187 (0.175) data 0.108 (0.098) loss_u loss_u 0.7222 (0.6726) acc_u 34.3750 (39.3750) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/15] time 0.183 (0.176) data 0.104 (0.098) loss_u loss_u 0.8169 (0.7100) acc_u 25.0000 (35.0000) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [15/15] time 0.182 (0.177) data 0.104 (0.099) loss_u loss_u 0.6914 (0.6835) acc_u 40.6250 (37.2917) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 349
confident_label rate tensor(0.6949, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1123
clean true:1121
clean false:2
clean_rate:0.9982190560997328
noisy true:146
noisy false:347
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 493
epoch [151/200] batch [5/35] time 0.162 (0.177) data 0.085 (0.100) loss_x loss_x 0.4282 (0.5214) acc_x 87.5000 (86.2500) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [10/35] time 0.178 (0.175) data 0.100 (0.097) loss_x loss_x 0.5083 (0.5634) acc_x 87.5000 (85.9375) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/35] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.4453 (0.5832) acc_x 90.6250 (85.6250) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/35] time 0.187 (0.177) data 0.109 (0.100) loss_x loss_x 0.5332 (0.5654) acc_x 87.5000 (86.4062) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/35] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.4788 (0.5884) acc_x 87.5000 (85.5000) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [30/35] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.3699 (0.5890) acc_x 87.5000 (85.4167) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [35/35] time 0.184 (0.180) data 0.106 (0.103) loss_x loss_x 1.1904 (0.6105) acc_x 68.7500 (85.0000) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/15] time 0.187 (0.181) data 0.110 (0.104) loss_u loss_u 0.6953 (0.6952) acc_u 31.2500 (34.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/15] time 0.188 (0.182) data 0.110 (0.104) loss_u loss_u 0.7930 (0.7007) acc_u 21.8750 (34.0625) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [15/15] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.6978 (0.6909) acc_u 37.5000 (35.2083) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 354
confident_label rate tensor(0.6838, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1105
clean true:1104
clean false:1
clean_rate:0.9990950226244344
noisy true:158
noisy false:353
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 511
epoch [152/200] batch [5/34] time 0.172 (0.179) data 0.095 (0.101) loss_x loss_x 0.7041 (0.6447) acc_x 87.5000 (83.7500) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [10/34] time 0.187 (0.173) data 0.110 (0.095) loss_x loss_x 0.4082 (0.6565) acc_x 93.7500 (84.3750) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/34] time 0.185 (0.174) data 0.108 (0.097) loss_x loss_x 0.8862 (0.6017) acc_x 81.2500 (85.6250) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [20/34] time 0.168 (0.177) data 0.090 (0.099) loss_x loss_x 0.7554 (0.5900) acc_x 90.6250 (85.7812) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/34] time 0.187 (0.177) data 0.110 (0.099) loss_x loss_x 0.6699 (0.6263) acc_x 87.5000 (84.7500) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [30/34] time 0.166 (0.175) data 0.088 (0.098) loss_x loss_x 0.3884 (0.6278) acc_x 87.5000 (84.1667) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/15] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.7163 (0.6972) acc_u 28.1250 (34.3750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/15] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.7256 (0.7141) acc_u 34.3750 (32.1875) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [15/15] time 0.180 (0.175) data 0.101 (0.097) loss_u loss_u 0.7422 (0.7205) acc_u 40.6250 (32.7083) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 338
confident_label rate tensor(0.6986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1129
clean true:1128
clean false:1
clean_rate:0.9991142604074402
noisy true:150
noisy false:337
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 487
epoch [153/200] batch [5/35] time 0.169 (0.181) data 0.091 (0.103) loss_x loss_x 0.4451 (0.5520) acc_x 84.3750 (85.6250) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [10/35] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 0.6206 (0.5957) acc_x 81.2500 (83.7500) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/35] time 0.169 (0.176) data 0.090 (0.098) loss_x loss_x 0.6045 (0.5962) acc_x 90.6250 (84.7917) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/35] time 0.165 (0.173) data 0.087 (0.095) loss_x loss_x 0.8491 (0.5702) acc_x 78.1250 (85.3125) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/35] time 0.168 (0.172) data 0.090 (0.094) loss_x loss_x 0.5615 (0.5867) acc_x 84.3750 (84.8750) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [30/35] time 0.163 (0.171) data 0.085 (0.093) loss_x loss_x 0.6973 (0.5852) acc_x 90.6250 (85.2083) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [35/35] time 0.164 (0.170) data 0.087 (0.092) loss_x loss_x 0.8286 (0.6103) acc_x 81.2500 (84.3750) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/15] time 0.164 (0.169) data 0.085 (0.091) loss_u loss_u 0.7310 (0.7344) acc_u 28.1250 (30.6250) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/15] time 0.164 (0.169) data 0.085 (0.091) loss_u loss_u 0.7383 (0.7200) acc_u 31.2500 (31.8750) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [15/15] time 0.172 (0.169) data 0.094 (0.091) loss_u loss_u 0.6138 (0.7140) acc_u 46.8750 (33.5417) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 349
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1113
clean true:1110
clean false:3
clean_rate:0.9973045822102425
noisy true:157
noisy false:346
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 503
epoch [154/200] batch [5/34] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 1.0312 (0.7194) acc_x 71.8750 (81.8750) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [10/34] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.6904 (0.7078) acc_x 81.2500 (80.9375) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/34] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.5430 (0.6710) acc_x 81.2500 (82.0833) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/34] time 0.181 (0.183) data 0.103 (0.105) loss_x loss_x 0.5806 (0.6495) acc_x 93.7500 (83.1250) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/34] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.4136 (0.6382) acc_x 93.7500 (83.6250) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/34] time 0.174 (0.180) data 0.096 (0.103) loss_x loss_x 0.4321 (0.6302) acc_x 87.5000 (83.9583) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/15] time 0.210 (0.182) data 0.131 (0.104) loss_u loss_u 0.7095 (0.6674) acc_u 31.2500 (35.6250) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/15] time 0.211 (0.182) data 0.133 (0.104) loss_u loss_u 0.6436 (0.6719) acc_u 40.6250 (35.9375) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [15/15] time 0.178 (0.182) data 0.100 (0.104) loss_u loss_u 0.6997 (0.6915) acc_u 34.3750 (34.3750) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 351
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1109
clean true:1107
clean false:2
clean_rate:0.9981965734896303
noisy true:158
noisy false:349
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 507
epoch [155/200] batch [5/34] time 0.165 (0.165) data 0.088 (0.087) loss_x loss_x 0.8164 (0.5033) acc_x 81.2500 (90.0000) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/34] time 0.183 (0.171) data 0.105 (0.093) loss_x loss_x 0.6016 (0.5505) acc_x 84.3750 (86.5625) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/34] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.4158 (0.5616) acc_x 87.5000 (86.4583) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/34] time 0.187 (0.175) data 0.109 (0.097) loss_x loss_x 0.6079 (0.5991) acc_x 84.3750 (85.3125) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/34] time 0.186 (0.177) data 0.109 (0.099) loss_x loss_x 0.3145 (0.5876) acc_x 93.7500 (85.3750) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [30/34] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.4878 (0.5830) acc_x 78.1250 (85.0000) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/15] time 0.183 (0.180) data 0.105 (0.102) loss_u loss_u 0.7065 (0.7288) acc_u 37.5000 (30.6250) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/15] time 0.188 (0.181) data 0.110 (0.103) loss_u loss_u 0.6958 (0.7176) acc_u 37.5000 (32.8125) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [15/15] time 0.186 (0.181) data 0.107 (0.104) loss_u loss_u 0.6328 (0.7060) acc_u 43.7500 (34.1667) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 344
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1113
clean true:1111
clean false:2
clean_rate:0.9982030548068284
noisy true:161
noisy false:342
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 503
epoch [156/200] batch [5/34] time 0.188 (0.185) data 0.110 (0.107) loss_x loss_x 0.3896 (0.5770) acc_x 90.6250 (86.2500) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/34] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.6133 (0.5510) acc_x 84.3750 (84.6875) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/34] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.6851 (0.5577) acc_x 84.3750 (84.7917) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/34] time 0.174 (0.182) data 0.095 (0.104) loss_x loss_x 0.7402 (0.6174) acc_x 75.0000 (83.5938) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/34] time 0.172 (0.181) data 0.094 (0.104) loss_x loss_x 0.5308 (0.6036) acc_x 90.6250 (84.3750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [30/34] time 0.161 (0.181) data 0.083 (0.103) loss_x loss_x 0.4216 (0.5724) acc_x 87.5000 (84.7917) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/15] time 0.188 (0.179) data 0.110 (0.101) loss_u loss_u 0.7021 (0.7165) acc_u 34.3750 (33.7500) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/15] time 0.183 (0.178) data 0.104 (0.100) loss_u loss_u 0.6055 (0.6995) acc_u 50.0000 (35.0000) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [15/15] time 0.161 (0.177) data 0.084 (0.099) loss_u loss_u 0.6958 (0.6945) acc_u 37.5000 (35.8333) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 355
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1112
clean true:1110
clean false:2
clean_rate:0.9982014388489209
noisy true:151
noisy false:353
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 504
epoch [157/200] batch [5/34] time 0.167 (0.183) data 0.089 (0.106) loss_x loss_x 0.8892 (0.6433) acc_x 84.3750 (84.3750) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/34] time 0.162 (0.173) data 0.085 (0.095) loss_x loss_x 0.4192 (0.5390) acc_x 90.6250 (86.5625) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/34] time 0.164 (0.170) data 0.086 (0.092) loss_x loss_x 0.8794 (0.5600) acc_x 75.0000 (86.4583) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/34] time 0.176 (0.169) data 0.098 (0.092) loss_x loss_x 0.5879 (0.5870) acc_x 84.3750 (85.3125) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/34] time 0.199 (0.173) data 0.122 (0.095) loss_x loss_x 0.6743 (0.6305) acc_x 84.3750 (84.0000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/34] time 0.170 (0.173) data 0.093 (0.095) loss_x loss_x 0.6982 (0.6235) acc_x 81.2500 (84.0625) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/15] time 0.185 (0.174) data 0.106 (0.096) loss_u loss_u 0.6865 (0.6956) acc_u 34.3750 (35.6250) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/15] time 0.175 (0.173) data 0.097 (0.095) loss_u loss_u 0.6455 (0.7006) acc_u 37.5000 (35.3125) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [15/15] time 0.184 (0.174) data 0.107 (0.096) loss_u loss_u 0.7554 (0.6919) acc_u 31.2500 (36.0417) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 356
confident_label rate tensor(0.6869, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1110
clean true:1110
clean false:0
clean_rate:1.0
noisy true:150
noisy false:356
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 506
epoch [158/200] batch [5/34] time 0.174 (0.179) data 0.096 (0.101) loss_x loss_x 0.6875 (0.7060) acc_x 78.1250 (80.6250) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [10/34] time 0.186 (0.182) data 0.108 (0.104) loss_x loss_x 0.4800 (0.5844) acc_x 90.6250 (84.6875) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/34] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.3252 (0.5595) acc_x 90.6250 (85.6250) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/34] time 0.169 (0.183) data 0.092 (0.105) loss_x loss_x 0.4453 (0.5109) acc_x 87.5000 (86.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/34] time 0.175 (0.182) data 0.098 (0.105) loss_x loss_x 0.6719 (0.5046) acc_x 87.5000 (86.8750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [30/34] time 0.188 (0.181) data 0.111 (0.103) loss_x loss_x 0.6958 (0.5060) acc_x 81.2500 (86.5625) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/15] time 0.185 (0.182) data 0.107 (0.104) loss_u loss_u 0.8257 (0.7692) acc_u 21.8750 (28.1250) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/15] time 0.181 (0.182) data 0.103 (0.104) loss_u loss_u 0.6768 (0.7190) acc_u 37.5000 (33.4375) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [15/15] time 0.184 (0.182) data 0.105 (0.104) loss_u loss_u 0.5879 (0.7067) acc_u 43.7500 (34.5833) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 353
confident_label rate tensor(0.6912, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1117
clean true:1117
clean false:0
clean_rate:1.0
noisy true:146
noisy false:353
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 499
epoch [159/200] batch [5/34] time 0.173 (0.169) data 0.096 (0.091) loss_x loss_x 0.5591 (0.5255) acc_x 84.3750 (86.2500) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/34] time 0.197 (0.176) data 0.119 (0.099) loss_x loss_x 0.7412 (0.6168) acc_x 81.2500 (84.0625) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/34] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.6274 (0.6266) acc_x 84.3750 (83.1250) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/34] time 0.182 (0.175) data 0.104 (0.097) loss_x loss_x 0.4902 (0.6110) acc_x 87.5000 (83.4375) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/34] time 0.184 (0.175) data 0.106 (0.097) loss_x loss_x 0.3816 (0.6084) acc_x 87.5000 (83.3750) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [30/34] time 0.175 (0.175) data 0.097 (0.097) loss_x loss_x 0.8325 (0.5894) acc_x 75.0000 (83.8542) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/15] time 0.162 (0.175) data 0.083 (0.097) loss_u loss_u 0.7808 (0.7691) acc_u 21.8750 (25.0000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/15] time 0.185 (0.175) data 0.107 (0.097) loss_u loss_u 0.7324 (0.7564) acc_u 37.5000 (28.1250) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [15/15] time 0.184 (0.176) data 0.106 (0.098) loss_u loss_u 0.5571 (0.7228) acc_u 50.0000 (31.8750) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 337
confident_label rate tensor(0.6986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1129
clean true:1128
clean false:1
clean_rate:0.9991142604074402
noisy true:151
noisy false:336
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 487
epoch [160/200] batch [5/35] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.2583 (0.4158) acc_x 96.8750 (90.0000) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [10/35] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.1810 (0.3993) acc_x 96.8750 (90.3125) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/35] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8389 (0.4983) acc_x 78.1250 (87.2917) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/35] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.4856 (0.5064) acc_x 81.2500 (86.8750) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/35] time 0.175 (0.183) data 0.097 (0.106) loss_x loss_x 0.8540 (0.5492) acc_x 81.2500 (85.8750) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [30/35] time 0.169 (0.181) data 0.091 (0.103) loss_x loss_x 0.8545 (0.5546) acc_x 81.2500 (85.6250) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [35/35] time 0.167 (0.179) data 0.089 (0.102) loss_x loss_x 0.4058 (0.5322) acc_x 84.3750 (85.8929) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/15] time 0.179 (0.179) data 0.101 (0.101) loss_u loss_u 0.7476 (0.7019) acc_u 34.3750 (36.2500) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/15] time 0.190 (0.179) data 0.111 (0.102) loss_u loss_u 0.6445 (0.7055) acc_u 40.6250 (34.6875) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [15/15] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.7969 (0.7099) acc_u 21.8750 (34.1667) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 353
confident_label rate tensor(0.6925, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1119
clean true:1115
clean false:4
clean_rate:0.9964253798033958
noisy true:148
noisy false:349
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 497
epoch [161/200] batch [5/34] time 0.187 (0.188) data 0.110 (0.110) loss_x loss_x 0.4600 (0.4814) acc_x 90.6250 (87.5000) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [10/34] time 0.187 (0.188) data 0.110 (0.110) loss_x loss_x 0.4756 (0.4622) acc_x 90.6250 (88.1250) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/34] time 0.175 (0.182) data 0.095 (0.104) loss_x loss_x 0.3975 (0.4478) acc_x 90.6250 (88.9583) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/34] time 0.173 (0.179) data 0.095 (0.102) loss_x loss_x 0.2983 (0.4866) acc_x 93.7500 (88.1250) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/34] time 0.178 (0.179) data 0.100 (0.101) loss_x loss_x 0.7437 (0.5103) acc_x 78.1250 (87.3750) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [30/34] time 0.179 (0.179) data 0.102 (0.101) loss_x loss_x 0.4309 (0.5105) acc_x 87.5000 (87.3958) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/15] time 0.174 (0.178) data 0.096 (0.100) loss_u loss_u 0.7627 (0.7425) acc_u 25.0000 (30.6250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [10/15] time 0.166 (0.176) data 0.088 (0.098) loss_u loss_u 0.5889 (0.7233) acc_u 50.0000 (33.7500) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [15/15] time 0.200 (0.176) data 0.122 (0.097) loss_u loss_u 0.7046 (0.7059) acc_u 31.2500 (35.2083) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 373
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1099
clean true:1098
clean false:1
clean_rate:0.9990900818926297
noisy true:145
noisy false:372
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 517
epoch [162/200] batch [5/34] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.8154 (0.6166) acc_x 81.2500 (85.6250) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [10/34] time 0.182 (0.184) data 0.104 (0.106) loss_x loss_x 1.2168 (0.6187) acc_x 65.6250 (85.0000) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/34] time 0.186 (0.184) data 0.108 (0.106) loss_x loss_x 0.3850 (0.5672) acc_x 90.6250 (85.6250) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/34] time 0.191 (0.185) data 0.112 (0.107) loss_x loss_x 0.8003 (0.5908) acc_x 78.1250 (85.4688) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/34] time 0.188 (0.185) data 0.110 (0.107) loss_x loss_x 0.6836 (0.5730) acc_x 81.2500 (85.3750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [30/34] time 0.191 (0.185) data 0.114 (0.107) loss_x loss_x 0.3455 (0.5556) acc_x 87.5000 (86.0417) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/16] time 0.186 (0.185) data 0.109 (0.107) loss_u loss_u 0.6353 (0.6787) acc_u 43.7500 (36.8750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/16] time 0.183 (0.185) data 0.106 (0.107) loss_u loss_u 0.6689 (0.6738) acc_u 37.5000 (37.1875) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/16] time 0.184 (0.185) data 0.107 (0.107) loss_u loss_u 0.7031 (0.6755) acc_u 31.2500 (37.5000) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 322
confident_label rate tensor(0.7054, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1140
clean true:1139
clean false:1
clean_rate:0.9991228070175439
noisy true:155
noisy false:321
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 476
epoch [163/200] batch [5/35] time 0.186 (0.189) data 0.107 (0.111) loss_x loss_x 0.8970 (0.5347) acc_x 78.1250 (85.0000) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [10/35] time 0.178 (0.186) data 0.101 (0.109) loss_x loss_x 0.5215 (0.6107) acc_x 84.3750 (83.7500) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/35] time 0.192 (0.186) data 0.115 (0.109) loss_x loss_x 0.6885 (0.5981) acc_x 84.3750 (84.3750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/35] time 0.187 (0.186) data 0.109 (0.109) loss_x loss_x 0.7925 (0.6028) acc_x 87.5000 (84.6875) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/35] time 0.186 (0.186) data 0.108 (0.109) loss_x loss_x 0.7007 (0.6193) acc_x 84.3750 (84.0000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [30/35] time 0.182 (0.186) data 0.104 (0.109) loss_x loss_x 1.0059 (0.6041) acc_x 75.0000 (84.6875) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [35/35] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.7446 (0.6027) acc_x 87.5000 (85.0893) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/14] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.6738 (0.7326) acc_u 34.3750 (31.2500) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [10/14] time 0.183 (0.185) data 0.105 (0.108) loss_u loss_u 0.7466 (0.7268) acc_u 28.1250 (31.8750) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 339
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1125
clean true:1123
clean false:2
clean_rate:0.9982222222222222
noisy true:154
noisy false:337
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 491
epoch [164/200] batch [5/35] time 0.181 (0.185) data 0.104 (0.106) loss_x loss_x 0.3604 (0.4305) acc_x 90.6250 (88.1250) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [10/35] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.5728 (0.4370) acc_x 87.5000 (88.7500) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/35] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.4690 (0.4416) acc_x 81.2500 (88.3333) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/35] time 0.182 (0.184) data 0.104 (0.106) loss_x loss_x 0.9790 (0.5031) acc_x 75.0000 (86.7188) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/35] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.4714 (0.5323) acc_x 84.3750 (86.1250) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [30/35] time 0.169 (0.183) data 0.091 (0.106) loss_x loss_x 0.4705 (0.5533) acc_x 81.2500 (85.1042) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [35/35] time 0.168 (0.181) data 0.091 (0.103) loss_x loss_x 0.5737 (0.5366) acc_x 87.5000 (85.6250) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/15] time 0.171 (0.180) data 0.092 (0.102) loss_u loss_u 0.7559 (0.7035) acc_u 31.2500 (35.0000) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [10/15] time 0.186 (0.180) data 0.107 (0.102) loss_u loss_u 0.6367 (0.6995) acc_u 43.7500 (35.9375) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [15/15] time 0.185 (0.180) data 0.107 (0.102) loss_u loss_u 0.6738 (0.6935) acc_u 40.6250 (36.4583) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 365
confident_label rate tensor(0.6807, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1100
clean true:1097
clean false:3
clean_rate:0.9972727272727273
noisy true:154
noisy false:362
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 516
epoch [165/200] batch [5/34] time 0.174 (0.176) data 0.097 (0.099) loss_x loss_x 0.5601 (0.7265) acc_x 84.3750 (82.5000) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [10/34] time 0.164 (0.176) data 0.087 (0.099) loss_x loss_x 0.4700 (0.6557) acc_x 90.6250 (84.0625) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/34] time 0.166 (0.173) data 0.089 (0.095) loss_x loss_x 0.6094 (0.6134) acc_x 87.5000 (85.0000) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/34] time 0.186 (0.173) data 0.108 (0.095) loss_x loss_x 0.5889 (0.6301) acc_x 84.3750 (84.6875) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/34] time 0.183 (0.175) data 0.105 (0.098) loss_x loss_x 0.6113 (0.6103) acc_x 87.5000 (84.8750) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [30/34] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.4993 (0.6007) acc_x 84.3750 (85.1042) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/16] time 0.172 (0.177) data 0.095 (0.099) loss_u loss_u 0.6875 (0.6958) acc_u 34.3750 (35.0000) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/16] time 0.168 (0.176) data 0.091 (0.098) loss_u loss_u 0.7256 (0.7050) acc_u 34.3750 (33.7500) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/16] time 0.163 (0.174) data 0.085 (0.097) loss_u loss_u 0.6455 (0.6927) acc_u 40.6250 (34.5833) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 342
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1116
clean true:1115
clean false:1
clean_rate:0.9991039426523297
noisy true:159
noisy false:341
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 500
epoch [166/200] batch [5/34] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.2064 (0.5318) acc_x 96.8750 (86.8750) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [10/34] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.8726 (0.5706) acc_x 78.1250 (85.6250) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/34] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.4800 (0.5996) acc_x 87.5000 (84.7917) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/34] time 0.183 (0.182) data 0.105 (0.104) loss_x loss_x 0.4895 (0.5492) acc_x 87.5000 (85.3125) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/34] time 0.163 (0.179) data 0.086 (0.101) loss_x loss_x 0.5586 (0.5584) acc_x 87.5000 (85.6250) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [30/34] time 0.160 (0.176) data 0.083 (0.098) loss_x loss_x 0.5693 (0.5529) acc_x 84.3750 (86.1458) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/15] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.7168 (0.6991) acc_u 34.3750 (34.3750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/15] time 0.172 (0.177) data 0.094 (0.100) loss_u loss_u 0.7603 (0.6997) acc_u 25.0000 (33.1250) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [15/15] time 0.185 (0.178) data 0.107 (0.100) loss_u loss_u 0.6221 (0.6916) acc_u 50.0000 (34.3750) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 357
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1112
clean true:1112
clean false:0
clean_rate:1.0
noisy true:147
noisy false:357
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 504
epoch [167/200] batch [5/34] time 0.173 (0.181) data 0.096 (0.103) loss_x loss_x 0.4412 (0.3812) acc_x 90.6250 (90.0000) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [10/34] time 0.182 (0.175) data 0.104 (0.098) loss_x loss_x 0.4868 (0.4536) acc_x 84.3750 (87.1875) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/34] time 0.185 (0.176) data 0.108 (0.098) loss_x loss_x 0.2559 (0.4469) acc_x 96.8750 (88.1250) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/34] time 0.179 (0.177) data 0.101 (0.100) loss_x loss_x 0.3821 (0.4531) acc_x 90.6250 (87.5000) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/34] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.3818 (0.4534) acc_x 90.6250 (87.6250) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/34] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.3137 (0.4689) acc_x 93.7500 (87.9167) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/15] time 0.175 (0.176) data 0.096 (0.098) loss_u loss_u 0.6758 (0.6287) acc_u 37.5000 (42.5000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/15] time 0.171 (0.175) data 0.092 (0.098) loss_u loss_u 0.7637 (0.6911) acc_u 31.2500 (35.0000) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [15/15] time 0.166 (0.175) data 0.089 (0.097) loss_u loss_u 0.6323 (0.7031) acc_u 43.7500 (33.9583) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 338
confident_label rate tensor(0.6986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1129
clean true:1128
clean false:1
clean_rate:0.9991142604074402
noisy true:150
noisy false:337
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 487
epoch [168/200] batch [5/35] time 0.166 (0.170) data 0.089 (0.093) loss_x loss_x 0.8198 (0.5875) acc_x 78.1250 (85.6250) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [10/35] time 0.209 (0.175) data 0.131 (0.097) loss_x loss_x 0.6074 (0.6104) acc_x 87.5000 (85.6250) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [15/35] time 0.185 (0.178) data 0.107 (0.101) loss_x loss_x 0.9683 (0.6404) acc_x 75.0000 (83.5417) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/35] time 0.178 (0.182) data 0.101 (0.104) loss_x loss_x 0.5571 (0.6140) acc_x 87.5000 (84.6875) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/35] time 0.184 (0.181) data 0.107 (0.103) loss_x loss_x 0.3801 (0.5956) acc_x 93.7500 (85.5000) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [30/35] time 0.184 (0.181) data 0.107 (0.103) loss_x loss_x 0.4880 (0.5870) acc_x 81.2500 (85.6250) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [35/35] time 0.183 (0.181) data 0.106 (0.103) loss_x loss_x 0.3970 (0.5726) acc_x 93.7500 (86.0714) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/15] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.7153 (0.7029) acc_u 28.1250 (35.6250) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [10/15] time 0.184 (0.182) data 0.106 (0.104) loss_u loss_u 0.6489 (0.7222) acc_u 43.7500 (31.8750) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [15/15] time 0.185 (0.182) data 0.107 (0.104) loss_u loss_u 0.6772 (0.7142) acc_u 40.6250 (32.9167) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 368
confident_label rate tensor(0.6813, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1101
clean true:1100
clean false:1
clean_rate:0.9990917347865577
noisy true:148
noisy false:367
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 515
epoch [169/200] batch [5/34] time 0.188 (0.182) data 0.111 (0.104) loss_x loss_x 0.3801 (0.4494) acc_x 87.5000 (88.7500) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [10/34] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.5898 (0.5706) acc_x 81.2500 (85.6250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/34] time 0.191 (0.185) data 0.114 (0.107) loss_x loss_x 0.5498 (0.5406) acc_x 87.5000 (86.6667) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [20/34] time 0.160 (0.180) data 0.083 (0.102) loss_x loss_x 0.5728 (0.5655) acc_x 87.5000 (86.0938) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/34] time 0.164 (0.178) data 0.087 (0.100) loss_x loss_x 0.5981 (0.5587) acc_x 81.2500 (86.1250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [30/34] time 0.166 (0.177) data 0.088 (0.099) loss_x loss_x 0.5547 (0.5382) acc_x 87.5000 (86.5625) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/16] time 0.182 (0.177) data 0.104 (0.099) loss_u loss_u 0.7666 (0.7043) acc_u 37.5000 (35.0000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/16] time 0.184 (0.178) data 0.107 (0.100) loss_u loss_u 0.6733 (0.7024) acc_u 43.7500 (35.3125) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [15/16] time 0.172 (0.178) data 0.093 (0.100) loss_u loss_u 0.8804 (0.6938) acc_u 12.5000 (37.2917) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 356
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1121
clean true:1120
clean false:1
clean_rate:0.9991079393398751
noisy true:140
noisy false:355
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 495
epoch [170/200] batch [5/35] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.4175 (0.3601) acc_x 90.6250 (91.8750) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [10/35] time 0.187 (0.185) data 0.109 (0.108) loss_x loss_x 0.5786 (0.4183) acc_x 90.6250 (89.6875) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/35] time 0.184 (0.185) data 0.105 (0.107) loss_x loss_x 0.6997 (0.4888) acc_x 87.5000 (87.7083) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/35] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.7041 (0.5093) acc_x 81.2500 (87.6562) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/35] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.6611 (0.5278) acc_x 84.3750 (87.3750) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [30/35] time 0.167 (0.183) data 0.090 (0.105) loss_x loss_x 0.2101 (0.4973) acc_x 93.7500 (88.1250) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [35/35] time 0.165 (0.181) data 0.087 (0.103) loss_x loss_x 0.5024 (0.5129) acc_x 90.6250 (87.6786) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/15] time 0.198 (0.181) data 0.119 (0.103) loss_u loss_u 0.6636 (0.7229) acc_u 34.3750 (30.6250) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/15] time 0.169 (0.181) data 0.091 (0.103) loss_u loss_u 0.7979 (0.7135) acc_u 28.1250 (32.8125) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [15/15] time 0.201 (0.182) data 0.123 (0.104) loss_u loss_u 0.7124 (0.7187) acc_u 37.5000 (33.5417) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 339
confident_label rate tensor(0.6931, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1120
clean true:1119
clean false:1
clean_rate:0.9991071428571429
noisy true:158
noisy false:338
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 496
epoch [171/200] batch [5/35] time 0.210 (0.181) data 0.131 (0.103) loss_x loss_x 0.4358 (0.5081) acc_x 90.6250 (88.1250) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [10/35] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 0.6177 (0.4888) acc_x 75.0000 (86.5625) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/35] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.4893 (0.4744) acc_x 90.6250 (87.7083) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [20/35] time 0.162 (0.182) data 0.084 (0.104) loss_x loss_x 0.4167 (0.4858) acc_x 90.6250 (87.5000) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/35] time 0.186 (0.182) data 0.108 (0.104) loss_x loss_x 0.4517 (0.5011) acc_x 78.1250 (86.3750) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [30/35] time 0.184 (0.183) data 0.107 (0.105) loss_x loss_x 0.8804 (0.5284) acc_x 68.7500 (85.3125) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [35/35] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.6572 (0.5473) acc_x 84.3750 (85.0000) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/15] time 0.185 (0.183) data 0.105 (0.106) loss_u loss_u 0.7466 (0.6860) acc_u 31.2500 (36.2500) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/15] time 0.187 (0.184) data 0.108 (0.106) loss_u loss_u 0.6221 (0.6937) acc_u 40.6250 (35.3125) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [15/15] time 0.186 (0.184) data 0.109 (0.106) loss_u loss_u 0.6084 (0.7004) acc_u 46.8750 (34.3750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 343
confident_label rate tensor(0.6931, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1120
clean true:1119
clean false:1
clean_rate:0.9991071428571429
noisy true:154
noisy false:342
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 496
epoch [172/200] batch [5/35] time 0.171 (0.179) data 0.093 (0.101) loss_x loss_x 0.2400 (0.5192) acc_x 93.7500 (84.3750) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [10/35] time 0.163 (0.173) data 0.086 (0.095) loss_x loss_x 0.5474 (0.5655) acc_x 81.2500 (83.4375) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/35] time 0.186 (0.177) data 0.109 (0.100) loss_x loss_x 0.2671 (0.5719) acc_x 90.6250 (83.3333) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [20/35] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.6353 (0.5830) acc_x 78.1250 (83.1250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/35] time 0.187 (0.181) data 0.109 (0.104) loss_x loss_x 0.5586 (0.5968) acc_x 90.6250 (83.6250) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [30/35] time 0.186 (0.182) data 0.109 (0.104) loss_x loss_x 0.3135 (0.5930) acc_x 96.8750 (84.0625) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [35/35] time 0.184 (0.183) data 0.107 (0.105) loss_x loss_x 0.6519 (0.5810) acc_x 81.2500 (84.2857) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/15] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.7305 (0.6794) acc_u 34.3750 (36.2500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [10/15] time 0.188 (0.184) data 0.110 (0.106) loss_u loss_u 0.6035 (0.6833) acc_u 37.5000 (35.9375) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [15/15] time 0.171 (0.183) data 0.093 (0.105) loss_u loss_u 0.7480 (0.7040) acc_u 28.1250 (33.7500) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 349
confident_label rate tensor(0.6943, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1122
clean true:1121
clean false:1
clean_rate:0.9991087344028521
noisy true:146
noisy false:348
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 494
epoch [173/200] batch [5/35] time 0.172 (0.179) data 0.094 (0.101) loss_x loss_x 0.4675 (0.5062) acc_x 93.7500 (89.3750) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [10/35] time 0.168 (0.172) data 0.090 (0.094) loss_x loss_x 0.2542 (0.4984) acc_x 96.8750 (89.3750) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/35] time 0.158 (0.170) data 0.080 (0.092) loss_x loss_x 0.5806 (0.5547) acc_x 90.6250 (87.0833) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/35] time 0.170 (0.169) data 0.093 (0.091) loss_x loss_x 0.4937 (0.5647) acc_x 87.5000 (86.8750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/35] time 0.166 (0.170) data 0.088 (0.092) loss_x loss_x 0.5049 (0.5530) acc_x 90.6250 (86.8750) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/35] time 0.185 (0.172) data 0.107 (0.094) loss_x loss_x 0.6372 (0.5501) acc_x 75.0000 (86.5625) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [35/35] time 0.184 (0.175) data 0.107 (0.097) loss_x loss_x 0.5820 (0.5441) acc_x 78.1250 (86.5179) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/15] time 0.185 (0.176) data 0.106 (0.098) loss_u loss_u 0.7603 (0.7279) acc_u 31.2500 (33.1250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/15] time 0.185 (0.177) data 0.108 (0.099) loss_u loss_u 0.6689 (0.7226) acc_u 34.3750 (32.8125) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [15/15] time 0.186 (0.178) data 0.107 (0.100) loss_u loss_u 0.6763 (0.7290) acc_u 34.3750 (32.0833) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 351
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1115
clean true:1115
clean false:0
clean_rate:1.0
noisy true:150
noisy false:351
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 501
epoch [174/200] batch [5/34] time 0.163 (0.183) data 0.086 (0.106) loss_x loss_x 0.8467 (0.5779) acc_x 78.1250 (83.7500) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [10/34] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.5210 (0.6060) acc_x 87.5000 (83.7500) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/34] time 0.162 (0.173) data 0.084 (0.095) loss_x loss_x 0.4014 (0.5612) acc_x 90.6250 (85.4167) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/34] time 0.166 (0.171) data 0.088 (0.093) loss_x loss_x 0.3840 (0.5571) acc_x 87.5000 (84.8438) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/34] time 0.183 (0.171) data 0.106 (0.094) loss_x loss_x 0.6475 (0.5386) acc_x 87.5000 (85.6250) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [30/34] time 0.187 (0.174) data 0.109 (0.096) loss_x loss_x 0.3333 (0.5323) acc_x 90.6250 (86.0417) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/15] time 0.184 (0.176) data 0.106 (0.098) loss_u loss_u 0.6147 (0.7046) acc_u 40.6250 (35.6250) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/15] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.6680 (0.7019) acc_u 40.6250 (35.9375) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [15/15] time 0.187 (0.178) data 0.110 (0.100) loss_u loss_u 0.5547 (0.7010) acc_u 50.0000 (35.4167) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 360
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1111
clean true:1108
clean false:3
clean_rate:0.9972997299729973
noisy true:148
noisy false:357
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 505
epoch [175/200] batch [5/34] time 0.184 (0.190) data 0.106 (0.112) loss_x loss_x 0.2908 (0.4317) acc_x 93.7500 (85.6250) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [10/34] time 0.186 (0.188) data 0.109 (0.110) loss_x loss_x 0.6807 (0.5019) acc_x 81.2500 (85.0000) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/34] time 0.186 (0.187) data 0.108 (0.110) loss_x loss_x 0.8320 (0.5425) acc_x 75.0000 (84.5833) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/34] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.3257 (0.5161) acc_x 93.7500 (85.7812) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/34] time 0.160 (0.184) data 0.082 (0.107) loss_x loss_x 0.5229 (0.5309) acc_x 84.3750 (86.2500) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [30/34] time 0.167 (0.182) data 0.089 (0.104) loss_x loss_x 0.9795 (0.5554) acc_x 75.0000 (85.2083) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/15] time 0.186 (0.181) data 0.108 (0.103) loss_u loss_u 0.7769 (0.7134) acc_u 28.1250 (33.7500) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [10/15] time 0.185 (0.181) data 0.107 (0.103) loss_u loss_u 0.7373 (0.7083) acc_u 28.1250 (34.3750) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [15/15] time 0.172 (0.180) data 0.093 (0.103) loss_u loss_u 0.7432 (0.6964) acc_u 25.0000 (35.4167) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 337
confident_label rate tensor(0.6993, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1130
clean true:1128
clean false:2
clean_rate:0.9982300884955753
noisy true:151
noisy false:335
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 486
epoch [176/200] batch [5/35] time 0.184 (0.197) data 0.107 (0.119) loss_x loss_x 0.5054 (0.4477) acc_x 87.5000 (87.5000) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [10/35] time 0.182 (0.190) data 0.104 (0.112) loss_x loss_x 0.5269 (0.5111) acc_x 81.2500 (84.0625) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/35] time 0.185 (0.188) data 0.107 (0.110) loss_x loss_x 0.5010 (0.5154) acc_x 84.3750 (84.3750) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/35] time 0.182 (0.187) data 0.105 (0.109) loss_x loss_x 0.6523 (0.5268) acc_x 87.5000 (85.1562) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/35] time 0.186 (0.186) data 0.108 (0.109) loss_x loss_x 0.6025 (0.5283) acc_x 78.1250 (85.0000) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [30/35] time 0.182 (0.186) data 0.104 (0.108) loss_x loss_x 0.5093 (0.5465) acc_x 87.5000 (85.2083) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [35/35] time 0.185 (0.186) data 0.108 (0.108) loss_x loss_x 0.6650 (0.5655) acc_x 81.2500 (84.6429) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/15] time 0.185 (0.186) data 0.108 (0.108) loss_u loss_u 0.7612 (0.7110) acc_u 28.1250 (34.3750) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [10/15] time 0.185 (0.186) data 0.107 (0.108) loss_u loss_u 0.7671 (0.7072) acc_u 21.8750 (34.6875) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [15/15] time 0.184 (0.186) data 0.106 (0.108) loss_u loss_u 0.6187 (0.6982) acc_u 43.7500 (35.0000) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 337
confident_label rate tensor(0.6974, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1127
clean true:1126
clean false:1
clean_rate:0.9991126885536823
noisy true:153
noisy false:336
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 489
epoch [177/200] batch [5/35] time 0.166 (0.172) data 0.087 (0.094) loss_x loss_x 0.7847 (0.6779) acc_x 90.6250 (84.3750) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [10/35] time 0.183 (0.174) data 0.106 (0.096) loss_x loss_x 0.6562 (0.6818) acc_x 90.6250 (83.1250) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/35] time 0.182 (0.176) data 0.104 (0.099) loss_x loss_x 0.7383 (0.6551) acc_x 81.2500 (83.9583) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/35] time 0.162 (0.176) data 0.084 (0.099) loss_x loss_x 0.6499 (0.6625) acc_x 78.1250 (83.1250) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/35] time 0.174 (0.175) data 0.096 (0.098) loss_x loss_x 0.4587 (0.5978) acc_x 84.3750 (84.6250) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [30/35] time 0.184 (0.176) data 0.103 (0.099) loss_x loss_x 0.4634 (0.5835) acc_x 87.5000 (85.1042) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [35/35] time 0.169 (0.177) data 0.092 (0.099) loss_x loss_x 0.9224 (0.5898) acc_x 71.8750 (84.9107) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/15] time 0.172 (0.176) data 0.094 (0.098) loss_u loss_u 0.7183 (0.6711) acc_u 34.3750 (39.3750) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/15] time 0.181 (0.176) data 0.103 (0.098) loss_u loss_u 0.6924 (0.6870) acc_u 34.3750 (36.8750) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [15/15] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.8862 (0.7113) acc_u 15.6250 (34.1667) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 333
confident_label rate tensor(0.6986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1129
clean true:1129
clean false:0
clean_rate:1.0
noisy true:154
noisy false:333
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 487
epoch [178/200] batch [5/35] time 0.158 (0.175) data 0.081 (0.097) loss_x loss_x 0.7764 (0.5406) acc_x 84.3750 (86.2500) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [10/35] time 0.178 (0.172) data 0.100 (0.094) loss_x loss_x 0.7178 (0.5512) acc_x 78.1250 (84.6875) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/35] time 0.172 (0.173) data 0.095 (0.095) loss_x loss_x 0.1251 (0.5227) acc_x 100.0000 (85.6250) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/35] time 0.162 (0.171) data 0.084 (0.093) loss_x loss_x 0.6431 (0.5393) acc_x 87.5000 (85.4688) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/35] time 0.163 (0.172) data 0.086 (0.094) loss_x loss_x 0.5811 (0.5322) acc_x 84.3750 (85.8750) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [30/35] time 0.167 (0.171) data 0.090 (0.094) loss_x loss_x 0.3623 (0.5367) acc_x 96.8750 (86.2500) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [35/35] time 0.182 (0.173) data 0.105 (0.095) loss_x loss_x 0.7124 (0.5506) acc_x 87.5000 (86.5179) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/15] time 0.184 (0.175) data 0.106 (0.097) loss_u loss_u 0.7944 (0.7350) acc_u 25.0000 (31.8750) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [10/15] time 0.184 (0.176) data 0.106 (0.098) loss_u loss_u 0.7217 (0.7356) acc_u 34.3750 (31.8750) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [15/15] time 0.185 (0.177) data 0.107 (0.099) loss_u loss_u 0.6323 (0.7173) acc_u 43.7500 (33.7500) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 338
confident_label rate tensor(0.6974, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1127
clean true:1127
clean false:0
clean_rate:1.0
noisy true:151
noisy false:338
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 489
epoch [179/200] batch [5/35] time 0.196 (0.188) data 0.119 (0.111) loss_x loss_x 0.3999 (0.6277) acc_x 90.6250 (81.2500) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [10/35] time 0.176 (0.186) data 0.097 (0.108) loss_x loss_x 0.9253 (0.6696) acc_x 81.2500 (80.9375) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/35] time 0.173 (0.183) data 0.095 (0.105) loss_x loss_x 1.1230 (0.6597) acc_x 75.0000 (83.1250) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [20/35] time 0.184 (0.181) data 0.107 (0.103) loss_x loss_x 0.6123 (0.6357) acc_x 87.5000 (83.9062) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/35] time 0.186 (0.181) data 0.109 (0.103) loss_x loss_x 0.6182 (0.5952) acc_x 84.3750 (85.0000) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [30/35] time 0.174 (0.181) data 0.096 (0.103) loss_x loss_x 1.0352 (0.6145) acc_x 68.7500 (84.4792) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [35/35] time 0.186 (0.180) data 0.108 (0.103) loss_x loss_x 0.4390 (0.6046) acc_x 87.5000 (84.5536) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/15] time 0.181 (0.181) data 0.104 (0.103) loss_u loss_u 0.8105 (0.7273) acc_u 25.0000 (32.5000) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/15] time 0.174 (0.180) data 0.095 (0.103) loss_u loss_u 0.7485 (0.7209) acc_u 28.1250 (32.8125) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [15/15] time 0.165 (0.180) data 0.087 (0.102) loss_u loss_u 0.6846 (0.7036) acc_u 40.6250 (35.6250) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 345
confident_label rate tensor(0.6925, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1119
clean true:1117
clean false:2
clean_rate:0.998212689901698
noisy true:154
noisy false:343
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 497
epoch [180/200] batch [5/34] time 0.185 (0.181) data 0.108 (0.103) loss_x loss_x 0.5479 (0.5256) acc_x 90.6250 (86.2500) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [10/34] time 0.185 (0.183) data 0.107 (0.105) loss_x loss_x 0.7300 (0.5444) acc_x 81.2500 (86.2500) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/34] time 0.187 (0.185) data 0.108 (0.107) loss_x loss_x 0.6514 (0.5110) acc_x 90.6250 (87.2917) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/34] time 0.188 (0.185) data 0.111 (0.107) loss_x loss_x 0.3188 (0.4958) acc_x 100.0000 (87.8125) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/34] time 0.187 (0.185) data 0.109 (0.107) loss_x loss_x 0.7329 (0.4939) acc_x 81.2500 (87.8750) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [30/34] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.5703 (0.4722) acc_x 81.2500 (88.1250) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/15] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.7236 (0.7126) acc_u 31.2500 (33.7500) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/15] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.7002 (0.7255) acc_u 34.3750 (32.1875) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [15/15] time 0.185 (0.186) data 0.107 (0.108) loss_u loss_u 0.6567 (0.7106) acc_u 37.5000 (33.3333) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 316
confident_label rate tensor(0.7123, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1151
clean true:1149
clean false:2
clean_rate:0.998262380538662
noisy true:151
noisy false:314
after delete: len(clean_dataset) 1151
after delete: len(noisy_dataset) 465
epoch [181/200] batch [5/35] time 0.181 (0.183) data 0.104 (0.105) loss_x loss_x 0.7690 (0.6625) acc_x 81.2500 (83.1250) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [10/35] time 0.190 (0.189) data 0.113 (0.111) loss_x loss_x 0.3660 (0.6419) acc_x 93.7500 (84.0625) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/35] time 0.160 (0.187) data 0.082 (0.109) loss_x loss_x 0.5405 (0.6576) acc_x 87.5000 (83.5417) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/35] time 0.160 (0.180) data 0.082 (0.103) loss_x loss_x 0.6895 (0.6190) acc_x 84.3750 (84.3750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/35] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.5679 (0.6043) acc_x 87.5000 (84.7500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [30/35] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 0.4739 (0.5908) acc_x 87.5000 (85.2083) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [35/35] time 0.177 (0.180) data 0.099 (0.102) loss_x loss_x 0.7031 (0.5792) acc_x 81.2500 (85.2679) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/14] time 0.187 (0.180) data 0.108 (0.102) loss_u loss_u 0.7280 (0.7700) acc_u 31.2500 (24.3750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [10/14] time 0.184 (0.179) data 0.105 (0.101) loss_u loss_u 0.6528 (0.7321) acc_u 37.5000 (29.6875) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 342
confident_label rate tensor(0.6993, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1130
clean true:1129
clean false:1
clean_rate:0.9991150442477876
noisy true:145
noisy false:341
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 486
epoch [182/200] batch [5/35] time 0.186 (0.186) data 0.108 (0.109) loss_x loss_x 0.3157 (0.4369) acc_x 93.7500 (88.7500) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [10/35] time 0.169 (0.181) data 0.092 (0.104) loss_x loss_x 0.6851 (0.4493) acc_x 75.0000 (88.7500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/35] time 0.177 (0.181) data 0.099 (0.103) loss_x loss_x 1.1035 (0.5232) acc_x 71.8750 (86.8750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [20/35] time 0.184 (0.181) data 0.106 (0.103) loss_x loss_x 0.5615 (0.5479) acc_x 84.3750 (85.7812) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/35] time 0.185 (0.182) data 0.107 (0.104) loss_x loss_x 0.7979 (0.5639) acc_x 81.2500 (86.0000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [30/35] time 0.179 (0.182) data 0.101 (0.105) loss_x loss_x 0.2323 (0.5652) acc_x 93.7500 (85.6250) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [35/35] time 0.195 (0.182) data 0.116 (0.105) loss_x loss_x 0.6899 (0.5844) acc_x 84.3750 (84.9107) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/15] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.7275 (0.7412) acc_u 31.2500 (31.2500) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/15] time 0.163 (0.182) data 0.085 (0.104) loss_u loss_u 0.5742 (0.7270) acc_u 50.0000 (32.8125) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [15/15] time 0.178 (0.181) data 0.099 (0.103) loss_u loss_u 0.5791 (0.7167) acc_u 50.0000 (33.7500) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 355
confident_label rate tensor(0.6850, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1107
clean true:1107
clean false:0
clean_rate:1.0
noisy true:154
noisy false:355
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 509
epoch [183/200] batch [5/34] time 0.174 (0.170) data 0.095 (0.092) loss_x loss_x 0.3740 (0.5629) acc_x 90.6250 (85.6250) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/34] time 0.163 (0.173) data 0.085 (0.095) loss_x loss_x 0.4856 (0.5491) acc_x 84.3750 (84.6875) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/34] time 0.179 (0.174) data 0.101 (0.097) loss_x loss_x 0.3149 (0.5194) acc_x 96.8750 (86.4583) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [20/34] time 0.179 (0.176) data 0.101 (0.098) loss_x loss_x 0.4492 (0.4946) acc_x 81.2500 (86.2500) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/34] time 0.167 (0.175) data 0.089 (0.097) loss_x loss_x 0.5010 (0.5079) acc_x 84.3750 (86.3750) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [30/34] time 0.161 (0.173) data 0.083 (0.096) loss_x loss_x 0.1807 (0.5091) acc_x 93.7500 (86.1458) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/15] time 0.194 (0.174) data 0.115 (0.097) loss_u loss_u 0.6431 (0.7178) acc_u 37.5000 (33.7500) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/15] time 0.162 (0.175) data 0.085 (0.097) loss_u loss_u 0.7861 (0.6962) acc_u 21.8750 (34.3750) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [15/15] time 0.162 (0.174) data 0.084 (0.096) loss_u loss_u 0.6855 (0.6905) acc_u 31.2500 (34.5833) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 326
confident_label rate tensor(0.7054, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1140
clean true:1138
clean false:2
clean_rate:0.9982456140350877
noisy true:152
noisy false:324
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 476
epoch [184/200] batch [5/35] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 0.6060 (0.5406) acc_x 78.1250 (86.8750) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [10/35] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.2712 (0.4869) acc_x 93.7500 (87.8125) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/35] time 0.177 (0.183) data 0.099 (0.106) loss_x loss_x 0.8877 (0.5491) acc_x 78.1250 (86.2500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [20/35] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.5835 (0.5619) acc_x 87.5000 (85.6250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/35] time 0.195 (0.181) data 0.115 (0.103) loss_x loss_x 0.8374 (0.5928) acc_x 81.2500 (85.1250) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [30/35] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.3662 (0.5720) acc_x 96.8750 (85.5208) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [35/35] time 0.173 (0.179) data 0.095 (0.102) loss_x loss_x 0.5088 (0.5774) acc_x 84.3750 (85.1786) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/14] time 0.178 (0.180) data 0.099 (0.102) loss_u loss_u 0.6523 (0.7279) acc_u 37.5000 (31.2500) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [10/14] time 0.182 (0.179) data 0.104 (0.101) loss_u loss_u 0.6479 (0.6980) acc_u 40.6250 (34.3750) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 343
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1121
clean true:1119
clean false:2
clean_rate:0.9982158786797503
noisy true:154
noisy false:341
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 495
epoch [185/200] batch [5/35] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.4778 (0.6056) acc_x 87.5000 (85.6250) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [10/35] time 0.196 (0.186) data 0.118 (0.109) loss_x loss_x 0.4817 (0.5577) acc_x 90.6250 (87.5000) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/35] time 0.174 (0.184) data 0.097 (0.106) loss_x loss_x 0.7944 (0.5856) acc_x 81.2500 (85.8333) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [20/35] time 0.183 (0.183) data 0.106 (0.105) loss_x loss_x 0.2148 (0.5970) acc_x 96.8750 (85.0000) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/35] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.1663 (0.5721) acc_x 96.8750 (85.3750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [30/35] time 0.182 (0.183) data 0.104 (0.105) loss_x loss_x 0.4045 (0.5802) acc_x 90.6250 (85.1042) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [35/35] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.9517 (0.5926) acc_x 68.7500 (84.7321) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/15] time 0.185 (0.183) data 0.106 (0.105) loss_u loss_u 0.7397 (0.7064) acc_u 28.1250 (33.7500) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/15] time 0.184 (0.183) data 0.105 (0.105) loss_u loss_u 0.7148 (0.7105) acc_u 31.2500 (33.4375) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [15/15] time 0.183 (0.183) data 0.106 (0.105) loss_u loss_u 0.7793 (0.7125) acc_u 21.8750 (32.9167) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 335
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1121
clean true:1120
clean false:1
clean_rate:0.9991079393398751
noisy true:161
noisy false:334
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 495
epoch [186/200] batch [5/35] time 0.177 (0.178) data 0.100 (0.100) loss_x loss_x 0.7319 (0.5288) acc_x 81.2500 (86.2500) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [10/35] time 0.161 (0.174) data 0.084 (0.096) loss_x loss_x 0.6045 (0.4839) acc_x 93.7500 (88.1250) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/35] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.7671 (0.5075) acc_x 71.8750 (86.6667) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [20/35] time 0.180 (0.176) data 0.102 (0.098) loss_x loss_x 0.5566 (0.5190) acc_x 87.5000 (86.5625) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/35] time 0.211 (0.179) data 0.135 (0.101) loss_x loss_x 0.3640 (0.4924) acc_x 93.7500 (87.5000) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [30/35] time 0.185 (0.180) data 0.109 (0.102) loss_x loss_x 0.7720 (0.5101) acc_x 84.3750 (87.1875) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [35/35] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.4316 (0.5095) acc_x 90.6250 (87.5893) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/15] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.7295 (0.7019) acc_u 31.2500 (35.0000) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [10/15] time 0.187 (0.181) data 0.108 (0.104) loss_u loss_u 0.7119 (0.7133) acc_u 34.3750 (34.0625) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [15/15] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.7134 (0.7111) acc_u 37.5000 (34.3750) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 347
confident_label rate tensor(0.6925, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1119
clean true:1117
clean false:2
clean_rate:0.998212689901698
noisy true:152
noisy false:345
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 497
epoch [187/200] batch [5/34] time 0.178 (0.181) data 0.100 (0.103) loss_x loss_x 0.4019 (0.3857) acc_x 87.5000 (88.7500) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [10/34] time 0.165 (0.177) data 0.087 (0.100) loss_x loss_x 0.4541 (0.4471) acc_x 84.3750 (87.5000) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/34] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 0.2283 (0.4466) acc_x 96.8750 (87.9167) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/34] time 0.168 (0.178) data 0.091 (0.100) loss_x loss_x 0.5635 (0.4727) acc_x 84.3750 (87.1875) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/34] time 0.173 (0.178) data 0.094 (0.100) loss_x loss_x 0.8081 (0.4921) acc_x 75.0000 (86.8750) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [30/34] time 0.184 (0.177) data 0.106 (0.100) loss_x loss_x 0.5732 (0.4935) acc_x 81.2500 (86.5625) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/15] time 0.162 (0.174) data 0.084 (0.097) loss_u loss_u 0.6162 (0.7138) acc_u 43.7500 (33.7500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [10/15] time 0.181 (0.174) data 0.104 (0.097) loss_u loss_u 0.7305 (0.7025) acc_u 31.2500 (34.3750) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [15/15] time 0.164 (0.173) data 0.086 (0.096) loss_u loss_u 0.6953 (0.7056) acc_u 31.2500 (33.9583) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 352
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1109
clean true:1108
clean false:1
clean_rate:0.9990982867448152
noisy true:156
noisy false:351
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 507
epoch [188/200] batch [5/34] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.3950 (0.6157) acc_x 90.6250 (83.1250) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [10/34] time 0.185 (0.181) data 0.108 (0.103) loss_x loss_x 0.5215 (0.5150) acc_x 84.3750 (87.1875) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/34] time 0.189 (0.183) data 0.111 (0.105) loss_x loss_x 0.6318 (0.5230) acc_x 87.5000 (86.6667) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/34] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4038 (0.5167) acc_x 87.5000 (86.4062) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/34] time 0.160 (0.180) data 0.083 (0.103) loss_x loss_x 0.3145 (0.5162) acc_x 96.8750 (85.8750) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [30/34] time 0.187 (0.181) data 0.110 (0.104) loss_x loss_x 0.3579 (0.5049) acc_x 96.8750 (86.2500) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/15] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.6802 (0.7048) acc_u 34.3750 (33.7500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/15] time 0.187 (0.182) data 0.109 (0.105) loss_u loss_u 0.7300 (0.6893) acc_u 28.1250 (35.9375) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [15/15] time 0.165 (0.182) data 0.086 (0.104) loss_u loss_u 0.5923 (0.6931) acc_u 50.0000 (36.0417) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 355
confident_label rate tensor(0.6968, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1126
clean true:1123
clean false:3
clean_rate:0.9973357015985791
noisy true:138
noisy false:352
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 490
epoch [189/200] batch [5/35] time 0.188 (0.187) data 0.111 (0.109) loss_x loss_x 0.2238 (0.4109) acc_x 90.6250 (90.0000) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [10/35] time 0.187 (0.186) data 0.109 (0.109) loss_x loss_x 0.5586 (0.5142) acc_x 84.3750 (86.8750) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/35] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.6362 (0.4894) acc_x 81.2500 (87.0833) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/35] time 0.186 (0.180) data 0.109 (0.102) loss_x loss_x 0.6079 (0.5284) acc_x 84.3750 (85.7812) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/35] time 0.170 (0.182) data 0.092 (0.105) loss_x loss_x 0.4556 (0.5269) acc_x 90.6250 (85.8750) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [30/35] time 0.187 (0.181) data 0.110 (0.103) loss_x loss_x 0.5679 (0.5088) acc_x 84.3750 (86.5625) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [35/35] time 0.167 (0.180) data 0.089 (0.102) loss_x loss_x 0.4810 (0.5189) acc_x 84.3750 (86.5179) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/15] time 0.183 (0.180) data 0.104 (0.102) loss_u loss_u 0.5586 (0.6961) acc_u 50.0000 (33.7500) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/15] time 0.179 (0.180) data 0.101 (0.102) loss_u loss_u 0.6968 (0.7068) acc_u 34.3750 (34.0625) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [15/15] time 0.161 (0.179) data 0.082 (0.101) loss_u loss_u 0.7866 (0.7086) acc_u 28.1250 (34.1667) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 351
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1111
clean true:1111
clean false:0
clean_rate:1.0
noisy true:154
noisy false:351
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 505
epoch [190/200] batch [5/34] time 0.202 (0.197) data 0.124 (0.119) loss_x loss_x 0.3708 (0.5281) acc_x 90.6250 (87.5000) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [10/34] time 0.172 (0.183) data 0.095 (0.106) loss_x loss_x 0.2408 (0.4748) acc_x 93.7500 (87.8125) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/34] time 0.162 (0.177) data 0.084 (0.099) loss_x loss_x 0.7773 (0.5004) acc_x 84.3750 (86.8750) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/34] time 0.172 (0.177) data 0.094 (0.099) loss_x loss_x 0.4880 (0.5153) acc_x 87.5000 (86.7188) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/34] time 0.162 (0.175) data 0.085 (0.097) loss_x loss_x 0.8062 (0.5283) acc_x 75.0000 (85.8750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [30/34] time 0.169 (0.173) data 0.091 (0.096) loss_x loss_x 0.3218 (0.5006) acc_x 93.7500 (86.8750) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/15] time 0.176 (0.171) data 0.098 (0.094) loss_u loss_u 0.6523 (0.6387) acc_u 40.6250 (41.8750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/15] time 0.176 (0.172) data 0.097 (0.094) loss_u loss_u 0.7969 (0.6897) acc_u 25.0000 (35.9375) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [15/15] time 0.158 (0.172) data 0.081 (0.094) loss_u loss_u 0.7510 (0.6886) acc_u 31.2500 (35.8333) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 340
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1125
clean true:1122
clean false:3
clean_rate:0.9973333333333333
noisy true:154
noisy false:337
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 491
epoch [191/200] batch [5/35] time 0.181 (0.186) data 0.104 (0.108) loss_x loss_x 0.7183 (0.5612) acc_x 84.3750 (87.5000) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [10/35] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.6914 (0.6347) acc_x 87.5000 (85.0000) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/35] time 0.186 (0.186) data 0.109 (0.108) loss_x loss_x 0.5083 (0.6326) acc_x 81.2500 (83.5417) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/35] time 0.182 (0.186) data 0.105 (0.108) loss_x loss_x 0.6245 (0.6238) acc_x 87.5000 (84.6875) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/35] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.2496 (0.5945) acc_x 96.8750 (85.3750) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [30/35] time 0.192 (0.186) data 0.114 (0.108) loss_x loss_x 1.0322 (0.6064) acc_x 78.1250 (84.8958) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [35/35] time 0.184 (0.186) data 0.106 (0.108) loss_x loss_x 0.4890 (0.6114) acc_x 81.2500 (84.2857) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/15] time 0.185 (0.186) data 0.107 (0.108) loss_u loss_u 0.7417 (0.6963) acc_u 34.3750 (34.3750) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/15] time 0.186 (0.186) data 0.109 (0.108) loss_u loss_u 0.6870 (0.7035) acc_u 34.3750 (33.1250) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [15/15] time 0.184 (0.186) data 0.106 (0.108) loss_u loss_u 0.6816 (0.7129) acc_u 37.5000 (32.7083) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 343
confident_label rate tensor(0.6949, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1123
clean true:1123
clean false:0
clean_rate:1.0
noisy true:150
noisy false:343
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 493
epoch [192/200] batch [5/35] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.2141 (0.5336) acc_x 93.7500 (85.6250) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [10/35] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 0.6265 (0.5604) acc_x 81.2500 (83.7500) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/35] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.4426 (0.5530) acc_x 90.6250 (84.3750) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [20/35] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.3357 (0.5157) acc_x 90.6250 (85.4688) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/35] time 0.191 (0.185) data 0.114 (0.108) loss_x loss_x 0.5342 (0.5321) acc_x 84.3750 (86.1250) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [30/35] time 0.176 (0.185) data 0.099 (0.107) loss_x loss_x 0.9131 (0.5257) acc_x 81.2500 (86.6667) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [35/35] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.5278 (0.5213) acc_x 84.3750 (86.6071) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/15] time 0.189 (0.185) data 0.112 (0.107) loss_u loss_u 0.7793 (0.6835) acc_u 28.1250 (37.5000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [10/15] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.6357 (0.7042) acc_u 46.8750 (35.3125) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [15/15] time 0.187 (0.184) data 0.109 (0.107) loss_u loss_u 0.6499 (0.7035) acc_u 40.6250 (35.4167) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 369
confident_label rate tensor(0.6819, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1102
clean true:1100
clean false:2
clean_rate:0.9981851179673321
noisy true:147
noisy false:367
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 514
epoch [193/200] batch [5/34] time 0.167 (0.172) data 0.090 (0.094) loss_x loss_x 0.5737 (0.4837) acc_x 81.2500 (87.5000) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/34] time 0.163 (0.169) data 0.086 (0.091) loss_x loss_x 0.4368 (0.4714) acc_x 90.6250 (88.7500) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [15/34] time 0.162 (0.166) data 0.085 (0.089) loss_x loss_x 0.4072 (0.4625) acc_x 87.5000 (88.9583) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/34] time 0.164 (0.166) data 0.087 (0.088) loss_x loss_x 0.5234 (0.4886) acc_x 84.3750 (88.5938) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/34] time 0.186 (0.170) data 0.109 (0.092) loss_x loss_x 0.5771 (0.4987) acc_x 81.2500 (88.2500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [30/34] time 0.184 (0.173) data 0.106 (0.095) loss_x loss_x 0.1564 (0.5062) acc_x 96.8750 (87.9167) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/16] time 0.184 (0.176) data 0.106 (0.098) loss_u loss_u 0.6553 (0.7061) acc_u 40.6250 (36.8750) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/16] time 0.187 (0.177) data 0.107 (0.099) loss_u loss_u 0.7603 (0.6923) acc_u 28.1250 (36.8750) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [15/16] time 0.186 (0.178) data 0.109 (0.100) loss_u loss_u 0.6304 (0.7002) acc_u 46.8750 (35.8333) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 353
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1116
clean true:1115
clean false:1
clean_rate:0.9991039426523297
noisy true:148
noisy false:352
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 500
epoch [194/200] batch [5/34] time 0.183 (0.187) data 0.106 (0.109) loss_x loss_x 0.4568 (0.5761) acc_x 90.6250 (84.3750) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [10/34] time 0.187 (0.186) data 0.109 (0.109) loss_x loss_x 0.4829 (0.5342) acc_x 90.6250 (85.9375) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/34] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.3049 (0.5482) acc_x 93.7500 (86.0417) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [20/34] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 1.0029 (0.5656) acc_x 78.1250 (86.2500) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/34] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.5815 (0.5594) acc_x 84.3750 (85.7500) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [30/34] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.4399 (0.5497) acc_x 90.6250 (85.6250) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/15] time 0.184 (0.185) data 0.107 (0.107) loss_u loss_u 0.7212 (0.6294) acc_u 34.3750 (43.1250) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/15] time 0.184 (0.185) data 0.106 (0.107) loss_u loss_u 0.5942 (0.6757) acc_u 43.7500 (37.1875) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [15/15] time 0.182 (0.185) data 0.105 (0.107) loss_u loss_u 0.6719 (0.6834) acc_u 40.6250 (36.8750) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 324
confident_label rate tensor(0.7042, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1138
clean true:1136
clean false:2
clean_rate:0.9982425307557118
noisy true:156
noisy false:322
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 478
epoch [195/200] batch [5/35] time 0.172 (0.173) data 0.094 (0.096) loss_x loss_x 0.6523 (0.5054) acc_x 87.5000 (87.5000) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [10/35] time 0.182 (0.174) data 0.105 (0.096) loss_x loss_x 0.7461 (0.5417) acc_x 87.5000 (86.8750) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/35] time 0.166 (0.172) data 0.088 (0.095) loss_x loss_x 0.4646 (0.5755) acc_x 90.6250 (85.8333) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/35] time 0.162 (0.171) data 0.085 (0.093) loss_x loss_x 0.8311 (0.5868) acc_x 81.2500 (85.3125) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/35] time 0.161 (0.169) data 0.084 (0.091) loss_x loss_x 0.3677 (0.5605) acc_x 93.7500 (85.8750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [30/35] time 0.180 (0.168) data 0.102 (0.091) loss_x loss_x 0.9326 (0.5757) acc_x 71.8750 (85.4167) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [35/35] time 0.163 (0.168) data 0.086 (0.090) loss_x loss_x 0.2947 (0.5822) acc_x 96.8750 (85.3571) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/14] time 0.167 (0.168) data 0.089 (0.090) loss_u loss_u 0.6968 (0.7343) acc_u 31.2500 (30.6250) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/14] time 0.165 (0.168) data 0.086 (0.091) loss_u loss_u 0.7471 (0.7206) acc_u 31.2500 (33.1250) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 350
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1111
clean true:1110
clean false:1
clean_rate:0.9990999099909991
noisy true:156
noisy false:349
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 505
epoch [196/200] batch [5/34] time 0.185 (0.187) data 0.107 (0.110) loss_x loss_x 0.6782 (0.6075) acc_x 81.2500 (80.0000) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [10/34] time 0.176 (0.184) data 0.096 (0.106) loss_x loss_x 0.4153 (0.5241) acc_x 87.5000 (82.8125) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/34] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.5068 (0.5277) acc_x 87.5000 (83.7500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/34] time 0.174 (0.181) data 0.095 (0.103) loss_x loss_x 0.5386 (0.5119) acc_x 87.5000 (85.1562) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/34] time 0.185 (0.181) data 0.107 (0.103) loss_x loss_x 0.5107 (0.5038) acc_x 84.3750 (85.8750) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [30/34] time 0.184 (0.181) data 0.106 (0.103) loss_x loss_x 0.5010 (0.5350) acc_x 84.3750 (85.4167) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/15] time 0.184 (0.182) data 0.106 (0.104) loss_u loss_u 0.6748 (0.6312) acc_u 40.6250 (43.1250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/15] time 0.181 (0.182) data 0.102 (0.104) loss_u loss_u 0.7402 (0.6761) acc_u 37.5000 (39.6875) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [15/15] time 0.174 (0.182) data 0.094 (0.104) loss_u loss_u 0.7319 (0.6842) acc_u 31.2500 (37.5000) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 335
confident_label rate tensor(0.7017, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1134
clean true:1133
clean false:1
clean_rate:0.9991181657848325
noisy true:148
noisy false:334
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 482
epoch [197/200] batch [5/35] time 0.184 (0.186) data 0.106 (0.109) loss_x loss_x 0.3284 (0.5310) acc_x 90.6250 (85.6250) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [10/35] time 0.185 (0.186) data 0.107 (0.109) loss_x loss_x 0.8110 (0.5404) acc_x 75.0000 (85.6250) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [15/35] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.4392 (0.5433) acc_x 84.3750 (85.4167) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/35] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.2452 (0.5366) acc_x 87.5000 (85.3125) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/35] time 0.183 (0.186) data 0.105 (0.108) loss_x loss_x 0.5786 (0.5481) acc_x 84.3750 (85.0000) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [30/35] time 0.185 (0.186) data 0.108 (0.108) loss_x loss_x 0.6118 (0.5429) acc_x 84.3750 (85.2083) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [35/35] time 0.184 (0.185) data 0.105 (0.108) loss_x loss_x 0.5098 (0.5424) acc_x 90.6250 (85.3571) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/15] time 0.186 (0.185) data 0.106 (0.108) loss_u loss_u 0.8311 (0.7405) acc_u 18.7500 (31.8750) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [10/15] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.6943 (0.7268) acc_u 31.2500 (32.1875) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [15/15] time 0.187 (0.186) data 0.110 (0.108) loss_u loss_u 0.6313 (0.7157) acc_u 34.3750 (32.5000) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 374
confident_label rate tensor(0.6726, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1087
clean true:1086
clean false:1
clean_rate:0.9990800367985281
noisy true:156
noisy false:373
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 529
epoch [198/200] batch [5/33] time 0.187 (0.191) data 0.109 (0.113) loss_x loss_x 0.4827 (0.6512) acc_x 87.5000 (84.3750) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [10/33] time 0.184 (0.188) data 0.106 (0.111) loss_x loss_x 0.6089 (0.6462) acc_x 81.2500 (83.4375) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/33] time 0.196 (0.188) data 0.118 (0.110) loss_x loss_x 0.4463 (0.6112) acc_x 84.3750 (83.9583) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [20/33] time 0.184 (0.187) data 0.105 (0.109) loss_x loss_x 0.6738 (0.6093) acc_x 78.1250 (83.9062) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/33] time 0.185 (0.186) data 0.107 (0.109) loss_x loss_x 0.1715 (0.5737) acc_x 93.7500 (84.7500) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [30/33] time 0.166 (0.184) data 0.089 (0.106) loss_x loss_x 0.3904 (0.5876) acc_x 90.6250 (84.3750) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/16] time 0.165 (0.181) data 0.087 (0.103) loss_u loss_u 0.6401 (0.7134) acc_u 37.5000 (31.8750) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/16] time 0.185 (0.181) data 0.107 (0.103) loss_u loss_u 0.5342 (0.6587) acc_u 56.2500 (39.0625) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/16] time 0.169 (0.180) data 0.091 (0.103) loss_u loss_u 0.7349 (0.6728) acc_u 28.1250 (37.0833) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 363
confident_label rate tensor(0.6819, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1102
clean true:1100
clean false:2
clean_rate:0.9981851179673321
noisy true:153
noisy false:361
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 514
epoch [199/200] batch [5/34] time 0.171 (0.168) data 0.094 (0.090) loss_x loss_x 0.7896 (0.6067) acc_x 78.1250 (83.7500) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/34] time 0.178 (0.171) data 0.101 (0.093) loss_x loss_x 0.4773 (0.5227) acc_x 81.2500 (85.3125) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [15/34] time 0.184 (0.175) data 0.107 (0.097) loss_x loss_x 0.3518 (0.5459) acc_x 93.7500 (83.9583) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [20/34] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.5552 (0.5356) acc_x 84.3750 (85.0000) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/34] time 0.184 (0.178) data 0.106 (0.101) loss_x loss_x 0.8574 (0.5662) acc_x 84.3750 (84.7500) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [30/34] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.6274 (0.5548) acc_x 84.3750 (85.6250) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/16] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.6157 (0.6392) acc_u 46.8750 (40.6250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/16] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.7969 (0.6819) acc_u 21.8750 (37.1875) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [15/16] time 0.161 (0.180) data 0.083 (0.102) loss_u loss_u 0.6816 (0.6991) acc_u 37.5000 (35.0000) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 338
confident_label rate tensor(0.6993, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1130
clean true:1128
clean false:2
clean_rate:0.9982300884955753
noisy true:150
noisy false:336
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 486
epoch [200/200] batch [5/35] time 0.184 (0.191) data 0.107 (0.114) loss_x loss_x 0.3030 (0.4404) acc_x 96.8750 (88.1250) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [10/35] time 0.199 (0.189) data 0.122 (0.111) loss_x loss_x 0.3643 (0.4442) acc_x 84.3750 (87.8125) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/35] time 0.216 (0.193) data 0.138 (0.115) loss_x loss_x 0.6646 (0.4338) acc_x 84.3750 (88.3333) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [20/35] time 0.185 (0.196) data 0.107 (0.118) loss_x loss_x 0.3496 (0.4301) acc_x 87.5000 (88.1250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/35] time 0.172 (0.197) data 0.094 (0.119) loss_x loss_x 0.5811 (0.4596) acc_x 87.5000 (87.2500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [30/35] time 0.176 (0.195) data 0.098 (0.117) loss_x loss_x 0.7637 (0.4844) acc_x 81.2500 (86.5625) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [35/35] time 0.179 (0.193) data 0.101 (0.116) loss_x loss_x 0.7798 (0.5119) acc_x 81.2500 (86.1607) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/15] time 0.184 (0.192) data 0.106 (0.114) loss_u loss_u 0.6616 (0.7004) acc_u 43.7500 (34.3750) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/15] time 0.192 (0.192) data 0.113 (0.114) loss_u loss_u 0.6479 (0.6957) acc_u 40.6250 (34.6875) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [15/15] time 0.182 (0.191) data 0.104 (0.113) loss_u loss_u 0.6958 (0.7058) acc_u 37.5000 (34.1667) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,903
* accuracy: 76.7%
* error: 23.3%
* macro_f1: 75.4%
Elapsed: 0:59:01
