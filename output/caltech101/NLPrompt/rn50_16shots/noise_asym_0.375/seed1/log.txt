***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '100']
output_dir: output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 845
confident_label rate tensor(0.2987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 478
clean true:469
clean false:9
clean_rate:0.9811715481171548
noisy true:286
noisy false:836
after delete: len(clean_dataset) 478
after delete: len(noisy_dataset) 1122
epoch [1/200] batch [5/14] time 0.188 (0.203) data 0.111 (0.108) loss_x loss_x 2.4141 (2.6922) acc_x 71.8750 (58.7500) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/14] time 0.185 (0.195) data 0.108 (0.109) loss_x loss_x 2.2305 (2.6320) acc_x 75.0000 (59.3750) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/35] time 0.200 (0.193) data 0.122 (0.111) loss_u loss_u 0.9307 (0.9336) acc_u 18.7500 (16.2500) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [10/35] time 0.191 (0.191) data 0.113 (0.109) loss_u loss_u 0.8994 (0.9058) acc_u 9.3750 (19.3750) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [15/35] time 0.165 (0.188) data 0.089 (0.107) loss_u loss_u 0.9136 (0.9077) acc_u 9.3750 (18.5417) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [20/35] time 0.171 (0.186) data 0.094 (0.106) loss_u loss_u 0.9302 (0.9043) acc_u 12.5000 (17.9688) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [25/35] time 0.170 (0.184) data 0.092 (0.103) loss_u loss_u 0.9365 (0.9024) acc_u 15.6250 (18.2500) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [30/35] time 0.188 (0.182) data 0.110 (0.102) loss_u loss_u 0.9058 (0.9033) acc_u 15.6250 (18.1250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [35/35] time 0.193 (0.183) data 0.115 (0.103) loss_u loss_u 0.8970 (0.9017) acc_u 21.8750 (18.2143) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 686
confident_label rate tensor(0.3669, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 587
clean true:575
clean false:12
clean_rate:0.979557069846678
noisy true:339
noisy false:674
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1013
epoch [2/200] batch [5/18] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.6069 (1.1353) acc_x 84.3750 (69.3750) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [10/18] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.5684 (0.8401) acc_x 81.2500 (76.2500) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [15/18] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 1.2881 (0.9233) acc_x 71.8750 (76.0417) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/31] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.7510 (0.8193) acc_u 25.0000 (22.5000) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [10/31] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.7793 (0.8064) acc_u 37.5000 (24.6875) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [15/31] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.7842 (0.7921) acc_u 28.1250 (26.6667) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [20/31] time 0.172 (0.181) data 0.094 (0.104) loss_u loss_u 0.8105 (0.7981) acc_u 21.8750 (25.1562) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [25/31] time 0.159 (0.180) data 0.082 (0.103) loss_u loss_u 0.7954 (0.7978) acc_u 18.7500 (24.8750) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [30/31] time 0.178 (0.179) data 0.100 (0.101) loss_u loss_u 0.8101 (0.8032) acc_u 25.0000 (24.3750) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 487
confident_label rate tensor(0.4319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 691
clean true:689
clean false:2
clean_rate:0.9971056439942113
noisy true:424
noisy false:485
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 909
epoch [3/200] batch [5/21] time 0.175 (0.181) data 0.098 (0.104) loss_x loss_x 1.2109 (0.9153) acc_x 62.5000 (73.7500) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/21] time 0.168 (0.175) data 0.092 (0.098) loss_x loss_x 1.3018 (0.8708) acc_x 68.7500 (77.5000) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/21] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.9702 (0.8142) acc_x 78.1250 (79.1667) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [20/21] time 0.181 (0.174) data 0.103 (0.097) loss_x loss_x 0.6714 (0.8324) acc_x 84.3750 (78.9062) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/28] time 0.180 (0.176) data 0.103 (0.099) loss_u loss_u 0.9014 (0.8890) acc_u 12.5000 (13.1250) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/28] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.8813 (0.8575) acc_u 12.5000 (16.2500) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/28] time 0.176 (0.177) data 0.099 (0.100) loss_u loss_u 0.8853 (0.8614) acc_u 12.5000 (16.2500) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/28] time 0.180 (0.178) data 0.102 (0.101) loss_u loss_u 0.8794 (0.8655) acc_u 12.5000 (15.3125) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [25/28] time 0.177 (0.178) data 0.099 (0.101) loss_u loss_u 0.7324 (0.8559) acc_u 31.2500 (16.3750) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 441
confident_label rate tensor(0.4600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 736
clean true:733
clean false:3
clean_rate:0.9959239130434783
noisy true:426
noisy false:438
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 864
epoch [4/200] batch [5/23] time 0.190 (0.183) data 0.114 (0.106) loss_x loss_x 0.7422 (0.8341) acc_x 81.2500 (75.6250) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [10/23] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.5640 (0.7257) acc_x 84.3750 (79.3750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/23] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.6143 (0.7118) acc_x 84.3750 (80.0000) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [20/23] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4150 (0.7068) acc_x 78.1250 (79.8438) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/27] time 0.178 (0.182) data 0.101 (0.105) loss_u loss_u 0.8169 (0.8708) acc_u 18.7500 (15.6250) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/27] time 0.178 (0.182) data 0.101 (0.105) loss_u loss_u 0.8491 (0.8659) acc_u 18.7500 (16.2500) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/27] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9058 (0.8725) acc_u 9.3750 (14.7917) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/27] time 0.181 (0.181) data 0.104 (0.105) loss_u loss_u 0.8110 (0.8648) acc_u 21.8750 (15.6250) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [25/27] time 0.179 (0.182) data 0.103 (0.105) loss_u loss_u 0.9189 (0.8690) acc_u 9.3750 (14.7500) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.4512, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 722
clean true:715
clean false:7
clean_rate:0.9903047091412742
noisy true:412
noisy false:466
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 878
epoch [5/200] batch [5/22] time 0.163 (0.173) data 0.086 (0.096) loss_x loss_x 0.4009 (0.8018) acc_x 93.7500 (81.8750) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/22] time 0.184 (0.174) data 0.107 (0.097) loss_x loss_x 0.8555 (0.7254) acc_x 75.0000 (83.1250) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [15/22] time 0.181 (0.176) data 0.104 (0.099) loss_x loss_x 0.6006 (0.6958) acc_x 81.2500 (82.9167) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/22] time 0.180 (0.178) data 0.103 (0.101) loss_x loss_x 0.7690 (0.7205) acc_x 81.2500 (82.3438) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/27] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.9028 (0.8572) acc_u 9.3750 (15.0000) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [10/27] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.8613 (0.8550) acc_u 15.6250 (16.5625) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/27] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.8628 (0.8638) acc_u 15.6250 (16.0417) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/27] time 0.183 (0.180) data 0.105 (0.102) loss_u loss_u 0.8638 (0.8597) acc_u 15.6250 (16.4062) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [25/27] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8657 (0.8542) acc_u 12.5000 (16.5000) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.4550, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 728
clean true:721
clean false:7
clean_rate:0.9903846153846154
noisy true:433
noisy false:439
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 872
epoch [6/200] batch [5/22] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.6875 (0.6477) acc_x 84.3750 (85.6250) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/22] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 1.0752 (0.7611) acc_x 75.0000 (82.5000) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/22] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 1.1162 (0.8067) acc_x 65.6250 (79.7917) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [20/22] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.3311 (0.7639) acc_x 90.6250 (81.2500) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/27] time 0.172 (0.181) data 0.095 (0.104) loss_u loss_u 0.8477 (0.8724) acc_u 18.7500 (16.8750) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/27] time 0.187 (0.181) data 0.111 (0.104) loss_u loss_u 0.9067 (0.8525) acc_u 12.5000 (17.8125) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/27] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.8096 (0.8437) acc_u 18.7500 (18.1250) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/27] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.8193 (0.8528) acc_u 21.8750 (17.0312) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [25/27] time 0.179 (0.181) data 0.102 (0.104) loss_u loss_u 0.8428 (0.8556) acc_u 15.6250 (16.3750) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.4631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 741
clean true:734
clean false:7
clean_rate:0.99055330634278
noisy true:420
noisy false:439
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 859
epoch [7/200] batch [5/23] time 0.180 (0.194) data 0.103 (0.117) loss_x loss_x 0.4392 (0.7571) acc_x 87.5000 (80.6250) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/23] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 0.6934 (0.6729) acc_x 84.3750 (82.8125) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/23] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.4963 (0.6643) acc_x 81.2500 (81.8750) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/23] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.4231 (0.6758) acc_x 84.3750 (81.0938) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/26] time 0.178 (0.184) data 0.101 (0.107) loss_u loss_u 0.8135 (0.8786) acc_u 25.0000 (15.6250) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/26] time 0.180 (0.184) data 0.104 (0.107) loss_u loss_u 0.8833 (0.8604) acc_u 9.3750 (16.2500) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/26] time 0.179 (0.183) data 0.102 (0.106) loss_u loss_u 0.8569 (0.8546) acc_u 12.5000 (17.0833) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [20/26] time 0.158 (0.180) data 0.079 (0.104) loss_u loss_u 0.7935 (0.8460) acc_u 25.0000 (17.8125) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [25/26] time 0.167 (0.179) data 0.090 (0.102) loss_u loss_u 0.7935 (0.8510) acc_u 21.8750 (17.2500) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.4525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 724
clean true:719
clean false:5
clean_rate:0.9930939226519337
noisy true:417
noisy false:459
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 876
epoch [8/200] batch [5/22] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.7188 (0.9100) acc_x 87.5000 (77.5000) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/22] time 0.169 (0.179) data 0.092 (0.103) loss_x loss_x 0.9746 (0.8444) acc_x 71.8750 (79.6875) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/22] time 0.181 (0.180) data 0.104 (0.104) loss_x loss_x 0.4473 (0.7872) acc_x 84.3750 (80.8333) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [20/22] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.8257 (0.7271) acc_x 78.1250 (81.7188) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/27] time 0.178 (0.179) data 0.101 (0.102) loss_u loss_u 0.8491 (0.8681) acc_u 15.6250 (16.2500) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/27] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8301 (0.8528) acc_u 18.7500 (16.8750) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/27] time 0.185 (0.179) data 0.107 (0.103) loss_u loss_u 0.8623 (0.8438) acc_u 12.5000 (17.2917) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/27] time 0.176 (0.180) data 0.098 (0.103) loss_u loss_u 0.8486 (0.8448) acc_u 18.7500 (17.8125) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [25/27] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.7783 (0.8462) acc_u 25.0000 (17.5000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 714
clean true:711
clean false:3
clean_rate:0.9957983193277311
noisy true:421
noisy false:465
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 886
epoch [9/200] batch [5/22] time 0.193 (0.193) data 0.116 (0.116) loss_x loss_x 0.3630 (0.5540) acc_x 90.6250 (83.1250) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/22] time 0.184 (0.189) data 0.107 (0.112) loss_x loss_x 0.4373 (0.6395) acc_x 87.5000 (82.5000) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/22] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.8486 (0.6430) acc_x 75.0000 (82.5000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/22] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 1.1924 (0.6861) acc_x 68.7500 (81.7188) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/27] time 0.182 (0.186) data 0.105 (0.109) loss_u loss_u 0.8169 (0.8493) acc_u 21.8750 (17.5000) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/27] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.8345 (0.8513) acc_u 15.6250 (17.1875) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/27] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.9077 (0.8504) acc_u 12.5000 (17.5000) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/27] time 0.187 (0.184) data 0.110 (0.107) loss_u loss_u 0.8784 (0.8497) acc_u 12.5000 (17.3438) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [25/27] time 0.181 (0.184) data 0.103 (0.107) loss_u loss_u 0.8345 (0.8528) acc_u 21.8750 (17.1250) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.4756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 761
clean true:756
clean false:5
clean_rate:0.9934296977660972
noisy true:416
noisy false:423
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 839
epoch [10/200] batch [5/23] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.4744 (0.4506) acc_x 90.6250 (90.0000) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/23] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 0.7427 (0.6319) acc_x 78.1250 (82.8125) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/23] time 0.164 (0.175) data 0.087 (0.098) loss_x loss_x 1.1992 (0.7134) acc_x 68.7500 (80.4167) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/23] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.7417 (0.7418) acc_x 84.3750 (80.1562) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/26] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.8975 (0.8694) acc_u 12.5000 (16.8750) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/26] time 0.162 (0.178) data 0.084 (0.102) loss_u loss_u 0.8037 (0.8456) acc_u 18.7500 (17.5000) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/26] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.9097 (0.8628) acc_u 9.3750 (15.4167) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/26] time 0.189 (0.180) data 0.111 (0.102) loss_u loss_u 0.8042 (0.8665) acc_u 18.7500 (15.1562) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [25/26] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.8589 (0.8662) acc_u 15.6250 (15.1250) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.4637, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 742
clean true:737
clean false:5
clean_rate:0.9932614555256065
noisy true:419
noisy false:439
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 858
epoch [11/200] batch [5/23] time 0.180 (0.171) data 0.102 (0.094) loss_x loss_x 0.8481 (0.8827) acc_x 75.0000 (76.2500) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/23] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.7432 (0.8705) acc_x 78.1250 (76.5625) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/23] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.5771 (0.8183) acc_x 84.3750 (78.5417) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/23] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.4265 (0.7620) acc_x 90.6250 (80.3125) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/26] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.8789 (0.8468) acc_u 12.5000 (18.7500) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/26] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.8354 (0.8689) acc_u 25.0000 (15.6250) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/26] time 0.180 (0.179) data 0.102 (0.101) loss_u loss_u 0.8081 (0.8684) acc_u 25.0000 (15.4167) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/26] time 0.177 (0.179) data 0.100 (0.101) loss_u loss_u 0.8101 (0.8709) acc_u 21.8750 (15.4688) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [25/26] time 0.181 (0.179) data 0.103 (0.102) loss_u loss_u 0.7598 (0.8598) acc_u 25.0000 (16.3750) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 419
confident_label rate tensor(0.4744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 759
clean true:755
clean false:4
clean_rate:0.994729907773386
noisy true:426
noisy false:415
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 841
epoch [12/200] batch [5/23] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.7441 (0.5482) acc_x 65.6250 (81.8750) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/23] time 0.174 (0.180) data 0.096 (0.103) loss_x loss_x 0.7681 (0.5634) acc_x 75.0000 (84.0625) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/23] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.7695 (0.5727) acc_x 84.3750 (83.3333) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/23] time 0.158 (0.180) data 0.081 (0.103) loss_x loss_x 1.2197 (0.6420) acc_x 68.7500 (81.8750) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/26] time 0.159 (0.175) data 0.082 (0.098) loss_u loss_u 0.8711 (0.8527) acc_u 15.6250 (16.2500) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/26] time 0.175 (0.175) data 0.097 (0.097) loss_u loss_u 0.8491 (0.8549) acc_u 18.7500 (15.9375) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/26] time 0.171 (0.173) data 0.094 (0.096) loss_u loss_u 0.8232 (0.8529) acc_u 21.8750 (16.4583) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/26] time 0.162 (0.172) data 0.086 (0.095) loss_u loss_u 0.8633 (0.8604) acc_u 15.6250 (15.4688) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [25/26] time 0.160 (0.171) data 0.083 (0.094) loss_u loss_u 0.7671 (0.8500) acc_u 25.0000 (16.8750) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.4650, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 744
clean true:742
clean false:2
clean_rate:0.9973118279569892
noisy true:425
noisy false:431
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 856
epoch [13/200] batch [5/23] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.6333 (0.8397) acc_x 87.5000 (79.3750) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/23] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.6152 (0.6787) acc_x 78.1250 (81.5625) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/23] time 0.214 (0.184) data 0.137 (0.107) loss_x loss_x 0.6357 (0.6884) acc_x 84.3750 (81.0417) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/23] time 0.176 (0.183) data 0.098 (0.106) loss_x loss_x 0.5522 (0.6659) acc_x 84.3750 (82.3438) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/26] time 0.168 (0.180) data 0.091 (0.103) loss_u loss_u 0.8257 (0.8524) acc_u 21.8750 (18.7500) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/26] time 0.160 (0.177) data 0.082 (0.100) loss_u loss_u 0.9614 (0.8638) acc_u 3.1250 (16.8750) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/26] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9502 (0.8643) acc_u 6.2500 (16.2500) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/26] time 0.184 (0.178) data 0.107 (0.100) loss_u loss_u 0.8403 (0.8594) acc_u 15.6250 (16.2500) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [25/26] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.8354 (0.8644) acc_u 21.8750 (15.8750) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.4756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 761
clean true:757
clean false:4
clean_rate:0.9947437582128777
noisy true:423
noisy false:416
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 839
epoch [14/200] batch [5/23] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.3418 (0.7679) acc_x 90.6250 (80.6250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/23] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.4932 (0.6357) acc_x 87.5000 (83.7500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/23] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.3872 (0.6180) acc_x 90.6250 (84.1667) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/23] time 0.158 (0.178) data 0.081 (0.101) loss_x loss_x 0.4497 (0.6115) acc_x 84.3750 (83.2812) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/26] time 0.164 (0.176) data 0.087 (0.099) loss_u loss_u 0.8491 (0.8339) acc_u 18.7500 (20.6250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/26] time 0.181 (0.176) data 0.103 (0.099) loss_u loss_u 0.8340 (0.8464) acc_u 15.6250 (17.5000) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/26] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9199 (0.8573) acc_u 9.3750 (16.2500) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/26] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.9648 (0.8652) acc_u 3.1250 (14.8438) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [25/26] time 0.199 (0.179) data 0.120 (0.102) loss_u loss_u 0.8652 (0.8687) acc_u 15.6250 (14.5000) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.4819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 771
clean true:766
clean false:5
clean_rate:0.993514915693904
noisy true:416
noisy false:413
after delete: len(clean_dataset) 771
after delete: len(noisy_dataset) 829
epoch [15/200] batch [5/24] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.8271 (0.7468) acc_x 78.1250 (81.8750) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/24] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.6904 (0.6579) acc_x 81.2500 (84.0625) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/24] time 0.191 (0.186) data 0.114 (0.109) loss_x loss_x 0.6167 (0.6334) acc_x 81.2500 (83.5417) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/24] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.7075 (0.6574) acc_x 78.1250 (83.1250) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/25] time 0.187 (0.186) data 0.109 (0.109) loss_u loss_u 0.9229 (0.8868) acc_u 9.3750 (11.2500) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/25] time 0.175 (0.184) data 0.097 (0.107) loss_u loss_u 0.8340 (0.8692) acc_u 15.6250 (13.1250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/25] time 0.177 (0.183) data 0.098 (0.106) loss_u loss_u 0.7886 (0.8646) acc_u 21.8750 (14.1667) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/25] time 0.181 (0.183) data 0.105 (0.105) loss_u loss_u 0.8574 (0.8599) acc_u 15.6250 (15.1562) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [25/25] time 0.172 (0.182) data 0.094 (0.105) loss_u loss_u 0.8149 (0.8626) acc_u 21.8750 (15.1250) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 437
confident_label rate tensor(0.4806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 769
clean true:764
clean false:5
clean_rate:0.9934980494148244
noisy true:399
noisy false:432
after delete: len(clean_dataset) 769
after delete: len(noisy_dataset) 831
epoch [16/200] batch [5/24] time 0.172 (0.176) data 0.095 (0.099) loss_x loss_x 0.6743 (0.7212) acc_x 75.0000 (81.2500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/24] time 0.163 (0.172) data 0.086 (0.095) loss_x loss_x 1.0410 (0.7114) acc_x 75.0000 (82.1875) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/24] time 0.190 (0.175) data 0.112 (0.098) loss_x loss_x 0.7681 (0.6678) acc_x 87.5000 (83.1250) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/24] time 0.188 (0.177) data 0.111 (0.100) loss_x loss_x 0.4978 (0.6682) acc_x 78.1250 (81.8750) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/25] time 0.176 (0.179) data 0.098 (0.102) loss_u loss_u 0.7969 (0.8455) acc_u 21.8750 (18.7500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/25] time 0.167 (0.177) data 0.089 (0.100) loss_u loss_u 0.8804 (0.8431) acc_u 15.6250 (18.7500) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/25] time 0.186 (0.177) data 0.108 (0.100) loss_u loss_u 0.7905 (0.8540) acc_u 21.8750 (16.8750) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/25] time 0.169 (0.176) data 0.093 (0.099) loss_u loss_u 0.9268 (0.8523) acc_u 9.3750 (16.7188) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [25/25] time 0.175 (0.175) data 0.097 (0.098) loss_u loss_u 0.9541 (0.8598) acc_u 6.2500 (15.7500) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.4775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 764
clean true:760
clean false:4
clean_rate:0.9947643979057592
noisy true:415
noisy false:421
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 836
epoch [17/200] batch [5/23] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.5635 (0.5489) acc_x 87.5000 (87.5000) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/23] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.5918 (0.5781) acc_x 87.5000 (86.8750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/23] time 0.180 (0.180) data 0.104 (0.103) loss_x loss_x 0.6631 (0.6595) acc_x 84.3750 (83.1250) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/23] time 0.180 (0.180) data 0.102 (0.103) loss_x loss_x 0.5742 (0.6584) acc_x 81.2500 (82.5000) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/26] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8276 (0.8750) acc_u 21.8750 (13.7500) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/26] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.9507 (0.8750) acc_u 6.2500 (13.7500) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/26] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8672 (0.8597) acc_u 18.7500 (16.2500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/26] time 0.169 (0.181) data 0.091 (0.104) loss_u loss_u 0.8252 (0.8565) acc_u 18.7500 (16.2500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [25/26] time 0.187 (0.180) data 0.110 (0.103) loss_u loss_u 0.8965 (0.8667) acc_u 15.6250 (15.2500) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.4950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 792
clean true:789
clean false:3
clean_rate:0.9962121212121212
noisy true:443
noisy false:365
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 808
epoch [18/200] batch [5/24] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.8223 (0.5917) acc_x 75.0000 (85.0000) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/24] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.6460 (0.5881) acc_x 78.1250 (85.3125) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/24] time 0.198 (0.174) data 0.121 (0.097) loss_x loss_x 0.4956 (0.6525) acc_x 84.3750 (83.3333) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/24] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 1.1553 (0.7074) acc_x 71.8750 (81.8750) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/25] time 0.184 (0.178) data 0.108 (0.101) loss_u loss_u 0.8589 (0.8926) acc_u 15.6250 (13.7500) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/25] time 0.159 (0.176) data 0.081 (0.099) loss_u loss_u 0.8638 (0.8757) acc_u 12.5000 (15.3125) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/25] time 0.189 (0.177) data 0.111 (0.099) loss_u loss_u 0.8984 (0.8706) acc_u 9.3750 (15.4167) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/25] time 0.209 (0.178) data 0.132 (0.101) loss_u loss_u 0.8369 (0.8691) acc_u 18.7500 (15.0000) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [25/25] time 0.181 (0.179) data 0.104 (0.101) loss_u loss_u 0.8604 (0.8749) acc_u 18.7500 (14.2500) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.4900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 784
clean true:777
clean false:7
clean_rate:0.9910714285714286
noisy true:428
noisy false:388
after delete: len(clean_dataset) 784
after delete: len(noisy_dataset) 816
epoch [19/200] batch [5/24] time 0.182 (0.192) data 0.105 (0.115) loss_x loss_x 0.4001 (0.8066) acc_x 87.5000 (78.1250) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/24] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.7026 (0.7092) acc_x 81.2500 (80.9375) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/24] time 0.189 (0.187) data 0.113 (0.110) loss_x loss_x 0.7275 (0.6790) acc_x 68.7500 (80.6250) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/24] time 0.180 (0.186) data 0.102 (0.109) loss_x loss_x 0.7500 (0.6458) acc_x 75.0000 (81.2500) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/25] time 0.177 (0.184) data 0.099 (0.107) loss_u loss_u 0.8198 (0.8474) acc_u 18.7500 (20.0000) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/25] time 0.171 (0.183) data 0.094 (0.106) loss_u loss_u 0.9116 (0.8628) acc_u 9.3750 (16.5625) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/25] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9312 (0.8684) acc_u 9.3750 (15.8333) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/25] time 0.188 (0.183) data 0.110 (0.106) loss_u loss_u 0.8667 (0.8525) acc_u 15.6250 (17.3438) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [25/25] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9121 (0.8618) acc_u 15.6250 (16.2500) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 772
clean true:763
clean false:9
clean_rate:0.9883419689119171
noisy true:437
noisy false:391
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 828
epoch [20/200] batch [5/24] time 0.178 (0.181) data 0.101 (0.105) loss_x loss_x 0.8652 (0.7951) acc_x 78.1250 (79.3750) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/24] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.3914 (0.6744) acc_x 87.5000 (82.5000) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/24] time 0.170 (0.181) data 0.094 (0.104) loss_x loss_x 0.3450 (0.7288) acc_x 93.7500 (81.8750) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/24] time 0.190 (0.182) data 0.114 (0.105) loss_x loss_x 0.2402 (0.6657) acc_x 90.6250 (82.8125) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/25] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.9102 (0.8773) acc_u 9.3750 (15.0000) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/25] time 0.179 (0.182) data 0.102 (0.105) loss_u loss_u 0.8989 (0.8844) acc_u 9.3750 (12.8125) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/25] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8730 (0.8684) acc_u 12.5000 (14.3750) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/25] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8496 (0.8634) acc_u 18.7500 (14.8438) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [25/25] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.8828 (0.8653) acc_u 15.6250 (15.1250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 792
clean true:786
clean false:6
clean_rate:0.9924242424242424
noisy true:433
noisy false:375
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 808
epoch [21/200] batch [5/24] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.8755 (0.5513) acc_x 75.0000 (87.5000) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/24] time 0.187 (0.183) data 0.111 (0.107) loss_x loss_x 0.7456 (0.6236) acc_x 81.2500 (83.7500) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/24] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.8135 (0.6148) acc_x 71.8750 (83.7500) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/24] time 0.189 (0.180) data 0.112 (0.104) loss_x loss_x 0.3484 (0.5844) acc_x 93.7500 (84.0625) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/25] time 0.159 (0.179) data 0.081 (0.102) loss_u loss_u 0.8154 (0.8643) acc_u 18.7500 (17.5000) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/25] time 0.175 (0.178) data 0.097 (0.101) loss_u loss_u 0.9170 (0.8748) acc_u 6.2500 (14.3750) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/25] time 0.167 (0.177) data 0.088 (0.100) loss_u loss_u 0.8799 (0.8779) acc_u 9.3750 (13.7500) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/25] time 0.182 (0.178) data 0.105 (0.100) loss_u loss_u 0.8521 (0.8809) acc_u 18.7500 (13.4375) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [25/25] time 0.178 (0.178) data 0.101 (0.101) loss_u loss_u 0.9844 (0.8815) acc_u 3.1250 (13.2500) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.4869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 779
clean true:774
clean false:5
clean_rate:0.993581514762516
noisy true:428
noisy false:393
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 821
epoch [22/200] batch [5/24] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.9121 (0.8137) acc_x 78.1250 (78.7500) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/24] time 0.200 (0.187) data 0.124 (0.110) loss_x loss_x 0.5840 (0.7071) acc_x 84.3750 (81.2500) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/24] time 0.184 (0.185) data 0.107 (0.109) loss_x loss_x 0.2240 (0.6814) acc_x 93.7500 (81.6667) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/24] time 0.182 (0.184) data 0.105 (0.108) loss_x loss_x 0.8721 (0.7064) acc_x 75.0000 (81.2500) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/25] time 0.161 (0.180) data 0.084 (0.103) loss_u loss_u 0.7754 (0.8271) acc_u 25.0000 (18.7500) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/25] time 0.188 (0.178) data 0.111 (0.101) loss_u loss_u 0.8696 (0.8392) acc_u 12.5000 (17.8125) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/25] time 0.220 (0.181) data 0.143 (0.104) loss_u loss_u 0.9185 (0.8475) acc_u 9.3750 (16.6667) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/25] time 0.177 (0.181) data 0.101 (0.104) loss_u loss_u 0.8936 (0.8524) acc_u 12.5000 (16.2500) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [25/25] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.8701 (0.8525) acc_u 15.6250 (16.5000) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 784
clean true:781
clean false:3
clean_rate:0.9961734693877551
noisy true:418
noisy false:398
after delete: len(clean_dataset) 784
after delete: len(noisy_dataset) 816
epoch [23/200] batch [5/24] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.9224 (0.7671) acc_x 71.8750 (78.7500) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/24] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 0.5444 (0.6825) acc_x 81.2500 (81.8750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/24] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.6831 (0.6681) acc_x 75.0000 (81.4583) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/24] time 0.179 (0.184) data 0.103 (0.107) loss_x loss_x 0.5923 (0.6434) acc_x 81.2500 (82.3438) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/25] time 0.181 (0.183) data 0.105 (0.107) loss_u loss_u 0.8994 (0.8504) acc_u 9.3750 (15.0000) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/25] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9360 (0.8565) acc_u 9.3750 (16.5625) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/25] time 0.179 (0.182) data 0.102 (0.105) loss_u loss_u 0.8267 (0.8625) acc_u 21.8750 (15.8333) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/25] time 0.177 (0.182) data 0.099 (0.105) loss_u loss_u 0.9712 (0.8639) acc_u 3.1250 (15.7812) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [25/25] time 0.180 (0.181) data 0.103 (0.105) loss_u loss_u 0.9507 (0.8630) acc_u 6.2500 (16.3750) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.4762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 762
clean true:757
clean false:5
clean_rate:0.9934383202099738
noisy true:434
noisy false:404
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 838
epoch [24/200] batch [5/23] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5796 (0.7978) acc_x 87.5000 (79.3750) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/23] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.4534 (0.7315) acc_x 93.7500 (81.2500) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/23] time 0.187 (0.184) data 0.110 (0.108) loss_x loss_x 0.5054 (0.7024) acc_x 90.6250 (82.7083) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [20/23] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.6973 (0.7095) acc_x 78.1250 (81.0938) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/26] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.9048 (0.8635) acc_u 12.5000 (16.8750) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/26] time 0.180 (0.183) data 0.104 (0.106) loss_u loss_u 0.8965 (0.8683) acc_u 9.3750 (15.9375) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/26] time 0.177 (0.183) data 0.100 (0.106) loss_u loss_u 0.8267 (0.8660) acc_u 21.8750 (16.0417) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/26] time 0.190 (0.183) data 0.113 (0.106) loss_u loss_u 0.7671 (0.8536) acc_u 28.1250 (17.3438) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [25/26] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9316 (0.8584) acc_u 3.1250 (16.3750) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 793
clean true:788
clean false:5
clean_rate:0.9936948297604036
noisy true:435
noisy false:372
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 807
epoch [25/200] batch [5/24] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 0.3308 (0.5068) acc_x 93.7500 (87.5000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/24] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.7944 (0.5847) acc_x 81.2500 (85.9375) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/24] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.7490 (0.6269) acc_x 78.1250 (83.9583) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/24] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.4475 (0.6107) acc_x 90.6250 (83.7500) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/25] time 0.179 (0.179) data 0.101 (0.102) loss_u loss_u 0.8887 (0.8540) acc_u 12.5000 (16.2500) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/25] time 0.174 (0.180) data 0.097 (0.103) loss_u loss_u 0.9307 (0.8694) acc_u 6.2500 (14.6875) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/25] time 0.168 (0.180) data 0.090 (0.103) loss_u loss_u 0.9067 (0.8678) acc_u 9.3750 (14.5833) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/25] time 0.190 (0.180) data 0.112 (0.103) loss_u loss_u 0.9126 (0.8670) acc_u 9.3750 (15.3125) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [25/25] time 0.182 (0.181) data 0.104 (0.103) loss_u loss_u 0.8120 (0.8668) acc_u 21.8750 (14.8750) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 785
clean true:777
clean false:8
clean_rate:0.9898089171974522
noisy true:423
noisy false:392
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 815
epoch [26/200] batch [5/24] time 0.159 (0.183) data 0.082 (0.106) loss_x loss_x 0.2930 (0.5665) acc_x 87.5000 (83.7500) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [10/24] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.9868 (0.5647) acc_x 71.8750 (84.6875) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/24] time 0.178 (0.182) data 0.102 (0.105) loss_x loss_x 0.4824 (0.5428) acc_x 84.3750 (84.1667) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/24] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 0.5972 (0.5886) acc_x 78.1250 (83.1250) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/25] time 0.190 (0.181) data 0.113 (0.104) loss_u loss_u 0.9170 (0.8581) acc_u 6.2500 (16.8750) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [10/25] time 0.159 (0.179) data 0.082 (0.102) loss_u loss_u 0.9004 (0.8724) acc_u 15.6250 (15.6250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/25] time 0.174 (0.178) data 0.096 (0.101) loss_u loss_u 0.8877 (0.8685) acc_u 6.2500 (15.2083) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/25] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.9331 (0.8696) acc_u 9.3750 (15.4688) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [25/25] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.8267 (0.8685) acc_u 18.7500 (15.5000) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.4856, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 777
clean true:770
clean false:7
clean_rate:0.990990990990991
noisy true:435
noisy false:388
after delete: len(clean_dataset) 777
after delete: len(noisy_dataset) 823
epoch [27/200] batch [5/24] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.3833 (0.5765) acc_x 87.5000 (85.0000) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/24] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.9976 (0.6339) acc_x 78.1250 (83.1250) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/24] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.3120 (0.5985) acc_x 90.6250 (83.3333) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/24] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.5557 (0.6070) acc_x 75.0000 (82.3438) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/25] time 0.162 (0.178) data 0.085 (0.101) loss_u loss_u 0.9272 (0.8218) acc_u 9.3750 (18.7500) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/25] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.8037 (0.8212) acc_u 25.0000 (19.6875) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/25] time 0.180 (0.177) data 0.104 (0.100) loss_u loss_u 0.8833 (0.8342) acc_u 12.5000 (18.5417) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/25] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.9102 (0.8443) acc_u 9.3750 (17.6562) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [25/25] time 0.178 (0.177) data 0.100 (0.100) loss_u loss_u 0.9189 (0.8557) acc_u 6.2500 (16.5000) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.4894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 783
clean true:776
clean false:7
clean_rate:0.9910600255427842
noisy true:432
noisy false:385
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 817
epoch [28/200] batch [5/24] time 0.183 (0.194) data 0.107 (0.117) loss_x loss_x 0.3511 (0.6748) acc_x 87.5000 (82.5000) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [10/24] time 0.183 (0.188) data 0.107 (0.112) loss_x loss_x 0.5420 (0.6190) acc_x 87.5000 (85.6250) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/24] time 0.180 (0.185) data 0.104 (0.109) loss_x loss_x 0.4299 (0.6265) acc_x 90.6250 (85.2083) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/24] time 0.199 (0.185) data 0.117 (0.108) loss_x loss_x 0.8647 (0.6436) acc_x 81.2500 (83.9062) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/25] time 0.166 (0.183) data 0.089 (0.106) loss_u loss_u 0.8140 (0.8469) acc_u 18.7500 (17.5000) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [10/25] time 0.174 (0.183) data 0.098 (0.106) loss_u loss_u 0.8579 (0.8490) acc_u 15.6250 (17.1875) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/25] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8784 (0.8558) acc_u 9.3750 (16.0417) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/25] time 0.178 (0.182) data 0.101 (0.105) loss_u loss_u 0.8315 (0.8557) acc_u 18.7500 (16.0938) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [25/25] time 0.179 (0.182) data 0.103 (0.105) loss_u loss_u 0.9199 (0.8615) acc_u 6.2500 (15.5000) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 787
clean true:782
clean false:5
clean_rate:0.9936467598475223
noisy true:436
noisy false:377
after delete: len(clean_dataset) 787
after delete: len(noisy_dataset) 813
epoch [29/200] batch [5/24] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.8594 (0.7014) acc_x 75.0000 (81.2500) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/24] time 0.186 (0.182) data 0.108 (0.105) loss_x loss_x 0.3730 (0.6334) acc_x 84.3750 (82.1875) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/24] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.5459 (0.5919) acc_x 84.3750 (83.1250) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/24] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.6309 (0.5721) acc_x 87.5000 (83.9062) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/25] time 0.181 (0.181) data 0.105 (0.104) loss_u loss_u 0.8882 (0.8445) acc_u 9.3750 (18.1250) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/25] time 0.181 (0.181) data 0.104 (0.105) loss_u loss_u 0.8032 (0.8628) acc_u 18.7500 (14.6875) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/25] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.8511 (0.8604) acc_u 12.5000 (15.0000) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/25] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.8813 (0.8656) acc_u 12.5000 (14.8438) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [25/25] time 0.179 (0.181) data 0.101 (0.104) loss_u loss_u 0.8555 (0.8552) acc_u 18.7500 (16.0000) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.4894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 783
clean true:776
clean false:7
clean_rate:0.9910600255427842
noisy true:432
noisy false:385
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 817
epoch [30/200] batch [5/24] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.8091 (0.7798) acc_x 78.1250 (80.0000) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/24] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.4768 (0.6829) acc_x 84.3750 (82.8125) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/24] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.6035 (0.6128) acc_x 84.3750 (84.1667) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/24] time 0.156 (0.181) data 0.079 (0.105) loss_x loss_x 0.4290 (0.6020) acc_x 90.6250 (84.0625) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/25] time 0.183 (0.180) data 0.105 (0.103) loss_u loss_u 0.8770 (0.8474) acc_u 15.6250 (15.6250) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/25] time 0.190 (0.180) data 0.112 (0.104) loss_u loss_u 0.8320 (0.8370) acc_u 18.7500 (18.1250) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/25] time 0.180 (0.181) data 0.102 (0.104) loss_u loss_u 0.7412 (0.8386) acc_u 28.1250 (17.7083) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/25] time 0.180 (0.181) data 0.102 (0.104) loss_u loss_u 0.8418 (0.8409) acc_u 18.7500 (17.5000) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [25/25] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8022 (0.8442) acc_u 18.7500 (17.1250) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 792
clean true:785
clean false:7
clean_rate:0.9911616161616161
noisy true:428
noisy false:380
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 808
epoch [31/200] batch [5/24] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.5366 (0.5634) acc_x 81.2500 (83.1250) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/24] time 0.181 (0.181) data 0.103 (0.105) loss_x loss_x 0.3550 (0.5572) acc_x 90.6250 (84.3750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/24] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 0.5552 (0.5565) acc_x 84.3750 (84.3750) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/24] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.7544 (0.5862) acc_x 78.1250 (82.6562) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/25] time 0.175 (0.180) data 0.097 (0.103) loss_u loss_u 0.9316 (0.8733) acc_u 6.2500 (15.0000) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/25] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9492 (0.8667) acc_u 3.1250 (15.0000) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/25] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.8677 (0.8633) acc_u 12.5000 (15.2083) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/25] time 0.162 (0.181) data 0.085 (0.104) loss_u loss_u 0.8677 (0.8525) acc_u 15.6250 (16.4062) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [25/25] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.9282 (0.8564) acc_u 9.3750 (16.5000) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.4906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 785
clean true:778
clean false:7
clean_rate:0.9910828025477707
noisy true:424
noisy false:391
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 815
epoch [32/200] batch [5/24] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.2976 (0.4909) acc_x 93.7500 (88.1250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/24] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.3298 (0.5390) acc_x 90.6250 (86.5625) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/24] time 0.166 (0.181) data 0.090 (0.105) loss_x loss_x 0.7217 (0.4962) acc_x 81.2500 (87.7083) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/24] time 0.180 (0.179) data 0.102 (0.102) loss_x loss_x 0.4653 (0.5283) acc_x 84.3750 (85.9375) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/25] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8403 (0.8540) acc_u 18.7500 (16.2500) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/25] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.8188 (0.8500) acc_u 15.6250 (16.2500) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/25] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.9370 (0.8578) acc_u 6.2500 (15.2083) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/25] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.8989 (0.8625) acc_u 12.5000 (14.6875) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [25/25] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.9458 (0.8657) acc_u 6.2500 (14.6250) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 795
clean true:787
clean false:8
clean_rate:0.989937106918239
noisy true:428
noisy false:377
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 805
epoch [33/200] batch [5/24] time 0.179 (0.180) data 0.102 (0.104) loss_x loss_x 0.7300 (0.6112) acc_x 78.1250 (84.3750) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/24] time 0.178 (0.180) data 0.102 (0.104) loss_x loss_x 0.8477 (0.7576) acc_x 81.2500 (80.0000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/24] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.8276 (0.7029) acc_x 78.1250 (80.6250) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/24] time 0.159 (0.179) data 0.082 (0.103) loss_x loss_x 0.8652 (0.6982) acc_x 87.5000 (82.3438) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/25] time 0.187 (0.180) data 0.109 (0.104) loss_u loss_u 0.8149 (0.8373) acc_u 15.6250 (16.8750) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/25] time 0.178 (0.181) data 0.102 (0.104) loss_u loss_u 0.8433 (0.8498) acc_u 21.8750 (16.8750) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/25] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.9077 (0.8634) acc_u 12.5000 (15.6250) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/25] time 0.176 (0.181) data 0.099 (0.104) loss_u loss_u 0.8574 (0.8562) acc_u 18.7500 (16.4062) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [25/25] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8770 (0.8638) acc_u 12.5000 (15.2500) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 774
clean true:768
clean false:6
clean_rate:0.9922480620155039
noisy true:444
noisy false:382
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 826
epoch [34/200] batch [5/24] time 0.183 (0.193) data 0.106 (0.117) loss_x loss_x 0.8003 (0.6760) acc_x 75.0000 (80.6250) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/24] time 0.185 (0.187) data 0.109 (0.110) loss_x loss_x 0.8032 (0.6404) acc_x 75.0000 (81.8750) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/24] time 0.185 (0.185) data 0.108 (0.109) loss_x loss_x 0.9868 (0.6356) acc_x 75.0000 (82.9167) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/24] time 0.178 (0.185) data 0.101 (0.108) loss_x loss_x 0.5869 (0.6326) acc_x 87.5000 (83.7500) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/25] time 0.198 (0.184) data 0.120 (0.107) loss_u loss_u 0.7856 (0.8430) acc_u 21.8750 (17.5000) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/25] time 0.187 (0.187) data 0.109 (0.110) loss_u loss_u 0.9263 (0.8584) acc_u 9.3750 (16.2500) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/25] time 0.183 (0.189) data 0.106 (0.111) loss_u loss_u 0.8555 (0.8546) acc_u 15.6250 (16.8750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/25] time 0.186 (0.188) data 0.109 (0.111) loss_u loss_u 0.7866 (0.8473) acc_u 25.0000 (17.3438) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [25/25] time 0.188 (0.188) data 0.110 (0.110) loss_u loss_u 0.9087 (0.8517) acc_u 12.5000 (17.1250) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 780
clean true:772
clean false:8
clean_rate:0.9897435897435898
noisy true:428
noisy false:392
after delete: len(clean_dataset) 780
after delete: len(noisy_dataset) 820
epoch [35/200] batch [5/24] time 0.177 (0.182) data 0.099 (0.105) loss_x loss_x 0.8633 (0.5536) acc_x 81.2500 (82.5000) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/24] time 0.179 (0.178) data 0.102 (0.101) loss_x loss_x 0.7368 (0.6347) acc_x 78.1250 (81.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/24] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 0.6772 (0.6175) acc_x 84.3750 (83.3333) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/24] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 0.6738 (0.6127) acc_x 84.3750 (82.9688) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/25] time 0.192 (0.179) data 0.114 (0.102) loss_u loss_u 0.8237 (0.8180) acc_u 21.8750 (20.6250) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/25] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9136 (0.8438) acc_u 9.3750 (17.8125) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/25] time 0.187 (0.180) data 0.109 (0.103) loss_u loss_u 0.7930 (0.8393) acc_u 21.8750 (17.7083) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/25] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8179 (0.8451) acc_u 21.8750 (16.8750) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [25/25] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.8091 (0.8460) acc_u 21.8750 (16.7500) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 809
clean true:795
clean false:14
clean_rate:0.9826946847960445
noisy true:419
noisy false:372
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 791
epoch [36/200] batch [5/25] time 0.159 (0.173) data 0.082 (0.096) loss_x loss_x 0.5928 (0.5502) acc_x 81.2500 (85.0000) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/25] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.7329 (0.5270) acc_x 84.3750 (87.1875) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/25] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.6499 (0.5159) acc_x 84.3750 (87.2917) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/25] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.3970 (0.5619) acc_x 87.5000 (85.4688) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [25/25] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.3679 (0.5913) acc_x 87.5000 (85.1250) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/24] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.7485 (0.8463) acc_u 28.1250 (16.2500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/24] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8325 (0.8442) acc_u 15.6250 (16.8750) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/24] time 0.181 (0.180) data 0.103 (0.103) loss_u loss_u 0.9067 (0.8529) acc_u 9.3750 (16.2500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/24] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.9263 (0.8609) acc_u 6.2500 (15.6250) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.5131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 821
clean true:811
clean false:10
clean_rate:0.9878197320341048
noisy true:424
noisy false:355
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 779
epoch [37/200] batch [5/25] time 0.168 (0.171) data 0.091 (0.094) loss_x loss_x 0.7773 (0.6448) acc_x 75.0000 (81.2500) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/25] time 0.206 (0.178) data 0.130 (0.101) loss_x loss_x 0.3101 (0.5166) acc_x 93.7500 (85.3125) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/25] time 0.158 (0.176) data 0.082 (0.100) loss_x loss_x 1.0303 (0.5941) acc_x 75.0000 (83.1250) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/25] time 0.176 (0.176) data 0.099 (0.099) loss_x loss_x 0.7749 (0.6385) acc_x 78.1250 (81.8750) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [25/25] time 0.165 (0.175) data 0.088 (0.098) loss_x loss_x 0.5146 (0.6241) acc_x 87.5000 (82.6250) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/24] time 0.179 (0.174) data 0.101 (0.097) loss_u loss_u 0.8511 (0.8313) acc_u 15.6250 (19.3750) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/24] time 0.177 (0.175) data 0.100 (0.098) loss_u loss_u 0.8394 (0.8292) acc_u 15.6250 (19.3750) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/24] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.8706 (0.8419) acc_u 12.5000 (17.5000) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/24] time 0.165 (0.174) data 0.089 (0.097) loss_u loss_u 0.9023 (0.8568) acc_u 9.3750 (16.2500) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:798
clean false:9
clean_rate:0.9888475836431226
noisy true:445
noisy false:348
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [38/200] batch [5/25] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.4302 (0.5109) acc_x 90.6250 (85.6250) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/25] time 0.178 (0.182) data 0.102 (0.105) loss_x loss_x 0.5005 (0.5183) acc_x 87.5000 (86.8750) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/25] time 0.178 (0.185) data 0.101 (0.107) loss_x loss_x 0.3462 (0.5575) acc_x 84.3750 (85.0000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/25] time 0.191 (0.183) data 0.114 (0.106) loss_x loss_x 0.3772 (0.5871) acc_x 90.6250 (84.2188) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [25/25] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.5928 (0.6089) acc_x 87.5000 (83.7500) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/24] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.8545 (0.8665) acc_u 15.6250 (16.2500) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/24] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.7593 (0.8656) acc_u 25.0000 (15.9375) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/24] time 0.179 (0.180) data 0.101 (0.103) loss_u loss_u 0.9150 (0.8836) acc_u 6.2500 (13.1250) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/24] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8740 (0.8801) acc_u 18.7500 (13.5938) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 796
clean true:786
clean false:10
clean_rate:0.9874371859296482
noisy true:438
noisy false:366
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 804
epoch [39/200] batch [5/24] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.6436 (0.5690) acc_x 75.0000 (82.5000) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/24] time 0.160 (0.169) data 0.083 (0.092) loss_x loss_x 0.7266 (0.6195) acc_x 81.2500 (83.1250) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/24] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.5166 (0.6646) acc_x 90.6250 (81.6667) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/24] time 0.180 (0.175) data 0.104 (0.098) loss_x loss_x 0.9697 (0.6582) acc_x 78.1250 (82.0312) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/25] time 0.159 (0.175) data 0.082 (0.098) loss_u loss_u 0.7866 (0.7872) acc_u 25.0000 (23.7500) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/25] time 0.160 (0.174) data 0.083 (0.098) loss_u loss_u 0.9287 (0.8518) acc_u 9.3750 (16.2500) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/25] time 0.182 (0.175) data 0.106 (0.099) loss_u loss_u 0.9326 (0.8629) acc_u 9.3750 (15.4167) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/25] time 0.157 (0.175) data 0.080 (0.098) loss_u loss_u 0.7881 (0.8514) acc_u 21.8750 (16.7188) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [25/25] time 0.179 (0.174) data 0.101 (0.097) loss_u loss_u 0.8535 (0.8498) acc_u 12.5000 (16.6250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 791
clean true:784
clean false:7
clean_rate:0.9911504424778761
noisy true:415
noisy false:394
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 809
epoch [40/200] batch [5/24] time 0.170 (0.172) data 0.094 (0.096) loss_x loss_x 0.4194 (0.5274) acc_x 81.2500 (81.2500) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/24] time 0.179 (0.175) data 0.102 (0.099) loss_x loss_x 0.5195 (0.5231) acc_x 87.5000 (83.1250) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/24] time 0.182 (0.177) data 0.106 (0.101) loss_x loss_x 0.8384 (0.5487) acc_x 84.3750 (84.3750) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/24] time 0.181 (0.178) data 0.105 (0.102) loss_x loss_x 0.1372 (0.5526) acc_x 96.8750 (84.3750) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/25] time 0.178 (0.179) data 0.100 (0.102) loss_u loss_u 0.8872 (0.8287) acc_u 12.5000 (20.0000) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/25] time 0.181 (0.179) data 0.103 (0.102) loss_u loss_u 0.8384 (0.8499) acc_u 21.8750 (18.4375) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/25] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.8315 (0.8550) acc_u 18.7500 (17.7083) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/25] time 0.182 (0.179) data 0.106 (0.102) loss_u loss_u 0.8286 (0.8587) acc_u 15.6250 (16.8750) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [25/25] time 0.184 (0.179) data 0.106 (0.103) loss_u loss_u 0.8608 (0.8633) acc_u 15.6250 (16.1250) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 808
clean true:798
clean false:10
clean_rate:0.9876237623762376
noisy true:441
noisy false:351
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 792
epoch [41/200] batch [5/25] time 0.182 (0.180) data 0.105 (0.104) loss_x loss_x 0.3196 (0.5138) acc_x 90.6250 (86.8750) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/25] time 0.187 (0.180) data 0.110 (0.103) loss_x loss_x 0.4927 (0.4559) acc_x 87.5000 (88.7500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/25] time 0.186 (0.181) data 0.109 (0.105) loss_x loss_x 0.5615 (0.5043) acc_x 78.1250 (86.2500) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/25] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.3767 (0.5519) acc_x 93.7500 (84.8438) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [25/25] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.4097 (0.5557) acc_x 84.3750 (84.0000) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/24] time 0.181 (0.180) data 0.104 (0.104) loss_u loss_u 0.8789 (0.8354) acc_u 12.5000 (18.1250) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/24] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9072 (0.8386) acc_u 9.3750 (17.1875) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/24] time 0.192 (0.181) data 0.115 (0.104) loss_u loss_u 0.8511 (0.8415) acc_u 18.7500 (17.5000) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/24] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9482 (0.8552) acc_u 6.2500 (15.9375) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 798
clean true:793
clean false:5
clean_rate:0.993734335839599
noisy true:425
noisy false:377
after delete: len(clean_dataset) 798
after delete: len(noisy_dataset) 802
epoch [42/200] batch [5/24] time 0.180 (0.193) data 0.103 (0.116) loss_x loss_x 0.7944 (0.5863) acc_x 75.0000 (81.8750) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/24] time 0.159 (0.189) data 0.082 (0.112) loss_x loss_x 0.5474 (0.5721) acc_x 84.3750 (82.5000) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/24] time 0.156 (0.183) data 0.078 (0.106) loss_x loss_x 0.3425 (0.6086) acc_x 87.5000 (81.8750) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/24] time 0.177 (0.182) data 0.100 (0.105) loss_x loss_x 0.7910 (0.6332) acc_x 71.8750 (81.4062) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/25] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8481 (0.8537) acc_u 18.7500 (16.2500) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/25] time 0.187 (0.182) data 0.110 (0.106) loss_u loss_u 0.9414 (0.8803) acc_u 6.2500 (13.7500) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/25] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.8892 (0.8668) acc_u 18.7500 (16.0417) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/25] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.7866 (0.8605) acc_u 21.8750 (16.5625) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [25/25] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.7783 (0.8516) acc_u 28.1250 (17.7500) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 810
clean true:802
clean false:8
clean_rate:0.9901234567901235
noisy true:438
noisy false:352
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 790
epoch [43/200] batch [5/25] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 1.0283 (0.7301) acc_x 78.1250 (81.8750) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/25] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.8960 (0.6669) acc_x 81.2500 (83.4375) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/25] time 0.177 (0.181) data 0.101 (0.104) loss_x loss_x 0.7944 (0.7480) acc_x 84.3750 (81.8750) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/25] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.8574 (0.7123) acc_x 75.0000 (82.3438) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [25/25] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.5771 (0.7054) acc_x 84.3750 (82.1250) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/24] time 0.180 (0.181) data 0.104 (0.105) loss_u loss_u 0.8755 (0.8798) acc_u 12.5000 (13.1250) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/24] time 0.180 (0.182) data 0.101 (0.105) loss_u loss_u 0.8472 (0.8658) acc_u 18.7500 (15.0000) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/24] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8643 (0.8641) acc_u 18.7500 (15.8333) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/24] time 0.176 (0.182) data 0.099 (0.105) loss_u loss_u 0.8486 (0.8702) acc_u 18.7500 (15.0000) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:815
clean false:7
clean_rate:0.9914841849148418
noisy true:435
noisy false:343
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [44/200] batch [5/25] time 0.177 (0.183) data 0.100 (0.106) loss_x loss_x 0.4819 (0.6645) acc_x 84.3750 (84.3750) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/25] time 0.181 (0.181) data 0.103 (0.104) loss_x loss_x 0.7153 (0.6772) acc_x 81.2500 (82.1875) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/25] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.9565 (0.6805) acc_x 71.8750 (81.8750) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/25] time 0.171 (0.179) data 0.095 (0.102) loss_x loss_x 0.2036 (0.6083) acc_x 90.6250 (82.9688) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [25/25] time 0.165 (0.176) data 0.089 (0.100) loss_x loss_x 0.8110 (0.6171) acc_x 81.2500 (82.8750) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/24] time 0.170 (0.176) data 0.092 (0.099) loss_u loss_u 0.9521 (0.8933) acc_u 3.1250 (11.2500) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/24] time 0.189 (0.176) data 0.112 (0.099) loss_u loss_u 0.9370 (0.8867) acc_u 3.1250 (12.1875) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/24] time 0.181 (0.177) data 0.105 (0.100) loss_u loss_u 0.8706 (0.8771) acc_u 15.6250 (13.5417) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/24] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.8594 (0.8703) acc_u 18.7500 (14.5312) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.4981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 797
clean true:787
clean false:10
clean_rate:0.9874529485570891
noisy true:397
noisy false:406
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 803
epoch [45/200] batch [5/24] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.6299 (0.6712) acc_x 84.3750 (81.2500) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/24] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.4143 (0.6068) acc_x 84.3750 (83.1250) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/24] time 0.174 (0.181) data 0.097 (0.105) loss_x loss_x 0.5874 (0.5709) acc_x 87.5000 (84.7917) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/24] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.2988 (0.5363) acc_x 93.7500 (85.9375) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/25] time 0.192 (0.183) data 0.115 (0.107) loss_u loss_u 0.9175 (0.8562) acc_u 9.3750 (17.5000) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/25] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.8428 (0.8463) acc_u 12.5000 (16.8750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/25] time 0.180 (0.183) data 0.103 (0.106) loss_u loss_u 0.8442 (0.8484) acc_u 18.7500 (16.6667) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/25] time 0.184 (0.183) data 0.108 (0.106) loss_u loss_u 0.9395 (0.8499) acc_u 6.2500 (16.5625) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [25/25] time 0.179 (0.183) data 0.101 (0.106) loss_u loss_u 0.9360 (0.8556) acc_u 6.2500 (15.7500) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:807
clean false:8
clean_rate:0.9901840490797545
noisy true:417
noisy false:368
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [46/200] batch [5/25] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.9844 (0.7079) acc_x 68.7500 (80.6250) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/25] time 0.182 (0.190) data 0.105 (0.113) loss_x loss_x 0.3337 (0.5741) acc_x 90.6250 (84.0625) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/25] time 0.184 (0.189) data 0.107 (0.112) loss_x loss_x 0.4614 (0.5778) acc_x 90.6250 (84.3750) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/25] time 0.184 (0.189) data 0.107 (0.112) loss_x loss_x 0.5220 (0.5558) acc_x 84.3750 (84.8438) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [25/25] time 0.181 (0.187) data 0.104 (0.110) loss_x loss_x 0.6812 (0.5486) acc_x 78.1250 (84.8750) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/24] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.9287 (0.8523) acc_u 6.2500 (15.6250) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/24] time 0.178 (0.184) data 0.101 (0.107) loss_u loss_u 0.8340 (0.8611) acc_u 18.7500 (15.0000) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/24] time 0.178 (0.184) data 0.100 (0.107) loss_u loss_u 0.8296 (0.8672) acc_u 18.7500 (14.1667) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/24] time 0.169 (0.183) data 0.092 (0.105) loss_u loss_u 0.8628 (0.8720) acc_u 15.6250 (14.2188) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 805
clean true:798
clean false:7
clean_rate:0.991304347826087
noisy true:426
noisy false:369
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 795
epoch [47/200] batch [5/25] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.4167 (0.4201) acc_x 90.6250 (90.0000) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/25] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6108 (0.5238) acc_x 84.3750 (87.1875) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/25] time 0.179 (0.185) data 0.102 (0.108) loss_x loss_x 0.6333 (0.5627) acc_x 78.1250 (85.8333) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/25] time 0.172 (0.182) data 0.096 (0.106) loss_x loss_x 0.3203 (0.5794) acc_x 90.6250 (85.4688) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [25/25] time 0.174 (0.182) data 0.097 (0.105) loss_x loss_x 0.8877 (0.5915) acc_x 87.5000 (85.2500) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/24] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.8774 (0.8528) acc_u 15.6250 (17.5000) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/24] time 0.173 (0.181) data 0.096 (0.104) loss_u loss_u 0.8872 (0.8612) acc_u 9.3750 (15.3125) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/24] time 0.166 (0.179) data 0.089 (0.103) loss_u loss_u 0.9409 (0.8688) acc_u 9.3750 (15.0000) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/24] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.8882 (0.8691) acc_u 12.5000 (14.8438) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:804
clean false:9
clean_rate:0.988929889298893
noisy true:426
noisy false:361
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [48/200] batch [5/25] time 0.161 (0.178) data 0.084 (0.101) loss_x loss_x 0.7109 (0.7458) acc_x 84.3750 (81.2500) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/25] time 0.182 (0.176) data 0.104 (0.098) loss_x loss_x 0.4253 (0.5943) acc_x 84.3750 (84.6875) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/25] time 0.178 (0.177) data 0.102 (0.100) loss_x loss_x 1.1943 (0.6692) acc_x 71.8750 (82.5000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/25] time 0.179 (0.178) data 0.102 (0.101) loss_x loss_x 0.5464 (0.6383) acc_x 84.3750 (83.4375) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [25/25] time 0.183 (0.178) data 0.107 (0.102) loss_x loss_x 0.3696 (0.6029) acc_x 81.2500 (83.8750) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/24] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8833 (0.8329) acc_u 12.5000 (18.1250) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/24] time 0.183 (0.179) data 0.107 (0.102) loss_u loss_u 0.8364 (0.8331) acc_u 21.8750 (19.0625) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/24] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.8804 (0.8506) acc_u 12.5000 (17.0833) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/24] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.8496 (0.8532) acc_u 15.6250 (16.7188) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 800
clean true:789
clean false:11
clean_rate:0.98625
noisy true:422
noisy false:378
after delete: len(clean_dataset) 800
after delete: len(noisy_dataset) 800
epoch [49/200] batch [5/25] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.4172 (0.4135) acc_x 90.6250 (90.6250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/25] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.5469 (0.5157) acc_x 90.6250 (86.8750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/25] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.5107 (0.5684) acc_x 90.6250 (84.7917) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/25] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 0.4053 (0.5668) acc_x 90.6250 (85.3125) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [25/25] time 0.168 (0.178) data 0.091 (0.102) loss_x loss_x 0.1552 (0.5619) acc_x 96.8750 (85.7500) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/25] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8843 (0.8526) acc_u 12.5000 (18.1250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/25] time 0.169 (0.177) data 0.093 (0.100) loss_u loss_u 0.9497 (0.8701) acc_u 3.1250 (15.0000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/25] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.8560 (0.8674) acc_u 15.6250 (15.4167) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/25] time 0.171 (0.177) data 0.093 (0.100) loss_u loss_u 0.9209 (0.8635) acc_u 9.3750 (15.7812) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [25/25] time 0.164 (0.177) data 0.086 (0.100) loss_u loss_u 0.7715 (0.8529) acc_u 21.8750 (16.7500) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:808
clean false:7
clean_rate:0.9914110429447853
noisy true:442
noisy false:343
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [50/200] batch [5/25] time 0.177 (0.180) data 0.100 (0.104) loss_x loss_x 0.8086 (0.6839) acc_x 75.0000 (78.7500) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/25] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.8076 (0.5786) acc_x 84.3750 (83.4375) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/25] time 0.180 (0.180) data 0.104 (0.103) loss_x loss_x 0.4180 (0.5517) acc_x 90.6250 (85.4167) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/25] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.2273 (0.5563) acc_x 93.7500 (85.7812) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [25/25] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.3396 (0.5433) acc_x 90.6250 (86.2500) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/24] time 0.164 (0.180) data 0.087 (0.103) loss_u loss_u 0.8687 (0.8351) acc_u 15.6250 (18.7500) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/24] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.9048 (0.8464) acc_u 9.3750 (17.1875) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/24] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.9780 (0.8683) acc_u 3.1250 (15.0000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/24] time 0.179 (0.179) data 0.103 (0.103) loss_u loss_u 0.8618 (0.8676) acc_u 15.6250 (15.3125) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.5119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 819
clean true:808
clean false:11
clean_rate:0.9865689865689866
noisy true:422
noisy false:359
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 781
epoch [51/200] batch [5/25] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.5239 (0.5233) acc_x 90.6250 (86.2500) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/25] time 0.185 (0.181) data 0.109 (0.104) loss_x loss_x 0.8208 (0.6215) acc_x 75.0000 (81.8750) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/25] time 0.163 (0.180) data 0.086 (0.103) loss_x loss_x 0.6265 (0.6619) acc_x 84.3750 (81.8750) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/25] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.8760 (0.6524) acc_x 84.3750 (83.1250) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [25/25] time 0.179 (0.178) data 0.102 (0.101) loss_x loss_x 0.7441 (0.6384) acc_x 87.5000 (84.1250) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/24] time 0.181 (0.179) data 0.103 (0.102) loss_u loss_u 0.7925 (0.8793) acc_u 25.0000 (14.3750) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/24] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.9302 (0.8713) acc_u 9.3750 (15.0000) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/24] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8618 (0.8694) acc_u 12.5000 (15.4167) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/24] time 0.176 (0.180) data 0.099 (0.103) loss_u loss_u 0.8652 (0.8646) acc_u 12.5000 (15.7812) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 820
clean true:815
clean false:5
clean_rate:0.9939024390243902
noisy true:428
noisy false:352
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 780
epoch [52/200] batch [5/25] time 0.161 (0.169) data 0.084 (0.092) loss_x loss_x 0.7500 (0.6892) acc_x 84.3750 (81.8750) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/25] time 0.158 (0.167) data 0.082 (0.090) loss_x loss_x 0.2213 (0.6508) acc_x 93.7500 (80.9375) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/25] time 0.167 (0.171) data 0.091 (0.094) loss_x loss_x 0.2598 (0.5931) acc_x 96.8750 (83.3333) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/25] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.1884 (0.5852) acc_x 96.8750 (83.4375) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [25/25] time 0.185 (0.170) data 0.109 (0.094) loss_x loss_x 0.6050 (0.5940) acc_x 81.2500 (82.7500) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/24] time 0.180 (0.170) data 0.103 (0.094) loss_u loss_u 0.8735 (0.8267) acc_u 12.5000 (18.7500) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/24] time 0.179 (0.172) data 0.103 (0.095) loss_u loss_u 0.8184 (0.8457) acc_u 21.8750 (17.5000) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/24] time 0.180 (0.173) data 0.103 (0.097) loss_u loss_u 0.8984 (0.8616) acc_u 9.3750 (15.2083) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/24] time 0.177 (0.174) data 0.100 (0.097) loss_u loss_u 0.9629 (0.8735) acc_u 6.2500 (14.0625) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 809
clean true:802
clean false:7
clean_rate:0.9913473423980222
noisy true:447
noisy false:344
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 791
epoch [53/200] batch [5/25] time 0.181 (0.177) data 0.104 (0.101) loss_x loss_x 0.6616 (0.7373) acc_x 78.1250 (79.3750) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/25] time 0.200 (0.181) data 0.123 (0.104) loss_x loss_x 0.2247 (0.6174) acc_x 93.7500 (81.2500) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/25] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.5767 (0.5905) acc_x 87.5000 (82.7083) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/25] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.2196 (0.5501) acc_x 96.8750 (84.3750) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [25/25] time 0.165 (0.175) data 0.087 (0.099) loss_x loss_x 0.5767 (0.5702) acc_x 87.5000 (84.5000) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/24] time 0.181 (0.177) data 0.103 (0.100) loss_u loss_u 0.6929 (0.7946) acc_u 34.3750 (23.1250) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/24] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.8311 (0.8240) acc_u 18.7500 (20.6250) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/24] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.8042 (0.8423) acc_u 21.8750 (18.3333) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/24] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.9292 (0.8561) acc_u 6.2500 (16.8750) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.5112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 818
clean true:813
clean false:5
clean_rate:0.9938875305623472
noisy true:458
noisy false:324
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 782
epoch [54/200] batch [5/25] time 0.160 (0.168) data 0.083 (0.091) loss_x loss_x 0.2742 (0.3595) acc_x 90.6250 (91.2500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/25] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 0.2717 (0.4035) acc_x 90.6250 (90.3125) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/25] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.6587 (0.4502) acc_x 84.3750 (88.1250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/25] time 0.159 (0.172) data 0.081 (0.095) loss_x loss_x 0.4536 (0.4353) acc_x 87.5000 (87.9688) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [25/25] time 0.174 (0.172) data 0.097 (0.095) loss_x loss_x 0.5928 (0.4892) acc_x 75.0000 (86.3750) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/24] time 0.175 (0.172) data 0.099 (0.095) loss_u loss_u 0.8477 (0.9037) acc_u 21.8750 (10.6250) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/24] time 0.183 (0.173) data 0.106 (0.096) loss_u loss_u 0.9009 (0.8858) acc_u 9.3750 (12.5000) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/24] time 0.176 (0.174) data 0.098 (0.097) loss_u loss_u 0.9097 (0.8604) acc_u 9.3750 (15.6250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/24] time 0.160 (0.174) data 0.084 (0.097) loss_u loss_u 0.8804 (0.8627) acc_u 15.6250 (15.7812) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 808
clean true:799
clean false:9
clean_rate:0.9888613861386139
noisy true:427
noisy false:365
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 792
epoch [55/200] batch [5/25] time 0.180 (0.185) data 0.104 (0.108) loss_x loss_x 0.4133 (0.5355) acc_x 90.6250 (86.8750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/25] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.2881 (0.5718) acc_x 93.7500 (85.6250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/25] time 0.177 (0.184) data 0.100 (0.108) loss_x loss_x 0.4167 (0.5491) acc_x 87.5000 (85.8333) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [20/25] time 0.172 (0.182) data 0.095 (0.105) loss_x loss_x 0.3997 (0.5538) acc_x 90.6250 (85.9375) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [25/25] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.6421 (0.5617) acc_x 84.3750 (85.8750) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/24] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.8491 (0.8384) acc_u 21.8750 (20.0000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/24] time 0.178 (0.177) data 0.101 (0.100) loss_u loss_u 0.7510 (0.8489) acc_u 28.1250 (17.8125) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/24] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.9092 (0.8605) acc_u 9.3750 (16.4583) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [20/24] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8032 (0.8555) acc_u 21.8750 (16.7188) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:807
clean false:8
clean_rate:0.9901840490797545
noisy true:426
noisy false:359
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [56/200] batch [5/25] time 0.206 (0.190) data 0.129 (0.113) loss_x loss_x 0.4495 (0.6287) acc_x 84.3750 (83.7500) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/25] time 0.191 (0.185) data 0.114 (0.108) loss_x loss_x 0.3174 (0.5745) acc_x 90.6250 (85.0000) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/25] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.4961 (0.5908) acc_x 87.5000 (84.3750) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/25] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.4202 (0.5801) acc_x 87.5000 (83.9062) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [25/25] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.9922 (0.5853) acc_x 81.2500 (84.6250) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/24] time 0.187 (0.184) data 0.109 (0.107) loss_u loss_u 0.8247 (0.8574) acc_u 18.7500 (15.6250) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/24] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8784 (0.8600) acc_u 15.6250 (15.3125) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/24] time 0.178 (0.184) data 0.101 (0.107) loss_u loss_u 0.8325 (0.8571) acc_u 18.7500 (15.8333) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/24] time 0.180 (0.185) data 0.103 (0.107) loss_u loss_u 0.8037 (0.8644) acc_u 21.8750 (15.1562) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 340
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:815
clean false:10
clean_rate:0.9878787878787879
noisy true:445
noisy false:330
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [57/200] batch [5/25] time 0.188 (0.184) data 0.110 (0.107) loss_x loss_x 0.4873 (0.5379) acc_x 87.5000 (86.2500) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/25] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 0.4167 (0.5251) acc_x 90.6250 (86.2500) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/25] time 0.180 (0.180) data 0.104 (0.103) loss_x loss_x 0.3848 (0.5491) acc_x 87.5000 (85.0000) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/25] time 0.186 (0.180) data 0.110 (0.103) loss_x loss_x 0.5879 (0.5876) acc_x 87.5000 (83.9062) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [25/25] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.4861 (0.5607) acc_x 81.2500 (84.5000) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/24] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.8931 (0.8451) acc_u 9.3750 (17.5000) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/24] time 0.178 (0.179) data 0.100 (0.101) loss_u loss_u 0.9360 (0.8711) acc_u 6.2500 (14.0625) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/24] time 0.188 (0.179) data 0.110 (0.101) loss_u loss_u 0.9229 (0.8777) acc_u 9.3750 (13.5417) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/24] time 0.164 (0.177) data 0.087 (0.100) loss_u loss_u 0.8989 (0.8713) acc_u 12.5000 (14.3750) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 827
clean true:819
clean false:8
clean_rate:0.9903264812575574
noisy true:433
noisy false:340
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 773
epoch [58/200] batch [5/25] time 0.178 (0.182) data 0.102 (0.105) loss_x loss_x 0.5576 (0.4631) acc_x 87.5000 (88.7500) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/25] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.6782 (0.5161) acc_x 78.1250 (86.8750) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/25] time 0.178 (0.182) data 0.101 (0.105) loss_x loss_x 0.9673 (0.5850) acc_x 81.2500 (85.2083) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/25] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.7969 (0.6058) acc_x 84.3750 (83.9062) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [25/25] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.1359 (0.5889) acc_x 100.0000 (84.6250) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/24] time 0.179 (0.183) data 0.102 (0.106) loss_u loss_u 0.8867 (0.8657) acc_u 12.5000 (15.0000) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/24] time 0.170 (0.182) data 0.093 (0.105) loss_u loss_u 0.7964 (0.8645) acc_u 25.0000 (14.6875) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/24] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.9683 (0.8811) acc_u 3.1250 (12.7083) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/24] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.8325 (0.8743) acc_u 18.7500 (13.7500) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.5188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 830
clean true:819
clean false:11
clean_rate:0.9867469879518073
noisy true:430
noisy false:340
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 770
epoch [59/200] batch [5/25] time 0.167 (0.180) data 0.091 (0.103) loss_x loss_x 0.6792 (0.7278) acc_x 84.3750 (82.5000) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/25] time 0.183 (0.180) data 0.107 (0.103) loss_x loss_x 0.2223 (0.6928) acc_x 90.6250 (82.1875) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/25] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.4387 (0.6738) acc_x 90.6250 (82.9167) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/25] time 0.184 (0.182) data 0.106 (0.105) loss_x loss_x 0.4854 (0.6773) acc_x 87.5000 (81.5625) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [25/25] time 0.221 (0.183) data 0.144 (0.107) loss_x loss_x 0.5127 (0.6371) acc_x 87.5000 (83.1250) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/24] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.8862 (0.8937) acc_u 12.5000 (11.2500) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/24] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9102 (0.9001) acc_u 12.5000 (11.5625) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/24] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9092 (0.8917) acc_u 9.3750 (12.0833) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/24] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8184 (0.8804) acc_u 18.7500 (13.2812) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 355
confident_label rate tensor(0.5106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 817
clean true:805
clean false:12
clean_rate:0.98531211750306
noisy true:440
noisy false:343
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 783
epoch [60/200] batch [5/25] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.4783 (0.7086) acc_x 87.5000 (81.2500) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/25] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 0.8887 (0.6618) acc_x 75.0000 (83.1250) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/25] time 0.184 (0.182) data 0.108 (0.105) loss_x loss_x 0.6768 (0.6426) acc_x 81.2500 (83.1250) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/25] time 0.186 (0.182) data 0.109 (0.106) loss_x loss_x 0.5063 (0.5818) acc_x 87.5000 (85.0000) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [25/25] time 0.188 (0.182) data 0.111 (0.106) loss_x loss_x 0.3962 (0.5711) acc_x 87.5000 (85.3750) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/24] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.8799 (0.8681) acc_u 15.6250 (15.0000) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/24] time 0.178 (0.182) data 0.101 (0.106) loss_u loss_u 0.8433 (0.8530) acc_u 15.6250 (16.8750) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/24] time 0.193 (0.182) data 0.116 (0.105) loss_u loss_u 0.8833 (0.8632) acc_u 12.5000 (16.0417) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/24] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.8511 (0.8673) acc_u 21.8750 (15.6250) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.5112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 818
clean true:811
clean false:7
clean_rate:0.991442542787286
noisy true:429
noisy false:353
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 782
epoch [61/200] batch [5/25] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.3137 (0.5005) acc_x 90.6250 (88.1250) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/25] time 0.181 (0.181) data 0.104 (0.105) loss_x loss_x 0.4531 (0.4723) acc_x 90.6250 (88.1250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/25] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.2664 (0.4947) acc_x 96.8750 (87.0833) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/25] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.6162 (0.5049) acc_x 81.2500 (86.5625) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [25/25] time 0.178 (0.182) data 0.100 (0.105) loss_x loss_x 0.6406 (0.4946) acc_x 81.2500 (86.3750) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/24] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.9336 (0.8631) acc_u 9.3750 (16.2500) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/24] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8452 (0.8475) acc_u 15.6250 (16.8750) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/24] time 0.183 (0.182) data 0.106 (0.104) loss_u loss_u 0.7983 (0.8490) acc_u 21.8750 (16.4583) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/24] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8105 (0.8529) acc_u 21.8750 (16.4062) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:797
clean false:10
clean_rate:0.9876084262701363
noisy true:422
noisy false:371
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [62/200] batch [5/25] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.8389 (0.5489) acc_x 78.1250 (85.6250) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/25] time 0.190 (0.190) data 0.113 (0.113) loss_x loss_x 0.3176 (0.5781) acc_x 87.5000 (84.6875) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/25] time 0.184 (0.188) data 0.106 (0.111) loss_x loss_x 0.3425 (0.5645) acc_x 87.5000 (84.7917) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/25] time 0.180 (0.186) data 0.102 (0.109) loss_x loss_x 0.6406 (0.5467) acc_x 81.2500 (85.3125) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [25/25] time 0.180 (0.185) data 0.104 (0.108) loss_x loss_x 1.1836 (0.5333) acc_x 65.6250 (85.3750) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/24] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.8052 (0.8313) acc_u 25.0000 (19.3750) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/24] time 0.172 (0.184) data 0.095 (0.107) loss_u loss_u 0.8599 (0.8587) acc_u 12.5000 (16.2500) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/24] time 0.198 (0.184) data 0.121 (0.107) loss_u loss_u 0.8643 (0.8606) acc_u 12.5000 (15.4167) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/24] time 0.180 (0.184) data 0.104 (0.107) loss_u loss_u 0.9126 (0.8577) acc_u 9.3750 (15.7812) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 338
confident_label rate tensor(0.5150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 824
clean true:816
clean false:8
clean_rate:0.9902912621359223
noisy true:446
noisy false:330
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 776
epoch [63/200] batch [5/25] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.4712 (0.4304) acc_x 84.3750 (88.1250) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/25] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.5923 (0.5230) acc_x 84.3750 (84.6875) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/25] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4963 (0.5217) acc_x 90.6250 (85.6250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/25] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.6699 (0.5478) acc_x 84.3750 (85.0000) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [25/25] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.5791 (0.5408) acc_x 81.2500 (85.2500) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/24] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.9199 (0.8654) acc_u 9.3750 (16.2500) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/24] time 0.180 (0.183) data 0.102 (0.106) loss_u loss_u 0.8481 (0.8663) acc_u 21.8750 (16.2500) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/24] time 0.177 (0.183) data 0.100 (0.106) loss_u loss_u 0.8955 (0.8688) acc_u 15.6250 (15.6250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/24] time 0.187 (0.183) data 0.109 (0.106) loss_u loss_u 0.8628 (0.8656) acc_u 12.5000 (15.6250) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.5169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 827
clean true:818
clean false:9
clean_rate:0.9891172914147521
noisy true:420
noisy false:353
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 773
epoch [64/200] batch [5/25] time 0.172 (0.179) data 0.095 (0.103) loss_x loss_x 0.5469 (0.5077) acc_x 84.3750 (83.7500) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/25] time 0.158 (0.173) data 0.081 (0.096) loss_x loss_x 0.6743 (0.5367) acc_x 81.2500 (83.4375) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/25] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.4778 (0.5440) acc_x 84.3750 (83.5417) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/25] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.2386 (0.5152) acc_x 90.6250 (84.6875) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [25/25] time 0.180 (0.179) data 0.103 (0.102) loss_x loss_x 0.4768 (0.4989) acc_x 81.2500 (85.3750) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/24] time 0.163 (0.179) data 0.086 (0.102) loss_u loss_u 0.8198 (0.8508) acc_u 21.8750 (15.6250) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/24] time 0.174 (0.178) data 0.097 (0.101) loss_u loss_u 0.8086 (0.8622) acc_u 18.7500 (14.6875) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/24] time 0.179 (0.178) data 0.101 (0.101) loss_u loss_u 0.8081 (0.8447) acc_u 21.8750 (16.6667) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/24] time 0.172 (0.178) data 0.095 (0.100) loss_u loss_u 0.8545 (0.8516) acc_u 15.6250 (16.0938) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 803
clean true:794
clean false:9
clean_rate:0.9887920298879203
noisy true:432
noisy false:365
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 797
epoch [65/200] batch [5/25] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.3918 (0.4064) acc_x 93.7500 (92.5000) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/25] time 0.181 (0.182) data 0.103 (0.105) loss_x loss_x 0.6455 (0.5010) acc_x 84.3750 (88.7500) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/25] time 0.180 (0.181) data 0.103 (0.105) loss_x loss_x 0.4790 (0.5615) acc_x 87.5000 (86.6667) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/25] time 0.177 (0.181) data 0.100 (0.104) loss_x loss_x 0.7021 (0.6002) acc_x 84.3750 (86.2500) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [25/25] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.5830 (0.5679) acc_x 87.5000 (86.7500) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/24] time 0.160 (0.180) data 0.083 (0.103) loss_u loss_u 0.7603 (0.8175) acc_u 28.1250 (21.2500) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/24] time 0.178 (0.179) data 0.101 (0.102) loss_u loss_u 0.8901 (0.8529) acc_u 9.3750 (16.2500) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/24] time 0.171 (0.179) data 0.094 (0.102) loss_u loss_u 0.8208 (0.8425) acc_u 25.0000 (18.3333) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/24] time 0.176 (0.178) data 0.098 (0.101) loss_u loss_u 0.8955 (0.8518) acc_u 12.5000 (17.0312) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.5169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 827
clean true:816
clean false:11
clean_rate:0.9866989117291415
noisy true:409
noisy false:364
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 773
epoch [66/200] batch [5/25] time 0.189 (0.179) data 0.112 (0.103) loss_x loss_x 0.4673 (0.5211) acc_x 87.5000 (86.2500) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/25] time 0.181 (0.179) data 0.105 (0.103) loss_x loss_x 0.9419 (0.4851) acc_x 81.2500 (86.8750) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/25] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.6675 (0.5042) acc_x 84.3750 (86.6667) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/25] time 0.177 (0.181) data 0.100 (0.104) loss_x loss_x 0.7104 (0.5486) acc_x 78.1250 (85.4688) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [25/25] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.4011 (0.5414) acc_x 90.6250 (86.0000) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/24] time 0.186 (0.181) data 0.109 (0.105) loss_u loss_u 0.9517 (0.8896) acc_u 6.2500 (13.1250) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/24] time 0.178 (0.182) data 0.101 (0.105) loss_u loss_u 0.8389 (0.8887) acc_u 18.7500 (12.1875) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/24] time 0.182 (0.181) data 0.104 (0.105) loss_u loss_u 0.8970 (0.8800) acc_u 9.3750 (13.3333) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/24] time 0.162 (0.181) data 0.084 (0.104) loss_u loss_u 0.8408 (0.8769) acc_u 15.6250 (13.5938) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 821
clean true:812
clean false:9
clean_rate:0.9890377588306942
noisy true:434
noisy false:345
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 779
epoch [67/200] batch [5/25] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.8164 (0.6271) acc_x 71.8750 (83.1250) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/25] time 0.184 (0.174) data 0.107 (0.098) loss_x loss_x 0.6392 (0.5813) acc_x 84.3750 (85.6250) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/25] time 0.182 (0.174) data 0.106 (0.097) loss_x loss_x 0.1870 (0.5406) acc_x 96.8750 (85.8333) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [20/25] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.8691 (0.5336) acc_x 78.1250 (85.7812) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [25/25] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.4016 (0.5571) acc_x 90.6250 (86.1250) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/24] time 0.179 (0.178) data 0.101 (0.101) loss_u loss_u 0.9009 (0.8341) acc_u 9.3750 (20.0000) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/24] time 0.188 (0.178) data 0.112 (0.101) loss_u loss_u 0.8569 (0.8674) acc_u 12.5000 (15.9375) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/24] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9014 (0.8660) acc_u 12.5000 (15.8333) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [20/24] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.7974 (0.8534) acc_u 25.0000 (17.1875) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 809
clean true:802
clean false:7
clean_rate:0.9913473423980222
noisy true:439
noisy false:352
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 791
epoch [68/200] batch [5/25] time 0.168 (0.164) data 0.092 (0.088) loss_x loss_x 0.2426 (0.4998) acc_x 93.7500 (85.0000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/25] time 0.177 (0.170) data 0.101 (0.093) loss_x loss_x 0.5103 (0.5125) acc_x 81.2500 (85.3125) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/25] time 0.180 (0.174) data 0.104 (0.097) loss_x loss_x 0.2905 (0.4995) acc_x 90.6250 (87.5000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/25] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.6904 (0.5109) acc_x 84.3750 (86.8750) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [25/25] time 0.188 (0.178) data 0.111 (0.101) loss_x loss_x 0.6460 (0.5413) acc_x 75.0000 (86.0000) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/24] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.8804 (0.8399) acc_u 12.5000 (16.8750) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/24] time 0.180 (0.179) data 0.102 (0.102) loss_u loss_u 0.8457 (0.8406) acc_u 15.6250 (16.8750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/24] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.8774 (0.8509) acc_u 12.5000 (15.6250) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/24] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8291 (0.8499) acc_u 15.6250 (15.7812) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 803
clean true:794
clean false:9
clean_rate:0.9887920298879203
noisy true:415
noisy false:382
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 797
epoch [69/200] batch [5/25] time 0.191 (0.186) data 0.115 (0.109) loss_x loss_x 0.1146 (0.4360) acc_x 96.8750 (90.0000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/25] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.3743 (0.4972) acc_x 90.6250 (87.8125) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/25] time 0.157 (0.182) data 0.081 (0.105) loss_x loss_x 0.1896 (0.5251) acc_x 93.7500 (87.9167) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/25] time 0.178 (0.181) data 0.101 (0.105) loss_x loss_x 0.6553 (0.5461) acc_x 81.2500 (86.8750) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [25/25] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.6309 (0.5402) acc_x 81.2500 (86.5000) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/24] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8364 (0.8464) acc_u 15.6250 (16.8750) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/24] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.8394 (0.8383) acc_u 18.7500 (18.4375) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/24] time 0.161 (0.180) data 0.084 (0.103) loss_u loss_u 0.8594 (0.8417) acc_u 18.7500 (17.7083) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/24] time 0.175 (0.179) data 0.098 (0.103) loss_u loss_u 0.7642 (0.8391) acc_u 25.0000 (17.9688) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 818
clean true:808
clean false:10
clean_rate:0.9877750611246944
noisy true:444
noisy false:338
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 782
epoch [70/200] batch [5/25] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.7393 (0.6000) acc_x 78.1250 (82.5000) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/25] time 0.172 (0.178) data 0.095 (0.101) loss_x loss_x 0.8330 (0.6280) acc_x 71.8750 (81.2500) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/25] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.4717 (0.5857) acc_x 90.6250 (82.9167) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/25] time 0.180 (0.179) data 0.103 (0.102) loss_x loss_x 0.5122 (0.5644) acc_x 81.2500 (83.9062) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [25/25] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.6631 (0.5734) acc_x 87.5000 (83.7500) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/24] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8389 (0.8408) acc_u 15.6250 (17.5000) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/24] time 0.171 (0.180) data 0.093 (0.102) loss_u loss_u 0.8428 (0.8535) acc_u 18.7500 (16.2500) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/24] time 0.167 (0.178) data 0.089 (0.101) loss_u loss_u 0.8433 (0.8605) acc_u 15.6250 (15.4167) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/24] time 0.191 (0.178) data 0.114 (0.101) loss_u loss_u 0.8350 (0.8587) acc_u 15.6250 (15.0000) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 330
confident_label rate tensor(0.5231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 837
clean true:826
clean false:11
clean_rate:0.986857825567503
noisy true:444
noisy false:319
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 763
epoch [71/200] batch [5/26] time 0.181 (0.181) data 0.103 (0.104) loss_x loss_x 0.9966 (0.6671) acc_x 78.1250 (83.7500) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/26] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.5781 (0.6172) acc_x 90.6250 (85.0000) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/26] time 0.180 (0.181) data 0.102 (0.104) loss_x loss_x 0.6724 (0.6088) acc_x 87.5000 (85.0000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [20/26] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 1.1211 (0.6049) acc_x 78.1250 (85.6250) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [25/26] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.5801 (0.5764) acc_x 87.5000 (85.8750) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/23] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8789 (0.8573) acc_u 12.5000 (15.0000) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/23] time 0.184 (0.181) data 0.107 (0.105) loss_u loss_u 0.8843 (0.8701) acc_u 12.5000 (13.7500) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/23] time 0.182 (0.181) data 0.105 (0.105) loss_u loss_u 0.8584 (0.8645) acc_u 15.6250 (14.7917) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [20/23] time 0.176 (0.180) data 0.098 (0.103) loss_u loss_u 0.8906 (0.8768) acc_u 12.5000 (13.5938) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.5213, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 834
clean true:823
clean false:11
clean_rate:0.986810551558753
noisy true:426
noisy false:340
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 766
epoch [72/200] batch [5/26] time 0.175 (0.173) data 0.098 (0.097) loss_x loss_x 0.2554 (0.3912) acc_x 96.8750 (90.6250) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/26] time 0.160 (0.171) data 0.084 (0.094) loss_x loss_x 0.4275 (0.5082) acc_x 84.3750 (87.1875) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/26] time 0.165 (0.170) data 0.089 (0.093) loss_x loss_x 0.2502 (0.5207) acc_x 100.0000 (86.6667) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/26] time 0.184 (0.172) data 0.107 (0.096) loss_x loss_x 0.7002 (0.5209) acc_x 81.2500 (86.5625) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [25/26] time 0.186 (0.174) data 0.110 (0.097) loss_x loss_x 0.2715 (0.5158) acc_x 93.7500 (86.6250) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/23] time 0.187 (0.174) data 0.111 (0.097) loss_u loss_u 0.7446 (0.8338) acc_u 31.2500 (20.6250) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/23] time 0.169 (0.173) data 0.092 (0.096) loss_u loss_u 0.7485 (0.8462) acc_u 31.2500 (18.4375) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/23] time 0.175 (0.174) data 0.099 (0.097) loss_u loss_u 0.8320 (0.8685) acc_u 18.7500 (15.0000) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/23] time 0.182 (0.174) data 0.106 (0.097) loss_u loss_u 0.9224 (0.8796) acc_u 6.2500 (13.2812) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 344
confident_label rate tensor(0.5231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 837
clean true:824
clean false:13
clean_rate:0.984468339307049
noisy true:432
noisy false:331
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 763
epoch [73/200] batch [5/26] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.3811 (0.4205) acc_x 93.7500 (89.3750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/26] time 0.179 (0.184) data 0.102 (0.108) loss_x loss_x 0.3542 (0.4561) acc_x 93.7500 (87.1875) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/26] time 0.180 (0.184) data 0.104 (0.107) loss_x loss_x 0.5869 (0.5078) acc_x 84.3750 (87.5000) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/26] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5376 (0.5169) acc_x 87.5000 (86.8750) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [25/26] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.3484 (0.4947) acc_x 87.5000 (87.0000) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/23] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.8721 (0.8776) acc_u 15.6250 (14.3750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/23] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.9390 (0.8550) acc_u 6.2500 (16.5625) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/23] time 0.179 (0.184) data 0.101 (0.107) loss_u loss_u 0.8145 (0.8543) acc_u 18.7500 (16.2500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [20/23] time 0.181 (0.183) data 0.103 (0.106) loss_u loss_u 0.9043 (0.8571) acc_u 9.3750 (16.2500) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 833
clean true:820
clean false:13
clean_rate:0.9843937575030012
noisy true:426
noisy false:341
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 767
epoch [74/200] batch [5/26] time 0.178 (0.177) data 0.101 (0.101) loss_x loss_x 0.5029 (0.5095) acc_x 84.3750 (86.2500) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/26] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.4309 (0.5047) acc_x 93.7500 (87.1875) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/26] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.4729 (0.5523) acc_x 84.3750 (85.8333) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [20/26] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.4558 (0.5288) acc_x 93.7500 (86.8750) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [25/26] time 0.177 (0.182) data 0.100 (0.105) loss_x loss_x 0.4207 (0.5507) acc_x 87.5000 (86.3750) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/23] time 0.174 (0.179) data 0.095 (0.102) loss_u loss_u 0.8667 (0.8508) acc_u 15.6250 (16.2500) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/23] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.8750 (0.8668) acc_u 12.5000 (14.6875) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/23] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.8882 (0.8722) acc_u 12.5000 (14.1667) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [20/23] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.8252 (0.8641) acc_u 18.7500 (15.0000) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 340
confident_label rate tensor(0.5288, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 846
clean true:833
clean false:13
clean_rate:0.9846335697399528
noisy true:427
noisy false:327
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 754
epoch [75/200] batch [5/26] time 0.161 (0.178) data 0.085 (0.101) loss_x loss_x 0.9268 (0.7326) acc_x 78.1250 (78.1250) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/26] time 0.177 (0.173) data 0.100 (0.096) loss_x loss_x 0.7285 (0.6442) acc_x 78.1250 (81.8750) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/26] time 0.167 (0.175) data 0.089 (0.098) loss_x loss_x 0.2861 (0.6102) acc_x 90.6250 (82.9167) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/26] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.4299 (0.6191) acc_x 90.6250 (83.4375) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [25/26] time 0.186 (0.177) data 0.110 (0.100) loss_x loss_x 0.5786 (0.6031) acc_x 84.3750 (83.7500) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/23] time 0.179 (0.178) data 0.103 (0.101) loss_u loss_u 0.8755 (0.8588) acc_u 15.6250 (16.8750) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/23] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.8682 (0.8624) acc_u 18.7500 (15.9375) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/23] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.9370 (0.8792) acc_u 6.2500 (14.1667) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/23] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.8398 (0.8745) acc_u 15.6250 (14.6875) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:814
clean false:8
clean_rate:0.9902676399026764
noisy true:420
noisy false:358
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [76/200] batch [5/25] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.3328 (0.4951) acc_x 93.7500 (85.0000) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/25] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.1544 (0.5529) acc_x 93.7500 (85.0000) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/25] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 1.0957 (0.5882) acc_x 81.2500 (85.0000) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/25] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.3403 (0.6059) acc_x 90.6250 (84.8438) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [25/25] time 0.181 (0.182) data 0.104 (0.104) loss_x loss_x 0.3567 (0.5973) acc_x 87.5000 (84.3750) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/24] time 0.187 (0.182) data 0.109 (0.105) loss_u loss_u 0.7949 (0.8588) acc_u 25.0000 (15.6250) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/24] time 0.181 (0.182) data 0.103 (0.104) loss_u loss_u 0.8965 (0.8766) acc_u 9.3750 (14.3750) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/24] time 0.181 (0.182) data 0.105 (0.104) loss_u loss_u 0.8545 (0.8788) acc_u 15.6250 (14.1667) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/24] time 0.189 (0.182) data 0.112 (0.105) loss_u loss_u 0.8682 (0.8758) acc_u 12.5000 (14.2188) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.5131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 821
clean true:811
clean false:10
clean_rate:0.9878197320341048
noisy true:428
noisy false:351
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 779
epoch [77/200] batch [5/25] time 0.177 (0.183) data 0.099 (0.106) loss_x loss_x 0.4080 (0.6624) acc_x 87.5000 (83.1250) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/25] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.5640 (0.5600) acc_x 84.3750 (85.0000) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/25] time 0.180 (0.183) data 0.104 (0.106) loss_x loss_x 0.8462 (0.5683) acc_x 81.2500 (84.5833) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [20/25] time 0.175 (0.182) data 0.098 (0.105) loss_x loss_x 0.4792 (0.5656) acc_x 84.3750 (85.4688) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [25/25] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.6934 (0.5576) acc_x 84.3750 (85.5000) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/24] time 0.161 (0.179) data 0.084 (0.102) loss_u loss_u 0.8818 (0.8912) acc_u 12.5000 (11.8750) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/24] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.8188 (0.8706) acc_u 18.7500 (13.7500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/24] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.8467 (0.8723) acc_u 15.6250 (13.5417) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [20/24] time 0.180 (0.180) data 0.104 (0.103) loss_u loss_u 0.9038 (0.8697) acc_u 9.3750 (13.9062) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 314
confident_label rate tensor(0.5356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 857
clean true:846
clean false:11
clean_rate:0.9871645274212368
noisy true:440
noisy false:303
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 743
epoch [78/200] batch [5/26] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.4810 (0.6051) acc_x 90.6250 (85.6250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/26] time 0.181 (0.186) data 0.105 (0.110) loss_x loss_x 0.3398 (0.5200) acc_x 90.6250 (86.8750) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/26] time 0.179 (0.185) data 0.102 (0.108) loss_x loss_x 0.5015 (0.4702) acc_x 90.6250 (88.5417) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/26] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.3848 (0.4905) acc_x 90.6250 (87.8125) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [25/26] time 0.193 (0.184) data 0.117 (0.108) loss_x loss_x 0.3779 (0.4770) acc_x 90.6250 (88.1250) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/23] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.8818 (0.8793) acc_u 12.5000 (12.5000) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/23] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9092 (0.8703) acc_u 9.3750 (13.7500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/23] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.8857 (0.8740) acc_u 15.6250 (13.7500) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/23] time 0.186 (0.183) data 0.108 (0.107) loss_u loss_u 0.8843 (0.8728) acc_u 12.5000 (13.7500) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:815
clean false:10
clean_rate:0.9878787878787879
noisy true:443
noisy false:332
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [79/200] batch [5/25] time 0.158 (0.163) data 0.081 (0.087) loss_x loss_x 0.9009 (0.8583) acc_x 84.3750 (80.0000) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/25] time 0.166 (0.168) data 0.089 (0.091) loss_x loss_x 0.5386 (0.7240) acc_x 78.1250 (82.8125) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/25] time 0.169 (0.170) data 0.091 (0.094) loss_x loss_x 0.3599 (0.7159) acc_x 84.3750 (82.5000) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/25] time 0.178 (0.170) data 0.101 (0.093) loss_x loss_x 0.4712 (0.6903) acc_x 90.6250 (82.8125) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [25/25] time 0.188 (0.173) data 0.111 (0.096) loss_x loss_x 0.4897 (0.6625) acc_x 90.6250 (83.3750) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/24] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.8682 (0.8524) acc_u 15.6250 (16.8750) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/24] time 0.179 (0.176) data 0.103 (0.099) loss_u loss_u 0.7646 (0.8286) acc_u 25.0000 (19.0625) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/24] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.9175 (0.8400) acc_u 6.2500 (17.2917) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/24] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.8760 (0.8485) acc_u 15.6250 (16.5625) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.5263, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 842
clean true:831
clean false:11
clean_rate:0.9869358669833729
noisy true:443
noisy false:315
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 758
epoch [80/200] batch [5/26] time 0.190 (0.186) data 0.114 (0.109) loss_x loss_x 0.7378 (0.5409) acc_x 81.2500 (86.2500) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/26] time 0.173 (0.183) data 0.097 (0.107) loss_x loss_x 0.4541 (0.4888) acc_x 90.6250 (88.4375) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/26] time 0.163 (0.176) data 0.086 (0.099) loss_x loss_x 0.3940 (0.4731) acc_x 93.7500 (88.3333) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [20/26] time 0.159 (0.172) data 0.082 (0.096) loss_x loss_x 0.5991 (0.4570) acc_x 90.6250 (88.5938) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [25/26] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.5083 (0.5037) acc_x 84.3750 (86.8750) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/23] time 0.184 (0.171) data 0.107 (0.094) loss_u loss_u 0.9307 (0.8881) acc_u 6.2500 (13.7500) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/23] time 0.163 (0.170) data 0.086 (0.094) loss_u loss_u 0.7979 (0.8680) acc_u 18.7500 (15.3125) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/23] time 0.163 (0.170) data 0.085 (0.093) loss_u loss_u 0.8789 (0.8788) acc_u 12.5000 (13.7500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [20/23] time 0.168 (0.170) data 0.090 (0.093) loss_u loss_u 0.8550 (0.8707) acc_u 15.6250 (14.5312) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 841
clean true:831
clean false:10
clean_rate:0.9881093935790726
noisy true:433
noisy false:326
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 759
epoch [81/200] batch [5/26] time 0.179 (0.183) data 0.103 (0.106) loss_x loss_x 0.4426 (0.6139) acc_x 84.3750 (84.3750) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/26] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.7925 (0.5288) acc_x 75.0000 (84.6875) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/26] time 0.187 (0.184) data 0.110 (0.108) loss_x loss_x 0.9507 (0.5691) acc_x 71.8750 (83.1250) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/26] time 0.167 (0.184) data 0.091 (0.107) loss_x loss_x 0.2732 (0.5540) acc_x 93.7500 (83.9062) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [25/26] time 0.158 (0.179) data 0.081 (0.102) loss_x loss_x 0.4692 (0.5436) acc_x 84.3750 (83.6250) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/23] time 0.164 (0.175) data 0.088 (0.099) loss_u loss_u 0.8467 (0.8445) acc_u 15.6250 (16.8750) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/23] time 0.184 (0.174) data 0.108 (0.097) loss_u loss_u 0.8872 (0.8588) acc_u 15.6250 (15.0000) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/23] time 0.183 (0.175) data 0.106 (0.099) loss_u loss_u 0.9316 (0.8534) acc_u 6.2500 (15.6250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [20/23] time 0.165 (0.175) data 0.088 (0.099) loss_u loss_u 0.8999 (0.8541) acc_u 9.3750 (15.7812) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.5294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 847
clean true:837
clean false:10
clean_rate:0.9881936245572609
noisy true:436
noisy false:317
after delete: len(clean_dataset) 847
after delete: len(noisy_dataset) 753
epoch [82/200] batch [5/26] time 0.178 (0.182) data 0.101 (0.105) loss_x loss_x 0.2961 (0.6882) acc_x 93.7500 (85.0000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/26] time 0.164 (0.180) data 0.088 (0.103) loss_x loss_x 0.3779 (0.6002) acc_x 87.5000 (85.6250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/26] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 1.1826 (0.6160) acc_x 68.7500 (83.7500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/26] time 0.181 (0.180) data 0.105 (0.103) loss_x loss_x 0.6968 (0.6192) acc_x 75.0000 (82.8125) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [25/26] time 0.185 (0.180) data 0.108 (0.104) loss_x loss_x 0.3113 (0.5876) acc_x 93.7500 (84.2500) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/23] time 0.177 (0.181) data 0.099 (0.104) loss_u loss_u 0.8862 (0.8751) acc_u 12.5000 (15.0000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/23] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.8926 (0.8829) acc_u 12.5000 (14.0625) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/23] time 0.174 (0.181) data 0.096 (0.104) loss_u loss_u 0.9419 (0.8874) acc_u 9.3750 (13.5417) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/23] time 0.176 (0.180) data 0.098 (0.104) loss_u loss_u 0.8325 (0.8818) acc_u 15.6250 (14.0625) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 338
confident_label rate tensor(0.5256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 841
clean true:830
clean false:11
clean_rate:0.9869203329369798
noisy true:432
noisy false:327
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 759
epoch [83/200] batch [5/26] time 0.162 (0.175) data 0.085 (0.098) loss_x loss_x 0.3291 (0.3774) acc_x 93.7500 (89.3750) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/26] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.6318 (0.4847) acc_x 81.2500 (85.3125) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/26] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.2389 (0.4911) acc_x 90.6250 (86.0417) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/26] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.5654 (0.4758) acc_x 84.3750 (86.7188) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [25/26] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.2705 (0.4679) acc_x 93.7500 (87.0000) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/23] time 0.170 (0.181) data 0.092 (0.104) loss_u loss_u 0.9033 (0.8688) acc_u 12.5000 (15.6250) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/23] time 0.169 (0.180) data 0.091 (0.103) loss_u loss_u 0.8594 (0.8675) acc_u 15.6250 (15.3125) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/23] time 0.157 (0.179) data 0.079 (0.102) loss_u loss_u 0.8579 (0.8664) acc_u 15.6250 (15.4167) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/23] time 0.176 (0.179) data 0.099 (0.102) loss_u loss_u 0.8672 (0.8643) acc_u 12.5000 (15.4688) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 837
clean true:823
clean false:14
clean_rate:0.983273596176822
noisy true:442
noisy false:321
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 763
epoch [84/200] batch [5/26] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.4526 (0.4323) acc_x 90.6250 (90.0000) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/26] time 0.174 (0.176) data 0.097 (0.099) loss_x loss_x 0.4578 (0.4746) acc_x 87.5000 (88.1250) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/26] time 0.180 (0.175) data 0.103 (0.098) loss_x loss_x 0.4619 (0.4880) acc_x 87.5000 (87.5000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/26] time 0.185 (0.177) data 0.109 (0.101) loss_x loss_x 0.4331 (0.5016) acc_x 84.3750 (86.8750) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [25/26] time 0.180 (0.177) data 0.104 (0.100) loss_x loss_x 0.1986 (0.4919) acc_x 93.7500 (87.1250) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/23] time 0.186 (0.175) data 0.109 (0.099) loss_u loss_u 0.8896 (0.8935) acc_u 12.5000 (12.5000) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/23] time 0.182 (0.176) data 0.105 (0.100) loss_u loss_u 0.9097 (0.8688) acc_u 9.3750 (15.3125) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/23] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.8716 (0.8600) acc_u 12.5000 (15.6250) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/23] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.9600 (0.8690) acc_u 3.1250 (14.5312) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 340
confident_label rate tensor(0.5181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 829
clean true:817
clean false:12
clean_rate:0.985524728588661
noisy true:443
noisy false:328
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 771
epoch [85/200] batch [5/25] time 0.167 (0.168) data 0.090 (0.091) loss_x loss_x 0.3145 (0.4072) acc_x 90.6250 (91.2500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/25] time 0.177 (0.172) data 0.099 (0.095) loss_x loss_x 0.4062 (0.4922) acc_x 87.5000 (87.1875) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/25] time 0.183 (0.175) data 0.107 (0.098) loss_x loss_x 0.7109 (0.5241) acc_x 71.8750 (85.6250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/25] time 0.169 (0.174) data 0.093 (0.097) loss_x loss_x 0.1390 (0.5074) acc_x 96.8750 (86.8750) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [25/25] time 0.178 (0.176) data 0.101 (0.099) loss_x loss_x 0.5532 (0.5129) acc_x 78.1250 (86.3750) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/24] time 0.196 (0.176) data 0.119 (0.099) loss_u loss_u 0.8687 (0.8483) acc_u 12.5000 (17.5000) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/24] time 0.187 (0.177) data 0.110 (0.100) loss_u loss_u 0.9595 (0.8638) acc_u 6.2500 (16.2500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/24] time 0.187 (0.178) data 0.110 (0.101) loss_u loss_u 0.7568 (0.8661) acc_u 25.0000 (15.6250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/24] time 0.165 (0.179) data 0.088 (0.102) loss_u loss_u 0.9688 (0.8711) acc_u 3.1250 (14.6875) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 337
confident_label rate tensor(0.5238, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 838
clean true:824
clean false:14
clean_rate:0.9832935560859188
noisy true:439
noisy false:323
after delete: len(clean_dataset) 838
after delete: len(noisy_dataset) 762
epoch [86/200] batch [5/26] time 0.194 (0.184) data 0.117 (0.107) loss_x loss_x 0.4363 (0.3738) acc_x 81.2500 (90.6250) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/26] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.2502 (0.4826) acc_x 93.7500 (87.1875) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/26] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.1302 (0.5820) acc_x 96.8750 (84.7917) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/26] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.3975 (0.5533) acc_x 84.3750 (85.3125) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [25/26] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.3547 (0.5323) acc_x 93.7500 (85.6250) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/23] time 0.179 (0.182) data 0.101 (0.105) loss_u loss_u 0.8125 (0.8393) acc_u 18.7500 (17.5000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/23] time 0.175 (0.182) data 0.098 (0.105) loss_u loss_u 0.8604 (0.8452) acc_u 15.6250 (17.1875) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/23] time 0.166 (0.181) data 0.089 (0.104) loss_u loss_u 0.8413 (0.8544) acc_u 15.6250 (16.0417) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/23] time 0.161 (0.180) data 0.084 (0.103) loss_u loss_u 0.8315 (0.8616) acc_u 18.7500 (15.1562) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 338
confident_label rate tensor(0.5288, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 846
clean true:837
clean false:9
clean_rate:0.9893617021276596
noisy true:425
noisy false:329
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 754
epoch [87/200] batch [5/26] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.2722 (0.5438) acc_x 93.7500 (86.8750) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/26] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.4285 (0.4553) acc_x 96.8750 (89.3750) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/26] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.3264 (0.4512) acc_x 93.7500 (89.1667) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/26] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.5112 (0.4942) acc_x 87.5000 (87.8125) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [25/26] time 0.178 (0.184) data 0.102 (0.107) loss_x loss_x 0.2378 (0.4986) acc_x 90.6250 (87.5000) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/23] time 0.176 (0.182) data 0.098 (0.105) loss_u loss_u 0.8540 (0.8697) acc_u 15.6250 (15.6250) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/23] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.7700 (0.8684) acc_u 25.0000 (15.3125) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/23] time 0.191 (0.182) data 0.113 (0.105) loss_u loss_u 0.9087 (0.8603) acc_u 9.3750 (16.0417) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/23] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.9595 (0.8743) acc_u 3.1250 (14.3750) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.5150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 824
clean true:809
clean false:15
clean_rate:0.9817961165048543
noisy true:420
noisy false:356
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 776
epoch [88/200] batch [5/25] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.2778 (0.3030) acc_x 90.6250 (91.8750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/25] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.3455 (0.3795) acc_x 93.7500 (90.0000) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/25] time 0.171 (0.182) data 0.094 (0.105) loss_x loss_x 0.6514 (0.4566) acc_x 81.2500 (87.5000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/25] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.7383 (0.4837) acc_x 81.2500 (87.0312) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [25/25] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.7769 (0.5305) acc_x 78.1250 (85.7500) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/24] time 0.185 (0.181) data 0.108 (0.105) loss_u loss_u 0.8394 (0.8609) acc_u 18.7500 (16.2500) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/24] time 0.189 (0.182) data 0.113 (0.105) loss_u loss_u 0.8418 (0.8463) acc_u 18.7500 (17.1875) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/24] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8140 (0.8426) acc_u 18.7500 (17.5000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/24] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.9219 (0.8414) acc_u 9.3750 (17.8125) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.5213, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 834
clean true:822
clean false:12
clean_rate:0.9856115107913669
noisy true:412
noisy false:354
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 766
epoch [89/200] batch [5/26] time 0.185 (0.188) data 0.109 (0.112) loss_x loss_x 0.3840 (0.4851) acc_x 87.5000 (86.2500) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/26] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.2106 (0.5044) acc_x 93.7500 (85.9375) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/26] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.4690 (0.4946) acc_x 90.6250 (86.2500) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/26] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.2375 (0.5027) acc_x 90.6250 (86.5625) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [25/26] time 0.178 (0.185) data 0.102 (0.109) loss_x loss_x 0.2927 (0.5000) acc_x 96.8750 (86.3750) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/23] time 0.178 (0.184) data 0.101 (0.108) loss_u loss_u 0.8232 (0.8356) acc_u 21.8750 (18.7500) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/23] time 0.159 (0.181) data 0.082 (0.105) loss_u loss_u 0.8369 (0.8618) acc_u 15.6250 (15.9375) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/23] time 0.190 (0.180) data 0.112 (0.104) loss_u loss_u 0.7788 (0.8603) acc_u 25.0000 (16.0417) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/23] time 0.186 (0.181) data 0.110 (0.104) loss_u loss_u 0.9038 (0.8598) acc_u 6.2500 (15.6250) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.5281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 845
clean true:835
clean false:10
clean_rate:0.9881656804733728
noisy true:438
noisy false:317
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 755
epoch [90/200] batch [5/26] time 0.160 (0.175) data 0.083 (0.097) loss_x loss_x 0.6685 (0.5104) acc_x 87.5000 (85.6250) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/26] time 0.162 (0.170) data 0.086 (0.093) loss_x loss_x 0.4800 (0.6036) acc_x 87.5000 (85.3125) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/26] time 0.162 (0.171) data 0.085 (0.093) loss_x loss_x 0.3521 (0.5616) acc_x 87.5000 (85.4167) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/26] time 0.181 (0.173) data 0.103 (0.095) loss_x loss_x 0.4106 (0.5372) acc_x 93.7500 (86.2500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [25/26] time 0.181 (0.175) data 0.104 (0.097) loss_x loss_x 0.6689 (0.5392) acc_x 87.5000 (86.5000) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/23] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.7563 (0.8510) acc_u 31.2500 (16.8750) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/23] time 0.181 (0.177) data 0.103 (0.100) loss_u loss_u 0.9546 (0.8698) acc_u 6.2500 (15.0000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/23] time 0.180 (0.178) data 0.104 (0.100) loss_u loss_u 0.8999 (0.8735) acc_u 9.3750 (14.3750) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/23] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.8135 (0.8722) acc_u 18.7500 (14.3750) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 835
clean true:825
clean false:10
clean_rate:0.9880239520958084
noisy true:439
noisy false:326
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 765
epoch [91/200] batch [5/26] time 0.182 (0.184) data 0.105 (0.108) loss_x loss_x 0.3047 (0.5398) acc_x 96.8750 (86.8750) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/26] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.3560 (0.4501) acc_x 90.6250 (89.0625) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/26] time 0.182 (0.183) data 0.104 (0.106) loss_x loss_x 0.2983 (0.5055) acc_x 96.8750 (88.1250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/26] time 0.174 (0.181) data 0.097 (0.104) loss_x loss_x 1.0684 (0.5128) acc_x 65.6250 (86.7188) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [25/26] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 0.8550 (0.4993) acc_x 78.1250 (86.7500) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/23] time 0.179 (0.182) data 0.102 (0.105) loss_u loss_u 0.9292 (0.8942) acc_u 6.2500 (11.8750) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/23] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.8521 (0.8640) acc_u 18.7500 (15.3125) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/23] time 0.166 (0.180) data 0.090 (0.103) loss_u loss_u 0.9478 (0.8747) acc_u 3.1250 (14.1667) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/23] time 0.166 (0.179) data 0.089 (0.102) loss_u loss_u 0.7642 (0.8612) acc_u 25.0000 (15.3125) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.5331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 853
clean true:841
clean false:12
clean_rate:0.9859320046893317
noisy true:417
noisy false:330
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 747
epoch [92/200] batch [5/26] time 0.186 (0.189) data 0.109 (0.112) loss_x loss_x 0.7559 (0.4562) acc_x 87.5000 (90.6250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/26] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 0.8296 (0.5056) acc_x 87.5000 (89.3750) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/26] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.5371 (0.4784) acc_x 87.5000 (89.7917) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/26] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.4348 (0.4941) acc_x 87.5000 (88.7500) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [25/26] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.4583 (0.5137) acc_x 87.5000 (88.2500) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/23] time 0.187 (0.184) data 0.110 (0.107) loss_u loss_u 0.8584 (0.8475) acc_u 15.6250 (18.1250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/23] time 0.194 (0.185) data 0.117 (0.107) loss_u loss_u 0.8452 (0.8679) acc_u 21.8750 (16.5625) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/23] time 0.193 (0.184) data 0.116 (0.107) loss_u loss_u 0.8809 (0.8726) acc_u 15.6250 (15.8333) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/23] time 0.188 (0.184) data 0.110 (0.107) loss_u loss_u 0.8721 (0.8790) acc_u 15.6250 (14.6875) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.5281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 845
clean true:833
clean false:12
clean_rate:0.9857988165680474
noisy true:451
noisy false:304
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 755
epoch [93/200] batch [5/26] time 0.188 (0.183) data 0.111 (0.106) loss_x loss_x 0.2812 (0.4063) acc_x 90.6250 (88.7500) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/26] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.3801 (0.4518) acc_x 90.6250 (88.4375) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/26] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.6597 (0.4853) acc_x 84.3750 (87.0833) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/26] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.5464 (0.4758) acc_x 84.3750 (87.0312) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [25/26] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.8389 (0.4904) acc_x 78.1250 (86.8750) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/23] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.8413 (0.8831) acc_u 18.7500 (13.1250) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/23] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9146 (0.8821) acc_u 9.3750 (14.0625) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/23] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.9077 (0.8810) acc_u 9.3750 (13.9583) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/23] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8154 (0.8773) acc_u 21.8750 (14.2188) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.5294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 847
clean true:831
clean false:16
clean_rate:0.9811097992916175
noisy true:419
noisy false:334
after delete: len(clean_dataset) 847
after delete: len(noisy_dataset) 753
epoch [94/200] batch [5/26] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.6597 (0.4356) acc_x 81.2500 (86.8750) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/26] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.3125 (0.4296) acc_x 90.6250 (87.5000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/26] time 0.186 (0.179) data 0.110 (0.103) loss_x loss_x 0.8760 (0.5396) acc_x 81.2500 (85.0000) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/26] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.3054 (0.5246) acc_x 93.7500 (85.6250) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [25/26] time 0.189 (0.181) data 0.112 (0.104) loss_x loss_x 0.3496 (0.5167) acc_x 87.5000 (85.6250) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/23] time 0.187 (0.182) data 0.109 (0.105) loss_u loss_u 0.8623 (0.8754) acc_u 15.6250 (13.7500) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/23] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.8623 (0.8762) acc_u 12.5000 (13.4375) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/23] time 0.180 (0.182) data 0.104 (0.105) loss_u loss_u 0.8159 (0.8621) acc_u 21.8750 (14.7917) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/23] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8901 (0.8650) acc_u 12.5000 (14.5312) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.5263, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 842
clean true:827
clean false:15
clean_rate:0.982185273159145
noisy true:444
noisy false:314
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 758
epoch [95/200] batch [5/26] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.3423 (0.4960) acc_x 87.5000 (88.1250) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/26] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.3010 (0.4616) acc_x 93.7500 (89.0625) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/26] time 0.178 (0.184) data 0.101 (0.107) loss_x loss_x 0.3440 (0.4916) acc_x 87.5000 (88.1250) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/26] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.4438 (0.5140) acc_x 90.6250 (87.6562) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [25/26] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.8340 (0.5171) acc_x 84.3750 (87.5000) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/23] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9263 (0.8665) acc_u 6.2500 (14.3750) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/23] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.8809 (0.8502) acc_u 12.5000 (16.5625) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/23] time 0.184 (0.183) data 0.108 (0.106) loss_u loss_u 0.8896 (0.8650) acc_u 12.5000 (14.7917) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/23] time 0.182 (0.182) data 0.103 (0.105) loss_u loss_u 0.8945 (0.8644) acc_u 9.3750 (15.1562) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.5188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 830
clean true:819
clean false:11
clean_rate:0.9867469879518073
noisy true:430
noisy false:340
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 770
epoch [96/200] batch [5/25] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.3491 (0.4314) acc_x 93.7500 (86.2500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/25] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.4363 (0.4685) acc_x 90.6250 (86.8750) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/25] time 0.161 (0.169) data 0.084 (0.092) loss_x loss_x 0.6938 (0.4740) acc_x 81.2500 (86.6667) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/25] time 0.156 (0.167) data 0.079 (0.090) loss_x loss_x 0.6616 (0.5113) acc_x 84.3750 (85.7812) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [25/25] time 0.184 (0.170) data 0.107 (0.093) loss_x loss_x 0.2360 (0.4850) acc_x 93.7500 (86.6250) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/24] time 0.170 (0.171) data 0.092 (0.094) loss_u loss_u 0.8550 (0.8822) acc_u 15.6250 (11.8750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/24] time 0.179 (0.173) data 0.101 (0.096) loss_u loss_u 0.8975 (0.8882) acc_u 9.3750 (11.8750) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/24] time 0.182 (0.173) data 0.104 (0.096) loss_u loss_u 0.8672 (0.8710) acc_u 15.6250 (14.1667) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/24] time 0.172 (0.173) data 0.094 (0.096) loss_u loss_u 0.8130 (0.8580) acc_u 21.8750 (15.9375) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 345
confident_label rate tensor(0.5350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 856
clean true:844
clean false:12
clean_rate:0.985981308411215
noisy true:411
noisy false:333
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 744
epoch [97/200] batch [5/26] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.2922 (0.5984) acc_x 93.7500 (86.8750) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/26] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.3584 (0.5527) acc_x 87.5000 (86.2500) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/26] time 0.189 (0.183) data 0.111 (0.107) loss_x loss_x 0.4429 (0.5370) acc_x 87.5000 (86.6667) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/26] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.4307 (0.5352) acc_x 90.6250 (87.0312) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [25/26] time 0.195 (0.184) data 0.119 (0.107) loss_x loss_x 0.7939 (0.5520) acc_x 75.0000 (86.3750) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/23] time 0.176 (0.183) data 0.098 (0.106) loss_u loss_u 0.8276 (0.8514) acc_u 21.8750 (17.5000) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/23] time 0.172 (0.182) data 0.095 (0.105) loss_u loss_u 0.8418 (0.8633) acc_u 18.7500 (15.9375) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/23] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9233 (0.8584) acc_u 9.3750 (16.2500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/23] time 0.169 (0.180) data 0.092 (0.103) loss_u loss_u 0.7397 (0.8573) acc_u 28.1250 (15.9375) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 321
confident_label rate tensor(0.5275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 844
clean true:832
clean false:12
clean_rate:0.985781990521327
noisy true:447
noisy false:309
after delete: len(clean_dataset) 844
after delete: len(noisy_dataset) 756
epoch [98/200] batch [5/26] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.9980 (0.4036) acc_x 71.8750 (88.7500) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/26] time 0.174 (0.180) data 0.097 (0.103) loss_x loss_x 0.5625 (0.4489) acc_x 78.1250 (87.5000) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/26] time 0.181 (0.180) data 0.105 (0.103) loss_x loss_x 0.3406 (0.4291) acc_x 93.7500 (87.9167) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/26] time 0.187 (0.181) data 0.110 (0.104) loss_x loss_x 0.7266 (0.4368) acc_x 87.5000 (87.9688) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [25/26] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.5786 (0.4543) acc_x 81.2500 (87.6250) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/23] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.7451 (0.8052) acc_u 28.1250 (20.6250) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/23] time 0.192 (0.182) data 0.115 (0.105) loss_u loss_u 0.9316 (0.8439) acc_u 6.2500 (16.5625) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/23] time 0.178 (0.182) data 0.100 (0.105) loss_u loss_u 0.9688 (0.8650) acc_u 3.1250 (14.5833) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/23] time 0.165 (0.180) data 0.088 (0.103) loss_u loss_u 0.8237 (0.8551) acc_u 18.7500 (15.3125) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 318
confident_label rate tensor(0.5450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 872
clean true:859
clean false:13
clean_rate:0.9850917431192661
noisy true:423
noisy false:305
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 728
epoch [99/200] batch [5/27] time 0.179 (0.183) data 0.103 (0.106) loss_x loss_x 0.4739 (0.4223) acc_x 93.7500 (92.5000) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/27] time 0.179 (0.183) data 0.103 (0.106) loss_x loss_x 0.2866 (0.4538) acc_x 93.7500 (89.6875) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [15/27] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.2783 (0.4600) acc_x 90.6250 (88.9583) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/27] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.4795 (0.4754) acc_x 93.7500 (88.9062) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [25/27] time 0.179 (0.183) data 0.103 (0.107) loss_x loss_x 0.6758 (0.4967) acc_x 78.1250 (87.7500) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/22] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.8418 (0.8473) acc_u 18.7500 (18.7500) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/22] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.9683 (0.8810) acc_u 3.1250 (14.6875) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/22] time 0.189 (0.183) data 0.111 (0.107) loss_u loss_u 0.9316 (0.8841) acc_u 6.2500 (13.9583) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/22] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.9292 (0.8918) acc_u 9.3750 (13.1250) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.5175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 828
clean true:813
clean false:15
clean_rate:0.9818840579710145
noisy true:420
noisy false:352
all clean rate:  [0.9811715481171548, 0.979557069846678, 0.9971056439942113, 0.9959239130434783, 0.9903047091412742, 0.9903846153846154, 0.99055330634278, 0.9930939226519337, 0.9957983193277311, 0.9934296977660972, 0.9932614555256065, 0.994729907773386, 0.9973118279569892, 0.9947437582128777, 0.993514915693904, 0.9934980494148244, 0.9947643979057592, 0.9962121212121212, 0.9910714285714286, 0.9883419689119171, 0.9924242424242424, 0.993581514762516, 0.9961734693877551, 0.9934383202099738, 0.9936948297604036, 0.9898089171974522, 0.990990990990991, 0.9910600255427842, 0.9936467598475223, 0.9910600255427842, 0.9911616161616161, 0.9910828025477707, 0.989937106918239, 0.9922480620155039, 0.9897435897435898, 0.9826946847960445, 0.9878197320341048, 0.9888475836431226, 0.9874371859296482, 0.9911504424778761, 0.9876237623762376, 0.993734335839599, 0.9901234567901235, 0.9914841849148418, 0.9874529485570891, 0.9901840490797545, 0.991304347826087, 0.988929889298893, 0.98625, 0.9914110429447853, 0.9865689865689866, 0.9939024390243902, 0.9913473423980222, 0.9938875305623472, 0.9888613861386139, 0.9901840490797545, 0.9878787878787879, 0.9903264812575574, 0.9867469879518073, 0.98531211750306, 0.991442542787286, 0.9876084262701363, 0.9902912621359223, 0.9891172914147521, 0.9887920298879203, 0.9866989117291415, 0.9890377588306942, 0.9913473423980222, 0.9887920298879203, 0.9877750611246944, 0.986857825567503, 0.986810551558753, 0.984468339307049, 0.9843937575030012, 0.9846335697399528, 0.9902676399026764, 0.9878197320341048, 0.9871645274212368, 0.9878787878787879, 0.9869358669833729, 0.9881093935790726, 0.9881936245572609, 0.9869203329369798, 0.983273596176822, 0.985524728588661, 0.9832935560859188, 0.9893617021276596, 0.9817961165048543, 0.9856115107913669, 0.9881656804733728, 0.9880239520958084, 0.9859320046893317, 0.9857988165680474, 0.9811097992916175, 0.982185273159145, 0.9867469879518073, 0.985981308411215, 0.985781990521327, 0.9850917431192661, 0.9818840579710145]
after delete: len(clean_dataset) 828
after delete: len(noisy_dataset) 772
epoch [100/200] batch [5/25] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.2761 (0.3739) acc_x 87.5000 (88.1250) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/25] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.5034 (0.5390) acc_x 87.5000 (86.8750) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/25] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.3315 (0.4751) acc_x 90.6250 (87.7083) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/25] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.7402 (0.5154) acc_x 81.2500 (87.1875) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [25/25] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.3945 (0.5059) acc_x 93.7500 (87.2500) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/24] time 0.183 (0.182) data 0.107 (0.106) loss_u loss_u 0.8525 (0.8742) acc_u 15.6250 (14.3750) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/24] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.8452 (0.8838) acc_u 18.7500 (13.4375) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/24] time 0.179 (0.183) data 0.101 (0.106) loss_u loss_u 0.8179 (0.8700) acc_u 18.7500 (14.3750) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/24] time 0.164 (0.182) data 0.088 (0.106) loss_u loss_u 0.8896 (0.8691) acc_u 12.5000 (14.8438) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.5375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 860
clean true:846
clean false:14
clean_rate:0.9837209302325581
noisy true:430
noisy false:310
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 740
epoch [101/200] batch [5/26] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.5156 (0.5336) acc_x 84.3750 (84.3750) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/26] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.5869 (0.6215) acc_x 75.0000 (82.5000) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/26] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.6626 (0.5725) acc_x 87.5000 (84.7917) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/26] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.3518 (0.5378) acc_x 90.6250 (85.4688) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [25/26] time 0.186 (0.183) data 0.109 (0.107) loss_x loss_x 0.4658 (0.5095) acc_x 87.5000 (86.3750) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/23] time 0.187 (0.185) data 0.110 (0.108) loss_u loss_u 0.8774 (0.8871) acc_u 12.5000 (14.3750) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/23] time 0.184 (0.185) data 0.107 (0.109) loss_u loss_u 0.9194 (0.8688) acc_u 9.3750 (16.5625) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/23] time 0.181 (0.185) data 0.105 (0.109) loss_u loss_u 0.8745 (0.8659) acc_u 15.6250 (16.4583) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/23] time 0.179 (0.185) data 0.103 (0.108) loss_u loss_u 0.8252 (0.8707) acc_u 18.7500 (15.3125) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 333
confident_label rate tensor(0.5288, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 846
clean true:836
clean false:10
clean_rate:0.9881796690307328
noisy true:431
noisy false:323
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 754
epoch [102/200] batch [5/26] time 0.176 (0.180) data 0.100 (0.104) loss_x loss_x 0.4976 (0.5457) acc_x 90.6250 (83.1250) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/26] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.4968 (0.5070) acc_x 87.5000 (85.6250) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/26] time 0.176 (0.182) data 0.099 (0.106) loss_x loss_x 0.6035 (0.5432) acc_x 78.1250 (84.5833) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/26] time 0.178 (0.181) data 0.102 (0.104) loss_x loss_x 0.4934 (0.5917) acc_x 87.5000 (83.7500) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [25/26] time 0.182 (0.181) data 0.104 (0.104) loss_x loss_x 0.8447 (0.6032) acc_x 81.2500 (83.7500) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/23] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.8569 (0.8801) acc_u 18.7500 (14.3750) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/23] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.9160 (0.8710) acc_u 12.5000 (15.0000) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/23] time 0.188 (0.181) data 0.110 (0.104) loss_u loss_u 0.8291 (0.8740) acc_u 21.8750 (14.5833) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/23] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9009 (0.8713) acc_u 15.6250 (15.1562) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.5306, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 849
clean true:839
clean false:10
clean_rate:0.9882214369846879
noisy true:434
noisy false:317
after delete: len(clean_dataset) 849
after delete: len(noisy_dataset) 751
epoch [103/200] batch [5/26] time 0.168 (0.179) data 0.091 (0.103) loss_x loss_x 0.1627 (0.4314) acc_x 93.7500 (88.1250) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/26] time 0.161 (0.172) data 0.085 (0.095) loss_x loss_x 0.2045 (0.3852) acc_x 96.8750 (89.3750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/26] time 0.174 (0.173) data 0.097 (0.096) loss_x loss_x 0.4241 (0.3899) acc_x 84.3750 (89.1667) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/26] time 0.183 (0.175) data 0.106 (0.099) loss_x loss_x 0.4910 (0.3768) acc_x 84.3750 (89.8438) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [25/26] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.7046 (0.4068) acc_x 78.1250 (88.7500) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/23] time 0.178 (0.178) data 0.102 (0.101) loss_u loss_u 0.8755 (0.8827) acc_u 12.5000 (13.7500) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/23] time 0.182 (0.178) data 0.105 (0.102) loss_u loss_u 0.8228 (0.8547) acc_u 18.7500 (16.2500) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/23] time 0.179 (0.179) data 0.102 (0.102) loss_u loss_u 0.8638 (0.8549) acc_u 18.7500 (16.2500) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/23] time 0.175 (0.178) data 0.097 (0.101) loss_u loss_u 0.9424 (0.8570) acc_u 6.2500 (15.7812) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.5225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 836
clean true:827
clean false:9
clean_rate:0.9892344497607656
noisy true:432
noisy false:332
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 764
epoch [104/200] batch [5/26] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.5957 (0.5406) acc_x 90.6250 (89.3750) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/26] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.2321 (0.4575) acc_x 93.7500 (89.6875) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/26] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 1.0205 (0.4847) acc_x 71.8750 (87.9167) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/26] time 0.171 (0.179) data 0.095 (0.102) loss_x loss_x 0.4519 (0.4559) acc_x 87.5000 (88.2812) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [25/26] time 0.162 (0.176) data 0.085 (0.100) loss_x loss_x 0.4922 (0.4537) acc_x 90.6250 (88.6250) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/23] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.8486 (0.8486) acc_u 15.6250 (17.5000) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/23] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.9214 (0.8600) acc_u 9.3750 (16.5625) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/23] time 0.180 (0.178) data 0.103 (0.101) loss_u loss_u 0.9077 (0.8677) acc_u 9.3750 (15.2083) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/23] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.8184 (0.8608) acc_u 18.7500 (15.4688) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.5431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 869
clean true:857
clean false:12
clean_rate:0.9861910241657077
noisy true:417
noisy false:314
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 731
epoch [105/200] batch [5/27] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.6831 (0.4776) acc_x 75.0000 (85.0000) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/27] time 0.188 (0.178) data 0.112 (0.102) loss_x loss_x 0.5034 (0.4408) acc_x 87.5000 (86.8750) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [15/27] time 0.180 (0.179) data 0.104 (0.102) loss_x loss_x 0.4836 (0.4781) acc_x 87.5000 (86.2500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/27] time 0.167 (0.177) data 0.091 (0.101) loss_x loss_x 0.6064 (0.4839) acc_x 84.3750 (86.2500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [25/27] time 0.180 (0.177) data 0.103 (0.101) loss_x loss_x 0.5015 (0.4705) acc_x 84.3750 (86.5000) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/22] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9385 (0.8642) acc_u 6.2500 (15.6250) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/22] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.8159 (0.8716) acc_u 18.7500 (14.0625) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/22] time 0.181 (0.179) data 0.104 (0.103) loss_u loss_u 0.8984 (0.8785) acc_u 9.3750 (13.3333) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/22] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.8760 (0.8815) acc_u 15.6250 (13.2812) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 322
confident_label rate tensor(0.5337, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 854
clean true:840
clean false:14
clean_rate:0.9836065573770492
noisy true:438
noisy false:308
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 746
epoch [106/200] batch [5/26] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.5908 (0.5004) acc_x 81.2500 (86.2500) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/26] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.1842 (0.4266) acc_x 96.8750 (89.3750) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/26] time 0.189 (0.183) data 0.112 (0.107) loss_x loss_x 0.8281 (0.4681) acc_x 78.1250 (88.1250) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [20/26] time 0.178 (0.187) data 0.102 (0.110) loss_x loss_x 0.3457 (0.4478) acc_x 93.7500 (88.5938) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [25/26] time 0.165 (0.184) data 0.088 (0.108) loss_x loss_x 0.2389 (0.4445) acc_x 96.8750 (88.6250) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/23] time 0.181 (0.183) data 0.104 (0.107) loss_u loss_u 0.8721 (0.8102) acc_u 12.5000 (20.0000) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/23] time 0.172 (0.183) data 0.096 (0.106) loss_u loss_u 0.9331 (0.8528) acc_u 6.2500 (15.3125) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/23] time 0.173 (0.182) data 0.095 (0.105) loss_u loss_u 0.8237 (0.8515) acc_u 15.6250 (15.6250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/23] time 0.178 (0.181) data 0.102 (0.104) loss_u loss_u 0.8999 (0.8568) acc_u 12.5000 (15.4688) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 334
confident_label rate tensor(0.5362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 858
clean true:844
clean false:14
clean_rate:0.9836829836829837
noisy true:422
noisy false:320
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 742
epoch [107/200] batch [5/26] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.2122 (0.3840) acc_x 96.8750 (91.8750) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/26] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.3855 (0.4065) acc_x 87.5000 (90.0000) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/26] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.0829 (0.4175) acc_x 93.7500 (89.7917) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/26] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.2144 (0.4146) acc_x 93.7500 (89.3750) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [25/26] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.3767 (0.4349) acc_x 90.6250 (89.0000) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/23] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.7905 (0.8802) acc_u 25.0000 (15.6250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/23] time 0.179 (0.182) data 0.103 (0.105) loss_u loss_u 0.8877 (0.8853) acc_u 12.5000 (14.3750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/23] time 0.188 (0.182) data 0.111 (0.106) loss_u loss_u 0.9961 (0.8841) acc_u 0.0000 (14.1667) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/23] time 0.182 (0.182) data 0.105 (0.106) loss_u loss_u 0.8511 (0.8805) acc_u 15.6250 (14.0625) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.5337, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 854
clean true:845
clean false:9
clean_rate:0.9894613583138173
noisy true:432
noisy false:314
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 746
epoch [108/200] batch [5/26] time 0.180 (0.183) data 0.103 (0.107) loss_x loss_x 0.4365 (0.4242) acc_x 87.5000 (87.5000) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/26] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.8892 (0.4407) acc_x 75.0000 (87.1875) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/26] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.4651 (0.4559) acc_x 90.6250 (87.2917) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/26] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.2498 (0.4283) acc_x 90.6250 (88.5938) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [25/26] time 0.184 (0.182) data 0.108 (0.105) loss_x loss_x 0.3704 (0.4360) acc_x 90.6250 (88.1250) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/23] time 0.182 (0.181) data 0.105 (0.105) loss_u loss_u 0.8506 (0.8703) acc_u 15.6250 (13.7500) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/23] time 0.160 (0.181) data 0.084 (0.105) loss_u loss_u 0.8716 (0.8787) acc_u 15.6250 (12.8125) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/23] time 0.181 (0.181) data 0.104 (0.105) loss_u loss_u 0.8599 (0.8749) acc_u 15.6250 (13.7500) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/23] time 0.185 (0.181) data 0.108 (0.105) loss_u loss_u 0.8940 (0.8790) acc_u 12.5000 (13.7500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.5263, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 842
clean true:833
clean false:9
clean_rate:0.9893111638954869
noisy true:441
noisy false:317
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 758
epoch [109/200] batch [5/26] time 0.185 (0.182) data 0.108 (0.104) loss_x loss_x 0.6934 (0.4982) acc_x 84.3750 (86.8750) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/26] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.7114 (0.5442) acc_x 84.3750 (87.5000) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/26] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.2966 (0.4781) acc_x 93.7500 (88.5417) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/26] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.1418 (0.4581) acc_x 100.0000 (89.0625) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [25/26] time 0.177 (0.180) data 0.100 (0.103) loss_x loss_x 0.3230 (0.4486) acc_x 90.6250 (89.1250) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/23] time 0.177 (0.179) data 0.099 (0.102) loss_u loss_u 0.8330 (0.8827) acc_u 18.7500 (15.6250) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/23] time 0.173 (0.179) data 0.096 (0.102) loss_u loss_u 0.7871 (0.8653) acc_u 21.8750 (15.6250) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/23] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.9009 (0.8654) acc_u 9.3750 (15.0000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/23] time 0.173 (0.179) data 0.095 (0.102) loss_u loss_u 0.8574 (0.8576) acc_u 15.6250 (16.5625) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.5281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 845
clean true:833
clean false:12
clean_rate:0.9857988165680474
noisy true:426
noisy false:329
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 755
epoch [110/200] batch [5/26] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.3579 (0.4531) acc_x 90.6250 (89.3750) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/26] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 0.5371 (0.4942) acc_x 78.1250 (86.5625) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/26] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.8706 (0.5242) acc_x 78.1250 (86.2500) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [20/26] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.4143 (0.5231) acc_x 87.5000 (86.2500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [25/26] time 0.192 (0.186) data 0.114 (0.109) loss_x loss_x 0.5884 (0.5134) acc_x 78.1250 (86.0000) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/23] time 0.179 (0.186) data 0.102 (0.109) loss_u loss_u 0.7583 (0.8517) acc_u 28.1250 (18.7500) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/23] time 0.179 (0.185) data 0.102 (0.108) loss_u loss_u 0.7607 (0.8494) acc_u 25.0000 (17.8125) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/23] time 0.180 (0.185) data 0.103 (0.108) loss_u loss_u 0.8442 (0.8460) acc_u 18.7500 (18.1250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/23] time 0.187 (0.185) data 0.110 (0.108) loss_u loss_u 0.9126 (0.8536) acc_u 12.5000 (17.0312) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 831
clean true:819
clean false:12
clean_rate:0.9855595667870036
noisy true:433
noisy false:336
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 769
epoch [111/200] batch [5/25] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.6216 (0.4428) acc_x 81.2500 (88.7500) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/25] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.5493 (0.5134) acc_x 81.2500 (84.3750) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/25] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.2471 (0.4985) acc_x 90.6250 (86.0417) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/25] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.7388 (0.5298) acc_x 81.2500 (85.7812) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [25/25] time 0.190 (0.182) data 0.114 (0.106) loss_x loss_x 0.5537 (0.5769) acc_x 87.5000 (84.7500) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/24] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.8511 (0.8658) acc_u 18.7500 (15.0000) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/24] time 0.173 (0.182) data 0.096 (0.105) loss_u loss_u 0.8662 (0.8628) acc_u 15.6250 (15.6250) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/24] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8682 (0.8623) acc_u 15.6250 (15.6250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/24] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8032 (0.8554) acc_u 21.8750 (16.0938) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.5337, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 854
clean true:844
clean false:10
clean_rate:0.9882903981264637
noisy true:432
noisy false:314
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 746
epoch [112/200] batch [5/26] time 0.169 (0.180) data 0.092 (0.103) loss_x loss_x 0.8320 (0.4951) acc_x 75.0000 (84.3750) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/26] time 0.185 (0.182) data 0.109 (0.105) loss_x loss_x 0.4387 (0.5136) acc_x 87.5000 (84.3750) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/26] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.2500 (0.5124) acc_x 93.7500 (85.2083) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/26] time 0.159 (0.180) data 0.082 (0.104) loss_x loss_x 0.8535 (0.5337) acc_x 84.3750 (85.7812) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [25/26] time 0.169 (0.179) data 0.093 (0.103) loss_x loss_x 0.2089 (0.5155) acc_x 96.8750 (86.2500) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/23] time 0.172 (0.177) data 0.095 (0.101) loss_u loss_u 0.9346 (0.9052) acc_u 6.2500 (10.0000) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/23] time 0.159 (0.176) data 0.081 (0.099) loss_u loss_u 0.8018 (0.8873) acc_u 21.8750 (11.8750) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/23] time 0.180 (0.175) data 0.103 (0.098) loss_u loss_u 0.8062 (0.8762) acc_u 21.8750 (12.9167) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/23] time 0.180 (0.175) data 0.103 (0.098) loss_u loss_u 0.8198 (0.8667) acc_u 18.7500 (14.0625) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.5425, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 868
clean true:855
clean false:13
clean_rate:0.9850230414746544
noisy true:429
noisy false:303
after delete: len(clean_dataset) 868
after delete: len(noisy_dataset) 732
epoch [113/200] batch [5/27] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.3611 (0.6193) acc_x 87.5000 (86.2500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/27] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.2986 (0.4465) acc_x 87.5000 (89.3750) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [15/27] time 0.179 (0.185) data 0.103 (0.109) loss_x loss_x 0.1057 (0.4320) acc_x 100.0000 (89.7917) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/27] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.3928 (0.4103) acc_x 90.6250 (90.3125) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [25/27] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.4194 (0.4371) acc_x 84.3750 (89.5000) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/22] time 0.191 (0.185) data 0.114 (0.108) loss_u loss_u 0.8311 (0.8848) acc_u 15.6250 (11.8750) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/22] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9009 (0.8703) acc_u 9.3750 (13.1250) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/22] time 0.185 (0.186) data 0.108 (0.109) loss_u loss_u 0.7910 (0.8665) acc_u 25.0000 (14.3750) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/22] time 0.185 (0.186) data 0.108 (0.109) loss_u loss_u 0.9673 (0.8766) acc_u 3.1250 (13.2812) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 312
confident_label rate tensor(0.5456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 873
clean true:859
clean false:14
clean_rate:0.983963344788087
noisy true:429
noisy false:298
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 727
epoch [114/200] batch [5/27] time 0.156 (0.170) data 0.079 (0.094) loss_x loss_x 0.6362 (0.3819) acc_x 87.5000 (94.3750) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/27] time 0.186 (0.170) data 0.109 (0.094) loss_x loss_x 0.2971 (0.3887) acc_x 87.5000 (91.5625) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/27] time 0.184 (0.175) data 0.108 (0.099) loss_x loss_x 0.3225 (0.3884) acc_x 87.5000 (90.8333) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/27] time 0.195 (0.177) data 0.119 (0.101) loss_x loss_x 0.7949 (0.4195) acc_x 78.1250 (89.6875) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [25/27] time 0.183 (0.178) data 0.107 (0.102) loss_x loss_x 0.2260 (0.4140) acc_x 96.8750 (90.3750) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/22] time 0.157 (0.178) data 0.080 (0.102) loss_u loss_u 0.8486 (0.8472) acc_u 15.6250 (16.8750) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/22] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8462 (0.8671) acc_u 18.7500 (15.3125) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/22] time 0.160 (0.175) data 0.082 (0.099) loss_u loss_u 0.8145 (0.8719) acc_u 18.7500 (14.5833) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/22] time 0.174 (0.175) data 0.097 (0.098) loss_u loss_u 0.8862 (0.8714) acc_u 15.6250 (14.8438) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 305
confident_label rate tensor(0.5375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 860
clean true:850
clean false:10
clean_rate:0.9883720930232558
noisy true:445
noisy false:295
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 740
epoch [115/200] batch [5/26] time 0.173 (0.177) data 0.095 (0.100) loss_x loss_x 0.5464 (0.4186) acc_x 90.6250 (89.3750) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/26] time 0.178 (0.178) data 0.100 (0.101) loss_x loss_x 0.5190 (0.5125) acc_x 84.3750 (86.2500) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/26] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.4512 (0.4959) acc_x 84.3750 (86.8750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/26] time 0.180 (0.176) data 0.102 (0.099) loss_x loss_x 0.3096 (0.4576) acc_x 90.6250 (87.3438) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [25/26] time 0.184 (0.177) data 0.107 (0.099) loss_x loss_x 0.3611 (0.4897) acc_x 90.6250 (87.2500) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/23] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.7891 (0.8604) acc_u 25.0000 (15.0000) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/23] time 0.186 (0.179) data 0.108 (0.101) loss_u loss_u 0.9351 (0.8746) acc_u 6.2500 (14.0625) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/23] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8257 (0.8712) acc_u 18.7500 (14.7917) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/23] time 0.181 (0.179) data 0.103 (0.102) loss_u loss_u 0.8154 (0.8677) acc_u 18.7500 (14.8438) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 319
confident_label rate tensor(0.5394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 863
clean true:852
clean false:11
clean_rate:0.9872537659327926
noisy true:429
noisy false:308
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 737
epoch [116/200] batch [5/26] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.4639 (0.4993) acc_x 87.5000 (85.6250) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/26] time 0.178 (0.180) data 0.102 (0.103) loss_x loss_x 0.4001 (0.5167) acc_x 93.7500 (86.8750) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/26] time 0.181 (0.180) data 0.104 (0.104) loss_x loss_x 0.5396 (0.5298) acc_x 84.3750 (86.0417) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/26] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.5005 (0.5131) acc_x 90.6250 (86.2500) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [25/26] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.7432 (0.5149) acc_x 81.2500 (85.8750) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/23] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.9087 (0.8944) acc_u 9.3750 (11.8750) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/23] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.8833 (0.8843) acc_u 15.6250 (13.7500) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/23] time 0.212 (0.183) data 0.135 (0.106) loss_u loss_u 0.9351 (0.8833) acc_u 6.2500 (13.1250) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/23] time 0.176 (0.182) data 0.098 (0.105) loss_u loss_u 0.8877 (0.8806) acc_u 15.6250 (13.5938) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 848
clean true:837
clean false:11
clean_rate:0.9870283018867925
noisy true:428
noisy false:324
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 752
epoch [117/200] batch [5/26] time 0.173 (0.173) data 0.097 (0.097) loss_x loss_x 0.8716 (0.6146) acc_x 71.8750 (84.3750) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/26] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.1639 (0.5203) acc_x 96.8750 (85.3125) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/26] time 0.180 (0.179) data 0.104 (0.102) loss_x loss_x 0.5479 (0.5697) acc_x 90.6250 (84.7917) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/26] time 0.177 (0.180) data 0.101 (0.103) loss_x loss_x 0.5303 (0.5538) acc_x 87.5000 (85.7812) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [25/26] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.2729 (0.5342) acc_x 93.7500 (86.1250) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/23] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.9287 (0.9051) acc_u 6.2500 (10.0000) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/23] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.7983 (0.8854) acc_u 21.8750 (12.1875) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/23] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9268 (0.8538) acc_u 12.5000 (16.6667) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/23] time 0.177 (0.181) data 0.101 (0.104) loss_u loss_u 0.9004 (0.8618) acc_u 12.5000 (15.7812) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 317
confident_label rate tensor(0.5456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 873
clean true:860
clean false:13
clean_rate:0.9851088201603666
noisy true:423
noisy false:304
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 727
epoch [118/200] batch [5/27] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.8232 (0.5340) acc_x 71.8750 (84.3750) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/27] time 0.165 (0.174) data 0.089 (0.097) loss_x loss_x 0.4783 (0.5546) acc_x 90.6250 (85.3125) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/27] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.6895 (0.5603) acc_x 84.3750 (84.7917) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/27] time 0.180 (0.175) data 0.103 (0.098) loss_x loss_x 0.8086 (0.5547) acc_x 84.3750 (85.4688) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [25/27] time 0.179 (0.175) data 0.102 (0.099) loss_x loss_x 0.3149 (0.5232) acc_x 90.6250 (86.3750) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/22] time 0.182 (0.177) data 0.104 (0.101) loss_u loss_u 0.9282 (0.9079) acc_u 6.2500 (10.0000) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/22] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.9307 (0.9093) acc_u 9.3750 (10.0000) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/22] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.8838 (0.9044) acc_u 12.5000 (10.6250) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/22] time 0.179 (0.179) data 0.102 (0.102) loss_u loss_u 0.8755 (0.8888) acc_u 15.6250 (12.3438) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 855
clean true:846
clean false:9
clean_rate:0.9894736842105263
noisy true:444
noisy false:301
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 745
epoch [119/200] batch [5/26] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 0.2605 (0.5231) acc_x 90.6250 (86.2500) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/26] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.4885 (0.4513) acc_x 87.5000 (87.5000) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/26] time 0.177 (0.174) data 0.101 (0.097) loss_x loss_x 0.1203 (0.4613) acc_x 100.0000 (88.1250) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/26] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.5093 (0.4809) acc_x 90.6250 (88.4375) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [25/26] time 0.180 (0.181) data 0.102 (0.104) loss_x loss_x 0.3904 (0.4644) acc_x 90.6250 (88.5000) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/23] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.8384 (0.8794) acc_u 15.6250 (12.5000) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/23] time 0.179 (0.181) data 0.102 (0.104) loss_u loss_u 0.8745 (0.8778) acc_u 15.6250 (12.8125) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/23] time 0.215 (0.183) data 0.137 (0.105) loss_u loss_u 0.8306 (0.8714) acc_u 18.7500 (13.7500) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/23] time 0.183 (0.183) data 0.107 (0.105) loss_u loss_u 0.8506 (0.8715) acc_u 15.6250 (13.9062) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 334
confident_label rate tensor(0.5406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 865
clean true:853
clean false:12
clean_rate:0.9861271676300578
noisy true:413
noisy false:322
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 735
epoch [120/200] batch [5/27] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.6074 (0.4688) acc_x 93.7500 (90.6250) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/27] time 0.179 (0.183) data 0.103 (0.106) loss_x loss_x 0.2949 (0.4108) acc_x 90.6250 (89.3750) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [15/27] time 0.159 (0.183) data 0.082 (0.106) loss_x loss_x 0.1086 (0.4152) acc_x 100.0000 (90.0000) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [20/27] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.4194 (0.4287) acc_x 93.7500 (89.6875) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [25/27] time 0.180 (0.179) data 0.103 (0.102) loss_x loss_x 0.3594 (0.4329) acc_x 87.5000 (89.1250) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/22] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.8921 (0.9178) acc_u 15.6250 (9.3750) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/22] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.8877 (0.9010) acc_u 15.6250 (11.5625) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/22] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8955 (0.8847) acc_u 12.5000 (13.3333) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/22] time 0.179 (0.181) data 0.103 (0.104) loss_u loss_u 0.8750 (0.8872) acc_u 18.7500 (13.2812) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 301
confident_label rate tensor(0.5394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 863
clean true:851
clean false:12
clean_rate:0.9860950173812283
noisy true:448
noisy false:289
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 737
epoch [121/200] batch [5/26] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.2722 (0.3883) acc_x 87.5000 (88.7500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/26] time 0.165 (0.173) data 0.088 (0.096) loss_x loss_x 0.6626 (0.4514) acc_x 78.1250 (87.8125) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/26] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.5571 (0.4784) acc_x 90.6250 (87.9167) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/26] time 0.163 (0.175) data 0.087 (0.099) loss_x loss_x 0.3904 (0.4717) acc_x 93.7500 (88.2812) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [25/26] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.5308 (0.4554) acc_x 84.3750 (88.3750) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/23] time 0.180 (0.178) data 0.103 (0.101) loss_u loss_u 0.8755 (0.8936) acc_u 15.6250 (11.2500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/23] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.8721 (0.8913) acc_u 15.6250 (12.5000) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/23] time 0.170 (0.179) data 0.092 (0.102) loss_u loss_u 0.8003 (0.8717) acc_u 21.8750 (14.5833) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/23] time 0.193 (0.179) data 0.116 (0.102) loss_u loss_u 0.9185 (0.8739) acc_u 9.3750 (14.5312) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 304
confident_label rate tensor(0.5431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 869
clean true:857
clean false:12
clean_rate:0.9861910241657077
noisy true:439
noisy false:292
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 731
epoch [122/200] batch [5/27] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.4607 (0.4118) acc_x 87.5000 (90.0000) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/27] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5215 (0.4377) acc_x 84.3750 (88.4375) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [15/27] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.8032 (0.4821) acc_x 75.0000 (88.1250) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [20/27] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.6221 (0.4744) acc_x 81.2500 (87.8125) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [25/27] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.2063 (0.4794) acc_x 93.7500 (87.3750) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/22] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.9292 (0.8697) acc_u 6.2500 (15.6250) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/22] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8623 (0.8809) acc_u 12.5000 (13.7500) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/22] time 0.180 (0.184) data 0.102 (0.107) loss_u loss_u 0.8350 (0.8772) acc_u 21.8750 (14.1667) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/22] time 0.177 (0.184) data 0.098 (0.106) loss_u loss_u 0.8457 (0.8835) acc_u 18.7500 (13.2812) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 291
confident_label rate tensor(0.5469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 875
clean true:863
clean false:12
clean_rate:0.9862857142857143
noisy true:446
noisy false:279
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 725
epoch [123/200] batch [5/27] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.3142 (0.4294) acc_x 90.6250 (86.8750) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/27] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.7383 (0.5433) acc_x 84.3750 (86.5625) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [15/27] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.4688 (0.5432) acc_x 87.5000 (85.8333) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [20/27] time 0.181 (0.183) data 0.104 (0.107) loss_x loss_x 1.2207 (0.5697) acc_x 71.8750 (85.3125) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [25/27] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.3228 (0.5476) acc_x 87.5000 (85.2500) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/22] time 0.181 (0.184) data 0.105 (0.108) loss_u loss_u 0.8896 (0.8837) acc_u 12.5000 (12.5000) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/22] time 0.182 (0.184) data 0.105 (0.108) loss_u loss_u 0.7900 (0.8714) acc_u 25.0000 (14.3750) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/22] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9077 (0.8828) acc_u 9.3750 (13.3333) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/22] time 0.183 (0.184) data 0.107 (0.107) loss_u loss_u 0.8960 (0.8804) acc_u 12.5000 (13.5938) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 322
confident_label rate tensor(0.5356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 857
clean true:845
clean false:12
clean_rate:0.9859976662777129
noisy true:433
noisy false:310
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 743
epoch [124/200] batch [5/26] time 0.166 (0.172) data 0.089 (0.095) loss_x loss_x 0.4839 (0.5585) acc_x 84.3750 (84.3750) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/26] time 0.166 (0.171) data 0.090 (0.094) loss_x loss_x 0.3193 (0.5098) acc_x 90.6250 (85.9375) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/26] time 0.172 (0.173) data 0.095 (0.096) loss_x loss_x 0.4905 (0.4464) acc_x 81.2500 (87.9167) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/26] time 0.180 (0.175) data 0.103 (0.098) loss_x loss_x 0.3079 (0.4301) acc_x 90.6250 (88.4375) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [25/26] time 0.183 (0.176) data 0.106 (0.100) loss_x loss_x 0.2927 (0.4433) acc_x 93.7500 (87.7500) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/23] time 0.182 (0.177) data 0.105 (0.101) loss_u loss_u 0.8350 (0.8507) acc_u 15.6250 (16.8750) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/23] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9014 (0.8691) acc_u 12.5000 (15.0000) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/23] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.8140 (0.8630) acc_u 18.7500 (15.6250) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/23] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8730 (0.8612) acc_u 15.6250 (15.7812) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 318
confident_label rate tensor(0.5481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 877
clean true:860
clean false:17
clean_rate:0.9806157354618016
noisy true:422
noisy false:301
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 723
epoch [125/200] batch [5/27] time 0.158 (0.177) data 0.082 (0.101) loss_x loss_x 0.3711 (0.4918) acc_x 93.7500 (84.3750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/27] time 0.194 (0.180) data 0.117 (0.103) loss_x loss_x 0.6592 (0.5184) acc_x 87.5000 (86.8750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [15/27] time 0.168 (0.178) data 0.091 (0.102) loss_x loss_x 0.4419 (0.4681) acc_x 90.6250 (87.7083) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/27] time 0.173 (0.178) data 0.097 (0.101) loss_x loss_x 0.2886 (0.4446) acc_x 96.8750 (88.1250) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [25/27] time 0.167 (0.176) data 0.091 (0.100) loss_x loss_x 0.5483 (0.4819) acc_x 87.5000 (87.3750) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/22] time 0.180 (0.178) data 0.104 (0.101) loss_u loss_u 0.9048 (0.8977) acc_u 9.3750 (11.2500) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/22] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9102 (0.8963) acc_u 12.5000 (11.8750) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/22] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.9526 (0.8889) acc_u 6.2500 (12.7083) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/22] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.7920 (0.8785) acc_u 21.8750 (13.5938) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.5369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 859
clean true:845
clean false:14
clean_rate:0.9837019790454016
noisy true:426
noisy false:315
after delete: len(clean_dataset) 859
after delete: len(noisy_dataset) 741
epoch [126/200] batch [5/26] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.1296 (0.4734) acc_x 93.7500 (88.1250) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/26] time 0.204 (0.184) data 0.128 (0.108) loss_x loss_x 0.5342 (0.5146) acc_x 84.3750 (86.5625) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/26] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.2561 (0.4944) acc_x 96.8750 (86.6667) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/26] time 0.182 (0.184) data 0.105 (0.108) loss_x loss_x 0.2659 (0.4848) acc_x 93.7500 (86.7188) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [25/26] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.5586 (0.5010) acc_x 78.1250 (86.2500) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/23] time 0.179 (0.184) data 0.102 (0.107) loss_u loss_u 0.8994 (0.8712) acc_u 12.5000 (13.7500) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/23] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.7861 (0.8496) acc_u 21.8750 (16.8750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/23] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.8159 (0.8303) acc_u 18.7500 (18.5417) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/23] time 0.160 (0.183) data 0.083 (0.106) loss_u loss_u 0.9829 (0.8412) acc_u 0.0000 (17.1875) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.5369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 859
clean true:845
clean false:14
clean_rate:0.9837019790454016
noisy true:444
noisy false:297
after delete: len(clean_dataset) 859
after delete: len(noisy_dataset) 741
epoch [127/200] batch [5/26] time 0.185 (0.189) data 0.107 (0.112) loss_x loss_x 0.4270 (0.4421) acc_x 93.7500 (89.3750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/26] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.3445 (0.4130) acc_x 93.7500 (90.3125) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/26] time 0.164 (0.184) data 0.087 (0.107) loss_x loss_x 0.4875 (0.4602) acc_x 87.5000 (88.3333) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [20/26] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.4629 (0.4625) acc_x 90.6250 (88.5938) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [25/26] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.4412 (0.4521) acc_x 90.6250 (88.7500) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/23] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.8525 (0.8742) acc_u 15.6250 (13.1250) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/23] time 0.182 (0.183) data 0.104 (0.105) loss_u loss_u 0.8047 (0.8795) acc_u 21.8750 (12.8125) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/23] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8242 (0.8698) acc_u 18.7500 (13.9583) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/23] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.8813 (0.8708) acc_u 12.5000 (14.0625) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 314
confident_label rate tensor(0.5394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 863
clean true:848
clean false:15
clean_rate:0.9826187717265353
noisy true:438
noisy false:299
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 737
epoch [128/200] batch [5/26] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.2969 (0.3853) acc_x 93.7500 (91.2500) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/26] time 0.158 (0.178) data 0.081 (0.101) loss_x loss_x 0.3616 (0.4249) acc_x 90.6250 (89.6875) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/26] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 0.2058 (0.4379) acc_x 93.7500 (88.9583) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/26] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.3252 (0.4434) acc_x 93.7500 (89.0625) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [25/26] time 0.172 (0.176) data 0.095 (0.099) loss_x loss_x 0.3245 (0.4595) acc_x 90.6250 (89.0000) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/23] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.8940 (0.8693) acc_u 12.5000 (15.0000) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/23] time 0.168 (0.174) data 0.091 (0.097) loss_u loss_u 0.8608 (0.8716) acc_u 15.6250 (14.6875) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/23] time 0.174 (0.174) data 0.098 (0.097) loss_u loss_u 0.8018 (0.8626) acc_u 21.8750 (15.6250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/23] time 0.186 (0.175) data 0.109 (0.098) loss_u loss_u 0.9204 (0.8668) acc_u 9.3750 (15.0000) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 850
clean true:836
clean false:14
clean_rate:0.9835294117647059
noisy true:428
noisy false:322
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 750
epoch [129/200] batch [5/26] time 0.173 (0.165) data 0.095 (0.088) loss_x loss_x 0.6660 (0.3706) acc_x 84.3750 (90.0000) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/26] time 0.184 (0.174) data 0.107 (0.097) loss_x loss_x 0.6323 (0.4533) acc_x 87.5000 (88.1250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/26] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.1919 (0.4788) acc_x 93.7500 (87.5000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/26] time 0.176 (0.178) data 0.100 (0.102) loss_x loss_x 0.5874 (0.4752) acc_x 87.5000 (87.6562) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [25/26] time 0.173 (0.178) data 0.097 (0.101) loss_x loss_x 0.2489 (0.4327) acc_x 90.6250 (88.5000) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/23] time 0.157 (0.176) data 0.081 (0.100) loss_u loss_u 0.8281 (0.8415) acc_u 18.7500 (17.5000) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/23] time 0.173 (0.175) data 0.096 (0.098) loss_u loss_u 0.9419 (0.8472) acc_u 6.2500 (17.1875) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/23] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.8188 (0.8510) acc_u 21.8750 (16.8750) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/23] time 0.174 (0.175) data 0.097 (0.099) loss_u loss_u 0.8188 (0.8539) acc_u 21.8750 (17.0312) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 308
confident_label rate tensor(0.5431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 869
clean true:857
clean false:12
clean_rate:0.9861910241657077
noisy true:435
noisy false:296
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 731
epoch [130/200] batch [5/27] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.8511 (0.6222) acc_x 81.2500 (87.5000) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [10/27] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.5649 (0.6124) acc_x 78.1250 (85.0000) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [15/27] time 0.179 (0.181) data 0.103 (0.105) loss_x loss_x 0.5737 (0.5761) acc_x 81.2500 (85.8333) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [20/27] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.4070 (0.5682) acc_x 87.5000 (85.7812) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [25/27] time 0.186 (0.183) data 0.110 (0.106) loss_x loss_x 0.4473 (0.5482) acc_x 90.6250 (86.2500) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/22] time 0.173 (0.181) data 0.096 (0.105) loss_u loss_u 0.8354 (0.8519) acc_u 15.6250 (15.0000) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/22] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9414 (0.8735) acc_u 6.2500 (13.1250) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/22] time 0.171 (0.180) data 0.094 (0.103) loss_u loss_u 0.9697 (0.8871) acc_u 3.1250 (12.0833) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/22] time 0.181 (0.179) data 0.105 (0.102) loss_u loss_u 0.9014 (0.8675) acc_u 9.3750 (14.3750) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 313
confident_label rate tensor(0.5437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 870
clean true:857
clean false:13
clean_rate:0.9850574712643678
noisy true:430
noisy false:300
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 730
epoch [131/200] batch [5/27] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.4817 (0.5623) acc_x 84.3750 (83.7500) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/27] time 0.168 (0.172) data 0.092 (0.096) loss_x loss_x 0.5786 (0.5542) acc_x 87.5000 (84.3750) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/27] time 0.179 (0.174) data 0.102 (0.098) loss_x loss_x 0.2383 (0.5075) acc_x 93.7500 (85.4167) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/27] time 0.179 (0.178) data 0.103 (0.101) loss_x loss_x 0.2107 (0.4895) acc_x 96.8750 (86.7188) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [25/27] time 0.180 (0.179) data 0.103 (0.102) loss_x loss_x 0.3325 (0.4734) acc_x 87.5000 (87.0000) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/22] time 0.174 (0.179) data 0.097 (0.102) loss_u loss_u 0.9028 (0.9003) acc_u 18.7500 (14.3750) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/22] time 0.190 (0.179) data 0.112 (0.102) loss_u loss_u 0.7495 (0.8806) acc_u 31.2500 (15.6250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/22] time 0.190 (0.178) data 0.112 (0.101) loss_u loss_u 0.8213 (0.8722) acc_u 18.7500 (16.0417) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/22] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.9429 (0.8790) acc_u 3.1250 (14.5312) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 313
confident_label rate tensor(0.5450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 872
clean true:857
clean false:15
clean_rate:0.9827981651376146
noisy true:430
noisy false:298
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 728
epoch [132/200] batch [5/27] time 0.167 (0.188) data 0.090 (0.112) loss_x loss_x 0.6289 (0.4357) acc_x 81.2500 (86.8750) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/27] time 0.178 (0.183) data 0.101 (0.107) loss_x loss_x 0.7275 (0.5413) acc_x 78.1250 (85.3125) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [15/27] time 0.177 (0.183) data 0.100 (0.106) loss_x loss_x 0.7212 (0.5084) acc_x 81.2500 (86.0417) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [20/27] time 0.181 (0.183) data 0.104 (0.107) loss_x loss_x 0.6626 (0.5265) acc_x 81.2500 (85.0000) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [25/27] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.7139 (0.5348) acc_x 84.3750 (85.7500) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/22] time 0.188 (0.181) data 0.111 (0.104) loss_u loss_u 0.9468 (0.8825) acc_u 6.2500 (14.3750) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/22] time 0.180 (0.181) data 0.102 (0.104) loss_u loss_u 0.8281 (0.8727) acc_u 18.7500 (15.0000) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/22] time 0.189 (0.181) data 0.111 (0.104) loss_u loss_u 0.8936 (0.8645) acc_u 12.5000 (15.4167) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/22] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.9297 (0.8626) acc_u 6.2500 (15.4688) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 322
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:854
clean false:13
clean_rate:0.9850057670126874
noisy true:424
noisy false:309
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [133/200] batch [5/27] time 0.183 (0.177) data 0.106 (0.099) loss_x loss_x 0.6001 (0.5300) acc_x 84.3750 (86.8750) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/27] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.4788 (0.5273) acc_x 93.7500 (86.2500) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [15/27] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.1611 (0.4831) acc_x 100.0000 (87.5000) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/27] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.2366 (0.5128) acc_x 96.8750 (87.1875) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [25/27] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.6689 (0.5054) acc_x 78.1250 (87.0000) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/22] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8887 (0.8420) acc_u 9.3750 (16.2500) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/22] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.8770 (0.8516) acc_u 15.6250 (16.5625) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/22] time 0.180 (0.183) data 0.103 (0.107) loss_u loss_u 0.8511 (0.8691) acc_u 18.7500 (15.2083) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/22] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9395 (0.8717) acc_u 6.2500 (14.5312) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 319
confident_label rate tensor(0.5356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 857
clean true:842
clean false:15
clean_rate:0.9824970828471412
noisy true:439
noisy false:304
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 743
epoch [134/200] batch [5/26] time 0.185 (0.192) data 0.108 (0.116) loss_x loss_x 0.6670 (0.6990) acc_x 84.3750 (84.3750) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [10/26] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 0.4878 (0.5367) acc_x 87.5000 (86.5625) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [15/26] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.2793 (0.5193) acc_x 90.6250 (86.2500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/26] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 1.1299 (0.5640) acc_x 78.1250 (85.7812) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [25/26] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.6104 (0.5440) acc_x 87.5000 (86.1250) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/23] time 0.185 (0.180) data 0.109 (0.104) loss_u loss_u 0.7729 (0.8407) acc_u 21.8750 (17.5000) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/23] time 0.164 (0.179) data 0.086 (0.102) loss_u loss_u 0.9321 (0.8452) acc_u 6.2500 (17.1875) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/23] time 0.163 (0.177) data 0.085 (0.100) loss_u loss_u 0.8467 (0.8493) acc_u 15.6250 (16.4583) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/23] time 0.177 (0.176) data 0.101 (0.100) loss_u loss_u 0.8281 (0.8580) acc_u 21.8750 (15.6250) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 333
confident_label rate tensor(0.5375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 860
clean true:846
clean false:14
clean_rate:0.9837209302325581
noisy true:421
noisy false:319
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 740
epoch [135/200] batch [5/26] time 0.175 (0.179) data 0.098 (0.102) loss_x loss_x 0.3140 (0.3861) acc_x 90.6250 (91.2500) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/26] time 0.165 (0.173) data 0.089 (0.096) loss_x loss_x 0.3530 (0.4241) acc_x 90.6250 (88.4375) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/26] time 0.162 (0.171) data 0.086 (0.094) loss_x loss_x 0.2788 (0.4391) acc_x 90.6250 (87.7083) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/26] time 0.175 (0.170) data 0.099 (0.094) loss_x loss_x 0.3311 (0.4434) acc_x 96.8750 (87.8125) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [25/26] time 0.181 (0.172) data 0.105 (0.096) loss_x loss_x 0.4900 (0.4480) acc_x 87.5000 (87.8750) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/23] time 0.163 (0.174) data 0.085 (0.097) loss_u loss_u 0.9048 (0.8725) acc_u 9.3750 (14.3750) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/23] time 0.179 (0.173) data 0.101 (0.096) loss_u loss_u 0.9204 (0.8721) acc_u 9.3750 (14.3750) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/23] time 0.178 (0.173) data 0.100 (0.096) loss_u loss_u 0.8447 (0.8752) acc_u 15.6250 (13.7500) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/23] time 0.181 (0.174) data 0.103 (0.097) loss_u loss_u 0.8081 (0.8634) acc_u 21.8750 (15.3125) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 304
confident_label rate tensor(0.5450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 872
clean true:858
clean false:14
clean_rate:0.9839449541284404
noisy true:438
noisy false:290
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 728
epoch [136/200] batch [5/27] time 0.186 (0.182) data 0.109 (0.106) loss_x loss_x 0.1958 (0.3511) acc_x 90.6250 (89.3750) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/27] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.8179 (0.3803) acc_x 81.2500 (89.6875) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [15/27] time 0.194 (0.184) data 0.118 (0.107) loss_x loss_x 0.5024 (0.4141) acc_x 81.2500 (88.9583) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/27] time 0.177 (0.183) data 0.100 (0.107) loss_x loss_x 0.2045 (0.4284) acc_x 93.7500 (88.9062) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [25/27] time 0.177 (0.183) data 0.100 (0.106) loss_x loss_x 0.5444 (0.4124) acc_x 87.5000 (89.2500) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/22] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9648 (0.8704) acc_u 3.1250 (13.1250) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/22] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.8633 (0.8856) acc_u 15.6250 (12.1875) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/22] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.8779 (0.8846) acc_u 12.5000 (12.0833) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/22] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.8647 (0.8829) acc_u 15.6250 (12.5000) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 869
clean true:857
clean false:12
clean_rate:0.9861910241657077
noisy true:433
noisy false:298
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 731
epoch [137/200] batch [5/27] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.3506 (0.3254) acc_x 93.7500 (93.1250) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/27] time 0.169 (0.177) data 0.091 (0.100) loss_x loss_x 0.6499 (0.3826) acc_x 78.1250 (90.3125) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [15/27] time 0.160 (0.173) data 0.084 (0.096) loss_x loss_x 0.2179 (0.4032) acc_x 93.7500 (89.5833) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [20/27] time 0.185 (0.172) data 0.108 (0.095) loss_x loss_x 0.3979 (0.4273) acc_x 90.6250 (89.0625) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [25/27] time 0.184 (0.175) data 0.106 (0.098) loss_x loss_x 0.5166 (0.4250) acc_x 87.5000 (89.1250) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/22] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.8369 (0.8615) acc_u 18.7500 (15.6250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/22] time 0.189 (0.177) data 0.112 (0.100) loss_u loss_u 0.7827 (0.8756) acc_u 21.8750 (13.7500) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/22] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.8096 (0.8596) acc_u 18.7500 (15.8333) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/22] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.9165 (0.8739) acc_u 9.3750 (14.2188) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 318
confident_label rate tensor(0.5406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 865
clean true:846
clean false:19
clean_rate:0.9780346820809248
noisy true:436
noisy false:299
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 735
epoch [138/200] batch [5/27] time 0.181 (0.183) data 0.103 (0.106) loss_x loss_x 0.8525 (0.4927) acc_x 78.1250 (86.2500) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/27] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.4426 (0.5173) acc_x 87.5000 (85.6250) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [15/27] time 0.177 (0.182) data 0.100 (0.105) loss_x loss_x 0.9312 (0.5689) acc_x 78.1250 (84.1667) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [20/27] time 0.161 (0.178) data 0.084 (0.101) loss_x loss_x 0.5688 (0.5894) acc_x 78.1250 (84.3750) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [25/27] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 0.9868 (0.6158) acc_x 75.0000 (84.0000) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/22] time 0.183 (0.176) data 0.107 (0.099) loss_u loss_u 0.8301 (0.8498) acc_u 25.0000 (19.3750) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/22] time 0.186 (0.177) data 0.109 (0.099) loss_u loss_u 0.8511 (0.8641) acc_u 18.7500 (16.5625) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/22] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.7788 (0.8620) acc_u 25.0000 (16.2500) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/22] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.8960 (0.8635) acc_u 12.5000 (15.9375) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.5387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 862
clean true:854
clean false:8
clean_rate:0.9907192575406032
noisy true:422
noisy false:316
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 738
epoch [139/200] batch [5/26] time 0.178 (0.181) data 0.102 (0.104) loss_x loss_x 0.6235 (0.4267) acc_x 81.2500 (87.5000) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/26] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.7017 (0.3790) acc_x 81.2500 (89.6875) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/26] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4075 (0.3543) acc_x 87.5000 (90.0000) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [20/26] time 0.181 (0.180) data 0.105 (0.104) loss_x loss_x 0.3450 (0.3864) acc_x 90.6250 (89.6875) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [25/26] time 0.187 (0.181) data 0.111 (0.104) loss_x loss_x 0.3916 (0.3968) acc_x 90.6250 (89.7500) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/23] time 0.177 (0.180) data 0.100 (0.103) loss_u loss_u 0.9536 (0.8778) acc_u 9.3750 (14.3750) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/23] time 0.181 (0.180) data 0.104 (0.104) loss_u loss_u 0.9072 (0.8860) acc_u 9.3750 (12.8125) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/23] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8501 (0.8682) acc_u 15.6250 (14.5833) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/23] time 0.186 (0.181) data 0.108 (0.104) loss_u loss_u 0.8242 (0.8625) acc_u 18.7500 (15.1562) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 294
confident_label rate tensor(0.5550, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 888
clean true:870
clean false:18
clean_rate:0.9797297297297297
noisy true:436
noisy false:276
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 712
epoch [140/200] batch [5/27] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.4246 (0.4664) acc_x 84.3750 (86.8750) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/27] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.5244 (0.5238) acc_x 84.3750 (85.9375) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [15/27] time 0.165 (0.181) data 0.088 (0.104) loss_x loss_x 0.2424 (0.4736) acc_x 93.7500 (86.6667) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/27] time 0.180 (0.180) data 0.103 (0.102) loss_x loss_x 0.7593 (0.4683) acc_x 81.2500 (87.3438) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [25/27] time 0.166 (0.179) data 0.089 (0.102) loss_x loss_x 0.3176 (0.4735) acc_x 96.8750 (87.7500) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/22] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9678 (0.8967) acc_u 3.1250 (10.0000) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/22] time 0.228 (0.182) data 0.151 (0.105) loss_u loss_u 0.9131 (0.8854) acc_u 9.3750 (12.5000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/22] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8833 (0.8833) acc_u 12.5000 (12.7083) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/22] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.9551 (0.8859) acc_u 9.3750 (12.8125) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 313
confident_label rate tensor(0.5437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 870
clean true:853
clean false:17
clean_rate:0.9804597701149426
noisy true:434
noisy false:296
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 730
epoch [141/200] batch [5/27] time 0.178 (0.182) data 0.102 (0.106) loss_x loss_x 0.8301 (0.4378) acc_x 75.0000 (86.8750) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/27] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.8291 (0.4582) acc_x 81.2500 (86.8750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [15/27] time 0.159 (0.180) data 0.083 (0.104) loss_x loss_x 0.7378 (0.4548) acc_x 81.2500 (87.0833) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [20/27] time 0.174 (0.176) data 0.098 (0.100) loss_x loss_x 0.1707 (0.4387) acc_x 96.8750 (87.8125) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [25/27] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.5620 (0.4310) acc_x 84.3750 (88.0000) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/22] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.8965 (0.8360) acc_u 12.5000 (18.7500) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/22] time 0.177 (0.178) data 0.099 (0.101) loss_u loss_u 0.8218 (0.8416) acc_u 18.7500 (17.8125) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/22] time 0.161 (0.177) data 0.084 (0.100) loss_u loss_u 0.8569 (0.8477) acc_u 15.6250 (16.6667) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/22] time 0.160 (0.176) data 0.083 (0.099) loss_u loss_u 0.9209 (0.8582) acc_u 9.3750 (15.9375) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 297
confident_label rate tensor(0.5462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 874
clean true:863
clean false:11
clean_rate:0.9874141876430206
noisy true:440
noisy false:286
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 726
epoch [142/200] batch [5/27] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.4766 (0.5431) acc_x 93.7500 (87.5000) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/27] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.1376 (0.4349) acc_x 96.8750 (90.6250) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [15/27] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.5264 (0.4797) acc_x 84.3750 (88.7500) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [20/27] time 0.163 (0.182) data 0.086 (0.105) loss_x loss_x 0.2673 (0.4675) acc_x 93.7500 (88.9062) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [25/27] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.4402 (0.5058) acc_x 84.3750 (87.8750) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/22] time 0.171 (0.179) data 0.094 (0.102) loss_u loss_u 0.9004 (0.8938) acc_u 12.5000 (11.8750) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/22] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.8716 (0.8804) acc_u 15.6250 (12.8125) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/22] time 0.171 (0.179) data 0.094 (0.102) loss_u loss_u 0.9282 (0.8775) acc_u 12.5000 (14.3750) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/22] time 0.166 (0.178) data 0.090 (0.101) loss_u loss_u 0.9165 (0.8802) acc_u 9.3750 (13.5938) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.5481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 877
clean true:860
clean false:17
clean_rate:0.9806157354618016
noisy true:413
noisy false:310
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 723
epoch [143/200] batch [5/27] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.2615 (0.3417) acc_x 93.7500 (90.0000) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/27] time 0.229 (0.191) data 0.152 (0.115) loss_x loss_x 0.2864 (0.3346) acc_x 87.5000 (89.3750) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [15/27] time 0.183 (0.189) data 0.106 (0.112) loss_x loss_x 0.2007 (0.3580) acc_x 96.8750 (89.3750) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/27] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.5420 (0.4064) acc_x 84.3750 (88.4375) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [25/27] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.2399 (0.4250) acc_x 96.8750 (88.5000) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/22] time 0.177 (0.185) data 0.100 (0.108) loss_u loss_u 0.8301 (0.8868) acc_u 18.7500 (11.8750) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/22] time 0.181 (0.185) data 0.104 (0.108) loss_u loss_u 0.8184 (0.8742) acc_u 21.8750 (13.7500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/22] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.8662 (0.8788) acc_u 15.6250 (13.5417) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/22] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.8838 (0.8839) acc_u 15.6250 (13.1250) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.5475, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 876
clean true:860
clean false:16
clean_rate:0.9817351598173516
noisy true:433
noisy false:291
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 724
epoch [144/200] batch [5/27] time 0.194 (0.184) data 0.117 (0.107) loss_x loss_x 0.4434 (0.4147) acc_x 90.6250 (91.2500) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/27] time 0.200 (0.190) data 0.123 (0.113) loss_x loss_x 0.6865 (0.4969) acc_x 81.2500 (88.7500) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/27] time 0.179 (0.189) data 0.102 (0.113) loss_x loss_x 0.6279 (0.4804) acc_x 81.2500 (88.3333) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [20/27] time 0.181 (0.189) data 0.105 (0.112) loss_x loss_x 0.2400 (0.4535) acc_x 93.7500 (88.2812) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [25/27] time 0.180 (0.188) data 0.103 (0.112) loss_x loss_x 0.4392 (0.4683) acc_x 87.5000 (87.8750) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/22] time 0.183 (0.186) data 0.106 (0.110) loss_u loss_u 0.7798 (0.8632) acc_u 25.0000 (14.3750) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/22] time 0.186 (0.186) data 0.108 (0.109) loss_u loss_u 0.9082 (0.8580) acc_u 12.5000 (15.9375) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/22] time 0.179 (0.186) data 0.102 (0.109) loss_u loss_u 0.8960 (0.8819) acc_u 9.3750 (12.7083) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/22] time 0.179 (0.185) data 0.101 (0.108) loss_u loss_u 0.9102 (0.8793) acc_u 9.3750 (13.2812) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.5412, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 866
clean true:851
clean false:15
clean_rate:0.9826789838337182
noisy true:424
noisy false:310
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 734
epoch [145/200] batch [5/27] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 0.2649 (0.3674) acc_x 93.7500 (90.6250) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/27] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.7373 (0.4277) acc_x 84.3750 (88.4375) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [15/27] time 0.185 (0.182) data 0.107 (0.105) loss_x loss_x 0.8184 (0.4792) acc_x 78.1250 (87.0833) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/27] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 1.0674 (0.5131) acc_x 78.1250 (87.3438) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [25/27] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.8726 (0.5582) acc_x 75.0000 (86.6250) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/22] time 0.185 (0.183) data 0.106 (0.106) loss_u loss_u 0.9043 (0.8654) acc_u 12.5000 (15.6250) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/22] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.8608 (0.8611) acc_u 15.6250 (15.3125) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/22] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8594 (0.8651) acc_u 15.6250 (15.2083) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/22] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.8208 (0.8629) acc_u 21.8750 (15.6250) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.5437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 870
clean true:852
clean false:18
clean_rate:0.9793103448275862
noisy true:425
noisy false:305
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 730
epoch [146/200] batch [5/27] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.8760 (0.5786) acc_x 78.1250 (82.5000) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/27] time 0.160 (0.175) data 0.083 (0.098) loss_x loss_x 0.4409 (0.5364) acc_x 87.5000 (84.0625) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/27] time 0.167 (0.170) data 0.091 (0.093) loss_x loss_x 0.5786 (0.4979) acc_x 78.1250 (84.1667) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/27] time 0.173 (0.169) data 0.096 (0.092) loss_x loss_x 0.4751 (0.4934) acc_x 84.3750 (84.5312) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [25/27] time 0.187 (0.170) data 0.110 (0.094) loss_x loss_x 0.4509 (0.4593) acc_x 87.5000 (85.6250) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/22] time 0.184 (0.174) data 0.107 (0.097) loss_u loss_u 0.9414 (0.8815) acc_u 9.3750 (15.0000) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/22] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.8481 (0.8814) acc_u 15.6250 (13.7500) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/22] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.8428 (0.8714) acc_u 15.6250 (14.7917) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/22] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.8330 (0.8700) acc_u 15.6250 (14.5312) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 308
confident_label rate tensor(0.5512, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 882
clean true:867
clean false:15
clean_rate:0.9829931972789115
noisy true:425
noisy false:293
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 718
epoch [147/200] batch [5/27] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.7852 (0.3451) acc_x 87.5000 (91.8750) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/27] time 0.192 (0.184) data 0.115 (0.107) loss_x loss_x 0.7749 (0.4762) acc_x 84.3750 (89.0625) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/27] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.8228 (0.4598) acc_x 84.3750 (89.7917) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [20/27] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.4739 (0.4374) acc_x 90.6250 (89.5312) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [25/27] time 0.178 (0.182) data 0.102 (0.105) loss_x loss_x 0.4058 (0.4372) acc_x 87.5000 (89.1250) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/22] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.8569 (0.8868) acc_u 15.6250 (13.1250) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/22] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8750 (0.8904) acc_u 12.5000 (12.8125) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/22] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.8960 (0.8878) acc_u 9.3750 (12.7083) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/22] time 0.180 (0.182) data 0.104 (0.105) loss_u loss_u 0.9458 (0.8808) acc_u 6.2500 (13.4375) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 314
confident_label rate tensor(0.5487, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 878
clean true:855
clean false:23
clean_rate:0.9738041002277904
noisy true:431
noisy false:291
after delete: len(clean_dataset) 878
after delete: len(noisy_dataset) 722
epoch [148/200] batch [5/27] time 0.188 (0.188) data 0.112 (0.111) loss_x loss_x 0.4067 (0.4546) acc_x 93.7500 (91.2500) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/27] time 0.179 (0.186) data 0.101 (0.109) loss_x loss_x 0.6113 (0.4770) acc_x 75.0000 (87.8125) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [15/27] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.6309 (0.4766) acc_x 87.5000 (88.9583) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/27] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.3147 (0.4646) acc_x 87.5000 (88.7500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [25/27] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8423 (0.4613) acc_x 78.1250 (88.8750) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/22] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9106 (0.8666) acc_u 9.3750 (15.0000) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/22] time 0.158 (0.182) data 0.081 (0.105) loss_u loss_u 0.7256 (0.8789) acc_u 28.1250 (13.4375) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/22] time 0.155 (0.179) data 0.078 (0.102) loss_u loss_u 0.8779 (0.8849) acc_u 15.6250 (12.7083) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/22] time 0.158 (0.177) data 0.081 (0.100) loss_u loss_u 0.7539 (0.8740) acc_u 28.1250 (14.2188) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.5431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 869
clean true:855
clean false:14
clean_rate:0.9838895281933256
noisy true:436
noisy false:295
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 731
epoch [149/200] batch [5/27] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.3118 (0.5208) acc_x 90.6250 (85.0000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/27] time 0.168 (0.176) data 0.092 (0.099) loss_x loss_x 0.6235 (0.5098) acc_x 78.1250 (85.9375) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/27] time 0.159 (0.173) data 0.082 (0.096) loss_x loss_x 0.2415 (0.4564) acc_x 96.8750 (87.5000) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/27] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.3494 (0.4227) acc_x 90.6250 (88.2812) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [25/27] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 0.4885 (0.4047) acc_x 90.6250 (89.0000) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/22] time 0.184 (0.176) data 0.107 (0.100) loss_u loss_u 0.7954 (0.8360) acc_u 21.8750 (17.5000) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [10/22] time 0.173 (0.176) data 0.097 (0.099) loss_u loss_u 0.8320 (0.8480) acc_u 21.8750 (17.1875) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/22] time 0.181 (0.176) data 0.103 (0.099) loss_u loss_u 0.8521 (0.8385) acc_u 21.8750 (18.3333) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/22] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9189 (0.8552) acc_u 9.3750 (16.5625) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 300
confident_label rate tensor(0.5450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 872
clean true:855
clean false:17
clean_rate:0.9805045871559633
noisy true:445
noisy false:283
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 728
epoch [150/200] batch [5/27] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.2661 (0.5367) acc_x 93.7500 (83.1250) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/27] time 0.198 (0.191) data 0.122 (0.114) loss_x loss_x 1.1045 (0.5648) acc_x 78.1250 (84.6875) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [15/27] time 0.192 (0.190) data 0.115 (0.113) loss_x loss_x 0.5405 (0.5422) acc_x 81.2500 (85.4167) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [20/27] time 0.161 (0.186) data 0.084 (0.109) loss_x loss_x 0.1683 (0.5027) acc_x 100.0000 (86.7188) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [25/27] time 0.158 (0.182) data 0.082 (0.105) loss_x loss_x 0.8389 (0.4885) acc_x 78.1250 (86.8750) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/22] time 0.160 (0.179) data 0.082 (0.102) loss_u loss_u 0.8608 (0.8915) acc_u 15.6250 (12.5000) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/22] time 0.186 (0.181) data 0.108 (0.103) loss_u loss_u 0.9380 (0.8697) acc_u 9.3750 (15.0000) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/22] time 0.172 (0.180) data 0.095 (0.103) loss_u loss_u 0.8657 (0.8664) acc_u 12.5000 (15.2083) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/22] time 0.176 (0.180) data 0.098 (0.103) loss_u loss_u 0.8784 (0.8721) acc_u 12.5000 (14.3750) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.5462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 874
clean true:857
clean false:17
clean_rate:0.9805491990846682
noisy true:418
noisy false:308
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 726
epoch [151/200] batch [5/27] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.8477 (0.3956) acc_x 81.2500 (90.0000) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/27] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.7769 (0.4534) acc_x 78.1250 (88.4375) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [15/27] time 0.181 (0.184) data 0.103 (0.108) loss_x loss_x 0.4275 (0.4406) acc_x 90.6250 (88.5417) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [20/27] time 0.158 (0.180) data 0.081 (0.103) loss_x loss_x 0.6650 (0.4669) acc_x 84.3750 (88.5938) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [25/27] time 0.190 (0.180) data 0.114 (0.103) loss_x loss_x 0.3950 (0.4365) acc_x 90.6250 (89.6250) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/22] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8252 (0.8953) acc_u 18.7500 (11.8750) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/22] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.7588 (0.8670) acc_u 25.0000 (15.0000) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/22] time 0.180 (0.182) data 0.104 (0.105) loss_u loss_u 0.9414 (0.8747) acc_u 6.2500 (13.9583) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/22] time 0.204 (0.182) data 0.128 (0.105) loss_u loss_u 0.8911 (0.8766) acc_u 18.7500 (14.0625) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 314
confident_label rate tensor(0.5356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 857
clean true:844
clean false:13
clean_rate:0.9848308051341891
noisy true:442
noisy false:301
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 743
epoch [152/200] batch [5/26] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.5039 (0.5258) acc_x 84.3750 (86.2500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/26] time 0.172 (0.181) data 0.095 (0.104) loss_x loss_x 0.4250 (0.6165) acc_x 87.5000 (83.4375) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/26] time 0.183 (0.183) data 0.105 (0.106) loss_x loss_x 0.4841 (0.5669) acc_x 84.3750 (85.2083) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/26] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 1.0820 (0.5832) acc_x 84.3750 (85.6250) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [25/26] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.4817 (0.5558) acc_x 84.3750 (85.7500) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/23] time 0.162 (0.181) data 0.085 (0.104) loss_u loss_u 0.9268 (0.9157) acc_u 6.2500 (8.7500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/23] time 0.158 (0.180) data 0.080 (0.103) loss_u loss_u 0.7593 (0.8731) acc_u 25.0000 (13.4375) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/23] time 0.162 (0.178) data 0.084 (0.101) loss_u loss_u 0.8662 (0.8464) acc_u 12.5000 (16.0417) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/23] time 0.171 (0.178) data 0.094 (0.100) loss_u loss_u 0.8296 (0.8437) acc_u 18.7500 (16.8750) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 304
confident_label rate tensor(0.5431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 869
clean true:854
clean false:15
clean_rate:0.9827387802071347
noisy true:442
noisy false:289
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 731
epoch [153/200] batch [5/27] time 0.185 (0.186) data 0.107 (0.109) loss_x loss_x 0.5435 (0.5139) acc_x 81.2500 (85.6250) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/27] time 0.184 (0.188) data 0.108 (0.111) loss_x loss_x 0.1661 (0.4153) acc_x 96.8750 (89.0625) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [15/27] time 0.162 (0.180) data 0.086 (0.104) loss_x loss_x 0.5527 (0.4505) acc_x 87.5000 (89.1667) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/27] time 0.169 (0.180) data 0.092 (0.103) loss_x loss_x 0.4089 (0.4248) acc_x 87.5000 (89.8438) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [25/27] time 0.159 (0.177) data 0.083 (0.101) loss_x loss_x 0.8013 (0.4332) acc_x 65.6250 (88.8750) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/22] time 0.178 (0.178) data 0.100 (0.101) loss_u loss_u 0.7041 (0.8009) acc_u 34.3750 (22.5000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/22] time 0.188 (0.179) data 0.111 (0.102) loss_u loss_u 0.8521 (0.8335) acc_u 21.8750 (19.6875) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/22] time 0.189 (0.179) data 0.111 (0.103) loss_u loss_u 0.7568 (0.8352) acc_u 25.0000 (18.9583) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/22] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.9639 (0.8522) acc_u 3.1250 (17.3438) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.5475, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 876
clean true:859
clean false:17
clean_rate:0.980593607305936
noisy true:417
noisy false:307
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 724
epoch [154/200] batch [5/27] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.4722 (0.4990) acc_x 84.3750 (88.1250) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/27] time 0.187 (0.180) data 0.110 (0.103) loss_x loss_x 0.2549 (0.4802) acc_x 93.7500 (88.7500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [15/27] time 0.186 (0.181) data 0.108 (0.104) loss_x loss_x 0.5806 (0.4761) acc_x 93.7500 (89.3750) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/27] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.5225 (0.4556) acc_x 84.3750 (88.9062) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [25/27] time 0.190 (0.183) data 0.114 (0.106) loss_x loss_x 0.4719 (0.4507) acc_x 84.3750 (88.3750) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/22] time 0.180 (0.183) data 0.102 (0.106) loss_u loss_u 0.8735 (0.8731) acc_u 15.6250 (13.7500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/22] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8667 (0.8601) acc_u 18.7500 (16.2500) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/22] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9160 (0.8754) acc_u 9.3750 (14.3750) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/22] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.8750 (0.8789) acc_u 12.5000 (13.9062) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 292
confident_label rate tensor(0.5494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 879
clean true:860
clean false:19
clean_rate:0.9783845278725825
noisy true:448
noisy false:273
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 721
epoch [155/200] batch [5/27] time 0.170 (0.169) data 0.092 (0.092) loss_x loss_x 0.7402 (0.4778) acc_x 84.3750 (86.8750) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/27] time 0.165 (0.172) data 0.088 (0.095) loss_x loss_x 0.2764 (0.5639) acc_x 93.7500 (84.3750) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/27] time 0.181 (0.173) data 0.104 (0.096) loss_x loss_x 0.7979 (0.5634) acc_x 68.7500 (84.5833) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [20/27] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.4563 (0.5501) acc_x 87.5000 (85.1562) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [25/27] time 0.178 (0.172) data 0.101 (0.095) loss_x loss_x 0.6084 (0.5279) acc_x 81.2500 (85.6250) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/22] time 0.185 (0.175) data 0.108 (0.098) loss_u loss_u 0.8174 (0.8542) acc_u 18.7500 (16.2500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/22] time 0.186 (0.176) data 0.108 (0.099) loss_u loss_u 0.8140 (0.8613) acc_u 21.8750 (16.2500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/22] time 0.186 (0.177) data 0.108 (0.100) loss_u loss_u 0.8970 (0.8629) acc_u 12.5000 (15.8333) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/22] time 0.163 (0.177) data 0.086 (0.100) loss_u loss_u 0.9058 (0.8717) acc_u 12.5000 (14.8438) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.5519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 883
clean true:871
clean false:12
clean_rate:0.986409966024915
noisy true:430
noisy false:287
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 717
epoch [156/200] batch [5/27] time 0.183 (0.192) data 0.107 (0.115) loss_x loss_x 0.5308 (0.4011) acc_x 84.3750 (88.1250) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/27] time 0.189 (0.190) data 0.113 (0.114) loss_x loss_x 0.4973 (0.4377) acc_x 90.6250 (89.6875) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/27] time 0.181 (0.188) data 0.105 (0.111) loss_x loss_x 0.3418 (0.4545) acc_x 84.3750 (88.5417) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/27] time 0.182 (0.186) data 0.106 (0.109) loss_x loss_x 0.5420 (0.4784) acc_x 84.3750 (87.9688) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [25/27] time 0.179 (0.185) data 0.102 (0.108) loss_x loss_x 0.4009 (0.4712) acc_x 84.3750 (87.7500) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/22] time 0.180 (0.184) data 0.102 (0.107) loss_u loss_u 0.8892 (0.8927) acc_u 12.5000 (11.8750) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/22] time 0.188 (0.184) data 0.111 (0.107) loss_u loss_u 0.7734 (0.8795) acc_u 28.1250 (13.7500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/22] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8545 (0.8732) acc_u 15.6250 (13.9583) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/22] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9023 (0.8796) acc_u 12.5000 (13.5938) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 318
confident_label rate tensor(0.5444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 871
clean true:852
clean false:19
clean_rate:0.9781859931113662
noisy true:430
noisy false:299
after delete: len(clean_dataset) 871
after delete: len(noisy_dataset) 729
epoch [157/200] batch [5/27] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.5420 (0.5095) acc_x 90.6250 (86.2500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/27] time 0.159 (0.189) data 0.083 (0.112) loss_x loss_x 0.2502 (0.4446) acc_x 93.7500 (88.1250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/27] time 0.185 (0.183) data 0.109 (0.106) loss_x loss_x 0.3606 (0.4338) acc_x 90.6250 (87.2917) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/27] time 0.177 (0.182) data 0.100 (0.106) loss_x loss_x 0.6177 (0.4524) acc_x 81.2500 (87.3438) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [25/27] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.3552 (0.4484) acc_x 93.7500 (87.7500) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/22] time 0.172 (0.181) data 0.094 (0.104) loss_u loss_u 0.8608 (0.8313) acc_u 12.5000 (18.1250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/22] time 0.171 (0.179) data 0.094 (0.102) loss_u loss_u 0.7822 (0.8475) acc_u 25.0000 (16.5625) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/22] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.8618 (0.8547) acc_u 18.7500 (16.2500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/22] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.8540 (0.8668) acc_u 15.6250 (14.8438) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 289
confident_label rate tensor(0.5619, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 899
clean true:881
clean false:18
clean_rate:0.9799777530589544
noisy true:430
noisy false:271
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 701
epoch [158/200] batch [5/28] time 0.186 (0.184) data 0.109 (0.108) loss_x loss_x 0.2866 (0.6979) acc_x 93.7500 (85.6250) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/28] time 0.177 (0.182) data 0.100 (0.105) loss_x loss_x 0.5708 (0.5481) acc_x 90.6250 (88.4375) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [15/28] time 0.176 (0.182) data 0.100 (0.105) loss_x loss_x 0.3525 (0.5061) acc_x 90.6250 (87.5000) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/28] time 0.193 (0.183) data 0.117 (0.106) loss_x loss_x 0.5801 (0.4876) acc_x 81.2500 (87.3438) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [25/28] time 0.178 (0.182) data 0.102 (0.106) loss_x loss_x 0.3789 (0.4732) acc_x 87.5000 (87.7500) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/21] time 0.186 (0.182) data 0.109 (0.106) loss_u loss_u 0.9136 (0.8889) acc_u 9.3750 (11.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/21] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.7837 (0.8617) acc_u 25.0000 (15.0000) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/21] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.9517 (0.8795) acc_u 6.2500 (13.5417) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/21] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.8901 (0.8823) acc_u 12.5000 (13.1250) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 879
clean true:861
clean false:18
clean_rate:0.9795221843003413
noisy true:429
noisy false:292
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 721
epoch [159/200] batch [5/27] time 0.180 (0.185) data 0.103 (0.108) loss_x loss_x 0.8643 (0.5540) acc_x 78.1250 (85.0000) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/27] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.4167 (0.4343) acc_x 90.6250 (89.3750) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [15/27] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.2231 (0.4193) acc_x 96.8750 (90.0000) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/27] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.3623 (0.4146) acc_x 90.6250 (90.1562) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [25/27] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.3494 (0.4218) acc_x 87.5000 (89.7500) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/22] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8232 (0.8896) acc_u 21.8750 (12.5000) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/22] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.7739 (0.8560) acc_u 21.8750 (15.6250) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/22] time 0.178 (0.182) data 0.100 (0.105) loss_u loss_u 0.9194 (0.8626) acc_u 9.3750 (15.2083) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/22] time 0.187 (0.182) data 0.109 (0.105) loss_u loss_u 0.8701 (0.8614) acc_u 15.6250 (15.6250) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 319
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:852
clean false:15
clean_rate:0.9826989619377162
noisy true:429
noisy false:304
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [160/200] batch [5/27] time 0.187 (0.195) data 0.110 (0.118) loss_x loss_x 0.3967 (0.4845) acc_x 90.6250 (88.7500) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/27] time 0.187 (0.190) data 0.111 (0.113) loss_x loss_x 0.5386 (0.4948) acc_x 81.2500 (87.1875) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [15/27] time 0.180 (0.187) data 0.103 (0.111) loss_x loss_x 0.3508 (0.4551) acc_x 90.6250 (88.1250) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/27] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.2874 (0.4328) acc_x 87.5000 (88.2812) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [25/27] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.6133 (0.4288) acc_x 84.3750 (88.8750) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/22] time 0.171 (0.183) data 0.093 (0.106) loss_u loss_u 0.7754 (0.8515) acc_u 21.8750 (16.8750) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/22] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.7993 (0.8336) acc_u 21.8750 (18.7500) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/22] time 0.164 (0.181) data 0.087 (0.104) loss_u loss_u 0.9170 (0.8493) acc_u 9.3750 (16.8750) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/22] time 0.184 (0.181) data 0.106 (0.103) loss_u loss_u 0.9131 (0.8574) acc_u 9.3750 (15.9375) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 281
confident_label rate tensor(0.5556, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 889
clean true:878
clean false:11
clean_rate:0.9876265466816648
noisy true:441
noisy false:270
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 711
epoch [161/200] batch [5/27] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.7451 (0.5045) acc_x 87.5000 (87.5000) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/27] time 0.166 (0.189) data 0.089 (0.112) loss_x loss_x 0.6245 (0.5390) acc_x 81.2500 (85.0000) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [15/27] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.0854 (0.4988) acc_x 96.8750 (87.2917) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/27] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.5015 (0.5130) acc_x 87.5000 (87.0312) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [25/27] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.3816 (0.4810) acc_x 93.7500 (87.8750) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/22] time 0.185 (0.185) data 0.108 (0.109) loss_u loss_u 0.9688 (0.8999) acc_u 3.1250 (11.2500) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/22] time 0.193 (0.185) data 0.116 (0.108) loss_u loss_u 0.9150 (0.8903) acc_u 9.3750 (13.1250) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/22] time 0.185 (0.185) data 0.109 (0.108) loss_u loss_u 0.9287 (0.8843) acc_u 6.2500 (13.7500) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/22] time 0.180 (0.185) data 0.102 (0.108) loss_u loss_u 0.8945 (0.8809) acc_u 12.5000 (13.7500) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.5387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 862
clean true:844
clean false:18
clean_rate:0.9791183294663574
noisy true:427
noisy false:311
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 738
epoch [162/200] batch [5/26] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.5933 (0.4305) acc_x 75.0000 (88.1250) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/26] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.2876 (0.4296) acc_x 93.7500 (88.4375) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/26] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.4744 (0.4457) acc_x 84.3750 (87.5000) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/26] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.6167 (0.4641) acc_x 81.2500 (87.1875) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [25/26] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.3789 (0.4498) acc_x 93.7500 (88.0000) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/23] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.9424 (0.8920) acc_u 6.2500 (11.8750) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/23] time 0.159 (0.181) data 0.081 (0.104) loss_u loss_u 0.8267 (0.8706) acc_u 18.7500 (13.7500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/23] time 0.161 (0.180) data 0.083 (0.103) loss_u loss_u 0.8770 (0.8753) acc_u 12.5000 (13.1250) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/23] time 0.188 (0.179) data 0.110 (0.102) loss_u loss_u 0.8989 (0.8754) acc_u 9.3750 (13.4375) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 317
confident_label rate tensor(0.5437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 870
clean true:848
clean false:22
clean_rate:0.9747126436781609
noisy true:435
noisy false:295
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 730
epoch [163/200] batch [5/27] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.3533 (0.4541) acc_x 90.6250 (88.1250) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/27] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.5332 (0.4791) acc_x 84.3750 (87.1875) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [15/27] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.3684 (0.4541) acc_x 90.6250 (87.9167) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/27] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5679 (0.4558) acc_x 84.3750 (87.9688) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [25/27] time 0.192 (0.184) data 0.115 (0.107) loss_x loss_x 0.5615 (0.4764) acc_x 84.3750 (87.8750) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/22] time 0.186 (0.183) data 0.108 (0.107) loss_u loss_u 0.8555 (0.8484) acc_u 15.6250 (16.8750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/22] time 0.181 (0.183) data 0.103 (0.106) loss_u loss_u 0.8403 (0.8422) acc_u 18.7500 (17.1875) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/22] time 0.178 (0.183) data 0.100 (0.106) loss_u loss_u 0.9922 (0.8600) acc_u 0.0000 (15.4167) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/22] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.8857 (0.8610) acc_u 12.5000 (15.3125) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.5444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 871
clean true:853
clean false:18
clean_rate:0.9793340987370838
noisy true:423
noisy false:306
after delete: len(clean_dataset) 871
after delete: len(noisy_dataset) 729
epoch [164/200] batch [5/27] time 0.180 (0.183) data 0.103 (0.107) loss_x loss_x 0.5024 (0.3592) acc_x 84.3750 (93.1250) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/27] time 0.185 (0.183) data 0.108 (0.107) loss_x loss_x 0.2771 (0.3870) acc_x 90.6250 (91.2500) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/27] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.7998 (0.4264) acc_x 78.1250 (90.0000) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/27] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.2722 (0.4160) acc_x 93.7500 (90.1562) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [25/27] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.1871 (0.4314) acc_x 93.7500 (89.0000) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/22] time 0.186 (0.184) data 0.109 (0.108) loss_u loss_u 0.9209 (0.8658) acc_u 9.3750 (14.3750) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/22] time 0.174 (0.183) data 0.096 (0.106) loss_u loss_u 0.8896 (0.8629) acc_u 15.6250 (15.0000) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/22] time 0.181 (0.183) data 0.103 (0.106) loss_u loss_u 0.8564 (0.8566) acc_u 15.6250 (15.8333) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/22] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.9502 (0.8509) acc_u 6.2500 (16.7188) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.5456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 873
clean true:859
clean false:14
clean_rate:0.983963344788087
noisy true:430
noisy false:297
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 727
epoch [165/200] batch [5/27] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 0.2639 (0.4112) acc_x 93.7500 (90.0000) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/27] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.5195 (0.5193) acc_x 84.3750 (85.9375) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [15/27] time 0.178 (0.183) data 0.102 (0.106) loss_x loss_x 0.8062 (0.5001) acc_x 81.2500 (86.6667) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/27] time 0.179 (0.181) data 0.103 (0.104) loss_x loss_x 0.5435 (0.4872) acc_x 84.3750 (87.3438) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [25/27] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.5391 (0.4910) acc_x 93.7500 (87.7500) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/22] time 0.179 (0.181) data 0.102 (0.104) loss_u loss_u 0.8960 (0.8628) acc_u 12.5000 (15.6250) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/22] time 0.178 (0.181) data 0.101 (0.104) loss_u loss_u 0.7568 (0.8570) acc_u 25.0000 (16.2500) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/22] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8374 (0.8574) acc_u 15.6250 (15.8333) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/22] time 0.180 (0.181) data 0.102 (0.104) loss_u loss_u 0.7534 (0.8509) acc_u 28.1250 (16.5625) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.5362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 858
clean true:843
clean false:15
clean_rate:0.9825174825174825
noisy true:434
noisy false:308
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 742
epoch [166/200] batch [5/26] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.6191 (0.3889) acc_x 84.3750 (89.3750) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/26] time 0.187 (0.185) data 0.109 (0.108) loss_x loss_x 0.3933 (0.4504) acc_x 96.8750 (89.0625) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/26] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.7896 (0.4317) acc_x 84.3750 (89.5833) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/26] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.3606 (0.4530) acc_x 90.6250 (89.5312) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [25/26] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.6606 (0.4570) acc_x 84.3750 (89.5000) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/23] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.8608 (0.8477) acc_u 15.6250 (16.2500) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/23] time 0.181 (0.183) data 0.103 (0.107) loss_u loss_u 0.9004 (0.8356) acc_u 9.3750 (17.1875) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/23] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.9146 (0.8333) acc_u 9.3750 (18.1250) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/23] time 0.180 (0.183) data 0.103 (0.106) loss_u loss_u 0.8794 (0.8393) acc_u 12.5000 (17.5000) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 287
confident_label rate tensor(0.5594, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 895
clean true:877
clean false:18
clean_rate:0.9798882681564246
noisy true:436
noisy false:269
after delete: len(clean_dataset) 895
after delete: len(noisy_dataset) 705
epoch [167/200] batch [5/27] time 0.161 (0.180) data 0.084 (0.103) loss_x loss_x 0.5811 (0.5391) acc_x 84.3750 (86.2500) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/27] time 0.186 (0.176) data 0.109 (0.098) loss_x loss_x 0.3108 (0.5138) acc_x 90.6250 (86.8750) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/27] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.5225 (0.4699) acc_x 84.3750 (87.5000) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/27] time 0.177 (0.180) data 0.100 (0.103) loss_x loss_x 0.4517 (0.4637) acc_x 87.5000 (87.6562) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [25/27] time 0.189 (0.181) data 0.112 (0.104) loss_x loss_x 0.2178 (0.4360) acc_x 93.7500 (88.1250) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/22] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.8071 (0.9023) acc_u 18.7500 (10.0000) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/22] time 0.175 (0.181) data 0.099 (0.105) loss_u loss_u 0.7915 (0.8643) acc_u 25.0000 (14.6875) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/22] time 0.170 (0.181) data 0.092 (0.104) loss_u loss_u 0.8569 (0.8765) acc_u 15.6250 (13.5417) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/22] time 0.188 (0.181) data 0.110 (0.104) loss_u loss_u 0.9312 (0.8821) acc_u 9.3750 (13.2812) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 293
confident_label rate tensor(0.5562, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 890
clean true:875
clean false:15
clean_rate:0.9831460674157303
noisy true:432
noisy false:278
after delete: len(clean_dataset) 890
after delete: len(noisy_dataset) 710
epoch [168/200] batch [5/27] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.6885 (0.4682) acc_x 81.2500 (87.5000) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/27] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.4045 (0.4397) acc_x 90.6250 (88.4375) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/27] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.3372 (0.4724) acc_x 84.3750 (87.0833) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/27] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.4900 (0.4603) acc_x 90.6250 (87.5000) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [25/27] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.4146 (0.4403) acc_x 93.7500 (88.0000) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/22] time 0.182 (0.182) data 0.104 (0.106) loss_u loss_u 0.9541 (0.8996) acc_u 6.2500 (11.2500) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/22] time 0.178 (0.182) data 0.102 (0.106) loss_u loss_u 0.8979 (0.8934) acc_u 12.5000 (11.8750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/22] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.9287 (0.8956) acc_u 12.5000 (12.5000) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/22] time 0.185 (0.182) data 0.108 (0.106) loss_u loss_u 0.8853 (0.8870) acc_u 9.3750 (12.8125) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 312
confident_label rate tensor(0.5475, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 876
clean true:860
clean false:16
clean_rate:0.9817351598173516
noisy true:428
noisy false:296
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 724
epoch [169/200] batch [5/27] time 0.169 (0.177) data 0.093 (0.101) loss_x loss_x 0.4956 (0.5825) acc_x 90.6250 (85.0000) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/27] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.4829 (0.5058) acc_x 87.5000 (86.5625) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/27] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.5020 (0.4622) acc_x 90.6250 (87.5000) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/27] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.1262 (0.4194) acc_x 96.8750 (89.2188) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [25/27] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.3108 (0.4230) acc_x 93.7500 (88.7500) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/22] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8198 (0.8237) acc_u 18.7500 (20.6250) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/22] time 0.186 (0.181) data 0.108 (0.104) loss_u loss_u 0.8101 (0.8410) acc_u 21.8750 (18.7500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/22] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8398 (0.8570) acc_u 15.6250 (16.4583) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/22] time 0.180 (0.182) data 0.104 (0.105) loss_u loss_u 0.8462 (0.8537) acc_u 15.6250 (16.4062) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 314
confident_label rate tensor(0.5469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 875
clean true:858
clean false:17
clean_rate:0.9805714285714285
noisy true:428
noisy false:297
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 725
epoch [170/200] batch [5/27] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.5605 (0.4639) acc_x 87.5000 (86.8750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/27] time 0.187 (0.182) data 0.110 (0.106) loss_x loss_x 0.8291 (0.5082) acc_x 78.1250 (85.6250) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/27] time 0.177 (0.182) data 0.100 (0.106) loss_x loss_x 0.5356 (0.4853) acc_x 87.5000 (86.4583) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/27] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.4114 (0.4772) acc_x 87.5000 (87.5000) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [25/27] time 0.175 (0.181) data 0.097 (0.104) loss_x loss_x 0.6450 (0.4766) acc_x 87.5000 (88.0000) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/22] time 0.180 (0.181) data 0.102 (0.104) loss_u loss_u 0.9009 (0.8601) acc_u 12.5000 (15.6250) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/22] time 0.185 (0.182) data 0.109 (0.105) loss_u loss_u 0.8638 (0.8715) acc_u 12.5000 (13.4375) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/22] time 0.188 (0.181) data 0.110 (0.104) loss_u loss_u 0.8447 (0.8685) acc_u 15.6250 (14.1667) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/22] time 0.160 (0.180) data 0.082 (0.102) loss_u loss_u 0.8896 (0.8531) acc_u 12.5000 (15.9375) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.5381, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 861
clean true:847
clean false:14
clean_rate:0.983739837398374
noisy true:428
noisy false:311
after delete: len(clean_dataset) 861
after delete: len(noisy_dataset) 739
epoch [171/200] batch [5/26] time 0.178 (0.181) data 0.102 (0.104) loss_x loss_x 0.3430 (0.5311) acc_x 93.7500 (88.1250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/26] time 0.180 (0.180) data 0.102 (0.104) loss_x loss_x 0.4463 (0.5020) acc_x 84.3750 (88.1250) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/26] time 0.178 (0.181) data 0.101 (0.105) loss_x loss_x 0.9424 (0.5343) acc_x 75.0000 (87.9167) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/26] time 0.160 (0.180) data 0.083 (0.103) loss_x loss_x 0.0936 (0.5178) acc_x 100.0000 (87.9688) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [25/26] time 0.191 (0.180) data 0.114 (0.104) loss_x loss_x 0.4788 (0.5036) acc_x 84.3750 (87.6250) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/23] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.8779 (0.8727) acc_u 9.3750 (13.1250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/23] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.8921 (0.8549) acc_u 15.6250 (15.9375) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/23] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.7432 (0.8539) acc_u 25.0000 (15.8333) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/23] time 0.168 (0.181) data 0.092 (0.104) loss_u loss_u 0.9336 (0.8537) acc_u 6.2500 (16.0938) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.5506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 881
clean true:861
clean false:20
clean_rate:0.9772985244040863
noisy true:440
noisy false:279
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 719
epoch [172/200] batch [5/27] time 0.187 (0.183) data 0.110 (0.107) loss_x loss_x 0.4592 (0.4554) acc_x 84.3750 (86.2500) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/27] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.4028 (0.4185) acc_x 93.7500 (88.1250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/27] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.3066 (0.4529) acc_x 90.6250 (87.7083) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/27] time 0.182 (0.183) data 0.105 (0.107) loss_x loss_x 0.9697 (0.4949) acc_x 84.3750 (87.6562) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [25/27] time 0.179 (0.183) data 0.103 (0.107) loss_x loss_x 0.2935 (0.4936) acc_x 90.6250 (87.7500) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/22] time 0.172 (0.183) data 0.094 (0.106) loss_u loss_u 0.8774 (0.8467) acc_u 12.5000 (16.2500) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/22] time 0.169 (0.182) data 0.091 (0.105) loss_u loss_u 0.8970 (0.8588) acc_u 12.5000 (16.5625) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/22] time 0.173 (0.180) data 0.095 (0.103) loss_u loss_u 0.9077 (0.8628) acc_u 15.6250 (16.0417) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/22] time 0.161 (0.179) data 0.083 (0.102) loss_u loss_u 0.8032 (0.8655) acc_u 21.8750 (15.6250) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 294
confident_label rate tensor(0.5562, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 890
clean true:867
clean false:23
clean_rate:0.9741573033707865
noisy true:439
noisy false:271
after delete: len(clean_dataset) 890
after delete: len(noisy_dataset) 710
epoch [173/200] batch [5/27] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 0.7466 (0.5264) acc_x 71.8750 (85.0000) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/27] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.4822 (0.5600) acc_x 90.6250 (85.0000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [15/27] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.5596 (0.4754) acc_x 81.2500 (87.5000) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/27] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.6699 (0.4687) acc_x 84.3750 (87.6562) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [25/27] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.4412 (0.4930) acc_x 87.5000 (87.3750) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/22] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.9819 (0.9035) acc_u 3.1250 (11.2500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/22] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.8457 (0.8795) acc_u 18.7500 (13.4375) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/22] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9521 (0.8862) acc_u 6.2500 (12.9167) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/22] time 0.190 (0.183) data 0.112 (0.106) loss_u loss_u 0.8521 (0.8799) acc_u 15.6250 (13.7500) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.5406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 865
clean true:851
clean false:14
clean_rate:0.9838150289017341
noisy true:425
noisy false:310
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 735
epoch [174/200] batch [5/27] time 0.171 (0.165) data 0.094 (0.088) loss_x loss_x 0.3059 (0.4341) acc_x 93.7500 (88.7500) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/27] time 0.189 (0.174) data 0.113 (0.097) loss_x loss_x 0.4277 (0.3834) acc_x 90.6250 (90.3125) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/27] time 0.185 (0.176) data 0.107 (0.099) loss_x loss_x 0.0740 (0.4131) acc_x 100.0000 (89.3750) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/27] time 0.180 (0.178) data 0.104 (0.101) loss_x loss_x 0.7798 (0.4310) acc_x 81.2500 (88.9062) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [25/27] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.2690 (0.4294) acc_x 90.6250 (88.8750) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/22] time 0.184 (0.180) data 0.108 (0.103) loss_u loss_u 0.8677 (0.8445) acc_u 18.7500 (16.8750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/22] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9062 (0.8668) acc_u 9.3750 (15.6250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/22] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.8491 (0.8579) acc_u 15.6250 (16.2500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/22] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8403 (0.8466) acc_u 18.7500 (17.5000) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 880
clean true:860
clean false:20
clean_rate:0.9772727272727273
noisy true:430
noisy false:290
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 720
epoch [175/200] batch [5/27] time 0.185 (0.185) data 0.108 (0.109) loss_x loss_x 0.3105 (0.3953) acc_x 87.5000 (87.5000) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/27] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.2246 (0.3812) acc_x 90.6250 (88.4375) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [15/27] time 0.170 (0.184) data 0.093 (0.107) loss_x loss_x 0.4399 (0.3765) acc_x 93.7500 (89.3750) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/27] time 0.176 (0.181) data 0.100 (0.103) loss_x loss_x 0.7754 (0.4312) acc_x 75.0000 (87.8125) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [25/27] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.3252 (0.4367) acc_x 93.7500 (88.0000) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/22] time 0.193 (0.179) data 0.116 (0.102) loss_u loss_u 0.8477 (0.8712) acc_u 18.7500 (13.7500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/22] time 0.182 (0.179) data 0.105 (0.101) loss_u loss_u 0.9268 (0.8680) acc_u 9.3750 (14.3750) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/22] time 0.190 (0.179) data 0.112 (0.102) loss_u loss_u 0.8369 (0.8639) acc_u 18.7500 (15.0000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/22] time 0.187 (0.180) data 0.110 (0.103) loss_u loss_u 0.8613 (0.8718) acc_u 15.6250 (14.2188) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 297
confident_label rate tensor(0.5519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 883
clean true:867
clean false:16
clean_rate:0.9818799546998868
noisy true:436
noisy false:281
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 717
epoch [176/200] batch [5/27] time 0.185 (0.181) data 0.108 (0.105) loss_x loss_x 0.1804 (0.4651) acc_x 96.8750 (90.0000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/27] time 0.190 (0.184) data 0.113 (0.108) loss_x loss_x 0.1741 (0.4126) acc_x 96.8750 (90.0000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/27] time 0.190 (0.184) data 0.113 (0.108) loss_x loss_x 0.2505 (0.4101) acc_x 96.8750 (90.6250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/27] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.3557 (0.4131) acc_x 93.7500 (90.1562) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [25/27] time 0.188 (0.182) data 0.110 (0.106) loss_x loss_x 0.4834 (0.4006) acc_x 90.6250 (90.8750) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/22] time 0.185 (0.183) data 0.107 (0.107) loss_u loss_u 0.9253 (0.8902) acc_u 12.5000 (13.7500) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/22] time 0.199 (0.182) data 0.122 (0.105) loss_u loss_u 0.8989 (0.8850) acc_u 12.5000 (13.7500) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/22] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8408 (0.8778) acc_u 15.6250 (14.5833) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/22] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8989 (0.8784) acc_u 12.5000 (14.2188) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 294
confident_label rate tensor(0.5481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 877
clean true:862
clean false:15
clean_rate:0.9828962371721779
noisy true:444
noisy false:279
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 723
epoch [177/200] batch [5/27] time 0.177 (0.187) data 0.100 (0.110) loss_x loss_x 0.4905 (0.4179) acc_x 90.6250 (88.7500) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/27] time 0.203 (0.182) data 0.126 (0.105) loss_x loss_x 0.3779 (0.4361) acc_x 90.6250 (88.4375) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [15/27] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.5054 (0.4186) acc_x 84.3750 (88.5417) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/27] time 0.182 (0.177) data 0.106 (0.100) loss_x loss_x 0.2839 (0.4131) acc_x 96.8750 (88.9062) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [25/27] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.3542 (0.4297) acc_x 84.3750 (88.5000) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/22] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8403 (0.8800) acc_u 18.7500 (12.5000) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/22] time 0.177 (0.179) data 0.101 (0.103) loss_u loss_u 0.8174 (0.8655) acc_u 18.7500 (14.0625) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/22] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9316 (0.8633) acc_u 6.2500 (14.5833) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/22] time 0.181 (0.180) data 0.103 (0.103) loss_u loss_u 0.9185 (0.8635) acc_u 9.3750 (14.6875) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.5519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 883
clean true:868
clean false:15
clean_rate:0.9830124575311439
noisy true:425
noisy false:292
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 717
epoch [178/200] batch [5/27] time 0.192 (0.184) data 0.114 (0.107) loss_x loss_x 0.3157 (0.3678) acc_x 87.5000 (90.6250) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/27] time 0.186 (0.183) data 0.109 (0.107) loss_x loss_x 0.2778 (0.3764) acc_x 93.7500 (90.3125) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/27] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.6646 (0.4322) acc_x 84.3750 (89.1667) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/27] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.2991 (0.4533) acc_x 87.5000 (88.5938) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [25/27] time 0.179 (0.183) data 0.103 (0.106) loss_x loss_x 0.5913 (0.4655) acc_x 87.5000 (88.2500) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/22] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.8809 (0.8490) acc_u 12.5000 (16.2500) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/22] time 0.179 (0.183) data 0.102 (0.106) loss_u loss_u 0.9141 (0.8763) acc_u 9.3750 (13.1250) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/22] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8696 (0.8716) acc_u 15.6250 (13.7500) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/22] time 0.177 (0.182) data 0.101 (0.106) loss_u loss_u 0.9307 (0.8721) acc_u 9.3750 (13.7500) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.5506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 881
clean true:865
clean false:16
clean_rate:0.981838819523269
noisy true:428
noisy false:291
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 719
epoch [179/200] batch [5/27] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.5488 (0.4875) acc_x 84.3750 (84.3750) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/27] time 0.182 (0.185) data 0.105 (0.107) loss_x loss_x 0.2318 (0.4717) acc_x 90.6250 (85.6250) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/27] time 0.193 (0.186) data 0.117 (0.109) loss_x loss_x 0.3066 (0.4237) acc_x 87.5000 (87.2917) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/27] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.5586 (0.4199) acc_x 93.7500 (87.9688) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [25/27] time 0.179 (0.185) data 0.102 (0.108) loss_x loss_x 0.3203 (0.4143) acc_x 90.6250 (88.5000) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/22] time 0.171 (0.181) data 0.093 (0.104) loss_u loss_u 0.8667 (0.8584) acc_u 12.5000 (15.0000) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/22] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.8120 (0.8605) acc_u 21.8750 (15.6250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/22] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.8521 (0.8621) acc_u 18.7500 (15.8333) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/22] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.8140 (0.8625) acc_u 18.7500 (15.6250) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 869
clean true:851
clean false:18
clean_rate:0.9792865362485615
noisy true:439
noisy false:292
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 731
epoch [180/200] batch [5/27] time 0.189 (0.189) data 0.112 (0.112) loss_x loss_x 0.4021 (0.3673) acc_x 84.3750 (88.1250) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/27] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.3140 (0.3784) acc_x 87.5000 (88.7500) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/27] time 0.187 (0.184) data 0.111 (0.107) loss_x loss_x 0.2969 (0.3901) acc_x 93.7500 (88.9583) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/27] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.2739 (0.4225) acc_x 93.7500 (88.5938) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [25/27] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.5444 (0.4383) acc_x 84.3750 (88.2500) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/22] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8784 (0.8683) acc_u 9.3750 (13.7500) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/22] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9526 (0.8859) acc_u 6.2500 (12.1875) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/22] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8164 (0.8802) acc_u 18.7500 (12.7083) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/22] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8203 (0.8635) acc_u 18.7500 (14.5312) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.5412, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 866
clean true:848
clean false:18
clean_rate:0.9792147806004619
noisy true:423
noisy false:311
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 734
epoch [181/200] batch [5/27] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.2316 (0.4032) acc_x 93.7500 (88.1250) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/27] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.2864 (0.3719) acc_x 93.7500 (89.0625) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/27] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.2671 (0.3726) acc_x 87.5000 (88.7500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/27] time 0.178 (0.182) data 0.101 (0.106) loss_x loss_x 0.7173 (0.3936) acc_x 84.3750 (88.9062) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [25/27] time 0.169 (0.180) data 0.091 (0.104) loss_x loss_x 0.9824 (0.4002) acc_x 75.0000 (89.0000) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/22] time 0.187 (0.180) data 0.111 (0.103) loss_u loss_u 0.8687 (0.8694) acc_u 12.5000 (13.7500) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/22] time 0.181 (0.180) data 0.105 (0.103) loss_u loss_u 0.8525 (0.8374) acc_u 18.7500 (17.8125) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/22] time 0.177 (0.180) data 0.099 (0.103) loss_u loss_u 0.7490 (0.8482) acc_u 31.2500 (16.8750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/22] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9595 (0.8569) acc_u 3.1250 (16.0938) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:848
clean false:19
clean_rate:0.9780853517877739
noisy true:420
noisy false:313
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [182/200] batch [5/27] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.9395 (0.4873) acc_x 81.2500 (88.1250) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/27] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.4575 (0.4165) acc_x 90.6250 (89.0625) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/27] time 0.196 (0.186) data 0.120 (0.109) loss_x loss_x 0.5044 (0.4032) acc_x 90.6250 (89.3750) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/27] time 0.206 (0.187) data 0.129 (0.110) loss_x loss_x 0.7666 (0.4446) acc_x 81.2500 (88.2812) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [25/27] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.3491 (0.4560) acc_x 93.7500 (88.0000) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/22] time 0.185 (0.186) data 0.107 (0.109) loss_u loss_u 0.7798 (0.8605) acc_u 25.0000 (16.8750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/22] time 0.186 (0.186) data 0.108 (0.109) loss_u loss_u 0.8345 (0.8507) acc_u 15.6250 (17.5000) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/22] time 0.182 (0.185) data 0.106 (0.108) loss_u loss_u 0.8130 (0.8569) acc_u 25.0000 (16.8750) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/22] time 0.181 (0.185) data 0.104 (0.108) loss_u loss_u 0.9604 (0.8619) acc_u 3.1250 (16.5625) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 322
confident_label rate tensor(0.5462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 874
clean true:856
clean false:18
clean_rate:0.9794050343249427
noisy true:422
noisy false:304
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 726
epoch [183/200] batch [5/27] time 0.178 (0.180) data 0.100 (0.103) loss_x loss_x 0.5918 (0.4484) acc_x 84.3750 (88.1250) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/27] time 0.186 (0.182) data 0.110 (0.105) loss_x loss_x 0.5830 (0.4255) acc_x 84.3750 (88.4375) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/27] time 0.198 (0.183) data 0.122 (0.106) loss_x loss_x 0.1733 (0.4108) acc_x 93.7500 (88.5417) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/27] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.2983 (0.3929) acc_x 93.7500 (89.5312) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [25/27] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.4866 (0.3930) acc_x 84.3750 (89.2500) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/22] time 0.181 (0.184) data 0.104 (0.108) loss_u loss_u 0.8877 (0.8362) acc_u 9.3750 (18.7500) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/22] time 0.188 (0.184) data 0.112 (0.107) loss_u loss_u 0.9414 (0.8506) acc_u 6.2500 (17.8125) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/22] time 0.186 (0.185) data 0.109 (0.108) loss_u loss_u 0.9521 (0.8475) acc_u 6.2500 (18.1250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/22] time 0.182 (0.184) data 0.104 (0.108) loss_u loss_u 0.9624 (0.8599) acc_u 3.1250 (16.4062) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.5431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 869
clean true:850
clean false:19
clean_rate:0.9781357882623706
noisy true:418
noisy false:313
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 731
epoch [184/200] batch [5/27] time 0.182 (0.168) data 0.106 (0.091) loss_x loss_x 0.3206 (0.3335) acc_x 96.8750 (91.8750) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/27] time 0.182 (0.171) data 0.106 (0.094) loss_x loss_x 0.2866 (0.4363) acc_x 90.6250 (89.0625) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/27] time 0.174 (0.173) data 0.097 (0.096) loss_x loss_x 0.7544 (0.4610) acc_x 84.3750 (88.3333) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/27] time 0.193 (0.179) data 0.116 (0.102) loss_x loss_x 0.1871 (0.4505) acc_x 93.7500 (88.5938) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [25/27] time 0.186 (0.179) data 0.109 (0.102) loss_x loss_x 0.4216 (0.4251) acc_x 87.5000 (89.2500) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/22] time 0.190 (0.180) data 0.112 (0.103) loss_u loss_u 0.8130 (0.8696) acc_u 25.0000 (15.6250) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/22] time 0.160 (0.179) data 0.083 (0.102) loss_u loss_u 0.8198 (0.8682) acc_u 21.8750 (16.2500) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/22] time 0.182 (0.178) data 0.104 (0.101) loss_u loss_u 0.8213 (0.8658) acc_u 18.7500 (16.0417) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/22] time 0.171 (0.177) data 0.093 (0.100) loss_u loss_u 0.9370 (0.8655) acc_u 6.2500 (15.6250) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.5594, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 895
clean true:875
clean false:20
clean_rate:0.9776536312849162
noisy true:400
noisy false:305
after delete: len(clean_dataset) 895
after delete: len(noisy_dataset) 705
epoch [185/200] batch [5/27] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6943 (0.5412) acc_x 81.2500 (85.6250) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/27] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.2646 (0.4955) acc_x 93.7500 (86.2500) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/27] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.3533 (0.4648) acc_x 87.5000 (86.2500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/27] time 0.178 (0.184) data 0.102 (0.107) loss_x loss_x 0.5322 (0.4472) acc_x 87.5000 (87.3438) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [25/27] time 0.160 (0.183) data 0.083 (0.106) loss_x loss_x 0.3252 (0.4486) acc_x 87.5000 (86.8750) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/22] time 0.188 (0.185) data 0.109 (0.108) loss_u loss_u 0.8569 (0.8939) acc_u 18.7500 (12.5000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/22] time 0.180 (0.185) data 0.102 (0.108) loss_u loss_u 0.9692 (0.8918) acc_u 3.1250 (12.5000) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/22] time 0.180 (0.185) data 0.102 (0.108) loss_u loss_u 0.8618 (0.8883) acc_u 18.7500 (12.9167) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/22] time 0.174 (0.183) data 0.098 (0.106) loss_u loss_u 0.9614 (0.8830) acc_u 3.1250 (13.4375) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 300
confident_label rate tensor(0.5594, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 895
clean true:877
clean false:18
clean_rate:0.9798882681564246
noisy true:423
noisy false:282
after delete: len(clean_dataset) 895
after delete: len(noisy_dataset) 705
epoch [186/200] batch [5/27] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.1626 (0.4253) acc_x 93.7500 (88.1250) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/27] time 0.189 (0.183) data 0.113 (0.106) loss_x loss_x 0.2490 (0.4639) acc_x 87.5000 (86.8750) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/27] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.5171 (0.4741) acc_x 87.5000 (86.6667) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/27] time 0.184 (0.182) data 0.106 (0.105) loss_x loss_x 0.7817 (0.4592) acc_x 87.5000 (87.6562) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [25/27] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.6162 (0.4445) acc_x 81.2500 (87.5000) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/22] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8989 (0.8402) acc_u 15.6250 (18.1250) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/22] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9224 (0.8838) acc_u 12.5000 (14.6875) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/22] time 0.180 (0.182) data 0.102 (0.106) loss_u loss_u 0.8799 (0.8902) acc_u 15.6250 (13.7500) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/22] time 0.187 (0.182) data 0.110 (0.106) loss_u loss_u 0.9688 (0.8896) acc_u 3.1250 (13.4375) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 319
confident_label rate tensor(0.5494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 879
clean true:864
clean false:15
clean_rate:0.9829351535836177
noisy true:417
noisy false:304
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 721
epoch [187/200] batch [5/27] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5317 (0.5003) acc_x 90.6250 (85.6250) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/27] time 0.174 (0.177) data 0.098 (0.100) loss_x loss_x 0.5190 (0.4895) acc_x 87.5000 (86.8750) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/27] time 0.178 (0.179) data 0.102 (0.102) loss_x loss_x 0.3770 (0.4846) acc_x 90.6250 (88.1250) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/27] time 0.193 (0.181) data 0.116 (0.104) loss_x loss_x 0.3345 (0.4853) acc_x 90.6250 (87.9688) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [25/27] time 0.185 (0.180) data 0.108 (0.104) loss_x loss_x 0.1377 (0.4765) acc_x 96.8750 (87.7500) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/22] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.9272 (0.8967) acc_u 9.3750 (10.6250) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/22] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.8110 (0.8747) acc_u 21.8750 (13.7500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/22] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9185 (0.8788) acc_u 9.3750 (13.5417) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/22] time 0.181 (0.181) data 0.105 (0.104) loss_u loss_u 0.8877 (0.8780) acc_u 12.5000 (13.4375) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.5537, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 886
clean true:869
clean false:17
clean_rate:0.9808126410835214
noisy true:422
noisy false:292
after delete: len(clean_dataset) 886
after delete: len(noisy_dataset) 714
epoch [188/200] batch [5/27] time 0.180 (0.173) data 0.104 (0.096) loss_x loss_x 0.8750 (0.5497) acc_x 81.2500 (86.2500) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/27] time 0.182 (0.178) data 0.105 (0.102) loss_x loss_x 0.6396 (0.4869) acc_x 81.2500 (88.1250) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/27] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.5776 (0.4817) acc_x 84.3750 (87.2917) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/27] time 0.177 (0.180) data 0.101 (0.103) loss_x loss_x 0.5894 (0.4551) acc_x 87.5000 (87.9688) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [25/27] time 0.187 (0.181) data 0.111 (0.104) loss_x loss_x 0.4795 (0.4695) acc_x 81.2500 (87.1250) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/22] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8550 (0.9197) acc_u 15.6250 (8.1250) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/22] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.8945 (0.9074) acc_u 15.6250 (10.9375) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/22] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8428 (0.8963) acc_u 15.6250 (11.8750) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/22] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8735 (0.8846) acc_u 15.6250 (13.5938) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.5400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 864
clean true:847
clean false:17
clean_rate:0.9803240740740741
noisy true:430
noisy false:306
after delete: len(clean_dataset) 864
after delete: len(noisy_dataset) 736
epoch [189/200] batch [5/27] time 0.166 (0.176) data 0.090 (0.099) loss_x loss_x 0.3557 (0.3997) acc_x 93.7500 (91.8750) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/27] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.1658 (0.3612) acc_x 96.8750 (91.8750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/27] time 0.181 (0.176) data 0.104 (0.099) loss_x loss_x 0.5264 (0.3552) acc_x 81.2500 (91.6667) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/27] time 0.176 (0.176) data 0.100 (0.100) loss_x loss_x 0.7646 (0.3674) acc_x 84.3750 (91.0938) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [25/27] time 0.216 (0.179) data 0.139 (0.102) loss_x loss_x 0.7056 (0.3774) acc_x 87.5000 (91.0000) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/23] time 0.182 (0.181) data 0.106 (0.104) loss_u loss_u 0.8618 (0.8694) acc_u 15.6250 (15.0000) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/23] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9209 (0.8635) acc_u 9.3750 (15.9375) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/23] time 0.171 (0.181) data 0.093 (0.104) loss_u loss_u 0.9019 (0.8685) acc_u 12.5000 (15.0000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/23] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9097 (0.8666) acc_u 12.5000 (15.0000) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 301
confident_label rate tensor(0.5637, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 902
clean true:880
clean false:22
clean_rate:0.975609756097561
noisy true:419
noisy false:279
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 698
epoch [190/200] batch [5/28] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.2793 (0.4134) acc_x 93.7500 (89.3750) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/28] time 0.198 (0.182) data 0.121 (0.105) loss_x loss_x 0.6362 (0.3943) acc_x 90.6250 (90.9375) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [15/28] time 0.210 (0.183) data 0.133 (0.106) loss_x loss_x 0.9941 (0.4521) acc_x 84.3750 (89.1667) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/28] time 0.200 (0.184) data 0.123 (0.107) loss_x loss_x 0.8174 (0.4435) acc_x 75.0000 (88.9062) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [25/28] time 0.195 (0.186) data 0.119 (0.109) loss_x loss_x 0.5386 (0.4683) acc_x 78.1250 (88.3750) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/21] time 0.181 (0.187) data 0.103 (0.110) loss_u loss_u 0.8506 (0.8867) acc_u 18.7500 (12.5000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/21] time 0.175 (0.187) data 0.098 (0.110) loss_u loss_u 0.8848 (0.9033) acc_u 15.6250 (10.6250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/21] time 0.192 (0.184) data 0.114 (0.107) loss_u loss_u 0.9023 (0.8996) acc_u 9.3750 (10.8333) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/21] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.8462 (0.8847) acc_u 18.7500 (12.6562) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.5531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 885
clean true:867
clean false:18
clean_rate:0.9796610169491525
noisy true:435
noisy false:280
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 715
epoch [191/200] batch [5/27] time 0.182 (0.179) data 0.106 (0.103) loss_x loss_x 0.4988 (0.4983) acc_x 87.5000 (86.8750) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/27] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.5254 (0.4602) acc_x 90.6250 (87.1875) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/27] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.2344 (0.4588) acc_x 96.8750 (87.5000) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/27] time 0.188 (0.182) data 0.111 (0.106) loss_x loss_x 0.1688 (0.4366) acc_x 100.0000 (88.9062) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [25/27] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 0.9990 (0.4769) acc_x 71.8750 (87.6250) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/22] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.8940 (0.9083) acc_u 9.3750 (8.7500) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/22] time 0.180 (0.183) data 0.103 (0.106) loss_u loss_u 0.8594 (0.8960) acc_u 15.6250 (10.9375) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/22] time 0.176 (0.183) data 0.098 (0.106) loss_u loss_u 0.8145 (0.8836) acc_u 18.7500 (12.2917) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/22] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.9385 (0.8802) acc_u 6.2500 (13.1250) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.5444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 871
clean true:848
clean false:23
clean_rate:0.9735935706084959
noisy true:429
noisy false:300
after delete: len(clean_dataset) 871
after delete: len(noisy_dataset) 729
epoch [192/200] batch [5/27] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.5776 (0.5104) acc_x 81.2500 (86.2500) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/27] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.5776 (0.4998) acc_x 87.5000 (86.5625) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/27] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.4187 (0.5005) acc_x 90.6250 (86.8750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/27] time 0.179 (0.182) data 0.102 (0.106) loss_x loss_x 0.3433 (0.4795) acc_x 87.5000 (87.6562) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [25/27] time 0.186 (0.182) data 0.110 (0.105) loss_x loss_x 0.6152 (0.4529) acc_x 81.2500 (88.2500) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/22] time 0.179 (0.181) data 0.103 (0.105) loss_u loss_u 0.9375 (0.8994) acc_u 6.2500 (10.6250) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/22] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8174 (0.8736) acc_u 18.7500 (13.4375) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/22] time 0.178 (0.181) data 0.100 (0.104) loss_u loss_u 0.7275 (0.8549) acc_u 28.1250 (15.6250) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/22] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8408 (0.8573) acc_u 15.6250 (15.9375) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.5481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 877
clean true:861
clean false:16
clean_rate:0.9817559863169898
noisy true:423
noisy false:300
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 723
epoch [193/200] batch [5/27] time 0.187 (0.182) data 0.110 (0.106) loss_x loss_x 0.1078 (0.4100) acc_x 96.8750 (89.3750) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/27] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.3650 (0.4333) acc_x 93.7500 (88.1250) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/27] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.1448 (0.3929) acc_x 96.8750 (89.5833) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/27] time 0.179 (0.182) data 0.102 (0.106) loss_x loss_x 0.2874 (0.3918) acc_x 90.6250 (89.3750) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [25/27] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.3860 (0.4281) acc_x 93.7500 (88.6250) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/22] time 0.179 (0.182) data 0.103 (0.105) loss_u loss_u 0.9702 (0.9376) acc_u 3.1250 (6.2500) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/22] time 0.189 (0.184) data 0.111 (0.107) loss_u loss_u 0.8506 (0.8970) acc_u 15.6250 (10.9375) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/22] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.8506 (0.8884) acc_u 15.6250 (12.0833) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/22] time 0.179 (0.184) data 0.103 (0.107) loss_u loss_u 0.8423 (0.8707) acc_u 25.0000 (14.6875) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.5525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 884
clean true:865
clean false:19
clean_rate:0.9785067873303167
noisy true:426
noisy false:290
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 716
epoch [194/200] batch [5/27] time 0.159 (0.169) data 0.082 (0.092) loss_x loss_x 0.4492 (0.4323) acc_x 84.3750 (88.7500) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/27] time 0.184 (0.171) data 0.107 (0.094) loss_x loss_x 0.6152 (0.4887) acc_x 81.2500 (86.8750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/27] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.3738 (0.4979) acc_x 87.5000 (86.6667) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/27] time 0.183 (0.176) data 0.107 (0.099) loss_x loss_x 0.3120 (0.4446) acc_x 90.6250 (88.5938) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [25/27] time 0.181 (0.177) data 0.104 (0.101) loss_x loss_x 0.4126 (0.4393) acc_x 87.5000 (88.8750) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/22] time 0.191 (0.178) data 0.114 (0.102) loss_u loss_u 0.8716 (0.8890) acc_u 12.5000 (12.5000) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/22] time 0.183 (0.179) data 0.106 (0.103) loss_u loss_u 0.8809 (0.8705) acc_u 15.6250 (14.6875) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/22] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8828 (0.8698) acc_u 12.5000 (14.7917) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/22] time 0.183 (0.180) data 0.107 (0.103) loss_u loss_u 0.8496 (0.8701) acc_u 15.6250 (14.3750) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 319
confident_label rate tensor(0.5537, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 886
clean true:864
clean false:22
clean_rate:0.9751693002257337
noisy true:417
noisy false:297
after delete: len(clean_dataset) 886
after delete: len(noisy_dataset) 714
epoch [195/200] batch [5/27] time 0.177 (0.184) data 0.101 (0.107) loss_x loss_x 0.4272 (0.4488) acc_x 87.5000 (88.7500) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/27] time 0.190 (0.182) data 0.113 (0.106) loss_x loss_x 0.3640 (0.4230) acc_x 93.7500 (90.0000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/27] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.9424 (0.5229) acc_x 78.1250 (87.0833) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/27] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.7007 (0.5225) acc_x 90.6250 (87.8125) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [25/27] time 0.181 (0.183) data 0.103 (0.106) loss_x loss_x 0.2163 (0.4886) acc_x 93.7500 (88.6250) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/22] time 0.169 (0.181) data 0.091 (0.104) loss_u loss_u 0.9150 (0.8772) acc_u 12.5000 (14.3750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/22] time 0.181 (0.180) data 0.103 (0.103) loss_u loss_u 0.9707 (0.8831) acc_u 3.1250 (13.7500) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/22] time 0.171 (0.180) data 0.094 (0.102) loss_u loss_u 0.8750 (0.8818) acc_u 15.6250 (13.9583) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/22] time 0.184 (0.180) data 0.107 (0.102) loss_u loss_u 0.7651 (0.8700) acc_u 28.1250 (15.1562) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 301
confident_label rate tensor(0.5494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 879
clean true:864
clean false:15
clean_rate:0.9829351535836177
noisy true:435
noisy false:286
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 721
epoch [196/200] batch [5/27] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.4170 (0.3989) acc_x 87.5000 (88.7500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/27] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.3323 (0.3632) acc_x 90.6250 (90.6250) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/27] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.5879 (0.4081) acc_x 84.3750 (90.2083) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/27] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.2241 (0.3947) acc_x 93.7500 (89.8438) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [25/27] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.3870 (0.4104) acc_x 93.7500 (89.5000) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/22] time 0.188 (0.183) data 0.110 (0.106) loss_u loss_u 0.9434 (0.8712) acc_u 6.2500 (15.0000) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/22] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.8672 (0.8763) acc_u 15.6250 (14.3750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/22] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.9238 (0.8714) acc_u 9.3750 (15.0000) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/22] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9360 (0.8729) acc_u 6.2500 (14.6875) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 306
confident_label rate tensor(0.5569, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 891
clean true:876
clean false:15
clean_rate:0.9831649831649831
noisy true:418
noisy false:291
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 709
epoch [197/200] batch [5/27] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.3857 (0.4852) acc_x 84.3750 (87.5000) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/27] time 0.186 (0.184) data 0.110 (0.107) loss_x loss_x 0.2440 (0.3875) acc_x 93.7500 (89.3750) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/27] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.6699 (0.4628) acc_x 84.3750 (89.1667) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/27] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.2471 (0.4542) acc_x 93.7500 (89.2188) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [25/27] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.5742 (0.4563) acc_x 81.2500 (88.6250) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/22] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.8501 (0.8935) acc_u 15.6250 (11.8750) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/22] time 0.176 (0.182) data 0.099 (0.105) loss_u loss_u 0.8462 (0.8765) acc_u 15.6250 (13.7500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/22] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8516 (0.8754) acc_u 18.7500 (14.1667) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/22] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8774 (0.8790) acc_u 12.5000 (13.5938) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 294
confident_label rate tensor(0.5525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 884
clean true:866
clean false:18
clean_rate:0.9796380090497737
noisy true:440
noisy false:276
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 716
epoch [198/200] batch [5/27] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.5645 (0.3828) acc_x 87.5000 (90.0000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/27] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.5366 (0.3913) acc_x 81.2500 (89.3750) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/27] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.1528 (0.3485) acc_x 93.7500 (89.7917) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/27] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.3486 (0.3821) acc_x 93.7500 (88.9062) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [25/27] time 0.181 (0.180) data 0.105 (0.103) loss_x loss_x 0.4956 (0.4040) acc_x 84.3750 (88.5000) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/22] time 0.193 (0.181) data 0.116 (0.104) loss_u loss_u 0.9194 (0.8669) acc_u 9.3750 (15.6250) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/22] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.8550 (0.8604) acc_u 18.7500 (15.9375) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/22] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9238 (0.8669) acc_u 12.5000 (15.2083) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/22] time 0.180 (0.183) data 0.104 (0.106) loss_u loss_u 0.8428 (0.8688) acc_u 15.6250 (14.8438) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 884
clean true:866
clean false:18
clean_rate:0.9796380090497737
noisy true:424
noisy false:292
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 716
epoch [199/200] batch [5/27] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.4868 (0.4046) acc_x 81.2500 (91.2500) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/27] time 0.185 (0.182) data 0.107 (0.105) loss_x loss_x 0.3672 (0.4218) acc_x 81.2500 (89.0625) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/27] time 0.172 (0.179) data 0.096 (0.102) loss_x loss_x 0.5410 (0.4458) acc_x 84.3750 (88.7500) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/27] time 0.184 (0.176) data 0.108 (0.099) loss_x loss_x 0.1136 (0.4072) acc_x 96.8750 (89.6875) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [25/27] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.5342 (0.4240) acc_x 87.5000 (89.0000) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/22] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8901 (0.8994) acc_u 9.3750 (10.6250) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/22] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.9253 (0.8935) acc_u 9.3750 (12.1875) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/22] time 0.176 (0.179) data 0.100 (0.102) loss_u loss_u 0.8867 (0.8859) acc_u 12.5000 (12.7083) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/22] time 0.181 (0.179) data 0.103 (0.102) loss_u loss_u 0.8135 (0.8788) acc_u 25.0000 (13.4375) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 317
confident_label rate tensor(0.5444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 871
clean true:855
clean false:16
clean_rate:0.981630309988519
noisy true:428
noisy false:301
after delete: len(clean_dataset) 871
after delete: len(noisy_dataset) 729
epoch [200/200] batch [5/27] time 0.183 (0.182) data 0.105 (0.105) loss_x loss_x 0.4031 (0.4759) acc_x 87.5000 (85.6250) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/27] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 0.1295 (0.4685) acc_x 93.7500 (86.5625) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/27] time 0.162 (0.178) data 0.085 (0.101) loss_x loss_x 0.5186 (0.4541) acc_x 90.6250 (87.2917) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/27] time 0.160 (0.173) data 0.083 (0.096) loss_x loss_x 0.4336 (0.4609) acc_x 90.6250 (87.3438) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [25/27] time 0.157 (0.170) data 0.080 (0.093) loss_x loss_x 0.2778 (0.4516) acc_x 93.7500 (87.8750) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/22] time 0.163 (0.168) data 0.086 (0.091) loss_u loss_u 0.8062 (0.8457) acc_u 25.0000 (18.1250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/22] time 0.159 (0.167) data 0.082 (0.090) loss_u loss_u 0.8486 (0.8514) acc_u 15.6250 (17.5000) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/22] time 0.158 (0.166) data 0.080 (0.089) loss_u loss_u 0.9316 (0.8712) acc_u 9.3750 (14.7917) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/22] time 0.157 (0.165) data 0.079 (0.088) loss_u loss_u 0.8335 (0.8677) acc_u 18.7500 (15.0000) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,210
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 84.8%
Elapsed: 0:58:29
