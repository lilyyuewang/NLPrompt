***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '100']
output_dir: output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 845
confident_label rate tensor(0.1181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 189
clean true:179
clean false:10
clean_rate:0.9470899470899471
noisy true:576
noisy false:835
after delete: len(clean_dataset) 189
after delete: len(noisy_dataset) 1411
epoch [1/200] batch [5/5] time 0.165 (0.195) data 0.089 (0.099) loss_x loss_x 2.5508 (2.7918) acc_x 56.2500 (60.0000) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/44] time 0.202 (0.189) data 0.125 (0.101) loss_u loss_u 0.9727 (0.9805) acc_u 3.1250 (5.6250) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [10/44] time 0.186 (0.191) data 0.109 (0.106) loss_u loss_u 0.9912 (0.9837) acc_u 0.0000 (3.7500) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [15/44] time 0.195 (0.190) data 0.118 (0.107) loss_u loss_u 0.9639 (0.9796) acc_u 6.2500 (4.1667) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [20/44] time 0.233 (0.189) data 0.156 (0.107) loss_u loss_u 0.9683 (0.9788) acc_u 3.1250 (3.7500) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [25/44] time 0.226 (0.194) data 0.146 (0.113) loss_u loss_u 0.9839 (0.9783) acc_u 3.1250 (3.5000) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [30/44] time 0.197 (0.197) data 0.120 (0.116) loss_u loss_u 0.9780 (0.9795) acc_u 9.3750 (3.3333) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [35/44] time 0.190 (0.196) data 0.113 (0.115) loss_u loss_u 0.9697 (0.9792) acc_u 6.2500 (3.3929) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [40/44] time 0.195 (0.195) data 0.118 (0.115) loss_u loss_u 0.9814 (0.9796) acc_u 3.1250 (3.2812) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 852
confident_label rate tensor(0.1319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 211
clean true:192
clean false:19
clean_rate:0.909952606635071
noisy true:556
noisy false:833
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 1389
epoch [2/200] batch [5/6] time 0.169 (0.177) data 0.092 (0.101) loss_x loss_x 0.9253 (1.4923) acc_x 71.8750 (61.8750) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/43] time 0.194 (0.180) data 0.116 (0.103) loss_u loss_u 0.9111 (0.9181) acc_u 12.5000 (12.5000) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [10/43] time 0.172 (0.181) data 0.094 (0.103) loss_u loss_u 0.9678 (0.9305) acc_u 3.1250 (9.6875) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [15/43] time 0.167 (0.179) data 0.090 (0.102) loss_u loss_u 0.9629 (0.9368) acc_u 3.1250 (8.1250) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [20/43] time 0.182 (0.179) data 0.105 (0.101) loss_u loss_u 0.9458 (0.9329) acc_u 9.3750 (8.5938) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [25/43] time 0.191 (0.180) data 0.113 (0.102) loss_u loss_u 0.8799 (0.9277) acc_u 15.6250 (9.2500) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [30/43] time 0.162 (0.179) data 0.085 (0.102) loss_u loss_u 0.9390 (0.9253) acc_u 6.2500 (9.2708) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [35/43] time 0.179 (0.180) data 0.101 (0.102) loss_u loss_u 0.9102 (0.9249) acc_u 12.5000 (9.2857) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [40/43] time 0.179 (0.181) data 0.102 (0.104) loss_u loss_u 0.9790 (0.9266) acc_u 3.1250 (9.1406) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 537
confident_label rate tensor(0.1700, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 272
clean true:263
clean false:9
clean_rate:0.9669117647058824
noisy true:800
noisy false:528
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 1328
epoch [3/200] batch [5/8] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.9971 (1.1951) acc_x 75.0000 (70.0000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/41] time 0.193 (0.180) data 0.116 (0.103) loss_u loss_u 0.9780 (0.9449) acc_u 3.1250 (7.5000) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [10/41] time 0.179 (0.178) data 0.101 (0.101) loss_u loss_u 0.9531 (0.9452) acc_u 9.3750 (7.5000) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [15/41] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9810 (0.9479) acc_u 3.1250 (6.4583) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [20/41] time 0.192 (0.180) data 0.114 (0.103) loss_u loss_u 0.9497 (0.9521) acc_u 6.2500 (5.9375) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [25/41] time 0.180 (0.180) data 0.101 (0.103) loss_u loss_u 0.9292 (0.9507) acc_u 9.3750 (5.8750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [30/41] time 0.176 (0.180) data 0.099 (0.103) loss_u loss_u 0.9946 (0.9507) acc_u 0.0000 (5.7292) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [35/41] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.9849 (0.9522) acc_u 0.0000 (5.4464) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [40/41] time 0.177 (0.179) data 0.100 (0.101) loss_u loss_u 0.9937 (0.9528) acc_u 0.0000 (5.3906) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 523
confident_label rate tensor(0.1781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 285
clean true:273
clean false:12
clean_rate:0.9578947368421052
noisy true:804
noisy false:511
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 1315
epoch [4/200] batch [5/8] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.6870 (0.9794) acc_x 87.5000 (76.2500) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/41] time 0.167 (0.178) data 0.090 (0.101) loss_u loss_u 0.9360 (0.9538) acc_u 6.2500 (5.0000) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [10/41] time 0.162 (0.174) data 0.084 (0.097) loss_u loss_u 0.9922 (0.9563) acc_u 0.0000 (4.0625) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [15/41] time 0.160 (0.171) data 0.083 (0.094) loss_u loss_u 0.9980 (0.9554) acc_u 0.0000 (4.5833) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [20/41] time 0.160 (0.170) data 0.083 (0.093) loss_u loss_u 0.9751 (0.9564) acc_u 0.0000 (4.3750) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [25/41] time 0.162 (0.170) data 0.085 (0.092) loss_u loss_u 0.9912 (0.9568) acc_u 0.0000 (4.5000) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [30/41] time 0.167 (0.170) data 0.090 (0.093) loss_u loss_u 0.9399 (0.9561) acc_u 6.2500 (4.4792) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [35/41] time 0.170 (0.171) data 0.093 (0.094) loss_u loss_u 0.9800 (0.9583) acc_u 3.1250 (4.3750) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [40/41] time 0.172 (0.171) data 0.095 (0.094) loss_u loss_u 0.9526 (0.9579) acc_u 6.2500 (4.4531) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 493
confident_label rate tensor(0.1812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 290
clean true:280
clean false:10
clean_rate:0.9655172413793104
noisy true:827
noisy false:483
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 1310
epoch [5/200] batch [5/9] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.7734 (0.6613) acc_x 81.2500 (82.5000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/40] time 0.183 (0.184) data 0.107 (0.107) loss_u loss_u 0.9639 (0.9703) acc_u 3.1250 (3.1250) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [10/40] time 0.186 (0.183) data 0.110 (0.106) loss_u loss_u 0.9619 (0.9595) acc_u 3.1250 (4.0625) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [15/40] time 0.176 (0.182) data 0.097 (0.105) loss_u loss_u 0.9688 (0.9572) acc_u 3.1250 (4.3750) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [20/40] time 0.159 (0.179) data 0.081 (0.102) loss_u loss_u 0.9497 (0.9541) acc_u 6.2500 (4.6875) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [25/40] time 0.166 (0.178) data 0.087 (0.101) loss_u loss_u 0.9941 (0.9578) acc_u 0.0000 (4.3750) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [30/40] time 0.172 (0.177) data 0.095 (0.099) loss_u loss_u 0.9829 (0.9556) acc_u 0.0000 (4.4792) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [35/40] time 0.182 (0.178) data 0.105 (0.100) loss_u loss_u 0.9761 (0.9568) acc_u 0.0000 (4.1964) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [40/40] time 0.175 (0.177) data 0.097 (0.099) loss_u loss_u 0.9990 (0.9585) acc_u 0.0000 (3.9844) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 489
confident_label rate tensor(0.1831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 293
clean true:281
clean false:12
clean_rate:0.9590443686006825
noisy true:830
noisy false:477
after delete: len(clean_dataset) 293
after delete: len(noisy_dataset) 1307
epoch [6/200] batch [5/9] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 1.1748 (0.9998) acc_x 65.6250 (71.2500) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/40] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.9619 (0.9590) acc_u 6.2500 (6.2500) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [10/40] time 0.181 (0.179) data 0.103 (0.102) loss_u loss_u 0.8906 (0.9531) acc_u 12.5000 (5.9375) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [15/40] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.9321 (0.9540) acc_u 15.6250 (6.2500) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [20/40] time 0.159 (0.180) data 0.082 (0.102) loss_u loss_u 0.9180 (0.9562) acc_u 6.2500 (5.6250) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [25/40] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.9819 (0.9548) acc_u 0.0000 (5.5000) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [30/40] time 0.172 (0.178) data 0.094 (0.101) loss_u loss_u 0.9595 (0.9572) acc_u 3.1250 (5.1042) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [35/40] time 0.174 (0.178) data 0.097 (0.101) loss_u loss_u 0.9360 (0.9594) acc_u 6.2500 (4.7321) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [40/40] time 0.159 (0.177) data 0.082 (0.100) loss_u loss_u 0.9409 (0.9584) acc_u 6.2500 (4.8438) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.1819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 291
clean true:282
clean false:9
clean_rate:0.9690721649484536
noisy true:836
noisy false:473
after delete: len(clean_dataset) 291
after delete: len(noisy_dataset) 1309
epoch [7/200] batch [5/9] time 0.170 (0.166) data 0.093 (0.089) loss_x loss_x 1.0742 (0.9141) acc_x 71.8750 (75.0000) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/40] time 0.162 (0.169) data 0.085 (0.092) loss_u loss_u 0.9570 (0.9449) acc_u 0.0000 (5.0000) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [10/40] time 0.169 (0.170) data 0.091 (0.093) loss_u loss_u 0.9292 (0.9449) acc_u 6.2500 (4.6875) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [15/40] time 0.179 (0.171) data 0.102 (0.094) loss_u loss_u 0.9473 (0.9470) acc_u 3.1250 (5.4167) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [20/40] time 0.188 (0.172) data 0.110 (0.094) loss_u loss_u 0.9941 (0.9518) acc_u 0.0000 (4.6875) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [25/40] time 0.178 (0.173) data 0.100 (0.095) loss_u loss_u 0.9458 (0.9538) acc_u 6.2500 (4.6250) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [30/40] time 0.184 (0.174) data 0.105 (0.097) loss_u loss_u 0.9521 (0.9522) acc_u 6.2500 (4.7917) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [35/40] time 0.172 (0.174) data 0.095 (0.097) loss_u loss_u 0.9492 (0.9505) acc_u 3.1250 (5.0000) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [40/40] time 0.191 (0.175) data 0.113 (0.097) loss_u loss_u 0.9526 (0.9504) acc_u 3.1250 (5.0781) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 461
confident_label rate tensor(0.1831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 293
clean true:285
clean false:8
clean_rate:0.9726962457337884
noisy true:854
noisy false:453
after delete: len(clean_dataset) 293
after delete: len(noisy_dataset) 1307
epoch [8/200] batch [5/9] time 0.182 (0.171) data 0.105 (0.095) loss_x loss_x 0.9370 (0.9568) acc_x 75.0000 (76.8750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/40] time 0.161 (0.169) data 0.084 (0.092) loss_u loss_u 0.9985 (0.9617) acc_u 0.0000 (5.0000) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [10/40] time 0.164 (0.170) data 0.088 (0.093) loss_u loss_u 0.9731 (0.9527) acc_u 3.1250 (6.2500) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [15/40] time 0.175 (0.170) data 0.098 (0.093) loss_u loss_u 0.9893 (0.9516) acc_u 0.0000 (6.0417) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [20/40] time 0.168 (0.172) data 0.091 (0.095) loss_u loss_u 0.9092 (0.9443) acc_u 6.2500 (6.4062) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [25/40] time 0.210 (0.173) data 0.132 (0.096) loss_u loss_u 0.9619 (0.9489) acc_u 3.1250 (5.7500) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [30/40] time 0.186 (0.174) data 0.110 (0.097) loss_u loss_u 0.9492 (0.9502) acc_u 6.2500 (5.7292) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [35/40] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.9043 (0.9478) acc_u 9.3750 (6.0714) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [40/40] time 0.170 (0.174) data 0.093 (0.097) loss_u loss_u 0.9668 (0.9477) acc_u 3.1250 (6.0938) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 518
confident_label rate tensor(0.1769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 283
clean true:270
clean false:13
clean_rate:0.9540636042402827
noisy true:812
noisy false:505
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 1317
epoch [9/200] batch [5/8] time 0.182 (0.190) data 0.105 (0.113) loss_x loss_x 0.9644 (0.8973) acc_x 81.2500 (77.5000) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/41] time 0.191 (0.186) data 0.114 (0.109) loss_u loss_u 0.9585 (0.9419) acc_u 3.1250 (7.5000) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [10/41] time 0.205 (0.186) data 0.128 (0.109) loss_u loss_u 0.9741 (0.9498) acc_u 3.1250 (6.2500) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [15/41] time 0.175 (0.185) data 0.098 (0.108) loss_u loss_u 0.9321 (0.9467) acc_u 6.2500 (6.4583) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [20/41] time 0.188 (0.185) data 0.111 (0.108) loss_u loss_u 0.9297 (0.9423) acc_u 9.3750 (6.7188) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [25/41] time 0.161 (0.182) data 0.084 (0.105) loss_u loss_u 0.9526 (0.9456) acc_u 6.2500 (6.3750) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [30/41] time 0.161 (0.180) data 0.084 (0.103) loss_u loss_u 0.9541 (0.9447) acc_u 6.2500 (6.3542) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [35/41] time 0.190 (0.179) data 0.112 (0.102) loss_u loss_u 0.9263 (0.9461) acc_u 12.5000 (6.1607) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [40/41] time 0.190 (0.179) data 0.112 (0.102) loss_u loss_u 0.9126 (0.9447) acc_u 9.3750 (6.3281) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 497
confident_label rate tensor(0.1837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 294
clean true:284
clean false:10
clean_rate:0.9659863945578231
noisy true:819
noisy false:487
after delete: len(clean_dataset) 294
after delete: len(noisy_dataset) 1306
epoch [10/200] batch [5/9] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 1.0381 (0.7779) acc_x 71.8750 (80.0000) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/40] time 0.162 (0.177) data 0.086 (0.101) loss_u loss_u 0.9448 (0.9575) acc_u 3.1250 (3.7500) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [10/40] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.9482 (0.9566) acc_u 3.1250 (4.3750) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [15/40] time 0.181 (0.175) data 0.103 (0.099) loss_u loss_u 0.9434 (0.9516) acc_u 9.3750 (5.2083) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [20/40] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9741 (0.9526) acc_u 3.1250 (5.1562) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [25/40] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.9629 (0.9527) acc_u 6.2500 (5.2500) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [30/40] time 0.178 (0.176) data 0.100 (0.099) loss_u loss_u 0.9741 (0.9534) acc_u 3.1250 (5.1042) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [35/40] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9663 (0.9534) acc_u 3.1250 (5.3571) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [40/40] time 0.200 (0.178) data 0.121 (0.101) loss_u loss_u 0.9429 (0.9533) acc_u 6.2500 (5.3125) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.1887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 302
clean true:290
clean false:12
clean_rate:0.9602649006622517
noisy true:844
noisy false:454
after delete: len(clean_dataset) 302
after delete: len(noisy_dataset) 1298
epoch [11/200] batch [5/9] time 0.176 (0.186) data 0.100 (0.109) loss_x loss_x 0.8223 (0.9817) acc_x 75.0000 (75.6250) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/40] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.9980 (0.9846) acc_u 0.0000 (1.2500) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [10/40] time 0.217 (0.185) data 0.140 (0.107) loss_u loss_u 0.9683 (0.9568) acc_u 3.1250 (4.6875) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [15/40] time 0.176 (0.184) data 0.100 (0.107) loss_u loss_u 0.9199 (0.9571) acc_u 9.3750 (4.7917) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [20/40] time 0.161 (0.182) data 0.083 (0.104) loss_u loss_u 0.9092 (0.9603) acc_u 9.3750 (4.3750) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [25/40] time 0.169 (0.181) data 0.093 (0.104) loss_u loss_u 0.9419 (0.9564) acc_u 9.3750 (4.8750) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [30/40] time 0.194 (0.181) data 0.118 (0.104) loss_u loss_u 0.9912 (0.9573) acc_u 0.0000 (4.7917) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [35/40] time 0.189 (0.181) data 0.113 (0.104) loss_u loss_u 0.9512 (0.9580) acc_u 6.2500 (4.8214) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [40/40] time 0.190 (0.182) data 0.111 (0.105) loss_u loss_u 0.9399 (0.9551) acc_u 9.3750 (5.1562) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.1962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 314
clean true:294
clean false:20
clean_rate:0.9363057324840764
noisy true:821
noisy false:465
after delete: len(clean_dataset) 314
after delete: len(noisy_dataset) 1286
epoch [12/200] batch [5/9] time 0.174 (0.173) data 0.097 (0.096) loss_x loss_x 0.6582 (0.8337) acc_x 87.5000 (78.7500) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/40] time 0.165 (0.172) data 0.088 (0.095) loss_u loss_u 0.9873 (0.9686) acc_u 0.0000 (3.1250) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [10/40] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.9883 (0.9734) acc_u 3.1250 (3.4375) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [15/40] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.9780 (0.9680) acc_u 3.1250 (4.1667) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [20/40] time 0.186 (0.177) data 0.110 (0.099) loss_u loss_u 0.9780 (0.9626) acc_u 3.1250 (4.8438) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [25/40] time 0.187 (0.178) data 0.110 (0.100) loss_u loss_u 0.9707 (0.9588) acc_u 3.1250 (5.2500) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [30/40] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9375 (0.9589) acc_u 9.3750 (5.2083) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [35/40] time 0.188 (0.177) data 0.110 (0.100) loss_u loss_u 0.9741 (0.9599) acc_u 3.1250 (4.9107) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [40/40] time 0.260 (0.180) data 0.182 (0.102) loss_u loss_u 0.9946 (0.9616) acc_u 0.0000 (4.6875) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 476
confident_label rate tensor(0.1962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 314
clean true:299
clean false:15
clean_rate:0.9522292993630573
noisy true:825
noisy false:461
after delete: len(clean_dataset) 314
after delete: len(noisy_dataset) 1286
epoch [13/200] batch [5/9] time 0.184 (0.172) data 0.107 (0.094) loss_x loss_x 0.2385 (0.8444) acc_x 93.7500 (79.3750) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/40] time 0.169 (0.186) data 0.091 (0.108) loss_u loss_u 0.9351 (0.9533) acc_u 6.2500 (5.0000) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [10/40] time 0.187 (0.184) data 0.109 (0.106) loss_u loss_u 0.9507 (0.9622) acc_u 6.2500 (3.7500) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [15/40] time 0.180 (0.184) data 0.103 (0.106) loss_u loss_u 0.8999 (0.9565) acc_u 12.5000 (4.7917) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [20/40] time 0.165 (0.182) data 0.086 (0.105) loss_u loss_u 0.9570 (0.9531) acc_u 9.3750 (5.3125) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [25/40] time 0.169 (0.181) data 0.092 (0.103) loss_u loss_u 0.9087 (0.9532) acc_u 12.5000 (5.5000) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [30/40] time 0.183 (0.180) data 0.106 (0.102) loss_u loss_u 0.9517 (0.9528) acc_u 6.2500 (5.5208) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [35/40] time 0.167 (0.180) data 0.090 (0.102) loss_u loss_u 0.8872 (0.9529) acc_u 15.6250 (5.5357) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [40/40] time 0.181 (0.179) data 0.102 (0.102) loss_u loss_u 0.9194 (0.9521) acc_u 9.3750 (5.6250) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.1894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 303
clean true:289
clean false:14
clean_rate:0.9537953795379538
noisy true:840
noisy false:457
after delete: len(clean_dataset) 303
after delete: len(noisy_dataset) 1297
epoch [14/200] batch [5/9] time 0.170 (0.177) data 0.094 (0.100) loss_x loss_x 1.0508 (1.1092) acc_x 71.8750 (74.3750) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/40] time 0.175 (0.179) data 0.097 (0.102) loss_u loss_u 0.9111 (0.9593) acc_u 9.3750 (5.6250) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [10/40] time 0.174 (0.180) data 0.097 (0.102) loss_u loss_u 0.9956 (0.9700) acc_u 0.0000 (4.0625) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [15/40] time 0.185 (0.178) data 0.107 (0.100) loss_u loss_u 0.9258 (0.9606) acc_u 9.3750 (4.7917) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [20/40] time 0.182 (0.178) data 0.104 (0.101) loss_u loss_u 0.9951 (0.9634) acc_u 3.1250 (4.3750) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [25/40] time 0.199 (0.180) data 0.122 (0.103) loss_u loss_u 0.9248 (0.9570) acc_u 6.2500 (5.0000) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [30/40] time 0.164 (0.180) data 0.087 (0.102) loss_u loss_u 0.9175 (0.9542) acc_u 9.3750 (5.4167) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [35/40] time 0.161 (0.179) data 0.084 (0.102) loss_u loss_u 0.9116 (0.9504) acc_u 12.5000 (5.8929) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [40/40] time 0.168 (0.178) data 0.090 (0.101) loss_u loss_u 0.9380 (0.9504) acc_u 6.2500 (5.5469) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.1919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 307
clean true:291
clean false:16
clean_rate:0.9478827361563518
noisy true:819
noisy false:474
after delete: len(clean_dataset) 307
after delete: len(noisy_dataset) 1293
epoch [15/200] batch [5/9] time 0.182 (0.168) data 0.105 (0.091) loss_x loss_x 1.0146 (0.8187) acc_x 78.1250 (76.8750) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/40] time 0.184 (0.180) data 0.106 (0.102) loss_u loss_u 0.9609 (0.9685) acc_u 3.1250 (2.5000) lr 1.9792e-03 eta 0:00:06
epoch [15/200] batch [10/40] time 0.210 (0.189) data 0.132 (0.111) loss_u loss_u 0.9443 (0.9498) acc_u 6.2500 (5.0000) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [15/40] time 0.173 (0.188) data 0.096 (0.111) loss_u loss_u 0.9609 (0.9488) acc_u 3.1250 (5.6250) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [20/40] time 0.164 (0.186) data 0.085 (0.108) loss_u loss_u 0.9673 (0.9533) acc_u 3.1250 (5.3125) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [25/40] time 0.174 (0.184) data 0.097 (0.107) loss_u loss_u 0.9751 (0.9506) acc_u 0.0000 (5.6250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [30/40] time 0.223 (0.184) data 0.146 (0.107) loss_u loss_u 0.9126 (0.9489) acc_u 9.3750 (5.7292) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [35/40] time 0.185 (0.184) data 0.108 (0.106) loss_u loss_u 0.9951 (0.9497) acc_u 0.0000 (5.6250) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [40/40] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9990 (0.9517) acc_u 0.0000 (5.3906) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 470
confident_label rate tensor(0.1981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 317
clean true:300
clean false:17
clean_rate:0.9463722397476341
noisy true:830
noisy false:453
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 1283
epoch [16/200] batch [5/9] time 0.188 (0.183) data 0.112 (0.106) loss_x loss_x 1.1738 (0.8002) acc_x 65.6250 (77.5000) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/40] time 0.170 (0.180) data 0.093 (0.103) loss_u loss_u 0.9531 (0.9444) acc_u 3.1250 (5.0000) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [10/40] time 0.163 (0.179) data 0.086 (0.101) loss_u loss_u 0.9468 (0.9512) acc_u 6.2500 (4.6875) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [15/40] time 0.177 (0.179) data 0.099 (0.101) loss_u loss_u 0.9556 (0.9555) acc_u 3.1250 (4.3750) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [20/40] time 0.188 (0.180) data 0.111 (0.102) loss_u loss_u 0.9849 (0.9602) acc_u 0.0000 (3.7500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [25/40] time 0.162 (0.177) data 0.084 (0.100) loss_u loss_u 0.9419 (0.9581) acc_u 6.2500 (4.2500) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [30/40] time 0.190 (0.178) data 0.113 (0.101) loss_u loss_u 0.9604 (0.9570) acc_u 3.1250 (4.2708) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [35/40] time 0.186 (0.179) data 0.110 (0.101) loss_u loss_u 0.9390 (0.9545) acc_u 6.2500 (4.6429) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [40/40] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.9551 (0.9560) acc_u 3.1250 (4.6094) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.1912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 306
clean true:289
clean false:17
clean_rate:0.9444444444444444
noisy true:809
noisy false:485
after delete: len(clean_dataset) 306
after delete: len(noisy_dataset) 1294
epoch [17/200] batch [5/9] time 0.170 (0.178) data 0.092 (0.101) loss_x loss_x 0.9771 (0.9187) acc_x 78.1250 (78.1250) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/40] time 0.179 (0.175) data 0.102 (0.097) loss_u loss_u 0.9463 (0.9563) acc_u 6.2500 (5.0000) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [10/40] time 0.173 (0.173) data 0.094 (0.096) loss_u loss_u 0.9756 (0.9661) acc_u 6.2500 (4.0625) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [15/40] time 0.169 (0.174) data 0.092 (0.097) loss_u loss_u 0.9688 (0.9593) acc_u 3.1250 (4.7917) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [20/40] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.9419 (0.9568) acc_u 9.3750 (5.3125) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [25/40] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.9282 (0.9525) acc_u 6.2500 (5.6250) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [30/40] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.9321 (0.9521) acc_u 6.2500 (5.7292) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [35/40] time 0.181 (0.174) data 0.103 (0.097) loss_u loss_u 0.9658 (0.9523) acc_u 3.1250 (5.6250) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [40/40] time 0.163 (0.174) data 0.086 (0.097) loss_u loss_u 0.9282 (0.9520) acc_u 6.2500 (5.5469) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.1919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 307
clean true:294
clean false:13
clean_rate:0.9576547231270358
noisy true:822
noisy false:471
after delete: len(clean_dataset) 307
after delete: len(noisy_dataset) 1293
epoch [18/200] batch [5/9] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.7222 (0.8338) acc_x 81.2500 (79.3750) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/40] time 0.192 (0.180) data 0.115 (0.103) loss_u loss_u 0.9976 (0.9408) acc_u 0.0000 (6.8750) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [10/40] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9990 (0.9554) acc_u 0.0000 (5.3125) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [15/40] time 0.184 (0.185) data 0.108 (0.108) loss_u loss_u 0.9497 (0.9575) acc_u 9.3750 (5.8333) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [20/40] time 0.187 (0.184) data 0.110 (0.108) loss_u loss_u 0.9629 (0.9552) acc_u 3.1250 (6.0938) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [25/40] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9189 (0.9515) acc_u 9.3750 (6.2500) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [30/40] time 0.214 (0.188) data 0.137 (0.111) loss_u loss_u 0.9092 (0.9469) acc_u 9.3750 (6.6667) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [35/40] time 0.220 (0.191) data 0.142 (0.114) loss_u loss_u 0.9365 (0.9468) acc_u 6.2500 (6.5179) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [40/40] time 0.216 (0.194) data 0.138 (0.116) loss_u loss_u 0.9478 (0.9462) acc_u 6.2500 (6.4844) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.1906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 305
clean true:287
clean false:18
clean_rate:0.940983606557377
noisy true:823
noisy false:472
after delete: len(clean_dataset) 305
after delete: len(noisy_dataset) 1295
epoch [19/200] batch [5/9] time 0.165 (0.181) data 0.087 (0.104) loss_x loss_x 1.5508 (0.9154) acc_x 59.3750 (74.3750) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/40] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.9707 (0.9580) acc_u 3.1250 (5.0000) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [10/40] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.9331 (0.9459) acc_u 6.2500 (5.9375) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [15/40] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9502 (0.9459) acc_u 3.1250 (5.8333) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [20/40] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9233 (0.9477) acc_u 6.2500 (5.7812) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [25/40] time 0.178 (0.178) data 0.099 (0.101) loss_u loss_u 0.8955 (0.9446) acc_u 12.5000 (6.5000) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [30/40] time 0.177 (0.178) data 0.099 (0.101) loss_u loss_u 0.9839 (0.9472) acc_u 0.0000 (6.1458) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [35/40] time 0.187 (0.179) data 0.109 (0.102) loss_u loss_u 0.9482 (0.9487) acc_u 6.2500 (5.9821) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [40/40] time 0.189 (0.179) data 0.111 (0.102) loss_u loss_u 0.9600 (0.9467) acc_u 6.2500 (6.2500) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 488
confident_label rate tensor(0.1925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 308
clean true:291
clean false:17
clean_rate:0.9448051948051948
noisy true:821
noisy false:471
after delete: len(clean_dataset) 308
after delete: len(noisy_dataset) 1292
epoch [20/200] batch [5/9] time 0.177 (0.180) data 0.101 (0.103) loss_x loss_x 0.4685 (0.6231) acc_x 84.3750 (81.2500) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/40] time 0.179 (0.177) data 0.102 (0.100) loss_u loss_u 0.9731 (0.9668) acc_u 3.1250 (4.3750) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [10/40] time 0.178 (0.176) data 0.101 (0.098) loss_u loss_u 0.9639 (0.9633) acc_u 6.2500 (4.6875) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [15/40] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.9038 (0.9622) acc_u 12.5000 (4.7917) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [20/40] time 0.171 (0.174) data 0.093 (0.097) loss_u loss_u 0.9131 (0.9518) acc_u 9.3750 (5.7812) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [25/40] time 0.178 (0.173) data 0.102 (0.096) loss_u loss_u 0.9707 (0.9496) acc_u 3.1250 (5.8750) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [30/40] time 0.170 (0.174) data 0.094 (0.097) loss_u loss_u 0.9272 (0.9460) acc_u 6.2500 (6.2500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [35/40] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.9536 (0.9450) acc_u 6.2500 (6.5179) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [40/40] time 0.177 (0.175) data 0.100 (0.098) loss_u loss_u 0.9292 (0.9467) acc_u 9.3750 (6.3281) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 489
confident_label rate tensor(0.1950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 312
clean true:300
clean false:12
clean_rate:0.9615384615384616
noisy true:811
noisy false:477
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 1288
epoch [21/200] batch [5/9] time 0.186 (0.182) data 0.109 (0.106) loss_x loss_x 0.8955 (0.8523) acc_x 81.2500 (78.7500) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/40] time 0.171 (0.174) data 0.094 (0.097) loss_u loss_u 0.9897 (0.9574) acc_u 0.0000 (4.3750) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [10/40] time 0.183 (0.175) data 0.105 (0.098) loss_u loss_u 0.9287 (0.9476) acc_u 12.5000 (6.2500) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [15/40] time 0.170 (0.175) data 0.093 (0.098) loss_u loss_u 0.9600 (0.9499) acc_u 3.1250 (5.8333) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [20/40] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.9492 (0.9525) acc_u 3.1250 (5.4688) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [25/40] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.9531 (0.9493) acc_u 6.2500 (6.0000) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [30/40] time 0.173 (0.176) data 0.095 (0.098) loss_u loss_u 0.9717 (0.9509) acc_u 3.1250 (5.7292) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [35/40] time 0.175 (0.176) data 0.097 (0.099) loss_u loss_u 0.9243 (0.9517) acc_u 9.3750 (5.6250) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [40/40] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.9731 (0.9534) acc_u 6.2500 (5.4688) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 496
confident_label rate tensor(0.1969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 315
clean true:299
clean false:16
clean_rate:0.9492063492063492
noisy true:805
noisy false:480
after delete: len(clean_dataset) 315
after delete: len(noisy_dataset) 1285
epoch [22/200] batch [5/9] time 0.180 (0.178) data 0.103 (0.101) loss_x loss_x 0.7451 (0.7647) acc_x 81.2500 (80.0000) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/40] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9155 (0.9457) acc_u 9.3750 (5.6250) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [10/40] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9199 (0.9500) acc_u 9.3750 (5.6250) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [15/40] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.9023 (0.9471) acc_u 9.3750 (6.2500) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [20/40] time 0.180 (0.181) data 0.104 (0.104) loss_u loss_u 0.9780 (0.9443) acc_u 3.1250 (6.7188) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [25/40] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9932 (0.9505) acc_u 0.0000 (5.8750) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [30/40] time 0.173 (0.184) data 0.094 (0.107) loss_u loss_u 0.9502 (0.9518) acc_u 6.2500 (5.6250) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [35/40] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.9531 (0.9501) acc_u 3.1250 (5.7143) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [40/40] time 0.171 (0.182) data 0.093 (0.105) loss_u loss_u 0.9683 (0.9504) acc_u 3.1250 (5.6250) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 489
confident_label rate tensor(0.2075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 332
clean true:308
clean false:24
clean_rate:0.927710843373494
noisy true:803
noisy false:465
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 1268
epoch [23/200] batch [5/10] time 0.178 (0.185) data 0.101 (0.108) loss_x loss_x 0.4375 (0.6201) acc_x 84.3750 (81.8750) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [10/10] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.6890 (0.6512) acc_x 78.1250 (82.5000) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/39] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.9907 (0.9440) acc_u 0.0000 (7.5000) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [10/39] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.9780 (0.9526) acc_u 3.1250 (5.6250) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [15/39] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9771 (0.9569) acc_u 3.1250 (5.6250) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [20/39] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8237 (0.9514) acc_u 18.7500 (5.9375) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [25/39] time 0.174 (0.184) data 0.097 (0.107) loss_u loss_u 0.9414 (0.9528) acc_u 6.2500 (5.6250) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [30/39] time 0.188 (0.183) data 0.110 (0.106) loss_u loss_u 0.9634 (0.9530) acc_u 3.1250 (5.5208) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [35/39] time 0.188 (0.183) data 0.110 (0.106) loss_u loss_u 0.9458 (0.9529) acc_u 6.2500 (5.6250) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 501
confident_label rate tensor(0.2013, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 322
clean true:299
clean false:23
clean_rate:0.9285714285714286
noisy true:800
noisy false:478
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 1278
epoch [24/200] batch [5/10] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.6475 (0.6651) acc_x 81.2500 (84.3750) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [10/10] time 0.169 (0.181) data 0.093 (0.104) loss_x loss_x 0.4685 (0.6149) acc_x 87.5000 (85.0000) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/39] time 0.166 (0.176) data 0.088 (0.099) loss_u loss_u 0.9844 (0.9636) acc_u 3.1250 (5.0000) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/39] time 0.172 (0.174) data 0.095 (0.097) loss_u loss_u 0.9863 (0.9556) acc_u 3.1250 (5.9375) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [15/39] time 0.174 (0.174) data 0.095 (0.097) loss_u loss_u 0.9580 (0.9608) acc_u 6.2500 (5.0000) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [20/39] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.9644 (0.9610) acc_u 3.1250 (4.6875) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [25/39] time 0.183 (0.175) data 0.105 (0.098) loss_u loss_u 0.9429 (0.9586) acc_u 6.2500 (4.8750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [30/39] time 0.178 (0.176) data 0.099 (0.098) loss_u loss_u 0.9609 (0.9560) acc_u 3.1250 (5.2083) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [35/39] time 0.171 (0.176) data 0.094 (0.098) loss_u loss_u 0.9565 (0.9532) acc_u 6.2500 (5.5357) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 501
confident_label rate tensor(0.1975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 316
clean true:293
clean false:23
clean_rate:0.9272151898734177
noisy true:806
noisy false:478
after delete: len(clean_dataset) 316
after delete: len(noisy_dataset) 1284
epoch [25/200] batch [5/9] time 0.176 (0.181) data 0.100 (0.104) loss_x loss_x 0.8350 (0.7404) acc_x 81.2500 (78.1250) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/40] time 0.171 (0.176) data 0.093 (0.098) loss_u loss_u 0.9268 (0.9482) acc_u 12.5000 (6.8750) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [10/40] time 0.163 (0.177) data 0.086 (0.100) loss_u loss_u 0.9458 (0.9412) acc_u 6.2500 (7.5000) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [15/40] time 0.191 (0.176) data 0.112 (0.099) loss_u loss_u 0.9785 (0.9488) acc_u 3.1250 (6.4583) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [20/40] time 0.200 (0.179) data 0.123 (0.102) loss_u loss_u 0.9575 (0.9509) acc_u 9.3750 (6.5625) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [25/40] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.9551 (0.9491) acc_u 3.1250 (6.5000) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [30/40] time 0.166 (0.181) data 0.089 (0.104) loss_u loss_u 0.9707 (0.9464) acc_u 3.1250 (6.7708) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [35/40] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.9346 (0.9477) acc_u 6.2500 (6.3393) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [40/40] time 0.181 (0.180) data 0.103 (0.102) loss_u loss_u 0.8755 (0.9470) acc_u 15.6250 (6.4062) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 518
confident_label rate tensor(0.2100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 336
clean true:302
clean false:34
clean_rate:0.8988095238095238
noisy true:780
noisy false:484
after delete: len(clean_dataset) 336
after delete: len(noisy_dataset) 1264
epoch [26/200] batch [5/10] time 0.185 (0.177) data 0.109 (0.101) loss_x loss_x 0.6006 (0.5955) acc_x 78.1250 (81.2500) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [10/10] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.4709 (0.7186) acc_x 90.6250 (82.5000) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/39] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9526 (0.9450) acc_u 3.1250 (4.3750) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [10/39] time 0.193 (0.184) data 0.116 (0.107) loss_u loss_u 0.9087 (0.9421) acc_u 9.3750 (5.3125) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [15/39] time 0.168 (0.183) data 0.091 (0.106) loss_u loss_u 0.9912 (0.9512) acc_u 3.1250 (4.5833) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [20/39] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9585 (0.9497) acc_u 6.2500 (5.3125) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [25/39] time 0.174 (0.181) data 0.096 (0.104) loss_u loss_u 0.9985 (0.9523) acc_u 0.0000 (5.1250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [30/39] time 0.167 (0.179) data 0.090 (0.102) loss_u loss_u 0.9678 (0.9499) acc_u 3.1250 (5.4167) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [35/39] time 0.179 (0.179) data 0.103 (0.102) loss_u loss_u 0.9707 (0.9502) acc_u 3.1250 (5.3571) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 497
confident_label rate tensor(0.2100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 336
clean true:308
clean false:28
clean_rate:0.9166666666666666
noisy true:795
noisy false:469
after delete: len(clean_dataset) 336
after delete: len(noisy_dataset) 1264
epoch [27/200] batch [5/10] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 1.3672 (1.0113) acc_x 65.6250 (72.5000) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [10/10] time 0.178 (0.177) data 0.102 (0.101) loss_x loss_x 0.8350 (0.7951) acc_x 81.2500 (79.0625) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/39] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.9482 (0.9351) acc_u 6.2500 (8.1250) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [10/39] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9702 (0.9319) acc_u 3.1250 (8.1250) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [15/39] time 0.177 (0.175) data 0.100 (0.099) loss_u loss_u 0.9229 (0.9346) acc_u 9.3750 (7.7083) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [20/39] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.9771 (0.9413) acc_u 3.1250 (6.8750) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/39] time 0.191 (0.177) data 0.113 (0.100) loss_u loss_u 0.9951 (0.9402) acc_u 0.0000 (6.7500) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [30/39] time 0.169 (0.177) data 0.093 (0.100) loss_u loss_u 0.9414 (0.9412) acc_u 6.2500 (6.6667) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [35/39] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9673 (0.9460) acc_u 3.1250 (6.2500) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 486
confident_label rate tensor(0.2094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 335
clean true:309
clean false:26
clean_rate:0.9223880597014925
noisy true:805
noisy false:460
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1265
epoch [28/200] batch [5/10] time 0.159 (0.167) data 0.083 (0.090) loss_x loss_x 0.8193 (0.7257) acc_x 75.0000 (80.0000) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [10/10] time 0.168 (0.172) data 0.091 (0.095) loss_x loss_x 0.6616 (0.8283) acc_x 87.5000 (79.3750) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/39] time 0.177 (0.170) data 0.100 (0.094) loss_u loss_u 0.9980 (0.9504) acc_u 0.0000 (5.6250) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [10/39] time 0.175 (0.171) data 0.097 (0.094) loss_u loss_u 0.9580 (0.9584) acc_u 3.1250 (4.6875) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [15/39] time 0.174 (0.171) data 0.096 (0.094) loss_u loss_u 0.9077 (0.9589) acc_u 9.3750 (4.5833) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [20/39] time 0.180 (0.173) data 0.103 (0.096) loss_u loss_u 0.9829 (0.9544) acc_u 0.0000 (4.8438) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [25/39] time 0.184 (0.175) data 0.106 (0.098) loss_u loss_u 0.9839 (0.9568) acc_u 3.1250 (4.8750) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [30/39] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9629 (0.9576) acc_u 6.2500 (4.7917) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [35/39] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.8892 (0.9541) acc_u 9.3750 (5.0000) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 532
confident_label rate tensor(0.2094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 335
clean true:303
clean false:32
clean_rate:0.9044776119402985
noisy true:765
noisy false:500
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1265
epoch [29/200] batch [5/10] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.7275 (0.7867) acc_x 87.5000 (81.2500) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [10/10] time 0.181 (0.181) data 0.104 (0.105) loss_x loss_x 0.6182 (0.8359) acc_x 78.1250 (81.2500) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/39] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.9746 (0.9656) acc_u 3.1250 (2.5000) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [10/39] time 0.177 (0.181) data 0.099 (0.104) loss_u loss_u 0.9399 (0.9621) acc_u 9.3750 (3.1250) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [15/39] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.9155 (0.9567) acc_u 9.3750 (4.3750) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [20/39] time 0.185 (0.182) data 0.108 (0.106) loss_u loss_u 0.9380 (0.9504) acc_u 6.2500 (5.1562) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [25/39] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.9609 (0.9503) acc_u 6.2500 (5.6250) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [30/39] time 0.193 (0.183) data 0.114 (0.106) loss_u loss_u 0.8838 (0.9491) acc_u 12.5000 (5.7292) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [35/39] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.9399 (0.9471) acc_u 9.3750 (5.9821) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 495
confident_label rate tensor(0.2050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 328
clean true:306
clean false:22
clean_rate:0.9329268292682927
noisy true:799
noisy false:473
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1272
epoch [30/200] batch [5/10] time 0.180 (0.184) data 0.104 (0.107) loss_x loss_x 1.1543 (0.7102) acc_x 75.0000 (82.5000) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [10/10] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.3606 (0.6646) acc_x 90.6250 (81.8750) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/39] time 0.187 (0.184) data 0.110 (0.107) loss_u loss_u 0.9424 (0.9350) acc_u 6.2500 (8.1250) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [10/39] time 0.177 (0.182) data 0.097 (0.104) loss_u loss_u 0.9590 (0.9502) acc_u 3.1250 (5.6250) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [15/39] time 0.173 (0.181) data 0.096 (0.104) loss_u loss_u 0.9971 (0.9528) acc_u 0.0000 (5.4167) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [20/39] time 0.167 (0.179) data 0.089 (0.102) loss_u loss_u 0.9385 (0.9511) acc_u 6.2500 (5.4688) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [25/39] time 0.179 (0.179) data 0.103 (0.102) loss_u loss_u 0.9087 (0.9459) acc_u 9.3750 (6.1250) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [30/39] time 0.170 (0.179) data 0.092 (0.101) loss_u loss_u 0.9438 (0.9486) acc_u 9.3750 (5.8333) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [35/39] time 0.177 (0.179) data 0.100 (0.101) loss_u loss_u 0.9692 (0.9491) acc_u 3.1250 (5.8929) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 510
confident_label rate tensor(0.2094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 335
clean true:308
clean false:27
clean_rate:0.9194029850746268
noisy true:782
noisy false:483
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1265
epoch [31/200] batch [5/10] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.9370 (0.8978) acc_x 81.2500 (78.7500) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [10/10] time 0.169 (0.177) data 0.090 (0.100) loss_x loss_x 0.4307 (0.7628) acc_x 87.5000 (81.5625) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/39] time 0.179 (0.177) data 0.101 (0.099) loss_u loss_u 0.9717 (0.9430) acc_u 6.2500 (7.5000) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [10/39] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.8848 (0.9395) acc_u 12.5000 (6.8750) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [15/39] time 0.198 (0.178) data 0.121 (0.100) loss_u loss_u 0.9165 (0.9475) acc_u 15.6250 (6.2500) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [20/39] time 0.193 (0.178) data 0.116 (0.101) loss_u loss_u 0.9297 (0.9493) acc_u 6.2500 (5.7812) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [25/39] time 0.184 (0.179) data 0.108 (0.102) loss_u loss_u 0.9404 (0.9467) acc_u 6.2500 (6.0000) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [30/39] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9673 (0.9486) acc_u 3.1250 (5.8333) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [35/39] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.9790 (0.9507) acc_u 3.1250 (5.7143) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 487
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:320
clean false:28
clean_rate:0.9195402298850575
noisy true:793
noisy false:459
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [32/200] batch [5/10] time 0.187 (0.187) data 0.110 (0.111) loss_x loss_x 0.5200 (0.9009) acc_x 81.2500 (80.6250) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [10/10] time 0.171 (0.186) data 0.094 (0.110) loss_x loss_x 0.7007 (0.7273) acc_x 84.3750 (82.8125) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/39] time 0.161 (0.179) data 0.084 (0.103) loss_u loss_u 0.9766 (0.9571) acc_u 3.1250 (5.6250) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [10/39] time 0.173 (0.177) data 0.096 (0.101) loss_u loss_u 0.9004 (0.9376) acc_u 12.5000 (7.8125) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [15/39] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.9263 (0.9389) acc_u 9.3750 (7.2917) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [20/39] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.8965 (0.9435) acc_u 12.5000 (6.8750) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [25/39] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.9531 (0.9458) acc_u 6.2500 (6.6250) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [30/39] time 0.176 (0.180) data 0.099 (0.103) loss_u loss_u 0.9385 (0.9481) acc_u 9.3750 (6.4583) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [35/39] time 0.177 (0.179) data 0.098 (0.102) loss_u loss_u 0.9951 (0.9523) acc_u 0.0000 (5.8929) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 494
confident_label rate tensor(0.2106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 337
clean true:306
clean false:31
clean_rate:0.9080118694362018
noisy true:800
noisy false:463
after delete: len(clean_dataset) 337
after delete: len(noisy_dataset) 1263
epoch [33/200] batch [5/10] time 0.172 (0.166) data 0.096 (0.089) loss_x loss_x 0.8184 (0.6922) acc_x 75.0000 (80.6250) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [10/10] time 0.182 (0.172) data 0.105 (0.095) loss_x loss_x 0.8525 (0.7435) acc_x 71.8750 (79.6875) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/39] time 0.161 (0.175) data 0.085 (0.098) loss_u loss_u 0.9404 (0.9688) acc_u 6.2500 (3.7500) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/39] time 0.177 (0.175) data 0.099 (0.099) loss_u loss_u 0.9272 (0.9602) acc_u 9.3750 (4.6875) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [15/39] time 0.186 (0.176) data 0.108 (0.099) loss_u loss_u 0.9624 (0.9539) acc_u 3.1250 (5.4167) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [20/39] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9980 (0.9571) acc_u 0.0000 (5.0000) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [25/39] time 0.171 (0.179) data 0.094 (0.102) loss_u loss_u 0.9331 (0.9551) acc_u 6.2500 (5.2500) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [30/39] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.9341 (0.9546) acc_u 9.3750 (5.4167) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [35/39] time 0.184 (0.181) data 0.108 (0.104) loss_u loss_u 0.9302 (0.9531) acc_u 9.3750 (5.5357) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 497
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 352
clean true:320
clean false:32
clean_rate:0.9090909090909091
noisy true:783
noisy false:465
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1248
epoch [34/200] batch [5/11] time 0.184 (0.187) data 0.107 (0.109) loss_x loss_x 0.6250 (0.8657) acc_x 84.3750 (78.7500) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/11] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.7188 (0.8450) acc_x 78.1250 (78.7500) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/39] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9985 (0.9514) acc_u 0.0000 (5.0000) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [10/39] time 0.173 (0.182) data 0.095 (0.105) loss_u loss_u 0.8887 (0.9462) acc_u 12.5000 (6.5625) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [15/39] time 0.188 (0.182) data 0.111 (0.105) loss_u loss_u 0.9658 (0.9558) acc_u 3.1250 (5.4167) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [20/39] time 0.190 (0.182) data 0.113 (0.105) loss_u loss_u 0.8818 (0.9551) acc_u 15.6250 (5.4688) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [25/39] time 0.175 (0.183) data 0.096 (0.105) loss_u loss_u 0.9775 (0.9589) acc_u 3.1250 (4.8750) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [30/39] time 0.180 (0.183) data 0.103 (0.106) loss_u loss_u 0.9697 (0.9538) acc_u 6.2500 (5.4167) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [35/39] time 0.166 (0.182) data 0.089 (0.105) loss_u loss_u 0.9438 (0.9542) acc_u 6.2500 (5.3571) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 503
confident_label rate tensor(0.2069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 331
clean true:298
clean false:33
clean_rate:0.9003021148036254
noisy true:799
noisy false:470
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 1269
epoch [35/200] batch [5/10] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.3398 (0.8423) acc_x 93.7500 (80.6250) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [10/10] time 0.189 (0.182) data 0.112 (0.105) loss_x loss_x 0.7271 (0.7796) acc_x 71.8750 (79.3750) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/39] time 0.168 (0.179) data 0.090 (0.101) loss_u loss_u 0.8589 (0.9214) acc_u 15.6250 (9.3750) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [10/39] time 0.195 (0.183) data 0.117 (0.106) loss_u loss_u 0.9219 (0.9421) acc_u 6.2500 (6.8750) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [15/39] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9014 (0.9416) acc_u 12.5000 (7.0833) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [20/39] time 0.185 (0.185) data 0.108 (0.107) loss_u loss_u 0.9165 (0.9371) acc_u 9.3750 (7.5000) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [25/39] time 0.180 (0.185) data 0.103 (0.107) loss_u loss_u 0.9277 (0.9396) acc_u 9.3750 (7.2500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [30/39] time 0.187 (0.183) data 0.109 (0.106) loss_u loss_u 0.9019 (0.9406) acc_u 12.5000 (7.2917) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [35/39] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.9653 (0.9410) acc_u 3.1250 (7.2321) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 510
confident_label rate tensor(0.2169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 347
clean true:314
clean false:33
clean_rate:0.9048991354466859
noisy true:776
noisy false:477
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1253
epoch [36/200] batch [5/10] time 0.184 (0.182) data 0.106 (0.104) loss_x loss_x 0.9653 (0.7697) acc_x 81.2500 (80.6250) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [10/10] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.7017 (0.7270) acc_x 87.5000 (80.6250) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/39] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.9668 (0.9604) acc_u 6.2500 (5.0000) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/39] time 0.166 (0.175) data 0.088 (0.098) loss_u loss_u 0.9502 (0.9516) acc_u 6.2500 (5.9375) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [15/39] time 0.172 (0.175) data 0.095 (0.097) loss_u loss_u 0.9526 (0.9507) acc_u 6.2500 (5.8333) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [20/39] time 0.180 (0.176) data 0.104 (0.099) loss_u loss_u 0.9541 (0.9448) acc_u 6.2500 (6.4062) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [25/39] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9683 (0.9442) acc_u 3.1250 (6.3750) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [30/39] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9790 (0.9482) acc_u 3.1250 (6.0417) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [35/39] time 0.167 (0.179) data 0.090 (0.102) loss_u loss_u 0.9702 (0.9485) acc_u 3.1250 (6.0714) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.2150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 344
clean true:314
clean false:30
clean_rate:0.9127906976744186
noisy true:795
noisy false:461
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1256
epoch [37/200] batch [5/10] time 0.174 (0.172) data 0.098 (0.095) loss_x loss_x 0.7866 (0.7588) acc_x 71.8750 (78.7500) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [10/10] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.6323 (0.6104) acc_x 87.5000 (84.6875) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/39] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9409 (0.9648) acc_u 9.3750 (3.7500) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [10/39] time 0.161 (0.178) data 0.084 (0.101) loss_u loss_u 0.9365 (0.9487) acc_u 6.2500 (5.3125) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [15/39] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.9463 (0.9484) acc_u 6.2500 (5.2083) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [20/39] time 0.167 (0.177) data 0.089 (0.100) loss_u loss_u 0.9287 (0.9491) acc_u 9.3750 (5.3125) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [25/39] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.9219 (0.9545) acc_u 9.3750 (4.7500) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [30/39] time 0.176 (0.176) data 0.099 (0.099) loss_u loss_u 0.9644 (0.9553) acc_u 3.1250 (4.6875) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [35/39] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.9214 (0.9555) acc_u 9.3750 (4.6429) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 470
confident_label rate tensor(0.2087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 334
clean true:305
clean false:29
clean_rate:0.9131736526946108
noisy true:825
noisy false:441
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1266
epoch [38/200] batch [5/10] time 0.171 (0.167) data 0.095 (0.090) loss_x loss_x 0.6230 (0.5269) acc_x 81.2500 (86.2500) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [10/10] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.4177 (0.4788) acc_x 84.3750 (86.8750) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/39] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.9683 (0.9781) acc_u 3.1250 (2.5000) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [10/39] time 0.182 (0.177) data 0.105 (0.099) loss_u loss_u 0.9365 (0.9550) acc_u 6.2500 (5.3125) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [15/39] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9131 (0.9452) acc_u 6.2500 (6.4583) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [20/39] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.9409 (0.9454) acc_u 6.2500 (6.7188) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [25/39] time 0.190 (0.177) data 0.112 (0.100) loss_u loss_u 0.9023 (0.9459) acc_u 9.3750 (6.5000) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [30/39] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9487 (0.9463) acc_u 6.2500 (6.5625) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [35/39] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9463 (0.9450) acc_u 6.2500 (6.7857) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 512
confident_label rate tensor(0.2087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 334
clean true:310
clean false:24
clean_rate:0.9281437125748503
noisy true:778
noisy false:488
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1266
epoch [39/200] batch [5/10] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 0.9033 (0.5754) acc_x 75.0000 (83.7500) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [10/10] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.7197 (0.6749) acc_x 78.1250 (81.5625) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/39] time 0.166 (0.179) data 0.088 (0.102) loss_u loss_u 0.9307 (0.9339) acc_u 9.3750 (7.5000) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [10/39] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.9829 (0.9357) acc_u 0.0000 (7.8125) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [15/39] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.9585 (0.9352) acc_u 3.1250 (7.7083) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [20/39] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.9668 (0.9469) acc_u 6.2500 (6.4062) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [25/39] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.9771 (0.9457) acc_u 6.2500 (6.5000) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [30/39] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.9448 (0.9450) acc_u 6.2500 (6.4583) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [35/39] time 0.177 (0.177) data 0.099 (0.100) loss_u loss_u 0.9697 (0.9471) acc_u 3.1250 (6.1607) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 514
confident_label rate tensor(0.2125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 340
clean true:302
clean false:38
clean_rate:0.888235294117647
noisy true:784
noisy false:476
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1260
epoch [40/200] batch [5/10] time 0.162 (0.165) data 0.085 (0.088) loss_x loss_x 0.6709 (0.7324) acc_x 87.5000 (79.3750) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [10/10] time 0.167 (0.165) data 0.090 (0.088) loss_x loss_x 0.6851 (0.8156) acc_x 81.2500 (79.3750) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/39] time 0.170 (0.167) data 0.092 (0.089) loss_u loss_u 0.8276 (0.9000) acc_u 18.7500 (10.6250) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [10/39] time 0.166 (0.168) data 0.089 (0.091) loss_u loss_u 0.9736 (0.9217) acc_u 3.1250 (8.7500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/39] time 0.183 (0.170) data 0.105 (0.092) loss_u loss_u 0.9668 (0.9341) acc_u 3.1250 (7.2917) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [20/39] time 0.183 (0.170) data 0.106 (0.092) loss_u loss_u 0.9233 (0.9373) acc_u 12.5000 (7.3438) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [25/39] time 0.183 (0.171) data 0.106 (0.094) loss_u loss_u 0.9419 (0.9398) acc_u 6.2500 (7.1250) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [30/39] time 0.187 (0.172) data 0.111 (0.095) loss_u loss_u 0.9512 (0.9382) acc_u 6.2500 (7.2917) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [35/39] time 0.186 (0.173) data 0.108 (0.096) loss_u loss_u 0.9858 (0.9395) acc_u 3.1250 (7.1429) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 546
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 351
clean true:308
clean false:43
clean_rate:0.8774928774928775
noisy true:746
noisy false:503
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1249
epoch [41/200] batch [5/10] time 0.166 (0.176) data 0.089 (0.098) loss_x loss_x 0.7227 (0.6851) acc_x 78.1250 (83.1250) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [10/10] time 0.194 (0.180) data 0.117 (0.103) loss_x loss_x 0.3979 (0.8626) acc_x 84.3750 (80.3125) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/39] time 0.174 (0.188) data 0.096 (0.111) loss_u loss_u 0.9780 (0.9570) acc_u 0.0000 (4.3750) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [10/39] time 0.169 (0.186) data 0.091 (0.109) loss_u loss_u 0.9648 (0.9533) acc_u 6.2500 (5.0000) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [15/39] time 0.178 (0.185) data 0.100 (0.108) loss_u loss_u 0.9458 (0.9569) acc_u 6.2500 (4.7917) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [20/39] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9478 (0.9580) acc_u 6.2500 (5.0000) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [25/39] time 0.189 (0.184) data 0.112 (0.107) loss_u loss_u 0.9458 (0.9545) acc_u 9.3750 (5.7500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [30/39] time 0.193 (0.184) data 0.115 (0.107) loss_u loss_u 0.8970 (0.9539) acc_u 12.5000 (5.6250) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [35/39] time 0.183 (0.185) data 0.106 (0.107) loss_u loss_u 0.9482 (0.9515) acc_u 6.2500 (5.8929) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 499
confident_label rate tensor(0.2137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 342
clean true:303
clean false:39
clean_rate:0.8859649122807017
noisy true:798
noisy false:460
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1258
epoch [42/200] batch [5/10] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.6191 (0.5711) acc_x 81.2500 (84.3750) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [10/10] time 0.170 (0.183) data 0.094 (0.106) loss_x loss_x 0.7402 (0.6380) acc_x 84.3750 (83.7500) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/39] time 0.163 (0.179) data 0.085 (0.103) loss_u loss_u 0.9390 (0.9432) acc_u 6.2500 (6.2500) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [10/39] time 0.174 (0.177) data 0.098 (0.100) loss_u loss_u 0.9365 (0.9370) acc_u 6.2500 (6.8750) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [15/39] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.9536 (0.9430) acc_u 6.2500 (6.6667) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [20/39] time 0.164 (0.177) data 0.088 (0.100) loss_u loss_u 0.9849 (0.9369) acc_u 0.0000 (7.1875) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [25/39] time 0.181 (0.178) data 0.102 (0.101) loss_u loss_u 0.8892 (0.9321) acc_u 12.5000 (7.7500) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [30/39] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.9111 (0.9309) acc_u 15.6250 (8.1250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [35/39] time 0.180 (0.179) data 0.102 (0.102) loss_u loss_u 0.9985 (0.9389) acc_u 0.0000 (7.1429) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 523
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 352
clean true:309
clean false:43
clean_rate:0.8778409090909091
noisy true:768
noisy false:480
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1248
epoch [43/200] batch [5/11] time 0.163 (0.172) data 0.086 (0.095) loss_x loss_x 0.5312 (0.6863) acc_x 87.5000 (80.6250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/11] time 0.174 (0.170) data 0.097 (0.093) loss_x loss_x 1.2842 (0.8727) acc_x 71.8750 (76.5625) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/39] time 0.178 (0.173) data 0.101 (0.096) loss_u loss_u 0.9844 (0.9747) acc_u 0.0000 (2.5000) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/39] time 0.171 (0.174) data 0.094 (0.097) loss_u loss_u 0.9297 (0.9565) acc_u 12.5000 (5.0000) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [15/39] time 0.181 (0.174) data 0.102 (0.096) loss_u loss_u 0.9404 (0.9539) acc_u 6.2500 (5.4167) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [20/39] time 0.170 (0.174) data 0.092 (0.097) loss_u loss_u 0.9751 (0.9553) acc_u 3.1250 (5.4688) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [25/39] time 0.177 (0.175) data 0.101 (0.098) loss_u loss_u 0.9678 (0.9527) acc_u 3.1250 (5.7500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [30/39] time 0.222 (0.177) data 0.145 (0.100) loss_u loss_u 0.9336 (0.9499) acc_u 6.2500 (6.0417) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [35/39] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9443 (0.9492) acc_u 6.2500 (6.2500) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 486
confident_label rate tensor(0.2150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 344
clean true:309
clean false:35
clean_rate:0.8982558139534884
noisy true:805
noisy false:451
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1256
epoch [44/200] batch [5/10] time 0.178 (0.183) data 0.102 (0.107) loss_x loss_x 0.4873 (0.6477) acc_x 84.3750 (80.0000) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [10/10] time 0.173 (0.178) data 0.096 (0.102) loss_x loss_x 0.2411 (0.7379) acc_x 93.7500 (79.3750) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/39] time 0.176 (0.175) data 0.100 (0.099) loss_u loss_u 0.9312 (0.9373) acc_u 6.2500 (8.7500) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/39] time 0.176 (0.177) data 0.099 (0.100) loss_u loss_u 0.9214 (0.9377) acc_u 9.3750 (8.1250) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [15/39] time 0.190 (0.177) data 0.113 (0.100) loss_u loss_u 0.9717 (0.9389) acc_u 3.1250 (7.9167) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [20/39] time 0.170 (0.177) data 0.092 (0.100) loss_u loss_u 0.9116 (0.9396) acc_u 9.3750 (7.9688) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [25/39] time 0.187 (0.178) data 0.111 (0.102) loss_u loss_u 0.9683 (0.9447) acc_u 3.1250 (7.1250) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [30/39] time 0.178 (0.178) data 0.101 (0.101) loss_u loss_u 0.9683 (0.9426) acc_u 3.1250 (7.5000) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [35/39] time 0.177 (0.178) data 0.100 (0.101) loss_u loss_u 0.9233 (0.9418) acc_u 9.3750 (7.6786) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 495
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:313
clean false:35
clean_rate:0.8994252873563219
noisy true:792
noisy false:460
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [45/200] batch [5/10] time 0.166 (0.169) data 0.090 (0.092) loss_x loss_x 0.9448 (0.7800) acc_x 75.0000 (78.7500) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [10/10] time 0.165 (0.167) data 0.088 (0.090) loss_x loss_x 0.6885 (0.6752) acc_x 81.2500 (81.8750) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/39] time 0.167 (0.166) data 0.089 (0.089) loss_u loss_u 0.9307 (0.9299) acc_u 6.2500 (8.1250) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [10/39] time 0.182 (0.169) data 0.105 (0.092) loss_u loss_u 0.9961 (0.9311) acc_u 0.0000 (7.8125) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/39] time 0.167 (0.171) data 0.090 (0.094) loss_u loss_u 0.9785 (0.9353) acc_u 6.2500 (7.5000) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [20/39] time 0.175 (0.171) data 0.098 (0.093) loss_u loss_u 0.9854 (0.9421) acc_u 0.0000 (6.7188) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [25/39] time 0.178 (0.172) data 0.102 (0.095) loss_u loss_u 0.9883 (0.9467) acc_u 0.0000 (6.1250) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [30/39] time 0.179 (0.173) data 0.102 (0.096) loss_u loss_u 0.9536 (0.9471) acc_u 6.2500 (6.3542) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [35/39] time 0.185 (0.173) data 0.109 (0.096) loss_u loss_u 0.9907 (0.9466) acc_u 0.0000 (6.4286) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 481
confident_label rate tensor(0.2294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 367
clean true:328
clean false:39
clean_rate:0.8937329700272479
noisy true:791
noisy false:442
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1233
epoch [46/200] batch [5/11] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.3955 (0.5782) acc_x 84.3750 (79.3750) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/11] time 0.172 (0.182) data 0.096 (0.106) loss_x loss_x 0.5938 (0.5497) acc_x 81.2500 (82.5000) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/38] time 0.177 (0.178) data 0.099 (0.101) loss_u loss_u 0.9258 (0.9295) acc_u 6.2500 (7.5000) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/38] time 0.188 (0.177) data 0.111 (0.100) loss_u loss_u 0.9966 (0.9514) acc_u 0.0000 (5.0000) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/38] time 0.170 (0.178) data 0.094 (0.101) loss_u loss_u 0.9365 (0.9469) acc_u 6.2500 (5.6250) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [20/38] time 0.178 (0.178) data 0.102 (0.101) loss_u loss_u 0.9956 (0.9498) acc_u 0.0000 (5.3125) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [25/38] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.9819 (0.9490) acc_u 0.0000 (5.5000) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [30/38] time 0.187 (0.179) data 0.109 (0.102) loss_u loss_u 0.9351 (0.9484) acc_u 6.2500 (5.7292) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [35/38] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.9375 (0.9505) acc_u 6.2500 (5.4464) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 501
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 355
clean true:315
clean false:40
clean_rate:0.8873239436619719
noisy true:784
noisy false:461
after delete: len(clean_dataset) 355
after delete: len(noisy_dataset) 1245
epoch [47/200] batch [5/11] time 0.178 (0.173) data 0.102 (0.096) loss_x loss_x 0.5859 (0.6946) acc_x 81.2500 (82.5000) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/11] time 0.174 (0.175) data 0.096 (0.098) loss_x loss_x 0.5581 (0.6174) acc_x 87.5000 (84.0625) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/38] time 0.185 (0.176) data 0.109 (0.099) loss_u loss_u 0.9014 (0.9258) acc_u 12.5000 (8.7500) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/38] time 0.200 (0.179) data 0.123 (0.102) loss_u loss_u 0.9888 (0.9428) acc_u 0.0000 (6.2500) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [15/38] time 0.183 (0.178) data 0.106 (0.102) loss_u loss_u 0.9224 (0.9452) acc_u 9.3750 (6.0417) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [20/38] time 0.175 (0.178) data 0.097 (0.101) loss_u loss_u 0.9995 (0.9464) acc_u 0.0000 (5.9375) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/38] time 0.175 (0.180) data 0.099 (0.103) loss_u loss_u 0.9189 (0.9428) acc_u 12.5000 (6.6250) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [30/38] time 0.175 (0.178) data 0.098 (0.102) loss_u loss_u 0.9121 (0.9399) acc_u 9.3750 (6.9792) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [35/38] time 0.171 (0.178) data 0.094 (0.101) loss_u loss_u 0.9238 (0.9366) acc_u 9.3750 (7.4107) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 508
confident_label rate tensor(0.2306, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 369
clean true:319
clean false:50
clean_rate:0.8644986449864499
noisy true:773
noisy false:458
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1231
epoch [48/200] batch [5/11] time 0.161 (0.169) data 0.085 (0.093) loss_x loss_x 0.6943 (0.6436) acc_x 84.3750 (81.8750) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [10/11] time 0.165 (0.170) data 0.089 (0.093) loss_x loss_x 0.6777 (0.6667) acc_x 81.2500 (83.1250) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/38] time 0.166 (0.168) data 0.089 (0.091) loss_u loss_u 0.9780 (0.9645) acc_u 3.1250 (3.1250) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [10/38] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.9385 (0.9397) acc_u 6.2500 (6.2500) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/38] time 0.180 (0.175) data 0.102 (0.098) loss_u loss_u 0.9956 (0.9490) acc_u 0.0000 (5.0000) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [20/38] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.9766 (0.9510) acc_u 3.1250 (4.8438) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [25/38] time 0.171 (0.177) data 0.095 (0.100) loss_u loss_u 0.9482 (0.9456) acc_u 6.2500 (5.6250) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [30/38] time 0.203 (0.178) data 0.125 (0.101) loss_u loss_u 0.9658 (0.9514) acc_u 3.1250 (5.0000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [35/38] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8218 (0.9481) acc_u 21.8750 (5.4464) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 514
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 358
clean true:315
clean false:43
clean_rate:0.8798882681564246
noisy true:771
noisy false:471
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1242
epoch [49/200] batch [5/11] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.9307 (0.7313) acc_x 75.0000 (81.8750) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [10/11] time 0.167 (0.173) data 0.090 (0.096) loss_x loss_x 0.7319 (0.6722) acc_x 78.1250 (83.4375) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/38] time 0.168 (0.170) data 0.091 (0.093) loss_u loss_u 0.9736 (0.9466) acc_u 3.1250 (5.6250) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/38] time 0.166 (0.170) data 0.088 (0.093) loss_u loss_u 0.9355 (0.9490) acc_u 6.2500 (6.2500) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/38] time 0.194 (0.170) data 0.117 (0.093) loss_u loss_u 0.9434 (0.9464) acc_u 9.3750 (6.6667) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/38] time 0.161 (0.169) data 0.085 (0.092) loss_u loss_u 0.9990 (0.9457) acc_u 0.0000 (6.7188) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [25/38] time 0.178 (0.169) data 0.101 (0.092) loss_u loss_u 0.9697 (0.9442) acc_u 3.1250 (6.6250) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [30/38] time 0.188 (0.171) data 0.111 (0.093) loss_u loss_u 0.8867 (0.9458) acc_u 12.5000 (6.3542) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [35/38] time 0.175 (0.171) data 0.097 (0.094) loss_u loss_u 0.9648 (0.9465) acc_u 3.1250 (6.2500) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 528
confident_label rate tensor(0.2250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 360
clean true:313
clean false:47
clean_rate:0.8694444444444445
noisy true:759
noisy false:481
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1240
epoch [50/200] batch [5/11] time 0.170 (0.185) data 0.094 (0.109) loss_x loss_x 0.6685 (0.5707) acc_x 87.5000 (86.2500) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [10/11] time 0.178 (0.179) data 0.102 (0.103) loss_x loss_x 0.5591 (0.5832) acc_x 81.2500 (84.6875) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/38] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.9238 (0.9573) acc_u 6.2500 (3.7500) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/38] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9556 (0.9556) acc_u 3.1250 (4.6875) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [15/38] time 0.176 (0.180) data 0.099 (0.103) loss_u loss_u 0.9673 (0.9506) acc_u 3.1250 (5.4167) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [20/38] time 0.169 (0.178) data 0.093 (0.101) loss_u loss_u 0.9507 (0.9520) acc_u 6.2500 (5.4688) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [25/38] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.9312 (0.9452) acc_u 9.3750 (6.1250) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [30/38] time 0.194 (0.178) data 0.117 (0.101) loss_u loss_u 0.9521 (0.9480) acc_u 9.3750 (6.0417) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [35/38] time 0.178 (0.178) data 0.101 (0.101) loss_u loss_u 0.8540 (0.9444) acc_u 15.6250 (6.2500) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 463
confident_label rate tensor(0.2294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 367
clean true:332
clean false:35
clean_rate:0.9046321525885559
noisy true:805
noisy false:428
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1233
epoch [51/200] batch [5/11] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.6528 (0.5080) acc_x 87.5000 (86.2500) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/11] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 1.1787 (0.6714) acc_x 78.1250 (81.8750) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/38] time 0.181 (0.183) data 0.105 (0.107) loss_u loss_u 0.9653 (0.9383) acc_u 6.2500 (6.8750) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [10/38] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9707 (0.9378) acc_u 3.1250 (6.5625) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [15/38] time 0.170 (0.182) data 0.094 (0.106) loss_u loss_u 0.9609 (0.9477) acc_u 6.2500 (5.8333) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [20/38] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.9775 (0.9484) acc_u 3.1250 (5.6250) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [25/38] time 0.172 (0.181) data 0.095 (0.104) loss_u loss_u 0.9722 (0.9476) acc_u 3.1250 (5.7500) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [30/38] time 0.178 (0.181) data 0.101 (0.104) loss_u loss_u 0.9321 (0.9482) acc_u 6.2500 (5.6250) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [35/38] time 0.173 (0.181) data 0.096 (0.104) loss_u loss_u 0.9146 (0.9482) acc_u 9.3750 (5.6250) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 530
confident_label rate tensor(0.2231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 357
clean true:314
clean false:43
clean_rate:0.8795518207282913
noisy true:756
noisy false:487
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1243
epoch [52/200] batch [5/11] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.4956 (0.6896) acc_x 87.5000 (84.3750) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/11] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.8921 (0.7291) acc_x 75.0000 (82.5000) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/38] time 0.167 (0.175) data 0.091 (0.099) loss_u loss_u 0.9053 (0.9522) acc_u 9.3750 (5.0000) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [10/38] time 0.166 (0.173) data 0.090 (0.097) loss_u loss_u 0.9248 (0.9498) acc_u 9.3750 (5.3125) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/38] time 0.182 (0.173) data 0.105 (0.096) loss_u loss_u 0.9487 (0.9440) acc_u 6.2500 (5.6250) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/38] time 0.191 (0.175) data 0.114 (0.098) loss_u loss_u 0.9351 (0.9433) acc_u 6.2500 (6.0938) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [25/38] time 0.186 (0.175) data 0.108 (0.098) loss_u loss_u 0.8911 (0.9450) acc_u 12.5000 (6.2500) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [30/38] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9253 (0.9417) acc_u 6.2500 (6.5625) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [35/38] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.9751 (0.9407) acc_u 3.1250 (6.6071) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.2362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 378
clean true:334
clean false:44
clean_rate:0.8835978835978836
noisy true:794
noisy false:428
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1222
epoch [53/200] batch [5/11] time 0.169 (0.170) data 0.092 (0.092) loss_x loss_x 0.9775 (0.7187) acc_x 84.3750 (85.6250) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/11] time 0.179 (0.173) data 0.103 (0.096) loss_x loss_x 0.6074 (0.6771) acc_x 81.2500 (83.4375) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/38] time 0.187 (0.178) data 0.110 (0.101) loss_u loss_u 0.9810 (0.9619) acc_u 3.1250 (3.7500) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/38] time 0.161 (0.177) data 0.085 (0.100) loss_u loss_u 0.9131 (0.9537) acc_u 9.3750 (5.0000) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/38] time 0.159 (0.174) data 0.080 (0.097) loss_u loss_u 0.8779 (0.9410) acc_u 12.5000 (6.2500) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [20/38] time 0.172 (0.173) data 0.095 (0.096) loss_u loss_u 0.9575 (0.9408) acc_u 6.2500 (6.2500) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [25/38] time 0.173 (0.174) data 0.094 (0.097) loss_u loss_u 0.9976 (0.9463) acc_u 0.0000 (5.6250) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [30/38] time 0.187 (0.176) data 0.110 (0.099) loss_u loss_u 0.9619 (0.9495) acc_u 3.1250 (5.2083) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [35/38] time 0.170 (0.176) data 0.093 (0.098) loss_u loss_u 0.9517 (0.9507) acc_u 6.2500 (5.0893) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.2256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 361
clean true:321
clean false:40
clean_rate:0.889196675900277
noisy true:808
noisy false:431
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1239
epoch [54/200] batch [5/11] time 0.166 (0.171) data 0.088 (0.094) loss_x loss_x 0.4443 (0.6341) acc_x 90.6250 (83.1250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/11] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.4980 (0.5343) acc_x 81.2500 (83.7500) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/38] time 0.194 (0.181) data 0.117 (0.104) loss_u loss_u 0.9688 (0.9430) acc_u 3.1250 (5.6250) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [10/38] time 0.188 (0.182) data 0.110 (0.104) loss_u loss_u 0.9707 (0.9331) acc_u 3.1250 (6.5625) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [15/38] time 0.164 (0.181) data 0.086 (0.104) loss_u loss_u 0.9517 (0.9360) acc_u 3.1250 (6.4583) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [20/38] time 0.180 (0.180) data 0.103 (0.102) loss_u loss_u 0.9346 (0.9410) acc_u 6.2500 (5.9375) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [25/38] time 0.169 (0.180) data 0.091 (0.102) loss_u loss_u 0.9736 (0.9423) acc_u 3.1250 (6.0000) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [30/38] time 0.169 (0.179) data 0.091 (0.102) loss_u loss_u 0.9531 (0.9429) acc_u 3.1250 (5.9375) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [35/38] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.9131 (0.9426) acc_u 9.3750 (5.9821) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 487
confident_label rate tensor(0.2362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 378
clean true:333
clean false:45
clean_rate:0.8809523809523809
noisy true:780
noisy false:442
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1222
epoch [55/200] batch [5/11] time 0.179 (0.176) data 0.102 (0.100) loss_x loss_x 0.8872 (0.4292) acc_x 78.1250 (88.7500) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/11] time 0.171 (0.176) data 0.093 (0.100) loss_x loss_x 0.3584 (0.4758) acc_x 90.6250 (88.7500) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/38] time 0.163 (0.173) data 0.083 (0.095) loss_u loss_u 0.8726 (0.9592) acc_u 15.6250 (5.0000) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/38] time 0.172 (0.171) data 0.095 (0.094) loss_u loss_u 0.9375 (0.9592) acc_u 6.2500 (4.6875) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/38] time 0.174 (0.172) data 0.097 (0.094) loss_u loss_u 0.9834 (0.9532) acc_u 3.1250 (5.4167) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/38] time 0.176 (0.172) data 0.099 (0.095) loss_u loss_u 0.9321 (0.9504) acc_u 9.3750 (5.7812) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [25/38] time 0.168 (0.173) data 0.091 (0.096) loss_u loss_u 0.9238 (0.9522) acc_u 9.3750 (5.6250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [30/38] time 0.190 (0.173) data 0.112 (0.096) loss_u loss_u 0.9907 (0.9494) acc_u 3.1250 (5.9375) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [35/38] time 0.180 (0.174) data 0.102 (0.097) loss_u loss_u 0.9941 (0.9520) acc_u 0.0000 (5.6250) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 526
confident_label rate tensor(0.2294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 367
clean true:316
clean false:51
clean_rate:0.8610354223433242
noisy true:758
noisy false:475
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1233
epoch [56/200] batch [5/11] time 0.167 (0.171) data 0.090 (0.094) loss_x loss_x 0.2944 (0.4960) acc_x 93.7500 (86.8750) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/11] time 0.170 (0.168) data 0.093 (0.091) loss_x loss_x 0.1678 (0.4783) acc_x 96.8750 (87.8125) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/38] time 0.182 (0.172) data 0.106 (0.095) loss_u loss_u 0.9639 (0.9503) acc_u 3.1250 (6.2500) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [10/38] time 0.183 (0.174) data 0.105 (0.097) loss_u loss_u 0.8442 (0.9395) acc_u 18.7500 (7.1875) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/38] time 0.184 (0.177) data 0.108 (0.100) loss_u loss_u 0.9688 (0.9435) acc_u 3.1250 (6.6667) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [20/38] time 0.164 (0.176) data 0.087 (0.099) loss_u loss_u 0.9341 (0.9368) acc_u 6.2500 (7.1875) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [25/38] time 0.161 (0.174) data 0.083 (0.097) loss_u loss_u 0.9448 (0.9406) acc_u 6.2500 (6.6250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/38] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.9917 (0.9391) acc_u 0.0000 (6.7708) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [35/38] time 0.179 (0.174) data 0.101 (0.097) loss_u loss_u 0.9893 (0.9390) acc_u 0.0000 (6.6071) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 494
confident_label rate tensor(0.2381, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 381
clean true:330
clean false:51
clean_rate:0.8661417322834646
noisy true:776
noisy false:443
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1219
epoch [57/200] batch [5/11] time 0.167 (0.167) data 0.090 (0.091) loss_x loss_x 0.7534 (0.6284) acc_x 71.8750 (80.0000) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/11] time 0.162 (0.165) data 0.085 (0.088) loss_x loss_x 0.5815 (0.5594) acc_x 87.5000 (83.7500) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/38] time 0.177 (0.170) data 0.101 (0.094) loss_u loss_u 0.9780 (0.9504) acc_u 3.1250 (6.2500) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [10/38] time 0.195 (0.176) data 0.118 (0.099) loss_u loss_u 0.9341 (0.9376) acc_u 6.2500 (7.5000) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/38] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.9453 (0.9456) acc_u 6.2500 (6.2500) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [20/38] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.9946 (0.9509) acc_u 0.0000 (5.4688) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [25/38] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.9106 (0.9465) acc_u 9.3750 (6.1250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [30/38] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.9224 (0.9477) acc_u 9.3750 (6.0417) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [35/38] time 0.176 (0.177) data 0.099 (0.100) loss_u loss_u 0.9648 (0.9489) acc_u 3.1250 (5.8929) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 353
clean true:317
clean false:36
clean_rate:0.8980169971671388
noisy true:799
noisy false:448
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1247
epoch [58/200] batch [5/11] time 0.183 (0.185) data 0.105 (0.108) loss_x loss_x 0.7598 (0.6068) acc_x 81.2500 (85.0000) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/11] time 0.162 (0.178) data 0.085 (0.101) loss_x loss_x 0.7949 (0.6278) acc_x 75.0000 (82.8125) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/38] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.9468 (0.9270) acc_u 6.2500 (8.7500) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/38] time 0.181 (0.174) data 0.104 (0.097) loss_u loss_u 0.9219 (0.9371) acc_u 9.3750 (7.1875) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [15/38] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.9326 (0.9306) acc_u 6.2500 (7.7083) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [20/38] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.9189 (0.9288) acc_u 9.3750 (7.9688) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [25/38] time 0.178 (0.176) data 0.099 (0.099) loss_u loss_u 0.8677 (0.9296) acc_u 12.5000 (8.0000) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [30/38] time 0.189 (0.177) data 0.112 (0.099) loss_u loss_u 0.9771 (0.9290) acc_u 3.1250 (8.2292) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [35/38] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9941 (0.9309) acc_u 0.0000 (8.0357) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 511
confident_label rate tensor(0.2269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 363
clean true:317
clean false:46
clean_rate:0.8732782369146006
noisy true:772
noisy false:465
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1237
epoch [59/200] batch [5/11] time 0.167 (0.166) data 0.089 (0.090) loss_x loss_x 0.4060 (0.7579) acc_x 84.3750 (80.0000) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [10/11] time 0.181 (0.172) data 0.104 (0.096) loss_x loss_x 1.2402 (0.6837) acc_x 78.1250 (81.5625) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/38] time 0.174 (0.174) data 0.097 (0.097) loss_u loss_u 0.9365 (0.9488) acc_u 6.2500 (5.6250) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/38] time 0.167 (0.173) data 0.088 (0.096) loss_u loss_u 0.9648 (0.9487) acc_u 3.1250 (6.2500) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/38] time 0.161 (0.170) data 0.085 (0.093) loss_u loss_u 0.8677 (0.9428) acc_u 15.6250 (7.0833) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/38] time 0.183 (0.171) data 0.105 (0.094) loss_u loss_u 0.9424 (0.9462) acc_u 6.2500 (6.5625) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [25/38] time 0.168 (0.171) data 0.091 (0.094) loss_u loss_u 0.9629 (0.9456) acc_u 3.1250 (6.6250) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [30/38] time 0.186 (0.172) data 0.109 (0.095) loss_u loss_u 0.8604 (0.9442) acc_u 15.6250 (6.7708) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [35/38] time 0.180 (0.173) data 0.104 (0.096) loss_u loss_u 0.9717 (0.9462) acc_u 3.1250 (6.3393) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 506
confident_label rate tensor(0.2387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 382
clean true:330
clean false:52
clean_rate:0.8638743455497382
noisy true:764
noisy false:454
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1218
epoch [60/200] batch [5/11] time 0.166 (0.172) data 0.089 (0.095) loss_x loss_x 0.7378 (0.7425) acc_x 81.2500 (80.0000) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/11] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.5547 (0.7604) acc_x 81.2500 (80.0000) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/38] time 0.186 (0.174) data 0.109 (0.098) loss_u loss_u 0.9976 (0.9737) acc_u 0.0000 (3.1250) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [10/38] time 0.178 (0.175) data 0.102 (0.098) loss_u loss_u 0.9775 (0.9642) acc_u 3.1250 (3.7500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/38] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.9502 (0.9556) acc_u 6.2500 (5.0000) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [20/38] time 0.185 (0.176) data 0.107 (0.099) loss_u loss_u 0.9658 (0.9549) acc_u 3.1250 (4.8438) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [25/38] time 0.173 (0.176) data 0.095 (0.099) loss_u loss_u 0.8804 (0.9548) acc_u 15.6250 (5.1250) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [30/38] time 0.171 (0.176) data 0.092 (0.099) loss_u loss_u 0.9565 (0.9507) acc_u 6.2500 (5.5208) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [35/38] time 0.173 (0.176) data 0.095 (0.099) loss_u loss_u 0.9194 (0.9499) acc_u 9.3750 (5.8036) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 549
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 373
clean true:313
clean false:60
clean_rate:0.839142091152815
noisy true:738
noisy false:489
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1227
epoch [61/200] batch [5/11] time 0.177 (0.169) data 0.098 (0.092) loss_x loss_x 0.7622 (0.7800) acc_x 87.5000 (82.5000) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/11] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.3855 (0.7256) acc_x 87.5000 (84.6875) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/38] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9966 (0.9566) acc_u 0.0000 (4.3750) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [10/38] time 0.182 (0.178) data 0.104 (0.101) loss_u loss_u 0.9937 (0.9499) acc_u 0.0000 (5.9375) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [15/38] time 0.182 (0.179) data 0.104 (0.101) loss_u loss_u 0.9092 (0.9480) acc_u 12.5000 (6.0417) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [20/38] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9756 (0.9447) acc_u 3.1250 (6.4062) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [25/38] time 0.179 (0.179) data 0.101 (0.102) loss_u loss_u 0.9224 (0.9403) acc_u 12.5000 (7.1250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [30/38] time 0.193 (0.179) data 0.116 (0.102) loss_u loss_u 0.9380 (0.9426) acc_u 6.2500 (6.7708) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [35/38] time 0.161 (0.177) data 0.085 (0.100) loss_u loss_u 0.9575 (0.9444) acc_u 3.1250 (6.6071) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 505
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 375
clean true:326
clean false:49
clean_rate:0.8693333333333333
noisy true:769
noisy false:456
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1225
epoch [62/200] batch [5/11] time 0.169 (0.167) data 0.092 (0.089) loss_x loss_x 0.6152 (0.6851) acc_x 75.0000 (83.7500) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [10/11] time 0.182 (0.172) data 0.104 (0.095) loss_x loss_x 0.5117 (0.5959) acc_x 81.2500 (84.0625) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/38] time 0.202 (0.182) data 0.122 (0.104) loss_u loss_u 0.9502 (0.9544) acc_u 6.2500 (4.3750) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [10/38] time 0.219 (0.185) data 0.141 (0.107) loss_u loss_u 0.9424 (0.9592) acc_u 6.2500 (4.3750) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [15/38] time 0.186 (0.184) data 0.108 (0.106) loss_u loss_u 0.9702 (0.9593) acc_u 3.1250 (4.5833) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [20/38] time 0.181 (0.184) data 0.105 (0.106) loss_u loss_u 0.9380 (0.9556) acc_u 9.3750 (5.1562) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [25/38] time 0.174 (0.182) data 0.097 (0.104) loss_u loss_u 0.9590 (0.9515) acc_u 6.2500 (5.7500) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [30/38] time 0.175 (0.182) data 0.097 (0.104) loss_u loss_u 0.9326 (0.9494) acc_u 6.2500 (5.9375) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [35/38] time 0.187 (0.181) data 0.110 (0.104) loss_u loss_u 0.9736 (0.9447) acc_u 3.1250 (6.4286) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 528
confident_label rate tensor(0.2325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 372
clean true:329
clean false:43
clean_rate:0.8844086021505376
noisy true:743
noisy false:485
after delete: len(clean_dataset) 372
after delete: len(noisy_dataset) 1228
epoch [63/200] batch [5/11] time 0.185 (0.178) data 0.107 (0.100) loss_x loss_x 0.7324 (0.6737) acc_x 78.1250 (82.5000) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/11] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.8652 (0.6822) acc_x 75.0000 (83.4375) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/38] time 0.169 (0.175) data 0.091 (0.097) loss_u loss_u 0.9922 (0.9464) acc_u 0.0000 (5.6250) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/38] time 0.180 (0.175) data 0.103 (0.097) loss_u loss_u 0.9761 (0.9395) acc_u 3.1250 (6.5625) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/38] time 0.174 (0.177) data 0.096 (0.100) loss_u loss_u 0.9609 (0.9430) acc_u 3.1250 (6.2500) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [20/38] time 0.178 (0.178) data 0.101 (0.100) loss_u loss_u 0.9067 (0.9393) acc_u 9.3750 (6.5625) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [25/38] time 0.178 (0.178) data 0.101 (0.100) loss_u loss_u 0.9834 (0.9438) acc_u 3.1250 (6.2500) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [30/38] time 0.182 (0.178) data 0.103 (0.100) loss_u loss_u 0.9155 (0.9458) acc_u 9.3750 (5.9375) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [35/38] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.8940 (0.9429) acc_u 12.5000 (6.4286) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 562
confident_label rate tensor(0.2294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 367
clean true:309
clean false:58
clean_rate:0.8419618528610354
noisy true:729
noisy false:504
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1233
epoch [64/200] batch [5/11] time 0.190 (0.188) data 0.113 (0.111) loss_x loss_x 0.4468 (0.6261) acc_x 90.6250 (83.1250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/11] time 0.173 (0.184) data 0.096 (0.107) loss_x loss_x 1.0625 (0.6815) acc_x 81.2500 (83.4375) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/38] time 0.173 (0.179) data 0.095 (0.102) loss_u loss_u 0.9663 (0.9559) acc_u 3.1250 (4.3750) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [10/38] time 0.176 (0.177) data 0.099 (0.100) loss_u loss_u 0.9487 (0.9543) acc_u 6.2500 (5.0000) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [15/38] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.9678 (0.9526) acc_u 3.1250 (5.2083) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [20/38] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.8711 (0.9442) acc_u 12.5000 (6.0938) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [25/38] time 0.171 (0.178) data 0.093 (0.100) loss_u loss_u 0.9146 (0.9436) acc_u 12.5000 (6.6250) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [30/38] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.9746 (0.9472) acc_u 3.1250 (6.2500) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [35/38] time 0.175 (0.177) data 0.097 (0.100) loss_u loss_u 0.9585 (0.9485) acc_u 3.1250 (6.0714) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 512
confident_label rate tensor(0.2350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 376
clean true:323
clean false:53
clean_rate:0.8590425531914894
noisy true:765
noisy false:459
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 1224
epoch [65/200] batch [5/11] time 0.180 (0.183) data 0.103 (0.107) loss_x loss_x 0.8774 (0.7668) acc_x 68.7500 (78.7500) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [10/11] time 0.177 (0.182) data 0.101 (0.106) loss_x loss_x 0.5918 (0.6404) acc_x 87.5000 (83.4375) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/38] time 0.170 (0.179) data 0.094 (0.102) loss_u loss_u 0.9927 (0.9409) acc_u 0.0000 (6.8750) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/38] time 0.161 (0.175) data 0.083 (0.098) loss_u loss_u 0.9634 (0.9507) acc_u 6.2500 (6.2500) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/38] time 0.187 (0.174) data 0.110 (0.097) loss_u loss_u 0.9546 (0.9527) acc_u 6.2500 (5.8333) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/38] time 0.169 (0.172) data 0.093 (0.095) loss_u loss_u 0.9614 (0.9464) acc_u 3.1250 (6.7188) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [25/38] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.7983 (0.9420) acc_u 25.0000 (7.1250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [30/38] time 0.193 (0.175) data 0.115 (0.098) loss_u loss_u 0.9839 (0.9445) acc_u 3.1250 (6.8750) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [35/38] time 0.189 (0.176) data 0.111 (0.099) loss_u loss_u 0.9438 (0.9428) acc_u 6.2500 (7.0536) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 533
confident_label rate tensor(0.2325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 372
clean true:319
clean false:53
clean_rate:0.8575268817204301
noisy true:748
noisy false:480
after delete: len(clean_dataset) 372
after delete: len(noisy_dataset) 1228
epoch [66/200] batch [5/11] time 0.173 (0.174) data 0.097 (0.097) loss_x loss_x 0.7104 (0.6397) acc_x 90.6250 (86.2500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/11] time 0.163 (0.171) data 0.087 (0.093) loss_x loss_x 0.2490 (0.5878) acc_x 96.8750 (86.8750) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/38] time 0.169 (0.169) data 0.091 (0.092) loss_u loss_u 0.8276 (0.9320) acc_u 21.8750 (8.1250) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/38] time 0.170 (0.169) data 0.092 (0.092) loss_u loss_u 0.9028 (0.9210) acc_u 9.3750 (9.0625) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/38] time 0.176 (0.170) data 0.099 (0.093) loss_u loss_u 0.9365 (0.9165) acc_u 6.2500 (9.7917) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/38] time 0.194 (0.172) data 0.117 (0.094) loss_u loss_u 0.9868 (0.9237) acc_u 3.1250 (8.9062) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [25/38] time 0.188 (0.173) data 0.111 (0.096) loss_u loss_u 0.9688 (0.9310) acc_u 3.1250 (8.0000) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [30/38] time 0.169 (0.173) data 0.092 (0.096) loss_u loss_u 0.9751 (0.9343) acc_u 3.1250 (7.5000) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [35/38] time 0.178 (0.174) data 0.101 (0.096) loss_u loss_u 0.9517 (0.9391) acc_u 6.2500 (6.8750) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 533
confident_label rate tensor(0.2369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 379
clean true:327
clean false:52
clean_rate:0.862796833773087
noisy true:740
noisy false:481
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1221
epoch [67/200] batch [5/11] time 0.174 (0.171) data 0.097 (0.095) loss_x loss_x 1.0713 (0.5878) acc_x 65.6250 (83.1250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/11] time 0.164 (0.169) data 0.086 (0.092) loss_x loss_x 0.8760 (0.6609) acc_x 84.3750 (81.5625) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/38] time 0.164 (0.167) data 0.086 (0.090) loss_u loss_u 0.9863 (0.9366) acc_u 0.0000 (5.6250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/38] time 0.169 (0.169) data 0.090 (0.092) loss_u loss_u 0.9839 (0.9418) acc_u 3.1250 (6.2500) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/38] time 0.178 (0.170) data 0.099 (0.092) loss_u loss_u 0.9844 (0.9437) acc_u 0.0000 (6.0417) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/38] time 0.167 (0.171) data 0.089 (0.094) loss_u loss_u 0.9404 (0.9393) acc_u 6.2500 (6.5625) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [25/38] time 0.179 (0.172) data 0.102 (0.094) loss_u loss_u 0.9722 (0.9378) acc_u 6.2500 (6.8750) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [30/38] time 0.169 (0.172) data 0.091 (0.095) loss_u loss_u 0.9170 (0.9356) acc_u 9.3750 (7.1875) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [35/38] time 0.170 (0.172) data 0.092 (0.095) loss_u loss_u 0.9385 (0.9371) acc_u 9.3750 (7.0536) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.2462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 394
clean true:335
clean false:59
clean_rate:0.850253807106599
noisy true:780
noisy false:426
after delete: len(clean_dataset) 394
after delete: len(noisy_dataset) 1206
epoch [68/200] batch [5/12] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.6938 (0.5729) acc_x 84.3750 (85.0000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/12] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.6968 (0.5357) acc_x 81.2500 (86.5625) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/37] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.9980 (0.9709) acc_u 0.0000 (5.0000) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/37] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9639 (0.9579) acc_u 3.1250 (5.0000) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/37] time 0.174 (0.184) data 0.095 (0.107) loss_u loss_u 0.9458 (0.9615) acc_u 6.2500 (4.3750) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [20/37] time 0.181 (0.183) data 0.102 (0.106) loss_u loss_u 0.9907 (0.9570) acc_u 0.0000 (4.8438) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [25/37] time 0.209 (0.183) data 0.132 (0.105) loss_u loss_u 0.9839 (0.9550) acc_u 3.1250 (5.2500) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [30/37] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.9424 (0.9547) acc_u 6.2500 (5.2083) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [35/37] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.9199 (0.9527) acc_u 12.5000 (5.7143) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 535
confident_label rate tensor(0.2387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 382
clean true:329
clean false:53
clean_rate:0.8612565445026178
noisy true:736
noisy false:482
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1218
epoch [69/200] batch [5/11] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.3613 (0.5402) acc_x 87.5000 (83.7500) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/11] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.5728 (0.6418) acc_x 81.2500 (83.7500) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/38] time 0.191 (0.186) data 0.114 (0.109) loss_u loss_u 0.9053 (0.9360) acc_u 9.3750 (6.8750) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [10/38] time 0.187 (0.186) data 0.109 (0.109) loss_u loss_u 0.9243 (0.9480) acc_u 9.3750 (5.6250) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [15/38] time 0.164 (0.184) data 0.086 (0.107) loss_u loss_u 0.9219 (0.9498) acc_u 12.5000 (6.0417) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [20/38] time 0.169 (0.182) data 0.092 (0.105) loss_u loss_u 0.9556 (0.9522) acc_u 6.2500 (5.7812) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [25/38] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.9565 (0.9500) acc_u 3.1250 (5.8750) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [30/38] time 0.194 (0.181) data 0.117 (0.104) loss_u loss_u 0.9204 (0.9446) acc_u 9.3750 (6.5625) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [35/38] time 0.174 (0.181) data 0.097 (0.104) loss_u loss_u 0.9473 (0.9448) acc_u 6.2500 (6.6071) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 523
confident_label rate tensor(0.2381, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 381
clean true:327
clean false:54
clean_rate:0.8582677165354331
noisy true:750
noisy false:469
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1219
epoch [70/200] batch [5/11] time 0.171 (0.166) data 0.094 (0.089) loss_x loss_x 0.4888 (0.4751) acc_x 81.2500 (87.5000) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [10/11] time 0.194 (0.174) data 0.117 (0.097) loss_x loss_x 0.8257 (0.6200) acc_x 81.2500 (82.8125) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/38] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.9985 (0.9743) acc_u 0.0000 (3.1250) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/38] time 0.164 (0.177) data 0.086 (0.100) loss_u loss_u 0.8970 (0.9554) acc_u 12.5000 (5.6250) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/38] time 0.161 (0.175) data 0.082 (0.098) loss_u loss_u 0.9473 (0.9476) acc_u 6.2500 (6.0417) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [20/38] time 0.184 (0.175) data 0.106 (0.097) loss_u loss_u 0.9678 (0.9461) acc_u 3.1250 (6.2500) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [25/38] time 0.182 (0.176) data 0.105 (0.098) loss_u loss_u 0.9912 (0.9417) acc_u 0.0000 (6.5000) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [30/38] time 0.180 (0.177) data 0.102 (0.099) loss_u loss_u 0.9395 (0.9439) acc_u 6.2500 (6.2500) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [35/38] time 0.186 (0.177) data 0.108 (0.100) loss_u loss_u 0.9634 (0.9455) acc_u 3.1250 (5.9821) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 500
confident_label rate tensor(0.2312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 370
clean true:319
clean false:51
clean_rate:0.8621621621621621
noisy true:781
noisy false:449
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1230
epoch [71/200] batch [5/11] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 1.5898 (0.7447) acc_x 62.5000 (82.5000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [10/11] time 0.163 (0.171) data 0.086 (0.093) loss_x loss_x 0.7344 (0.6601) acc_x 90.6250 (86.2500) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/38] time 0.187 (0.173) data 0.110 (0.096) loss_u loss_u 0.9146 (0.9519) acc_u 9.3750 (5.6250) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/38] time 0.187 (0.175) data 0.110 (0.098) loss_u loss_u 0.9355 (0.9368) acc_u 6.2500 (7.1875) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [15/38] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.9976 (0.9467) acc_u 0.0000 (6.2500) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [20/38] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.9292 (0.9451) acc_u 6.2500 (6.5625) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [25/38] time 0.180 (0.175) data 0.103 (0.098) loss_u loss_u 0.9033 (0.9433) acc_u 12.5000 (6.7500) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [30/38] time 0.171 (0.175) data 0.094 (0.097) loss_u loss_u 0.8755 (0.9430) acc_u 12.5000 (6.6667) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [35/38] time 0.172 (0.174) data 0.095 (0.097) loss_u loss_u 0.9331 (0.9422) acc_u 9.3750 (6.9643) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 508
confident_label rate tensor(0.2369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 379
clean true:321
clean false:58
clean_rate:0.8469656992084432
noisy true:771
noisy false:450
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1221
epoch [72/200] batch [5/11] time 0.168 (0.175) data 0.092 (0.098) loss_x loss_x 0.7827 (0.6651) acc_x 87.5000 (85.0000) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/11] time 0.180 (0.173) data 0.103 (0.097) loss_x loss_x 0.2646 (0.5418) acc_x 90.6250 (87.5000) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/38] time 0.186 (0.175) data 0.109 (0.099) loss_u loss_u 0.8315 (0.9245) acc_u 21.8750 (8.7500) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/38] time 0.179 (0.176) data 0.102 (0.100) loss_u loss_u 0.9648 (0.9360) acc_u 6.2500 (7.8125) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/38] time 0.162 (0.175) data 0.085 (0.098) loss_u loss_u 0.9824 (0.9396) acc_u 3.1250 (7.5000) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [20/38] time 0.163 (0.174) data 0.085 (0.097) loss_u loss_u 0.9575 (0.9414) acc_u 6.2500 (6.8750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [25/38] time 0.171 (0.175) data 0.094 (0.098) loss_u loss_u 0.9224 (0.9387) acc_u 9.3750 (7.0000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [30/38] time 0.189 (0.175) data 0.111 (0.098) loss_u loss_u 0.9106 (0.9395) acc_u 9.3750 (6.9792) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [35/38] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.9443 (0.9425) acc_u 6.2500 (6.5179) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 521
confident_label rate tensor(0.2387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 382
clean true:330
clean false:52
clean_rate:0.8638743455497382
noisy true:749
noisy false:469
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1218
epoch [73/200] batch [5/11] time 0.224 (0.192) data 0.147 (0.115) loss_x loss_x 0.5029 (0.7041) acc_x 87.5000 (84.3750) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/11] time 0.171 (0.185) data 0.094 (0.108) loss_x loss_x 0.3145 (0.6648) acc_x 93.7500 (83.4375) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/38] time 0.168 (0.180) data 0.091 (0.103) loss_u loss_u 0.8887 (0.9457) acc_u 15.6250 (7.5000) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/38] time 0.185 (0.180) data 0.105 (0.103) loss_u loss_u 0.8784 (0.9267) acc_u 15.6250 (9.0625) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [15/38] time 0.175 (0.179) data 0.097 (0.102) loss_u loss_u 0.9014 (0.9314) acc_u 12.5000 (8.3333) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [20/38] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8667 (0.9281) acc_u 15.6250 (8.5938) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [25/38] time 0.181 (0.179) data 0.102 (0.101) loss_u loss_u 0.9312 (0.9304) acc_u 9.3750 (8.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [30/38] time 0.167 (0.179) data 0.089 (0.101) loss_u loss_u 0.9971 (0.9364) acc_u 0.0000 (7.2917) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [35/38] time 0.169 (0.179) data 0.091 (0.101) loss_u loss_u 0.9380 (0.9374) acc_u 6.2500 (7.2321) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 461
confident_label rate tensor(0.2394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 383
clean true:333
clean false:50
clean_rate:0.8694516971279374
noisy true:806
noisy false:411
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1217
epoch [74/200] batch [5/11] time 0.177 (0.175) data 0.100 (0.098) loss_x loss_x 0.5596 (0.6778) acc_x 87.5000 (84.3750) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/11] time 0.175 (0.181) data 0.098 (0.104) loss_x loss_x 0.4241 (0.5716) acc_x 90.6250 (85.9375) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/38] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.9702 (0.9617) acc_u 3.1250 (3.7500) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/38] time 0.167 (0.174) data 0.091 (0.097) loss_u loss_u 0.9224 (0.9575) acc_u 9.3750 (4.6875) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/38] time 0.184 (0.174) data 0.106 (0.097) loss_u loss_u 0.9141 (0.9477) acc_u 9.3750 (5.6250) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [20/38] time 0.180 (0.174) data 0.102 (0.097) loss_u loss_u 0.9551 (0.9472) acc_u 6.2500 (5.7812) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [25/38] time 0.167 (0.175) data 0.090 (0.098) loss_u loss_u 0.9243 (0.9474) acc_u 9.3750 (6.0000) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [30/38] time 0.174 (0.175) data 0.095 (0.098) loss_u loss_u 0.9658 (0.9471) acc_u 3.1250 (6.1458) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [35/38] time 0.187 (0.176) data 0.110 (0.099) loss_u loss_u 0.9414 (0.9451) acc_u 3.1250 (6.1607) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 492
confident_label rate tensor(0.2369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 379
clean true:320
clean false:59
clean_rate:0.8443271767810027
noisy true:788
noisy false:433
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1221
epoch [75/200] batch [5/11] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.5117 (0.7060) acc_x 90.6250 (80.0000) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/11] time 0.188 (0.185) data 0.111 (0.108) loss_x loss_x 0.6025 (0.6933) acc_x 87.5000 (80.9375) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/38] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.9858 (0.9652) acc_u 3.1250 (4.3750) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [10/38] time 0.190 (0.185) data 0.112 (0.108) loss_u loss_u 0.9868 (0.9653) acc_u 3.1250 (4.0625) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [15/38] time 0.183 (0.186) data 0.106 (0.109) loss_u loss_u 0.9741 (0.9560) acc_u 3.1250 (5.0000) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [20/38] time 0.193 (0.185) data 0.115 (0.108) loss_u loss_u 0.9438 (0.9467) acc_u 6.2500 (5.9375) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [25/38] time 0.169 (0.184) data 0.092 (0.106) loss_u loss_u 0.8823 (0.9402) acc_u 12.5000 (6.6250) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [30/38] time 0.167 (0.182) data 0.089 (0.104) loss_u loss_u 0.9614 (0.9423) acc_u 3.1250 (6.4583) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [35/38] time 0.171 (0.181) data 0.094 (0.104) loss_u loss_u 0.9497 (0.9427) acc_u 6.2500 (6.2500) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.2375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 380
clean true:326
clean false:54
clean_rate:0.8578947368421053
noisy true:783
noisy false:437
after delete: len(clean_dataset) 380
after delete: len(noisy_dataset) 1220
epoch [76/200] batch [5/11] time 0.177 (0.169) data 0.100 (0.092) loss_x loss_x 0.5229 (0.5801) acc_x 87.5000 (85.0000) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [10/11] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.3562 (0.5059) acc_x 93.7500 (86.5625) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/38] time 0.174 (0.181) data 0.097 (0.104) loss_u loss_u 0.9170 (0.9556) acc_u 9.3750 (5.6250) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/38] time 0.178 (0.182) data 0.101 (0.104) loss_u loss_u 0.8457 (0.9427) acc_u 18.7500 (7.5000) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [15/38] time 0.186 (0.181) data 0.107 (0.104) loss_u loss_u 0.9844 (0.9507) acc_u 3.1250 (6.0417) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [20/38] time 0.175 (0.181) data 0.096 (0.104) loss_u loss_u 0.9614 (0.9509) acc_u 3.1250 (5.9375) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [25/38] time 0.179 (0.181) data 0.102 (0.104) loss_u loss_u 0.9595 (0.9475) acc_u 3.1250 (6.0000) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [30/38] time 0.184 (0.181) data 0.106 (0.103) loss_u loss_u 0.9248 (0.9480) acc_u 9.3750 (5.9375) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [35/38] time 0.166 (0.180) data 0.090 (0.102) loss_u loss_u 0.8999 (0.9465) acc_u 6.2500 (5.8929) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 510
confident_label rate tensor(0.2400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 384
clean true:327
clean false:57
clean_rate:0.8515625
noisy true:763
noisy false:453
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1216
epoch [77/200] batch [5/12] time 0.160 (0.170) data 0.082 (0.093) loss_x loss_x 0.5674 (0.5945) acc_x 84.3750 (84.3750) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/12] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.5093 (0.5912) acc_x 90.6250 (86.5625) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/38] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.9478 (0.9531) acc_u 6.2500 (6.2500) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/38] time 0.180 (0.176) data 0.103 (0.099) loss_u loss_u 0.9819 (0.9430) acc_u 3.1250 (7.1875) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/38] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.9980 (0.9470) acc_u 0.0000 (6.4583) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [20/38] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.8945 (0.9473) acc_u 12.5000 (6.2500) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [25/38] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.9663 (0.9496) acc_u 3.1250 (6.0000) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [30/38] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9253 (0.9438) acc_u 9.3750 (6.7708) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [35/38] time 0.190 (0.182) data 0.112 (0.105) loss_u loss_u 0.9800 (0.9472) acc_u 3.1250 (6.4286) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 533
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 373
clean true:321
clean false:52
clean_rate:0.8605898123324397
noisy true:746
noisy false:481
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1227
epoch [78/200] batch [5/11] time 0.163 (0.170) data 0.086 (0.093) loss_x loss_x 0.2627 (0.5388) acc_x 93.7500 (85.6250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/11] time 0.160 (0.167) data 0.083 (0.091) loss_x loss_x 0.5493 (0.5419) acc_x 87.5000 (85.0000) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/38] time 0.186 (0.171) data 0.108 (0.094) loss_u loss_u 0.9146 (0.9429) acc_u 9.3750 (6.8750) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/38] time 0.187 (0.175) data 0.109 (0.098) loss_u loss_u 0.9194 (0.9309) acc_u 12.5000 (9.6875) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/38] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.9326 (0.9351) acc_u 6.2500 (8.3333) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [20/38] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9331 (0.9334) acc_u 6.2500 (8.1250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [25/38] time 0.187 (0.178) data 0.109 (0.100) loss_u loss_u 0.9736 (0.9394) acc_u 3.1250 (7.3750) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [30/38] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9087 (0.9381) acc_u 9.3750 (7.2917) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [35/38] time 0.163 (0.177) data 0.086 (0.100) loss_u loss_u 0.8799 (0.9385) acc_u 12.5000 (7.1429) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 510
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 399
clean true:333
clean false:66
clean_rate:0.8345864661654135
noisy true:757
noisy false:444
after delete: len(clean_dataset) 399
after delete: len(noisy_dataset) 1201
epoch [79/200] batch [5/12] time 0.189 (0.186) data 0.112 (0.109) loss_x loss_x 0.5693 (0.5636) acc_x 84.3750 (83.7500) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/12] time 0.186 (0.186) data 0.108 (0.109) loss_x loss_x 0.4355 (0.5876) acc_x 81.2500 (82.1875) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/37] time 0.168 (0.181) data 0.090 (0.103) loss_u loss_u 0.9771 (0.9477) acc_u 6.2500 (5.6250) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/37] time 0.186 (0.179) data 0.110 (0.102) loss_u loss_u 0.9385 (0.9478) acc_u 6.2500 (5.6250) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/37] time 0.178 (0.179) data 0.101 (0.102) loss_u loss_u 0.9512 (0.9421) acc_u 6.2500 (6.0417) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [20/37] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9683 (0.9461) acc_u 3.1250 (5.6250) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [25/37] time 0.186 (0.181) data 0.108 (0.103) loss_u loss_u 0.8726 (0.9438) acc_u 15.6250 (6.1250) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [30/37] time 0.166 (0.179) data 0.089 (0.102) loss_u loss_u 0.9819 (0.9476) acc_u 0.0000 (5.7292) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [35/37] time 0.163 (0.178) data 0.085 (0.100) loss_u loss_u 0.9727 (0.9507) acc_u 3.1250 (5.3571) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 509
confident_label rate tensor(0.2450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 392
clean true:326
clean false:66
clean_rate:0.8316326530612245
noisy true:765
noisy false:443
after delete: len(clean_dataset) 392
after delete: len(noisy_dataset) 1208
epoch [80/200] batch [5/12] time 0.177 (0.173) data 0.100 (0.096) loss_x loss_x 1.2100 (0.7091) acc_x 75.0000 (80.6250) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [10/12] time 0.176 (0.175) data 0.100 (0.098) loss_x loss_x 0.4214 (0.6418) acc_x 87.5000 (83.4375) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/37] time 0.165 (0.173) data 0.088 (0.096) loss_u loss_u 0.9902 (0.9846) acc_u 0.0000 (1.2500) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/37] time 0.165 (0.172) data 0.087 (0.095) loss_u loss_u 0.9736 (0.9602) acc_u 3.1250 (4.3750) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/37] time 0.171 (0.173) data 0.094 (0.096) loss_u loss_u 0.9814 (0.9558) acc_u 3.1250 (4.7917) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/37] time 0.173 (0.172) data 0.095 (0.095) loss_u loss_u 0.9136 (0.9558) acc_u 9.3750 (4.8438) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/37] time 0.164 (0.172) data 0.086 (0.095) loss_u loss_u 0.9897 (0.9571) acc_u 0.0000 (4.5000) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [30/37] time 0.185 (0.173) data 0.108 (0.095) loss_u loss_u 0.9424 (0.9557) acc_u 6.2500 (4.6875) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [35/37] time 0.179 (0.173) data 0.101 (0.095) loss_u loss_u 0.9375 (0.9514) acc_u 9.3750 (5.3571) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 487
confident_label rate tensor(0.2450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 392
clean true:332
clean false:60
clean_rate:0.8469387755102041
noisy true:781
noisy false:427
after delete: len(clean_dataset) 392
after delete: len(noisy_dataset) 1208
epoch [81/200] batch [5/12] time 0.182 (0.167) data 0.105 (0.090) loss_x loss_x 0.4893 (0.5158) acc_x 84.3750 (86.8750) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/12] time 0.190 (0.177) data 0.113 (0.101) loss_x loss_x 0.6348 (0.5536) acc_x 84.3750 (85.6250) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/37] time 0.187 (0.179) data 0.111 (0.102) loss_u loss_u 0.9502 (0.9420) acc_u 6.2500 (6.2500) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [10/37] time 0.174 (0.179) data 0.097 (0.102) loss_u loss_u 0.9688 (0.9489) acc_u 3.1250 (5.3125) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [15/37] time 0.166 (0.179) data 0.089 (0.102) loss_u loss_u 0.9995 (0.9499) acc_u 0.0000 (5.4167) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/37] time 0.164 (0.177) data 0.087 (0.100) loss_u loss_u 0.9673 (0.9484) acc_u 3.1250 (5.6250) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [25/37] time 0.176 (0.176) data 0.098 (0.099) loss_u loss_u 0.9673 (0.9445) acc_u 3.1250 (6.1250) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [30/37] time 0.178 (0.177) data 0.100 (0.099) loss_u loss_u 0.9399 (0.9445) acc_u 6.2500 (6.0417) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [35/37] time 0.174 (0.177) data 0.096 (0.100) loss_u loss_u 0.9365 (0.9461) acc_u 6.2500 (5.8036) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 552
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 399
clean true:325
clean false:74
clean_rate:0.8145363408521303
noisy true:723
noisy false:478
after delete: len(clean_dataset) 399
after delete: len(noisy_dataset) 1201
epoch [82/200] batch [5/12] time 0.182 (0.171) data 0.104 (0.094) loss_x loss_x 1.1885 (0.6513) acc_x 71.8750 (82.5000) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [10/12] time 0.184 (0.176) data 0.108 (0.099) loss_x loss_x 0.8823 (0.6537) acc_x 84.3750 (82.5000) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/37] time 0.181 (0.171) data 0.104 (0.094) loss_u loss_u 0.9536 (0.9631) acc_u 6.2500 (4.3750) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/37] time 0.166 (0.173) data 0.088 (0.096) loss_u loss_u 0.8906 (0.9561) acc_u 9.3750 (5.0000) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/37] time 0.180 (0.175) data 0.102 (0.097) loss_u loss_u 0.9316 (0.9523) acc_u 6.2500 (5.2083) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/37] time 0.170 (0.175) data 0.094 (0.097) loss_u loss_u 0.9717 (0.9552) acc_u 9.3750 (5.1562) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/37] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.9478 (0.9528) acc_u 6.2500 (5.6250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [30/37] time 0.170 (0.176) data 0.093 (0.098) loss_u loss_u 0.8906 (0.9478) acc_u 15.6250 (6.1458) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [35/37] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.9629 (0.9487) acc_u 3.1250 (5.9821) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 518
confident_label rate tensor(0.2419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 387
clean true:327
clean false:60
clean_rate:0.8449612403100775
noisy true:755
noisy false:458
after delete: len(clean_dataset) 387
after delete: len(noisy_dataset) 1213
epoch [83/200] batch [5/12] time 0.201 (0.197) data 0.124 (0.121) loss_x loss_x 0.5239 (0.5729) acc_x 90.6250 (88.1250) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/12] time 0.183 (0.190) data 0.106 (0.113) loss_x loss_x 0.4434 (0.5212) acc_x 84.3750 (88.1250) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/37] time 0.179 (0.186) data 0.102 (0.109) loss_u loss_u 0.9487 (0.9749) acc_u 6.2500 (2.5000) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/37] time 0.166 (0.183) data 0.089 (0.106) loss_u loss_u 0.9297 (0.9531) acc_u 9.3750 (5.0000) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/37] time 0.164 (0.180) data 0.086 (0.103) loss_u loss_u 0.9102 (0.9387) acc_u 9.3750 (6.6667) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [20/37] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.9160 (0.9451) acc_u 9.3750 (6.0938) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [25/37] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.9619 (0.9443) acc_u 6.2500 (6.3750) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [30/37] time 0.178 (0.178) data 0.101 (0.101) loss_u loss_u 0.9858 (0.9459) acc_u 3.1250 (6.2500) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [35/37] time 0.178 (0.177) data 0.101 (0.100) loss_u loss_u 0.9395 (0.9441) acc_u 9.3750 (6.6071) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 511
confident_label rate tensor(0.2444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 391
clean true:330
clean false:61
clean_rate:0.8439897698209718
noisy true:759
noisy false:450
after delete: len(clean_dataset) 391
after delete: len(noisy_dataset) 1209
epoch [84/200] batch [5/12] time 0.175 (0.179) data 0.099 (0.103) loss_x loss_x 0.6875 (0.6397) acc_x 81.2500 (82.5000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/12] time 0.167 (0.171) data 0.089 (0.095) loss_x loss_x 0.3513 (0.5856) acc_x 93.7500 (85.6250) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/37] time 0.195 (0.177) data 0.117 (0.100) loss_u loss_u 0.9067 (0.9397) acc_u 9.3750 (6.8750) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/37] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9282 (0.9497) acc_u 9.3750 (5.0000) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/37] time 0.177 (0.178) data 0.100 (0.101) loss_u loss_u 0.9429 (0.9485) acc_u 6.2500 (5.4167) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/37] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.9512 (0.9473) acc_u 6.2500 (5.6250) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [25/37] time 0.169 (0.178) data 0.090 (0.101) loss_u loss_u 0.9370 (0.9408) acc_u 6.2500 (6.7500) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [30/37] time 0.193 (0.178) data 0.114 (0.101) loss_u loss_u 0.9331 (0.9401) acc_u 9.3750 (6.8750) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [35/37] time 0.184 (0.178) data 0.107 (0.100) loss_u loss_u 0.9609 (0.9422) acc_u 3.1250 (6.6964) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 542
confident_label rate tensor(0.2387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 382
clean true:322
clean false:60
clean_rate:0.8429319371727748
noisy true:736
noisy false:482
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1218
epoch [85/200] batch [5/11] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.6914 (0.5963) acc_x 84.3750 (87.5000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/11] time 0.186 (0.185) data 0.109 (0.109) loss_x loss_x 0.4512 (0.5425) acc_x 87.5000 (89.0625) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/38] time 0.182 (0.185) data 0.104 (0.108) loss_u loss_u 0.9663 (0.9451) acc_u 3.1250 (5.6250) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [10/38] time 0.215 (0.188) data 0.138 (0.111) loss_u loss_u 0.9380 (0.9320) acc_u 6.2500 (7.8125) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [15/38] time 0.174 (0.186) data 0.096 (0.109) loss_u loss_u 0.9478 (0.9275) acc_u 6.2500 (8.3333) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [20/38] time 0.190 (0.185) data 0.113 (0.108) loss_u loss_u 0.9551 (0.9326) acc_u 3.1250 (7.6562) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [25/38] time 0.168 (0.184) data 0.089 (0.107) loss_u loss_u 0.9961 (0.9391) acc_u 0.0000 (6.8750) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [30/38] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9180 (0.9409) acc_u 12.5000 (6.6667) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [35/38] time 0.175 (0.184) data 0.098 (0.107) loss_u loss_u 0.9912 (0.9457) acc_u 0.0000 (6.1607) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 569
confident_label rate tensor(0.2444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 391
clean true:317
clean false:74
clean_rate:0.8107416879795396
noisy true:714
noisy false:495
after delete: len(clean_dataset) 391
after delete: len(noisy_dataset) 1209
epoch [86/200] batch [5/12] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.3562 (0.3939) acc_x 90.6250 (89.3750) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [10/12] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.9897 (0.5007) acc_x 87.5000 (88.7500) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/37] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.9272 (0.9272) acc_u 9.3750 (7.5000) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/37] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9858 (0.9359) acc_u 0.0000 (6.8750) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/37] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.9126 (0.9391) acc_u 9.3750 (6.8750) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [20/37] time 0.168 (0.182) data 0.091 (0.105) loss_u loss_u 0.9956 (0.9430) acc_u 0.0000 (6.5625) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [25/37] time 0.174 (0.181) data 0.096 (0.104) loss_u loss_u 0.9365 (0.9435) acc_u 6.2500 (6.7500) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [30/37] time 0.176 (0.180) data 0.098 (0.103) loss_u loss_u 0.9219 (0.9402) acc_u 9.3750 (7.0833) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [35/37] time 0.168 (0.180) data 0.091 (0.103) loss_u loss_u 0.9907 (0.9402) acc_u 0.0000 (7.0536) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 514
confident_label rate tensor(0.2450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 392
clean true:333
clean false:59
clean_rate:0.8494897959183674
noisy true:753
noisy false:455
after delete: len(clean_dataset) 392
after delete: len(noisy_dataset) 1208
epoch [87/200] batch [5/12] time 0.182 (0.177) data 0.104 (0.101) loss_x loss_x 0.5078 (0.4648) acc_x 87.5000 (88.1250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/12] time 0.164 (0.175) data 0.088 (0.098) loss_x loss_x 0.4209 (0.5266) acc_x 93.7500 (85.6250) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/37] time 0.167 (0.172) data 0.090 (0.095) loss_u loss_u 0.9785 (0.9400) acc_u 3.1250 (6.2500) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/37] time 0.193 (0.173) data 0.115 (0.096) loss_u loss_u 0.8979 (0.9326) acc_u 9.3750 (6.8750) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/37] time 0.167 (0.174) data 0.089 (0.097) loss_u loss_u 0.9526 (0.9396) acc_u 9.3750 (6.2500) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/37] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.9399 (0.9375) acc_u 9.3750 (7.0312) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/37] time 0.173 (0.175) data 0.095 (0.098) loss_u loss_u 0.9551 (0.9335) acc_u 3.1250 (7.3750) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [30/37] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.9531 (0.9371) acc_u 6.2500 (6.9792) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [35/37] time 0.170 (0.176) data 0.092 (0.099) loss_u loss_u 0.9282 (0.9404) acc_u 9.3750 (6.6071) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 593
confident_label rate tensor(0.2456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 393
clean true:315
clean false:78
clean_rate:0.8015267175572519
noisy true:692
noisy false:515
after delete: len(clean_dataset) 393
after delete: len(noisy_dataset) 1207
epoch [88/200] batch [5/12] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.7227 (0.6483) acc_x 84.3750 (85.6250) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/12] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.8340 (0.7186) acc_x 75.0000 (81.2500) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/37] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9688 (0.9700) acc_u 3.1250 (3.7500) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [10/37] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.9043 (0.9462) acc_u 12.5000 (6.8750) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/37] time 0.170 (0.180) data 0.093 (0.103) loss_u loss_u 0.9634 (0.9474) acc_u 3.1250 (6.4583) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/37] time 0.164 (0.178) data 0.087 (0.101) loss_u loss_u 0.9644 (0.9452) acc_u 3.1250 (6.8750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [25/37] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.9189 (0.9445) acc_u 9.3750 (6.6250) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [30/37] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.9150 (0.9394) acc_u 12.5000 (7.1875) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [35/37] time 0.173 (0.177) data 0.095 (0.100) loss_u loss_u 0.9673 (0.9396) acc_u 3.1250 (6.9643) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 538
confident_label rate tensor(0.2437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 390
clean true:320
clean false:70
clean_rate:0.8205128205128205
noisy true:742
noisy false:468
after delete: len(clean_dataset) 390
after delete: len(noisy_dataset) 1210
epoch [89/200] batch [5/12] time 0.176 (0.169) data 0.099 (0.092) loss_x loss_x 0.3245 (0.7421) acc_x 93.7500 (80.0000) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [10/12] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.4094 (0.6587) acc_x 93.7500 (84.0625) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/37] time 0.170 (0.177) data 0.092 (0.100) loss_u loss_u 0.9565 (0.9093) acc_u 6.2500 (11.2500) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/37] time 0.163 (0.175) data 0.086 (0.098) loss_u loss_u 0.8921 (0.9209) acc_u 12.5000 (9.0625) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/37] time 0.167 (0.173) data 0.090 (0.096) loss_u loss_u 0.9556 (0.9219) acc_u 6.2500 (9.5833) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/37] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.8921 (0.9258) acc_u 12.5000 (9.0625) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/37] time 0.190 (0.174) data 0.113 (0.097) loss_u loss_u 0.9980 (0.9276) acc_u 0.0000 (8.7500) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [30/37] time 0.169 (0.174) data 0.092 (0.097) loss_u loss_u 0.9072 (0.9308) acc_u 12.5000 (8.3333) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [35/37] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.8765 (0.9300) acc_u 12.5000 (8.3036) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 548
confident_label rate tensor(0.2475, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 396
clean true:325
clean false:71
clean_rate:0.8207070707070707
noisy true:727
noisy false:477
after delete: len(clean_dataset) 396
after delete: len(noisy_dataset) 1204
epoch [90/200] batch [5/12] time 0.163 (0.170) data 0.086 (0.093) loss_x loss_x 0.2903 (0.6996) acc_x 93.7500 (83.7500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [10/12] time 0.163 (0.167) data 0.086 (0.090) loss_x loss_x 0.5298 (0.6751) acc_x 90.6250 (84.0625) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/37] time 0.176 (0.169) data 0.099 (0.092) loss_u loss_u 0.9028 (0.9301) acc_u 9.3750 (8.1250) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/37] time 0.171 (0.171) data 0.094 (0.094) loss_u loss_u 0.9160 (0.9317) acc_u 9.3750 (7.5000) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/37] time 0.193 (0.171) data 0.116 (0.094) loss_u loss_u 0.9219 (0.9304) acc_u 9.3750 (8.1250) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/37] time 0.187 (0.173) data 0.110 (0.096) loss_u loss_u 0.8936 (0.9325) acc_u 12.5000 (7.5000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/37] time 0.189 (0.175) data 0.111 (0.098) loss_u loss_u 0.9658 (0.9360) acc_u 6.2500 (7.2500) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [30/37] time 0.194 (0.177) data 0.116 (0.100) loss_u loss_u 0.9551 (0.9395) acc_u 3.1250 (6.7708) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [35/37] time 0.187 (0.178) data 0.109 (0.100) loss_u loss_u 0.9624 (0.9407) acc_u 6.2500 (6.6071) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 562
confident_label rate tensor(0.2575, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 412
clean true:324
clean false:88
clean_rate:0.7864077669902912
noisy true:714
noisy false:474
after delete: len(clean_dataset) 412
after delete: len(noisy_dataset) 1188
epoch [91/200] batch [5/12] time 0.189 (0.186) data 0.112 (0.109) loss_x loss_x 0.7183 (0.8120) acc_x 81.2500 (79.3750) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [10/12] time 0.163 (0.180) data 0.087 (0.104) loss_x loss_x 0.4568 (0.6987) acc_x 87.5000 (81.8750) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/37] time 0.179 (0.179) data 0.101 (0.102) loss_u loss_u 0.8677 (0.9418) acc_u 15.6250 (6.2500) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/37] time 0.222 (0.182) data 0.145 (0.105) loss_u loss_u 0.8750 (0.9360) acc_u 12.5000 (6.8750) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/37] time 0.173 (0.179) data 0.096 (0.102) loss_u loss_u 0.9175 (0.9412) acc_u 9.3750 (6.2500) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/37] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.9722 (0.9447) acc_u 6.2500 (5.9375) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [25/37] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9385 (0.9423) acc_u 6.2500 (6.2500) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [30/37] time 0.170 (0.179) data 0.092 (0.102) loss_u loss_u 0.9980 (0.9408) acc_u 0.0000 (6.5625) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [35/37] time 0.186 (0.179) data 0.107 (0.102) loss_u loss_u 0.9697 (0.9416) acc_u 3.1250 (6.7857) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 540
confident_label rate tensor(0.2481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 397
clean true:331
clean false:66
clean_rate:0.8337531486146096
noisy true:729
noisy false:474
after delete: len(clean_dataset) 397
after delete: len(noisy_dataset) 1203
epoch [92/200] batch [5/12] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.6533 (0.5965) acc_x 78.1250 (83.7500) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/12] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.7090 (0.6063) acc_x 84.3750 (84.3750) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/37] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.8926 (0.9167) acc_u 12.5000 (9.3750) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/37] time 0.178 (0.180) data 0.099 (0.102) loss_u loss_u 0.9492 (0.9301) acc_u 6.2500 (8.1250) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/37] time 0.167 (0.178) data 0.090 (0.101) loss_u loss_u 0.9136 (0.9372) acc_u 9.3750 (7.5000) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [20/37] time 0.163 (0.176) data 0.085 (0.099) loss_u loss_u 0.9463 (0.9441) acc_u 6.2500 (6.5625) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/37] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.9229 (0.9439) acc_u 9.3750 (6.6250) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [30/37] time 0.204 (0.176) data 0.127 (0.099) loss_u loss_u 0.9912 (0.9445) acc_u 0.0000 (6.5625) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [35/37] time 0.171 (0.175) data 0.092 (0.098) loss_u loss_u 0.9609 (0.9398) acc_u 6.2500 (7.3214) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 505
confident_label rate tensor(0.2562, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 410
clean true:337
clean false:73
clean_rate:0.8219512195121951
noisy true:758
noisy false:432
after delete: len(clean_dataset) 410
after delete: len(noisy_dataset) 1190
epoch [93/200] batch [5/12] time 0.209 (0.189) data 0.132 (0.112) loss_x loss_x 0.8760 (0.7521) acc_x 81.2500 (80.6250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [10/12] time 0.188 (0.194) data 0.112 (0.117) loss_x loss_x 0.4543 (0.5560) acc_x 87.5000 (86.8750) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/37] time 0.186 (0.190) data 0.110 (0.113) loss_u loss_u 0.9375 (0.9261) acc_u 6.2500 (8.1250) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [10/37] time 0.186 (0.187) data 0.109 (0.110) loss_u loss_u 0.9067 (0.9324) acc_u 9.3750 (7.1875) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [15/37] time 0.187 (0.186) data 0.110 (0.109) loss_u loss_u 0.9521 (0.9324) acc_u 6.2500 (7.5000) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [20/37] time 0.203 (0.186) data 0.126 (0.109) loss_u loss_u 0.9956 (0.9339) acc_u 0.0000 (7.1875) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [25/37] time 0.187 (0.186) data 0.109 (0.109) loss_u loss_u 0.9336 (0.9344) acc_u 6.2500 (7.1250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [30/37] time 0.167 (0.185) data 0.090 (0.108) loss_u loss_u 0.9556 (0.9393) acc_u 6.2500 (6.6667) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [35/37] time 0.187 (0.185) data 0.110 (0.108) loss_u loss_u 0.9980 (0.9423) acc_u 0.0000 (6.4286) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 556
confident_label rate tensor(0.2488, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 398
clean true:319
clean false:79
clean_rate:0.8015075376884422
noisy true:725
noisy false:477
after delete: len(clean_dataset) 398
after delete: len(noisy_dataset) 1202
epoch [94/200] batch [5/12] time 0.189 (0.190) data 0.111 (0.113) loss_x loss_x 0.4065 (0.6263) acc_x 84.3750 (84.3750) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [10/12] time 0.173 (0.184) data 0.096 (0.107) loss_x loss_x 0.5410 (0.5607) acc_x 87.5000 (85.3125) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/37] time 0.162 (0.182) data 0.085 (0.105) loss_u loss_u 0.9590 (0.9633) acc_u 6.2500 (4.3750) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/37] time 0.164 (0.179) data 0.087 (0.101) loss_u loss_u 0.8135 (0.9414) acc_u 18.7500 (6.5625) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/37] time 0.175 (0.177) data 0.098 (0.099) loss_u loss_u 0.9194 (0.9455) acc_u 9.3750 (6.2500) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/37] time 0.165 (0.177) data 0.087 (0.100) loss_u loss_u 0.9673 (0.9464) acc_u 3.1250 (6.0938) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [25/37] time 0.188 (0.178) data 0.111 (0.100) loss_u loss_u 0.9683 (0.9467) acc_u 3.1250 (6.0000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [30/37] time 0.186 (0.177) data 0.107 (0.100) loss_u loss_u 0.9746 (0.9468) acc_u 3.1250 (5.9375) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [35/37] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.9424 (0.9448) acc_u 6.2500 (6.0714) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 536
confident_label rate tensor(0.2556, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 409
clean true:324
clean false:85
clean_rate:0.7921760391198044
noisy true:740
noisy false:451
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1191
epoch [95/200] batch [5/12] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.5317 (0.6448) acc_x 90.6250 (83.7500) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/12] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.2847 (0.5806) acc_x 93.7500 (84.3750) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/37] time 0.174 (0.183) data 0.097 (0.107) loss_u loss_u 0.9590 (0.9661) acc_u 3.1250 (3.7500) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/37] time 0.174 (0.183) data 0.096 (0.106) loss_u loss_u 0.9058 (0.9635) acc_u 12.5000 (4.6875) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/37] time 0.163 (0.183) data 0.085 (0.105) loss_u loss_u 0.9395 (0.9620) acc_u 6.2500 (4.5833) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [20/37] time 0.199 (0.183) data 0.120 (0.106) loss_u loss_u 0.9414 (0.9607) acc_u 6.2500 (4.8438) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [25/37] time 0.192 (0.184) data 0.115 (0.106) loss_u loss_u 0.9126 (0.9525) acc_u 9.3750 (5.8750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [30/37] time 0.190 (0.185) data 0.113 (0.107) loss_u loss_u 0.8560 (0.9496) acc_u 15.6250 (6.1458) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [35/37] time 0.185 (0.185) data 0.109 (0.108) loss_u loss_u 0.9888 (0.9475) acc_u 0.0000 (6.3393) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 582
confident_label rate tensor(0.2581, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 413
clean true:330
clean false:83
clean_rate:0.7990314769975787
noisy true:688
noisy false:499
after delete: len(clean_dataset) 413
after delete: len(noisy_dataset) 1187
epoch [96/200] batch [5/12] time 0.166 (0.172) data 0.090 (0.095) loss_x loss_x 0.3989 (0.4656) acc_x 87.5000 (86.2500) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [10/12] time 0.186 (0.176) data 0.109 (0.099) loss_x loss_x 1.1572 (0.5745) acc_x 75.0000 (85.6250) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/37] time 0.176 (0.178) data 0.100 (0.101) loss_u loss_u 0.9487 (0.9404) acc_u 6.2500 (6.2500) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/37] time 0.158 (0.176) data 0.082 (0.099) loss_u loss_u 0.9331 (0.9359) acc_u 9.3750 (7.1875) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/37] time 0.188 (0.175) data 0.110 (0.098) loss_u loss_u 0.9487 (0.9382) acc_u 6.2500 (6.8750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/37] time 0.200 (0.175) data 0.123 (0.098) loss_u loss_u 0.9492 (0.9403) acc_u 6.2500 (6.5625) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/37] time 0.189 (0.177) data 0.113 (0.100) loss_u loss_u 0.9258 (0.9404) acc_u 9.3750 (6.6250) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [30/37] time 0.175 (0.177) data 0.098 (0.100) loss_u loss_u 0.9604 (0.9426) acc_u 6.2500 (6.5625) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [35/37] time 0.182 (0.177) data 0.106 (0.100) loss_u loss_u 0.9014 (0.9426) acc_u 15.6250 (6.7857) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 566
confident_label rate tensor(0.2519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 403
clean true:324
clean false:79
clean_rate:0.8039702233250621
noisy true:710
noisy false:487
after delete: len(clean_dataset) 403
after delete: len(noisy_dataset) 1197
epoch [97/200] batch [5/12] time 0.177 (0.168) data 0.101 (0.091) loss_x loss_x 0.4316 (0.5606) acc_x 87.5000 (86.2500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [10/12] time 0.162 (0.170) data 0.084 (0.093) loss_x loss_x 0.4631 (0.5205) acc_x 87.5000 (86.8750) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/37] time 0.173 (0.170) data 0.096 (0.093) loss_u loss_u 0.8896 (0.9140) acc_u 15.6250 (10.6250) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [10/37] time 0.159 (0.169) data 0.082 (0.092) loss_u loss_u 0.9883 (0.9209) acc_u 0.0000 (8.7500) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/37] time 0.183 (0.171) data 0.105 (0.094) loss_u loss_u 0.9541 (0.9329) acc_u 6.2500 (7.9167) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/37] time 0.174 (0.172) data 0.097 (0.095) loss_u loss_u 0.9360 (0.9310) acc_u 9.3750 (8.2812) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/37] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.9932 (0.9361) acc_u 0.0000 (7.6250) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [30/37] time 0.176 (0.174) data 0.097 (0.097) loss_u loss_u 0.9087 (0.9394) acc_u 9.3750 (7.1875) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [35/37] time 0.176 (0.175) data 0.099 (0.098) loss_u loss_u 0.9487 (0.9413) acc_u 6.2500 (6.9643) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 560
confident_label rate tensor(0.2512, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 402
clean true:318
clean false:84
clean_rate:0.7910447761194029
noisy true:722
noisy false:476
after delete: len(clean_dataset) 402
after delete: len(noisy_dataset) 1198
epoch [98/200] batch [5/12] time 0.190 (0.188) data 0.113 (0.112) loss_x loss_x 0.2078 (0.6272) acc_x 93.7500 (85.0000) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [10/12] time 0.163 (0.180) data 0.086 (0.104) loss_x loss_x 0.6699 (0.6163) acc_x 81.2500 (84.3750) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/37] time 0.174 (0.177) data 0.096 (0.100) loss_u loss_u 0.9546 (0.9566) acc_u 3.1250 (4.3750) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/37] time 0.186 (0.177) data 0.109 (0.101) loss_u loss_u 0.8848 (0.9483) acc_u 12.5000 (5.3125) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/37] time 0.177 (0.178) data 0.100 (0.101) loss_u loss_u 0.8999 (0.9371) acc_u 12.5000 (6.6667) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/37] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.8701 (0.9341) acc_u 15.6250 (7.0312) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [25/37] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.9663 (0.9398) acc_u 3.1250 (6.3750) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [30/37] time 0.190 (0.178) data 0.113 (0.101) loss_u loss_u 0.9390 (0.9442) acc_u 6.2500 (5.9375) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [35/37] time 0.183 (0.178) data 0.104 (0.101) loss_u loss_u 0.9136 (0.9383) acc_u 9.3750 (6.6964) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 535
confident_label rate tensor(0.2544, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 407
clean true:321
clean false:86
clean_rate:0.7886977886977887
noisy true:744
noisy false:449
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1193
epoch [99/200] batch [5/12] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.4128 (0.5549) acc_x 84.3750 (82.5000) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [10/12] time 0.188 (0.186) data 0.111 (0.109) loss_x loss_x 0.7534 (0.6200) acc_x 81.2500 (84.3750) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/37] time 0.187 (0.184) data 0.108 (0.107) loss_u loss_u 0.9336 (0.9325) acc_u 9.3750 (8.1250) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [10/37] time 0.183 (0.184) data 0.107 (0.107) loss_u loss_u 0.8706 (0.9250) acc_u 15.6250 (9.3750) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/37] time 0.176 (0.183) data 0.098 (0.105) loss_u loss_u 0.9561 (0.9382) acc_u 6.2500 (7.7083) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [20/37] time 0.187 (0.183) data 0.110 (0.105) loss_u loss_u 0.8955 (0.9325) acc_u 9.3750 (7.9688) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [25/37] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.9355 (0.9362) acc_u 9.3750 (7.6250) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [30/37] time 0.187 (0.182) data 0.111 (0.105) loss_u loss_u 0.8848 (0.9322) acc_u 12.5000 (7.8125) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [35/37] time 0.169 (0.182) data 0.092 (0.105) loss_u loss_u 0.9810 (0.9362) acc_u 3.1250 (7.5000) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 575
confident_label rate tensor(0.2600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 416
clean true:329
clean false:87
clean_rate:0.7908653846153846
noisy true:696
noisy false:488
all clean rate:  [0.9470899470899471, 0.909952606635071, 0.9669117647058824, 0.9578947368421052, 0.9655172413793104, 0.9590443686006825, 0.9690721649484536, 0.9726962457337884, 0.9540636042402827, 0.9659863945578231, 0.9602649006622517, 0.9363057324840764, 0.9522292993630573, 0.9537953795379538, 0.9478827361563518, 0.9463722397476341, 0.9444444444444444, 0.9576547231270358, 0.940983606557377, 0.9448051948051948, 0.9615384615384616, 0.9492063492063492, 0.927710843373494, 0.9285714285714286, 0.9272151898734177, 0.8988095238095238, 0.9166666666666666, 0.9223880597014925, 0.9044776119402985, 0.9329268292682927, 0.9194029850746268, 0.9195402298850575, 0.9080118694362018, 0.9090909090909091, 0.9003021148036254, 0.9048991354466859, 0.9127906976744186, 0.9131736526946108, 0.9281437125748503, 0.888235294117647, 0.8774928774928775, 0.8859649122807017, 0.8778409090909091, 0.8982558139534884, 0.8994252873563219, 0.8937329700272479, 0.8873239436619719, 0.8644986449864499, 0.8798882681564246, 0.8694444444444445, 0.9046321525885559, 0.8795518207282913, 0.8835978835978836, 0.889196675900277, 0.8809523809523809, 0.8610354223433242, 0.8661417322834646, 0.8980169971671388, 0.8732782369146006, 0.8638743455497382, 0.839142091152815, 0.8693333333333333, 0.8844086021505376, 0.8419618528610354, 0.8590425531914894, 0.8575268817204301, 0.862796833773087, 0.850253807106599, 0.8612565445026178, 0.8582677165354331, 0.8621621621621621, 0.8469656992084432, 0.8638743455497382, 0.8694516971279374, 0.8443271767810027, 0.8578947368421053, 0.8515625, 0.8605898123324397, 0.8345864661654135, 0.8316326530612245, 0.8469387755102041, 0.8145363408521303, 0.8449612403100775, 0.8439897698209718, 0.8429319371727748, 0.8107416879795396, 0.8494897959183674, 0.8015267175572519, 0.8205128205128205, 0.8207070707070707, 0.7864077669902912, 0.8337531486146096, 0.8219512195121951, 0.8015075376884422, 0.7921760391198044, 0.7990314769975787, 0.8039702233250621, 0.7910447761194029, 0.7886977886977887, 0.7908653846153846]
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 1184
epoch [100/200] batch [5/13] time 0.180 (0.177) data 0.104 (0.101) loss_x loss_x 0.8354 (0.6037) acc_x 84.3750 (86.2500) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [10/13] time 0.174 (0.181) data 0.097 (0.105) loss_x loss_x 0.7759 (0.5763) acc_x 81.2500 (84.3750) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/37] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.8872 (0.9266) acc_u 12.5000 (8.1250) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/37] time 0.171 (0.175) data 0.094 (0.098) loss_u loss_u 0.9595 (0.9351) acc_u 3.1250 (7.5000) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/37] time 0.194 (0.176) data 0.116 (0.099) loss_u loss_u 0.9497 (0.9406) acc_u 6.2500 (7.0833) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/37] time 0.174 (0.176) data 0.097 (0.099) loss_u loss_u 0.9316 (0.9446) acc_u 9.3750 (6.7188) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/37] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.9985 (0.9476) acc_u 0.0000 (6.3750) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [30/37] time 0.165 (0.177) data 0.087 (0.099) loss_u loss_u 0.9312 (0.9414) acc_u 6.2500 (6.8750) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [35/37] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.9766 (0.9453) acc_u 0.0000 (6.4286) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 581
confident_label rate tensor(0.2594, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 415
clean true:326
clean false:89
clean_rate:0.7855421686746988
noisy true:693
noisy false:492
after delete: len(clean_dataset) 415
after delete: len(noisy_dataset) 1185
epoch [101/200] batch [5/12] time 0.190 (0.189) data 0.114 (0.112) loss_x loss_x 0.4636 (0.5130) acc_x 90.6250 (90.0000) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/12] time 0.186 (0.190) data 0.109 (0.112) loss_x loss_x 0.5269 (0.5884) acc_x 87.5000 (86.8750) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/37] time 0.187 (0.188) data 0.110 (0.111) loss_u loss_u 0.9609 (0.9727) acc_u 6.2500 (3.1250) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [10/37] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.8530 (0.9349) acc_u 15.6250 (7.1875) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [15/37] time 0.171 (0.183) data 0.094 (0.106) loss_u loss_u 0.9229 (0.9351) acc_u 9.3750 (7.2917) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [20/37] time 0.187 (0.182) data 0.109 (0.105) loss_u loss_u 0.9624 (0.9417) acc_u 6.2500 (6.8750) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [25/37] time 0.177 (0.183) data 0.101 (0.106) loss_u loss_u 0.9526 (0.9410) acc_u 6.2500 (7.1250) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [30/37] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.9565 (0.9409) acc_u 3.1250 (6.9792) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [35/37] time 0.186 (0.184) data 0.109 (0.106) loss_u loss_u 0.9150 (0.9417) acc_u 9.3750 (6.8750) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 578
confident_label rate tensor(0.2569, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 411
clean true:328
clean false:83
clean_rate:0.7980535279805353
noisy true:694
noisy false:495
after delete: len(clean_dataset) 411
after delete: len(noisy_dataset) 1189
epoch [102/200] batch [5/12] time 0.175 (0.169) data 0.097 (0.092) loss_x loss_x 0.4070 (0.3878) acc_x 87.5000 (90.6250) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/12] time 0.167 (0.169) data 0.090 (0.092) loss_x loss_x 0.5068 (0.4532) acc_x 90.6250 (88.7500) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/37] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.9619 (0.9677) acc_u 6.2500 (4.3750) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/37] time 0.173 (0.177) data 0.097 (0.100) loss_u loss_u 0.9883 (0.9480) acc_u 0.0000 (6.5625) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/37] time 0.170 (0.176) data 0.092 (0.099) loss_u loss_u 0.9375 (0.9504) acc_u 6.2500 (6.0417) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/37] time 0.173 (0.175) data 0.095 (0.098) loss_u loss_u 0.8940 (0.9413) acc_u 12.5000 (7.1875) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/37] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.9287 (0.9453) acc_u 9.3750 (6.7500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [30/37] time 0.186 (0.176) data 0.110 (0.099) loss_u loss_u 0.9180 (0.9393) acc_u 9.3750 (7.3958) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [35/37] time 0.183 (0.177) data 0.106 (0.099) loss_u loss_u 0.9409 (0.9396) acc_u 9.3750 (7.4107) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 523
confident_label rate tensor(0.2706, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 433
clean true:338
clean false:95
clean_rate:0.7806004618937644
noisy true:739
noisy false:428
after delete: len(clean_dataset) 433
after delete: len(noisy_dataset) 1167
epoch [103/200] batch [5/13] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.4604 (0.6342) acc_x 87.5000 (81.8750) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [10/13] time 0.183 (0.182) data 0.105 (0.106) loss_x loss_x 0.9238 (0.6298) acc_x 90.6250 (84.6875) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/36] time 0.174 (0.178) data 0.095 (0.102) loss_u loss_u 0.9424 (0.9750) acc_u 6.2500 (2.5000) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/36] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.8433 (0.9530) acc_u 18.7500 (5.0000) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/36] time 0.168 (0.177) data 0.091 (0.101) loss_u loss_u 0.9077 (0.9456) acc_u 9.3750 (5.8333) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/36] time 0.173 (0.178) data 0.095 (0.101) loss_u loss_u 0.9736 (0.9507) acc_u 3.1250 (5.3125) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/36] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.9707 (0.9505) acc_u 6.2500 (5.2500) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [30/36] time 0.183 (0.178) data 0.104 (0.101) loss_u loss_u 0.9609 (0.9512) acc_u 6.2500 (5.3125) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [35/36] time 0.183 (0.179) data 0.104 (0.101) loss_u loss_u 0.9312 (0.9521) acc_u 9.3750 (5.2679) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 573
confident_label rate tensor(0.2612, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 418
clean true:326
clean false:92
clean_rate:0.7799043062200957
noisy true:701
noisy false:481
after delete: len(clean_dataset) 418
after delete: len(noisy_dataset) 1182
epoch [104/200] batch [5/13] time 0.175 (0.184) data 0.097 (0.107) loss_x loss_x 0.6880 (0.6369) acc_x 84.3750 (83.1250) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/13] time 0.172 (0.176) data 0.095 (0.098) loss_x loss_x 0.4229 (0.5377) acc_x 87.5000 (85.9375) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/36] time 0.187 (0.178) data 0.109 (0.100) loss_u loss_u 0.9570 (0.9503) acc_u 6.2500 (5.6250) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [10/36] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.9600 (0.9535) acc_u 6.2500 (5.3125) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/36] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.9580 (0.9479) acc_u 6.2500 (6.2500) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/36] time 0.171 (0.177) data 0.092 (0.100) loss_u loss_u 0.9800 (0.9464) acc_u 3.1250 (6.7188) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/36] time 0.171 (0.176) data 0.093 (0.099) loss_u loss_u 0.9058 (0.9439) acc_u 9.3750 (6.7500) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [30/36] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9531 (0.9402) acc_u 6.2500 (7.2917) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [35/36] time 0.186 (0.177) data 0.109 (0.099) loss_u loss_u 0.9380 (0.9404) acc_u 6.2500 (7.1429) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 559
confident_label rate tensor(0.2600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 416
clean true:330
clean false:86
clean_rate:0.7932692307692307
noisy true:711
noisy false:473
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 1184
epoch [105/200] batch [5/13] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 1.0254 (0.5938) acc_x 71.8750 (85.6250) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/13] time 0.164 (0.181) data 0.087 (0.104) loss_x loss_x 0.4385 (0.4828) acc_x 93.7500 (88.7500) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/37] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.8970 (0.9156) acc_u 9.3750 (11.2500) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [10/37] time 0.171 (0.180) data 0.094 (0.102) loss_u loss_u 0.9336 (0.9249) acc_u 9.3750 (9.6875) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/37] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8838 (0.9316) acc_u 15.6250 (8.5417) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/37] time 0.187 (0.181) data 0.110 (0.104) loss_u loss_u 0.9351 (0.9348) acc_u 6.2500 (7.9688) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [25/37] time 0.183 (0.182) data 0.106 (0.104) loss_u loss_u 0.9697 (0.9322) acc_u 3.1250 (8.0000) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [30/37] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9937 (0.9352) acc_u 0.0000 (7.5000) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [35/37] time 0.188 (0.183) data 0.110 (0.105) loss_u loss_u 0.8765 (0.9376) acc_u 15.6250 (7.2321) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 581
confident_label rate tensor(0.2606, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 417
clean true:322
clean false:95
clean_rate:0.7721822541966427
noisy true:697
noisy false:486
after delete: len(clean_dataset) 417
after delete: len(noisy_dataset) 1183
epoch [106/200] batch [5/13] time 0.172 (0.182) data 0.096 (0.105) loss_x loss_x 0.8433 (0.5052) acc_x 84.3750 (88.1250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [10/13] time 0.172 (0.174) data 0.096 (0.097) loss_x loss_x 0.4795 (0.4581) acc_x 84.3750 (88.1250) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/36] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.9629 (0.9273) acc_u 6.2500 (8.7500) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/36] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9629 (0.9348) acc_u 3.1250 (7.8125) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/36] time 0.204 (0.177) data 0.127 (0.100) loss_u loss_u 0.9746 (0.9343) acc_u 3.1250 (7.9167) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/36] time 0.179 (0.177) data 0.102 (0.100) loss_u loss_u 0.8799 (0.9387) acc_u 12.5000 (7.3438) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/36] time 0.172 (0.177) data 0.093 (0.100) loss_u loss_u 0.8867 (0.9400) acc_u 12.5000 (7.1250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [30/36] time 0.177 (0.177) data 0.099 (0.100) loss_u loss_u 0.9741 (0.9366) acc_u 3.1250 (7.6042) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [35/36] time 0.177 (0.178) data 0.100 (0.101) loss_u loss_u 0.9585 (0.9377) acc_u 3.1250 (7.3214) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 553
confident_label rate tensor(0.2625, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 420
clean true:329
clean false:91
clean_rate:0.7833333333333333
noisy true:718
noisy false:462
after delete: len(clean_dataset) 420
after delete: len(noisy_dataset) 1180
epoch [107/200] batch [5/13] time 0.181 (0.185) data 0.105 (0.109) loss_x loss_x 0.8223 (0.5809) acc_x 84.3750 (86.8750) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [10/13] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.7363 (0.5537) acc_x 78.1250 (85.3125) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/36] time 0.169 (0.181) data 0.091 (0.104) loss_u loss_u 0.9512 (0.9253) acc_u 6.2500 (7.5000) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/36] time 0.177 (0.179) data 0.099 (0.102) loss_u loss_u 0.9448 (0.9306) acc_u 6.2500 (7.5000) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/36] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.9673 (0.9449) acc_u 3.1250 (5.6250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/36] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.9497 (0.9439) acc_u 6.2500 (5.9375) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/36] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.9702 (0.9453) acc_u 3.1250 (5.7500) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [30/36] time 0.189 (0.182) data 0.111 (0.104) loss_u loss_u 0.9048 (0.9440) acc_u 9.3750 (5.8333) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [35/36] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.9946 (0.9480) acc_u 0.0000 (5.4464) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 555
confident_label rate tensor(0.2581, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 413
clean true:325
clean false:88
clean_rate:0.7869249394673123
noisy true:720
noisy false:467
after delete: len(clean_dataset) 413
after delete: len(noisy_dataset) 1187
epoch [108/200] batch [5/12] time 0.162 (0.164) data 0.085 (0.087) loss_x loss_x 0.4265 (0.4957) acc_x 87.5000 (87.5000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/12] time 0.165 (0.165) data 0.087 (0.088) loss_x loss_x 0.9644 (0.5795) acc_x 90.6250 (86.2500) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/37] time 0.180 (0.171) data 0.102 (0.093) loss_u loss_u 0.9746 (0.9608) acc_u 3.1250 (4.3750) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/37] time 0.172 (0.171) data 0.095 (0.093) loss_u loss_u 0.9126 (0.9455) acc_u 9.3750 (5.9375) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/37] time 0.185 (0.172) data 0.109 (0.095) loss_u loss_u 0.8833 (0.9443) acc_u 12.5000 (6.0417) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/37] time 0.170 (0.173) data 0.094 (0.096) loss_u loss_u 0.8647 (0.9369) acc_u 15.6250 (6.7188) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/37] time 0.178 (0.173) data 0.101 (0.096) loss_u loss_u 0.8711 (0.9305) acc_u 12.5000 (7.3750) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [30/37] time 0.192 (0.174) data 0.115 (0.097) loss_u loss_u 0.9971 (0.9321) acc_u 0.0000 (7.1875) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [35/37] time 0.169 (0.173) data 0.092 (0.096) loss_u loss_u 0.9019 (0.9323) acc_u 9.3750 (7.2321) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 577
confident_label rate tensor(0.2600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 416
clean true:328
clean false:88
clean_rate:0.7884615384615384
noisy true:695
noisy false:489
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 1184
epoch [109/200] batch [5/13] time 0.173 (0.177) data 0.095 (0.099) loss_x loss_x 0.2505 (0.4412) acc_x 100.0000 (91.2500) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/13] time 0.172 (0.174) data 0.096 (0.097) loss_x loss_x 0.3599 (0.5258) acc_x 84.3750 (87.1875) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/37] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.9023 (0.9417) acc_u 12.5000 (7.5000) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/37] time 0.173 (0.177) data 0.095 (0.100) loss_u loss_u 0.9678 (0.9345) acc_u 3.1250 (7.8125) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/37] time 0.174 (0.178) data 0.097 (0.100) loss_u loss_u 0.9487 (0.9241) acc_u 9.3750 (9.1667) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/37] time 0.173 (0.179) data 0.095 (0.102) loss_u loss_u 0.9248 (0.9278) acc_u 9.3750 (8.5938) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [25/37] time 0.188 (0.180) data 0.111 (0.102) loss_u loss_u 0.9004 (0.9322) acc_u 9.3750 (7.7500) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [30/37] time 0.181 (0.179) data 0.103 (0.102) loss_u loss_u 0.9043 (0.9293) acc_u 12.5000 (8.0208) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [35/37] time 0.195 (0.179) data 0.117 (0.102) loss_u loss_u 0.9482 (0.9329) acc_u 6.2500 (7.5893) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 557
confident_label rate tensor(0.2488, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 398
clean true:318
clean false:80
clean_rate:0.7989949748743719
noisy true:725
noisy false:477
after delete: len(clean_dataset) 398
after delete: len(noisy_dataset) 1202
epoch [110/200] batch [5/12] time 0.186 (0.168) data 0.109 (0.091) loss_x loss_x 0.4668 (0.4293) acc_x 81.2500 (86.8750) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/12] time 0.162 (0.174) data 0.084 (0.097) loss_x loss_x 0.3594 (0.4644) acc_x 93.7500 (87.5000) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/37] time 0.195 (0.178) data 0.116 (0.100) loss_u loss_u 0.9258 (0.9182) acc_u 9.3750 (10.0000) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/37] time 0.189 (0.180) data 0.111 (0.103) loss_u loss_u 0.9653 (0.9230) acc_u 3.1250 (9.0625) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/37] time 0.188 (0.182) data 0.111 (0.104) loss_u loss_u 0.9194 (0.9244) acc_u 9.3750 (9.1667) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [20/37] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.9995 (0.9254) acc_u 0.0000 (8.5938) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [25/37] time 0.189 (0.184) data 0.112 (0.107) loss_u loss_u 0.9463 (0.9266) acc_u 6.2500 (8.5000) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [30/37] time 0.187 (0.185) data 0.111 (0.107) loss_u loss_u 0.9507 (0.9238) acc_u 6.2500 (8.9583) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [35/37] time 0.170 (0.184) data 0.093 (0.107) loss_u loss_u 0.9570 (0.9259) acc_u 6.2500 (8.7500) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 530
confident_label rate tensor(0.2587, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 414
clean true:333
clean false:81
clean_rate:0.8043478260869565
noisy true:737
noisy false:449
after delete: len(clean_dataset) 414
after delete: len(noisy_dataset) 1186
epoch [111/200] batch [5/12] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 1.0947 (0.5688) acc_x 68.7500 (83.1250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/12] time 0.213 (0.181) data 0.137 (0.104) loss_x loss_x 0.7852 (0.5852) acc_x 81.2500 (84.6875) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/37] time 0.188 (0.176) data 0.110 (0.099) loss_u loss_u 0.9370 (0.9242) acc_u 6.2500 (8.1250) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/37] time 0.180 (0.177) data 0.103 (0.100) loss_u loss_u 0.9854 (0.9218) acc_u 3.1250 (8.4375) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/37] time 0.181 (0.178) data 0.103 (0.100) loss_u loss_u 0.9170 (0.9311) acc_u 12.5000 (8.1250) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/37] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9038 (0.9343) acc_u 9.3750 (7.5000) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [25/37] time 0.180 (0.179) data 0.103 (0.101) loss_u loss_u 0.9497 (0.9397) acc_u 6.2500 (7.0000) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [30/37] time 0.178 (0.180) data 0.100 (0.102) loss_u loss_u 0.9937 (0.9414) acc_u 0.0000 (6.7708) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [35/37] time 0.173 (0.181) data 0.096 (0.103) loss_u loss_u 0.9438 (0.9377) acc_u 6.2500 (7.0536) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 601
confident_label rate tensor(0.2544, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 407
clean true:317
clean false:90
clean_rate:0.7788697788697788
noisy true:682
noisy false:511
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1193
epoch [112/200] batch [5/12] time 0.185 (0.179) data 0.109 (0.102) loss_x loss_x 0.5439 (0.6114) acc_x 93.7500 (85.0000) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/12] time 0.174 (0.180) data 0.097 (0.103) loss_x loss_x 0.4778 (0.5197) acc_x 81.2500 (86.2500) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/37] time 0.174 (0.178) data 0.097 (0.101) loss_u loss_u 0.9780 (0.9497) acc_u 3.1250 (5.6250) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [10/37] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9736 (0.9435) acc_u 3.1250 (6.8750) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/37] time 0.176 (0.178) data 0.098 (0.101) loss_u loss_u 0.9702 (0.9349) acc_u 3.1250 (7.5000) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/37] time 0.214 (0.179) data 0.137 (0.102) loss_u loss_u 0.8940 (0.9296) acc_u 12.5000 (7.9688) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [25/37] time 0.174 (0.178) data 0.097 (0.101) loss_u loss_u 0.8823 (0.9296) acc_u 15.6250 (8.2500) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [30/37] time 0.169 (0.178) data 0.092 (0.100) loss_u loss_u 0.9087 (0.9281) acc_u 9.3750 (8.4375) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [35/37] time 0.167 (0.177) data 0.090 (0.099) loss_u loss_u 0.8994 (0.9312) acc_u 12.5000 (8.1250) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 564
confident_label rate tensor(0.2575, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 412
clean true:325
clean false:87
clean_rate:0.7888349514563107
noisy true:711
noisy false:477
after delete: len(clean_dataset) 412
after delete: len(noisy_dataset) 1188
epoch [113/200] batch [5/12] time 0.181 (0.173) data 0.104 (0.096) loss_x loss_x 0.4910 (0.5333) acc_x 81.2500 (84.3750) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/12] time 0.173 (0.175) data 0.095 (0.098) loss_x loss_x 0.5444 (0.5828) acc_x 90.6250 (84.6875) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/37] time 0.182 (0.177) data 0.105 (0.099) loss_u loss_u 0.9614 (0.9248) acc_u 3.1250 (8.7500) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [10/37] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.9346 (0.9377) acc_u 9.3750 (7.1875) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/37] time 0.172 (0.176) data 0.095 (0.098) loss_u loss_u 0.8828 (0.9306) acc_u 12.5000 (7.9167) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [20/37] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.9346 (0.9365) acc_u 6.2500 (6.8750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/37] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.8706 (0.9330) acc_u 15.6250 (7.2500) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [30/37] time 0.180 (0.179) data 0.103 (0.101) loss_u loss_u 0.9424 (0.9314) acc_u 6.2500 (7.5000) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [35/37] time 0.163 (0.178) data 0.086 (0.100) loss_u loss_u 0.8584 (0.9297) acc_u 15.6250 (7.6786) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 571
confident_label rate tensor(0.2637, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 422
clean true:326
clean false:96
clean_rate:0.7725118483412322
noisy true:703
noisy false:475
after delete: len(clean_dataset) 422
after delete: len(noisy_dataset) 1178
epoch [114/200] batch [5/13] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.5747 (0.6064) acc_x 84.3750 (84.3750) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [10/13] time 0.177 (0.183) data 0.100 (0.106) loss_x loss_x 0.3030 (0.5721) acc_x 84.3750 (84.6875) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/36] time 0.171 (0.180) data 0.094 (0.103) loss_u loss_u 0.9927 (0.9511) acc_u 0.0000 (5.0000) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [10/36] time 0.178 (0.178) data 0.102 (0.101) loss_u loss_u 0.9028 (0.9268) acc_u 9.3750 (7.5000) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/36] time 0.190 (0.179) data 0.113 (0.102) loss_u loss_u 0.9238 (0.9352) acc_u 9.3750 (6.8750) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/36] time 0.169 (0.179) data 0.091 (0.102) loss_u loss_u 0.9399 (0.9349) acc_u 6.2500 (6.7188) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/36] time 0.170 (0.178) data 0.092 (0.100) loss_u loss_u 0.8994 (0.9358) acc_u 15.6250 (7.1250) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [30/36] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.9697 (0.9403) acc_u 6.2500 (6.7708) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [35/36] time 0.185 (0.179) data 0.108 (0.101) loss_u loss_u 0.9653 (0.9423) acc_u 3.1250 (6.5179) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 563
confident_label rate tensor(0.2537, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 406
clean true:320
clean false:86
clean_rate:0.7881773399014779
noisy true:717
noisy false:477
after delete: len(clean_dataset) 406
after delete: len(noisy_dataset) 1194
epoch [115/200] batch [5/12] time 0.173 (0.177) data 0.097 (0.100) loss_x loss_x 0.5005 (0.5999) acc_x 81.2500 (83.1250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/12] time 0.171 (0.173) data 0.094 (0.095) loss_x loss_x 0.5586 (0.5861) acc_x 81.2500 (83.7500) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/37] time 0.188 (0.180) data 0.110 (0.102) loss_u loss_u 0.9141 (0.9299) acc_u 12.5000 (8.7500) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/37] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9604 (0.9235) acc_u 3.1250 (9.3750) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/37] time 0.175 (0.185) data 0.097 (0.107) loss_u loss_u 0.9229 (0.9301) acc_u 9.3750 (8.1250) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [20/37] time 0.178 (0.183) data 0.101 (0.105) loss_u loss_u 0.9868 (0.9341) acc_u 0.0000 (7.6562) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [25/37] time 0.173 (0.183) data 0.096 (0.106) loss_u loss_u 0.9282 (0.9306) acc_u 6.2500 (8.0000) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [30/37] time 0.187 (0.182) data 0.109 (0.105) loss_u loss_u 0.9609 (0.9302) acc_u 6.2500 (8.0208) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [35/37] time 0.177 (0.183) data 0.100 (0.105) loss_u loss_u 0.9429 (0.9298) acc_u 6.2500 (7.9464) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 552
confident_label rate tensor(0.2650, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 424
clean true:339
clean false:85
clean_rate:0.7995283018867925
noisy true:709
noisy false:467
after delete: len(clean_dataset) 424
after delete: len(noisy_dataset) 1176
epoch [116/200] batch [5/13] time 0.181 (0.179) data 0.105 (0.101) loss_x loss_x 0.3213 (0.3889) acc_x 87.5000 (90.6250) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/13] time 0.171 (0.175) data 0.092 (0.098) loss_x loss_x 0.4729 (0.4309) acc_x 84.3750 (89.0625) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/36] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.9688 (0.9336) acc_u 3.1250 (6.8750) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [10/36] time 0.187 (0.177) data 0.110 (0.100) loss_u loss_u 0.9185 (0.9460) acc_u 12.5000 (6.5625) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/36] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.8340 (0.9330) acc_u 21.8750 (8.1250) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/36] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.9077 (0.9381) acc_u 12.5000 (7.8125) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/36] time 0.190 (0.181) data 0.111 (0.103) loss_u loss_u 0.9087 (0.9394) acc_u 12.5000 (7.5000) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [30/36] time 0.171 (0.180) data 0.093 (0.103) loss_u loss_u 0.9922 (0.9421) acc_u 0.0000 (6.9792) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [35/36] time 0.180 (0.179) data 0.102 (0.102) loss_u loss_u 0.9097 (0.9400) acc_u 9.3750 (7.4107) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 581
confident_label rate tensor(0.2525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 404
clean true:324
clean false:80
clean_rate:0.801980198019802
noisy true:695
noisy false:501
after delete: len(clean_dataset) 404
after delete: len(noisy_dataset) 1196
epoch [117/200] batch [5/12] time 0.187 (0.183) data 0.109 (0.106) loss_x loss_x 0.7930 (0.5725) acc_x 75.0000 (82.5000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/12] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 1.0605 (0.5751) acc_x 78.1250 (83.4375) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/37] time 0.187 (0.180) data 0.109 (0.103) loss_u loss_u 0.9902 (0.9524) acc_u 0.0000 (5.0000) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/37] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.8994 (0.9486) acc_u 15.6250 (5.9375) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/37] time 0.183 (0.182) data 0.105 (0.104) loss_u loss_u 0.9990 (0.9402) acc_u 0.0000 (7.2917) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [20/37] time 0.185 (0.183) data 0.108 (0.105) loss_u loss_u 0.9663 (0.9363) acc_u 3.1250 (7.8125) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [25/37] time 0.183 (0.183) data 0.106 (0.105) loss_u loss_u 0.9365 (0.9359) acc_u 6.2500 (7.6250) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [30/37] time 0.171 (0.182) data 0.093 (0.104) loss_u loss_u 0.9688 (0.9326) acc_u 3.1250 (8.0208) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [35/37] time 0.164 (0.181) data 0.085 (0.104) loss_u loss_u 0.9248 (0.9285) acc_u 9.3750 (8.4821) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 557
confident_label rate tensor(0.2569, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 411
clean true:333
clean false:78
clean_rate:0.8102189781021898
noisy true:710
noisy false:479
after delete: len(clean_dataset) 411
after delete: len(noisy_dataset) 1189
epoch [118/200] batch [5/12] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.4282 (0.5122) acc_x 90.6250 (86.2500) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [10/12] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.8853 (0.5369) acc_x 78.1250 (85.6250) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/37] time 0.191 (0.184) data 0.113 (0.107) loss_u loss_u 0.9146 (0.9097) acc_u 9.3750 (10.6250) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/37] time 0.168 (0.182) data 0.090 (0.105) loss_u loss_u 0.9590 (0.9371) acc_u 3.1250 (7.5000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/37] time 0.174 (0.181) data 0.098 (0.104) loss_u loss_u 0.8760 (0.9332) acc_u 15.6250 (7.9167) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/37] time 0.175 (0.181) data 0.098 (0.104) loss_u loss_u 0.9668 (0.9331) acc_u 6.2500 (8.1250) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [25/37] time 0.188 (0.181) data 0.111 (0.104) loss_u loss_u 0.9937 (0.9348) acc_u 0.0000 (7.7500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [30/37] time 0.162 (0.179) data 0.085 (0.102) loss_u loss_u 0.9795 (0.9346) acc_u 3.1250 (7.7083) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [35/37] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9868 (0.9334) acc_u 3.1250 (7.9464) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 590
confident_label rate tensor(0.2631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 421
clean true:330
clean false:91
clean_rate:0.7838479809976246
noisy true:680
noisy false:499
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1179
epoch [119/200] batch [5/13] time 0.180 (0.171) data 0.103 (0.094) loss_x loss_x 1.0557 (0.7885) acc_x 68.7500 (79.3750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/13] time 0.187 (0.178) data 0.110 (0.101) loss_x loss_x 0.4084 (0.5999) acc_x 90.6250 (85.3125) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/36] time 0.202 (0.184) data 0.125 (0.107) loss_u loss_u 0.8887 (0.9227) acc_u 15.6250 (9.3750) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [10/36] time 0.219 (0.192) data 0.141 (0.115) loss_u loss_u 0.9111 (0.9354) acc_u 12.5000 (8.4375) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/36] time 0.211 (0.196) data 0.133 (0.119) loss_u loss_u 0.9282 (0.9432) acc_u 9.3750 (7.2917) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [20/36] time 0.183 (0.196) data 0.106 (0.119) loss_u loss_u 0.8438 (0.9323) acc_u 15.6250 (8.2812) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [25/36] time 0.182 (0.194) data 0.105 (0.117) loss_u loss_u 0.8867 (0.9320) acc_u 12.5000 (8.2500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [30/36] time 0.175 (0.193) data 0.099 (0.116) loss_u loss_u 0.9937 (0.9338) acc_u 0.0000 (8.0208) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [35/36] time 0.160 (0.190) data 0.082 (0.113) loss_u loss_u 0.9648 (0.9391) acc_u 3.1250 (7.3214) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 597
confident_label rate tensor(0.2562, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 410
clean true:321
clean false:89
clean_rate:0.7829268292682927
noisy true:682
noisy false:508
after delete: len(clean_dataset) 410
after delete: len(noisy_dataset) 1190
epoch [120/200] batch [5/12] time 0.207 (0.188) data 0.130 (0.110) loss_x loss_x 0.5625 (0.4815) acc_x 81.2500 (86.8750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/12] time 0.182 (0.187) data 0.106 (0.110) loss_x loss_x 0.4622 (0.4646) acc_x 84.3750 (87.1875) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/37] time 0.188 (0.188) data 0.111 (0.111) loss_u loss_u 0.9761 (0.9398) acc_u 0.0000 (7.5000) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [10/37] time 0.180 (0.188) data 0.103 (0.110) loss_u loss_u 0.8447 (0.9264) acc_u 18.7500 (8.7500) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [15/37] time 0.186 (0.187) data 0.107 (0.110) loss_u loss_u 0.9443 (0.9283) acc_u 3.1250 (8.3333) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [20/37] time 0.182 (0.187) data 0.105 (0.109) loss_u loss_u 0.9487 (0.9323) acc_u 3.1250 (7.8125) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [25/37] time 0.189 (0.186) data 0.111 (0.109) loss_u loss_u 0.9419 (0.9392) acc_u 6.2500 (6.8750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [30/37] time 0.186 (0.186) data 0.108 (0.109) loss_u loss_u 0.8652 (0.9356) acc_u 15.6250 (7.2917) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [35/37] time 0.183 (0.186) data 0.106 (0.108) loss_u loss_u 0.8647 (0.9292) acc_u 15.6250 (8.1250) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 584
confident_label rate tensor(0.2662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 426
clean true:335
clean false:91
clean_rate:0.7863849765258216
noisy true:681
noisy false:493
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1174
epoch [121/200] batch [5/13] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.2135 (0.4559) acc_x 93.7500 (88.7500) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/13] time 0.186 (0.184) data 0.110 (0.107) loss_x loss_x 0.2859 (0.4525) acc_x 93.7500 (89.6875) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/36] time 0.189 (0.183) data 0.112 (0.106) loss_u loss_u 0.9165 (0.9210) acc_u 9.3750 (8.7500) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [10/36] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9478 (0.9381) acc_u 6.2500 (6.8750) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/36] time 0.162 (0.180) data 0.084 (0.103) loss_u loss_u 0.9575 (0.9402) acc_u 3.1250 (6.4583) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [20/36] time 0.166 (0.178) data 0.089 (0.101) loss_u loss_u 0.8784 (0.9324) acc_u 12.5000 (7.3438) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/36] time 0.160 (0.176) data 0.083 (0.099) loss_u loss_u 0.9985 (0.9379) acc_u 0.0000 (6.8750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [30/36] time 0.163 (0.175) data 0.085 (0.098) loss_u loss_u 0.9136 (0.9392) acc_u 9.3750 (6.7708) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [35/36] time 0.158 (0.174) data 0.080 (0.096) loss_u loss_u 0.9893 (0.9423) acc_u 3.1250 (6.5179) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 543
confident_label rate tensor(0.2581, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 413
clean true:330
clean false:83
clean_rate:0.7990314769975787
noisy true:727
noisy false:460
after delete: len(clean_dataset) 413
after delete: len(noisy_dataset) 1187
epoch [122/200] batch [5/12] time 0.177 (0.168) data 0.099 (0.090) loss_x loss_x 0.4248 (0.5156) acc_x 90.6250 (85.0000) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/12] time 0.178 (0.175) data 0.101 (0.098) loss_x loss_x 0.2515 (0.5299) acc_x 90.6250 (85.0000) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/37] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.9023 (0.9273) acc_u 12.5000 (8.1250) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [10/37] time 0.172 (0.176) data 0.094 (0.099) loss_u loss_u 0.9316 (0.9337) acc_u 9.3750 (7.5000) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/37] time 0.164 (0.175) data 0.086 (0.097) loss_u loss_u 0.9102 (0.9309) acc_u 9.3750 (7.7083) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/37] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.9463 (0.9290) acc_u 3.1250 (7.8125) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/37] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.9600 (0.9302) acc_u 6.2500 (7.7500) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [30/37] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.9424 (0.9278) acc_u 6.2500 (8.0208) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [35/37] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.9316 (0.9241) acc_u 6.2500 (8.3036) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 569
confident_label rate tensor(0.2706, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 433
clean true:333
clean false:100
clean_rate:0.76905311778291
noisy true:698
noisy false:469
after delete: len(clean_dataset) 433
after delete: len(noisy_dataset) 1167
epoch [123/200] batch [5/13] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.7744 (0.6066) acc_x 81.2500 (86.8750) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/13] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.9854 (0.6534) acc_x 78.1250 (84.0625) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/36] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.8999 (0.9089) acc_u 12.5000 (11.8750) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [10/36] time 0.167 (0.175) data 0.089 (0.097) loss_u loss_u 0.9722 (0.9271) acc_u 6.2500 (9.6875) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/36] time 0.169 (0.173) data 0.092 (0.096) loss_u loss_u 0.9419 (0.9338) acc_u 6.2500 (8.3333) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/36] time 0.184 (0.175) data 0.107 (0.097) loss_u loss_u 0.8833 (0.9273) acc_u 15.6250 (9.0625) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/36] time 0.180 (0.176) data 0.102 (0.098) loss_u loss_u 0.9561 (0.9310) acc_u 6.2500 (8.3750) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [30/36] time 0.174 (0.176) data 0.096 (0.098) loss_u loss_u 0.9688 (0.9310) acc_u 3.1250 (8.2292) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [35/36] time 0.167 (0.175) data 0.089 (0.098) loss_u loss_u 0.9883 (0.9354) acc_u 0.0000 (7.6786) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 561
confident_label rate tensor(0.2594, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 415
clean true:328
clean false:87
clean_rate:0.7903614457831325
noisy true:711
noisy false:474
after delete: len(clean_dataset) 415
after delete: len(noisy_dataset) 1185
epoch [124/200] batch [5/12] time 0.186 (0.187) data 0.110 (0.111) loss_x loss_x 0.3245 (0.4873) acc_x 93.7500 (88.1250) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/12] time 0.190 (0.187) data 0.113 (0.110) loss_x loss_x 0.8599 (0.5557) acc_x 81.2500 (85.9375) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/37] time 0.186 (0.186) data 0.107 (0.109) loss_u loss_u 0.9028 (0.9501) acc_u 9.3750 (5.6250) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/37] time 0.188 (0.186) data 0.109 (0.109) loss_u loss_u 0.9263 (0.9392) acc_u 9.3750 (6.5625) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [15/37] time 0.183 (0.186) data 0.106 (0.108) loss_u loss_u 0.9673 (0.9404) acc_u 3.1250 (6.4583) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [20/37] time 0.174 (0.185) data 0.096 (0.107) loss_u loss_u 0.9404 (0.9395) acc_u 6.2500 (6.5625) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [25/37] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.8887 (0.9355) acc_u 15.6250 (7.1250) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [30/37] time 0.169 (0.183) data 0.091 (0.105) loss_u loss_u 0.9688 (0.9376) acc_u 3.1250 (6.8750) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [35/37] time 0.182 (0.181) data 0.105 (0.103) loss_u loss_u 0.9556 (0.9345) acc_u 6.2500 (7.3214) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 616
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 405
clean true:318
clean false:87
clean_rate:0.7851851851851852
noisy true:666
noisy false:529
after delete: len(clean_dataset) 405
after delete: len(noisy_dataset) 1195
epoch [125/200] batch [5/12] time 0.177 (0.193) data 0.101 (0.116) loss_x loss_x 0.4026 (0.5213) acc_x 90.6250 (88.1250) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/12] time 0.171 (0.186) data 0.095 (0.109) loss_x loss_x 0.3403 (0.5406) acc_x 96.8750 (86.8750) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/37] time 0.189 (0.185) data 0.110 (0.108) loss_u loss_u 0.8481 (0.8956) acc_u 15.6250 (10.6250) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [10/37] time 0.189 (0.186) data 0.111 (0.109) loss_u loss_u 0.9062 (0.9013) acc_u 9.3750 (10.3125) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [15/37] time 0.195 (0.187) data 0.116 (0.109) loss_u loss_u 0.9116 (0.9072) acc_u 9.3750 (10.0000) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [20/37] time 0.179 (0.186) data 0.102 (0.109) loss_u loss_u 0.7705 (0.9074) acc_u 28.1250 (10.0000) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [25/37] time 0.175 (0.185) data 0.097 (0.108) loss_u loss_u 0.9556 (0.9133) acc_u 3.1250 (9.5000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [30/37] time 0.189 (0.185) data 0.112 (0.108) loss_u loss_u 0.9707 (0.9188) acc_u 3.1250 (8.8542) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [35/37] time 0.186 (0.185) data 0.109 (0.108) loss_u loss_u 0.9707 (0.9230) acc_u 6.2500 (8.5714) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 575
confident_label rate tensor(0.2650, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 424
clean true:332
clean false:92
clean_rate:0.7830188679245284
noisy true:693
noisy false:483
after delete: len(clean_dataset) 424
after delete: len(noisy_dataset) 1176
epoch [126/200] batch [5/13] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 0.3848 (0.4580) acc_x 90.6250 (85.6250) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/13] time 0.185 (0.187) data 0.107 (0.110) loss_x loss_x 0.4138 (0.5076) acc_x 93.7500 (86.5625) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/36] time 0.179 (0.187) data 0.102 (0.110) loss_u loss_u 0.8872 (0.9453) acc_u 12.5000 (5.6250) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/36] time 0.184 (0.186) data 0.106 (0.109) loss_u loss_u 0.9160 (0.9322) acc_u 9.3750 (7.8125) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/36] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.9600 (0.9332) acc_u 3.1250 (7.5000) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/36] time 0.171 (0.186) data 0.094 (0.109) loss_u loss_u 0.9316 (0.9391) acc_u 6.2500 (6.7188) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/36] time 0.179 (0.185) data 0.103 (0.108) loss_u loss_u 0.9790 (0.9309) acc_u 3.1250 (7.8750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [30/36] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.9150 (0.9352) acc_u 9.3750 (7.2917) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [35/36] time 0.169 (0.184) data 0.092 (0.106) loss_u loss_u 0.9155 (0.9359) acc_u 12.5000 (7.2321) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 551
confident_label rate tensor(0.2600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 416
clean true:330
clean false:86
clean_rate:0.7932692307692307
noisy true:719
noisy false:465
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 1184
epoch [127/200] batch [5/13] time 0.186 (0.188) data 0.109 (0.112) loss_x loss_x 0.3489 (0.5360) acc_x 90.6250 (86.2500) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/13] time 0.169 (0.184) data 0.092 (0.107) loss_x loss_x 0.5479 (0.5955) acc_x 81.2500 (86.2500) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/37] time 0.157 (0.179) data 0.080 (0.102) loss_u loss_u 0.8975 (0.9046) acc_u 12.5000 (11.8750) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [10/37] time 0.191 (0.177) data 0.114 (0.100) loss_u loss_u 0.8403 (0.9104) acc_u 18.7500 (10.6250) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/37] time 0.193 (0.179) data 0.115 (0.102) loss_u loss_u 0.9531 (0.9205) acc_u 3.1250 (9.1667) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/37] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.9644 (0.9184) acc_u 3.1250 (9.3750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [25/37] time 0.182 (0.178) data 0.105 (0.100) loss_u loss_u 0.9590 (0.9248) acc_u 6.2500 (8.7500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [30/37] time 0.198 (0.178) data 0.121 (0.101) loss_u loss_u 0.9355 (0.9313) acc_u 6.2500 (7.8125) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [35/37] time 0.185 (0.179) data 0.109 (0.101) loss_u loss_u 0.9219 (0.9290) acc_u 9.3750 (8.3036) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 590
confident_label rate tensor(0.2644, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 423
clean true:325
clean false:98
clean_rate:0.7683215130023641
noisy true:685
noisy false:492
after delete: len(clean_dataset) 423
after delete: len(noisy_dataset) 1177
epoch [128/200] batch [5/13] time 0.170 (0.184) data 0.094 (0.107) loss_x loss_x 0.5562 (0.5034) acc_x 84.3750 (87.5000) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/13] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.7251 (0.4939) acc_x 81.2500 (87.1875) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/36] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.9976 (0.9475) acc_u 0.0000 (5.6250) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [10/36] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9321 (0.9514) acc_u 6.2500 (5.3125) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/36] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.8228 (0.9359) acc_u 21.8750 (7.2917) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [20/36] time 0.181 (0.184) data 0.105 (0.106) loss_u loss_u 0.9556 (0.9394) acc_u 6.2500 (7.0312) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/36] time 0.157 (0.181) data 0.080 (0.104) loss_u loss_u 0.8589 (0.9367) acc_u 15.6250 (7.2500) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [30/36] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.9990 (0.9414) acc_u 0.0000 (6.6667) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [35/36] time 0.162 (0.179) data 0.084 (0.102) loss_u loss_u 0.9824 (0.9362) acc_u 0.0000 (7.3214) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 526
confident_label rate tensor(0.2625, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 420
clean true:336
clean false:84
clean_rate:0.8
noisy true:738
noisy false:442
after delete: len(clean_dataset) 420
after delete: len(noisy_dataset) 1180
epoch [129/200] batch [5/13] time 0.180 (0.180) data 0.104 (0.103) loss_x loss_x 0.3799 (0.6445) acc_x 93.7500 (81.8750) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/13] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.1857 (0.5749) acc_x 96.8750 (85.0000) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/36] time 0.160 (0.175) data 0.083 (0.099) loss_u loss_u 0.9395 (0.9597) acc_u 6.2500 (4.3750) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [10/36] time 0.179 (0.175) data 0.101 (0.098) loss_u loss_u 0.9790 (0.9514) acc_u 3.1250 (5.6250) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/36] time 0.164 (0.174) data 0.087 (0.097) loss_u loss_u 0.9248 (0.9339) acc_u 9.3750 (7.5000) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/36] time 0.199 (0.174) data 0.122 (0.097) loss_u loss_u 0.8804 (0.9227) acc_u 12.5000 (8.9062) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/36] time 0.179 (0.175) data 0.102 (0.098) loss_u loss_u 0.8906 (0.9250) acc_u 12.5000 (8.6250) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/36] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.9360 (0.9275) acc_u 6.2500 (8.2292) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [35/36] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.9829 (0.9312) acc_u 3.1250 (7.7679) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 550
confident_label rate tensor(0.2669, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 427
clean true:332
clean false:95
clean_rate:0.7775175644028103
noisy true:718
noisy false:455
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1173
epoch [130/200] batch [5/13] time 0.186 (0.188) data 0.110 (0.112) loss_x loss_x 0.4424 (0.5746) acc_x 87.5000 (86.8750) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/13] time 0.175 (0.186) data 0.098 (0.110) loss_x loss_x 0.5933 (0.6014) acc_x 87.5000 (85.9375) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/36] time 0.164 (0.181) data 0.087 (0.104) loss_u loss_u 0.9136 (0.9426) acc_u 9.3750 (7.5000) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [10/36] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.8730 (0.9266) acc_u 15.6250 (9.0625) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/36] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.9390 (0.9270) acc_u 6.2500 (8.5417) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/36] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9194 (0.9294) acc_u 9.3750 (8.2812) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/36] time 0.190 (0.181) data 0.113 (0.104) loss_u loss_u 0.9688 (0.9321) acc_u 3.1250 (8.0000) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [30/36] time 0.183 (0.181) data 0.107 (0.104) loss_u loss_u 0.8433 (0.9315) acc_u 15.6250 (8.0208) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [35/36] time 0.185 (0.181) data 0.109 (0.104) loss_u loss_u 0.9546 (0.9349) acc_u 3.1250 (7.5000) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 583
confident_label rate tensor(0.2619, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 419
clean true:327
clean false:92
clean_rate:0.7804295942720764
noisy true:690
noisy false:491
after delete: len(clean_dataset) 419
after delete: len(noisy_dataset) 1181
epoch [131/200] batch [5/13] time 0.187 (0.188) data 0.111 (0.111) loss_x loss_x 0.9810 (0.6078) acc_x 78.1250 (83.7500) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [10/13] time 0.186 (0.183) data 0.109 (0.107) loss_x loss_x 0.2930 (0.4573) acc_x 93.7500 (87.8125) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/36] time 0.172 (0.177) data 0.096 (0.100) loss_u loss_u 0.8730 (0.9376) acc_u 9.3750 (6.2500) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [10/36] time 0.176 (0.176) data 0.097 (0.099) loss_u loss_u 0.9141 (0.9299) acc_u 9.3750 (7.5000) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [15/36] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9170 (0.9224) acc_u 9.3750 (8.3333) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [20/36] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.9766 (0.9314) acc_u 3.1250 (7.8125) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/36] time 0.183 (0.179) data 0.106 (0.101) loss_u loss_u 0.9736 (0.9344) acc_u 3.1250 (7.6250) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [30/36] time 0.189 (0.180) data 0.111 (0.103) loss_u loss_u 0.8403 (0.9324) acc_u 15.6250 (7.8125) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [35/36] time 0.189 (0.181) data 0.112 (0.104) loss_u loss_u 0.9985 (0.9344) acc_u 0.0000 (7.5000) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 581
confident_label rate tensor(0.2675, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 428
clean true:328
clean false:100
clean_rate:0.7663551401869159
noisy true:691
noisy false:481
after delete: len(clean_dataset) 428
after delete: len(noisy_dataset) 1172
epoch [132/200] batch [5/13] time 0.191 (0.186) data 0.113 (0.109) loss_x loss_x 0.3203 (0.4543) acc_x 90.6250 (90.6250) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [10/13] time 0.187 (0.187) data 0.111 (0.111) loss_x loss_x 0.7080 (0.5227) acc_x 71.8750 (87.1875) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/36] time 0.170 (0.182) data 0.093 (0.106) loss_u loss_u 1.0000 (0.9403) acc_u 0.0000 (6.8750) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [10/36] time 0.179 (0.180) data 0.102 (0.104) loss_u loss_u 0.9521 (0.9356) acc_u 6.2500 (7.8125) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/36] time 0.163 (0.178) data 0.086 (0.102) loss_u loss_u 0.9663 (0.9355) acc_u 6.2500 (7.7083) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/36] time 0.188 (0.179) data 0.111 (0.102) loss_u loss_u 0.9639 (0.9376) acc_u 3.1250 (7.3438) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/36] time 0.195 (0.183) data 0.118 (0.107) loss_u loss_u 0.8789 (0.9342) acc_u 12.5000 (7.8750) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [30/36] time 0.169 (0.181) data 0.093 (0.105) loss_u loss_u 0.9258 (0.9374) acc_u 12.5000 (7.6042) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [35/36] time 0.162 (0.180) data 0.086 (0.103) loss_u loss_u 0.9790 (0.9364) acc_u 3.1250 (7.6786) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 554
confident_label rate tensor(0.2694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 431
clean true:338
clean false:93
clean_rate:0.7842227378190255
noisy true:708
noisy false:461
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1169
epoch [133/200] batch [5/13] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.2343 (0.3350) acc_x 96.8750 (95.0000) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/13] time 0.189 (0.187) data 0.113 (0.111) loss_x loss_x 0.4385 (0.3491) acc_x 84.3750 (93.4375) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/36] time 0.190 (0.185) data 0.114 (0.109) loss_u loss_u 0.9058 (0.9581) acc_u 12.5000 (5.0000) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [10/36] time 0.185 (0.186) data 0.109 (0.109) loss_u loss_u 0.9746 (0.9527) acc_u 6.2500 (5.3125) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/36] time 0.187 (0.186) data 0.110 (0.110) loss_u loss_u 0.8481 (0.9479) acc_u 15.6250 (5.8333) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [20/36] time 0.187 (0.186) data 0.109 (0.109) loss_u loss_u 0.8926 (0.9494) acc_u 12.5000 (5.6250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/36] time 0.190 (0.186) data 0.109 (0.109) loss_u loss_u 0.9824 (0.9473) acc_u 0.0000 (5.8750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [30/36] time 0.172 (0.185) data 0.095 (0.108) loss_u loss_u 0.9775 (0.9480) acc_u 3.1250 (5.8333) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [35/36] time 0.171 (0.183) data 0.094 (0.106) loss_u loss_u 0.9692 (0.9463) acc_u 3.1250 (6.1607) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 575
confident_label rate tensor(0.2681, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 429
clean true:329
clean false:100
clean_rate:0.7668997668997669
noisy true:696
noisy false:475
after delete: len(clean_dataset) 429
after delete: len(noisy_dataset) 1171
epoch [134/200] batch [5/13] time 0.173 (0.181) data 0.095 (0.104) loss_x loss_x 0.7095 (0.6098) acc_x 81.2500 (87.5000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/13] time 0.177 (0.183) data 0.099 (0.106) loss_x loss_x 0.6401 (0.5865) acc_x 87.5000 (87.1875) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/36] time 0.190 (0.184) data 0.112 (0.107) loss_u loss_u 0.9360 (0.9263) acc_u 6.2500 (7.5000) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [10/36] time 0.167 (0.184) data 0.089 (0.107) loss_u loss_u 0.9253 (0.9247) acc_u 6.2500 (8.4375) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/36] time 0.165 (0.181) data 0.086 (0.103) loss_u loss_u 0.9741 (0.9399) acc_u 6.2500 (7.0833) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/36] time 0.164 (0.178) data 0.086 (0.101) loss_u loss_u 0.9351 (0.9366) acc_u 6.2500 (7.1875) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/36] time 0.170 (0.177) data 0.092 (0.099) loss_u loss_u 0.9692 (0.9353) acc_u 3.1250 (7.3750) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/36] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.9775 (0.9366) acc_u 0.0000 (7.0833) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [35/36] time 0.178 (0.177) data 0.101 (0.099) loss_u loss_u 0.9341 (0.9343) acc_u 6.2500 (7.3214) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 571
confident_label rate tensor(0.2712, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 434
clean true:340
clean false:94
clean_rate:0.783410138248848
noisy true:689
noisy false:477
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1166
epoch [135/200] batch [5/13] time 0.184 (0.187) data 0.108 (0.110) loss_x loss_x 0.8633 (0.5376) acc_x 87.5000 (89.3750) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/13] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.8140 (0.5436) acc_x 78.1250 (86.8750) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/36] time 0.189 (0.186) data 0.111 (0.109) loss_u loss_u 0.9697 (0.9418) acc_u 3.1250 (6.2500) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/36] time 0.165 (0.184) data 0.088 (0.107) loss_u loss_u 0.7539 (0.9101) acc_u 25.0000 (9.3750) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/36] time 0.169 (0.182) data 0.091 (0.105) loss_u loss_u 0.9155 (0.9211) acc_u 9.3750 (8.5417) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/36] time 0.168 (0.180) data 0.091 (0.103) loss_u loss_u 0.9683 (0.9333) acc_u 3.1250 (7.1875) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/36] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.8960 (0.9342) acc_u 12.5000 (7.3750) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/36] time 0.183 (0.180) data 0.106 (0.102) loss_u loss_u 0.9604 (0.9362) acc_u 3.1250 (7.0833) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [35/36] time 0.183 (0.180) data 0.105 (0.103) loss_u loss_u 0.9238 (0.9346) acc_u 9.3750 (7.3214) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 557
confident_label rate tensor(0.2769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 443
clean true:343
clean false:100
clean_rate:0.7742663656884876
noisy true:700
noisy false:457
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1157
epoch [136/200] batch [5/13] time 0.159 (0.180) data 0.082 (0.103) loss_x loss_x 0.5435 (0.5470) acc_x 84.3750 (83.7500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/13] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.4846 (0.4815) acc_x 93.7500 (87.5000) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/36] time 0.184 (0.172) data 0.108 (0.095) loss_u loss_u 0.9277 (0.9479) acc_u 9.3750 (6.8750) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [10/36] time 0.170 (0.171) data 0.093 (0.094) loss_u loss_u 0.9712 (0.9362) acc_u 3.1250 (7.8125) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/36] time 0.186 (0.174) data 0.109 (0.097) loss_u loss_u 0.9219 (0.9429) acc_u 9.3750 (7.0833) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [20/36] time 0.180 (0.175) data 0.103 (0.098) loss_u loss_u 0.9683 (0.9469) acc_u 3.1250 (6.7188) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/36] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.9502 (0.9448) acc_u 6.2500 (6.7500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [30/36] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.9243 (0.9408) acc_u 6.2500 (6.9792) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [35/36] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.9644 (0.9404) acc_u 3.1250 (6.9643) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 603
confident_label rate tensor(0.2694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 431
clean true:332
clean false:99
clean_rate:0.7703016241299304
noisy true:665
noisy false:504
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1169
epoch [137/200] batch [5/13] time 0.180 (0.186) data 0.103 (0.110) loss_x loss_x 0.7847 (0.4514) acc_x 78.1250 (86.2500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/13] time 0.177 (0.184) data 0.100 (0.107) loss_x loss_x 0.5815 (0.4459) acc_x 78.1250 (86.5625) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/36] time 0.168 (0.182) data 0.089 (0.106) loss_u loss_u 0.9424 (0.9495) acc_u 9.3750 (7.5000) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/36] time 0.167 (0.181) data 0.090 (0.105) loss_u loss_u 0.8936 (0.9249) acc_u 12.5000 (9.3750) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/36] time 0.161 (0.178) data 0.084 (0.102) loss_u loss_u 0.9805 (0.9370) acc_u 0.0000 (7.7083) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/36] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.9175 (0.9363) acc_u 9.3750 (7.6562) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/36] time 0.173 (0.179) data 0.097 (0.102) loss_u loss_u 0.9707 (0.9390) acc_u 3.1250 (7.2500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [30/36] time 0.169 (0.178) data 0.091 (0.101) loss_u loss_u 0.9546 (0.9406) acc_u 6.2500 (7.0833) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [35/36] time 0.202 (0.180) data 0.125 (0.103) loss_u loss_u 0.9438 (0.9336) acc_u 6.2500 (7.7679) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 598
confident_label rate tensor(0.2712, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 434
clean true:337
clean false:97
clean_rate:0.7764976958525346
noisy true:665
noisy false:501
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1166
epoch [138/200] batch [5/13] time 0.161 (0.180) data 0.083 (0.103) loss_x loss_x 0.7305 (0.6028) acc_x 81.2500 (85.6250) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/13] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.8755 (0.6365) acc_x 81.2500 (84.0625) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/36] time 0.174 (0.176) data 0.097 (0.099) loss_u loss_u 0.9644 (0.9454) acc_u 3.1250 (6.2500) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [10/36] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.9531 (0.9390) acc_u 6.2500 (7.8125) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/36] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.9648 (0.9419) acc_u 6.2500 (7.2917) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/36] time 0.162 (0.174) data 0.085 (0.097) loss_u loss_u 0.9507 (0.9420) acc_u 6.2500 (7.1875) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/36] time 0.165 (0.175) data 0.088 (0.098) loss_u loss_u 0.9741 (0.9407) acc_u 3.1250 (7.1250) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/36] time 0.163 (0.175) data 0.085 (0.098) loss_u loss_u 0.9600 (0.9378) acc_u 3.1250 (7.3958) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [35/36] time 0.170 (0.175) data 0.092 (0.098) loss_u loss_u 0.9453 (0.9406) acc_u 9.3750 (7.0536) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 558
confident_label rate tensor(0.2738, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 438
clean true:345
clean false:93
clean_rate:0.7876712328767124
noisy true:697
noisy false:465
after delete: len(clean_dataset) 438
after delete: len(noisy_dataset) 1162
epoch [139/200] batch [5/13] time 0.163 (0.167) data 0.087 (0.090) loss_x loss_x 0.4326 (0.5544) acc_x 87.5000 (83.1250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/13] time 0.186 (0.173) data 0.109 (0.096) loss_x loss_x 0.5547 (0.5318) acc_x 84.3750 (85.0000) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/36] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.9639 (0.9301) acc_u 3.1250 (8.1250) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [10/36] time 0.168 (0.175) data 0.091 (0.097) loss_u loss_u 0.9365 (0.9262) acc_u 9.3750 (9.0625) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/36] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.9658 (0.9411) acc_u 3.1250 (7.0833) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [20/36] time 0.179 (0.175) data 0.103 (0.098) loss_u loss_u 0.9136 (0.9412) acc_u 9.3750 (6.7188) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/36] time 0.166 (0.174) data 0.089 (0.097) loss_u loss_u 0.9458 (0.9382) acc_u 9.3750 (7.3750) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [30/36] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.8833 (0.9371) acc_u 12.5000 (7.3958) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [35/36] time 0.168 (0.174) data 0.091 (0.097) loss_u loss_u 0.9624 (0.9378) acc_u 3.1250 (7.2321) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 548
confident_label rate tensor(0.2712, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 434
clean true:344
clean false:90
clean_rate:0.7926267281105991
noisy true:708
noisy false:458
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1166
epoch [140/200] batch [5/13] time 0.185 (0.172) data 0.108 (0.094) loss_x loss_x 0.4385 (0.5224) acc_x 90.6250 (87.5000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [10/13] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.2993 (0.4782) acc_x 93.7500 (88.1250) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/36] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.9185 (0.9340) acc_u 9.3750 (7.5000) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/36] time 0.195 (0.179) data 0.119 (0.102) loss_u loss_u 0.9253 (0.9434) acc_u 6.2500 (5.6250) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/36] time 0.189 (0.180) data 0.111 (0.103) loss_u loss_u 0.9077 (0.9386) acc_u 9.3750 (6.0417) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/36] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9941 (0.9340) acc_u 0.0000 (6.5625) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/36] time 0.185 (0.182) data 0.109 (0.105) loss_u loss_u 0.8848 (0.9294) acc_u 12.5000 (7.3750) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [30/36] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.9014 (0.9293) acc_u 12.5000 (7.5000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [35/36] time 0.186 (0.182) data 0.110 (0.105) loss_u loss_u 0.9546 (0.9321) acc_u 6.2500 (7.3214) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 573
confident_label rate tensor(0.2675, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 428
clean true:333
clean false:95
clean_rate:0.7780373831775701
noisy true:694
noisy false:478
after delete: len(clean_dataset) 428
after delete: len(noisy_dataset) 1172
epoch [141/200] batch [5/13] time 0.172 (0.182) data 0.096 (0.105) loss_x loss_x 0.3242 (0.4497) acc_x 87.5000 (90.0000) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/13] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.5283 (0.4612) acc_x 84.3750 (89.6875) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/36] time 0.175 (0.179) data 0.098 (0.101) loss_u loss_u 0.9785 (0.9190) acc_u 3.1250 (8.7500) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [10/36] time 0.167 (0.177) data 0.089 (0.100) loss_u loss_u 0.9678 (0.9178) acc_u 3.1250 (9.3750) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/36] time 0.177 (0.177) data 0.099 (0.099) loss_u loss_u 0.9419 (0.9259) acc_u 6.2500 (8.5417) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/36] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.9814 (0.9305) acc_u 3.1250 (7.9688) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/36] time 0.163 (0.176) data 0.086 (0.099) loss_u loss_u 0.9492 (0.9290) acc_u 6.2500 (8.2500) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/36] time 0.175 (0.176) data 0.097 (0.098) loss_u loss_u 0.9438 (0.9305) acc_u 6.2500 (7.9167) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [35/36] time 0.176 (0.175) data 0.097 (0.098) loss_u loss_u 0.8892 (0.9318) acc_u 15.6250 (7.8571) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 572
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 450
clean true:342
clean false:108
clean_rate:0.76
noisy true:686
noisy false:464
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1150
epoch [142/200] batch [5/14] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.3647 (0.6026) acc_x 93.7500 (81.8750) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/14] time 0.172 (0.174) data 0.096 (0.097) loss_x loss_x 0.4985 (0.5738) acc_x 90.6250 (84.6875) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/35] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.8789 (0.9214) acc_u 12.5000 (8.7500) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/35] time 0.162 (0.174) data 0.085 (0.097) loss_u loss_u 0.9702 (0.9382) acc_u 3.1250 (6.8750) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/35] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.8760 (0.9363) acc_u 12.5000 (7.0833) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/35] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.9883 (0.9388) acc_u 3.1250 (6.8750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/35] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.9917 (0.9483) acc_u 3.1250 (5.8750) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [30/35] time 0.180 (0.176) data 0.103 (0.098) loss_u loss_u 0.9521 (0.9453) acc_u 3.1250 (6.1458) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [35/35] time 0.183 (0.177) data 0.106 (0.099) loss_u loss_u 0.9556 (0.9441) acc_u 3.1250 (6.1607) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 591
confident_label rate tensor(0.2694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 431
clean true:332
clean false:99
clean_rate:0.7703016241299304
noisy true:677
noisy false:492
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1169
epoch [143/200] batch [5/13] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.5693 (0.5872) acc_x 87.5000 (83.1250) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/13] time 0.173 (0.176) data 0.095 (0.099) loss_x loss_x 0.5674 (0.5373) acc_x 84.3750 (85.6250) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/36] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.9785 (0.9688) acc_u 3.1250 (4.3750) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [10/36] time 0.162 (0.175) data 0.084 (0.098) loss_u loss_u 0.9575 (0.9474) acc_u 6.2500 (5.9375) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/36] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.9648 (0.9416) acc_u 3.1250 (6.6667) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/36] time 0.166 (0.173) data 0.087 (0.096) loss_u loss_u 0.9497 (0.9441) acc_u 6.2500 (6.4062) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/36] time 0.191 (0.174) data 0.113 (0.097) loss_u loss_u 0.9927 (0.9400) acc_u 0.0000 (6.7500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/36] time 0.161 (0.174) data 0.084 (0.096) loss_u loss_u 0.9746 (0.9412) acc_u 3.1250 (6.7708) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [35/36] time 0.184 (0.174) data 0.107 (0.097) loss_u loss_u 0.8887 (0.9387) acc_u 12.5000 (7.1429) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 576
confident_label rate tensor(0.2650, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 424
clean true:324
clean false:100
clean_rate:0.7641509433962265
noisy true:700
noisy false:476
after delete: len(clean_dataset) 424
after delete: len(noisy_dataset) 1176
epoch [144/200] batch [5/13] time 0.187 (0.186) data 0.111 (0.110) loss_x loss_x 0.4456 (0.6287) acc_x 90.6250 (86.2500) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/13] time 0.188 (0.185) data 0.112 (0.109) loss_x loss_x 0.5244 (0.5562) acc_x 87.5000 (86.8750) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/36] time 0.174 (0.180) data 0.095 (0.103) loss_u loss_u 0.8896 (0.9221) acc_u 12.5000 (10.6250) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [10/36] time 0.157 (0.178) data 0.080 (0.101) loss_u loss_u 0.8745 (0.9178) acc_u 15.6250 (10.9375) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [15/36] time 0.177 (0.176) data 0.100 (0.099) loss_u loss_u 0.9341 (0.9316) acc_u 6.2500 (8.9583) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/36] time 0.200 (0.177) data 0.121 (0.100) loss_u loss_u 0.9341 (0.9304) acc_u 6.2500 (8.5938) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/36] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.9727 (0.9302) acc_u 3.1250 (8.6250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/36] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.9072 (0.9297) acc_u 9.3750 (8.4375) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [35/36] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.9639 (0.9312) acc_u 3.1250 (8.1250) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 591
confident_label rate tensor(0.2669, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 427
clean true:326
clean false:101
clean_rate:0.7634660421545667
noisy true:683
noisy false:490
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1173
epoch [145/200] batch [5/13] time 0.184 (0.199) data 0.108 (0.122) loss_x loss_x 0.1837 (0.4191) acc_x 93.7500 (90.6250) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/13] time 0.184 (0.193) data 0.108 (0.117) loss_x loss_x 0.6772 (0.4630) acc_x 81.2500 (87.8125) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/36] time 0.191 (0.190) data 0.114 (0.113) loss_u loss_u 0.9561 (0.9248) acc_u 3.1250 (9.3750) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [10/36] time 0.187 (0.189) data 0.109 (0.112) loss_u loss_u 0.9756 (0.9417) acc_u 3.1250 (7.1875) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/36] time 0.188 (0.187) data 0.109 (0.110) loss_u loss_u 0.9941 (0.9415) acc_u 0.0000 (7.2917) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [20/36] time 0.180 (0.186) data 0.103 (0.109) loss_u loss_u 0.9683 (0.9385) acc_u 3.1250 (7.6562) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/36] time 0.185 (0.186) data 0.107 (0.109) loss_u loss_u 0.9468 (0.9352) acc_u 6.2500 (7.7500) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [30/36] time 0.185 (0.186) data 0.107 (0.108) loss_u loss_u 0.8701 (0.9314) acc_u 15.6250 (8.2292) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [35/36] time 0.161 (0.186) data 0.082 (0.109) loss_u loss_u 0.9521 (0.9337) acc_u 6.2500 (7.9464) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 576
confident_label rate tensor(0.2644, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 423
clean true:330
clean false:93
clean_rate:0.7801418439716312
noisy true:694
noisy false:483
after delete: len(clean_dataset) 423
after delete: len(noisy_dataset) 1177
epoch [146/200] batch [5/13] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.3491 (0.3958) acc_x 90.6250 (88.7500) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/13] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.6377 (0.4496) acc_x 87.5000 (88.4375) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/36] time 0.174 (0.179) data 0.097 (0.103) loss_u loss_u 0.9619 (0.9491) acc_u 3.1250 (5.6250) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [10/36] time 0.176 (0.180) data 0.098 (0.103) loss_u loss_u 0.9521 (0.9455) acc_u 3.1250 (6.2500) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/36] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.8760 (0.9405) acc_u 12.5000 (6.6667) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/36] time 0.165 (0.178) data 0.089 (0.101) loss_u loss_u 0.9453 (0.9456) acc_u 6.2500 (6.5625) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/36] time 0.160 (0.178) data 0.082 (0.101) loss_u loss_u 0.9282 (0.9371) acc_u 9.3750 (7.5000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [30/36] time 0.188 (0.178) data 0.111 (0.100) loss_u loss_u 0.8975 (0.9320) acc_u 12.5000 (8.1250) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [35/36] time 0.173 (0.177) data 0.095 (0.100) loss_u loss_u 0.9146 (0.9295) acc_u 9.3750 (8.2143) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 560
confident_label rate tensor(0.2744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 439
clean true:344
clean false:95
clean_rate:0.7835990888382688
noisy true:696
noisy false:465
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1161
epoch [147/200] batch [5/13] time 0.166 (0.177) data 0.090 (0.100) loss_x loss_x 0.9692 (0.5645) acc_x 81.2500 (86.8750) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/13] time 0.170 (0.174) data 0.094 (0.097) loss_x loss_x 0.2622 (0.5367) acc_x 90.6250 (85.9375) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/36] time 0.186 (0.176) data 0.109 (0.100) loss_u loss_u 0.9717 (0.9272) acc_u 3.1250 (8.1250) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [10/36] time 0.181 (0.175) data 0.103 (0.098) loss_u loss_u 0.9658 (0.9345) acc_u 3.1250 (7.8125) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/36] time 0.167 (0.173) data 0.089 (0.096) loss_u loss_u 0.9585 (0.9355) acc_u 3.1250 (7.7083) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/36] time 0.165 (0.174) data 0.088 (0.097) loss_u loss_u 0.9360 (0.9350) acc_u 6.2500 (7.6562) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/36] time 0.167 (0.173) data 0.088 (0.096) loss_u loss_u 0.9409 (0.9361) acc_u 6.2500 (7.2500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [30/36] time 0.187 (0.173) data 0.108 (0.096) loss_u loss_u 0.9980 (0.9316) acc_u 0.0000 (7.7083) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [35/36] time 0.162 (0.173) data 0.085 (0.096) loss_u loss_u 0.8989 (0.9321) acc_u 9.3750 (7.7679) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 564
confident_label rate tensor(0.2763, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 442
clean true:336
clean false:106
clean_rate:0.7601809954751131
noisy true:700
noisy false:458
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 1158
epoch [148/200] batch [5/13] time 0.181 (0.188) data 0.104 (0.111) loss_x loss_x 0.5493 (0.5811) acc_x 87.5000 (88.1250) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/13] time 0.190 (0.184) data 0.114 (0.107) loss_x loss_x 0.7524 (0.5338) acc_x 84.3750 (87.1875) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/36] time 0.170 (0.181) data 0.091 (0.104) loss_u loss_u 0.9497 (0.9085) acc_u 6.2500 (11.2500) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [10/36] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.9565 (0.9335) acc_u 3.1250 (7.8125) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/36] time 0.205 (0.181) data 0.127 (0.103) loss_u loss_u 0.9551 (0.9394) acc_u 9.3750 (7.5000) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/36] time 0.174 (0.180) data 0.096 (0.103) loss_u loss_u 0.9541 (0.9375) acc_u 3.1250 (7.6562) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/36] time 0.166 (0.182) data 0.088 (0.104) loss_u loss_u 0.9233 (0.9383) acc_u 9.3750 (7.6250) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [30/36] time 0.162 (0.180) data 0.085 (0.102) loss_u loss_u 0.8843 (0.9362) acc_u 12.5000 (7.9167) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [35/36] time 0.199 (0.182) data 0.123 (0.104) loss_u loss_u 0.9062 (0.9343) acc_u 9.3750 (8.1250) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 589
confident_label rate tensor(0.2744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 439
clean true:331
clean false:108
clean_rate:0.7539863325740319
noisy true:680
noisy false:481
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1161
epoch [149/200] batch [5/13] time 0.183 (0.189) data 0.106 (0.111) loss_x loss_x 0.5659 (0.5090) acc_x 81.2500 (86.2500) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/13] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.4109 (0.4650) acc_x 90.6250 (87.8125) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/36] time 0.185 (0.186) data 0.108 (0.109) loss_u loss_u 0.9292 (0.9268) acc_u 9.3750 (8.1250) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [10/36] time 0.185 (0.186) data 0.108 (0.109) loss_u loss_u 0.8828 (0.9314) acc_u 15.6250 (8.1250) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/36] time 0.180 (0.185) data 0.102 (0.108) loss_u loss_u 0.9683 (0.9380) acc_u 3.1250 (7.2917) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/36] time 0.191 (0.185) data 0.114 (0.107) loss_u loss_u 0.9683 (0.9377) acc_u 3.1250 (7.1875) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/36] time 0.184 (0.185) data 0.105 (0.107) loss_u loss_u 0.9507 (0.9375) acc_u 6.2500 (7.3750) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [30/36] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9194 (0.9377) acc_u 9.3750 (7.3958) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [35/36] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9570 (0.9390) acc_u 6.2500 (7.3214) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 562
confident_label rate tensor(0.2731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 437
clean true:336
clean false:101
clean_rate:0.7688787185354691
noisy true:702
noisy false:461
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1163
epoch [150/200] batch [5/13] time 0.165 (0.176) data 0.087 (0.099) loss_x loss_x 0.7915 (0.6178) acc_x 81.2500 (82.5000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/13] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.6313 (0.5636) acc_x 87.5000 (86.2500) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/36] time 0.172 (0.174) data 0.095 (0.097) loss_u loss_u 0.8877 (0.9360) acc_u 12.5000 (7.5000) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [10/36] time 0.180 (0.173) data 0.103 (0.095) loss_u loss_u 0.8247 (0.9293) acc_u 18.7500 (8.1250) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/36] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.9014 (0.9272) acc_u 12.5000 (8.3333) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/36] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9937 (0.9298) acc_u 0.0000 (8.4375) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/36] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.9092 (0.9339) acc_u 12.5000 (8.0000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [30/36] time 0.187 (0.178) data 0.110 (0.101) loss_u loss_u 0.9424 (0.9329) acc_u 6.2500 (8.0208) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [35/36] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.9175 (0.9312) acc_u 9.3750 (8.1250) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 572
confident_label rate tensor(0.2788, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 446
clean true:345
clean false:101
clean_rate:0.773542600896861
noisy true:683
noisy false:471
after delete: len(clean_dataset) 446
after delete: len(noisy_dataset) 1154
epoch [151/200] batch [5/13] time 0.186 (0.169) data 0.109 (0.092) loss_x loss_x 0.5840 (0.5299) acc_x 78.1250 (84.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/13] time 0.181 (0.176) data 0.105 (0.099) loss_x loss_x 0.4548 (0.4887) acc_x 90.6250 (87.1875) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/36] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9468 (0.9462) acc_u 6.2500 (6.8750) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [10/36] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.9131 (0.9387) acc_u 9.3750 (7.1875) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/36] time 0.173 (0.180) data 0.096 (0.103) loss_u loss_u 0.8813 (0.9421) acc_u 12.5000 (6.8750) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/36] time 0.173 (0.179) data 0.097 (0.102) loss_u loss_u 0.9683 (0.9402) acc_u 3.1250 (7.0312) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/36] time 0.191 (0.178) data 0.113 (0.101) loss_u loss_u 0.9331 (0.9398) acc_u 12.5000 (7.2500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [30/36] time 0.177 (0.178) data 0.098 (0.101) loss_u loss_u 0.9478 (0.9399) acc_u 6.2500 (7.1875) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [35/36] time 0.162 (0.177) data 0.085 (0.100) loss_u loss_u 0.9346 (0.9394) acc_u 6.2500 (7.0536) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 565
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 450
clean true:342
clean false:108
clean_rate:0.76
noisy true:693
noisy false:457
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1150
epoch [152/200] batch [5/14] time 0.190 (0.190) data 0.113 (0.113) loss_x loss_x 0.3401 (0.5375) acc_x 90.6250 (84.3750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/14] time 0.172 (0.188) data 0.095 (0.111) loss_x loss_x 0.6582 (0.5060) acc_x 78.1250 (85.6250) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/35] time 0.175 (0.181) data 0.098 (0.104) loss_u loss_u 0.9263 (0.9264) acc_u 9.3750 (8.7500) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [10/35] time 0.195 (0.182) data 0.116 (0.105) loss_u loss_u 0.9414 (0.9294) acc_u 6.2500 (7.8125) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/35] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.8740 (0.9232) acc_u 15.6250 (8.7500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [20/35] time 0.178 (0.182) data 0.101 (0.105) loss_u loss_u 0.9927 (0.9328) acc_u 0.0000 (7.5000) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/35] time 0.168 (0.181) data 0.091 (0.103) loss_u loss_u 0.9873 (0.9361) acc_u 3.1250 (7.3750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [30/35] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.9844 (0.9386) acc_u 0.0000 (6.9792) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [35/35] time 0.193 (0.181) data 0.116 (0.103) loss_u loss_u 0.9941 (0.9394) acc_u 0.0000 (6.8750) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 587
confident_label rate tensor(0.2725, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 436
clean true:337
clean false:99
clean_rate:0.7729357798165137
noisy true:676
noisy false:488
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1164
epoch [153/200] batch [5/13] time 0.173 (0.168) data 0.096 (0.091) loss_x loss_x 0.5127 (0.5757) acc_x 87.5000 (85.0000) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/13] time 0.165 (0.167) data 0.087 (0.090) loss_x loss_x 0.9897 (0.5519) acc_x 78.1250 (86.2500) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/36] time 0.168 (0.168) data 0.091 (0.091) loss_u loss_u 0.9487 (0.9372) acc_u 6.2500 (6.8750) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [10/36] time 0.178 (0.170) data 0.101 (0.093) loss_u loss_u 0.9023 (0.9308) acc_u 9.3750 (7.8125) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/36] time 0.186 (0.172) data 0.109 (0.094) loss_u loss_u 0.9844 (0.9416) acc_u 6.2500 (6.6667) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/36] time 0.172 (0.172) data 0.093 (0.095) loss_u loss_u 0.8853 (0.9359) acc_u 12.5000 (7.1875) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/36] time 0.161 (0.172) data 0.083 (0.094) loss_u loss_u 0.9692 (0.9304) acc_u 3.1250 (7.8750) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [30/36] time 0.170 (0.171) data 0.093 (0.094) loss_u loss_u 0.9644 (0.9332) acc_u 3.1250 (7.5000) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [35/36] time 0.176 (0.171) data 0.099 (0.094) loss_u loss_u 0.9312 (0.9356) acc_u 9.3750 (7.3214) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 562
confident_label rate tensor(0.2769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 443
clean true:346
clean false:97
clean_rate:0.781038374717833
noisy true:692
noisy false:465
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1157
epoch [154/200] batch [5/13] time 0.169 (0.164) data 0.091 (0.087) loss_x loss_x 0.4070 (0.3748) acc_x 90.6250 (90.6250) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/13] time 0.170 (0.167) data 0.093 (0.090) loss_x loss_x 0.6108 (0.5306) acc_x 81.2500 (85.0000) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/36] time 0.176 (0.173) data 0.098 (0.096) loss_u loss_u 0.9712 (0.9632) acc_u 6.2500 (3.7500) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [10/36] time 0.179 (0.173) data 0.101 (0.095) loss_u loss_u 0.9194 (0.9399) acc_u 9.3750 (7.1875) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/36] time 0.210 (0.179) data 0.132 (0.102) loss_u loss_u 0.9790 (0.9436) acc_u 3.1250 (6.6667) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/36] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9917 (0.9408) acc_u 0.0000 (6.8750) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/36] time 0.171 (0.181) data 0.093 (0.103) loss_u loss_u 0.9473 (0.9372) acc_u 6.2500 (7.2500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/36] time 0.168 (0.180) data 0.089 (0.102) loss_u loss_u 0.8623 (0.9374) acc_u 15.6250 (7.1875) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [35/36] time 0.179 (0.179) data 0.102 (0.101) loss_u loss_u 0.9414 (0.9368) acc_u 6.2500 (7.2321) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 569
confident_label rate tensor(0.2662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 426
clean true:330
clean false:96
clean_rate:0.7746478873239436
noisy true:701
noisy false:473
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1174
epoch [155/200] batch [5/13] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.3792 (0.4997) acc_x 90.6250 (85.6250) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/13] time 0.172 (0.178) data 0.095 (0.101) loss_x loss_x 0.1667 (0.4643) acc_x 96.8750 (86.2500) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/36] time 0.163 (0.173) data 0.085 (0.096) loss_u loss_u 0.9951 (0.9211) acc_u 0.0000 (8.1250) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [10/36] time 0.169 (0.171) data 0.092 (0.094) loss_u loss_u 0.9194 (0.9201) acc_u 9.3750 (8.7500) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/36] time 0.160 (0.170) data 0.083 (0.093) loss_u loss_u 0.9365 (0.9271) acc_u 6.2500 (7.9167) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/36] time 0.163 (0.170) data 0.086 (0.092) loss_u loss_u 0.9258 (0.9318) acc_u 6.2500 (7.6562) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/36] time 0.163 (0.169) data 0.086 (0.092) loss_u loss_u 0.9067 (0.9336) acc_u 9.3750 (7.3750) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [30/36] time 0.191 (0.170) data 0.115 (0.093) loss_u loss_u 0.9497 (0.9294) acc_u 6.2500 (7.7083) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [35/36] time 0.185 (0.172) data 0.109 (0.094) loss_u loss_u 0.8760 (0.9236) acc_u 12.5000 (8.4821) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 560
confident_label rate tensor(0.2781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 445
clean true:344
clean false:101
clean_rate:0.7730337078651686
noisy true:696
noisy false:459
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1155
epoch [156/200] batch [5/13] time 0.180 (0.179) data 0.104 (0.101) loss_x loss_x 0.1779 (0.3854) acc_x 96.8750 (91.2500) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/13] time 0.174 (0.180) data 0.097 (0.103) loss_x loss_x 0.8203 (0.5048) acc_x 84.3750 (89.6875) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/36] time 0.165 (0.175) data 0.088 (0.097) loss_u loss_u 0.9482 (0.9356) acc_u 6.2500 (6.8750) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/36] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.9116 (0.9420) acc_u 9.3750 (6.5625) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/36] time 0.167 (0.172) data 0.089 (0.095) loss_u loss_u 0.9258 (0.9361) acc_u 9.3750 (7.0833) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/36] time 0.175 (0.171) data 0.098 (0.094) loss_u loss_u 0.9194 (0.9401) acc_u 9.3750 (6.8750) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/36] time 0.176 (0.171) data 0.098 (0.094) loss_u loss_u 0.9502 (0.9373) acc_u 6.2500 (7.0000) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [30/36] time 0.172 (0.172) data 0.094 (0.095) loss_u loss_u 0.9565 (0.9330) acc_u 3.1250 (7.3958) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [35/36] time 0.173 (0.172) data 0.096 (0.095) loss_u loss_u 0.9409 (0.9326) acc_u 6.2500 (7.5893) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 607
confident_label rate tensor(0.2794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 447
clean true:343
clean false:104
clean_rate:0.767337807606264
noisy true:650
noisy false:503
after delete: len(clean_dataset) 447
after delete: len(noisy_dataset) 1153
epoch [157/200] batch [5/13] time 0.164 (0.173) data 0.088 (0.096) loss_x loss_x 1.1035 (0.7558) acc_x 75.0000 (83.1250) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/13] time 0.171 (0.170) data 0.094 (0.094) loss_x loss_x 0.6787 (0.6493) acc_x 81.2500 (85.0000) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/36] time 0.167 (0.170) data 0.090 (0.093) loss_u loss_u 0.9688 (0.9543) acc_u 3.1250 (5.6250) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/36] time 0.188 (0.169) data 0.111 (0.092) loss_u loss_u 0.9253 (0.9464) acc_u 9.3750 (6.5625) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/36] time 0.181 (0.172) data 0.104 (0.095) loss_u loss_u 0.9336 (0.9454) acc_u 9.3750 (6.6667) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/36] time 0.173 (0.172) data 0.095 (0.096) loss_u loss_u 0.9697 (0.9435) acc_u 3.1250 (6.7188) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/36] time 0.183 (0.172) data 0.106 (0.096) loss_u loss_u 0.9316 (0.9382) acc_u 9.3750 (7.3750) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/36] time 0.169 (0.173) data 0.092 (0.096) loss_u loss_u 0.9429 (0.9404) acc_u 6.2500 (7.1875) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [35/36] time 0.175 (0.173) data 0.098 (0.096) loss_u loss_u 0.9282 (0.9398) acc_u 9.3750 (7.3214) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 607
confident_label rate tensor(0.2769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 443
clean true:343
clean false:100
clean_rate:0.7742663656884876
noisy true:650
noisy false:507
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1157
epoch [158/200] batch [5/13] time 0.171 (0.174) data 0.095 (0.097) loss_x loss_x 0.6104 (0.5843) acc_x 84.3750 (85.6250) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/13] time 0.176 (0.170) data 0.100 (0.093) loss_x loss_x 0.6021 (0.5247) acc_x 84.3750 (86.8750) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/36] time 0.172 (0.174) data 0.095 (0.098) loss_u loss_u 0.9053 (0.9326) acc_u 12.5000 (8.1250) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [10/36] time 0.175 (0.173) data 0.098 (0.097) loss_u loss_u 0.9980 (0.9287) acc_u 0.0000 (8.4375) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/36] time 0.160 (0.172) data 0.083 (0.095) loss_u loss_u 0.8589 (0.9247) acc_u 15.6250 (8.9583) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/36] time 0.174 (0.172) data 0.094 (0.095) loss_u loss_u 0.9292 (0.9309) acc_u 9.3750 (8.1250) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/36] time 0.188 (0.174) data 0.111 (0.097) loss_u loss_u 1.0000 (0.9328) acc_u 0.0000 (8.2500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [30/36] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.9106 (0.9329) acc_u 9.3750 (8.2292) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [35/36] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.9683 (0.9350) acc_u 3.1250 (7.7679) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 574
confident_label rate tensor(0.2825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 452
clean true:350
clean false:102
clean_rate:0.7743362831858407
noisy true:676
noisy false:472
after delete: len(clean_dataset) 452
after delete: len(noisy_dataset) 1148
epoch [159/200] batch [5/14] time 0.169 (0.170) data 0.092 (0.093) loss_x loss_x 0.5752 (0.4841) acc_x 87.5000 (90.0000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/14] time 0.158 (0.168) data 0.082 (0.091) loss_x loss_x 1.3174 (0.5624) acc_x 75.0000 (88.4375) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/35] time 0.168 (0.171) data 0.089 (0.095) loss_u loss_u 0.9058 (0.9454) acc_u 12.5000 (6.8750) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [10/35] time 0.168 (0.170) data 0.092 (0.094) loss_u loss_u 0.9980 (0.9342) acc_u 0.0000 (8.1250) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/35] time 0.176 (0.170) data 0.099 (0.094) loss_u loss_u 0.9482 (0.9388) acc_u 6.2500 (7.2917) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/35] time 0.182 (0.171) data 0.105 (0.094) loss_u loss_u 0.9746 (0.9382) acc_u 3.1250 (7.3438) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/35] time 0.165 (0.171) data 0.088 (0.095) loss_u loss_u 0.9233 (0.9384) acc_u 9.3750 (7.1250) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [30/35] time 0.184 (0.173) data 0.108 (0.096) loss_u loss_u 0.9604 (0.9394) acc_u 3.1250 (7.0833) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [35/35] time 0.184 (0.174) data 0.107 (0.097) loss_u loss_u 0.9468 (0.9409) acc_u 6.2500 (6.9643) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 541
confident_label rate tensor(0.2731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 437
clean true:343
clean false:94
clean_rate:0.7848970251716247
noisy true:716
noisy false:447
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1163
epoch [160/200] batch [5/13] time 0.169 (0.177) data 0.093 (0.100) loss_x loss_x 0.2930 (0.5566) acc_x 90.6250 (88.1250) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/13] time 0.164 (0.174) data 0.087 (0.097) loss_x loss_x 0.6333 (0.5522) acc_x 90.6250 (88.7500) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/36] time 0.178 (0.175) data 0.101 (0.098) loss_u loss_u 0.9219 (0.9113) acc_u 9.3750 (10.6250) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [10/36] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.8979 (0.9249) acc_u 6.2500 (8.4375) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/36] time 0.159 (0.176) data 0.082 (0.099) loss_u loss_u 0.9189 (0.9222) acc_u 9.3750 (8.5417) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/36] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.9688 (0.9312) acc_u 3.1250 (7.6562) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/36] time 0.178 (0.176) data 0.102 (0.099) loss_u loss_u 0.8872 (0.9326) acc_u 9.3750 (7.5000) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [30/36] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.9253 (0.9324) acc_u 6.2500 (7.3958) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [35/36] time 0.175 (0.177) data 0.097 (0.100) loss_u loss_u 0.9146 (0.9277) acc_u 9.3750 (7.9464) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 568
confident_label rate tensor(0.2775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 444
clean true:345
clean false:99
clean_rate:0.777027027027027
noisy true:687
noisy false:469
after delete: len(clean_dataset) 444
after delete: len(noisy_dataset) 1156
epoch [161/200] batch [5/13] time 0.175 (0.174) data 0.098 (0.098) loss_x loss_x 0.4084 (0.5092) acc_x 90.6250 (85.6250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [10/13] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.2585 (0.5195) acc_x 93.7500 (86.5625) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/36] time 0.183 (0.174) data 0.107 (0.097) loss_u loss_u 0.9258 (0.9439) acc_u 9.3750 (6.8750) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [10/36] time 0.180 (0.175) data 0.103 (0.099) loss_u loss_u 0.9790 (0.9476) acc_u 3.1250 (6.2500) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/36] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.9009 (0.9442) acc_u 9.3750 (6.4583) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/36] time 0.188 (0.178) data 0.111 (0.101) loss_u loss_u 0.8735 (0.9436) acc_u 12.5000 (6.2500) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/36] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9004 (0.9385) acc_u 12.5000 (7.5000) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [30/36] time 0.186 (0.180) data 0.110 (0.103) loss_u loss_u 0.9253 (0.9379) acc_u 9.3750 (7.6042) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [35/36] time 0.186 (0.181) data 0.110 (0.104) loss_u loss_u 0.8574 (0.9370) acc_u 15.6250 (7.5000) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 567
confident_label rate tensor(0.2669, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 427
clean true:331
clean false:96
clean_rate:0.775175644028103
noisy true:702
noisy false:471
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1173
epoch [162/200] batch [5/13] time 0.224 (0.203) data 0.148 (0.126) loss_x loss_x 0.5215 (0.4916) acc_x 87.5000 (86.8750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [10/13] time 0.178 (0.194) data 0.101 (0.118) loss_x loss_x 0.3928 (0.4516) acc_x 90.6250 (88.4375) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/36] time 0.190 (0.190) data 0.112 (0.114) loss_u loss_u 0.9170 (0.9190) acc_u 9.3750 (9.3750) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [10/36] time 0.189 (0.190) data 0.112 (0.113) loss_u loss_u 0.8623 (0.8998) acc_u 18.7500 (11.8750) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/36] time 0.184 (0.188) data 0.106 (0.111) loss_u loss_u 0.9111 (0.9051) acc_u 9.3750 (10.8333) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/36] time 0.167 (0.187) data 0.089 (0.110) loss_u loss_u 0.8979 (0.9137) acc_u 9.3750 (9.8438) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/36] time 0.181 (0.185) data 0.103 (0.108) loss_u loss_u 0.9385 (0.9222) acc_u 6.2500 (8.8750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [30/36] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9297 (0.9221) acc_u 6.2500 (8.6458) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [35/36] time 0.176 (0.183) data 0.099 (0.106) loss_u loss_u 0.9448 (0.9250) acc_u 3.1250 (8.2143) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 575
confident_label rate tensor(0.2662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 426
clean true:333
clean false:93
clean_rate:0.7816901408450704
noisy true:692
noisy false:482
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1174
epoch [163/200] batch [5/13] time 0.175 (0.167) data 0.099 (0.091) loss_x loss_x 0.5049 (0.6011) acc_x 84.3750 (86.2500) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [10/13] time 0.182 (0.171) data 0.106 (0.094) loss_x loss_x 0.4800 (0.5417) acc_x 78.1250 (86.2500) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/36] time 0.180 (0.176) data 0.104 (0.100) loss_u loss_u 0.8857 (0.9345) acc_u 12.5000 (7.5000) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [10/36] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9673 (0.9441) acc_u 6.2500 (6.8750) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/36] time 0.183 (0.179) data 0.107 (0.102) loss_u loss_u 0.8438 (0.9244) acc_u 18.7500 (8.7500) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/36] time 0.185 (0.180) data 0.109 (0.103) loss_u loss_u 0.9497 (0.9260) acc_u 6.2500 (8.5938) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/36] time 0.161 (0.180) data 0.084 (0.103) loss_u loss_u 0.8799 (0.9201) acc_u 12.5000 (9.1250) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [30/36] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.8555 (0.9209) acc_u 15.6250 (8.7500) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [35/36] time 0.163 (0.178) data 0.086 (0.102) loss_u loss_u 0.9419 (0.9216) acc_u 6.2500 (8.7500) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 584
confident_label rate tensor(0.2750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 440
clean true:343
clean false:97
clean_rate:0.7795454545454545
noisy true:673
noisy false:487
after delete: len(clean_dataset) 440
after delete: len(noisy_dataset) 1160
epoch [164/200] batch [5/13] time 0.190 (0.185) data 0.114 (0.109) loss_x loss_x 0.4597 (0.4941) acc_x 84.3750 (87.5000) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [10/13] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.4104 (0.4812) acc_x 93.7500 (86.5625) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/36] time 0.180 (0.186) data 0.103 (0.110) loss_u loss_u 0.9448 (0.9253) acc_u 9.3750 (9.3750) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [10/36] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.9780 (0.9296) acc_u 3.1250 (8.7500) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/36] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.8838 (0.9255) acc_u 12.5000 (9.1667) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/36] time 0.161 (0.182) data 0.084 (0.105) loss_u loss_u 0.9746 (0.9212) acc_u 3.1250 (9.5312) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/36] time 0.172 (0.179) data 0.096 (0.102) loss_u loss_u 0.9614 (0.9186) acc_u 3.1250 (9.8750) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [30/36] time 0.184 (0.179) data 0.108 (0.102) loss_u loss_u 0.9214 (0.9202) acc_u 9.3750 (9.6875) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [35/36] time 0.173 (0.179) data 0.096 (0.102) loss_u loss_u 0.9771 (0.9280) acc_u 3.1250 (8.8393) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 580
confident_label rate tensor(0.2837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 454
clean true:344
clean false:110
clean_rate:0.7577092511013216
noisy true:676
noisy false:470
after delete: len(clean_dataset) 454
after delete: len(noisy_dataset) 1146
epoch [165/200] batch [5/14] time 0.175 (0.174) data 0.097 (0.097) loss_x loss_x 0.6372 (0.6478) acc_x 81.2500 (80.6250) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/14] time 0.190 (0.173) data 0.112 (0.096) loss_x loss_x 0.6440 (0.5651) acc_x 87.5000 (83.1250) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/35] time 0.169 (0.173) data 0.092 (0.096) loss_u loss_u 0.9253 (0.9279) acc_u 12.5000 (8.7500) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [10/35] time 0.175 (0.173) data 0.097 (0.096) loss_u loss_u 0.9238 (0.9454) acc_u 9.3750 (6.2500) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/35] time 0.184 (0.175) data 0.108 (0.098) loss_u loss_u 0.9741 (0.9498) acc_u 3.1250 (5.8333) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/35] time 0.185 (0.176) data 0.109 (0.099) loss_u loss_u 0.9595 (0.9455) acc_u 3.1250 (6.0938) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/35] time 0.186 (0.177) data 0.108 (0.100) loss_u loss_u 0.9390 (0.9452) acc_u 6.2500 (6.2500) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [30/35] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.9443 (0.9476) acc_u 6.2500 (5.9375) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [35/35] time 0.180 (0.179) data 0.104 (0.102) loss_u loss_u 0.9688 (0.9461) acc_u 3.1250 (6.2500) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 593
confident_label rate tensor(0.2756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 441
clean true:340
clean false:101
clean_rate:0.7709750566893424
noisy true:667
noisy false:492
after delete: len(clean_dataset) 441
after delete: len(noisy_dataset) 1159
epoch [166/200] batch [5/13] time 0.171 (0.173) data 0.095 (0.096) loss_x loss_x 0.2678 (0.4412) acc_x 90.6250 (90.0000) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/13] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.3203 (0.4900) acc_x 90.6250 (87.5000) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/36] time 0.164 (0.170) data 0.086 (0.093) loss_u loss_u 0.9980 (0.9708) acc_u 0.0000 (3.1250) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [10/36] time 0.167 (0.170) data 0.090 (0.093) loss_u loss_u 0.9443 (0.9331) acc_u 6.2500 (7.5000) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/36] time 0.178 (0.169) data 0.101 (0.092) loss_u loss_u 0.9229 (0.9408) acc_u 9.3750 (7.0833) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/36] time 0.184 (0.172) data 0.108 (0.095) loss_u loss_u 0.9990 (0.9371) acc_u 0.0000 (7.8125) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/36] time 0.185 (0.173) data 0.107 (0.096) loss_u loss_u 0.9346 (0.9311) acc_u 9.3750 (8.8750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [30/36] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.9707 (0.9342) acc_u 3.1250 (8.3333) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [35/36] time 0.161 (0.173) data 0.084 (0.096) loss_u loss_u 0.9458 (0.9356) acc_u 3.1250 (7.9464) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 576
confident_label rate tensor(0.2781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 445
clean true:342
clean false:103
clean_rate:0.7685393258426966
noisy true:682
noisy false:473
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1155
epoch [167/200] batch [5/13] time 0.176 (0.177) data 0.099 (0.101) loss_x loss_x 0.3352 (0.5460) acc_x 93.7500 (86.2500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/13] time 0.184 (0.177) data 0.108 (0.100) loss_x loss_x 0.3906 (0.5349) acc_x 87.5000 (86.2500) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/36] time 0.162 (0.171) data 0.085 (0.094) loss_u loss_u 0.9258 (0.9282) acc_u 12.5000 (8.7500) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [10/36] time 0.164 (0.170) data 0.087 (0.093) loss_u loss_u 0.9331 (0.9237) acc_u 6.2500 (8.7500) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/36] time 0.194 (0.170) data 0.115 (0.094) loss_u loss_u 0.8916 (0.9238) acc_u 9.3750 (8.7500) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/36] time 0.185 (0.173) data 0.108 (0.096) loss_u loss_u 0.9043 (0.9298) acc_u 12.5000 (8.2812) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/36] time 0.182 (0.174) data 0.106 (0.097) loss_u loss_u 0.8613 (0.9279) acc_u 15.6250 (8.5000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/36] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.9570 (0.9328) acc_u 3.1250 (7.9167) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [35/36] time 0.196 (0.177) data 0.119 (0.100) loss_u loss_u 0.9043 (0.9314) acc_u 12.5000 (8.2143) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 577
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 449
clean true:342
clean false:107
clean_rate:0.7616926503340757
noisy true:681
noisy false:470
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 1151
epoch [168/200] batch [5/14] time 0.174 (0.177) data 0.096 (0.100) loss_x loss_x 0.2744 (0.4500) acc_x 93.7500 (90.0000) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [10/14] time 0.189 (0.181) data 0.113 (0.105) loss_x loss_x 0.2715 (0.4398) acc_x 93.7500 (87.8125) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/35] time 0.188 (0.182) data 0.111 (0.106) loss_u loss_u 0.9248 (0.9379) acc_u 6.2500 (7.5000) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [10/35] time 0.185 (0.182) data 0.109 (0.106) loss_u loss_u 0.9526 (0.9180) acc_u 3.1250 (9.3750) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [15/35] time 0.172 (0.182) data 0.095 (0.105) loss_u loss_u 0.9033 (0.9219) acc_u 9.3750 (8.7500) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/35] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.9980 (0.9249) acc_u 0.0000 (8.4375) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/35] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9673 (0.9252) acc_u 3.1250 (8.6250) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [30/35] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.9341 (0.9299) acc_u 6.2500 (8.1250) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [35/35] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9126 (0.9284) acc_u 9.3750 (8.2143) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 611
confident_label rate tensor(0.2637, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 422
clean true:323
clean false:99
clean_rate:0.7654028436018957
noisy true:666
noisy false:512
after delete: len(clean_dataset) 422
after delete: len(noisy_dataset) 1178
epoch [169/200] batch [5/13] time 0.188 (0.183) data 0.111 (0.106) loss_x loss_x 0.6567 (0.5731) acc_x 81.2500 (88.1250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/13] time 0.180 (0.177) data 0.104 (0.099) loss_x loss_x 0.2776 (0.5287) acc_x 90.6250 (86.5625) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/36] time 0.178 (0.179) data 0.101 (0.102) loss_u loss_u 0.9326 (0.9295) acc_u 9.3750 (8.1250) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [10/36] time 0.174 (0.179) data 0.098 (0.101) loss_u loss_u 0.9790 (0.9124) acc_u 3.1250 (10.3125) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/36] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8970 (0.9102) acc_u 15.6250 (11.2500) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [20/36] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8936 (0.9046) acc_u 9.3750 (11.4062) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/36] time 0.181 (0.181) data 0.103 (0.103) loss_u loss_u 0.9316 (0.9096) acc_u 6.2500 (10.5000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [30/36] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9473 (0.9134) acc_u 6.2500 (10.0000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [35/36] time 0.187 (0.182) data 0.110 (0.104) loss_u loss_u 0.9678 (0.9178) acc_u 3.1250 (9.3750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 582
confident_label rate tensor(0.2756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 441
clean true:335
clean false:106
clean_rate:0.7596371882086168
noisy true:683
noisy false:476
after delete: len(clean_dataset) 441
after delete: len(noisy_dataset) 1159
epoch [170/200] batch [5/13] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.3914 (0.5081) acc_x 90.6250 (88.7500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/13] time 0.192 (0.187) data 0.116 (0.110) loss_x loss_x 0.3159 (0.4463) acc_x 90.6250 (89.3750) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/36] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9614 (0.9130) acc_u 6.2500 (10.6250) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [10/36] time 0.180 (0.182) data 0.104 (0.104) loss_u loss_u 0.8999 (0.9170) acc_u 12.5000 (10.3125) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/36] time 0.171 (0.181) data 0.094 (0.104) loss_u loss_u 0.9814 (0.9320) acc_u 3.1250 (8.3333) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/36] time 0.169 (0.180) data 0.090 (0.102) loss_u loss_u 0.8652 (0.9244) acc_u 18.7500 (9.2188) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/36] time 0.172 (0.179) data 0.095 (0.101) loss_u loss_u 0.8799 (0.9227) acc_u 12.5000 (9.2500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [30/36] time 0.174 (0.179) data 0.096 (0.102) loss_u loss_u 0.8901 (0.9238) acc_u 12.5000 (8.8542) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [35/36] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9624 (0.9251) acc_u 6.2500 (8.7500) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 574
confident_label rate tensor(0.2837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 454
clean true:348
clean false:106
clean_rate:0.7665198237885462
noisy true:678
noisy false:468
after delete: len(clean_dataset) 454
after delete: len(noisy_dataset) 1146
epoch [171/200] batch [5/14] time 0.178 (0.169) data 0.102 (0.092) loss_x loss_x 0.8975 (0.5807) acc_x 90.6250 (86.8750) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/14] time 0.175 (0.172) data 0.097 (0.095) loss_x loss_x 0.3643 (0.5567) acc_x 93.7500 (87.5000) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/35] time 0.188 (0.172) data 0.110 (0.095) loss_u loss_u 0.8843 (0.9184) acc_u 15.6250 (10.6250) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [10/35] time 0.170 (0.177) data 0.092 (0.100) loss_u loss_u 0.9824 (0.9327) acc_u 3.1250 (8.4375) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/35] time 0.168 (0.176) data 0.090 (0.099) loss_u loss_u 0.9258 (0.9338) acc_u 9.3750 (7.7083) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [20/35] time 0.162 (0.175) data 0.084 (0.097) loss_u loss_u 0.9517 (0.9339) acc_u 6.2500 (7.6562) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/35] time 0.173 (0.176) data 0.095 (0.098) loss_u loss_u 0.9995 (0.9394) acc_u 0.0000 (6.8750) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [30/35] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.8726 (0.9370) acc_u 12.5000 (7.0833) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [35/35] time 0.187 (0.176) data 0.110 (0.098) loss_u loss_u 0.9502 (0.9365) acc_u 6.2500 (7.1429) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 578
confident_label rate tensor(0.2681, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 429
clean true:328
clean false:101
clean_rate:0.7645687645687645
noisy true:694
noisy false:477
after delete: len(clean_dataset) 429
after delete: len(noisy_dataset) 1171
epoch [172/200] batch [5/13] time 0.174 (0.174) data 0.098 (0.098) loss_x loss_x 0.5771 (0.4301) acc_x 84.3750 (88.1250) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [10/13] time 0.178 (0.171) data 0.100 (0.095) loss_x loss_x 0.4075 (0.4511) acc_x 84.3750 (86.8750) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/36] time 0.178 (0.174) data 0.101 (0.098) loss_u loss_u 0.9062 (0.9075) acc_u 9.3750 (10.6250) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [10/36] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.9404 (0.9215) acc_u 6.2500 (8.7500) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/36] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.8931 (0.9136) acc_u 12.5000 (9.3750) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [20/36] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.9316 (0.9173) acc_u 9.3750 (9.0625) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/36] time 0.183 (0.178) data 0.106 (0.102) loss_u loss_u 0.8569 (0.9154) acc_u 15.6250 (9.5000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [30/36] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.9521 (0.9207) acc_u 3.1250 (8.7500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [35/36] time 0.171 (0.179) data 0.094 (0.102) loss_u loss_u 0.8975 (0.9226) acc_u 9.3750 (8.3929) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 559
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 450
clean true:343
clean false:107
clean_rate:0.7622222222222222
noisy true:698
noisy false:452
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1150
epoch [173/200] batch [5/14] time 0.165 (0.173) data 0.089 (0.096) loss_x loss_x 0.5737 (0.4548) acc_x 84.3750 (88.7500) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/14] time 0.170 (0.175) data 0.092 (0.098) loss_x loss_x 0.7417 (0.4523) acc_x 78.1250 (88.4375) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/35] time 0.163 (0.172) data 0.084 (0.094) loss_u loss_u 0.9263 (0.9481) acc_u 9.3750 (6.2500) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [10/35] time 0.179 (0.172) data 0.102 (0.095) loss_u loss_u 0.9590 (0.9370) acc_u 6.2500 (7.8125) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/35] time 0.200 (0.174) data 0.122 (0.097) loss_u loss_u 0.9448 (0.9401) acc_u 6.2500 (7.2917) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/35] time 0.208 (0.179) data 0.131 (0.102) loss_u loss_u 0.8745 (0.9358) acc_u 15.6250 (7.6562) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/35] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.9907 (0.9375) acc_u 0.0000 (7.2500) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/35] time 0.176 (0.179) data 0.099 (0.102) loss_u loss_u 0.9023 (0.9365) acc_u 9.3750 (7.2917) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [35/35] time 0.171 (0.179) data 0.092 (0.102) loss_u loss_u 0.8945 (0.9369) acc_u 12.5000 (7.3214) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 585
confident_label rate tensor(0.2725, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 436
clean true:328
clean false:108
clean_rate:0.7522935779816514
noisy true:687
noisy false:477
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1164
epoch [174/200] batch [5/13] time 0.164 (0.176) data 0.087 (0.099) loss_x loss_x 0.6421 (0.4306) acc_x 78.1250 (88.7500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/13] time 0.161 (0.172) data 0.085 (0.095) loss_x loss_x 0.4846 (0.4846) acc_x 84.3750 (87.5000) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/36] time 0.174 (0.171) data 0.097 (0.094) loss_u loss_u 0.9380 (0.9145) acc_u 9.3750 (10.6250) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [10/36] time 0.171 (0.171) data 0.094 (0.094) loss_u loss_u 0.9331 (0.9196) acc_u 9.3750 (10.0000) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/36] time 0.173 (0.171) data 0.094 (0.094) loss_u loss_u 0.9424 (0.9296) acc_u 6.2500 (8.9583) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/36] time 0.165 (0.170) data 0.088 (0.093) loss_u loss_u 0.9619 (0.9258) acc_u 3.1250 (8.9062) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/36] time 0.171 (0.170) data 0.093 (0.093) loss_u loss_u 0.9785 (0.9245) acc_u 0.0000 (8.8750) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [30/36] time 0.175 (0.172) data 0.097 (0.094) loss_u loss_u 0.9404 (0.9263) acc_u 9.3750 (8.6458) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [35/36] time 0.182 (0.172) data 0.105 (0.094) loss_u loss_u 0.9180 (0.9261) acc_u 9.3750 (8.5714) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 584
confident_label rate tensor(0.2794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 447
clean true:343
clean false:104
clean_rate:0.767337807606264
noisy true:673
noisy false:480
after delete: len(clean_dataset) 447
after delete: len(noisy_dataset) 1153
epoch [175/200] batch [5/13] time 0.175 (0.176) data 0.099 (0.099) loss_x loss_x 0.5376 (0.4856) acc_x 84.3750 (88.7500) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [10/13] time 0.178 (0.172) data 0.101 (0.095) loss_x loss_x 0.4866 (0.5032) acc_x 81.2500 (87.1875) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/36] time 0.172 (0.170) data 0.095 (0.093) loss_u loss_u 0.8613 (0.9251) acc_u 15.6250 (9.3750) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [10/36] time 0.173 (0.170) data 0.096 (0.093) loss_u loss_u 0.9033 (0.9354) acc_u 12.5000 (7.8125) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/36] time 0.178 (0.171) data 0.101 (0.094) loss_u loss_u 0.9971 (0.9313) acc_u 0.0000 (7.9167) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/36] time 0.181 (0.172) data 0.104 (0.095) loss_u loss_u 0.9531 (0.9345) acc_u 6.2500 (7.3438) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/36] time 0.179 (0.173) data 0.102 (0.096) loss_u loss_u 0.9712 (0.9289) acc_u 3.1250 (7.8750) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [30/36] time 0.182 (0.173) data 0.104 (0.096) loss_u loss_u 0.8691 (0.9328) acc_u 15.6250 (7.5000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [35/36] time 0.171 (0.174) data 0.094 (0.097) loss_u loss_u 0.9170 (0.9334) acc_u 12.5000 (7.6786) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 592
confident_label rate tensor(0.2862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 458
clean true:346
clean false:112
clean_rate:0.7554585152838428
noisy true:662
noisy false:480
after delete: len(clean_dataset) 458
after delete: len(noisy_dataset) 1142
epoch [176/200] batch [5/14] time 0.177 (0.173) data 0.100 (0.096) loss_x loss_x 0.7520 (0.5990) acc_x 81.2500 (85.0000) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [10/14] time 0.179 (0.176) data 0.101 (0.099) loss_x loss_x 0.5952 (0.5210) acc_x 87.5000 (88.4375) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/35] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9829 (0.9052) acc_u 0.0000 (10.0000) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [10/35] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.9492 (0.9260) acc_u 6.2500 (8.7500) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/35] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.9985 (0.9326) acc_u 0.0000 (7.9167) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/35] time 0.177 (0.181) data 0.099 (0.104) loss_u loss_u 0.9688 (0.9399) acc_u 3.1250 (6.8750) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/35] time 0.188 (0.181) data 0.111 (0.104) loss_u loss_u 0.9985 (0.9404) acc_u 0.0000 (6.8750) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [30/35] time 0.172 (0.181) data 0.095 (0.104) loss_u loss_u 0.9028 (0.9348) acc_u 9.3750 (7.6042) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [35/35] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.9453 (0.9374) acc_u 6.2500 (7.2321) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 580
confident_label rate tensor(0.2725, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 436
clean true:334
clean false:102
clean_rate:0.7660550458715596
noisy true:686
noisy false:478
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1164
epoch [177/200] batch [5/13] time 0.174 (0.173) data 0.097 (0.096) loss_x loss_x 0.4246 (0.4654) acc_x 87.5000 (87.5000) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/13] time 0.183 (0.178) data 0.107 (0.101) loss_x loss_x 0.1768 (0.5039) acc_x 93.7500 (87.8125) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/36] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.9912 (0.9416) acc_u 0.0000 (6.2500) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [10/36] time 0.181 (0.181) data 0.105 (0.104) loss_u loss_u 0.9932 (0.9293) acc_u 3.1250 (8.1250) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/36] time 0.190 (0.182) data 0.112 (0.105) loss_u loss_u 0.8706 (0.9284) acc_u 12.5000 (7.7083) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/36] time 0.187 (0.183) data 0.111 (0.106) loss_u loss_u 0.9307 (0.9239) acc_u 6.2500 (8.5938) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/36] time 0.188 (0.183) data 0.109 (0.106) loss_u loss_u 0.9980 (0.9289) acc_u 0.0000 (8.0000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [30/36] time 0.169 (0.183) data 0.092 (0.106) loss_u loss_u 0.9565 (0.9277) acc_u 6.2500 (8.2292) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [35/36] time 0.178 (0.181) data 0.101 (0.105) loss_u loss_u 0.9072 (0.9258) acc_u 9.3750 (8.4821) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 571
confident_label rate tensor(0.2788, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 446
clean true:339
clean false:107
clean_rate:0.7600896860986547
noisy true:690
noisy false:464
after delete: len(clean_dataset) 446
after delete: len(noisy_dataset) 1154
epoch [178/200] batch [5/13] time 0.193 (0.174) data 0.116 (0.097) loss_x loss_x 0.5122 (0.4260) acc_x 90.6250 (90.6250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [10/13] time 0.161 (0.169) data 0.084 (0.092) loss_x loss_x 0.3923 (0.4862) acc_x 96.8750 (88.7500) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/36] time 0.161 (0.168) data 0.084 (0.092) loss_u loss_u 0.9556 (0.9392) acc_u 6.2500 (6.8750) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [10/36] time 0.161 (0.167) data 0.084 (0.090) loss_u loss_u 0.8408 (0.9246) acc_u 18.7500 (8.1250) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/36] time 0.160 (0.166) data 0.082 (0.089) loss_u loss_u 0.9375 (0.9263) acc_u 6.2500 (7.9167) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/36] time 0.163 (0.166) data 0.085 (0.089) loss_u loss_u 0.9502 (0.9273) acc_u 6.2500 (8.1250) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/36] time 0.184 (0.166) data 0.106 (0.089) loss_u loss_u 0.9229 (0.9251) acc_u 9.3750 (8.6250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [30/36] time 0.187 (0.167) data 0.109 (0.090) loss_u loss_u 0.9683 (0.9308) acc_u 3.1250 (8.0208) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [35/36] time 0.194 (0.170) data 0.117 (0.093) loss_u loss_u 0.9648 (0.9277) acc_u 3.1250 (8.3036) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 598
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 449
clean true:340
clean false:109
clean_rate:0.7572383073496659
noisy true:662
noisy false:489
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 1151
epoch [179/200] batch [5/14] time 0.167 (0.162) data 0.091 (0.086) loss_x loss_x 0.7563 (0.3715) acc_x 87.5000 (91.8750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/14] time 0.173 (0.169) data 0.096 (0.092) loss_x loss_x 0.5884 (0.4406) acc_x 84.3750 (88.4375) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/35] time 0.162 (0.169) data 0.085 (0.093) loss_u loss_u 0.8833 (0.9146) acc_u 18.7500 (10.6250) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [10/35] time 0.183 (0.169) data 0.106 (0.092) loss_u loss_u 0.9111 (0.9188) acc_u 9.3750 (9.3750) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/35] time 0.184 (0.172) data 0.107 (0.095) loss_u loss_u 0.9438 (0.9222) acc_u 6.2500 (8.9583) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [20/35] time 0.170 (0.174) data 0.093 (0.097) loss_u loss_u 0.9531 (0.9290) acc_u 6.2500 (8.2812) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/35] time 0.176 (0.175) data 0.099 (0.098) loss_u loss_u 0.9683 (0.9308) acc_u 3.1250 (8.0000) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [30/35] time 0.184 (0.175) data 0.107 (0.099) loss_u loss_u 0.8994 (0.9336) acc_u 12.5000 (7.6042) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [35/35] time 0.171 (0.175) data 0.094 (0.098) loss_u loss_u 0.9199 (0.9307) acc_u 9.3750 (7.8571) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 584
confident_label rate tensor(0.2694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 431
clean true:329
clean false:102
clean_rate:0.7633410672853829
noisy true:687
noisy false:482
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1169
epoch [180/200] batch [5/13] time 0.177 (0.172) data 0.099 (0.095) loss_x loss_x 0.3018 (0.3408) acc_x 90.6250 (89.3750) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/13] time 0.168 (0.175) data 0.092 (0.098) loss_x loss_x 0.5586 (0.4392) acc_x 90.6250 (86.8750) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/36] time 0.158 (0.175) data 0.082 (0.099) loss_u loss_u 0.9609 (0.9207) acc_u 6.2500 (8.1250) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [10/36] time 0.177 (0.173) data 0.101 (0.097) loss_u loss_u 0.8823 (0.9133) acc_u 15.6250 (9.6875) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/36] time 0.191 (0.173) data 0.115 (0.097) loss_u loss_u 0.9150 (0.9122) acc_u 9.3750 (10.0000) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/36] time 0.186 (0.174) data 0.109 (0.097) loss_u loss_u 0.9404 (0.9169) acc_u 6.2500 (9.8438) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/36] time 0.175 (0.174) data 0.098 (0.097) loss_u loss_u 0.9204 (0.9218) acc_u 9.3750 (9.1250) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [30/36] time 0.189 (0.175) data 0.112 (0.098) loss_u loss_u 0.9009 (0.9242) acc_u 9.3750 (8.6458) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [35/36] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.9072 (0.9249) acc_u 12.5000 (8.5714) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 573
confident_label rate tensor(0.2837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 454
clean true:348
clean false:106
clean_rate:0.7665198237885462
noisy true:679
noisy false:467
after delete: len(clean_dataset) 454
after delete: len(noisy_dataset) 1146
epoch [181/200] batch [5/14] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.4590 (0.4926) acc_x 84.3750 (86.8750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [10/14] time 0.160 (0.178) data 0.083 (0.101) loss_x loss_x 0.3584 (0.4655) acc_x 87.5000 (87.5000) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/35] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.9268 (0.9414) acc_u 6.2500 (6.2500) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [10/35] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9399 (0.9392) acc_u 9.3750 (6.8750) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/35] time 0.165 (0.181) data 0.088 (0.104) loss_u loss_u 0.9502 (0.9475) acc_u 6.2500 (6.0417) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/35] time 0.173 (0.180) data 0.096 (0.103) loss_u loss_u 0.9160 (0.9423) acc_u 9.3750 (6.8750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/35] time 0.170 (0.180) data 0.092 (0.102) loss_u loss_u 0.9639 (0.9429) acc_u 3.1250 (6.7500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [30/35] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.9331 (0.9386) acc_u 6.2500 (7.2917) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [35/35] time 0.182 (0.181) data 0.105 (0.103) loss_u loss_u 0.8867 (0.9372) acc_u 12.5000 (7.4107) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 581
confident_label rate tensor(0.2725, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 436
clean true:335
clean false:101
clean_rate:0.768348623853211
noisy true:684
noisy false:480
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1164
epoch [182/200] batch [5/13] time 0.193 (0.182) data 0.114 (0.104) loss_x loss_x 0.2966 (0.4980) acc_x 93.7500 (90.6250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/13] time 0.188 (0.184) data 0.110 (0.107) loss_x loss_x 0.3726 (0.4479) acc_x 87.5000 (89.6875) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/36] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.8628 (0.9117) acc_u 15.6250 (10.0000) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [10/36] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9619 (0.9254) acc_u 3.1250 (8.7500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/36] time 0.189 (0.186) data 0.111 (0.109) loss_u loss_u 0.8794 (0.9262) acc_u 12.5000 (8.5417) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [20/36] time 0.188 (0.186) data 0.110 (0.109) loss_u loss_u 0.8286 (0.9230) acc_u 18.7500 (8.5938) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/36] time 0.194 (0.186) data 0.117 (0.109) loss_u loss_u 0.9639 (0.9265) acc_u 3.1250 (8.2500) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [30/36] time 0.186 (0.187) data 0.109 (0.110) loss_u loss_u 0.9399 (0.9292) acc_u 6.2500 (8.1250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [35/36] time 0.172 (0.186) data 0.095 (0.109) loss_u loss_u 0.9019 (0.9235) acc_u 12.5000 (8.5714) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 573
confident_label rate tensor(0.2850, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 456
clean true:344
clean false:112
clean_rate:0.7543859649122807
noisy true:683
noisy false:461
after delete: len(clean_dataset) 456
after delete: len(noisy_dataset) 1144
epoch [183/200] batch [5/14] time 0.183 (0.189) data 0.107 (0.112) loss_x loss_x 0.6250 (0.3691) acc_x 84.3750 (90.0000) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/14] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.4089 (0.4583) acc_x 90.6250 (89.3750) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/35] time 0.180 (0.181) data 0.102 (0.104) loss_u loss_u 0.8887 (0.9048) acc_u 15.6250 (10.0000) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [10/35] time 0.176 (0.181) data 0.098 (0.104) loss_u loss_u 0.9067 (0.9269) acc_u 9.3750 (8.1250) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/35] time 0.174 (0.179) data 0.096 (0.102) loss_u loss_u 0.9648 (0.9356) acc_u 3.1250 (7.0833) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [20/35] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.9360 (0.9292) acc_u 12.5000 (8.1250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/35] time 0.189 (0.178) data 0.113 (0.101) loss_u loss_u 0.9980 (0.9377) acc_u 0.0000 (7.3750) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [30/35] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.9912 (0.9387) acc_u 0.0000 (7.0833) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [35/35] time 0.192 (0.179) data 0.115 (0.101) loss_u loss_u 0.9380 (0.9390) acc_u 6.2500 (7.0536) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 586
confident_label rate tensor(0.2763, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 442
clean true:336
clean false:106
clean_rate:0.7601809954751131
noisy true:678
noisy false:480
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 1158
epoch [184/200] batch [5/13] time 0.168 (0.180) data 0.092 (0.103) loss_x loss_x 0.6304 (0.5590) acc_x 84.3750 (86.2500) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [10/13] time 0.164 (0.172) data 0.087 (0.095) loss_x loss_x 0.4819 (0.5237) acc_x 87.5000 (86.2500) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/36] time 0.164 (0.175) data 0.087 (0.099) loss_u loss_u 0.9907 (0.9169) acc_u 0.0000 (9.3750) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [10/36] time 0.163 (0.173) data 0.085 (0.096) loss_u loss_u 0.8896 (0.9191) acc_u 9.3750 (9.0625) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/36] time 0.169 (0.172) data 0.092 (0.095) loss_u loss_u 0.9619 (0.9259) acc_u 3.1250 (8.1250) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [20/36] time 0.174 (0.171) data 0.097 (0.094) loss_u loss_u 0.8823 (0.9253) acc_u 12.5000 (8.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/36] time 0.166 (0.171) data 0.088 (0.093) loss_u loss_u 0.9370 (0.9308) acc_u 6.2500 (7.6250) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [30/36] time 0.176 (0.171) data 0.100 (0.093) loss_u loss_u 0.9619 (0.9331) acc_u 6.2500 (7.6042) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [35/36] time 0.170 (0.171) data 0.093 (0.094) loss_u loss_u 0.9688 (0.9339) acc_u 3.1250 (7.5000) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 568
confident_label rate tensor(0.2769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 443
clean true:341
clean false:102
clean_rate:0.7697516930022573
noisy true:691
noisy false:466
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1157
epoch [185/200] batch [5/13] time 0.170 (0.171) data 0.093 (0.095) loss_x loss_x 0.5747 (0.6273) acc_x 81.2500 (84.3750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/13] time 0.177 (0.171) data 0.100 (0.094) loss_x loss_x 0.4905 (0.5366) acc_x 87.5000 (87.1875) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/36] time 0.157 (0.168) data 0.079 (0.090) loss_u loss_u 0.9688 (0.9625) acc_u 3.1250 (4.3750) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [10/36] time 0.180 (0.169) data 0.102 (0.092) loss_u loss_u 0.9009 (0.9471) acc_u 12.5000 (5.9375) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/36] time 0.190 (0.171) data 0.113 (0.094) loss_u loss_u 0.9385 (0.9252) acc_u 9.3750 (8.3333) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [20/36] time 0.179 (0.173) data 0.102 (0.096) loss_u loss_u 0.9409 (0.9240) acc_u 6.2500 (8.4375) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/36] time 0.181 (0.174) data 0.104 (0.097) loss_u loss_u 0.9136 (0.9252) acc_u 6.2500 (8.2500) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [30/36] time 0.186 (0.176) data 0.108 (0.099) loss_u loss_u 0.8789 (0.9279) acc_u 15.6250 (8.1250) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [35/36] time 0.190 (0.177) data 0.112 (0.100) loss_u loss_u 0.9263 (0.9274) acc_u 9.3750 (8.3036) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 566
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 449
clean true:345
clean false:104
clean_rate:0.7683741648106904
noisy true:689
noisy false:462
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 1151
epoch [186/200] batch [5/14] time 0.166 (0.171) data 0.090 (0.094) loss_x loss_x 0.1205 (0.3869) acc_x 100.0000 (88.1250) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [10/14] time 0.170 (0.169) data 0.093 (0.092) loss_x loss_x 0.5308 (0.4141) acc_x 87.5000 (88.1250) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/35] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.8770 (0.9145) acc_u 12.5000 (10.0000) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [10/35] time 0.190 (0.175) data 0.112 (0.098) loss_u loss_u 0.9629 (0.9179) acc_u 3.1250 (9.0625) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/35] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.9351 (0.9162) acc_u 9.3750 (9.5833) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [20/35] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.9365 (0.9200) acc_u 12.5000 (9.3750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/35] time 0.165 (0.174) data 0.088 (0.096) loss_u loss_u 0.9478 (0.9250) acc_u 6.2500 (8.7500) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [30/35] time 0.167 (0.173) data 0.089 (0.095) loss_u loss_u 0.9268 (0.9257) acc_u 9.3750 (8.6458) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [35/35] time 0.178 (0.173) data 0.101 (0.095) loss_u loss_u 0.9565 (0.9272) acc_u 3.1250 (8.3929) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 585
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 451
clean true:342
clean false:109
clean_rate:0.7583148558758315
noisy true:673
noisy false:476
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1149
epoch [187/200] batch [5/14] time 0.187 (0.188) data 0.111 (0.111) loss_x loss_x 0.4155 (0.4735) acc_x 90.6250 (85.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [10/14] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.7529 (0.5116) acc_x 84.3750 (85.6250) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/35] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9873 (0.9470) acc_u 0.0000 (5.6250) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [10/35] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8984 (0.9314) acc_u 12.5000 (7.8125) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/35] time 0.190 (0.184) data 0.112 (0.106) loss_u loss_u 0.9312 (0.9356) acc_u 6.2500 (7.0833) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/35] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9473 (0.9362) acc_u 3.1250 (6.8750) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/35] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9980 (0.9406) acc_u 0.0000 (6.6250) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [30/35] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9678 (0.9464) acc_u 3.1250 (5.9375) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [35/35] time 0.195 (0.185) data 0.117 (0.107) loss_u loss_u 0.9492 (0.9409) acc_u 9.3750 (6.6071) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 573
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 449
clean true:347
clean false:102
clean_rate:0.7728285077951003
noisy true:680
noisy false:471
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 1151
epoch [188/200] batch [5/14] time 0.180 (0.190) data 0.103 (0.113) loss_x loss_x 0.1530 (0.4263) acc_x 96.8750 (90.6250) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/14] time 0.174 (0.182) data 0.097 (0.106) loss_x loss_x 0.6025 (0.4034) acc_x 84.3750 (89.6875) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/35] time 0.178 (0.178) data 0.100 (0.101) loss_u loss_u 0.9258 (0.9481) acc_u 6.2500 (5.6250) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [10/35] time 0.163 (0.176) data 0.086 (0.099) loss_u loss_u 0.9033 (0.9490) acc_u 12.5000 (5.6250) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/35] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.9604 (0.9418) acc_u 3.1250 (6.0417) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/35] time 0.171 (0.175) data 0.094 (0.097) loss_u loss_u 0.8682 (0.9283) acc_u 15.6250 (7.8125) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/35] time 0.178 (0.174) data 0.100 (0.097) loss_u loss_u 0.8896 (0.9271) acc_u 12.5000 (8.2500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [30/35] time 0.174 (0.175) data 0.097 (0.098) loss_u loss_u 0.8975 (0.9299) acc_u 12.5000 (7.8125) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [35/35] time 0.187 (0.176) data 0.108 (0.099) loss_u loss_u 0.9067 (0.9311) acc_u 12.5000 (7.7679) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 577
confident_label rate tensor(0.2781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 445
clean true:341
clean false:104
clean_rate:0.7662921348314606
noisy true:682
noisy false:473
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1155
epoch [189/200] batch [5/13] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.1918 (0.4502) acc_x 96.8750 (91.8750) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/13] time 0.173 (0.172) data 0.096 (0.095) loss_x loss_x 0.3931 (0.4583) acc_x 93.7500 (90.0000) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/36] time 0.167 (0.171) data 0.090 (0.094) loss_u loss_u 0.8984 (0.9274) acc_u 12.5000 (8.1250) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [10/36] time 0.173 (0.171) data 0.096 (0.094) loss_u loss_u 0.9985 (0.9347) acc_u 0.0000 (7.1875) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/36] time 0.195 (0.173) data 0.118 (0.096) loss_u loss_u 0.9307 (0.9337) acc_u 6.2500 (7.0833) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/36] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.8760 (0.9259) acc_u 15.6250 (8.2812) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/36] time 0.182 (0.175) data 0.105 (0.098) loss_u loss_u 0.9639 (0.9298) acc_u 3.1250 (8.0000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [30/36] time 0.170 (0.174) data 0.093 (0.097) loss_u loss_u 0.9077 (0.9252) acc_u 12.5000 (8.5417) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [35/36] time 0.178 (0.176) data 0.099 (0.098) loss_u loss_u 0.9380 (0.9292) acc_u 6.2500 (8.2143) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 608
confident_label rate tensor(0.2800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 448
clean true:335
clean false:113
clean_rate:0.7477678571428571
noisy true:657
noisy false:495
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1152
epoch [190/200] batch [5/14] time 0.175 (0.187) data 0.097 (0.110) loss_x loss_x 0.6660 (0.6555) acc_x 84.3750 (85.0000) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/14] time 0.164 (0.178) data 0.086 (0.101) loss_x loss_x 0.3879 (0.6172) acc_x 90.6250 (85.3125) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/36] time 0.191 (0.175) data 0.114 (0.098) loss_u loss_u 0.9399 (0.9298) acc_u 6.2500 (6.8750) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [10/36] time 0.184 (0.178) data 0.107 (0.100) loss_u loss_u 0.9360 (0.9368) acc_u 6.2500 (6.5625) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/36] time 0.186 (0.179) data 0.109 (0.101) loss_u loss_u 0.9692 (0.9374) acc_u 3.1250 (6.8750) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/36] time 0.185 (0.181) data 0.108 (0.103) loss_u loss_u 0.8960 (0.9248) acc_u 12.5000 (8.4375) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/36] time 0.181 (0.181) data 0.102 (0.104) loss_u loss_u 0.8667 (0.9274) acc_u 15.6250 (8.1250) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [30/36] time 0.184 (0.181) data 0.108 (0.104) loss_u loss_u 0.9946 (0.9299) acc_u 0.0000 (7.8125) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [35/36] time 0.192 (0.182) data 0.114 (0.104) loss_u loss_u 0.9634 (0.9315) acc_u 3.1250 (7.5893) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 592
confident_label rate tensor(0.2775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 444
clean true:339
clean false:105
clean_rate:0.7635135135135135
noisy true:669
noisy false:487
after delete: len(clean_dataset) 444
after delete: len(noisy_dataset) 1156
epoch [191/200] batch [5/13] time 0.190 (0.182) data 0.113 (0.105) loss_x loss_x 0.3982 (0.4732) acc_x 87.5000 (85.6250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/13] time 0.195 (0.185) data 0.118 (0.108) loss_x loss_x 0.3875 (0.4706) acc_x 90.6250 (85.9375) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/36] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9941 (0.9167) acc_u 0.0000 (10.0000) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [10/36] time 0.187 (0.180) data 0.110 (0.104) loss_u loss_u 0.9150 (0.9151) acc_u 12.5000 (10.3125) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/36] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9956 (0.9273) acc_u 0.0000 (8.9583) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/36] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9648 (0.9307) acc_u 3.1250 (8.7500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/36] time 0.161 (0.179) data 0.084 (0.102) loss_u loss_u 0.9639 (0.9304) acc_u 3.1250 (8.6250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [30/36] time 0.181 (0.179) data 0.105 (0.102) loss_u loss_u 0.9604 (0.9319) acc_u 3.1250 (8.3333) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [35/36] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.8916 (0.9287) acc_u 12.5000 (8.6607) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 568
confident_label rate tensor(0.2756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 441
clean true:338
clean false:103
clean_rate:0.7664399092970522
noisy true:694
noisy false:465
after delete: len(clean_dataset) 441
after delete: len(noisy_dataset) 1159
epoch [192/200] batch [5/13] time 0.202 (0.194) data 0.125 (0.117) loss_x loss_x 0.4038 (0.4502) acc_x 87.5000 (89.3750) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [10/13] time 0.185 (0.191) data 0.108 (0.114) loss_x loss_x 0.3350 (0.4056) acc_x 87.5000 (89.0625) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/36] time 0.174 (0.181) data 0.097 (0.103) loss_u loss_u 0.9404 (0.9204) acc_u 9.3750 (9.3750) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [10/36] time 0.182 (0.180) data 0.104 (0.103) loss_u loss_u 0.8936 (0.9310) acc_u 9.3750 (7.8125) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/36] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9644 (0.9372) acc_u 6.2500 (7.2917) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [20/36] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9302 (0.9352) acc_u 6.2500 (7.1875) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/36] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.9604 (0.9373) acc_u 6.2500 (7.0000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [30/36] time 0.183 (0.182) data 0.106 (0.104) loss_u loss_u 0.9243 (0.9346) acc_u 6.2500 (7.3958) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [35/36] time 0.181 (0.182) data 0.103 (0.104) loss_u loss_u 0.9634 (0.9334) acc_u 6.2500 (7.5000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 587
confident_label rate tensor(0.2775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 444
clean true:337
clean false:107
clean_rate:0.759009009009009
noisy true:676
noisy false:480
after delete: len(clean_dataset) 444
after delete: len(noisy_dataset) 1156
epoch [193/200] batch [5/13] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.4324 (0.6912) acc_x 90.6250 (80.6250) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/13] time 0.158 (0.176) data 0.082 (0.099) loss_x loss_x 0.6855 (0.6192) acc_x 84.3750 (84.3750) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/36] time 0.161 (0.176) data 0.084 (0.099) loss_u loss_u 0.9526 (0.9322) acc_u 6.2500 (7.5000) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [10/36] time 0.162 (0.175) data 0.086 (0.098) loss_u loss_u 0.9604 (0.9350) acc_u 3.1250 (7.1875) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [15/36] time 0.176 (0.176) data 0.099 (0.100) loss_u loss_u 0.9551 (0.9240) acc_u 6.2500 (8.5417) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/36] time 0.180 (0.176) data 0.103 (0.100) loss_u loss_u 0.8701 (0.9256) acc_u 12.5000 (8.2812) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/36] time 0.182 (0.177) data 0.105 (0.101) loss_u loss_u 0.9644 (0.9257) acc_u 6.2500 (8.2500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [30/36] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.9600 (0.9294) acc_u 3.1250 (7.8125) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [35/36] time 0.187 (0.179) data 0.110 (0.103) loss_u loss_u 0.9966 (0.9319) acc_u 0.0000 (7.5000) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 597
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 451
clean true:336
clean false:115
clean_rate:0.7450110864745011
noisy true:667
noisy false:482
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1149
epoch [194/200] batch [5/14] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.3337 (0.4554) acc_x 90.6250 (86.8750) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/14] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.7358 (0.4898) acc_x 81.2500 (88.4375) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/35] time 0.181 (0.184) data 0.105 (0.107) loss_u loss_u 0.9277 (0.9566) acc_u 6.2500 (4.3750) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [10/35] time 0.183 (0.184) data 0.106 (0.108) loss_u loss_u 0.9131 (0.9317) acc_u 9.3750 (7.1875) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/35] time 0.189 (0.184) data 0.112 (0.108) loss_u loss_u 0.9370 (0.9367) acc_u 6.2500 (6.4583) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [20/35] time 0.183 (0.184) data 0.107 (0.108) loss_u loss_u 0.9204 (0.9333) acc_u 9.3750 (6.8750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/35] time 0.171 (0.184) data 0.094 (0.107) loss_u loss_u 0.9536 (0.9325) acc_u 6.2500 (7.1250) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [30/35] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8384 (0.9275) acc_u 18.7500 (7.9167) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [35/35] time 0.182 (0.182) data 0.106 (0.106) loss_u loss_u 0.9878 (0.9313) acc_u 0.0000 (7.4107) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 612
confident_label rate tensor(0.2750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 440
clean true:327
clean false:113
clean_rate:0.7431818181818182
noisy true:661
noisy false:499
after delete: len(clean_dataset) 440
after delete: len(noisy_dataset) 1160
epoch [195/200] batch [5/13] time 0.181 (0.177) data 0.105 (0.101) loss_x loss_x 0.5566 (0.6211) acc_x 90.6250 (85.0000) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/13] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.2732 (0.5442) acc_x 96.8750 (85.9375) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/36] time 0.168 (0.170) data 0.090 (0.093) loss_u loss_u 0.8799 (0.9330) acc_u 12.5000 (6.8750) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [10/36] time 0.187 (0.173) data 0.108 (0.096) loss_u loss_u 0.7959 (0.9134) acc_u 21.8750 (9.3750) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/36] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.8921 (0.9241) acc_u 12.5000 (8.3333) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/36] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.9443 (0.9307) acc_u 6.2500 (7.8125) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/36] time 0.173 (0.176) data 0.096 (0.099) loss_u loss_u 0.9590 (0.9319) acc_u 6.2500 (8.0000) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [30/36] time 0.162 (0.175) data 0.085 (0.098) loss_u loss_u 0.9009 (0.9283) acc_u 12.5000 (8.2292) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [35/36] time 0.161 (0.174) data 0.085 (0.097) loss_u loss_u 0.9683 (0.9291) acc_u 3.1250 (8.0357) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 604
confident_label rate tensor(0.2769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 443
clean true:333
clean false:110
clean_rate:0.7516930022573364
noisy true:663
noisy false:494
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1157
epoch [196/200] batch [5/13] time 0.195 (0.183) data 0.117 (0.106) loss_x loss_x 0.6470 (0.5374) acc_x 84.3750 (84.3750) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/13] time 0.163 (0.176) data 0.086 (0.099) loss_x loss_x 0.5879 (0.4589) acc_x 90.6250 (87.5000) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/36] time 0.187 (0.175) data 0.108 (0.098) loss_u loss_u 0.9941 (0.9619) acc_u 0.0000 (5.0000) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [10/36] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.8975 (0.9458) acc_u 9.3750 (6.2500) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/36] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.8892 (0.9297) acc_u 15.6250 (8.5417) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/36] time 0.184 (0.180) data 0.108 (0.103) loss_u loss_u 0.9185 (0.9220) acc_u 9.3750 (9.3750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/36] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.9751 (0.9291) acc_u 3.1250 (8.5000) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [30/36] time 0.189 (0.181) data 0.113 (0.104) loss_u loss_u 0.9404 (0.9232) acc_u 6.2500 (9.1667) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [35/36] time 0.183 (0.181) data 0.107 (0.105) loss_u loss_u 0.9263 (0.9247) acc_u 9.3750 (9.0179) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 589
confident_label rate tensor(0.2800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 448
clean true:338
clean false:110
clean_rate:0.7544642857142857
noisy true:673
noisy false:479
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1152
epoch [197/200] batch [5/14] time 0.173 (0.182) data 0.097 (0.105) loss_x loss_x 0.2651 (0.3758) acc_x 93.7500 (89.3750) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [10/14] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 0.4753 (0.4483) acc_x 90.6250 (88.4375) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/36] time 0.188 (0.173) data 0.111 (0.097) loss_u loss_u 0.8872 (0.9125) acc_u 12.5000 (10.0000) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [10/36] time 0.183 (0.175) data 0.106 (0.099) loss_u loss_u 0.9131 (0.9152) acc_u 12.5000 (10.0000) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [15/36] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.9692 (0.9097) acc_u 3.1250 (10.2083) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/36] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.9824 (0.9225) acc_u 3.1250 (9.0625) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/36] time 0.192 (0.177) data 0.115 (0.100) loss_u loss_u 0.9111 (0.9214) acc_u 9.3750 (9.2500) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [30/36] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.9531 (0.9218) acc_u 6.2500 (9.2708) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [35/36] time 0.180 (0.178) data 0.104 (0.101) loss_u loss_u 0.9292 (0.9232) acc_u 9.3750 (9.0179) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 588
confident_label rate tensor(0.2775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 444
clean true:340
clean false:104
clean_rate:0.7657657657657657
noisy true:672
noisy false:484
after delete: len(clean_dataset) 444
after delete: len(noisy_dataset) 1156
epoch [198/200] batch [5/13] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 0.4812 (0.4368) acc_x 90.6250 (89.3750) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/13] time 0.172 (0.184) data 0.095 (0.107) loss_x loss_x 0.5962 (0.4426) acc_x 81.2500 (89.3750) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/36] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.9131 (0.9347) acc_u 9.3750 (6.8750) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [10/36] time 0.178 (0.181) data 0.102 (0.104) loss_u loss_u 0.8857 (0.9441) acc_u 15.6250 (6.8750) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/36] time 0.185 (0.182) data 0.109 (0.105) loss_u loss_u 0.8848 (0.9400) acc_u 15.6250 (7.5000) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [20/36] time 0.165 (0.182) data 0.087 (0.105) loss_u loss_u 0.8638 (0.9319) acc_u 15.6250 (7.9688) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/36] time 0.175 (0.181) data 0.098 (0.104) loss_u loss_u 1.0000 (0.9351) acc_u 0.0000 (7.6250) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [30/36] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.9272 (0.9333) acc_u 9.3750 (7.8125) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [35/36] time 0.191 (0.181) data 0.113 (0.104) loss_u loss_u 0.9282 (0.9336) acc_u 9.3750 (7.7679) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 580
confident_label rate tensor(0.2712, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 434
clean true:329
clean false:105
clean_rate:0.7580645161290323
noisy true:691
noisy false:475
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1166
epoch [199/200] batch [5/13] time 0.177 (0.180) data 0.100 (0.104) loss_x loss_x 0.2491 (0.4940) acc_x 96.8750 (89.3750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/13] time 0.200 (0.178) data 0.124 (0.101) loss_x loss_x 0.2688 (0.5194) acc_x 93.7500 (87.1875) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/36] time 0.170 (0.176) data 0.092 (0.099) loss_u loss_u 0.9478 (0.9207) acc_u 6.2500 (9.3750) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [10/36] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9741 (0.9318) acc_u 3.1250 (7.5000) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [15/36] time 0.180 (0.178) data 0.103 (0.101) loss_u loss_u 0.9912 (0.9335) acc_u 0.0000 (7.0833) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [20/36] time 0.168 (0.179) data 0.092 (0.102) loss_u loss_u 0.9346 (0.9307) acc_u 9.3750 (7.6562) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/36] time 0.171 (0.178) data 0.094 (0.101) loss_u loss_u 0.9810 (0.9322) acc_u 0.0000 (7.3750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [30/36] time 0.158 (0.177) data 0.082 (0.100) loss_u loss_u 0.9189 (0.9344) acc_u 9.3750 (7.1875) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [35/36] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.9702 (0.9367) acc_u 3.1250 (7.0536) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 616
confident_label rate tensor(0.2769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 443
clean true:330
clean false:113
clean_rate:0.744920993227991
noisy true:654
noisy false:503
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1157
epoch [200/200] batch [5/13] time 0.175 (0.184) data 0.098 (0.107) loss_x loss_x 0.3669 (0.3040) acc_x 93.7500 (92.5000) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/13] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.2195 (0.3747) acc_x 93.7500 (91.2500) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/36] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.8882 (0.9300) acc_u 12.5000 (7.5000) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [10/36] time 0.174 (0.180) data 0.097 (0.103) loss_u loss_u 0.9619 (0.9301) acc_u 6.2500 (7.5000) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/36] time 0.164 (0.178) data 0.088 (0.101) loss_u loss_u 0.8818 (0.9282) acc_u 12.5000 (7.9167) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [20/36] time 0.162 (0.175) data 0.086 (0.098) loss_u loss_u 0.8882 (0.9284) acc_u 12.5000 (8.1250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/36] time 0.162 (0.173) data 0.084 (0.096) loss_u loss_u 0.9800 (0.9329) acc_u 3.1250 (7.7500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [30/36] time 0.164 (0.172) data 0.086 (0.095) loss_u loss_u 0.8584 (0.9301) acc_u 15.6250 (7.9167) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [35/36] time 0.191 (0.172) data 0.107 (0.094) loss_u loss_u 0.9399 (0.9295) acc_u 6.2500 (8.0357) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 1,898
* accuracy: 77.0%
* error: 23.0%
* macro_f1: 68.9%
Elapsed: 0:58:18
