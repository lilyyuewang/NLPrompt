***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.125', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '100']
output_dir: output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.125
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 846
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:659
clean false:3
clean_rate:0.9954682779456193
noisy true:95
noisy false:843
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [1/200] batch [5/20] time 0.190 (0.209) data 0.113 (0.114) loss_x loss_x 2.5039 (2.7105) acc_x 65.6250 (61.2500) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [10/20] time 0.190 (0.197) data 0.113 (0.111) loss_x loss_x 2.3418 (2.6344) acc_x 62.5000 (60.6250) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [15/20] time 0.166 (0.191) data 0.089 (0.108) loss_x loss_x 1.6992 (2.4017) acc_x 68.7500 (65.6250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [20/20] time 0.172 (0.188) data 0.096 (0.107) loss_x loss_x 1.3457 (2.2086) acc_x 78.1250 (67.0312) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/29] time 0.192 (0.189) data 0.116 (0.108) loss_u loss_u 0.9326 (0.8824) acc_u 12.5000 (21.2500) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [10/29] time 0.190 (0.189) data 0.114 (0.109) loss_u loss_u 0.8555 (0.8504) acc_u 28.1250 (26.2500) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [15/29] time 0.173 (0.188) data 0.096 (0.108) loss_u loss_u 0.7964 (0.8314) acc_u 31.2500 (27.7083) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [20/29] time 0.168 (0.187) data 0.090 (0.107) loss_u loss_u 0.8218 (0.8245) acc_u 21.8750 (27.9688) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [25/29] time 0.190 (0.187) data 0.114 (0.108) loss_u loss_u 0.8159 (0.8171) acc_u 28.1250 (29.0000) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 652
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 814
clean true:812
clean false:2
clean_rate:0.9975429975429976
noisy true:136
noisy false:650
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 786
epoch [2/200] batch [5/25] time 0.181 (0.175) data 0.104 (0.099) loss_x loss_x 1.0195 (0.9624) acc_x 75.0000 (76.8750) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [10/25] time 0.169 (0.176) data 0.093 (0.100) loss_x loss_x 0.8804 (0.9796) acc_x 71.8750 (75.0000) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [15/25] time 0.166 (0.174) data 0.090 (0.098) loss_x loss_x 0.8882 (0.9812) acc_x 78.1250 (75.4167) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [20/25] time 0.185 (0.173) data 0.108 (0.097) loss_x loss_x 0.7734 (0.9984) acc_x 81.2500 (74.8438) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [25/25] time 0.183 (0.175) data 0.106 (0.099) loss_x loss_x 0.6318 (0.9444) acc_x 81.2500 (76.2500) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/24] time 0.181 (0.177) data 0.103 (0.100) loss_u loss_u 0.7139 (0.6808) acc_u 34.3750 (35.0000) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [10/24] time 0.188 (0.178) data 0.111 (0.101) loss_u loss_u 0.5918 (0.6801) acc_u 53.1250 (36.8750) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [15/24] time 0.181 (0.179) data 0.103 (0.102) loss_u loss_u 0.6743 (0.6821) acc_u 43.7500 (37.2917) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [20/24] time 0.187 (0.179) data 0.109 (0.103) loss_u loss_u 0.6753 (0.6782) acc_u 43.7500 (37.9688) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.6150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 984
clean true:984
clean false:0
clean_rate:1.0
noisy true:157
noisy false:459
after delete: len(clean_dataset) 984
after delete: len(noisy_dataset) 616
epoch [3/200] batch [5/30] time 0.188 (0.183) data 0.112 (0.106) loss_x loss_x 0.9346 (0.6577) acc_x 84.3750 (84.3750) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/30] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.9839 (0.7156) acc_x 68.7500 (81.8750) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/30] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.6235 (0.7913) acc_x 90.6250 (80.4167) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/30] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.7866 (0.7824) acc_x 75.0000 (80.0000) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [25/30] time 0.157 (0.180) data 0.081 (0.104) loss_x loss_x 1.1094 (0.7843) acc_x 71.8750 (79.5000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [30/30] time 0.158 (0.177) data 0.082 (0.101) loss_x loss_x 1.0127 (0.7888) acc_x 75.0000 (79.3750) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/19] time 0.166 (0.175) data 0.090 (0.099) loss_u loss_u 0.7510 (0.7342) acc_u 31.2500 (34.3750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/19] time 0.159 (0.174) data 0.083 (0.097) loss_u loss_u 0.6851 (0.7161) acc_u 34.3750 (34.0625) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/19] time 0.159 (0.173) data 0.082 (0.096) loss_u loss_u 0.7944 (0.7146) acc_u 21.8750 (33.7500) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 458
confident_label rate tensor(0.6181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 989
clean true:987
clean false:2
clean_rate:0.9979777553083923
noisy true:155
noisy false:456
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 611
epoch [4/200] batch [5/30] time 0.185 (0.187) data 0.109 (0.110) loss_x loss_x 0.6846 (0.7919) acc_x 81.2500 (76.2500) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/30] time 0.203 (0.189) data 0.127 (0.113) loss_x loss_x 0.6191 (0.7643) acc_x 90.6250 (80.0000) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/30] time 0.178 (0.186) data 0.101 (0.109) loss_x loss_x 0.6973 (0.8308) acc_x 78.1250 (78.1250) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/30] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.4763 (0.8002) acc_x 84.3750 (78.4375) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [25/30] time 0.176 (0.184) data 0.099 (0.108) loss_x loss_x 0.4302 (0.7603) acc_x 90.6250 (79.6250) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [30/30] time 0.190 (0.184) data 0.115 (0.107) loss_x loss_x 0.5322 (0.7510) acc_x 81.2500 (79.5833) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/19] time 0.185 (0.184) data 0.109 (0.108) loss_u loss_u 0.7954 (0.7049) acc_u 21.8750 (33.1250) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/19] time 0.200 (0.185) data 0.122 (0.108) loss_u loss_u 0.7593 (0.7280) acc_u 31.2500 (32.1875) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [15/19] time 0.163 (0.184) data 0.086 (0.108) loss_u loss_u 0.7197 (0.7346) acc_u 28.1250 (30.2083) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.6331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1013
clean true:1013
clean false:0
clean_rate:1.0
noisy true:147
noisy false:440
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 587
epoch [5/200] batch [5/31] time 0.168 (0.180) data 0.092 (0.103) loss_x loss_x 0.9302 (0.8101) acc_x 75.0000 (79.3750) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/31] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 1.1562 (0.7587) acc_x 62.5000 (80.0000) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/31] time 0.161 (0.178) data 0.084 (0.101) loss_x loss_x 0.4438 (0.7221) acc_x 75.0000 (79.5833) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/31] time 0.167 (0.176) data 0.091 (0.099) loss_x loss_x 0.6636 (0.7062) acc_x 78.1250 (80.3125) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [25/31] time 0.163 (0.174) data 0.087 (0.098) loss_x loss_x 1.2598 (0.7314) acc_x 68.7500 (80.0000) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [30/31] time 0.167 (0.173) data 0.090 (0.096) loss_x loss_x 0.7783 (0.7641) acc_x 75.0000 (78.8542) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/18] time 0.180 (0.172) data 0.103 (0.095) loss_u loss_u 0.8306 (0.7352) acc_u 21.8750 (30.6250) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/18] time 0.176 (0.172) data 0.099 (0.096) loss_u loss_u 0.7441 (0.7413) acc_u 28.1250 (30.3125) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/18] time 0.175 (0.173) data 0.097 (0.096) loss_u loss_u 0.8228 (0.7333) acc_u 18.7500 (31.0417) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 451
confident_label rate tensor(0.6237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 998
clean true:998
clean false:0
clean_rate:1.0
noisy true:151
noisy false:451
after delete: len(clean_dataset) 998
after delete: len(noisy_dataset) 602
epoch [6/200] batch [5/31] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 1.2285 (0.7780) acc_x 75.0000 (80.6250) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/31] time 0.180 (0.179) data 0.104 (0.102) loss_x loss_x 0.8857 (0.7791) acc_x 71.8750 (78.1250) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/31] time 0.160 (0.180) data 0.083 (0.103) loss_x loss_x 0.9697 (0.7951) acc_x 65.6250 (77.5000) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/31] time 0.180 (0.177) data 0.104 (0.100) loss_x loss_x 1.0469 (0.7654) acc_x 78.1250 (78.7500) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [25/31] time 0.175 (0.177) data 0.099 (0.101) loss_x loss_x 0.6494 (0.7298) acc_x 75.0000 (79.5000) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [30/31] time 0.163 (0.175) data 0.086 (0.099) loss_x loss_x 0.6299 (0.7188) acc_x 81.2500 (79.7917) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/18] time 0.170 (0.176) data 0.094 (0.100) loss_u loss_u 0.6558 (0.6949) acc_u 34.3750 (33.1250) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/18] time 0.188 (0.176) data 0.112 (0.100) loss_u loss_u 0.7080 (0.6833) acc_u 31.2500 (35.6250) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [15/18] time 0.184 (0.177) data 0.108 (0.101) loss_u loss_u 0.7295 (0.6990) acc_u 34.3750 (34.7917) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.6456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1033
clean true:1032
clean false:1
clean_rate:0.9990319457889641
noisy true:151
noisy false:416
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 567
epoch [7/200] batch [5/32] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.7354 (0.5636) acc_x 81.2500 (83.7500) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/32] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.5049 (0.6273) acc_x 87.5000 (80.9375) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [15/32] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.7476 (0.5928) acc_x 78.1250 (82.9167) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/32] time 0.185 (0.183) data 0.107 (0.107) loss_x loss_x 0.5752 (0.6274) acc_x 84.3750 (81.8750) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [25/32] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 1.0674 (0.6596) acc_x 75.0000 (81.7500) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [30/32] time 0.189 (0.183) data 0.113 (0.107) loss_x loss_x 0.8369 (0.6762) acc_x 78.1250 (81.4583) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/17] time 0.165 (0.181) data 0.088 (0.104) loss_u loss_u 0.6504 (0.6863) acc_u 40.6250 (37.5000) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/17] time 0.177 (0.181) data 0.099 (0.104) loss_u loss_u 0.8623 (0.7112) acc_u 12.5000 (34.6875) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [15/17] time 0.179 (0.181) data 0.103 (0.105) loss_u loss_u 0.8042 (0.7139) acc_u 28.1250 (33.9583) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 434
confident_label rate tensor(0.6356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1017
clean true:1017
clean false:0
clean_rate:1.0
noisy true:149
noisy false:434
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 583
epoch [8/200] batch [5/31] time 0.186 (0.184) data 0.109 (0.108) loss_x loss_x 0.8618 (0.6203) acc_x 87.5000 (86.2500) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/31] time 0.169 (0.180) data 0.092 (0.103) loss_x loss_x 0.5273 (0.6549) acc_x 87.5000 (82.8125) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/31] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.7197 (0.6614) acc_x 90.6250 (83.5417) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/31] time 0.176 (0.183) data 0.101 (0.106) loss_x loss_x 0.9463 (0.6600) acc_x 84.3750 (83.7500) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [25/31] time 0.186 (0.183) data 0.111 (0.107) loss_x loss_x 0.6118 (0.6304) acc_x 81.2500 (84.5000) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [30/31] time 0.179 (0.183) data 0.103 (0.106) loss_x loss_x 0.5000 (0.6372) acc_x 84.3750 (84.1667) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/18] time 0.166 (0.181) data 0.090 (0.105) loss_u loss_u 0.8452 (0.7233) acc_u 21.8750 (33.1250) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/18] time 0.163 (0.179) data 0.086 (0.103) loss_u loss_u 0.7993 (0.7245) acc_u 25.0000 (31.8750) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/18] time 0.173 (0.179) data 0.097 (0.102) loss_u loss_u 0.6304 (0.7149) acc_u 46.8750 (32.5000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 438
confident_label rate tensor(0.6319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1011
clean true:1011
clean false:0
clean_rate:1.0
noisy true:151
noisy false:438
after delete: len(clean_dataset) 1011
after delete: len(noisy_dataset) 589
epoch [9/200] batch [5/31] time 0.170 (0.163) data 0.092 (0.086) loss_x loss_x 0.5430 (0.6495) acc_x 87.5000 (81.2500) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/31] time 0.175 (0.169) data 0.098 (0.093) loss_x loss_x 0.7490 (0.6399) acc_x 78.1250 (81.5625) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/31] time 0.186 (0.173) data 0.110 (0.096) loss_x loss_x 0.4998 (0.6445) acc_x 81.2500 (81.4583) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/31] time 0.182 (0.175) data 0.104 (0.099) loss_x loss_x 1.0605 (0.6676) acc_x 68.7500 (80.3125) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [25/31] time 0.187 (0.177) data 0.110 (0.101) loss_x loss_x 0.6958 (0.6476) acc_x 84.3750 (81.7500) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [30/31] time 0.181 (0.178) data 0.105 (0.102) loss_x loss_x 0.7856 (0.6412) acc_x 78.1250 (81.7708) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/18] time 0.159 (0.178) data 0.081 (0.101) loss_u loss_u 0.7871 (0.7003) acc_u 21.8750 (33.1250) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/18] time 0.173 (0.177) data 0.097 (0.100) loss_u loss_u 0.7183 (0.7035) acc_u 28.1250 (31.8750) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [15/18] time 0.175 (0.176) data 0.098 (0.100) loss_u loss_u 0.6167 (0.7165) acc_u 53.1250 (31.8750) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.6488, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1038
clean true:1037
clean false:1
clean_rate:0.9990366088631984
noisy true:148
noisy false:414
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 562
epoch [10/200] batch [5/32] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.5044 (0.6272) acc_x 84.3750 (83.7500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/32] time 0.174 (0.173) data 0.098 (0.097) loss_x loss_x 0.7510 (0.7735) acc_x 75.0000 (79.6875) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [15/32] time 0.171 (0.175) data 0.095 (0.098) loss_x loss_x 0.6641 (0.7481) acc_x 87.5000 (79.7917) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [20/32] time 0.158 (0.172) data 0.082 (0.096) loss_x loss_x 1.1055 (0.7879) acc_x 75.0000 (79.6875) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [25/32] time 0.182 (0.175) data 0.106 (0.099) loss_x loss_x 0.5649 (0.7898) acc_x 78.1250 (79.6250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [30/32] time 0.163 (0.175) data 0.087 (0.099) loss_x loss_x 0.4768 (0.7777) acc_x 87.5000 (79.8958) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/17] time 0.180 (0.176) data 0.100 (0.099) loss_u loss_u 0.6836 (0.6969) acc_u 37.5000 (33.1250) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/17] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.7290 (0.6977) acc_u 31.2500 (33.7500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [15/17] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.7275 (0.7042) acc_u 34.3750 (33.7500) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 434
confident_label rate tensor(0.6331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1013
clean true:1013
clean false:0
clean_rate:1.0
noisy true:153
noisy false:434
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 587
epoch [11/200] batch [5/31] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.6621 (0.5969) acc_x 84.3750 (85.0000) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/31] time 0.173 (0.178) data 0.096 (0.100) loss_x loss_x 0.9688 (0.6871) acc_x 78.1250 (83.1250) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/31] time 0.190 (0.178) data 0.114 (0.101) loss_x loss_x 0.5981 (0.6932) acc_x 84.3750 (82.9167) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/31] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 1.1348 (0.6808) acc_x 65.6250 (82.5000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [25/31] time 0.186 (0.177) data 0.110 (0.100) loss_x loss_x 0.4111 (0.6456) acc_x 87.5000 (82.8750) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [30/31] time 0.183 (0.178) data 0.106 (0.102) loss_x loss_x 0.8584 (0.6693) acc_x 81.2500 (82.5000) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/18] time 0.179 (0.179) data 0.102 (0.102) loss_u loss_u 0.7642 (0.7258) acc_u 25.0000 (30.0000) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/18] time 0.177 (0.179) data 0.100 (0.103) loss_u loss_u 0.6646 (0.7081) acc_u 37.5000 (32.5000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/18] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.7480 (0.7028) acc_u 28.1250 (32.5000) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.6494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1039
clean true:1038
clean false:1
clean_rate:0.9990375360923965
noisy true:150
noisy false:411
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 561
epoch [12/200] batch [5/32] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.5659 (0.7860) acc_x 81.2500 (76.8750) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/32] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5586 (0.7736) acc_x 87.5000 (78.1250) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [15/32] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.6201 (0.7160) acc_x 84.3750 (80.2083) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [20/32] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.4604 (0.6822) acc_x 84.3750 (80.7812) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [25/32] time 0.186 (0.184) data 0.109 (0.108) loss_x loss_x 0.6982 (0.6625) acc_x 75.0000 (81.7500) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [30/32] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.9072 (0.6942) acc_x 71.8750 (80.9375) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/17] time 0.190 (0.184) data 0.113 (0.107) loss_u loss_u 0.6592 (0.7276) acc_u 37.5000 (29.3750) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/17] time 0.170 (0.183) data 0.093 (0.107) loss_u loss_u 0.7334 (0.7187) acc_u 28.1250 (31.5625) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [15/17] time 0.178 (0.182) data 0.101 (0.106) loss_u loss_u 0.6035 (0.7202) acc_u 46.8750 (31.0417) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.6488, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1038
clean true:1038
clean false:0
clean_rate:1.0
noisy true:150
noisy false:412
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 562
epoch [13/200] batch [5/32] time 0.170 (0.177) data 0.092 (0.100) loss_x loss_x 0.8770 (0.7756) acc_x 81.2500 (80.0000) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/32] time 0.176 (0.175) data 0.100 (0.098) loss_x loss_x 0.9111 (0.7526) acc_x 81.2500 (80.0000) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [15/32] time 0.177 (0.176) data 0.100 (0.100) loss_x loss_x 0.9277 (0.7171) acc_x 75.0000 (81.2500) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/32] time 0.162 (0.173) data 0.085 (0.097) loss_x loss_x 0.7383 (0.7225) acc_x 78.1250 (81.0938) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [25/32] time 0.178 (0.174) data 0.102 (0.098) loss_x loss_x 0.3752 (0.7449) acc_x 87.5000 (80.0000) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [30/32] time 0.180 (0.175) data 0.104 (0.099) loss_x loss_x 0.2751 (0.7230) acc_x 90.6250 (80.7292) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/17] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.6875 (0.6934) acc_u 40.6250 (36.8750) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/17] time 0.184 (0.177) data 0.106 (0.101) loss_u loss_u 0.6812 (0.6646) acc_u 40.6250 (39.6875) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [15/17] time 0.165 (0.177) data 0.087 (0.100) loss_u loss_u 0.7705 (0.6978) acc_u 28.1250 (34.7917) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.6513, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1042
clean true:1042
clean false:0
clean_rate:1.0
noisy true:155
noisy false:403
after delete: len(clean_dataset) 1042
after delete: len(noisy_dataset) 558
epoch [14/200] batch [5/32] time 0.173 (0.182) data 0.095 (0.105) loss_x loss_x 0.5977 (0.6370) acc_x 84.3750 (83.7500) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/32] time 0.186 (0.182) data 0.110 (0.106) loss_x loss_x 0.3577 (0.5835) acc_x 90.6250 (84.6875) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [15/32] time 0.186 (0.177) data 0.110 (0.101) loss_x loss_x 0.9214 (0.5919) acc_x 75.0000 (84.1667) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [20/32] time 0.164 (0.178) data 0.087 (0.101) loss_x loss_x 0.5913 (0.6147) acc_x 84.3750 (83.7500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [25/32] time 0.181 (0.177) data 0.105 (0.101) loss_x loss_x 0.3411 (0.6183) acc_x 96.8750 (83.5000) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [30/32] time 0.166 (0.176) data 0.089 (0.100) loss_x loss_x 0.4890 (0.6098) acc_x 81.2500 (83.5417) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/17] time 0.175 (0.175) data 0.097 (0.098) loss_u loss_u 0.7466 (0.7540) acc_u 28.1250 (28.1250) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/17] time 0.164 (0.174) data 0.088 (0.098) loss_u loss_u 0.7153 (0.7131) acc_u 40.6250 (34.0625) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [15/17] time 0.165 (0.173) data 0.088 (0.097) loss_u loss_u 0.7754 (0.7238) acc_u 25.0000 (32.7083) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.6488, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1038
clean true:1036
clean false:2
clean_rate:0.9980732177263969
noisy true:150
noisy false:412
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 562
epoch [15/200] batch [5/32] time 0.184 (0.188) data 0.108 (0.112) loss_x loss_x 0.5996 (0.6991) acc_x 84.3750 (83.1250) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/32] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.3076 (0.6622) acc_x 87.5000 (83.7500) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [15/32] time 0.182 (0.186) data 0.106 (0.109) loss_x loss_x 1.1953 (0.7149) acc_x 71.8750 (81.8750) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [20/32] time 0.185 (0.185) data 0.108 (0.109) loss_x loss_x 0.3638 (0.6686) acc_x 87.5000 (82.6562) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [25/32] time 0.189 (0.185) data 0.112 (0.109) loss_x loss_x 0.4177 (0.7101) acc_x 93.7500 (82.0000) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [30/32] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.4172 (0.7070) acc_x 93.7500 (81.8750) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/17] time 0.183 (0.185) data 0.107 (0.108) loss_u loss_u 0.6748 (0.7131) acc_u 40.6250 (31.2500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/17] time 0.187 (0.185) data 0.109 (0.108) loss_u loss_u 0.7544 (0.7188) acc_u 25.0000 (30.3125) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [15/17] time 0.181 (0.185) data 0.104 (0.108) loss_u loss_u 0.7930 (0.7179) acc_u 28.1250 (30.6250) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.6637, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1062
clean true:1061
clean false:1
clean_rate:0.9990583804143126
noisy true:151
noisy false:387
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 538
epoch [16/200] batch [5/33] time 0.184 (0.179) data 0.107 (0.103) loss_x loss_x 0.6416 (0.5675) acc_x 78.1250 (84.3750) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/33] time 0.188 (0.183) data 0.111 (0.107) loss_x loss_x 0.8438 (0.7032) acc_x 81.2500 (81.2500) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [15/33] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.5718 (0.6473) acc_x 87.5000 (82.5000) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [20/33] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.6621 (0.6141) acc_x 81.2500 (83.7500) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [25/33] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.9766 (0.6539) acc_x 84.3750 (83.2500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [30/33] time 0.173 (0.184) data 0.096 (0.107) loss_x loss_x 0.9468 (0.6708) acc_x 71.8750 (82.8125) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/16] time 0.174 (0.182) data 0.097 (0.105) loss_u loss_u 0.6196 (0.6632) acc_u 43.7500 (38.1250) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/16] time 0.167 (0.181) data 0.089 (0.104) loss_u loss_u 0.7715 (0.6970) acc_u 28.1250 (35.0000) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [15/16] time 0.166 (0.180) data 0.088 (0.102) loss_u loss_u 0.7578 (0.7258) acc_u 28.1250 (31.4583) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.6500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1040
clean true:1040
clean false:0
clean_rate:1.0
noisy true:144
noisy false:416
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 560
epoch [17/200] batch [5/32] time 0.186 (0.179) data 0.107 (0.102) loss_x loss_x 0.5171 (0.5808) acc_x 87.5000 (84.3750) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [10/32] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.3945 (0.5577) acc_x 93.7500 (85.6250) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/32] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.6133 (0.6279) acc_x 81.2500 (83.9583) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/32] time 0.184 (0.174) data 0.106 (0.097) loss_x loss_x 0.2200 (0.5887) acc_x 93.7500 (84.5312) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [25/32] time 0.185 (0.175) data 0.109 (0.098) loss_x loss_x 0.8770 (0.6130) acc_x 71.8750 (83.1250) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [30/32] time 0.188 (0.176) data 0.111 (0.099) loss_x loss_x 0.3174 (0.6106) acc_x 90.6250 (82.8125) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/17] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.7441 (0.6955) acc_u 28.1250 (33.1250) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/17] time 0.166 (0.178) data 0.089 (0.101) loss_u loss_u 0.7534 (0.7284) acc_u 28.1250 (31.2500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [15/17] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.5767 (0.7186) acc_u 56.2500 (32.7083) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.6600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1056
clean true:1056
clean false:0
clean_rate:1.0
noisy true:153
noisy false:391
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 544
epoch [18/200] batch [5/33] time 0.180 (0.171) data 0.104 (0.094) loss_x loss_x 0.7437 (0.5683) acc_x 75.0000 (82.5000) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [10/33] time 0.167 (0.172) data 0.091 (0.095) loss_x loss_x 0.8760 (0.6812) acc_x 81.2500 (80.9375) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/33] time 0.181 (0.172) data 0.106 (0.095) loss_x loss_x 0.7402 (0.6766) acc_x 84.3750 (81.6667) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [20/33] time 0.174 (0.174) data 0.097 (0.097) loss_x loss_x 0.5898 (0.7086) acc_x 87.5000 (81.7188) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [25/33] time 0.179 (0.174) data 0.103 (0.098) loss_x loss_x 1.4131 (0.7229) acc_x 68.7500 (82.0000) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [30/33] time 0.183 (0.176) data 0.106 (0.100) loss_x loss_x 0.6255 (0.7076) acc_x 78.1250 (81.5625) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/17] time 0.176 (0.177) data 0.097 (0.100) loss_u loss_u 0.5957 (0.6985) acc_u 40.6250 (33.1250) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/17] time 0.179 (0.177) data 0.102 (0.101) loss_u loss_u 0.7520 (0.7100) acc_u 31.2500 (32.1875) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [15/17] time 0.177 (0.177) data 0.101 (0.100) loss_u loss_u 0.6685 (0.7061) acc_u 40.6250 (32.9167) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.6625, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1060
clean true:1057
clean false:3
clean_rate:0.9971698113207547
noisy true:151
noisy false:389
after delete: len(clean_dataset) 1060
after delete: len(noisy_dataset) 540
epoch [19/200] batch [5/33] time 0.189 (0.187) data 0.110 (0.110) loss_x loss_x 0.3186 (0.6254) acc_x 90.6250 (85.0000) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [10/33] time 0.158 (0.179) data 0.082 (0.102) loss_x loss_x 1.0068 (0.6496) acc_x 75.0000 (82.8125) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [15/33] time 0.187 (0.176) data 0.111 (0.099) loss_x loss_x 0.8330 (0.6315) acc_x 78.1250 (83.1250) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [20/33] time 0.163 (0.176) data 0.086 (0.100) loss_x loss_x 0.2908 (0.5664) acc_x 93.7500 (84.8438) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [25/33] time 0.174 (0.176) data 0.098 (0.099) loss_x loss_x 0.5454 (0.5707) acc_x 90.6250 (84.8750) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [30/33] time 0.192 (0.177) data 0.115 (0.101) loss_x loss_x 1.0732 (0.5868) acc_x 68.7500 (84.2708) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/16] time 0.184 (0.179) data 0.108 (0.102) loss_u loss_u 0.7471 (0.7066) acc_u 25.0000 (35.0000) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/16] time 0.180 (0.179) data 0.103 (0.103) loss_u loss_u 0.6865 (0.6810) acc_u 34.3750 (36.5625) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [15/16] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.7603 (0.6982) acc_u 28.1250 (34.5833) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.6781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1085
clean true:1084
clean false:1
clean_rate:0.9990783410138249
noisy true:150
noisy false:365
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 515
epoch [20/200] batch [5/33] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.5786 (0.4874) acc_x 87.5000 (88.7500) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [10/33] time 0.181 (0.181) data 0.103 (0.104) loss_x loss_x 0.6284 (0.5283) acc_x 84.3750 (87.1875) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/33] time 0.190 (0.182) data 0.112 (0.105) loss_x loss_x 0.5562 (0.5315) acc_x 84.3750 (86.4583) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [20/33] time 0.175 (0.182) data 0.098 (0.106) loss_x loss_x 0.5151 (0.5330) acc_x 81.2500 (85.7812) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [25/33] time 0.170 (0.181) data 0.093 (0.104) loss_x loss_x 1.0527 (0.5813) acc_x 75.0000 (84.7500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [30/33] time 0.164 (0.178) data 0.087 (0.102) loss_x loss_x 0.7866 (0.5806) acc_x 78.1250 (84.6875) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/16] time 0.165 (0.176) data 0.089 (0.099) loss_u loss_u 0.6787 (0.7048) acc_u 40.6250 (36.2500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [10/16] time 0.174 (0.175) data 0.097 (0.098) loss_u loss_u 0.8169 (0.7102) acc_u 18.7500 (34.3750) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [15/16] time 0.180 (0.175) data 0.102 (0.098) loss_u loss_u 0.7505 (0.7014) acc_u 28.1250 (35.2083) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.6831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1093
clean true:1092
clean false:1
clean_rate:0.9990850869167429
noisy true:144
noisy false:363
after delete: len(clean_dataset) 1093
after delete: len(noisy_dataset) 507
epoch [21/200] batch [5/34] time 0.173 (0.178) data 0.096 (0.102) loss_x loss_x 0.5898 (0.7910) acc_x 87.5000 (76.8750) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [10/34] time 0.178 (0.175) data 0.102 (0.098) loss_x loss_x 0.8208 (0.7800) acc_x 78.1250 (79.6875) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [15/34] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.6045 (0.7269) acc_x 84.3750 (81.4583) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/34] time 0.178 (0.175) data 0.102 (0.098) loss_x loss_x 0.5996 (0.6903) acc_x 81.2500 (82.3438) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [25/34] time 0.163 (0.173) data 0.086 (0.096) loss_x loss_x 0.3813 (0.6776) acc_x 87.5000 (82.2500) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [30/34] time 0.174 (0.173) data 0.097 (0.096) loss_x loss_x 1.0430 (0.6775) acc_x 71.8750 (82.1875) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/15] time 0.191 (0.175) data 0.112 (0.098) loss_u loss_u 0.7710 (0.7137) acc_u 28.1250 (31.8750) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [10/15] time 0.170 (0.175) data 0.092 (0.098) loss_u loss_u 0.6377 (0.7069) acc_u 40.6250 (32.1875) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [15/15] time 0.185 (0.175) data 0.109 (0.098) loss_u loss_u 0.7959 (0.7173) acc_u 28.1250 (31.4583) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.6819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1091
clean true:1090
clean false:1
clean_rate:0.999083409715857
noisy true:149
noisy false:360
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 509
epoch [22/200] batch [5/34] time 0.181 (0.170) data 0.104 (0.094) loss_x loss_x 0.7324 (0.7493) acc_x 87.5000 (80.0000) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/34] time 0.159 (0.170) data 0.082 (0.094) loss_x loss_x 0.5200 (0.6856) acc_x 81.2500 (81.5625) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [15/34] time 0.190 (0.174) data 0.112 (0.097) loss_x loss_x 0.6362 (0.6462) acc_x 78.1250 (82.2917) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [20/34] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.8120 (0.6656) acc_x 78.1250 (82.1875) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [25/34] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.6426 (0.6435) acc_x 87.5000 (82.3750) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [30/34] time 0.185 (0.181) data 0.107 (0.104) loss_x loss_x 0.7036 (0.6714) acc_x 78.1250 (81.8750) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/15] time 0.186 (0.182) data 0.110 (0.105) loss_u loss_u 0.7388 (0.7330) acc_u 31.2500 (31.8750) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [10/15] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.7480 (0.7555) acc_u 34.3750 (29.6875) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [15/15] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.6484 (0.7321) acc_u 40.6250 (32.0833) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.6769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1083
clean true:1082
clean false:1
clean_rate:0.9990766389658357
noisy true:157
noisy false:360
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 517
epoch [23/200] batch [5/33] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.5322 (0.5386) acc_x 87.5000 (87.5000) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [10/33] time 0.170 (0.186) data 0.094 (0.109) loss_x loss_x 1.1416 (0.6095) acc_x 75.0000 (85.3125) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [15/33] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.5068 (0.5883) acc_x 78.1250 (83.5417) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/33] time 0.184 (0.178) data 0.108 (0.101) loss_x loss_x 0.8223 (0.6027) acc_x 78.1250 (83.9062) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [25/33] time 0.180 (0.178) data 0.104 (0.102) loss_x loss_x 0.7080 (0.6087) acc_x 87.5000 (84.0000) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [30/33] time 0.182 (0.178) data 0.105 (0.102) loss_x loss_x 0.5361 (0.6365) acc_x 84.3750 (82.9167) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/16] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.7397 (0.6702) acc_u 28.1250 (36.8750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/16] time 0.176 (0.178) data 0.099 (0.102) loss_u loss_u 0.6606 (0.6968) acc_u 37.5000 (34.3750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [15/16] time 0.178 (0.178) data 0.101 (0.102) loss_u loss_u 0.7168 (0.6978) acc_u 31.2500 (34.7917) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.6856, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1097
clean true:1097
clean false:0
clean_rate:1.0
noisy true:152
noisy false:351
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 503
epoch [24/200] batch [5/34] time 0.183 (0.181) data 0.105 (0.104) loss_x loss_x 0.9673 (0.7857) acc_x 75.0000 (80.0000) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/34] time 0.176 (0.176) data 0.099 (0.099) loss_x loss_x 0.8750 (0.7707) acc_x 78.1250 (81.2500) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [15/34] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 0.9238 (0.7318) acc_x 81.2500 (82.5000) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [20/34] time 0.186 (0.176) data 0.109 (0.099) loss_x loss_x 0.6836 (0.6786) acc_x 84.3750 (83.5938) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [25/34] time 0.183 (0.177) data 0.107 (0.101) loss_x loss_x 1.1934 (0.7151) acc_x 68.7500 (82.3750) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [30/34] time 0.186 (0.178) data 0.110 (0.102) loss_x loss_x 0.3186 (0.6693) acc_x 93.7500 (83.5417) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/15] time 0.182 (0.180) data 0.106 (0.103) loss_u loss_u 0.6611 (0.6860) acc_u 34.3750 (34.3750) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [10/15] time 0.180 (0.180) data 0.104 (0.103) loss_u loss_u 0.7568 (0.7169) acc_u 31.2500 (30.0000) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [15/15] time 0.190 (0.180) data 0.114 (0.104) loss_u loss_u 0.7163 (0.7088) acc_u 37.5000 (32.5000) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.6831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1093
clean true:1093
clean false:0
clean_rate:1.0
noisy true:154
noisy false:353
after delete: len(clean_dataset) 1093
after delete: len(noisy_dataset) 507
epoch [25/200] batch [5/34] time 0.187 (0.186) data 0.110 (0.108) loss_x loss_x 0.5981 (0.6851) acc_x 81.2500 (80.0000) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [10/34] time 0.161 (0.181) data 0.084 (0.104) loss_x loss_x 0.9336 (0.7072) acc_x 75.0000 (79.6875) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [15/34] time 0.160 (0.179) data 0.084 (0.102) loss_x loss_x 0.4177 (0.7062) acc_x 90.6250 (80.0000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [20/34] time 0.161 (0.175) data 0.084 (0.098) loss_x loss_x 0.9102 (0.7237) acc_x 75.0000 (80.1562) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [25/34] time 0.164 (0.173) data 0.088 (0.096) loss_x loss_x 0.3667 (0.6991) acc_x 90.6250 (81.1250) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [30/34] time 0.182 (0.174) data 0.105 (0.098) loss_x loss_x 0.6836 (0.6734) acc_x 75.0000 (81.7708) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/15] time 0.186 (0.176) data 0.109 (0.100) loss_u loss_u 0.6426 (0.6709) acc_u 40.6250 (35.6250) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [10/15] time 0.165 (0.176) data 0.087 (0.099) loss_u loss_u 0.6753 (0.7038) acc_u 37.5000 (33.4375) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [15/15] time 0.171 (0.175) data 0.093 (0.098) loss_u loss_u 0.6143 (0.6791) acc_u 40.6250 (36.2500) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.6781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1085
clean true:1084
clean false:1
clean_rate:0.9990783410138249
noisy true:159
noisy false:356
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 515
epoch [26/200] batch [5/33] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.7446 (0.4293) acc_x 81.2500 (88.7500) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [10/33] time 0.166 (0.172) data 0.089 (0.096) loss_x loss_x 0.2839 (0.4825) acc_x 93.7500 (88.1250) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [15/33] time 0.177 (0.176) data 0.101 (0.100) loss_x loss_x 1.0000 (0.5515) acc_x 71.8750 (85.6250) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [20/33] time 0.184 (0.175) data 0.108 (0.099) loss_x loss_x 0.1162 (0.5511) acc_x 93.7500 (85.0000) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [25/33] time 0.164 (0.173) data 0.088 (0.097) loss_x loss_x 0.1958 (0.5622) acc_x 96.8750 (85.2500) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [30/33] time 0.167 (0.172) data 0.090 (0.096) loss_x loss_x 0.9814 (0.5918) acc_x 71.8750 (84.1667) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/16] time 0.166 (0.171) data 0.089 (0.095) loss_u loss_u 0.6187 (0.7032) acc_u 43.7500 (33.7500) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/16] time 0.171 (0.171) data 0.094 (0.094) loss_u loss_u 0.6934 (0.7063) acc_u 40.6250 (32.8125) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/16] time 0.163 (0.171) data 0.086 (0.094) loss_u loss_u 0.7173 (0.7003) acc_u 28.1250 (33.7500) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.6762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1082
clean true:1082
clean false:0
clean_rate:1.0
noisy true:150
noisy false:368
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 518
epoch [27/200] batch [5/33] time 0.170 (0.180) data 0.093 (0.104) loss_x loss_x 0.4717 (0.6991) acc_x 84.3750 (81.8750) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [10/33] time 0.160 (0.173) data 0.083 (0.097) loss_x loss_x 0.4961 (0.6975) acc_x 93.7500 (83.1250) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [15/33] time 0.173 (0.172) data 0.096 (0.095) loss_x loss_x 0.5234 (0.6263) acc_x 84.3750 (84.1667) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [20/33] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.3962 (0.6020) acc_x 87.5000 (85.0000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [25/33] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.5820 (0.6074) acc_x 81.2500 (84.3750) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [30/33] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 0.2991 (0.5869) acc_x 96.8750 (84.8958) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/16] time 0.162 (0.170) data 0.084 (0.093) loss_u loss_u 0.7236 (0.6933) acc_u 34.3750 (35.0000) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [10/16] time 0.168 (0.171) data 0.090 (0.094) loss_u loss_u 0.6333 (0.6741) acc_u 37.5000 (36.5625) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/16] time 0.175 (0.171) data 0.097 (0.094) loss_u loss_u 0.7212 (0.6827) acc_u 28.1250 (35.6250) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.6762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1082
clean true:1082
clean false:0
clean_rate:1.0
noisy true:157
noisy false:361
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 518
epoch [28/200] batch [5/33] time 0.175 (0.171) data 0.099 (0.095) loss_x loss_x 0.3428 (0.5187) acc_x 90.6250 (85.0000) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/33] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 1.0693 (0.6751) acc_x 75.0000 (83.4375) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/33] time 0.172 (0.170) data 0.095 (0.094) loss_x loss_x 0.5278 (0.6262) acc_x 84.3750 (83.7500) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [20/33] time 0.165 (0.170) data 0.087 (0.093) loss_x loss_x 0.8198 (0.6095) acc_x 81.2500 (84.2188) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [25/33] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 0.8301 (0.6368) acc_x 81.2500 (83.6250) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [30/33] time 0.175 (0.171) data 0.099 (0.094) loss_x loss_x 0.3684 (0.6266) acc_x 84.3750 (83.5417) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/16] time 0.168 (0.171) data 0.090 (0.094) loss_u loss_u 0.7222 (0.6948) acc_u 34.3750 (35.6250) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [10/16] time 0.169 (0.171) data 0.091 (0.094) loss_u loss_u 0.6992 (0.6804) acc_u 34.3750 (36.5625) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/16] time 0.166 (0.171) data 0.089 (0.094) loss_u loss_u 0.7441 (0.6797) acc_u 28.1250 (36.2500) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.6837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1094
clean true:1093
clean false:1
clean_rate:0.9990859232175503
noisy true:155
noisy false:351
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 506
epoch [29/200] batch [5/34] time 0.185 (0.183) data 0.110 (0.107) loss_x loss_x 0.2240 (0.5010) acc_x 93.7500 (88.1250) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [10/34] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.5879 (0.4772) acc_x 84.3750 (86.8750) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [15/34] time 0.166 (0.182) data 0.090 (0.105) loss_x loss_x 0.9712 (0.6033) acc_x 75.0000 (84.1667) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [20/34] time 0.165 (0.177) data 0.089 (0.100) loss_x loss_x 1.1133 (0.6256) acc_x 68.7500 (82.6562) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [25/34] time 0.168 (0.174) data 0.090 (0.098) loss_x loss_x 0.8589 (0.6222) acc_x 81.2500 (82.6250) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [30/34] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 0.7944 (0.6266) acc_x 78.1250 (83.1250) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/15] time 0.164 (0.171) data 0.087 (0.094) loss_u loss_u 0.7588 (0.7581) acc_u 25.0000 (27.5000) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/15] time 0.166 (0.170) data 0.089 (0.093) loss_u loss_u 0.5332 (0.7016) acc_u 50.0000 (32.8125) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [15/15] time 0.166 (0.170) data 0.088 (0.093) loss_u loss_u 0.7256 (0.7067) acc_u 31.2500 (32.0833) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.6794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1087
clean true:1086
clean false:1
clean_rate:0.9990800367985281
noisy true:149
noisy false:364
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 513
epoch [30/200] batch [5/33] time 0.186 (0.185) data 0.110 (0.109) loss_x loss_x 0.5679 (0.6933) acc_x 84.3750 (82.5000) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/33] time 0.183 (0.184) data 0.108 (0.108) loss_x loss_x 0.7041 (0.6602) acc_x 81.2500 (83.4375) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/33] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.8486 (0.6124) acc_x 71.8750 (83.3333) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [20/33] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.6587 (0.6045) acc_x 81.2500 (83.2812) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [25/33] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.7476 (0.6037) acc_x 75.0000 (82.8750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [30/33] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.2966 (0.6111) acc_x 90.6250 (82.9167) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/16] time 0.166 (0.182) data 0.087 (0.106) loss_u loss_u 0.6460 (0.6537) acc_u 37.5000 (36.2500) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/16] time 0.176 (0.181) data 0.098 (0.105) loss_u loss_u 0.6729 (0.6681) acc_u 34.3750 (36.5625) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/16] time 0.163 (0.179) data 0.085 (0.103) loss_u loss_u 0.7354 (0.6960) acc_u 31.2500 (33.7500) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.6994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1119
clean true:1119
clean false:0
clean_rate:1.0
noisy true:149
noisy false:332
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 481
epoch [31/200] batch [5/34] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.4976 (0.6210) acc_x 87.5000 (83.1250) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [10/34] time 0.188 (0.185) data 0.111 (0.108) loss_x loss_x 0.4016 (0.5716) acc_x 90.6250 (83.7500) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [15/34] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.6245 (0.6200) acc_x 78.1250 (82.7083) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [20/34] time 0.180 (0.185) data 0.103 (0.108) loss_x loss_x 0.2922 (0.5763) acc_x 90.6250 (83.9062) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [25/34] time 0.169 (0.181) data 0.093 (0.104) loss_x loss_x 0.6465 (0.6066) acc_x 81.2500 (83.5000) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [30/34] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.3923 (0.5776) acc_x 87.5000 (84.6875) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/15] time 0.182 (0.182) data 0.106 (0.106) loss_u loss_u 0.7939 (0.7776) acc_u 25.0000 (26.8750) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [10/15] time 0.185 (0.182) data 0.106 (0.106) loss_u loss_u 0.6694 (0.7164) acc_u 37.5000 (33.4375) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [15/15] time 0.187 (0.183) data 0.111 (0.106) loss_u loss_u 0.6396 (0.7124) acc_u 40.6250 (33.1250) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.7012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1122
clean true:1121
clean false:1
clean_rate:0.9991087344028521
noisy true:154
noisy false:324
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 478
epoch [32/200] batch [5/35] time 0.185 (0.182) data 0.109 (0.106) loss_x loss_x 1.2734 (0.6590) acc_x 68.7500 (82.5000) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [10/35] time 0.177 (0.182) data 0.100 (0.106) loss_x loss_x 0.7446 (0.6277) acc_x 84.3750 (84.3750) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/35] time 0.188 (0.180) data 0.111 (0.103) loss_x loss_x 0.6030 (0.6256) acc_x 78.1250 (84.5833) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [20/35] time 0.163 (0.178) data 0.087 (0.101) loss_x loss_x 0.2322 (0.6024) acc_x 96.8750 (85.0000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [25/35] time 0.158 (0.174) data 0.082 (0.097) loss_x loss_x 0.6079 (0.6055) acc_x 84.3750 (84.6250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [30/35] time 0.171 (0.173) data 0.095 (0.097) loss_x loss_x 0.8838 (0.6318) acc_x 75.0000 (83.7500) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [35/35] time 0.166 (0.173) data 0.088 (0.096) loss_x loss_x 0.6665 (0.6457) acc_x 81.2500 (83.4821) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/14] time 0.181 (0.174) data 0.102 (0.097) loss_u loss_u 0.7144 (0.7206) acc_u 34.3750 (34.3750) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [10/14] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.6401 (0.7076) acc_u 34.3750 (34.6875) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.6837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1094
clean true:1094
clean false:0
clean_rate:1.0
noisy true:154
noisy false:352
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 506
epoch [33/200] batch [5/34] time 0.158 (0.179) data 0.082 (0.102) loss_x loss_x 1.1250 (0.8465) acc_x 68.7500 (75.6250) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/34] time 0.191 (0.179) data 0.113 (0.102) loss_x loss_x 0.3220 (0.6274) acc_x 90.6250 (82.1875) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [15/34] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.5669 (0.6556) acc_x 87.5000 (81.8750) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [20/34] time 0.172 (0.182) data 0.095 (0.105) loss_x loss_x 0.7925 (0.6393) acc_x 71.8750 (82.1875) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [25/34] time 0.186 (0.182) data 0.108 (0.104) loss_x loss_x 0.4839 (0.6072) acc_x 81.2500 (83.2500) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [30/34] time 0.192 (0.182) data 0.113 (0.104) loss_x loss_x 0.4424 (0.6088) acc_x 87.5000 (83.2292) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/15] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.7007 (0.6758) acc_u 37.5000 (39.3750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [10/15] time 0.188 (0.182) data 0.112 (0.105) loss_u loss_u 0.7607 (0.6980) acc_u 37.5000 (37.1875) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [15/15] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.7192 (0.6966) acc_u 37.5000 (36.4583) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.6894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1103
clean true:1103
clean false:0
clean_rate:1.0
noisy true:144
noisy false:353
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 497
epoch [34/200] batch [5/34] time 0.187 (0.187) data 0.111 (0.110) loss_x loss_x 0.4453 (0.6487) acc_x 84.3750 (82.5000) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [10/34] time 0.182 (0.186) data 0.106 (0.109) loss_x loss_x 0.2842 (0.6460) acc_x 93.7500 (81.2500) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/34] time 0.182 (0.185) data 0.107 (0.109) loss_x loss_x 0.4326 (0.6134) acc_x 87.5000 (82.0833) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/34] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.7065 (0.6213) acc_x 84.3750 (82.5000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [25/34] time 0.175 (0.183) data 0.098 (0.107) loss_x loss_x 0.8091 (0.6381) acc_x 78.1250 (81.7500) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [30/34] time 0.208 (0.185) data 0.131 (0.109) loss_x loss_x 1.0400 (0.6534) acc_x 65.6250 (81.6667) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/15] time 0.212 (0.190) data 0.135 (0.114) loss_u loss_u 0.6567 (0.7128) acc_u 37.5000 (32.5000) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/15] time 0.165 (0.188) data 0.087 (0.111) loss_u loss_u 0.6689 (0.7376) acc_u 40.6250 (30.6250) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [15/15] time 0.181 (0.187) data 0.104 (0.110) loss_u loss_u 0.5820 (0.7261) acc_u 46.8750 (31.4583) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.6800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1088
clean true:1086
clean false:2
clean_rate:0.9981617647058824
noisy true:151
noisy false:361
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 512
epoch [35/200] batch [5/34] time 0.170 (0.172) data 0.093 (0.096) loss_x loss_x 0.4714 (0.5364) acc_x 84.3750 (80.6250) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [10/34] time 0.180 (0.174) data 0.101 (0.097) loss_x loss_x 0.7632 (0.5397) acc_x 84.3750 (82.8125) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/34] time 0.177 (0.175) data 0.099 (0.098) loss_x loss_x 0.5361 (0.5505) acc_x 81.2500 (83.5417) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [20/34] time 0.176 (0.176) data 0.099 (0.099) loss_x loss_x 0.8838 (0.5776) acc_x 78.1250 (82.9688) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [25/34] time 0.168 (0.175) data 0.092 (0.098) loss_x loss_x 0.6943 (0.5653) acc_x 84.3750 (83.2500) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [30/34] time 0.171 (0.175) data 0.095 (0.098) loss_x loss_x 0.5742 (0.5367) acc_x 87.5000 (84.2708) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/16] time 0.186 (0.176) data 0.109 (0.100) loss_u loss_u 0.7651 (0.6896) acc_u 28.1250 (37.5000) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [10/16] time 0.192 (0.178) data 0.114 (0.101) loss_u loss_u 0.7017 (0.6697) acc_u 43.7500 (39.3750) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/16] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.7393 (0.6823) acc_u 28.1250 (36.8750) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1105
clean true:1105
clean false:0
clean_rate:1.0
noisy true:160
noisy false:335
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 495
epoch [36/200] batch [5/34] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.5562 (0.6209) acc_x 81.2500 (81.2500) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/34] time 0.169 (0.176) data 0.093 (0.099) loss_x loss_x 0.6758 (0.6059) acc_x 81.2500 (84.6875) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/34] time 0.180 (0.173) data 0.102 (0.096) loss_x loss_x 0.8931 (0.5911) acc_x 78.1250 (85.4167) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [20/34] time 0.173 (0.175) data 0.097 (0.098) loss_x loss_x 0.8887 (0.5724) acc_x 78.1250 (85.7812) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [25/34] time 0.176 (0.176) data 0.100 (0.099) loss_x loss_x 0.6875 (0.5638) acc_x 75.0000 (86.0000) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [30/34] time 0.163 (0.174) data 0.087 (0.097) loss_x loss_x 0.5635 (0.5646) acc_x 81.2500 (85.7292) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/15] time 0.178 (0.175) data 0.100 (0.099) loss_u loss_u 0.7583 (0.7264) acc_u 21.8750 (28.7500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [10/15] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.7651 (0.7147) acc_u 25.0000 (30.3125) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [15/15] time 0.188 (0.177) data 0.111 (0.100) loss_u loss_u 0.7710 (0.7001) acc_u 21.8750 (32.0833) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 317
confident_label rate tensor(0.7069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1131
clean true:1130
clean false:1
clean_rate:0.9991158267020336
noisy true:153
noisy false:316
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 469
epoch [37/200] batch [5/35] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.3826 (0.5973) acc_x 87.5000 (85.6250) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [10/35] time 0.157 (0.179) data 0.081 (0.102) loss_x loss_x 0.4353 (0.5856) acc_x 93.7500 (84.6875) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/35] time 0.186 (0.176) data 0.109 (0.099) loss_x loss_x 0.4033 (0.5310) acc_x 81.2500 (85.6250) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [20/35] time 0.168 (0.177) data 0.092 (0.100) loss_x loss_x 0.7720 (0.5825) acc_x 78.1250 (84.2188) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [25/35] time 0.180 (0.176) data 0.104 (0.100) loss_x loss_x 0.2625 (0.5885) acc_x 90.6250 (83.6250) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [30/35] time 0.168 (0.175) data 0.091 (0.099) loss_x loss_x 0.4424 (0.5845) acc_x 87.5000 (83.7500) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [35/35] time 0.168 (0.175) data 0.092 (0.098) loss_x loss_x 0.5659 (0.5828) acc_x 84.3750 (83.6607) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/14] time 0.178 (0.175) data 0.101 (0.098) loss_u loss_u 0.8120 (0.7296) acc_u 21.8750 (29.3750) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [10/14] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.7056 (0.7323) acc_u 31.2500 (30.3125) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.6944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1111
clean true:1110
clean false:1
clean_rate:0.9990999099909991
noisy true:141
noisy false:348
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 489
epoch [38/200] batch [5/34] time 0.169 (0.180) data 0.093 (0.103) loss_x loss_x 0.2126 (0.4333) acc_x 93.7500 (87.5000) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [10/34] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.3469 (0.4586) acc_x 90.6250 (88.4375) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/34] time 0.168 (0.173) data 0.090 (0.096) loss_x loss_x 0.3279 (0.4498) acc_x 84.3750 (87.7083) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [20/34] time 0.171 (0.172) data 0.095 (0.095) loss_x loss_x 0.6050 (0.5340) acc_x 87.5000 (86.7188) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [25/34] time 0.178 (0.172) data 0.102 (0.095) loss_x loss_x 0.9351 (0.5502) acc_x 78.1250 (86.1250) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [30/34] time 0.171 (0.172) data 0.095 (0.095) loss_x loss_x 0.5811 (0.5530) acc_x 81.2500 (85.9375) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/15] time 0.163 (0.170) data 0.087 (0.093) loss_u loss_u 0.7222 (0.7354) acc_u 28.1250 (28.7500) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [10/15] time 0.178 (0.172) data 0.101 (0.095) loss_u loss_u 0.7153 (0.6942) acc_u 31.2500 (34.0625) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [15/15] time 0.172 (0.173) data 0.096 (0.096) loss_u loss_u 0.7178 (0.7126) acc_u 31.2500 (31.8750) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.6744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1079
clean true:1077
clean false:2
clean_rate:0.9981464318813716
noisy true:148
noisy false:373
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 521
epoch [39/200] batch [5/33] time 0.178 (0.183) data 0.102 (0.107) loss_x loss_x 0.7422 (0.7555) acc_x 87.5000 (79.3750) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [10/33] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.8730 (0.7054) acc_x 81.2500 (81.8750) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/33] time 0.181 (0.187) data 0.105 (0.110) loss_x loss_x 0.6250 (0.6532) acc_x 78.1250 (83.5417) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [20/33] time 0.179 (0.185) data 0.100 (0.109) loss_x loss_x 0.5171 (0.6267) acc_x 84.3750 (84.2188) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [25/33] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.8501 (0.6681) acc_x 78.1250 (83.6250) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [30/33] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.5342 (0.6549) acc_x 81.2500 (83.3333) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/16] time 0.187 (0.185) data 0.111 (0.109) loss_u loss_u 0.8203 (0.6946) acc_u 18.7500 (35.0000) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/16] time 0.183 (0.185) data 0.107 (0.109) loss_u loss_u 0.5645 (0.6722) acc_u 43.7500 (37.1875) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/16] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.7671 (0.6805) acc_u 25.0000 (35.4167) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 344
confident_label rate tensor(0.6919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1107
clean true:1106
clean false:1
clean_rate:0.999096657633243
noisy true:150
noisy false:343
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 493
epoch [40/200] batch [5/34] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.3518 (0.4966) acc_x 90.6250 (86.8750) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [10/34] time 0.189 (0.186) data 0.111 (0.110) loss_x loss_x 0.4207 (0.5080) acc_x 81.2500 (84.0625) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/34] time 0.174 (0.184) data 0.097 (0.107) loss_x loss_x 0.4780 (0.5096) acc_x 84.3750 (84.7917) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/34] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.7529 (0.5530) acc_x 81.2500 (84.2188) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [25/34] time 0.162 (0.179) data 0.084 (0.102) loss_x loss_x 0.7412 (0.5710) acc_x 84.3750 (84.1250) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [30/34] time 0.173 (0.177) data 0.097 (0.100) loss_x loss_x 0.5962 (0.5530) acc_x 87.5000 (84.7917) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/15] time 0.206 (0.176) data 0.128 (0.099) loss_u loss_u 0.7354 (0.7099) acc_u 31.2500 (32.5000) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [10/15] time 0.166 (0.175) data 0.088 (0.098) loss_u loss_u 0.7026 (0.7063) acc_u 28.1250 (30.9375) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [15/15] time 0.172 (0.174) data 0.094 (0.097) loss_u loss_u 0.6855 (0.6816) acc_u 37.5000 (35.2083) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 319
confident_label rate tensor(0.7037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1126
clean true:1126
clean false:0
clean_rate:1.0
noisy true:155
noisy false:319
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 474
epoch [41/200] batch [5/35] time 0.186 (0.170) data 0.109 (0.093) loss_x loss_x 0.8833 (0.6079) acc_x 75.0000 (84.3750) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [10/35] time 0.187 (0.178) data 0.111 (0.102) loss_x loss_x 0.5005 (0.5015) acc_x 87.5000 (86.2500) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/35] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.1378 (0.5312) acc_x 96.8750 (85.8333) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [20/35] time 0.181 (0.185) data 0.103 (0.108) loss_x loss_x 0.5327 (0.5443) acc_x 84.3750 (85.1562) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [25/35] time 0.174 (0.183) data 0.098 (0.106) loss_x loss_x 0.6343 (0.5311) acc_x 81.2500 (85.2500) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [30/35] time 0.168 (0.180) data 0.092 (0.103) loss_x loss_x 0.2527 (0.5177) acc_x 87.5000 (85.6250) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [35/35] time 0.189 (0.181) data 0.111 (0.104) loss_x loss_x 0.7842 (0.5736) acc_x 78.1250 (84.3750) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/14] time 0.164 (0.180) data 0.087 (0.104) loss_u loss_u 0.7246 (0.7032) acc_u 31.2500 (33.1250) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [10/14] time 0.163 (0.179) data 0.086 (0.102) loss_u loss_u 0.7573 (0.7248) acc_u 28.1250 (30.6250) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.6819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1091
clean true:1089
clean false:2
clean_rate:0.998166819431714
noisy true:155
noisy false:354
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 509
epoch [42/200] batch [5/34] time 0.169 (0.169) data 0.092 (0.093) loss_x loss_x 0.9458 (0.7318) acc_x 75.0000 (79.3750) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/34] time 0.156 (0.171) data 0.080 (0.094) loss_x loss_x 0.3518 (0.6150) acc_x 90.6250 (83.1250) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [15/34] time 0.165 (0.169) data 0.089 (0.092) loss_x loss_x 0.3821 (0.5963) acc_x 90.6250 (84.1667) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [20/34] time 0.168 (0.169) data 0.091 (0.092) loss_x loss_x 0.6523 (0.6227) acc_x 75.0000 (83.4375) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [25/34] time 0.173 (0.169) data 0.096 (0.093) loss_x loss_x 0.3804 (0.5919) acc_x 87.5000 (84.2500) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [30/34] time 0.168 (0.169) data 0.089 (0.093) loss_x loss_x 0.2068 (0.5924) acc_x 96.8750 (83.9583) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/15] time 0.184 (0.170) data 0.107 (0.093) loss_u loss_u 0.8247 (0.7344) acc_u 18.7500 (30.6250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [10/15] time 0.178 (0.171) data 0.101 (0.094) loss_u loss_u 0.6406 (0.7134) acc_u 40.6250 (32.1875) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [15/15] time 0.167 (0.171) data 0.090 (0.094) loss_u loss_u 0.6699 (0.6772) acc_u 37.5000 (36.0417) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 345
confident_label rate tensor(0.6869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1099
clean true:1098
clean false:1
clean_rate:0.9990900818926297
noisy true:157
noisy false:344
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 501
epoch [43/200] batch [5/34] time 0.170 (0.172) data 0.094 (0.095) loss_x loss_x 0.7515 (0.5828) acc_x 81.2500 (83.7500) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/34] time 0.179 (0.173) data 0.102 (0.097) loss_x loss_x 0.0362 (0.5692) acc_x 100.0000 (84.6875) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [15/34] time 0.168 (0.171) data 0.091 (0.094) loss_x loss_x 0.6162 (0.5757) acc_x 87.5000 (85.0000) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/34] time 0.181 (0.173) data 0.104 (0.096) loss_x loss_x 0.5054 (0.6130) acc_x 87.5000 (84.5312) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [25/34] time 0.179 (0.174) data 0.102 (0.098) loss_x loss_x 0.3145 (0.5950) acc_x 93.7500 (85.6250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [30/34] time 0.177 (0.174) data 0.101 (0.098) loss_x loss_x 0.2700 (0.5811) acc_x 100.0000 (86.1458) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/15] time 0.163 (0.173) data 0.086 (0.096) loss_u loss_u 0.7134 (0.7025) acc_u 34.3750 (34.3750) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/15] time 0.168 (0.173) data 0.091 (0.096) loss_u loss_u 0.6602 (0.6652) acc_u 37.5000 (36.8750) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [15/15] time 0.178 (0.173) data 0.100 (0.096) loss_u loss_u 0.7329 (0.6819) acc_u 28.1250 (35.2083) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.7006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1121
clean true:1120
clean false:1
clean_rate:0.9991079393398751
noisy true:156
noisy false:323
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 479
epoch [44/200] batch [5/35] time 0.170 (0.178) data 0.093 (0.100) loss_x loss_x 0.4480 (0.4147) acc_x 90.6250 (87.5000) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/35] time 0.169 (0.174) data 0.091 (0.096) loss_x loss_x 0.5708 (0.4703) acc_x 84.3750 (86.5625) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [15/35] time 0.167 (0.171) data 0.088 (0.094) loss_x loss_x 0.3486 (0.4714) acc_x 87.5000 (86.8750) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/35] time 0.165 (0.170) data 0.087 (0.092) loss_x loss_x 0.2532 (0.4565) acc_x 93.7500 (87.5000) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [25/35] time 0.197 (0.172) data 0.120 (0.095) loss_x loss_x 0.3604 (0.4990) acc_x 90.6250 (86.3750) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [30/35] time 0.169 (0.173) data 0.093 (0.096) loss_x loss_x 1.0713 (0.5415) acc_x 78.1250 (85.7292) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [35/35] time 0.162 (0.171) data 0.084 (0.094) loss_x loss_x 0.4658 (0.5354) acc_x 84.3750 (85.7143) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/14] time 0.174 (0.172) data 0.096 (0.095) loss_u loss_u 0.6392 (0.7161) acc_u 43.7500 (34.3750) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [10/14] time 0.169 (0.173) data 0.092 (0.095) loss_u loss_u 0.7031 (0.7140) acc_u 31.2500 (33.4375) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1095
clean true:1094
clean false:1
clean_rate:0.9990867579908675
noisy true:154
noisy false:351
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 505
epoch [45/200] batch [5/34] time 0.163 (0.172) data 0.086 (0.094) loss_x loss_x 0.5146 (0.5797) acc_x 84.3750 (84.3750) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/34] time 0.165 (0.168) data 0.088 (0.091) loss_x loss_x 0.2715 (0.4865) acc_x 87.5000 (87.1875) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/34] time 0.175 (0.171) data 0.098 (0.094) loss_x loss_x 0.6362 (0.5438) acc_x 81.2500 (85.0000) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/34] time 0.195 (0.173) data 0.118 (0.096) loss_x loss_x 0.3374 (0.5444) acc_x 90.6250 (85.7812) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [25/34] time 0.172 (0.175) data 0.096 (0.098) loss_x loss_x 0.3220 (0.5440) acc_x 96.8750 (86.1250) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [30/34] time 0.165 (0.176) data 0.089 (0.099) loss_x loss_x 0.4500 (0.5499) acc_x 93.7500 (86.1458) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/15] time 0.164 (0.174) data 0.087 (0.097) loss_u loss_u 0.6299 (0.7136) acc_u 40.6250 (34.3750) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [10/15] time 0.173 (0.173) data 0.096 (0.096) loss_u loss_u 0.6743 (0.6777) acc_u 28.1250 (35.6250) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [15/15] time 0.187 (0.174) data 0.110 (0.097) loss_u loss_u 0.7168 (0.6953) acc_u 34.3750 (34.1667) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.6994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1119
clean true:1118
clean false:1
clean_rate:0.9991063449508489
noisy true:147
noisy false:334
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 481
epoch [46/200] batch [5/34] time 0.180 (0.176) data 0.104 (0.099) loss_x loss_x 0.2971 (0.5383) acc_x 90.6250 (84.3750) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/34] time 0.172 (0.175) data 0.095 (0.099) loss_x loss_x 0.5713 (0.5655) acc_x 87.5000 (86.5625) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/34] time 0.183 (0.178) data 0.107 (0.101) loss_x loss_x 0.5181 (0.5479) acc_x 84.3750 (86.0417) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/34] time 0.164 (0.175) data 0.087 (0.098) loss_x loss_x 0.2954 (0.5746) acc_x 90.6250 (85.7812) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [25/34] time 0.176 (0.176) data 0.099 (0.100) loss_x loss_x 0.5801 (0.6176) acc_x 90.6250 (84.5000) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [30/34] time 0.173 (0.176) data 0.097 (0.100) loss_x loss_x 0.7515 (0.6199) acc_x 78.1250 (83.8542) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/15] time 0.165 (0.174) data 0.087 (0.098) loss_u loss_u 0.8125 (0.7178) acc_u 25.0000 (34.3750) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/15] time 0.181 (0.175) data 0.102 (0.098) loss_u loss_u 0.7061 (0.6917) acc_u 37.5000 (36.8750) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [15/15] time 0.176 (0.175) data 0.099 (0.098) loss_u loss_u 0.6016 (0.6713) acc_u 43.7500 (38.7500) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.7012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1122
clean true:1121
clean false:1
clean_rate:0.9991087344028521
noisy true:154
noisy false:324
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 478
epoch [47/200] batch [5/35] time 0.189 (0.190) data 0.112 (0.113) loss_x loss_x 0.2070 (0.4203) acc_x 96.8750 (89.3750) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/35] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.9224 (0.5477) acc_x 84.3750 (86.2500) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [15/35] time 0.178 (0.178) data 0.102 (0.101) loss_x loss_x 0.8569 (0.5817) acc_x 78.1250 (85.4167) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/35] time 0.164 (0.177) data 0.085 (0.100) loss_x loss_x 0.3435 (0.5912) acc_x 90.6250 (84.8438) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [25/35] time 0.175 (0.178) data 0.098 (0.100) loss_x loss_x 0.2515 (0.5685) acc_x 90.6250 (85.3750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [30/35] time 0.175 (0.177) data 0.099 (0.100) loss_x loss_x 0.9336 (0.6147) acc_x 75.0000 (84.2708) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [35/35] time 0.195 (0.178) data 0.119 (0.101) loss_x loss_x 0.7256 (0.6262) acc_x 84.3750 (83.9286) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/14] time 0.161 (0.177) data 0.084 (0.100) loss_u loss_u 0.6055 (0.6504) acc_u 46.8750 (41.2500) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/14] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.8018 (0.6840) acc_u 25.0000 (37.1875) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 343
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1105
clean true:1105
clean false:0
clean_rate:1.0
noisy true:152
noisy false:343
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 495
epoch [48/200] batch [5/34] time 0.171 (0.171) data 0.093 (0.093) loss_x loss_x 0.6465 (0.6317) acc_x 81.2500 (82.5000) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/34] time 0.185 (0.173) data 0.109 (0.096) loss_x loss_x 0.6431 (0.6379) acc_x 90.6250 (84.6875) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/34] time 0.165 (0.173) data 0.088 (0.096) loss_x loss_x 1.0088 (0.6284) acc_x 75.0000 (83.7500) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [20/34] time 0.178 (0.176) data 0.101 (0.099) loss_x loss_x 0.6543 (0.6307) acc_x 78.1250 (83.9062) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [25/34] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.2571 (0.5792) acc_x 90.6250 (85.0000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [30/34] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.4053 (0.6073) acc_x 93.7500 (84.4792) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/15] time 0.188 (0.180) data 0.112 (0.103) loss_u loss_u 0.6973 (0.6942) acc_u 37.5000 (35.6250) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [10/15] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.6514 (0.6863) acc_u 40.6250 (35.6250) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [15/15] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8115 (0.7047) acc_u 18.7500 (33.5417) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.6981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1117
clean true:1117
clean false:0
clean_rate:1.0
noisy true:156
noisy false:327
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 483
epoch [49/200] batch [5/34] time 0.176 (0.177) data 0.100 (0.100) loss_x loss_x 0.7725 (0.5636) acc_x 78.1250 (86.2500) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/34] time 0.175 (0.178) data 0.096 (0.101) loss_x loss_x 0.8662 (0.6928) acc_x 71.8750 (81.5625) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/34] time 0.172 (0.178) data 0.096 (0.101) loss_x loss_x 0.4822 (0.6378) acc_x 84.3750 (83.1250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/34] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.8105 (0.6024) acc_x 78.1250 (84.0625) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [25/34] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.3904 (0.6154) acc_x 87.5000 (84.0000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/34] time 0.172 (0.178) data 0.096 (0.101) loss_x loss_x 0.6426 (0.5933) acc_x 87.5000 (84.4792) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/15] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.7070 (0.6942) acc_u 37.5000 (35.0000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [10/15] time 0.185 (0.178) data 0.109 (0.101) loss_u loss_u 0.7026 (0.6975) acc_u 31.2500 (34.3750) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [15/15] time 0.187 (0.179) data 0.111 (0.102) loss_u loss_u 0.6475 (0.6968) acc_u 40.6250 (34.7917) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 337
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1110
clean true:1109
clean false:1
clean_rate:0.9990990990990991
noisy true:154
noisy false:336
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 490
epoch [50/200] batch [5/34] time 0.192 (0.183) data 0.115 (0.107) loss_x loss_x 0.6348 (0.5668) acc_x 81.2500 (86.2500) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/34] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.3198 (0.5695) acc_x 87.5000 (84.6875) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/34] time 0.173 (0.178) data 0.097 (0.102) loss_x loss_x 0.3086 (0.5400) acc_x 100.0000 (86.0417) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/34] time 0.167 (0.176) data 0.091 (0.100) loss_x loss_x 0.6470 (0.5482) acc_x 87.5000 (85.9375) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [25/34] time 0.182 (0.175) data 0.106 (0.099) loss_x loss_x 0.6641 (0.5734) acc_x 84.3750 (85.3750) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/34] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.3506 (0.5548) acc_x 87.5000 (85.5208) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/15] time 0.195 (0.178) data 0.115 (0.101) loss_u loss_u 0.6528 (0.6912) acc_u 46.8750 (35.6250) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [10/15] time 0.181 (0.179) data 0.102 (0.102) loss_u loss_u 0.6411 (0.6794) acc_u 43.7500 (36.5625) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [15/15] time 0.173 (0.179) data 0.096 (0.102) loss_u loss_u 0.7222 (0.6930) acc_u 28.1250 (35.0000) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.7050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1128
clean true:1126
clean false:2
clean_rate:0.99822695035461
noisy true:145
noisy false:327
after delete: len(clean_dataset) 1128
after delete: len(noisy_dataset) 472
epoch [51/200] batch [5/35] time 0.184 (0.185) data 0.107 (0.109) loss_x loss_x 0.4224 (0.4470) acc_x 87.5000 (86.8750) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/35] time 0.175 (0.184) data 0.098 (0.107) loss_x loss_x 0.6436 (0.5256) acc_x 78.1250 (84.6875) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [15/35] time 0.170 (0.180) data 0.093 (0.104) loss_x loss_x 0.3140 (0.5660) acc_x 90.6250 (84.1667) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/35] time 0.170 (0.177) data 0.094 (0.101) loss_x loss_x 0.5723 (0.5752) acc_x 84.3750 (84.5312) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [25/35] time 0.181 (0.178) data 0.104 (0.102) loss_x loss_x 0.7202 (0.5906) acc_x 84.3750 (84.0000) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [30/35] time 0.186 (0.178) data 0.109 (0.101) loss_x loss_x 0.3167 (0.5890) acc_x 84.3750 (83.7500) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [35/35] time 0.165 (0.178) data 0.088 (0.101) loss_x loss_x 0.3982 (0.5738) acc_x 87.5000 (83.7500) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/14] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.6938 (0.7351) acc_u 37.5000 (31.2500) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/14] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.7808 (0.7134) acc_u 28.1250 (33.1250) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 340
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1105
clean true:1104
clean false:1
clean_rate:0.9990950226244344
noisy true:156
noisy false:339
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 495
epoch [52/200] batch [5/34] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.7393 (0.4414) acc_x 84.3750 (88.7500) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [10/34] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.8569 (0.5797) acc_x 84.3750 (87.1875) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/34] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 0.1912 (0.5104) acc_x 96.8750 (88.5417) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/34] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 0.4807 (0.4796) acc_x 93.7500 (88.7500) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [25/34] time 0.176 (0.175) data 0.099 (0.099) loss_x loss_x 1.0410 (0.5207) acc_x 81.2500 (88.0000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [30/34] time 0.181 (0.177) data 0.103 (0.100) loss_x loss_x 0.7793 (0.5204) acc_x 84.3750 (87.8125) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/15] time 0.182 (0.176) data 0.105 (0.100) loss_u loss_u 0.6660 (0.6193) acc_u 40.6250 (41.8750) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/15] time 0.162 (0.176) data 0.085 (0.099) loss_u loss_u 0.5757 (0.6538) acc_u 50.0000 (39.0625) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [15/15] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.7520 (0.6779) acc_u 34.3750 (37.2917) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.6862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1098
clean true:1098
clean false:0
clean_rate:1.0
noisy true:145
noisy false:357
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 502
epoch [53/200] batch [5/34] time 0.180 (0.193) data 0.104 (0.116) loss_x loss_x 0.4771 (0.5898) acc_x 78.1250 (81.8750) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/34] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 0.6562 (0.6526) acc_x 71.8750 (80.3125) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/34] time 0.188 (0.186) data 0.112 (0.110) loss_x loss_x 0.3149 (0.5809) acc_x 90.6250 (83.3333) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/34] time 0.185 (0.187) data 0.107 (0.110) loss_x loss_x 0.2976 (0.5469) acc_x 90.6250 (85.0000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [25/34] time 0.178 (0.186) data 0.102 (0.109) loss_x loss_x 0.7090 (0.5481) acc_x 84.3750 (85.1250) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/34] time 0.184 (0.186) data 0.106 (0.109) loss_x loss_x 0.8521 (0.5470) acc_x 75.0000 (85.4167) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/15] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.7549 (0.6962) acc_u 34.3750 (38.1250) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/15] time 0.179 (0.183) data 0.102 (0.107) loss_u loss_u 0.6621 (0.6938) acc_u 34.3750 (35.9375) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [15/15] time 0.190 (0.183) data 0.113 (0.107) loss_u loss_u 0.7163 (0.6770) acc_u 31.2500 (38.3333) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 295
confident_label rate tensor(0.7194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1151
clean true:1151
clean false:0
clean_rate:1.0
noisy true:154
noisy false:295
after delete: len(clean_dataset) 1151
after delete: len(noisy_dataset) 449
epoch [54/200] batch [5/35] time 0.182 (0.174) data 0.105 (0.097) loss_x loss_x 0.4006 (0.4639) acc_x 87.5000 (86.8750) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [10/35] time 0.166 (0.172) data 0.089 (0.095) loss_x loss_x 0.6328 (0.4926) acc_x 90.6250 (88.1250) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [15/35] time 0.162 (0.169) data 0.085 (0.092) loss_x loss_x 0.5825 (0.4883) acc_x 81.2500 (87.5000) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/35] time 0.177 (0.171) data 0.100 (0.094) loss_x loss_x 0.5718 (0.5080) acc_x 84.3750 (86.5625) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [25/35] time 0.179 (0.173) data 0.103 (0.096) loss_x loss_x 0.6816 (0.5086) acc_x 81.2500 (86.6250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/35] time 0.169 (0.172) data 0.092 (0.096) loss_x loss_x 0.7866 (0.5454) acc_x 75.0000 (85.5208) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [35/35] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 0.3962 (0.5547) acc_x 87.5000 (84.9107) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/14] time 0.164 (0.174) data 0.087 (0.097) loss_u loss_u 0.6611 (0.7026) acc_u 37.5000 (34.3750) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/14] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.6626 (0.7140) acc_u 34.3750 (31.8750) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 331
confident_label rate tensor(0.6994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1119
clean true:1118
clean false:1
clean_rate:0.9991063449508489
noisy true:151
noisy false:330
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 481
epoch [55/200] batch [5/34] time 0.169 (0.184) data 0.093 (0.107) loss_x loss_x 0.5532 (0.5891) acc_x 84.3750 (84.3750) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/34] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.8892 (0.5515) acc_x 68.7500 (84.6875) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/34] time 0.178 (0.180) data 0.100 (0.103) loss_x loss_x 1.0039 (0.5449) acc_x 78.1250 (85.4167) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/34] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 0.6982 (0.5710) acc_x 90.6250 (84.6875) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/34] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 1.1025 (0.5956) acc_x 75.0000 (84.5000) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/34] time 0.183 (0.181) data 0.104 (0.105) loss_x loss_x 0.2751 (0.5861) acc_x 90.6250 (84.5833) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/15] time 0.161 (0.180) data 0.084 (0.103) loss_u loss_u 0.7534 (0.7066) acc_u 31.2500 (32.5000) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/15] time 0.161 (0.178) data 0.084 (0.102) loss_u loss_u 0.7266 (0.7138) acc_u 25.0000 (31.8750) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [15/15] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.6440 (0.6983) acc_u 37.5000 (34.1667) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.7069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1131
clean true:1129
clean false:2
clean_rate:0.9982316534040672
noisy true:146
noisy false:323
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 469
epoch [56/200] batch [5/35] time 0.219 (0.221) data 0.142 (0.144) loss_x loss_x 0.5781 (0.5975) acc_x 87.5000 (84.3750) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [10/35] time 0.195 (0.215) data 0.118 (0.138) loss_x loss_x 0.5615 (0.5470) acc_x 84.3750 (85.9375) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [15/35] time 0.156 (0.198) data 0.079 (0.121) loss_x loss_x 0.6831 (0.5637) acc_x 81.2500 (86.0417) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/35] time 0.177 (0.192) data 0.101 (0.115) loss_x loss_x 0.3718 (0.5793) acc_x 84.3750 (84.8438) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [25/35] time 0.172 (0.188) data 0.094 (0.111) loss_x loss_x 0.7207 (0.5847) acc_x 75.0000 (84.1250) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [30/35] time 0.186 (0.187) data 0.110 (0.110) loss_x loss_x 0.6587 (0.5867) acc_x 84.3750 (83.7500) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [35/35] time 0.182 (0.186) data 0.104 (0.109) loss_x loss_x 0.4292 (0.5895) acc_x 90.6250 (83.9286) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/14] time 0.171 (0.185) data 0.094 (0.108) loss_u loss_u 0.7983 (0.7311) acc_u 18.7500 (27.5000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/14] time 0.181 (0.184) data 0.104 (0.108) loss_u loss_u 0.7310 (0.7210) acc_u 25.0000 (29.6875) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 308
confident_label rate tensor(0.7069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1131
clean true:1131
clean false:0
clean_rate:1.0
noisy true:161
noisy false:308
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 469
epoch [57/200] batch [5/35] time 0.189 (0.188) data 0.112 (0.111) loss_x loss_x 0.2062 (0.3061) acc_x 93.7500 (90.0000) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [10/35] time 0.213 (0.191) data 0.136 (0.114) loss_x loss_x 0.5522 (0.4109) acc_x 84.3750 (88.7500) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/35] time 0.172 (0.188) data 0.096 (0.111) loss_x loss_x 0.5029 (0.4280) acc_x 87.5000 (88.5417) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/35] time 0.174 (0.184) data 0.096 (0.107) loss_x loss_x 0.1353 (0.4957) acc_x 96.8750 (87.3438) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/35] time 0.173 (0.182) data 0.097 (0.105) loss_x loss_x 0.4214 (0.4847) acc_x 90.6250 (87.6250) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [30/35] time 0.189 (0.181) data 0.112 (0.104) loss_x loss_x 0.6528 (0.5180) acc_x 81.2500 (86.7708) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [35/35] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.7876 (0.5210) acc_x 75.0000 (86.1607) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/14] time 0.177 (0.180) data 0.100 (0.103) loss_u loss_u 0.6992 (0.7243) acc_u 37.5000 (33.7500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/14] time 0.190 (0.180) data 0.111 (0.103) loss_u loss_u 0.6577 (0.6983) acc_u 34.3750 (35.3125) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 305
confident_label rate tensor(0.7194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1151
clean true:1146
clean false:5
clean_rate:0.9956559513466551
noisy true:149
noisy false:300
after delete: len(clean_dataset) 1151
after delete: len(noisy_dataset) 449
epoch [58/200] batch [5/35] time 0.168 (0.174) data 0.092 (0.097) loss_x loss_x 0.3145 (0.4175) acc_x 93.7500 (87.5000) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/35] time 0.167 (0.173) data 0.090 (0.097) loss_x loss_x 0.7793 (0.5193) acc_x 78.1250 (85.9375) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [15/35] time 0.183 (0.173) data 0.107 (0.097) loss_x loss_x 1.0127 (0.5705) acc_x 78.1250 (84.7917) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/35] time 0.187 (0.176) data 0.111 (0.099) loss_x loss_x 0.5557 (0.5798) acc_x 84.3750 (84.3750) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/35] time 0.182 (0.178) data 0.103 (0.101) loss_x loss_x 1.1592 (0.6315) acc_x 75.0000 (83.3750) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/35] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 0.8213 (0.6392) acc_x 75.0000 (82.5000) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [35/35] time 0.203 (0.179) data 0.127 (0.102) loss_x loss_x 0.7197 (0.6401) acc_x 71.8750 (82.4107) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/14] time 0.165 (0.177) data 0.089 (0.101) loss_u loss_u 0.7549 (0.7400) acc_u 28.1250 (30.0000) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/14] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.7417 (0.7220) acc_u 37.5000 (32.8125) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.7000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1120
clean true:1120
clean false:0
clean_rate:1.0
noisy true:155
noisy false:325
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 480
epoch [59/200] batch [5/35] time 0.171 (0.178) data 0.093 (0.101) loss_x loss_x 0.3464 (0.4972) acc_x 93.7500 (86.8750) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/35] time 0.163 (0.172) data 0.086 (0.095) loss_x loss_x 0.5444 (0.5098) acc_x 84.3750 (86.5625) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/35] time 0.164 (0.172) data 0.088 (0.095) loss_x loss_x 0.7612 (0.4913) acc_x 84.3750 (87.0833) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/35] time 0.172 (0.171) data 0.095 (0.094) loss_x loss_x 1.2871 (0.5437) acc_x 71.8750 (86.4062) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [25/35] time 0.175 (0.171) data 0.099 (0.094) loss_x loss_x 0.5264 (0.5771) acc_x 87.5000 (85.2500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/35] time 0.193 (0.172) data 0.117 (0.096) loss_x loss_x 0.7510 (0.5783) acc_x 81.2500 (85.3125) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [35/35] time 0.165 (0.172) data 0.088 (0.095) loss_x loss_x 0.5586 (0.5869) acc_x 87.5000 (84.5536) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/15] time 0.185 (0.172) data 0.109 (0.096) loss_u loss_u 0.5444 (0.6710) acc_u 50.0000 (36.2500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/15] time 0.174 (0.173) data 0.096 (0.096) loss_u loss_u 0.6240 (0.6905) acc_u 37.5000 (34.3750) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [15/15] time 0.176 (0.173) data 0.099 (0.096) loss_u loss_u 0.8228 (0.6844) acc_u 21.8750 (35.4167) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 333
confident_label rate tensor(0.6981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1117
clean true:1117
clean false:0
clean_rate:1.0
noisy true:150
noisy false:333
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 483
epoch [60/200] batch [5/34] time 0.188 (0.174) data 0.111 (0.097) loss_x loss_x 0.3662 (0.5519) acc_x 90.6250 (86.8750) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [10/34] time 0.189 (0.180) data 0.112 (0.104) loss_x loss_x 0.4783 (0.4733) acc_x 90.6250 (88.4375) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/34] time 0.174 (0.181) data 0.098 (0.104) loss_x loss_x 0.5254 (0.4779) acc_x 84.3750 (88.1250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [20/34] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.6377 (0.4910) acc_x 87.5000 (87.3438) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/34] time 0.173 (0.178) data 0.096 (0.102) loss_x loss_x 0.6904 (0.4760) acc_x 84.3750 (87.7500) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [30/34] time 0.181 (0.178) data 0.104 (0.102) loss_x loss_x 0.3596 (0.4812) acc_x 87.5000 (87.3958) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/15] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.5034 (0.6581) acc_u 53.1250 (38.1250) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/15] time 0.169 (0.176) data 0.089 (0.099) loss_u loss_u 0.6724 (0.6542) acc_u 40.6250 (38.7500) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [15/15] time 0.164 (0.175) data 0.087 (0.098) loss_u loss_u 0.7720 (0.6692) acc_u 21.8750 (37.0833) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.7156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1145
clean true:1144
clean false:1
clean_rate:0.9991266375545852
noisy true:145
noisy false:310
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 455
epoch [61/200] batch [5/35] time 0.167 (0.167) data 0.090 (0.089) loss_x loss_x 0.2805 (0.5167) acc_x 90.6250 (84.3750) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/35] time 0.166 (0.166) data 0.089 (0.089) loss_x loss_x 0.3501 (0.4860) acc_x 93.7500 (85.6250) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [15/35] time 0.160 (0.165) data 0.083 (0.088) loss_x loss_x 1.0674 (0.5497) acc_x 71.8750 (83.7500) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/35] time 0.167 (0.166) data 0.090 (0.089) loss_x loss_x 0.2388 (0.5462) acc_x 90.6250 (83.7500) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [25/35] time 0.163 (0.165) data 0.087 (0.088) loss_x loss_x 0.7456 (0.5715) acc_x 84.3750 (83.7500) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/35] time 0.161 (0.165) data 0.084 (0.088) loss_x loss_x 0.8965 (0.5856) acc_x 81.2500 (83.1250) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [35/35] time 0.184 (0.167) data 0.108 (0.090) loss_x loss_x 0.5288 (0.5836) acc_x 87.5000 (83.4821) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/14] time 0.172 (0.171) data 0.094 (0.094) loss_u loss_u 0.6704 (0.6768) acc_u 31.2500 (33.1250) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/14] time 0.173 (0.170) data 0.096 (0.093) loss_u loss_u 0.7236 (0.6933) acc_u 25.0000 (31.2500) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.7156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1145
clean true:1143
clean false:2
clean_rate:0.9982532751091703
noisy true:148
noisy false:307
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 455
epoch [62/200] batch [5/35] time 0.177 (0.183) data 0.101 (0.106) loss_x loss_x 0.7505 (0.6296) acc_x 81.2500 (83.1250) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/35] time 0.168 (0.183) data 0.092 (0.107) loss_x loss_x 0.3752 (0.5792) acc_x 87.5000 (85.0000) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [15/35] time 0.163 (0.178) data 0.085 (0.101) loss_x loss_x 0.3494 (0.5784) acc_x 93.7500 (85.0000) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/35] time 0.159 (0.175) data 0.082 (0.098) loss_x loss_x 0.5674 (0.5754) acc_x 84.3750 (85.0000) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/35] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.5703 (0.6066) acc_x 84.3750 (84.1250) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/35] time 0.178 (0.175) data 0.101 (0.098) loss_x loss_x 0.5400 (0.5879) acc_x 84.3750 (84.2708) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [35/35] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.5239 (0.5819) acc_x 81.2500 (84.3750) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/14] time 0.177 (0.175) data 0.100 (0.098) loss_u loss_u 0.6855 (0.6899) acc_u 31.2500 (33.7500) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [10/14] time 0.164 (0.175) data 0.087 (0.098) loss_u loss_u 0.7422 (0.7194) acc_u 31.2500 (31.5625) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 297
confident_label rate tensor(0.7219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1155
clean true:1155
clean false:0
clean_rate:1.0
noisy true:148
noisy false:297
after delete: len(clean_dataset) 1155
after delete: len(noisy_dataset) 445
epoch [63/200] batch [5/36] time 0.189 (0.177) data 0.112 (0.100) loss_x loss_x 0.4229 (0.5611) acc_x 87.5000 (85.6250) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/36] time 0.191 (0.176) data 0.115 (0.099) loss_x loss_x 0.4163 (0.5553) acc_x 90.6250 (84.6875) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/36] time 0.160 (0.174) data 0.083 (0.096) loss_x loss_x 0.4949 (0.5317) acc_x 81.2500 (85.4167) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/36] time 0.168 (0.174) data 0.091 (0.098) loss_x loss_x 1.0801 (0.5279) acc_x 71.8750 (85.1562) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [25/36] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.5811 (0.5684) acc_x 84.3750 (84.1250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/36] time 0.180 (0.173) data 0.103 (0.096) loss_x loss_x 0.1786 (0.5597) acc_x 96.8750 (84.3750) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [35/36] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.4111 (0.5475) acc_x 87.5000 (84.2857) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/13] time 0.182 (0.173) data 0.105 (0.096) loss_u loss_u 0.6382 (0.7089) acc_u 40.6250 (31.8750) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/13] time 0.200 (0.174) data 0.122 (0.097) loss_u loss_u 0.6455 (0.7267) acc_u 37.5000 (30.3125) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 330
confident_label rate tensor(0.7006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1121
clean true:1121
clean false:0
clean_rate:1.0
noisy true:149
noisy false:330
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 479
epoch [64/200] batch [5/35] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.2566 (0.4517) acc_x 93.7500 (87.5000) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [10/35] time 0.167 (0.176) data 0.091 (0.099) loss_x loss_x 1.3828 (0.6774) acc_x 71.8750 (85.0000) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [15/35] time 0.164 (0.173) data 0.087 (0.096) loss_x loss_x 0.6821 (0.6724) acc_x 78.1250 (83.7500) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/35] time 0.176 (0.174) data 0.098 (0.097) loss_x loss_x 0.3774 (0.5859) acc_x 87.5000 (85.3125) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/35] time 0.165 (0.175) data 0.089 (0.098) loss_x loss_x 0.3804 (0.5482) acc_x 93.7500 (85.6250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/35] time 0.185 (0.175) data 0.109 (0.098) loss_x loss_x 0.1587 (0.5214) acc_x 96.8750 (86.2500) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [35/35] time 0.184 (0.177) data 0.108 (0.100) loss_x loss_x 0.2913 (0.5191) acc_x 90.6250 (86.4286) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/14] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.6592 (0.6472) acc_u 40.6250 (40.6250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/14] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.5972 (0.6431) acc_u 43.7500 (40.6250) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 300
confident_label rate tensor(0.7175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1148
clean true:1147
clean false:1
clean_rate:0.9991289198606271
noisy true:153
noisy false:299
after delete: len(clean_dataset) 1148
after delete: len(noisy_dataset) 452
epoch [65/200] batch [5/35] time 0.170 (0.178) data 0.094 (0.102) loss_x loss_x 0.4934 (0.5678) acc_x 84.3750 (86.2500) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/35] time 0.180 (0.180) data 0.104 (0.104) loss_x loss_x 0.6006 (0.5178) acc_x 84.3750 (86.8750) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/35] time 0.162 (0.176) data 0.086 (0.099) loss_x loss_x 0.3489 (0.5143) acc_x 90.6250 (86.4583) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/35] time 0.170 (0.177) data 0.094 (0.100) loss_x loss_x 0.5913 (0.5097) acc_x 81.2500 (86.4062) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/35] time 0.185 (0.176) data 0.109 (0.099) loss_x loss_x 0.3386 (0.5006) acc_x 93.7500 (86.7500) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [30/35] time 0.165 (0.175) data 0.088 (0.098) loss_x loss_x 0.4912 (0.5039) acc_x 87.5000 (86.7708) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [35/35] time 0.173 (0.174) data 0.096 (0.098) loss_x loss_x 0.4429 (0.5044) acc_x 90.6250 (86.5179) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/14] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.6392 (0.7023) acc_u 40.6250 (33.7500) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [10/14] time 0.164 (0.175) data 0.086 (0.098) loss_u loss_u 0.7490 (0.7007) acc_u 25.0000 (32.5000) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 328
confident_label rate tensor(0.6981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1117
clean true:1116
clean false:1
clean_rate:0.999104744852283
noisy true:156
noisy false:327
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 483
epoch [66/200] batch [5/34] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.3633 (0.5344) acc_x 90.6250 (86.2500) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/34] time 0.168 (0.178) data 0.092 (0.101) loss_x loss_x 0.7734 (0.5511) acc_x 81.2500 (85.9375) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/34] time 0.182 (0.177) data 0.106 (0.100) loss_x loss_x 0.3311 (0.5438) acc_x 93.7500 (86.4583) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/34] time 0.162 (0.175) data 0.086 (0.098) loss_x loss_x 0.7168 (0.5620) acc_x 84.3750 (86.7188) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/34] time 0.186 (0.176) data 0.110 (0.100) loss_x loss_x 0.2426 (0.5504) acc_x 93.7500 (86.7500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/34] time 0.181 (0.177) data 0.105 (0.100) loss_x loss_x 0.5918 (0.5562) acc_x 84.3750 (86.7708) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/15] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.6938 (0.6682) acc_u 34.3750 (37.5000) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/15] time 0.167 (0.177) data 0.089 (0.100) loss_u loss_u 0.7158 (0.6754) acc_u 37.5000 (36.8750) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [15/15] time 0.169 (0.176) data 0.090 (0.098) loss_u loss_u 0.6313 (0.6721) acc_u 40.6250 (36.4583) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 304
confident_label rate tensor(0.7181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1149
clean true:1148
clean false:1
clean_rate:0.999129677980853
noisy true:148
noisy false:303
after delete: len(clean_dataset) 1149
after delete: len(noisy_dataset) 451
epoch [67/200] batch [5/35] time 0.188 (0.187) data 0.112 (0.110) loss_x loss_x 0.4973 (0.4720) acc_x 81.2500 (85.6250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/35] time 0.187 (0.190) data 0.110 (0.113) loss_x loss_x 0.5835 (0.5671) acc_x 84.3750 (84.0625) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/35] time 0.174 (0.187) data 0.097 (0.110) loss_x loss_x 0.3083 (0.5261) acc_x 90.6250 (85.4167) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/35] time 0.160 (0.185) data 0.083 (0.108) loss_x loss_x 0.2556 (0.5148) acc_x 93.7500 (85.7812) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [25/35] time 0.166 (0.181) data 0.089 (0.104) loss_x loss_x 0.2969 (0.4934) acc_x 90.6250 (86.1250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/35] time 0.171 (0.180) data 0.095 (0.103) loss_x loss_x 0.6514 (0.4870) acc_x 87.5000 (86.8750) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [35/35] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 0.5479 (0.5062) acc_x 78.1250 (85.8929) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/14] time 0.183 (0.180) data 0.107 (0.103) loss_u loss_u 0.6685 (0.7512) acc_u 37.5000 (30.0000) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/14] time 0.166 (0.179) data 0.088 (0.102) loss_u loss_u 0.6177 (0.6844) acc_u 46.8750 (36.2500) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.7069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1131
clean true:1130
clean false:1
clean_rate:0.9991158267020336
noisy true:159
noisy false:310
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 469
epoch [68/200] batch [5/35] time 0.184 (0.180) data 0.108 (0.104) loss_x loss_x 0.3027 (0.4021) acc_x 87.5000 (91.8750) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/35] time 0.178 (0.180) data 0.102 (0.103) loss_x loss_x 0.3738 (0.4631) acc_x 84.3750 (87.8125) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/35] time 0.189 (0.182) data 0.113 (0.106) loss_x loss_x 0.6982 (0.5475) acc_x 78.1250 (84.1667) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [20/35] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.5479 (0.5006) acc_x 81.2500 (85.4688) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/35] time 0.198 (0.184) data 0.122 (0.108) loss_x loss_x 0.5703 (0.5070) acc_x 78.1250 (85.2500) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [30/35] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.4089 (0.5059) acc_x 84.3750 (85.1042) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [35/35] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.4226 (0.5178) acc_x 87.5000 (84.9107) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/14] time 0.178 (0.185) data 0.101 (0.108) loss_u loss_u 0.7456 (0.6889) acc_u 28.1250 (35.0000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/14] time 0.159 (0.183) data 0.081 (0.106) loss_u loss_u 0.6079 (0.7041) acc_u 43.7500 (33.4375) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 274
confident_label rate tensor(0.7294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1167
clean true:1164
clean false:3
clean_rate:0.9974293059125964
noisy true:162
noisy false:271
after delete: len(clean_dataset) 1167
after delete: len(noisy_dataset) 433
epoch [69/200] batch [5/36] time 0.187 (0.185) data 0.109 (0.108) loss_x loss_x 0.3535 (0.5450) acc_x 90.6250 (83.1250) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/36] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.2705 (0.4746) acc_x 90.6250 (85.9375) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [15/36] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.6504 (0.5041) acc_x 78.1250 (85.4167) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [20/36] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 0.8320 (0.5419) acc_x 71.8750 (84.0625) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [25/36] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.6323 (0.5550) acc_x 84.3750 (83.8750) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [30/36] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.6743 (0.5646) acc_x 81.2500 (83.6458) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [35/36] time 0.165 (0.176) data 0.088 (0.099) loss_x loss_x 0.3870 (0.5586) acc_x 81.2500 (83.5714) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/13] time 0.177 (0.176) data 0.100 (0.099) loss_u loss_u 0.7803 (0.6488) acc_u 28.1250 (40.6250) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/13] time 0.177 (0.176) data 0.098 (0.099) loss_u loss_u 0.6938 (0.6927) acc_u 28.1250 (34.0625) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 302
confident_label rate tensor(0.7163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1146
clean true:1144
clean false:2
clean_rate:0.9982547993019197
noisy true:154
noisy false:300
after delete: len(clean_dataset) 1146
after delete: len(noisy_dataset) 454
epoch [70/200] batch [5/35] time 0.173 (0.177) data 0.096 (0.100) loss_x loss_x 0.5894 (0.7197) acc_x 84.3750 (82.5000) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/35] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.6226 (0.5997) acc_x 81.2500 (85.0000) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/35] time 0.159 (0.178) data 0.083 (0.101) loss_x loss_x 0.5991 (0.6138) acc_x 81.2500 (84.1667) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/35] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.7554 (0.6098) acc_x 78.1250 (84.3750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/35] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 0.4062 (0.6128) acc_x 87.5000 (84.6250) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [30/35] time 0.184 (0.175) data 0.107 (0.099) loss_x loss_x 0.2156 (0.5879) acc_x 93.7500 (85.3125) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [35/35] time 0.176 (0.175) data 0.098 (0.098) loss_x loss_x 0.3867 (0.5691) acc_x 90.6250 (85.7143) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/14] time 0.174 (0.175) data 0.098 (0.099) loss_u loss_u 0.6587 (0.6970) acc_u 43.7500 (34.3750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/14] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.7163 (0.7131) acc_u 34.3750 (32.8125) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 285
confident_label rate tensor(0.7306, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1169
clean true:1169
clean false:0
clean_rate:1.0
noisy true:146
noisy false:285
after delete: len(clean_dataset) 1169
after delete: len(noisy_dataset) 431
epoch [71/200] batch [5/36] time 0.188 (0.186) data 0.112 (0.110) loss_x loss_x 0.4348 (0.5610) acc_x 87.5000 (83.7500) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/36] time 0.188 (0.186) data 0.112 (0.109) loss_x loss_x 0.3633 (0.5235) acc_x 87.5000 (85.3125) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [15/36] time 0.184 (0.186) data 0.108 (0.109) loss_x loss_x 0.5889 (0.4966) acc_x 87.5000 (86.8750) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [20/36] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.8521 (0.5195) acc_x 81.2500 (86.5625) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/36] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.2070 (0.5167) acc_x 96.8750 (87.0000) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [30/36] time 0.176 (0.185) data 0.100 (0.108) loss_x loss_x 0.6108 (0.5148) acc_x 75.0000 (86.7708) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [35/36] time 0.167 (0.182) data 0.091 (0.105) loss_x loss_x 1.1104 (0.5276) acc_x 71.8750 (86.4286) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/13] time 0.166 (0.181) data 0.088 (0.104) loss_u loss_u 0.6689 (0.7041) acc_u 43.7500 (35.6250) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [10/13] time 0.157 (0.179) data 0.080 (0.102) loss_u loss_u 0.7393 (0.7213) acc_u 34.3750 (32.8125) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 286
confident_label rate tensor(0.7244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1159
clean true:1155
clean false:4
clean_rate:0.996548748921484
noisy true:159
noisy false:282
after delete: len(clean_dataset) 1159
after delete: len(noisy_dataset) 441
epoch [72/200] batch [5/36] time 0.168 (0.182) data 0.091 (0.105) loss_x loss_x 0.2318 (0.4058) acc_x 93.7500 (86.8750) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/36] time 0.175 (0.180) data 0.098 (0.104) loss_x loss_x 0.4568 (0.4359) acc_x 87.5000 (85.3125) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/36] time 0.188 (0.183) data 0.111 (0.106) loss_x loss_x 0.4207 (0.4878) acc_x 90.6250 (84.5833) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [20/36] time 0.171 (0.182) data 0.094 (0.105) loss_x loss_x 0.7026 (0.5219) acc_x 87.5000 (84.8438) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [25/36] time 0.170 (0.182) data 0.093 (0.105) loss_x loss_x 0.8135 (0.5302) acc_x 81.2500 (85.1250) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [30/36] time 0.163 (0.179) data 0.087 (0.103) loss_x loss_x 0.5181 (0.5476) acc_x 78.1250 (84.2708) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [35/36] time 0.183 (0.177) data 0.106 (0.101) loss_x loss_x 0.5552 (0.5548) acc_x 81.2500 (84.2857) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/13] time 0.184 (0.178) data 0.107 (0.102) loss_u loss_u 0.6440 (0.6848) acc_u 37.5000 (33.1250) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/13] time 0.158 (0.176) data 0.081 (0.100) loss_u loss_u 0.6011 (0.6975) acc_u 43.7500 (32.5000) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 318
confident_label rate tensor(0.7094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1135
clean true:1133
clean false:2
clean_rate:0.9982378854625551
noisy true:149
noisy false:316
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 465
epoch [73/200] batch [5/35] time 0.185 (0.191) data 0.109 (0.115) loss_x loss_x 0.7549 (0.5232) acc_x 78.1250 (85.6250) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/35] time 0.208 (0.191) data 0.132 (0.114) loss_x loss_x 0.3088 (0.5170) acc_x 87.5000 (85.6250) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [15/35] time 0.167 (0.188) data 0.090 (0.111) loss_x loss_x 0.3665 (0.5341) acc_x 87.5000 (85.6250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/35] time 0.179 (0.183) data 0.103 (0.107) loss_x loss_x 0.2092 (0.5365) acc_x 96.8750 (85.7812) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/35] time 0.172 (0.182) data 0.095 (0.106) loss_x loss_x 0.4541 (0.5291) acc_x 90.6250 (85.8750) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [30/35] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.3203 (0.5031) acc_x 90.6250 (86.6667) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [35/35] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.6328 (0.5308) acc_x 81.2500 (86.1607) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/14] time 0.167 (0.181) data 0.089 (0.105) loss_u loss_u 0.6230 (0.6889) acc_u 40.6250 (33.1250) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/14] time 0.179 (0.181) data 0.102 (0.104) loss_u loss_u 0.6299 (0.6860) acc_u 40.6250 (34.3750) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 294
confident_label rate tensor(0.7237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1158
clean true:1155
clean false:3
clean_rate:0.9974093264248705
noisy true:151
noisy false:291
after delete: len(clean_dataset) 1158
after delete: len(noisy_dataset) 442
epoch [74/200] batch [5/36] time 0.187 (0.185) data 0.110 (0.109) loss_x loss_x 0.4805 (0.5894) acc_x 90.6250 (86.2500) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/36] time 0.184 (0.187) data 0.108 (0.110) loss_x loss_x 0.3145 (0.5688) acc_x 90.6250 (85.9375) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/36] time 0.171 (0.184) data 0.094 (0.108) loss_x loss_x 0.3618 (0.5319) acc_x 90.6250 (86.4583) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/36] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5225 (0.4948) acc_x 84.3750 (86.8750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/36] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.2119 (0.5004) acc_x 93.7500 (87.0000) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [30/36] time 0.172 (0.182) data 0.095 (0.106) loss_x loss_x 0.4941 (0.5063) acc_x 87.5000 (86.9792) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [35/36] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.2905 (0.5122) acc_x 90.6250 (86.6964) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/13] time 0.160 (0.180) data 0.083 (0.103) loss_u loss_u 0.7969 (0.6782) acc_u 21.8750 (36.8750) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/13] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.7227 (0.7015) acc_u 31.2500 (34.6875) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.7088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1134
clean true:1134
clean false:0
clean_rate:1.0
noisy true:155
noisy false:311
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 466
epoch [75/200] batch [5/35] time 0.186 (0.190) data 0.109 (0.113) loss_x loss_x 0.6606 (0.6105) acc_x 75.0000 (82.5000) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [10/35] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.2957 (0.6019) acc_x 90.6250 (83.1250) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/35] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.5723 (0.5598) acc_x 84.3750 (84.1667) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/35] time 0.177 (0.178) data 0.101 (0.101) loss_x loss_x 0.5034 (0.5285) acc_x 87.5000 (85.0000) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/35] time 0.209 (0.179) data 0.132 (0.103) loss_x loss_x 0.0864 (0.5149) acc_x 100.0000 (85.3750) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [30/35] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.5845 (0.5143) acc_x 81.2500 (85.1042) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [35/35] time 0.189 (0.180) data 0.111 (0.103) loss_x loss_x 0.5449 (0.5180) acc_x 84.3750 (85.0893) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/14] time 0.228 (0.183) data 0.151 (0.106) loss_u loss_u 0.7192 (0.6847) acc_u 34.3750 (35.6250) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/14] time 0.167 (0.181) data 0.090 (0.104) loss_u loss_u 0.6045 (0.6646) acc_u 53.1250 (38.7500) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 301
confident_label rate tensor(0.7200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1152
clean true:1150
clean false:2
clean_rate:0.9982638888888888
noisy true:149
noisy false:299
after delete: len(clean_dataset) 1152
after delete: len(noisy_dataset) 448
epoch [76/200] batch [5/36] time 0.184 (0.182) data 0.108 (0.105) loss_x loss_x 0.6343 (0.5160) acc_x 87.5000 (86.8750) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/36] time 0.166 (0.178) data 0.089 (0.101) loss_x loss_x 0.4204 (0.5315) acc_x 90.6250 (85.9375) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [15/36] time 0.180 (0.178) data 0.103 (0.101) loss_x loss_x 0.6870 (0.5292) acc_x 84.3750 (86.2500) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/36] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.7153 (0.5499) acc_x 78.1250 (85.7812) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/36] time 0.190 (0.177) data 0.112 (0.100) loss_x loss_x 0.9019 (0.5568) acc_x 81.2500 (85.8750) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [30/36] time 0.191 (0.178) data 0.113 (0.101) loss_x loss_x 0.7324 (0.5601) acc_x 84.3750 (85.7292) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [35/36] time 0.185 (0.177) data 0.109 (0.101) loss_x loss_x 0.3879 (0.5807) acc_x 87.5000 (84.9107) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/14] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.7437 (0.7010) acc_u 28.1250 (33.7500) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [10/14] time 0.160 (0.178) data 0.083 (0.101) loss_u loss_u 0.7505 (0.7072) acc_u 31.2500 (33.4375) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 287
confident_label rate tensor(0.7219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1155
clean true:1154
clean false:1
clean_rate:0.9991341991341991
noisy true:159
noisy false:286
after delete: len(clean_dataset) 1155
after delete: len(noisy_dataset) 445
epoch [77/200] batch [5/36] time 0.183 (0.170) data 0.107 (0.093) loss_x loss_x 0.4854 (0.5015) acc_x 87.5000 (88.1250) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/36] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.6455 (0.5766) acc_x 90.6250 (86.8750) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/36] time 0.164 (0.174) data 0.088 (0.097) loss_x loss_x 0.2642 (0.5379) acc_x 90.6250 (87.0833) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/36] time 0.167 (0.173) data 0.089 (0.097) loss_x loss_x 0.3528 (0.5036) acc_x 87.5000 (87.6562) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/36] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.3999 (0.4955) acc_x 87.5000 (87.6250) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/36] time 0.167 (0.173) data 0.090 (0.097) loss_x loss_x 0.4712 (0.4866) acc_x 90.6250 (87.8125) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [35/36] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.6768 (0.5027) acc_x 75.0000 (87.1429) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/13] time 0.164 (0.175) data 0.088 (0.098) loss_u loss_u 0.7275 (0.6792) acc_u 28.1250 (35.0000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/13] time 0.170 (0.175) data 0.090 (0.098) loss_u loss_u 0.6689 (0.6915) acc_u 37.5000 (35.0000) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.7144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1143
clean true:1142
clean false:1
clean_rate:0.9991251093613298
noisy true:142
noisy false:315
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 457
epoch [78/200] batch [5/35] time 0.174 (0.176) data 0.098 (0.099) loss_x loss_x 0.2351 (0.4900) acc_x 96.8750 (87.5000) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/35] time 0.169 (0.173) data 0.092 (0.097) loss_x loss_x 0.5933 (0.5761) acc_x 81.2500 (84.6875) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/35] time 0.211 (0.179) data 0.133 (0.102) loss_x loss_x 0.6333 (0.5599) acc_x 81.2500 (84.5833) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/35] time 0.184 (0.180) data 0.108 (0.104) loss_x loss_x 0.5513 (0.5340) acc_x 87.5000 (85.3125) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/35] time 0.167 (0.180) data 0.090 (0.103) loss_x loss_x 0.4971 (0.5341) acc_x 87.5000 (85.6250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [30/35] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.9141 (0.5264) acc_x 84.3750 (86.4583) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [35/35] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.4214 (0.5285) acc_x 90.6250 (86.3393) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/14] time 0.179 (0.181) data 0.103 (0.104) loss_u loss_u 0.6035 (0.6519) acc_u 43.7500 (40.6250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/14] time 0.168 (0.180) data 0.090 (0.103) loss_u loss_u 0.7710 (0.6838) acc_u 21.8750 (35.9375) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 331
confident_label rate tensor(0.7025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1124
clean true:1120
clean false:4
clean_rate:0.99644128113879
noisy true:149
noisy false:327
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 476
epoch [79/200] batch [5/35] time 0.165 (0.176) data 0.088 (0.099) loss_x loss_x 0.4556 (0.4138) acc_x 90.6250 (88.1250) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/35] time 0.200 (0.174) data 0.123 (0.098) loss_x loss_x 0.6641 (0.5248) acc_x 81.2500 (86.5625) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/35] time 0.170 (0.173) data 0.094 (0.096) loss_x loss_x 0.7471 (0.5964) acc_x 81.2500 (83.9583) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [20/35] time 0.188 (0.174) data 0.111 (0.098) loss_x loss_x 0.3054 (0.5519) acc_x 90.6250 (85.1562) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/35] time 0.184 (0.177) data 0.108 (0.100) loss_x loss_x 0.4375 (0.5446) acc_x 90.6250 (85.8750) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [30/35] time 0.186 (0.179) data 0.110 (0.102) loss_x loss_x 0.7236 (0.5488) acc_x 78.1250 (85.6250) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [35/35] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.8159 (0.5573) acc_x 81.2500 (85.2679) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/14] time 0.186 (0.180) data 0.109 (0.104) loss_u loss_u 0.5664 (0.6808) acc_u 46.8750 (35.6250) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/14] time 0.159 (0.179) data 0.082 (0.102) loss_u loss_u 0.6597 (0.6775) acc_u 40.6250 (36.8750) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 281
confident_label rate tensor(0.7300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1168
clean true:1166
clean false:2
clean_rate:0.9982876712328768
noisy true:153
noisy false:279
after delete: len(clean_dataset) 1168
after delete: len(noisy_dataset) 432
epoch [80/200] batch [5/36] time 0.173 (0.173) data 0.095 (0.096) loss_x loss_x 0.6016 (0.4486) acc_x 84.3750 (88.1250) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/36] time 0.174 (0.171) data 0.097 (0.094) loss_x loss_x 0.4297 (0.4956) acc_x 90.6250 (86.8750) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/36] time 0.172 (0.175) data 0.096 (0.098) loss_x loss_x 0.6719 (0.5461) acc_x 81.2500 (86.2500) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/36] time 0.165 (0.175) data 0.089 (0.097) loss_x loss_x 0.3950 (0.5159) acc_x 84.3750 (86.4062) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/36] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.7935 (0.5543) acc_x 81.2500 (85.5000) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [30/36] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.7603 (0.5799) acc_x 81.2500 (84.8958) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [35/36] time 0.181 (0.176) data 0.105 (0.099) loss_x loss_x 0.3833 (0.5576) acc_x 90.6250 (85.4464) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/13] time 0.183 (0.176) data 0.107 (0.099) loss_u loss_u 0.7993 (0.7296) acc_u 21.8750 (31.2500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [10/13] time 0.169 (0.176) data 0.090 (0.099) loss_u loss_u 0.6763 (0.7056) acc_u 37.5000 (34.0625) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.7231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1157
clean true:1157
clean false:0
clean_rate:1.0
noisy true:145
noisy false:298
after delete: len(clean_dataset) 1157
after delete: len(noisy_dataset) 443
epoch [81/200] batch [5/36] time 0.197 (0.186) data 0.121 (0.109) loss_x loss_x 0.4475 (0.4971) acc_x 87.5000 (86.2500) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [10/36] time 0.172 (0.182) data 0.095 (0.105) loss_x loss_x 0.7607 (0.4859) acc_x 71.8750 (85.9375) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [15/36] time 0.171 (0.181) data 0.094 (0.104) loss_x loss_x 0.6821 (0.5108) acc_x 81.2500 (85.4167) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/36] time 0.169 (0.180) data 0.091 (0.103) loss_x loss_x 0.5845 (0.5608) acc_x 78.1250 (84.0625) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/36] time 0.175 (0.180) data 0.098 (0.103) loss_x loss_x 0.2617 (0.5102) acc_x 93.7500 (85.5000) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [30/36] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.7017 (0.5287) acc_x 78.1250 (84.8958) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [35/36] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.4917 (0.5195) acc_x 87.5000 (85.5357) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/13] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.7729 (0.6899) acc_u 21.8750 (33.1250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/13] time 0.167 (0.177) data 0.089 (0.100) loss_u loss_u 0.6714 (0.6806) acc_u 37.5000 (35.3125) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 291
confident_label rate tensor(0.7225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1156
clean true:1156
clean false:0
clean_rate:1.0
noisy true:153
noisy false:291
after delete: len(clean_dataset) 1156
after delete: len(noisy_dataset) 444
epoch [82/200] batch [5/36] time 0.167 (0.168) data 0.090 (0.091) loss_x loss_x 0.2117 (0.4409) acc_x 100.0000 (90.6250) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/36] time 0.174 (0.175) data 0.097 (0.097) loss_x loss_x 0.4309 (0.4423) acc_x 84.3750 (88.1250) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/36] time 0.184 (0.174) data 0.108 (0.097) loss_x loss_x 0.1848 (0.3938) acc_x 96.8750 (90.0000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/36] time 0.159 (0.175) data 0.082 (0.098) loss_x loss_x 0.6177 (0.4077) acc_x 84.3750 (89.8438) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/36] time 0.174 (0.175) data 0.098 (0.098) loss_x loss_x 0.6191 (0.4437) acc_x 90.6250 (89.1250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [30/36] time 0.181 (0.175) data 0.105 (0.098) loss_x loss_x 0.5732 (0.4406) acc_x 81.2500 (88.7500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [35/36] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.2847 (0.4340) acc_x 93.7500 (88.8393) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/13] time 0.169 (0.173) data 0.091 (0.096) loss_u loss_u 0.6953 (0.7289) acc_u 37.5000 (32.5000) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [10/13] time 0.174 (0.174) data 0.097 (0.097) loss_u loss_u 0.7217 (0.7152) acc_u 25.0000 (32.5000) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 290
confident_label rate tensor(0.7219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1155
clean true:1155
clean false:0
clean_rate:1.0
noisy true:155
noisy false:290
after delete: len(clean_dataset) 1155
after delete: len(noisy_dataset) 445
epoch [83/200] batch [5/36] time 0.172 (0.172) data 0.095 (0.096) loss_x loss_x 0.3542 (0.5580) acc_x 90.6250 (83.7500) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/36] time 0.166 (0.173) data 0.090 (0.096) loss_x loss_x 0.4092 (0.5251) acc_x 87.5000 (84.6875) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/36] time 0.172 (0.173) data 0.095 (0.096) loss_x loss_x 0.3391 (0.4953) acc_x 84.3750 (85.4167) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [20/36] time 0.170 (0.176) data 0.092 (0.099) loss_x loss_x 0.5215 (0.5105) acc_x 81.2500 (85.3125) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/36] time 0.192 (0.176) data 0.115 (0.099) loss_x loss_x 0.2294 (0.5023) acc_x 93.7500 (86.1250) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [30/36] time 0.182 (0.176) data 0.105 (0.100) loss_x loss_x 0.6616 (0.5214) acc_x 87.5000 (85.6250) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [35/36] time 0.169 (0.177) data 0.093 (0.100) loss_x loss_x 0.3298 (0.5351) acc_x 93.7500 (85.3571) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/13] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.7568 (0.6919) acc_u 28.1250 (34.3750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/13] time 0.170 (0.176) data 0.091 (0.099) loss_u loss_u 0.6792 (0.7050) acc_u 40.6250 (34.3750) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.7175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1148
clean true:1146
clean false:2
clean_rate:0.9982578397212544
noisy true:155
noisy false:297
after delete: len(clean_dataset) 1148
after delete: len(noisy_dataset) 452
epoch [84/200] batch [5/35] time 0.168 (0.179) data 0.092 (0.102) loss_x loss_x 0.5308 (0.4429) acc_x 87.5000 (88.1250) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/35] time 0.169 (0.178) data 0.092 (0.101) loss_x loss_x 0.6362 (0.4480) acc_x 81.2500 (87.8125) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/35] time 0.193 (0.178) data 0.115 (0.101) loss_x loss_x 0.5137 (0.4271) acc_x 84.3750 (88.3333) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/35] time 0.167 (0.177) data 0.091 (0.100) loss_x loss_x 0.4155 (0.4727) acc_x 84.3750 (86.8750) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/35] time 0.192 (0.177) data 0.116 (0.100) loss_x loss_x 0.5527 (0.4711) acc_x 81.2500 (86.7500) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [30/35] time 0.196 (0.179) data 0.120 (0.102) loss_x loss_x 0.4250 (0.4929) acc_x 90.6250 (85.9375) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [35/35] time 0.190 (0.180) data 0.113 (0.103) loss_x loss_x 0.6235 (0.5107) acc_x 84.3750 (85.5357) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/14] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.7100 (0.6872) acc_u 37.5000 (35.0000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/14] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.6846 (0.6889) acc_u 40.6250 (35.6250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 296
confident_label rate tensor(0.7150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1144
clean true:1143
clean false:1
clean_rate:0.9991258741258742
noisy true:161
noisy false:295
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 456
epoch [85/200] batch [5/35] time 0.185 (0.188) data 0.109 (0.112) loss_x loss_x 0.5649 (0.4245) acc_x 87.5000 (90.0000) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/35] time 0.181 (0.185) data 0.105 (0.109) loss_x loss_x 0.4993 (0.4278) acc_x 87.5000 (90.6250) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [15/35] time 0.172 (0.183) data 0.095 (0.107) loss_x loss_x 0.7456 (0.4292) acc_x 81.2500 (89.3750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/35] time 0.157 (0.181) data 0.081 (0.104) loss_x loss_x 0.4368 (0.4532) acc_x 87.5000 (89.0625) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/35] time 0.164 (0.178) data 0.087 (0.101) loss_x loss_x 0.2123 (0.4502) acc_x 93.7500 (88.7500) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [30/35] time 0.168 (0.177) data 0.092 (0.100) loss_x loss_x 0.5112 (0.4616) acc_x 78.1250 (87.8125) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [35/35] time 0.166 (0.175) data 0.089 (0.099) loss_x loss_x 0.3547 (0.4735) acc_x 90.6250 (87.7679) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/14] time 0.170 (0.175) data 0.093 (0.098) loss_u loss_u 0.7241 (0.6735) acc_u 28.1250 (35.6250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/14] time 0.168 (0.174) data 0.090 (0.097) loss_u loss_u 0.6812 (0.6905) acc_u 37.5000 (34.3750) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 305
confident_label rate tensor(0.7138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1142
clean true:1141
clean false:1
clean_rate:0.999124343257443
noisy true:154
noisy false:304
after delete: len(clean_dataset) 1142
after delete: len(noisy_dataset) 458
epoch [86/200] batch [5/35] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.8853 (0.5213) acc_x 75.0000 (86.2500) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/35] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.4622 (0.5367) acc_x 90.6250 (85.3125) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/35] time 0.186 (0.179) data 0.109 (0.102) loss_x loss_x 0.4292 (0.5039) acc_x 90.6250 (86.4583) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [20/35] time 0.184 (0.177) data 0.108 (0.101) loss_x loss_x 0.8916 (0.5427) acc_x 81.2500 (85.1562) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/35] time 0.172 (0.178) data 0.094 (0.101) loss_x loss_x 0.3831 (0.5294) acc_x 93.7500 (85.3750) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [30/35] time 0.164 (0.177) data 0.088 (0.100) loss_x loss_x 0.4980 (0.5182) acc_x 87.5000 (85.6250) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [35/35] time 0.167 (0.177) data 0.091 (0.100) loss_x loss_x 0.4236 (0.5178) acc_x 90.6250 (85.5357) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/14] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.7261 (0.6865) acc_u 34.3750 (35.6250) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [10/14] time 0.190 (0.177) data 0.112 (0.101) loss_u loss_u 0.5742 (0.6675) acc_u 53.1250 (38.1250) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 250
confident_label rate tensor(0.7475, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1196
clean true:1192
clean false:4
clean_rate:0.9966555183946488
noisy true:158
noisy false:246
after delete: len(clean_dataset) 1196
after delete: len(noisy_dataset) 404
epoch [87/200] batch [5/37] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 1.0078 (0.5852) acc_x 75.0000 (85.0000) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/37] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.5537 (0.5564) acc_x 90.6250 (85.0000) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/37] time 0.176 (0.183) data 0.098 (0.106) loss_x loss_x 0.3591 (0.5582) acc_x 90.6250 (85.0000) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [20/37] time 0.162 (0.181) data 0.084 (0.104) loss_x loss_x 0.4138 (0.5632) acc_x 87.5000 (85.3125) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [25/37] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.3044 (0.5557) acc_x 90.6250 (85.5000) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [30/37] time 0.174 (0.180) data 0.097 (0.104) loss_x loss_x 0.6680 (0.5445) acc_x 84.3750 (85.9375) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [35/37] time 0.170 (0.179) data 0.094 (0.102) loss_x loss_x 0.3979 (0.5419) acc_x 90.6250 (86.0714) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/12] time 0.187 (0.178) data 0.111 (0.101) loss_u loss_u 0.7319 (0.7326) acc_u 28.1250 (28.7500) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/12] time 0.184 (0.178) data 0.108 (0.102) loss_u loss_u 0.6265 (0.7186) acc_u 40.6250 (30.3125) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.7106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1137
clean true:1136
clean false:1
clean_rate:0.9991204925241864
noisy true:157
noisy false:306
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 463
epoch [88/200] batch [5/35] time 0.173 (0.176) data 0.097 (0.100) loss_x loss_x 0.2566 (0.4890) acc_x 90.6250 (88.1250) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [10/35] time 0.163 (0.171) data 0.085 (0.095) loss_x loss_x 0.8496 (0.5518) acc_x 71.8750 (86.5625) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/35] time 0.172 (0.171) data 0.096 (0.094) loss_x loss_x 0.3184 (0.5692) acc_x 90.6250 (85.8333) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/35] time 0.183 (0.171) data 0.106 (0.095) loss_x loss_x 0.2644 (0.5506) acc_x 96.8750 (86.0938) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/35] time 0.173 (0.171) data 0.096 (0.095) loss_x loss_x 0.4302 (0.5385) acc_x 93.7500 (87.0000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [30/35] time 0.167 (0.172) data 0.091 (0.096) loss_x loss_x 0.4727 (0.5204) acc_x 84.3750 (87.0833) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [35/35] time 0.177 (0.173) data 0.101 (0.096) loss_x loss_x 0.2639 (0.5089) acc_x 93.7500 (86.9643) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/14] time 0.164 (0.172) data 0.087 (0.095) loss_u loss_u 0.7227 (0.7006) acc_u 28.1250 (34.3750) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/14] time 0.175 (0.172) data 0.098 (0.095) loss_u loss_u 0.6445 (0.6876) acc_u 40.6250 (36.2500) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 286
confident_label rate tensor(0.7275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1164
clean true:1163
clean false:1
clean_rate:0.9991408934707904
noisy true:151
noisy false:285
after delete: len(clean_dataset) 1164
after delete: len(noisy_dataset) 436
epoch [89/200] batch [5/36] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.4526 (0.5161) acc_x 90.6250 (86.8750) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/36] time 0.180 (0.178) data 0.102 (0.102) loss_x loss_x 0.2319 (0.4333) acc_x 93.7500 (88.4375) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/36] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.2588 (0.4279) acc_x 93.7500 (88.7500) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/36] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 0.3186 (0.4693) acc_x 87.5000 (86.8750) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/36] time 0.171 (0.176) data 0.093 (0.099) loss_x loss_x 0.3491 (0.4605) acc_x 90.6250 (86.8750) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [30/36] time 0.193 (0.176) data 0.117 (0.099) loss_x loss_x 0.4624 (0.4709) acc_x 87.5000 (86.5625) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [35/36] time 0.173 (0.175) data 0.096 (0.099) loss_x loss_x 0.8389 (0.4907) acc_x 81.2500 (86.1607) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/13] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.6274 (0.6598) acc_u 43.7500 (38.1250) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [10/13] time 0.174 (0.175) data 0.097 (0.098) loss_u loss_u 0.6812 (0.6739) acc_u 37.5000 (37.5000) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.7169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1147
clean true:1146
clean false:1
clean_rate:0.999128160418483
noisy true:147
noisy false:306
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 453
epoch [90/200] batch [5/35] time 0.220 (0.195) data 0.144 (0.119) loss_x loss_x 0.5054 (0.5981) acc_x 87.5000 (86.2500) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/35] time 0.171 (0.189) data 0.094 (0.112) loss_x loss_x 0.7700 (0.5590) acc_x 84.3750 (86.2500) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/35] time 0.174 (0.185) data 0.098 (0.108) loss_x loss_x 0.2864 (0.5068) acc_x 96.8750 (87.9167) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/35] time 0.174 (0.183) data 0.098 (0.107) loss_x loss_x 0.5093 (0.5194) acc_x 84.3750 (87.1875) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/35] time 0.167 (0.180) data 0.091 (0.103) loss_x loss_x 0.3491 (0.4803) acc_x 90.6250 (87.6250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [30/35] time 0.163 (0.179) data 0.086 (0.103) loss_x loss_x 0.2312 (0.4657) acc_x 90.6250 (87.9167) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [35/35] time 0.165 (0.177) data 0.087 (0.101) loss_x loss_x 0.5864 (0.4903) acc_x 87.5000 (87.0536) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/14] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.6895 (0.6852) acc_u 31.2500 (36.2500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [10/14] time 0.177 (0.177) data 0.100 (0.101) loss_u loss_u 0.6836 (0.6761) acc_u 37.5000 (36.5625) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.7113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1138
clean true:1137
clean false:1
clean_rate:0.9991212653778558
noisy true:147
noisy false:315
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 462
epoch [91/200] batch [5/35] time 0.166 (0.180) data 0.090 (0.103) loss_x loss_x 0.5273 (0.4531) acc_x 84.3750 (87.5000) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/35] time 0.165 (0.175) data 0.089 (0.098) loss_x loss_x 0.5376 (0.4890) acc_x 90.6250 (85.6250) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/35] time 0.173 (0.174) data 0.097 (0.097) loss_x loss_x 0.4775 (0.4846) acc_x 87.5000 (85.6250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/35] time 0.187 (0.175) data 0.110 (0.099) loss_x loss_x 0.5557 (0.5164) acc_x 87.5000 (85.6250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/35] time 0.163 (0.174) data 0.087 (0.098) loss_x loss_x 0.4661 (0.5117) acc_x 90.6250 (86.0000) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [30/35] time 0.159 (0.172) data 0.083 (0.095) loss_x loss_x 0.3904 (0.5241) acc_x 87.5000 (86.0417) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [35/35] time 0.166 (0.171) data 0.090 (0.094) loss_x loss_x 0.3787 (0.5323) acc_x 93.7500 (85.8929) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/14] time 0.162 (0.170) data 0.085 (0.093) loss_u loss_u 0.6753 (0.6589) acc_u 34.3750 (39.3750) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [10/14] time 0.172 (0.169) data 0.095 (0.093) loss_u loss_u 0.7148 (0.6500) acc_u 31.2500 (39.6875) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 282
confident_label rate tensor(0.7244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1159
clean true:1159
clean false:0
clean_rate:1.0
noisy true:159
noisy false:282
after delete: len(clean_dataset) 1159
after delete: len(noisy_dataset) 441
epoch [92/200] batch [5/36] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.2219 (0.4129) acc_x 96.8750 (89.3750) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/36] time 0.174 (0.182) data 0.097 (0.105) loss_x loss_x 0.4949 (0.5297) acc_x 84.3750 (86.2500) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/36] time 0.185 (0.181) data 0.108 (0.105) loss_x loss_x 0.3997 (0.4991) acc_x 87.5000 (86.8750) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [20/36] time 0.169 (0.179) data 0.092 (0.103) loss_x loss_x 0.4463 (0.4456) acc_x 84.3750 (87.8125) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/36] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.7515 (0.4521) acc_x 75.0000 (87.1250) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [30/36] time 0.179 (0.176) data 0.102 (0.100) loss_x loss_x 0.6006 (0.4687) acc_x 84.3750 (86.5625) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [35/36] time 0.162 (0.175) data 0.085 (0.098) loss_x loss_x 0.6523 (0.5026) acc_x 84.3750 (85.8036) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/13] time 0.188 (0.177) data 0.111 (0.100) loss_u loss_u 0.8994 (0.7016) acc_u 9.3750 (31.2500) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/13] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.6821 (0.7042) acc_u 34.3750 (33.1250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 249
confident_label rate tensor(0.7462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1194
clean true:1190
clean false:4
clean_rate:0.9966499162479062
noisy true:161
noisy false:245
after delete: len(clean_dataset) 1194
after delete: len(noisy_dataset) 406
epoch [93/200] batch [5/37] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.4048 (0.4116) acc_x 93.7500 (90.0000) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/37] time 0.173 (0.173) data 0.097 (0.096) loss_x loss_x 0.6689 (0.5036) acc_x 78.1250 (86.2500) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/37] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.7476 (0.5451) acc_x 84.3750 (85.8333) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/37] time 0.201 (0.175) data 0.124 (0.099) loss_x loss_x 0.6025 (0.5324) acc_x 78.1250 (86.4062) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/37] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.1892 (0.5158) acc_x 96.8750 (86.5000) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [30/37] time 0.181 (0.176) data 0.103 (0.099) loss_x loss_x 0.9336 (0.5217) acc_x 78.1250 (86.2500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [35/37] time 0.162 (0.176) data 0.086 (0.099) loss_x loss_x 0.7651 (0.5213) acc_x 87.5000 (86.6071) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/12] time 0.166 (0.176) data 0.089 (0.099) loss_u loss_u 0.6338 (0.7149) acc_u 43.7500 (33.7500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [10/12] time 0.188 (0.175) data 0.111 (0.099) loss_u loss_u 0.6021 (0.7105) acc_u 43.7500 (34.0625) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 282
confident_label rate tensor(0.7262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1162
clean true:1161
clean false:1
clean_rate:0.9991394148020654
noisy true:157
noisy false:281
after delete: len(clean_dataset) 1162
after delete: len(noisy_dataset) 438
epoch [94/200] batch [5/36] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.8130 (0.5807) acc_x 75.0000 (83.1250) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/36] time 0.175 (0.175) data 0.097 (0.098) loss_x loss_x 0.1115 (0.5672) acc_x 100.0000 (83.4375) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/36] time 0.186 (0.179) data 0.109 (0.102) loss_x loss_x 0.6914 (0.5336) acc_x 81.2500 (84.3750) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/36] time 0.167 (0.177) data 0.088 (0.100) loss_x loss_x 0.5967 (0.5367) acc_x 87.5000 (84.5312) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/36] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.5132 (0.5305) acc_x 84.3750 (84.8750) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [30/36] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.2690 (0.5158) acc_x 96.8750 (85.3125) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [35/36] time 0.160 (0.177) data 0.083 (0.100) loss_x loss_x 0.4492 (0.5224) acc_x 87.5000 (85.5357) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/13] time 0.165 (0.176) data 0.088 (0.099) loss_u loss_u 0.6343 (0.6528) acc_u 43.7500 (39.3750) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [10/13] time 0.166 (0.175) data 0.087 (0.098) loss_u loss_u 0.6094 (0.6618) acc_u 43.7500 (38.1250) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 269
confident_label rate tensor(0.7337, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1174
clean true:1173
clean false:1
clean_rate:0.9991482112436116
noisy true:158
noisy false:268
after delete: len(clean_dataset) 1174
after delete: len(noisy_dataset) 426
epoch [95/200] batch [5/36] time 0.204 (0.180) data 0.127 (0.103) loss_x loss_x 0.2949 (0.4764) acc_x 93.7500 (86.8750) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/36] time 0.179 (0.178) data 0.101 (0.101) loss_x loss_x 0.5083 (0.5280) acc_x 87.5000 (85.3125) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/36] time 0.169 (0.177) data 0.093 (0.100) loss_x loss_x 0.6572 (0.5099) acc_x 87.5000 (87.0833) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [20/36] time 0.182 (0.177) data 0.104 (0.100) loss_x loss_x 0.3777 (0.5294) acc_x 87.5000 (86.5625) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/36] time 0.184 (0.178) data 0.108 (0.101) loss_x loss_x 0.2201 (0.4948) acc_x 93.7500 (87.1250) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [30/36] time 0.188 (0.180) data 0.112 (0.103) loss_x loss_x 0.5771 (0.4772) acc_x 90.6250 (87.3958) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [35/36] time 0.185 (0.181) data 0.107 (0.104) loss_x loss_x 0.9990 (0.4941) acc_x 71.8750 (86.9643) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/13] time 0.180 (0.181) data 0.102 (0.105) loss_u loss_u 0.6592 (0.6729) acc_u 37.5000 (36.2500) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/13] time 0.177 (0.181) data 0.099 (0.104) loss_u loss_u 0.7300 (0.7155) acc_u 28.1250 (31.5625) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 315
confident_label rate tensor(0.7113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1138
clean true:1138
clean false:0
clean_rate:1.0
noisy true:147
noisy false:315
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 462
epoch [96/200] batch [5/35] time 0.172 (0.178) data 0.095 (0.101) loss_x loss_x 0.4597 (0.4812) acc_x 87.5000 (87.5000) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/35] time 0.189 (0.178) data 0.112 (0.102) loss_x loss_x 0.2629 (0.5130) acc_x 90.6250 (86.2500) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/35] time 0.164 (0.176) data 0.087 (0.099) loss_x loss_x 0.3855 (0.5276) acc_x 90.6250 (86.0417) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/35] time 0.178 (0.175) data 0.100 (0.098) loss_x loss_x 0.4434 (0.5086) acc_x 87.5000 (86.7188) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/35] time 0.175 (0.175) data 0.098 (0.098) loss_x loss_x 0.2856 (0.4887) acc_x 96.8750 (87.0000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [30/35] time 0.190 (0.178) data 0.113 (0.101) loss_x loss_x 0.5308 (0.4932) acc_x 84.3750 (86.6667) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [35/35] time 0.181 (0.179) data 0.105 (0.102) loss_x loss_x 0.7544 (0.4917) acc_x 84.3750 (86.9643) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/14] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.6885 (0.6484) acc_u 34.3750 (39.3750) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [10/14] time 0.157 (0.178) data 0.081 (0.101) loss_u loss_u 0.6592 (0.6687) acc_u 43.7500 (37.8125) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 274
confident_label rate tensor(0.7287, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1166
clean true:1165
clean false:1
clean_rate:0.9991423670668954
noisy true:161
noisy false:273
after delete: len(clean_dataset) 1166
after delete: len(noisy_dataset) 434
epoch [97/200] batch [5/36] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.3604 (0.6607) acc_x 90.6250 (86.2500) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [10/36] time 0.185 (0.183) data 0.108 (0.107) loss_x loss_x 0.4868 (0.5937) acc_x 90.6250 (86.2500) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/36] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.6411 (0.5557) acc_x 78.1250 (86.6667) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/36] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.4829 (0.5692) acc_x 87.5000 (86.4062) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/36] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.5278 (0.5420) acc_x 87.5000 (87.1250) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [30/36] time 0.189 (0.185) data 0.113 (0.108) loss_x loss_x 0.3318 (0.5155) acc_x 90.6250 (87.6042) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [35/36] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.5991 (0.5160) acc_x 84.3750 (87.4107) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/13] time 0.170 (0.182) data 0.093 (0.105) loss_u loss_u 0.7568 (0.6440) acc_u 25.0000 (38.7500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [10/13] time 0.169 (0.180) data 0.090 (0.103) loss_u loss_u 0.7642 (0.6902) acc_u 28.1250 (34.6875) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 257
confident_label rate tensor(0.7469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1195
clean true:1195
clean false:0
clean_rate:1.0
noisy true:148
noisy false:257
after delete: len(clean_dataset) 1195
after delete: len(noisy_dataset) 405
epoch [98/200] batch [5/37] time 0.188 (0.174) data 0.111 (0.098) loss_x loss_x 0.3186 (0.4342) acc_x 93.7500 (89.3750) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/37] time 0.183 (0.179) data 0.106 (0.103) loss_x loss_x 0.7056 (0.4679) acc_x 78.1250 (87.1875) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/37] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.4827 (0.4275) acc_x 81.2500 (87.0833) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/37] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.6411 (0.4841) acc_x 84.3750 (86.5625) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [25/37] time 0.178 (0.182) data 0.101 (0.106) loss_x loss_x 0.6562 (0.5026) acc_x 84.3750 (85.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [30/37] time 0.162 (0.179) data 0.085 (0.103) loss_x loss_x 0.9214 (0.5377) acc_x 84.3750 (85.4167) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [35/37] time 0.160 (0.179) data 0.084 (0.102) loss_x loss_x 0.5669 (0.5328) acc_x 87.5000 (85.9821) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/12] time 0.160 (0.176) data 0.084 (0.099) loss_u loss_u 0.8315 (0.7637) acc_u 18.7500 (26.8750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [10/12] time 0.168 (0.175) data 0.089 (0.098) loss_u loss_u 0.6245 (0.7258) acc_u 40.6250 (31.2500) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 285
confident_label rate tensor(0.7275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1164
clean true:1162
clean false:2
clean_rate:0.9982817869415808
noisy true:153
noisy false:283
after delete: len(clean_dataset) 1164
after delete: len(noisy_dataset) 436
epoch [99/200] batch [5/36] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.7993 (0.6599) acc_x 75.0000 (81.8750) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [10/36] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.4534 (0.5972) acc_x 84.3750 (83.1250) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/36] time 0.178 (0.183) data 0.100 (0.106) loss_x loss_x 0.5786 (0.5419) acc_x 81.2500 (85.0000) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [20/36] time 0.163 (0.179) data 0.087 (0.102) loss_x loss_x 0.8188 (0.5805) acc_x 78.1250 (83.7500) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/36] time 0.183 (0.178) data 0.107 (0.101) loss_x loss_x 0.5767 (0.5836) acc_x 84.3750 (83.8750) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [30/36] time 0.183 (0.177) data 0.107 (0.101) loss_x loss_x 0.3152 (0.5609) acc_x 93.7500 (84.4792) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [35/36] time 0.162 (0.177) data 0.085 (0.100) loss_x loss_x 0.4622 (0.5472) acc_x 84.3750 (84.8214) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/13] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.7739 (0.6912) acc_u 28.1250 (38.1250) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [10/13] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.8066 (0.7140) acc_u 21.8750 (34.3750) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 294
confident_label rate tensor(0.7200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1152
clean true:1152
clean false:0
clean_rate:1.0
noisy true:154
noisy false:294
all clean rate:  [0.9954682779456193, 0.9975429975429976, 1.0, 0.9979777553083923, 1.0, 1.0, 0.9990319457889641, 1.0, 1.0, 0.9990366088631984, 1.0, 0.9990375360923965, 1.0, 1.0, 0.9980732177263969, 0.9990583804143126, 1.0, 1.0, 0.9971698113207547, 0.9990783410138249, 0.9990850869167429, 0.999083409715857, 0.9990766389658357, 1.0, 1.0, 0.9990783410138249, 1.0, 1.0, 0.9990859232175503, 0.9990800367985281, 1.0, 0.9991087344028521, 1.0, 1.0, 0.9981617647058824, 1.0, 0.9991158267020336, 0.9990999099909991, 0.9981464318813716, 0.999096657633243, 1.0, 0.998166819431714, 0.9990900818926297, 0.9991079393398751, 0.9990867579908675, 0.9991063449508489, 0.9991087344028521, 1.0, 1.0, 0.9990990990990991, 0.99822695035461, 0.9990950226244344, 1.0, 1.0, 0.9991063449508489, 0.9982316534040672, 1.0, 0.9956559513466551, 1.0, 1.0, 0.9991266375545852, 0.9982532751091703, 1.0, 1.0, 0.9991289198606271, 0.999104744852283, 0.999129677980853, 0.9991158267020336, 0.9974293059125964, 0.9982547993019197, 1.0, 0.996548748921484, 0.9982378854625551, 0.9974093264248705, 1.0, 0.9982638888888888, 0.9991341991341991, 0.9991251093613298, 0.99644128113879, 0.9982876712328768, 1.0, 1.0, 1.0, 0.9982578397212544, 0.9991258741258742, 0.999124343257443, 0.9966555183946488, 0.9991204925241864, 0.9991408934707904, 0.999128160418483, 0.9991212653778558, 1.0, 0.9966499162479062, 0.9991394148020654, 0.9991482112436116, 1.0, 0.9991423670668954, 1.0, 0.9982817869415808, 1.0]
after delete: len(clean_dataset) 1152
after delete: len(noisy_dataset) 448
epoch [100/200] batch [5/36] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.5757 (0.4725) acc_x 87.5000 (88.7500) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/36] time 0.188 (0.186) data 0.112 (0.109) loss_x loss_x 0.3167 (0.4569) acc_x 93.7500 (89.3750) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/36] time 0.194 (0.186) data 0.118 (0.109) loss_x loss_x 0.3335 (0.4543) acc_x 90.6250 (88.7500) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/36] time 0.192 (0.186) data 0.116 (0.109) loss_x loss_x 0.5840 (0.4627) acc_x 87.5000 (88.4375) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/36] time 0.166 (0.184) data 0.090 (0.107) loss_x loss_x 0.6851 (0.4384) acc_x 81.2500 (89.1250) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [30/36] time 0.180 (0.182) data 0.102 (0.105) loss_x loss_x 0.4126 (0.4303) acc_x 84.3750 (89.0625) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [35/36] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.8706 (0.4498) acc_x 75.0000 (88.5714) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/14] time 0.190 (0.183) data 0.114 (0.107) loss_u loss_u 0.7329 (0.6763) acc_u 37.5000 (36.2500) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [10/14] time 0.183 (0.184) data 0.107 (0.107) loss_u loss_u 0.8286 (0.6983) acc_u 18.7500 (34.6875) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 276
confident_label rate tensor(0.7294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1167
clean true:1166
clean false:1
clean_rate:0.9991431019708654
noisy true:158
noisy false:275
after delete: len(clean_dataset) 1167
after delete: len(noisy_dataset) 433
epoch [101/200] batch [5/36] time 0.177 (0.180) data 0.100 (0.103) loss_x loss_x 0.6050 (0.4716) acc_x 87.5000 (86.8750) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [10/36] time 0.185 (0.178) data 0.109 (0.101) loss_x loss_x 0.5864 (0.4956) acc_x 90.6250 (87.1875) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/36] time 0.165 (0.174) data 0.088 (0.097) loss_x loss_x 0.3684 (0.5024) acc_x 93.7500 (88.1250) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [20/36] time 0.175 (0.175) data 0.099 (0.098) loss_x loss_x 0.7847 (0.5135) acc_x 78.1250 (87.9688) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/36] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.8452 (0.5371) acc_x 78.1250 (87.3750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [30/36] time 0.167 (0.173) data 0.090 (0.097) loss_x loss_x 0.6089 (0.5560) acc_x 84.3750 (86.6667) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [35/36] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.6489 (0.5571) acc_x 78.1250 (85.9821) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/13] time 0.188 (0.172) data 0.110 (0.096) loss_u loss_u 0.6353 (0.6638) acc_u 43.7500 (39.3750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/13] time 0.184 (0.174) data 0.108 (0.097) loss_u loss_u 0.6538 (0.6701) acc_u 40.6250 (37.8125) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 271
confident_label rate tensor(0.7319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1171
clean true:1168
clean false:3
clean_rate:0.9974380871050385
noisy true:161
noisy false:268
after delete: len(clean_dataset) 1171
after delete: len(noisy_dataset) 429
epoch [102/200] batch [5/36] time 0.187 (0.186) data 0.111 (0.110) loss_x loss_x 0.7529 (0.4813) acc_x 81.2500 (86.2500) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/36] time 0.188 (0.188) data 0.110 (0.111) loss_x loss_x 0.8267 (0.4995) acc_x 78.1250 (87.1875) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/36] time 0.185 (0.187) data 0.107 (0.111) loss_x loss_x 0.2966 (0.4981) acc_x 90.6250 (86.8750) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/36] time 0.187 (0.186) data 0.111 (0.110) loss_x loss_x 0.4268 (0.5257) acc_x 87.5000 (86.2500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/36] time 0.181 (0.186) data 0.105 (0.109) loss_x loss_x 0.6772 (0.5250) acc_x 78.1250 (86.5000) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [30/36] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.5815 (0.5383) acc_x 90.6250 (86.1458) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [35/36] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.3855 (0.5031) acc_x 90.6250 (86.9643) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/13] time 0.175 (0.186) data 0.098 (0.109) loss_u loss_u 0.6284 (0.7028) acc_u 40.6250 (35.6250) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/13] time 0.176 (0.186) data 0.100 (0.109) loss_u loss_u 0.5947 (0.7045) acc_u 50.0000 (35.3125) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 257
confident_label rate tensor(0.7400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1184
clean true:1182
clean false:2
clean_rate:0.9983108108108109
noisy true:161
noisy false:255
after delete: len(clean_dataset) 1184
after delete: len(noisy_dataset) 416
epoch [103/200] batch [5/37] time 0.158 (0.176) data 0.082 (0.099) loss_x loss_x 0.4028 (0.2771) acc_x 84.3750 (90.6250) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/37] time 0.218 (0.181) data 0.141 (0.104) loss_x loss_x 0.3564 (0.2962) acc_x 90.6250 (90.6250) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/37] time 0.223 (0.194) data 0.146 (0.117) loss_x loss_x 0.6646 (0.3838) acc_x 81.2500 (88.1250) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [20/37] time 0.221 (0.200) data 0.145 (0.123) loss_x loss_x 0.3562 (0.4133) acc_x 90.6250 (87.3438) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [25/37] time 0.228 (0.199) data 0.151 (0.122) loss_x loss_x 0.6284 (0.4433) acc_x 87.5000 (87.1250) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [30/37] time 0.161 (0.200) data 0.084 (0.123) loss_x loss_x 0.2465 (0.4545) acc_x 93.7500 (86.5625) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [35/37] time 0.185 (0.196) data 0.108 (0.119) loss_x loss_x 0.5923 (0.4738) acc_x 84.3750 (86.4286) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/13] time 0.181 (0.194) data 0.104 (0.117) loss_u loss_u 0.6187 (0.6985) acc_u 46.8750 (35.0000) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [10/13] time 0.163 (0.191) data 0.086 (0.114) loss_u loss_u 0.8066 (0.7070) acc_u 21.8750 (32.8125) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 285
confident_label rate tensor(0.7275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1164
clean true:1163
clean false:1
clean_rate:0.9991408934707904
noisy true:152
noisy false:284
after delete: len(clean_dataset) 1164
after delete: len(noisy_dataset) 436
epoch [104/200] batch [5/36] time 0.185 (0.192) data 0.108 (0.115) loss_x loss_x 0.6470 (0.5725) acc_x 81.2500 (86.2500) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [10/36] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.2874 (0.4936) acc_x 90.6250 (86.8750) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/36] time 0.180 (0.186) data 0.103 (0.110) loss_x loss_x 0.4248 (0.5071) acc_x 87.5000 (86.6667) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/36] time 0.192 (0.183) data 0.115 (0.107) loss_x loss_x 0.5972 (0.5279) acc_x 81.2500 (86.4062) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/36] time 0.187 (0.184) data 0.109 (0.107) loss_x loss_x 0.7319 (0.5377) acc_x 78.1250 (85.7500) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [30/36] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.6655 (0.5402) acc_x 84.3750 (85.6250) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [35/36] time 0.163 (0.181) data 0.086 (0.105) loss_x loss_x 0.4739 (0.5252) acc_x 90.6250 (85.8929) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/13] time 0.165 (0.179) data 0.088 (0.102) loss_u loss_u 0.6401 (0.6447) acc_u 43.7500 (41.2500) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/13] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.6831 (0.6622) acc_u 34.3750 (37.8125) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 256
confident_label rate tensor(0.7444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1191
clean true:1191
clean false:0
clean_rate:1.0
noisy true:153
noisy false:256
after delete: len(clean_dataset) 1191
after delete: len(noisy_dataset) 409
epoch [105/200] batch [5/37] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.6323 (0.5112) acc_x 75.0000 (85.6250) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [10/37] time 0.189 (0.179) data 0.112 (0.102) loss_x loss_x 0.9238 (0.4950) acc_x 78.1250 (87.5000) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/37] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.7441 (0.5413) acc_x 78.1250 (85.2083) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/37] time 0.164 (0.174) data 0.088 (0.097) loss_x loss_x 0.3738 (0.5533) acc_x 90.6250 (85.1562) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/37] time 0.157 (0.171) data 0.080 (0.095) loss_x loss_x 0.4895 (0.5558) acc_x 87.5000 (85.1250) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [30/37] time 0.165 (0.170) data 0.089 (0.093) loss_x loss_x 0.2593 (0.5362) acc_x 93.7500 (85.8333) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [35/37] time 0.178 (0.171) data 0.102 (0.095) loss_x loss_x 0.5483 (0.5351) acc_x 87.5000 (86.1607) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/12] time 0.170 (0.172) data 0.093 (0.095) loss_u loss_u 0.7051 (0.6733) acc_u 34.3750 (38.7500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/12] time 0.170 (0.172) data 0.092 (0.095) loss_u loss_u 0.6934 (0.6866) acc_u 34.3750 (35.6250) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 253
confident_label rate tensor(0.7444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1191
clean true:1190
clean false:1
clean_rate:0.9991603694374476
noisy true:157
noisy false:252
after delete: len(clean_dataset) 1191
after delete: len(noisy_dataset) 409
epoch [106/200] batch [5/37] time 0.192 (0.187) data 0.115 (0.111) loss_x loss_x 0.4150 (0.3945) acc_x 90.6250 (90.0000) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/37] time 0.187 (0.185) data 0.109 (0.109) loss_x loss_x 0.5586 (0.4887) acc_x 84.3750 (88.4375) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [15/37] time 0.177 (0.184) data 0.099 (0.107) loss_x loss_x 0.6958 (0.5197) acc_x 87.5000 (87.9167) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [20/37] time 0.172 (0.182) data 0.096 (0.105) loss_x loss_x 0.3137 (0.4848) acc_x 90.6250 (87.8125) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [25/37] time 0.153 (0.179) data 0.076 (0.103) loss_x loss_x 0.6836 (0.4971) acc_x 87.5000 (87.7500) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [30/37] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.6782 (0.4989) acc_x 84.3750 (87.1875) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [35/37] time 0.166 (0.177) data 0.090 (0.101) loss_x loss_x 0.3418 (0.4748) acc_x 87.5000 (87.5893) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/12] time 0.176 (0.176) data 0.098 (0.100) loss_u loss_u 0.7856 (0.7255) acc_u 25.0000 (32.5000) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [10/12] time 0.177 (0.177) data 0.099 (0.100) loss_u loss_u 0.6035 (0.7078) acc_u 46.8750 (34.3750) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 243
confident_label rate tensor(0.7462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1194
clean true:1194
clean false:0
clean_rate:1.0
noisy true:163
noisy false:243
after delete: len(clean_dataset) 1194
after delete: len(noisy_dataset) 406
epoch [107/200] batch [5/37] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.2040 (0.3864) acc_x 96.8750 (90.0000) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/37] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.7197 (0.4578) acc_x 81.2500 (87.8125) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/37] time 0.181 (0.180) data 0.103 (0.104) loss_x loss_x 0.5771 (0.4641) acc_x 84.3750 (88.1250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/37] time 0.193 (0.181) data 0.116 (0.104) loss_x loss_x 0.3186 (0.4565) acc_x 93.7500 (87.9688) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [25/37] time 0.174 (0.183) data 0.098 (0.106) loss_x loss_x 0.2317 (0.4502) acc_x 87.5000 (87.5000) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [30/37] time 0.161 (0.179) data 0.083 (0.102) loss_x loss_x 0.8389 (0.4728) acc_x 78.1250 (86.9792) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [35/37] time 0.181 (0.179) data 0.105 (0.102) loss_x loss_x 0.6685 (0.4817) acc_x 87.5000 (86.8750) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/12] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.7534 (0.6989) acc_u 31.2500 (33.7500) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [10/12] time 0.171 (0.180) data 0.094 (0.103) loss_u loss_u 0.6938 (0.7024) acc_u 34.3750 (35.0000) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 283
confident_label rate tensor(0.7337, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1174
clean true:1172
clean false:2
clean_rate:0.9982964224872232
noisy true:145
noisy false:281
after delete: len(clean_dataset) 1174
after delete: len(noisy_dataset) 426
epoch [108/200] batch [5/36] time 0.174 (0.171) data 0.097 (0.094) loss_x loss_x 0.3723 (0.5287) acc_x 93.7500 (84.3750) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/36] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.4751 (0.4776) acc_x 84.3750 (86.5625) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/36] time 0.194 (0.175) data 0.117 (0.099) loss_x loss_x 0.7319 (0.4916) acc_x 84.3750 (86.6667) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/36] time 0.191 (0.177) data 0.115 (0.100) loss_x loss_x 0.6904 (0.5013) acc_x 75.0000 (85.9375) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/36] time 0.186 (0.178) data 0.110 (0.102) loss_x loss_x 0.9116 (0.5041) acc_x 75.0000 (85.6250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [30/36] time 0.188 (0.180) data 0.112 (0.103) loss_x loss_x 0.5020 (0.4939) acc_x 84.3750 (85.8333) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [35/36] time 0.166 (0.178) data 0.090 (0.102) loss_x loss_x 0.6006 (0.5094) acc_x 90.6250 (85.8036) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/13] time 0.188 (0.179) data 0.111 (0.102) loss_u loss_u 0.7510 (0.6876) acc_u 25.0000 (35.0000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/13] time 0.169 (0.179) data 0.091 (0.102) loss_u loss_u 0.6772 (0.6993) acc_u 34.3750 (33.1250) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.7250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1160
clean true:1160
clean false:0
clean_rate:1.0
noisy true:141
noisy false:299
after delete: len(clean_dataset) 1160
after delete: len(noisy_dataset) 440
epoch [109/200] batch [5/36] time 0.177 (0.173) data 0.098 (0.096) loss_x loss_x 0.3105 (0.4665) acc_x 93.7500 (89.3750) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/36] time 0.190 (0.180) data 0.114 (0.103) loss_x loss_x 0.2673 (0.4425) acc_x 90.6250 (89.3750) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/36] time 0.189 (0.183) data 0.113 (0.106) loss_x loss_x 0.4351 (0.4470) acc_x 90.6250 (89.5833) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/36] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.4673 (0.4330) acc_x 87.5000 (90.0000) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/36] time 0.174 (0.185) data 0.098 (0.108) loss_x loss_x 0.4668 (0.4273) acc_x 87.5000 (89.8750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [30/36] time 0.176 (0.184) data 0.099 (0.107) loss_x loss_x 0.3628 (0.4206) acc_x 93.7500 (90.0000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [35/36] time 0.167 (0.181) data 0.091 (0.105) loss_x loss_x 0.8867 (0.4334) acc_x 84.3750 (89.8214) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/13] time 0.197 (0.181) data 0.120 (0.104) loss_u loss_u 0.7222 (0.7123) acc_u 34.3750 (35.0000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/13] time 0.172 (0.180) data 0.095 (0.103) loss_u loss_u 0.4866 (0.6865) acc_u 56.2500 (37.5000) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 285
confident_label rate tensor(0.7281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1165
clean true:1164
clean false:1
clean_rate:0.9991416309012876
noisy true:151
noisy false:284
after delete: len(clean_dataset) 1165
after delete: len(noisy_dataset) 435
epoch [110/200] batch [5/36] time 0.173 (0.175) data 0.097 (0.098) loss_x loss_x 0.4631 (0.4522) acc_x 81.2500 (85.0000) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/36] time 0.177 (0.175) data 0.101 (0.098) loss_x loss_x 0.6851 (0.4941) acc_x 81.2500 (85.9375) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/36] time 0.187 (0.178) data 0.111 (0.101) loss_x loss_x 0.4519 (0.4791) acc_x 90.6250 (87.2917) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/36] time 0.166 (0.178) data 0.088 (0.101) loss_x loss_x 0.4749 (0.5079) acc_x 84.3750 (86.7188) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/36] time 0.188 (0.178) data 0.111 (0.102) loss_x loss_x 0.4512 (0.5295) acc_x 90.6250 (86.1250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [30/36] time 0.199 (0.179) data 0.123 (0.102) loss_x loss_x 0.1648 (0.5365) acc_x 96.8750 (86.4583) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [35/36] time 0.168 (0.178) data 0.092 (0.101) loss_x loss_x 0.5498 (0.5199) acc_x 90.6250 (87.0536) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/13] time 0.176 (0.178) data 0.099 (0.102) loss_u loss_u 0.6362 (0.6829) acc_u 37.5000 (35.0000) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/13] time 0.174 (0.178) data 0.098 (0.101) loss_u loss_u 0.6650 (0.6610) acc_u 34.3750 (36.5625) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 277
confident_label rate tensor(0.7344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1175
clean true:1173
clean false:2
clean_rate:0.9982978723404256
noisy true:150
noisy false:275
after delete: len(clean_dataset) 1175
after delete: len(noisy_dataset) 425
epoch [111/200] batch [5/36] time 0.171 (0.180) data 0.095 (0.103) loss_x loss_x 0.4753 (0.4248) acc_x 84.3750 (86.8750) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/36] time 0.178 (0.178) data 0.101 (0.102) loss_x loss_x 0.3845 (0.4193) acc_x 90.6250 (89.0625) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/36] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.3940 (0.4294) acc_x 87.5000 (87.9167) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/36] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 0.4746 (0.4646) acc_x 87.5000 (87.0312) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/36] time 0.168 (0.173) data 0.091 (0.096) loss_x loss_x 0.8662 (0.4933) acc_x 71.8750 (86.3750) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [30/36] time 0.179 (0.174) data 0.102 (0.097) loss_x loss_x 0.3167 (0.4926) acc_x 90.6250 (86.1458) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [35/36] time 0.172 (0.173) data 0.096 (0.096) loss_x loss_x 0.2734 (0.4926) acc_x 90.6250 (86.3393) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/13] time 0.165 (0.173) data 0.088 (0.096) loss_u loss_u 0.6851 (0.7441) acc_u 37.5000 (30.6250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/13] time 0.187 (0.175) data 0.110 (0.098) loss_u loss_u 0.7720 (0.7093) acc_u 28.1250 (34.6875) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 292
confident_label rate tensor(0.7256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1161
clean true:1159
clean false:2
clean_rate:0.9982773471145564
noisy true:149
noisy false:290
after delete: len(clean_dataset) 1161
after delete: len(noisy_dataset) 439
epoch [112/200] batch [5/36] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.6333 (0.5551) acc_x 87.5000 (86.8750) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [10/36] time 0.193 (0.181) data 0.117 (0.104) loss_x loss_x 0.6279 (0.5171) acc_x 81.2500 (88.1250) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/36] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.4717 (0.5336) acc_x 87.5000 (87.9167) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/36] time 0.159 (0.178) data 0.083 (0.101) loss_x loss_x 0.6060 (0.5384) acc_x 87.5000 (87.5000) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/36] time 0.166 (0.176) data 0.090 (0.099) loss_x loss_x 0.4683 (0.5378) acc_x 87.5000 (87.5000) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [30/36] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.8442 (0.5290) acc_x 81.2500 (87.6042) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [35/36] time 0.215 (0.176) data 0.138 (0.099) loss_x loss_x 0.3208 (0.5289) acc_x 93.7500 (87.6786) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/13] time 0.179 (0.176) data 0.101 (0.100) loss_u loss_u 0.8564 (0.7481) acc_u 15.6250 (28.7500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/13] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.7261 (0.7273) acc_u 37.5000 (31.8750) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 280
confident_label rate tensor(0.7287, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1166
clean true:1165
clean false:1
clean_rate:0.9991423670668954
noisy true:155
noisy false:279
after delete: len(clean_dataset) 1166
after delete: len(noisy_dataset) 434
epoch [113/200] batch [5/36] time 0.177 (0.177) data 0.101 (0.100) loss_x loss_x 0.2671 (0.5217) acc_x 93.7500 (86.2500) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [10/36] time 0.162 (0.175) data 0.085 (0.098) loss_x loss_x 0.6533 (0.5186) acc_x 87.5000 (85.9375) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/36] time 0.192 (0.177) data 0.116 (0.100) loss_x loss_x 0.4436 (0.4759) acc_x 87.5000 (86.8750) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [20/36] time 0.187 (0.178) data 0.111 (0.101) loss_x loss_x 0.5938 (0.5165) acc_x 84.3750 (85.9375) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/36] time 0.171 (0.175) data 0.095 (0.099) loss_x loss_x 0.8345 (0.5047) acc_x 71.8750 (86.6250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [30/36] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.3125 (0.4920) acc_x 90.6250 (86.8750) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [35/36] time 0.191 (0.175) data 0.114 (0.098) loss_x loss_x 0.3267 (0.5053) acc_x 93.7500 (86.6964) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/13] time 0.186 (0.176) data 0.109 (0.099) loss_u loss_u 0.6558 (0.7023) acc_u 34.3750 (33.1250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/13] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.7061 (0.6929) acc_u 28.1250 (33.7500) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 265
confident_label rate tensor(0.7450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1192
clean true:1191
clean false:1
clean_rate:0.9991610738255033
noisy true:144
noisy false:264
after delete: len(clean_dataset) 1192
after delete: len(noisy_dataset) 408
epoch [114/200] batch [5/37] time 0.170 (0.181) data 0.094 (0.105) loss_x loss_x 0.3452 (0.3625) acc_x 93.7500 (90.6250) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [10/37] time 0.163 (0.177) data 0.087 (0.100) loss_x loss_x 0.3413 (0.4384) acc_x 87.5000 (87.8125) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/37] time 0.184 (0.176) data 0.107 (0.100) loss_x loss_x 0.2969 (0.4266) acc_x 90.6250 (88.7500) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/37] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.4321 (0.4695) acc_x 90.6250 (87.9688) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [25/37] time 0.187 (0.178) data 0.112 (0.101) loss_x loss_x 0.4773 (0.4778) acc_x 78.1250 (87.6250) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [30/37] time 0.184 (0.179) data 0.108 (0.103) loss_x loss_x 0.6045 (0.4716) acc_x 81.2500 (87.5000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [35/37] time 0.169 (0.178) data 0.092 (0.102) loss_x loss_x 0.2505 (0.4861) acc_x 96.8750 (86.7857) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/12] time 0.194 (0.178) data 0.116 (0.102) loss_u loss_u 0.6079 (0.6881) acc_u 46.8750 (36.2500) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [10/12] time 0.180 (0.178) data 0.102 (0.101) loss_u loss_u 0.6895 (0.7089) acc_u 43.7500 (34.0625) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 267
confident_label rate tensor(0.7369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1179
clean true:1179
clean false:0
clean_rate:1.0
noisy true:154
noisy false:267
after delete: len(clean_dataset) 1179
after delete: len(noisy_dataset) 421
epoch [115/200] batch [5/36] time 0.190 (0.188) data 0.113 (0.111) loss_x loss_x 0.3772 (0.6278) acc_x 90.6250 (86.8750) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/36] time 0.166 (0.180) data 0.090 (0.103) loss_x loss_x 0.1869 (0.5339) acc_x 100.0000 (87.1875) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/36] time 0.159 (0.176) data 0.083 (0.099) loss_x loss_x 0.7144 (0.5811) acc_x 78.1250 (86.0417) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/36] time 0.162 (0.177) data 0.085 (0.100) loss_x loss_x 0.6187 (0.5516) acc_x 84.3750 (86.7188) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/36] time 0.177 (0.176) data 0.101 (0.099) loss_x loss_x 0.3450 (0.5442) acc_x 90.6250 (87.1250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [30/36] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.3225 (0.5500) acc_x 93.7500 (86.8750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [35/36] time 0.166 (0.174) data 0.090 (0.098) loss_x loss_x 0.2366 (0.5351) acc_x 93.7500 (87.0536) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/13] time 0.188 (0.174) data 0.110 (0.097) loss_u loss_u 0.7417 (0.6924) acc_u 25.0000 (35.0000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/13] time 0.184 (0.175) data 0.106 (0.098) loss_u loss_u 0.7104 (0.6844) acc_u 34.3750 (36.2500) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 267
confident_label rate tensor(0.7400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1184
clean true:1183
clean false:1
clean_rate:0.9991554054054054
noisy true:150
noisy false:266
after delete: len(clean_dataset) 1184
after delete: len(noisy_dataset) 416
epoch [116/200] batch [5/37] time 0.189 (0.186) data 0.114 (0.110) loss_x loss_x 0.4431 (0.6023) acc_x 81.2500 (84.3750) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [10/37] time 0.185 (0.179) data 0.109 (0.103) loss_x loss_x 0.3564 (0.5970) acc_x 93.7500 (85.6250) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/37] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.4358 (0.5250) acc_x 87.5000 (87.2917) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/37] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.6650 (0.5133) acc_x 81.2500 (87.5000) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [25/37] time 0.187 (0.183) data 0.110 (0.107) loss_x loss_x 0.3867 (0.5011) acc_x 90.6250 (88.0000) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [30/37] time 0.158 (0.182) data 0.082 (0.106) loss_x loss_x 0.7705 (0.5292) acc_x 84.3750 (87.0833) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [35/37] time 0.169 (0.181) data 0.093 (0.104) loss_x loss_x 0.6729 (0.5125) acc_x 90.6250 (87.4107) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/13] time 0.182 (0.179) data 0.106 (0.102) loss_u loss_u 0.6694 (0.7028) acc_u 40.6250 (35.0000) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/13] time 0.175 (0.178) data 0.098 (0.102) loss_u loss_u 0.6885 (0.7038) acc_u 34.3750 (33.4375) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 279
confident_label rate tensor(0.7294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1167
clean true:1167
clean false:0
clean_rate:1.0
noisy true:154
noisy false:279
after delete: len(clean_dataset) 1167
after delete: len(noisy_dataset) 433
epoch [117/200] batch [5/36] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.5659 (0.5300) acc_x 84.3750 (87.5000) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/36] time 0.165 (0.175) data 0.089 (0.098) loss_x loss_x 0.5947 (0.4687) acc_x 84.3750 (88.7500) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/36] time 0.170 (0.172) data 0.094 (0.096) loss_x loss_x 0.5254 (0.4642) acc_x 78.1250 (88.1250) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/36] time 0.177 (0.173) data 0.100 (0.096) loss_x loss_x 0.5786 (0.4404) acc_x 90.6250 (89.3750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/36] time 0.184 (0.172) data 0.108 (0.096) loss_x loss_x 1.1787 (0.4515) acc_x 75.0000 (89.0000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [30/36] time 0.174 (0.173) data 0.098 (0.096) loss_x loss_x 0.6133 (0.4660) acc_x 84.3750 (88.5417) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [35/36] time 0.159 (0.172) data 0.082 (0.095) loss_x loss_x 0.3054 (0.4544) acc_x 93.7500 (88.9286) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/13] time 0.186 (0.173) data 0.108 (0.096) loss_u loss_u 0.7788 (0.7146) acc_u 21.8750 (31.8750) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/13] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.7212 (0.6985) acc_u 34.3750 (35.0000) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 251
confident_label rate tensor(0.7444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1191
clean true:1189
clean false:2
clean_rate:0.998320738874895
noisy true:160
noisy false:249
after delete: len(clean_dataset) 1191
after delete: len(noisy_dataset) 409
epoch [118/200] batch [5/37] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.2693 (0.4547) acc_x 93.7500 (90.0000) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/37] time 0.198 (0.177) data 0.122 (0.100) loss_x loss_x 0.5151 (0.4743) acc_x 81.2500 (87.8125) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/37] time 0.183 (0.179) data 0.107 (0.102) loss_x loss_x 0.1627 (0.4361) acc_x 93.7500 (87.9167) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/37] time 0.180 (0.178) data 0.104 (0.101) loss_x loss_x 0.4116 (0.4090) acc_x 87.5000 (88.5938) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [25/37] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.2876 (0.4651) acc_x 93.7500 (87.2500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [30/37] time 0.165 (0.177) data 0.089 (0.100) loss_x loss_x 0.1335 (0.4622) acc_x 96.8750 (87.0833) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [35/37] time 0.162 (0.176) data 0.083 (0.099) loss_x loss_x 0.3337 (0.4562) acc_x 87.5000 (87.2321) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/12] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.7124 (0.6648) acc_u 37.5000 (39.3750) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [10/12] time 0.167 (0.174) data 0.090 (0.097) loss_u loss_u 0.6797 (0.6729) acc_u 31.2500 (38.1250) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 258
confident_label rate tensor(0.7462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1194
clean true:1194
clean false:0
clean_rate:1.0
noisy true:148
noisy false:258
after delete: len(clean_dataset) 1194
after delete: len(noisy_dataset) 406
epoch [119/200] batch [5/37] time 0.169 (0.178) data 0.093 (0.102) loss_x loss_x 0.8945 (0.6253) acc_x 78.1250 (83.1250) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [10/37] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 0.6313 (0.6201) acc_x 81.2500 (83.4375) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/37] time 0.180 (0.178) data 0.103 (0.101) loss_x loss_x 1.1035 (0.6811) acc_x 78.1250 (81.8750) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/37] time 0.175 (0.178) data 0.098 (0.102) loss_x loss_x 0.3984 (0.6085) acc_x 93.7500 (84.0625) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [25/37] time 0.176 (0.178) data 0.098 (0.101) loss_x loss_x 0.5742 (0.6109) acc_x 84.3750 (84.3750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [30/37] time 0.186 (0.178) data 0.110 (0.102) loss_x loss_x 0.3516 (0.5654) acc_x 96.8750 (85.7292) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [35/37] time 0.180 (0.178) data 0.104 (0.102) loss_x loss_x 0.4333 (0.5608) acc_x 90.6250 (85.9821) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/12] time 0.179 (0.177) data 0.102 (0.100) loss_u loss_u 0.7900 (0.7006) acc_u 21.8750 (33.7500) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/12] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.7671 (0.6910) acc_u 28.1250 (35.6250) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 259
confident_label rate tensor(0.7406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1185
clean true:1184
clean false:1
clean_rate:0.99915611814346
noisy true:157
noisy false:258
after delete: len(clean_dataset) 1185
after delete: len(noisy_dataset) 415
epoch [120/200] batch [5/37] time 0.172 (0.178) data 0.096 (0.101) loss_x loss_x 0.4551 (0.4534) acc_x 93.7500 (88.7500) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [10/37] time 0.179 (0.176) data 0.102 (0.100) loss_x loss_x 0.7046 (0.4982) acc_x 87.5000 (88.1250) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/37] time 0.171 (0.174) data 0.093 (0.098) loss_x loss_x 0.2355 (0.4517) acc_x 93.7500 (88.5417) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/37] time 0.179 (0.175) data 0.103 (0.098) loss_x loss_x 0.1351 (0.4486) acc_x 96.8750 (88.4375) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/37] time 0.186 (0.176) data 0.110 (0.100) loss_x loss_x 0.6030 (0.4596) acc_x 78.1250 (87.8750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [30/37] time 0.182 (0.178) data 0.106 (0.101) loss_x loss_x 0.3315 (0.4493) acc_x 93.7500 (88.0208) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [35/37] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.2957 (0.4643) acc_x 90.6250 (87.5893) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/12] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.7280 (0.7512) acc_u 31.2500 (27.5000) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/12] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.6865 (0.7061) acc_u 34.3750 (32.8125) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 227
confident_label rate tensor(0.7619, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1219
clean true:1219
clean false:0
clean_rate:1.0
noisy true:154
noisy false:227
after delete: len(clean_dataset) 1219
after delete: len(noisy_dataset) 381
epoch [121/200] batch [5/38] time 0.176 (0.187) data 0.100 (0.110) loss_x loss_x 0.8433 (0.5987) acc_x 78.1250 (83.7500) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [10/38] time 0.167 (0.176) data 0.090 (0.099) loss_x loss_x 0.4434 (0.4982) acc_x 87.5000 (86.8750) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/38] time 0.191 (0.180) data 0.115 (0.103) loss_x loss_x 0.4353 (0.5147) acc_x 84.3750 (85.6250) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [20/38] time 0.160 (0.179) data 0.083 (0.102) loss_x loss_x 0.8667 (0.5538) acc_x 75.0000 (84.8438) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [25/38] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.6157 (0.5412) acc_x 84.3750 (85.0000) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [30/38] time 0.187 (0.177) data 0.109 (0.100) loss_x loss_x 0.4404 (0.5486) acc_x 87.5000 (85.2083) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [35/38] time 0.179 (0.176) data 0.103 (0.099) loss_x loss_x 0.3330 (0.5361) acc_x 93.7500 (85.4464) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/11] time 0.185 (0.176) data 0.106 (0.099) loss_u loss_u 0.6333 (0.7464) acc_u 40.6250 (28.7500) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/11] time 0.188 (0.177) data 0.112 (0.100) loss_u loss_u 0.6875 (0.7281) acc_u 31.2500 (30.3125) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 256
confident_label rate tensor(0.7425, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1188
clean true:1188
clean false:0
clean_rate:1.0
noisy true:156
noisy false:256
after delete: len(clean_dataset) 1188
after delete: len(noisy_dataset) 412
epoch [122/200] batch [5/37] time 0.173 (0.181) data 0.096 (0.103) loss_x loss_x 0.1456 (0.3974) acc_x 93.7500 (88.7500) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [10/37] time 0.171 (0.182) data 0.094 (0.104) loss_x loss_x 0.4946 (0.4394) acc_x 78.1250 (87.8125) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/37] time 0.188 (0.177) data 0.112 (0.100) loss_x loss_x 0.3611 (0.4601) acc_x 93.7500 (88.3333) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/37] time 0.183 (0.180) data 0.107 (0.103) loss_x loss_x 0.5312 (0.4748) acc_x 90.6250 (88.7500) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [25/37] time 0.190 (0.181) data 0.113 (0.104) loss_x loss_x 0.4846 (0.4757) acc_x 90.6250 (88.5000) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [30/37] time 0.167 (0.180) data 0.090 (0.103) loss_x loss_x 0.3962 (0.4730) acc_x 84.3750 (87.9167) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [35/37] time 0.162 (0.179) data 0.086 (0.102) loss_x loss_x 0.1689 (0.4682) acc_x 100.0000 (88.3036) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/12] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.6577 (0.6784) acc_u 37.5000 (35.0000) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/12] time 0.186 (0.179) data 0.110 (0.102) loss_u loss_u 0.6548 (0.7042) acc_u 34.3750 (32.1875) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 258
confident_label rate tensor(0.7381, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1181
clean true:1180
clean false:1
clean_rate:0.9991532599491956
noisy true:162
noisy false:257
after delete: len(clean_dataset) 1181
after delete: len(noisy_dataset) 419
epoch [123/200] batch [5/36] time 0.186 (0.182) data 0.108 (0.105) loss_x loss_x 0.5239 (0.6891) acc_x 81.2500 (82.5000) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [10/36] time 0.159 (0.179) data 0.083 (0.102) loss_x loss_x 0.5659 (0.5664) acc_x 87.5000 (85.3125) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/36] time 0.177 (0.177) data 0.101 (0.100) loss_x loss_x 0.3308 (0.5282) acc_x 90.6250 (86.0417) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/36] time 0.176 (0.177) data 0.099 (0.101) loss_x loss_x 0.5830 (0.5329) acc_x 84.3750 (85.9375) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/36] time 0.173 (0.177) data 0.097 (0.101) loss_x loss_x 0.3948 (0.5208) acc_x 90.6250 (86.2500) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [30/36] time 0.177 (0.177) data 0.099 (0.101) loss_x loss_x 0.3064 (0.5212) acc_x 90.6250 (86.0417) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [35/36] time 0.172 (0.177) data 0.094 (0.101) loss_x loss_x 0.5010 (0.5115) acc_x 81.2500 (85.9821) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/13] time 0.159 (0.176) data 0.083 (0.099) loss_u loss_u 0.5864 (0.6142) acc_u 46.8750 (42.5000) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/13] time 0.163 (0.174) data 0.084 (0.097) loss_u loss_u 0.6616 (0.6652) acc_u 34.3750 (37.5000) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 254
confident_label rate tensor(0.7525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1204
clean true:1202
clean false:2
clean_rate:0.9983388704318937
noisy true:144
noisy false:252
after delete: len(clean_dataset) 1204
after delete: len(noisy_dataset) 396
epoch [124/200] batch [5/37] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.4946 (0.4633) acc_x 84.3750 (88.7500) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/37] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.4531 (0.4722) acc_x 90.6250 (89.0625) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/37] time 0.165 (0.184) data 0.089 (0.107) loss_x loss_x 0.2861 (0.4508) acc_x 93.7500 (89.1667) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [20/37] time 0.174 (0.180) data 0.096 (0.104) loss_x loss_x 0.3989 (0.4649) acc_x 87.5000 (88.4375) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [25/37] time 0.175 (0.179) data 0.099 (0.103) loss_x loss_x 0.5420 (0.4574) acc_x 87.5000 (88.7500) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [30/37] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 0.3921 (0.4504) acc_x 87.5000 (88.9583) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [35/37] time 0.181 (0.180) data 0.105 (0.103) loss_x loss_x 0.4360 (0.4609) acc_x 87.5000 (88.4821) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/12] time 0.177 (0.180) data 0.101 (0.103) loss_u loss_u 0.6655 (0.7210) acc_u 37.5000 (32.5000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/12] time 0.174 (0.179) data 0.097 (0.102) loss_u loss_u 0.7476 (0.7212) acc_u 34.3750 (31.8750) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 267
confident_label rate tensor(0.7387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1182
clean true:1182
clean false:0
clean_rate:1.0
noisy true:151
noisy false:267
after delete: len(clean_dataset) 1182
after delete: len(noisy_dataset) 418
epoch [125/200] batch [5/36] time 0.173 (0.175) data 0.096 (0.099) loss_x loss_x 0.5815 (0.5766) acc_x 84.3750 (86.2500) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [10/36] time 0.178 (0.174) data 0.101 (0.098) loss_x loss_x 0.3130 (0.5025) acc_x 87.5000 (86.5625) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/36] time 0.162 (0.173) data 0.086 (0.096) loss_x loss_x 0.4431 (0.4824) acc_x 93.7500 (87.9167) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/36] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.5405 (0.4779) acc_x 81.2500 (87.6562) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/36] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.3379 (0.4678) acc_x 90.6250 (87.7500) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [30/36] time 0.179 (0.176) data 0.102 (0.100) loss_x loss_x 0.2039 (0.4760) acc_x 93.7500 (87.3958) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [35/36] time 0.179 (0.177) data 0.103 (0.101) loss_x loss_x 0.2971 (0.4910) acc_x 93.7500 (87.1429) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/13] time 0.159 (0.175) data 0.082 (0.098) loss_u loss_u 0.6763 (0.6635) acc_u 43.7500 (38.1250) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/13] time 0.199 (0.174) data 0.122 (0.098) loss_u loss_u 0.6978 (0.6833) acc_u 34.3750 (35.3125) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 248
confident_label rate tensor(0.7462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1194
clean true:1192
clean false:2
clean_rate:0.998324958123953
noisy true:160
noisy false:246
after delete: len(clean_dataset) 1194
after delete: len(noisy_dataset) 406
epoch [126/200] batch [5/37] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 0.2576 (0.2331) acc_x 93.7500 (94.3750) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/37] time 0.188 (0.178) data 0.111 (0.102) loss_x loss_x 0.1221 (0.2642) acc_x 100.0000 (93.4375) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/37] time 0.164 (0.176) data 0.088 (0.099) loss_x loss_x 0.6689 (0.3216) acc_x 84.3750 (91.4583) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/37] time 0.162 (0.172) data 0.086 (0.096) loss_x loss_x 0.1890 (0.3726) acc_x 90.6250 (89.6875) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/37] time 0.168 (0.172) data 0.091 (0.095) loss_x loss_x 0.2491 (0.4072) acc_x 90.6250 (88.8750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [30/37] time 0.163 (0.171) data 0.087 (0.094) loss_x loss_x 0.5825 (0.4181) acc_x 90.6250 (88.4375) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [35/37] time 0.169 (0.170) data 0.092 (0.093) loss_x loss_x 0.1498 (0.4247) acc_x 100.0000 (88.3929) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/12] time 0.190 (0.170) data 0.112 (0.093) loss_u loss_u 0.6543 (0.6629) acc_u 43.7500 (38.7500) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/12] time 0.162 (0.170) data 0.084 (0.093) loss_u loss_u 0.6958 (0.6827) acc_u 34.3750 (35.6250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 243
confident_label rate tensor(0.7500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1200
clean true:1198
clean false:2
clean_rate:0.9983333333333333
noisy true:159
noisy false:241
after delete: len(clean_dataset) 1200
after delete: len(noisy_dataset) 400
epoch [127/200] batch [5/37] time 0.172 (0.175) data 0.096 (0.098) loss_x loss_x 0.3823 (0.4290) acc_x 90.6250 (88.7500) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [10/37] time 0.175 (0.177) data 0.098 (0.101) loss_x loss_x 0.5210 (0.4666) acc_x 75.0000 (86.8750) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/37] time 0.160 (0.174) data 0.083 (0.098) loss_x loss_x 0.2283 (0.4703) acc_x 90.6250 (86.8750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/37] time 0.167 (0.173) data 0.090 (0.097) loss_x loss_x 0.4836 (0.4885) acc_x 84.3750 (86.4062) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/37] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.3154 (0.4817) acc_x 93.7500 (86.6250) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [30/37] time 0.163 (0.172) data 0.085 (0.096) loss_x loss_x 0.5215 (0.4821) acc_x 84.3750 (86.8750) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [35/37] time 0.179 (0.173) data 0.102 (0.096) loss_x loss_x 0.7295 (0.4909) acc_x 78.1250 (86.5179) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/12] time 0.165 (0.174) data 0.087 (0.097) loss_u loss_u 0.6479 (0.7063) acc_u 40.6250 (32.5000) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/12] time 0.180 (0.175) data 0.104 (0.098) loss_u loss_u 0.6562 (0.7027) acc_u 37.5000 (32.8125) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 248
confident_label rate tensor(0.7525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1204
clean true:1203
clean false:1
clean_rate:0.9991694352159468
noisy true:149
noisy false:247
after delete: len(clean_dataset) 1204
after delete: len(noisy_dataset) 396
epoch [128/200] batch [5/37] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.3618 (0.5039) acc_x 90.6250 (85.6250) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [10/37] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.4590 (0.4944) acc_x 84.3750 (86.5625) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [15/37] time 0.194 (0.187) data 0.117 (0.111) loss_x loss_x 0.5796 (0.5306) acc_x 78.1250 (84.5833) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [20/37] time 0.170 (0.185) data 0.094 (0.109) loss_x loss_x 0.4119 (0.5228) acc_x 90.6250 (85.1562) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [25/37] time 0.180 (0.185) data 0.103 (0.108) loss_x loss_x 0.4165 (0.5117) acc_x 84.3750 (85.1250) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [30/37] time 0.193 (0.183) data 0.115 (0.107) loss_x loss_x 0.4700 (0.4844) acc_x 90.6250 (86.1458) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [35/37] time 0.172 (0.184) data 0.096 (0.107) loss_x loss_x 0.4287 (0.4893) acc_x 90.6250 (86.4286) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/12] time 0.177 (0.181) data 0.099 (0.104) loss_u loss_u 0.6128 (0.6749) acc_u 43.7500 (36.2500) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/12] time 0.190 (0.180) data 0.114 (0.103) loss_u loss_u 0.8296 (0.7010) acc_u 15.6250 (32.8125) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 294
confident_label rate tensor(0.7275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1164
clean true:1161
clean false:3
clean_rate:0.9974226804123711
noisy true:145
noisy false:291
after delete: len(clean_dataset) 1164
after delete: len(noisy_dataset) 436
epoch [129/200] batch [5/36] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.5400 (0.5555) acc_x 81.2500 (85.6250) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [10/36] time 0.174 (0.184) data 0.097 (0.107) loss_x loss_x 0.6851 (0.5938) acc_x 90.6250 (85.0000) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/36] time 0.194 (0.182) data 0.117 (0.106) loss_x loss_x 0.7095 (0.5373) acc_x 81.2500 (86.4583) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/36] time 0.157 (0.178) data 0.081 (0.102) loss_x loss_x 0.5977 (0.5050) acc_x 81.2500 (86.8750) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/36] time 0.161 (0.176) data 0.084 (0.100) loss_x loss_x 0.4983 (0.4946) acc_x 84.3750 (87.0000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/36] time 0.167 (0.174) data 0.090 (0.098) loss_x loss_x 0.2401 (0.4918) acc_x 90.6250 (86.7708) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [35/36] time 0.171 (0.174) data 0.095 (0.098) loss_x loss_x 0.2898 (0.4685) acc_x 90.6250 (87.3214) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/13] time 0.170 (0.174) data 0.091 (0.097) loss_u loss_u 0.6226 (0.6677) acc_u 40.6250 (36.8750) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/13] time 0.174 (0.173) data 0.097 (0.096) loss_u loss_u 0.7759 (0.7108) acc_u 18.7500 (31.8750) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 250
confident_label rate tensor(0.7487, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1198
clean true:1198
clean false:0
clean_rate:1.0
noisy true:152
noisy false:250
after delete: len(clean_dataset) 1198
after delete: len(noisy_dataset) 402
epoch [130/200] batch [5/37] time 0.164 (0.178) data 0.087 (0.101) loss_x loss_x 0.4912 (0.4749) acc_x 84.3750 (89.3750) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [10/37] time 0.193 (0.179) data 0.116 (0.103) loss_x loss_x 0.2443 (0.4032) acc_x 90.6250 (90.9375) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/37] time 0.211 (0.180) data 0.135 (0.103) loss_x loss_x 0.5264 (0.4139) acc_x 93.7500 (90.8333) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/37] time 0.186 (0.181) data 0.108 (0.105) loss_x loss_x 0.3186 (0.3961) acc_x 87.5000 (90.4688) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [25/37] time 0.171 (0.181) data 0.094 (0.104) loss_x loss_x 0.4924 (0.4153) acc_x 84.3750 (89.6250) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [30/37] time 0.167 (0.182) data 0.090 (0.105) loss_x loss_x 1.1436 (0.4392) acc_x 78.1250 (89.2708) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [35/37] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.7783 (0.4556) acc_x 84.3750 (88.9286) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/12] time 0.178 (0.180) data 0.099 (0.103) loss_u loss_u 0.6909 (0.7248) acc_u 34.3750 (30.6250) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/12] time 0.160 (0.179) data 0.084 (0.102) loss_u loss_u 0.7456 (0.7210) acc_u 31.2500 (31.5625) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 259
confident_label rate tensor(0.7444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1191
clean true:1189
clean false:2
clean_rate:0.998320738874895
noisy true:152
noisy false:257
after delete: len(clean_dataset) 1191
after delete: len(noisy_dataset) 409
epoch [131/200] batch [5/37] time 0.193 (0.189) data 0.116 (0.112) loss_x loss_x 0.6650 (0.6603) acc_x 78.1250 (81.8750) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [10/37] time 0.189 (0.188) data 0.112 (0.112) loss_x loss_x 0.6099 (0.5856) acc_x 81.2500 (84.6875) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [15/37] time 0.191 (0.187) data 0.115 (0.111) loss_x loss_x 0.5776 (0.5822) acc_x 84.3750 (84.7917) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [20/37] time 0.188 (0.187) data 0.112 (0.111) loss_x loss_x 0.4141 (0.5519) acc_x 87.5000 (85.3125) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [25/37] time 0.172 (0.186) data 0.096 (0.110) loss_x loss_x 0.6392 (0.5830) acc_x 87.5000 (85.3750) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [30/37] time 0.167 (0.183) data 0.091 (0.107) loss_x loss_x 0.3201 (0.5587) acc_x 90.6250 (85.9375) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [35/37] time 0.170 (0.182) data 0.094 (0.105) loss_x loss_x 0.8662 (0.5692) acc_x 84.3750 (85.7143) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/12] time 0.191 (0.182) data 0.115 (0.105) loss_u loss_u 0.6909 (0.6565) acc_u 34.3750 (38.7500) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [10/12] time 0.190 (0.181) data 0.112 (0.105) loss_u loss_u 0.7373 (0.7057) acc_u 28.1250 (33.1250) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 249
confident_label rate tensor(0.7537, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1206
clean true:1206
clean false:0
clean_rate:1.0
noisy true:145
noisy false:249
after delete: len(clean_dataset) 1206
after delete: len(noisy_dataset) 394
epoch [132/200] batch [5/37] time 0.190 (0.186) data 0.113 (0.109) loss_x loss_x 0.8110 (0.4658) acc_x 71.8750 (86.8750) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [10/37] time 0.187 (0.183) data 0.111 (0.106) loss_x loss_x 0.7378 (0.4706) acc_x 75.0000 (85.6250) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/37] time 0.165 (0.180) data 0.088 (0.103) loss_x loss_x 0.6851 (0.4731) acc_x 87.5000 (86.0417) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/37] time 0.170 (0.179) data 0.093 (0.103) loss_x loss_x 0.3967 (0.4890) acc_x 90.6250 (86.0938) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [25/37] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.5996 (0.5018) acc_x 87.5000 (86.2500) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [30/37] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.8828 (0.5350) acc_x 84.3750 (86.1458) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [35/37] time 0.188 (0.180) data 0.111 (0.103) loss_x loss_x 0.5210 (0.5222) acc_x 84.3750 (86.5179) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/12] time 0.184 (0.180) data 0.107 (0.104) loss_u loss_u 0.7808 (0.7760) acc_u 25.0000 (26.2500) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [10/12] time 0.191 (0.181) data 0.113 (0.104) loss_u loss_u 0.7051 (0.7452) acc_u 31.2500 (29.3750) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 254
confident_label rate tensor(0.7431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1189
clean true:1187
clean false:2
clean_rate:0.9983179142136249
noisy true:159
noisy false:252
after delete: len(clean_dataset) 1189
after delete: len(noisy_dataset) 411
epoch [133/200] batch [5/37] time 0.180 (0.186) data 0.104 (0.110) loss_x loss_x 0.3167 (0.4249) acc_x 90.6250 (86.8750) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [10/37] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.4324 (0.4223) acc_x 84.3750 (88.1250) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/37] time 0.188 (0.183) data 0.112 (0.107) loss_x loss_x 0.3708 (0.4034) acc_x 90.6250 (89.1667) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [20/37] time 0.189 (0.182) data 0.112 (0.106) loss_x loss_x 0.5532 (0.4260) acc_x 84.3750 (88.7500) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [25/37] time 0.164 (0.178) data 0.088 (0.102) loss_x loss_x 0.4895 (0.4367) acc_x 90.6250 (88.8750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [30/37] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.2488 (0.4423) acc_x 96.8750 (88.7500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [35/37] time 0.181 (0.179) data 0.105 (0.102) loss_x loss_x 0.3616 (0.4370) acc_x 87.5000 (88.9286) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/12] time 0.171 (0.178) data 0.093 (0.102) loss_u loss_u 0.7783 (0.7321) acc_u 25.0000 (30.0000) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/12] time 0.164 (0.178) data 0.087 (0.101) loss_u loss_u 0.7314 (0.7196) acc_u 34.3750 (32.5000) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 280
confident_label rate tensor(0.7344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1175
clean true:1174
clean false:1
clean_rate:0.9991489361702127
noisy true:146
noisy false:279
after delete: len(clean_dataset) 1175
after delete: len(noisy_dataset) 425
epoch [134/200] batch [5/36] time 0.165 (0.169) data 0.088 (0.092) loss_x loss_x 0.4080 (0.4910) acc_x 90.6250 (89.3750) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [10/36] time 0.183 (0.170) data 0.106 (0.093) loss_x loss_x 0.5273 (0.5475) acc_x 84.3750 (87.5000) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/36] time 0.165 (0.170) data 0.089 (0.093) loss_x loss_x 0.6694 (0.5971) acc_x 84.3750 (85.8333) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/36] time 0.170 (0.169) data 0.094 (0.092) loss_x loss_x 0.4829 (0.5590) acc_x 81.2500 (85.9375) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/36] time 0.171 (0.170) data 0.094 (0.093) loss_x loss_x 0.4202 (0.4997) acc_x 84.3750 (86.8750) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/36] time 0.165 (0.169) data 0.087 (0.092) loss_x loss_x 0.6001 (0.4876) acc_x 81.2500 (86.9792) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [35/36] time 0.168 (0.170) data 0.092 (0.093) loss_x loss_x 0.6978 (0.4944) acc_x 81.2500 (86.5179) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/13] time 0.241 (0.173) data 0.165 (0.096) loss_u loss_u 0.7290 (0.7427) acc_u 28.1250 (28.1250) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/13] time 0.183 (0.174) data 0.107 (0.097) loss_u loss_u 0.7593 (0.7005) acc_u 25.0000 (32.8125) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 283
confident_label rate tensor(0.7394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1183
clean true:1182
clean false:1
clean_rate:0.9991546914623838
noisy true:135
noisy false:282
after delete: len(clean_dataset) 1183
after delete: len(noisy_dataset) 417
epoch [135/200] batch [5/36] time 0.163 (0.174) data 0.087 (0.097) loss_x loss_x 0.3713 (0.4051) acc_x 87.5000 (88.7500) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/36] time 0.167 (0.172) data 0.091 (0.095) loss_x loss_x 0.3098 (0.3928) acc_x 90.6250 (89.3750) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/36] time 0.181 (0.171) data 0.103 (0.094) loss_x loss_x 0.9277 (0.4465) acc_x 71.8750 (88.5417) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/36] time 0.175 (0.172) data 0.098 (0.096) loss_x loss_x 0.1262 (0.4598) acc_x 96.8750 (87.9688) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/36] time 0.184 (0.172) data 0.108 (0.096) loss_x loss_x 0.4329 (0.4733) acc_x 87.5000 (87.6250) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/36] time 0.191 (0.175) data 0.115 (0.098) loss_x loss_x 0.4309 (0.4479) acc_x 90.6250 (88.3333) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [35/36] time 0.170 (0.176) data 0.094 (0.099) loss_x loss_x 0.7324 (0.4651) acc_x 87.5000 (88.0357) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/13] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.7773 (0.7505) acc_u 18.7500 (28.1250) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/13] time 0.177 (0.176) data 0.099 (0.099) loss_u loss_u 0.6650 (0.7037) acc_u 43.7500 (33.1250) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 266
confident_label rate tensor(0.7406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1185
clean true:1184
clean false:1
clean_rate:0.99915611814346
noisy true:150
noisy false:265
after delete: len(clean_dataset) 1185
after delete: len(noisy_dataset) 415
epoch [136/200] batch [5/37] time 0.173 (0.171) data 0.096 (0.094) loss_x loss_x 0.3367 (0.3486) acc_x 90.6250 (90.6250) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [10/37] time 0.177 (0.174) data 0.101 (0.097) loss_x loss_x 0.3782 (0.3822) acc_x 87.5000 (89.0625) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/37] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.5938 (0.4594) acc_x 84.3750 (87.0833) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [20/37] time 0.182 (0.177) data 0.104 (0.100) loss_x loss_x 0.4773 (0.4763) acc_x 90.6250 (87.3438) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [25/37] time 0.174 (0.176) data 0.096 (0.099) loss_x loss_x 0.4253 (0.4654) acc_x 81.2500 (87.0000) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [30/37] time 0.189 (0.176) data 0.113 (0.099) loss_x loss_x 0.3513 (0.4730) acc_x 90.6250 (86.7708) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [35/37] time 0.174 (0.176) data 0.098 (0.099) loss_x loss_x 0.7192 (0.4660) acc_x 84.3750 (87.3214) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/12] time 0.174 (0.176) data 0.096 (0.100) loss_u loss_u 0.7178 (0.6880) acc_u 31.2500 (36.2500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/12] time 0.174 (0.176) data 0.098 (0.099) loss_u loss_u 0.6030 (0.6737) acc_u 43.7500 (36.8750) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 251
confident_label rate tensor(0.7506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1201
clean true:1201
clean false:0
clean_rate:1.0
noisy true:148
noisy false:251
after delete: len(clean_dataset) 1201
after delete: len(noisy_dataset) 399
epoch [137/200] batch [5/37] time 0.158 (0.175) data 0.081 (0.099) loss_x loss_x 0.3806 (0.3219) acc_x 87.5000 (91.2500) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/37] time 0.178 (0.172) data 0.101 (0.095) loss_x loss_x 0.2698 (0.3662) acc_x 96.8750 (90.9375) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/37] time 0.183 (0.175) data 0.107 (0.098) loss_x loss_x 0.3025 (0.3862) acc_x 90.6250 (90.4167) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/37] time 0.185 (0.177) data 0.109 (0.101) loss_x loss_x 0.2937 (0.3993) acc_x 90.6250 (89.6875) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [25/37] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.4675 (0.4098) acc_x 87.5000 (89.3750) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [30/37] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 0.2434 (0.4207) acc_x 93.7500 (89.1667) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [35/37] time 0.178 (0.177) data 0.101 (0.100) loss_x loss_x 0.6943 (0.4323) acc_x 81.2500 (89.1071) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/12] time 0.177 (0.175) data 0.100 (0.099) loss_u loss_u 0.7051 (0.6854) acc_u 34.3750 (36.2500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/12] time 0.166 (0.175) data 0.089 (0.098) loss_u loss_u 0.7339 (0.6859) acc_u 37.5000 (37.1875) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 258
confident_label rate tensor(0.7387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1182
clean true:1181
clean false:1
clean_rate:0.9991539763113367
noisy true:161
noisy false:257
after delete: len(clean_dataset) 1182
after delete: len(noisy_dataset) 418
epoch [138/200] batch [5/36] time 0.173 (0.183) data 0.097 (0.106) loss_x loss_x 0.5093 (0.5325) acc_x 87.5000 (84.3750) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [10/36] time 0.163 (0.177) data 0.086 (0.100) loss_x loss_x 0.5405 (0.5132) acc_x 84.3750 (85.3125) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/36] time 0.187 (0.181) data 0.110 (0.105) loss_x loss_x 0.9077 (0.5347) acc_x 78.1250 (86.6667) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/36] time 0.170 (0.179) data 0.092 (0.102) loss_x loss_x 0.4216 (0.5207) acc_x 90.6250 (86.8750) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/36] time 0.176 (0.179) data 0.098 (0.102) loss_x loss_x 0.1912 (0.4977) acc_x 96.8750 (87.3750) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/36] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.2446 (0.5068) acc_x 93.7500 (87.2917) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [35/36] time 0.174 (0.176) data 0.098 (0.099) loss_x loss_x 1.0371 (0.5109) acc_x 78.1250 (87.1429) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/13] time 0.175 (0.177) data 0.098 (0.100) loss_u loss_u 0.5508 (0.6562) acc_u 50.0000 (39.3750) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/13] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.7100 (0.6851) acc_u 31.2500 (35.9375) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 233
confident_label rate tensor(0.7562, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1210
clean true:1210
clean false:0
clean_rate:1.0
noisy true:157
noisy false:233
after delete: len(clean_dataset) 1210
after delete: len(noisy_dataset) 390
epoch [139/200] batch [5/37] time 0.190 (0.182) data 0.112 (0.105) loss_x loss_x 0.2878 (0.5222) acc_x 96.8750 (87.5000) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [10/37] time 0.170 (0.181) data 0.092 (0.104) loss_x loss_x 0.4070 (0.5278) acc_x 90.6250 (86.5625) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/37] time 0.190 (0.183) data 0.113 (0.106) loss_x loss_x 0.5596 (0.5361) acc_x 84.3750 (87.0833) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [20/37] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.4980 (0.5463) acc_x 87.5000 (85.7812) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [25/37] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.1985 (0.5290) acc_x 96.8750 (86.6250) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [30/37] time 0.181 (0.185) data 0.103 (0.108) loss_x loss_x 0.3872 (0.5136) acc_x 87.5000 (86.8750) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [35/37] time 0.172 (0.183) data 0.096 (0.107) loss_x loss_x 0.2554 (0.5039) acc_x 93.7500 (86.7857) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/12] time 0.180 (0.182) data 0.102 (0.106) loss_u loss_u 0.7671 (0.7589) acc_u 31.2500 (27.5000) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/12] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.6758 (0.7273) acc_u 34.3750 (30.9375) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 258
confident_label rate tensor(0.7394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1183
clean true:1182
clean false:1
clean_rate:0.9991546914623838
noisy true:160
noisy false:257
after delete: len(clean_dataset) 1183
after delete: len(noisy_dataset) 417
epoch [140/200] batch [5/36] time 0.164 (0.175) data 0.088 (0.098) loss_x loss_x 0.7368 (0.5901) acc_x 81.2500 (85.0000) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/36] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.2751 (0.4972) acc_x 93.7500 (88.1250) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/36] time 0.179 (0.174) data 0.101 (0.097) loss_x loss_x 0.3870 (0.4507) acc_x 87.5000 (89.5833) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/36] time 0.176 (0.174) data 0.098 (0.097) loss_x loss_x 0.3130 (0.4312) acc_x 96.8750 (90.0000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/36] time 0.177 (0.175) data 0.101 (0.098) loss_x loss_x 0.5454 (0.4405) acc_x 87.5000 (89.3750) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [30/36] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.2888 (0.4287) acc_x 93.7500 (89.5833) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [35/36] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.8428 (0.4401) acc_x 75.0000 (89.1071) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/13] time 0.184 (0.174) data 0.106 (0.097) loss_u loss_u 0.6401 (0.6664) acc_u 40.6250 (35.6250) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [10/13] time 0.172 (0.174) data 0.094 (0.097) loss_u loss_u 0.6411 (0.6665) acc_u 43.7500 (37.1875) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 273
confident_label rate tensor(0.7350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1176
clean true:1176
clean false:0
clean_rate:1.0
noisy true:151
noisy false:273
after delete: len(clean_dataset) 1176
after delete: len(noisy_dataset) 424
epoch [141/200] batch [5/36] time 0.172 (0.177) data 0.096 (0.101) loss_x loss_x 0.2491 (0.5054) acc_x 93.7500 (86.8750) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [10/36] time 0.176 (0.173) data 0.100 (0.097) loss_x loss_x 0.1644 (0.4600) acc_x 96.8750 (88.1250) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/36] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.7383 (0.5011) acc_x 81.2500 (86.4583) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/36] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 0.5381 (0.4791) acc_x 87.5000 (87.5000) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/36] time 0.176 (0.174) data 0.100 (0.098) loss_x loss_x 0.4585 (0.4703) acc_x 87.5000 (87.5000) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/36] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.2878 (0.4536) acc_x 90.6250 (87.9167) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [35/36] time 0.174 (0.174) data 0.098 (0.098) loss_x loss_x 0.4309 (0.4631) acc_x 87.5000 (87.9464) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/13] time 0.181 (0.175) data 0.103 (0.098) loss_u loss_u 0.7275 (0.6612) acc_u 31.2500 (38.1250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/13] time 0.182 (0.175) data 0.103 (0.098) loss_u loss_u 0.6660 (0.6747) acc_u 40.6250 (37.1875) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 270
confident_label rate tensor(0.7437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1190
clean true:1184
clean false:6
clean_rate:0.9949579831932773
noisy true:146
noisy false:264
after delete: len(clean_dataset) 1190
after delete: len(noisy_dataset) 410
epoch [142/200] batch [5/37] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.7534 (0.5030) acc_x 87.5000 (87.5000) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/37] time 0.166 (0.179) data 0.089 (0.102) loss_x loss_x 0.7275 (0.4991) acc_x 81.2500 (86.8750) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/37] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.4717 (0.5544) acc_x 87.5000 (86.6667) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/37] time 0.186 (0.184) data 0.110 (0.107) loss_x loss_x 0.4160 (0.5491) acc_x 84.3750 (86.4062) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [25/37] time 0.192 (0.184) data 0.116 (0.107) loss_x loss_x 0.7925 (0.5630) acc_x 87.5000 (86.7500) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [30/37] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.4197 (0.5358) acc_x 87.5000 (86.7708) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [35/37] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 0.8398 (0.5373) acc_x 75.0000 (86.5179) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/12] time 0.169 (0.181) data 0.092 (0.105) loss_u loss_u 0.6162 (0.6560) acc_u 43.7500 (40.0000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/12] time 0.181 (0.180) data 0.104 (0.104) loss_u loss_u 0.6250 (0.6573) acc_u 40.6250 (39.0625) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 272
confident_label rate tensor(0.7375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1180
clean true:1176
clean false:4
clean_rate:0.9966101694915255
noisy true:152
noisy false:268
after delete: len(clean_dataset) 1180
after delete: len(noisy_dataset) 420
epoch [143/200] batch [5/36] time 0.187 (0.174) data 0.111 (0.097) loss_x loss_x 0.6665 (0.5000) acc_x 87.5000 (88.1250) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [10/36] time 0.173 (0.171) data 0.096 (0.094) loss_x loss_x 0.5645 (0.5211) acc_x 87.5000 (87.8125) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/36] time 0.177 (0.171) data 0.100 (0.094) loss_x loss_x 0.5386 (0.5453) acc_x 87.5000 (87.5000) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/36] time 0.178 (0.173) data 0.101 (0.096) loss_x loss_x 0.1200 (0.5159) acc_x 100.0000 (88.4375) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/36] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.8091 (0.4974) acc_x 81.2500 (88.2500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/36] time 0.170 (0.172) data 0.093 (0.096) loss_x loss_x 0.6733 (0.5023) acc_x 84.3750 (88.3333) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [35/36] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.7222 (0.5025) acc_x 84.3750 (88.3929) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/13] time 0.169 (0.173) data 0.092 (0.096) loss_u loss_u 0.6807 (0.6900) acc_u 34.3750 (35.0000) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/13] time 0.172 (0.173) data 0.094 (0.096) loss_u loss_u 0.6328 (0.6897) acc_u 40.6250 (35.0000) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 284
confident_label rate tensor(0.7256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1161
clean true:1159
clean false:2
clean_rate:0.9982773471145564
noisy true:157
noisy false:282
after delete: len(clean_dataset) 1161
after delete: len(noisy_dataset) 439
epoch [144/200] batch [5/36] time 0.160 (0.177) data 0.084 (0.101) loss_x loss_x 0.4417 (0.4109) acc_x 87.5000 (87.5000) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [10/36] time 0.186 (0.176) data 0.108 (0.099) loss_x loss_x 0.6880 (0.4736) acc_x 84.3750 (87.1875) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [15/36] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.6255 (0.5071) acc_x 75.0000 (86.4583) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/36] time 0.190 (0.176) data 0.113 (0.099) loss_x loss_x 0.3418 (0.4895) acc_x 90.6250 (86.5625) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/36] time 0.169 (0.177) data 0.093 (0.100) loss_x loss_x 0.3149 (0.4768) acc_x 90.6250 (86.6250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/36] time 0.187 (0.179) data 0.109 (0.102) loss_x loss_x 0.5625 (0.4599) acc_x 87.5000 (87.1875) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [35/36] time 0.187 (0.180) data 0.111 (0.103) loss_x loss_x 0.3564 (0.4719) acc_x 87.5000 (86.7857) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/13] time 0.187 (0.181) data 0.110 (0.104) loss_u loss_u 0.6973 (0.6919) acc_u 34.3750 (36.8750) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/13] time 0.188 (0.181) data 0.112 (0.104) loss_u loss_u 0.5020 (0.6505) acc_u 53.1250 (40.0000) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 271
confident_label rate tensor(0.7381, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1181
clean true:1178
clean false:3
clean_rate:0.9974597798475868
noisy true:151
noisy false:268
after delete: len(clean_dataset) 1181
after delete: len(noisy_dataset) 419
epoch [145/200] batch [5/36] time 0.192 (0.190) data 0.115 (0.114) loss_x loss_x 0.4932 (0.5229) acc_x 87.5000 (88.1250) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [10/36] time 0.183 (0.188) data 0.107 (0.112) loss_x loss_x 0.5244 (0.5818) acc_x 90.6250 (85.0000) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/36] time 0.171 (0.184) data 0.094 (0.108) loss_x loss_x 0.1746 (0.5655) acc_x 96.8750 (85.6250) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [20/36] time 0.161 (0.181) data 0.084 (0.105) loss_x loss_x 0.3792 (0.5296) acc_x 87.5000 (86.4062) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/36] time 0.190 (0.182) data 0.114 (0.106) loss_x loss_x 0.5942 (0.5010) acc_x 87.5000 (87.1250) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [30/36] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.2810 (0.4775) acc_x 93.7500 (87.7083) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [35/36] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.4797 (0.4785) acc_x 90.6250 (88.1250) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/13] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.6025 (0.6037) acc_u 43.7500 (45.6250) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/13] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.5850 (0.6457) acc_u 43.7500 (40.9375) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 252
confident_label rate tensor(0.7444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1191
clean true:1191
clean false:0
clean_rate:1.0
noisy true:157
noisy false:252
after delete: len(clean_dataset) 1191
after delete: len(noisy_dataset) 409
epoch [146/200] batch [5/37] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.2866 (0.5913) acc_x 90.6250 (83.7500) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [10/37] time 0.181 (0.185) data 0.106 (0.108) loss_x loss_x 0.7061 (0.6351) acc_x 84.3750 (83.1250) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/37] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.3645 (0.5901) acc_x 90.6250 (84.1667) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [20/37] time 0.192 (0.185) data 0.115 (0.109) loss_x loss_x 0.3125 (0.5229) acc_x 96.8750 (86.2500) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [25/37] time 0.184 (0.185) data 0.106 (0.109) loss_x loss_x 0.7651 (0.5231) acc_x 75.0000 (86.2500) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [30/37] time 0.167 (0.184) data 0.091 (0.107) loss_x loss_x 0.3606 (0.5285) acc_x 93.7500 (86.1458) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [35/37] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.5156 (0.5182) acc_x 87.5000 (86.5179) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/12] time 0.171 (0.181) data 0.093 (0.104) loss_u loss_u 0.7510 (0.7091) acc_u 31.2500 (34.3750) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/12] time 0.165 (0.179) data 0.088 (0.103) loss_u loss_u 0.6523 (0.7160) acc_u 40.6250 (32.5000) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 256
confident_label rate tensor(0.7406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1185
clean true:1185
clean false:0
clean_rate:1.0
noisy true:159
noisy false:256
after delete: len(clean_dataset) 1185
after delete: len(noisy_dataset) 415
epoch [147/200] batch [5/37] time 0.173 (0.179) data 0.096 (0.102) loss_x loss_x 0.3042 (0.3648) acc_x 93.7500 (90.0000) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [10/37] time 0.175 (0.175) data 0.097 (0.098) loss_x loss_x 0.3054 (0.3353) acc_x 90.6250 (91.5625) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/37] time 0.190 (0.177) data 0.114 (0.100) loss_x loss_x 0.5591 (0.4161) acc_x 84.3750 (88.5417) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/37] time 0.186 (0.178) data 0.110 (0.102) loss_x loss_x 0.5366 (0.4380) acc_x 81.2500 (87.5000) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [25/37] time 0.186 (0.180) data 0.109 (0.104) loss_x loss_x 0.7153 (0.4372) acc_x 81.2500 (87.6250) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [30/37] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.6772 (0.4439) acc_x 81.2500 (87.2917) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [35/37] time 0.177 (0.181) data 0.100 (0.105) loss_x loss_x 0.4800 (0.4339) acc_x 87.5000 (87.4107) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/12] time 0.176 (0.181) data 0.099 (0.104) loss_u loss_u 0.6743 (0.6525) acc_u 37.5000 (40.0000) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/12] time 0.174 (0.181) data 0.098 (0.104) loss_u loss_u 0.7324 (0.6805) acc_u 28.1250 (36.5625) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 246
confident_label rate tensor(0.7519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1203
clean true:1200
clean false:3
clean_rate:0.9975062344139651
noisy true:154
noisy false:243
after delete: len(clean_dataset) 1203
after delete: len(noisy_dataset) 397
epoch [148/200] batch [5/37] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.5894 (0.4494) acc_x 84.3750 (89.3750) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [10/37] time 0.176 (0.180) data 0.100 (0.103) loss_x loss_x 0.3057 (0.3601) acc_x 93.7500 (91.2500) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/37] time 0.167 (0.177) data 0.090 (0.101) loss_x loss_x 0.3499 (0.4252) acc_x 90.6250 (88.7500) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/37] time 0.189 (0.181) data 0.110 (0.104) loss_x loss_x 0.5088 (0.4204) acc_x 87.5000 (89.5312) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [25/37] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.4431 (0.4500) acc_x 84.3750 (88.6250) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [30/37] time 0.175 (0.180) data 0.098 (0.103) loss_x loss_x 0.4900 (0.4514) acc_x 87.5000 (88.7500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [35/37] time 0.177 (0.179) data 0.101 (0.102) loss_x loss_x 0.4211 (0.4655) acc_x 93.7500 (88.5714) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/12] time 0.165 (0.178) data 0.088 (0.101) loss_u loss_u 0.8110 (0.7574) acc_u 15.6250 (26.2500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/12] time 0.158 (0.177) data 0.081 (0.100) loss_u loss_u 0.7437 (0.7206) acc_u 28.1250 (31.2500) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 261
confident_label rate tensor(0.7375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1180
clean true:1179
clean false:1
clean_rate:0.9991525423728813
noisy true:160
noisy false:260
after delete: len(clean_dataset) 1180
after delete: len(noisy_dataset) 420
epoch [149/200] batch [5/36] time 0.223 (0.193) data 0.146 (0.116) loss_x loss_x 0.1671 (0.3573) acc_x 93.7500 (88.7500) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [10/36] time 0.171 (0.188) data 0.094 (0.111) loss_x loss_x 0.5239 (0.4003) acc_x 84.3750 (87.8125) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/36] time 0.159 (0.180) data 0.083 (0.103) loss_x loss_x 0.6826 (0.4316) acc_x 84.3750 (87.2917) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/36] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.3135 (0.4361) acc_x 93.7500 (87.5000) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/36] time 0.159 (0.177) data 0.083 (0.100) loss_x loss_x 0.6060 (0.4492) acc_x 81.2500 (87.0000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [30/36] time 0.210 (0.181) data 0.133 (0.104) loss_x loss_x 0.1782 (0.4420) acc_x 93.7500 (87.3958) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [35/36] time 0.174 (0.183) data 0.098 (0.106) loss_x loss_x 0.2708 (0.4433) acc_x 96.8750 (87.8571) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/13] time 0.184 (0.183) data 0.108 (0.106) loss_u loss_u 0.6836 (0.6575) acc_u 37.5000 (38.1250) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/13] time 0.172 (0.182) data 0.094 (0.105) loss_u loss_u 0.6826 (0.6543) acc_u 31.2500 (39.0625) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 254
confident_label rate tensor(0.7487, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1198
clean true:1197
clean false:1
clean_rate:0.9991652754590985
noisy true:149
noisy false:253
after delete: len(clean_dataset) 1198
after delete: len(noisy_dataset) 402
epoch [150/200] batch [5/37] time 0.163 (0.174) data 0.087 (0.098) loss_x loss_x 0.8369 (0.5470) acc_x 75.0000 (85.6250) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [10/37] time 0.177 (0.175) data 0.100 (0.099) loss_x loss_x 0.2546 (0.4715) acc_x 96.8750 (87.8125) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/37] time 0.198 (0.178) data 0.122 (0.101) loss_x loss_x 0.5352 (0.4631) acc_x 90.6250 (87.0833) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/37] time 0.168 (0.178) data 0.092 (0.101) loss_x loss_x 0.3269 (0.4529) acc_x 87.5000 (87.9688) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [25/37] time 0.180 (0.177) data 0.103 (0.101) loss_x loss_x 0.3589 (0.4791) acc_x 93.7500 (87.6250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [30/37] time 0.176 (0.177) data 0.097 (0.101) loss_x loss_x 0.5312 (0.4896) acc_x 81.2500 (87.0833) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [35/37] time 0.170 (0.178) data 0.094 (0.101) loss_x loss_x 0.2976 (0.4691) acc_x 93.7500 (87.5000) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/12] time 0.190 (0.178) data 0.113 (0.102) loss_u loss_u 0.6274 (0.7175) acc_u 46.8750 (35.0000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/12] time 0.166 (0.180) data 0.089 (0.103) loss_u loss_u 0.6924 (0.7086) acc_u 31.2500 (35.0000) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 238
confident_label rate tensor(0.7506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1201
clean true:1201
clean false:0
clean_rate:1.0
noisy true:161
noisy false:238
after delete: len(clean_dataset) 1201
after delete: len(noisy_dataset) 399
epoch [151/200] batch [5/37] time 0.166 (0.172) data 0.090 (0.095) loss_x loss_x 0.3352 (0.4372) acc_x 93.7500 (88.7500) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [10/37] time 0.166 (0.169) data 0.090 (0.092) loss_x loss_x 0.5063 (0.4655) acc_x 78.1250 (87.5000) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/37] time 0.181 (0.171) data 0.103 (0.094) loss_x loss_x 0.1508 (0.3805) acc_x 100.0000 (90.2083) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/37] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.4653 (0.4311) acc_x 87.5000 (89.2188) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/37] time 0.169 (0.172) data 0.093 (0.095) loss_x loss_x 0.2710 (0.4254) acc_x 90.6250 (89.1250) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [30/37] time 0.173 (0.172) data 0.097 (0.095) loss_x loss_x 0.4487 (0.4417) acc_x 87.5000 (88.6458) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [35/37] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 0.5923 (0.4484) acc_x 75.0000 (88.2143) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/12] time 0.181 (0.174) data 0.103 (0.097) loss_u loss_u 0.7402 (0.7849) acc_u 25.0000 (23.7500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/12] time 0.182 (0.175) data 0.106 (0.098) loss_u loss_u 0.6279 (0.7212) acc_u 37.5000 (31.5625) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 225
confident_label rate tensor(0.7619, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1219
clean true:1217
clean false:2
clean_rate:0.9983593109105825
noisy true:158
noisy false:223
after delete: len(clean_dataset) 1219
after delete: len(noisy_dataset) 381
epoch [152/200] batch [5/38] time 0.186 (0.187) data 0.110 (0.110) loss_x loss_x 0.0820 (0.3870) acc_x 96.8750 (89.3750) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [10/38] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.5527 (0.4557) acc_x 84.3750 (88.1250) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [15/38] time 0.162 (0.181) data 0.085 (0.104) loss_x loss_x 0.4595 (0.4747) acc_x 84.3750 (87.5000) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [20/38] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.6255 (0.4718) acc_x 87.5000 (88.5938) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [25/38] time 0.171 (0.178) data 0.094 (0.102) loss_x loss_x 0.4070 (0.4723) acc_x 93.7500 (88.5000) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [30/38] time 0.180 (0.178) data 0.104 (0.101) loss_x loss_x 0.3066 (0.4716) acc_x 87.5000 (88.0208) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [35/38] time 0.172 (0.177) data 0.096 (0.100) loss_x loss_x 0.5894 (0.4620) acc_x 93.7500 (88.3036) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/11] time 0.191 (0.177) data 0.114 (0.101) loss_u loss_u 0.6938 (0.6705) acc_u 31.2500 (36.2500) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/11] time 0.195 (0.178) data 0.118 (0.101) loss_u loss_u 0.8086 (0.7075) acc_u 21.8750 (31.5625) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 250
confident_label rate tensor(0.7500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1200
clean true:1197
clean false:3
clean_rate:0.9975
noisy true:153
noisy false:247
after delete: len(clean_dataset) 1200
after delete: len(noisy_dataset) 400
epoch [153/200] batch [5/37] time 0.188 (0.185) data 0.112 (0.108) loss_x loss_x 0.3577 (0.3786) acc_x 90.6250 (90.6250) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [10/37] time 0.171 (0.180) data 0.095 (0.103) loss_x loss_x 0.6143 (0.4888) acc_x 84.3750 (87.8125) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/37] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.6973 (0.4976) acc_x 84.3750 (87.9167) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/37] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.2134 (0.4902) acc_x 93.7500 (88.1250) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [25/37] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.3477 (0.4711) acc_x 93.7500 (88.3750) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [30/37] time 0.186 (0.182) data 0.110 (0.106) loss_x loss_x 0.3765 (0.5016) acc_x 93.7500 (87.5000) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [35/37] time 0.189 (0.183) data 0.113 (0.106) loss_x loss_x 0.4939 (0.5132) acc_x 87.5000 (86.8750) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/12] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.7388 (0.6951) acc_u 28.1250 (33.7500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/12] time 0.180 (0.183) data 0.103 (0.107) loss_u loss_u 0.7637 (0.6964) acc_u 21.8750 (33.4375) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 262
confident_label rate tensor(0.7387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1182
clean true:1180
clean false:2
clean_rate:0.9983079526226735
noisy true:158
noisy false:260
after delete: len(clean_dataset) 1182
after delete: len(noisy_dataset) 418
epoch [154/200] batch [5/36] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.2230 (0.4733) acc_x 93.7500 (89.3750) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [10/36] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.4121 (0.5290) acc_x 90.6250 (88.4375) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/36] time 0.172 (0.179) data 0.096 (0.102) loss_x loss_x 0.9233 (0.5259) acc_x 81.2500 (87.7083) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/36] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.4924 (0.4948) acc_x 87.5000 (87.9688) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/36] time 0.173 (0.178) data 0.097 (0.101) loss_x loss_x 0.3789 (0.4771) acc_x 90.6250 (88.2500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/36] time 0.163 (0.176) data 0.085 (0.099) loss_x loss_x 0.4270 (0.4535) acc_x 87.5000 (88.7500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [35/36] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.3589 (0.4501) acc_x 93.7500 (88.9286) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/13] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.6792 (0.7344) acc_u 34.3750 (27.5000) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/13] time 0.172 (0.174) data 0.094 (0.098) loss_u loss_u 0.7256 (0.6971) acc_u 31.2500 (32.8125) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 257
confident_label rate tensor(0.7525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1204
clean true:1200
clean false:4
clean_rate:0.9966777408637874
noisy true:143
noisy false:253
after delete: len(clean_dataset) 1204
after delete: len(noisy_dataset) 396
epoch [155/200] batch [5/37] time 0.178 (0.184) data 0.102 (0.107) loss_x loss_x 0.7197 (0.5856) acc_x 81.2500 (86.2500) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [10/37] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.3582 (0.5429) acc_x 81.2500 (86.2500) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/37] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.2612 (0.5034) acc_x 96.8750 (87.7083) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [20/37] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.5405 (0.5226) acc_x 90.6250 (87.6562) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [25/37] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.3977 (0.5151) acc_x 87.5000 (87.6250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [30/37] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.5103 (0.5106) acc_x 87.5000 (87.1875) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [35/37] time 0.169 (0.181) data 0.093 (0.104) loss_x loss_x 0.6094 (0.5326) acc_x 84.3750 (86.0714) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/12] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.6260 (0.7049) acc_u 40.6250 (33.1250) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/12] time 0.181 (0.179) data 0.104 (0.103) loss_u loss_u 0.6831 (0.6976) acc_u 40.6250 (34.3750) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 248
confident_label rate tensor(0.7512, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1202
clean true:1202
clean false:0
clean_rate:1.0
noisy true:150
noisy false:248
after delete: len(clean_dataset) 1202
after delete: len(noisy_dataset) 398
epoch [156/200] batch [5/37] time 0.188 (0.173) data 0.110 (0.096) loss_x loss_x 0.4128 (0.4679) acc_x 90.6250 (91.2500) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/37] time 0.165 (0.177) data 0.088 (0.100) loss_x loss_x 0.4534 (0.4064) acc_x 81.2500 (90.9375) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/37] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.5518 (0.4078) acc_x 84.3750 (90.6250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/37] time 0.187 (0.179) data 0.110 (0.102) loss_x loss_x 0.6660 (0.4471) acc_x 81.2500 (89.0625) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [25/37] time 0.172 (0.178) data 0.096 (0.101) loss_x loss_x 0.8892 (0.4997) acc_x 81.2500 (87.8750) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [30/37] time 0.199 (0.178) data 0.122 (0.102) loss_x loss_x 0.6675 (0.4938) acc_x 84.3750 (88.1250) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [35/37] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.3601 (0.4920) acc_x 90.6250 (88.0357) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/12] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.5806 (0.6290) acc_u 46.8750 (41.8750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/12] time 0.182 (0.180) data 0.105 (0.104) loss_u loss_u 0.7471 (0.6684) acc_u 31.2500 (38.4375) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 262
confident_label rate tensor(0.7356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1177
clean true:1176
clean false:1
clean_rate:0.9991503823279524
noisy true:162
noisy false:261
after delete: len(clean_dataset) 1177
after delete: len(noisy_dataset) 423
epoch [157/200] batch [5/36] time 0.170 (0.176) data 0.094 (0.100) loss_x loss_x 0.6050 (0.4835) acc_x 84.3750 (90.0000) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/36] time 0.183 (0.178) data 0.107 (0.102) loss_x loss_x 0.7349 (0.4775) acc_x 81.2500 (87.5000) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/36] time 0.192 (0.181) data 0.114 (0.104) loss_x loss_x 0.4080 (0.4714) acc_x 90.6250 (87.9167) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/36] time 0.167 (0.179) data 0.091 (0.102) loss_x loss_x 0.2590 (0.4205) acc_x 96.8750 (89.6875) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/36] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.3489 (0.4146) acc_x 90.6250 (90.0000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/36] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 0.5068 (0.4043) acc_x 87.5000 (90.2083) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [35/36] time 0.188 (0.180) data 0.112 (0.104) loss_x loss_x 0.2378 (0.3967) acc_x 93.7500 (90.4464) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/13] time 0.169 (0.179) data 0.091 (0.103) loss_u loss_u 0.6128 (0.6911) acc_u 40.6250 (34.3750) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/13] time 0.189 (0.180) data 0.111 (0.103) loss_u loss_u 0.6011 (0.6772) acc_u 43.7500 (36.8750) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 244
confident_label rate tensor(0.7487, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1198
clean true:1195
clean false:3
clean_rate:0.9974958263772955
noisy true:161
noisy false:241
after delete: len(clean_dataset) 1198
after delete: len(noisy_dataset) 402
epoch [158/200] batch [5/37] time 0.185 (0.188) data 0.109 (0.111) loss_x loss_x 0.3538 (0.4442) acc_x 90.6250 (86.2500) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [10/37] time 0.188 (0.196) data 0.111 (0.119) loss_x loss_x 0.6631 (0.5162) acc_x 84.3750 (85.3125) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [15/37] time 0.180 (0.191) data 0.102 (0.113) loss_x loss_x 0.4231 (0.5359) acc_x 84.3750 (85.4167) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [20/37] time 0.180 (0.188) data 0.103 (0.111) loss_x loss_x 0.2646 (0.5223) acc_x 93.7500 (86.4062) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [25/37] time 0.187 (0.188) data 0.111 (0.111) loss_x loss_x 0.3398 (0.4873) acc_x 90.6250 (87.5000) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [30/37] time 0.178 (0.187) data 0.102 (0.110) loss_x loss_x 0.0712 (0.5073) acc_x 96.8750 (87.2917) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [35/37] time 0.175 (0.185) data 0.098 (0.108) loss_x loss_x 0.2861 (0.5036) acc_x 90.6250 (87.2321) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/12] time 0.194 (0.184) data 0.116 (0.107) loss_u loss_u 0.6729 (0.7185) acc_u 34.3750 (31.2500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/12] time 0.166 (0.183) data 0.089 (0.106) loss_u loss_u 0.7173 (0.7115) acc_u 34.3750 (33.1250) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 233
confident_label rate tensor(0.7619, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1219
clean true:1218
clean false:1
clean_rate:0.9991796554552912
noisy true:149
noisy false:232
after delete: len(clean_dataset) 1219
after delete: len(noisy_dataset) 381
epoch [159/200] batch [5/38] time 0.179 (0.173) data 0.103 (0.096) loss_x loss_x 0.6572 (0.4306) acc_x 78.1250 (88.1250) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [10/38] time 0.185 (0.178) data 0.109 (0.102) loss_x loss_x 0.2969 (0.4090) acc_x 90.6250 (89.3750) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/38] time 0.179 (0.179) data 0.103 (0.102) loss_x loss_x 0.3979 (0.4391) acc_x 87.5000 (88.1250) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [20/38] time 0.180 (0.179) data 0.103 (0.102) loss_x loss_x 0.3662 (0.4393) acc_x 93.7500 (88.5938) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [25/38] time 0.186 (0.178) data 0.110 (0.101) loss_x loss_x 0.4805 (0.4335) acc_x 84.3750 (89.0000) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [30/38] time 0.175 (0.179) data 0.098 (0.102) loss_x loss_x 0.5796 (0.4189) acc_x 93.7500 (89.3750) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [35/38] time 0.188 (0.179) data 0.112 (0.103) loss_x loss_x 0.4558 (0.4270) acc_x 90.6250 (89.1964) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/11] time 0.185 (0.180) data 0.109 (0.104) loss_u loss_u 0.7871 (0.7442) acc_u 25.0000 (28.1250) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/11] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.7183 (0.7285) acc_u 28.1250 (30.0000) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 255
confident_label rate tensor(0.7500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1200
clean true:1199
clean false:1
clean_rate:0.9991666666666666
noisy true:146
noisy false:254
after delete: len(clean_dataset) 1200
after delete: len(noisy_dataset) 400
epoch [160/200] batch [5/37] time 0.167 (0.175) data 0.090 (0.098) loss_x loss_x 0.5151 (0.4608) acc_x 84.3750 (89.3750) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [10/37] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.3704 (0.4146) acc_x 87.5000 (89.0625) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/37] time 0.175 (0.172) data 0.098 (0.096) loss_x loss_x 0.4329 (0.4349) acc_x 87.5000 (88.5417) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/37] time 0.176 (0.173) data 0.100 (0.097) loss_x loss_x 0.6240 (0.4126) acc_x 84.3750 (89.5312) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/37] time 0.192 (0.175) data 0.115 (0.098) loss_x loss_x 0.3982 (0.4057) acc_x 93.7500 (89.0000) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [30/37] time 0.192 (0.177) data 0.113 (0.100) loss_x loss_x 0.3389 (0.4254) acc_x 93.7500 (88.5417) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [35/37] time 0.188 (0.178) data 0.112 (0.101) loss_x loss_x 0.5205 (0.4424) acc_x 81.2500 (87.6786) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/12] time 0.178 (0.179) data 0.102 (0.102) loss_u loss_u 0.8066 (0.7388) acc_u 28.1250 (29.3750) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/12] time 0.164 (0.179) data 0.087 (0.102) loss_u loss_u 0.6240 (0.7015) acc_u 40.6250 (33.7500) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 269
confident_label rate tensor(0.7312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1170
clean true:1169
clean false:1
clean_rate:0.9991452991452991
noisy true:162
noisy false:268
after delete: len(clean_dataset) 1170
after delete: len(noisy_dataset) 430
epoch [161/200] batch [5/36] time 0.187 (0.186) data 0.111 (0.110) loss_x loss_x 0.5439 (0.4119) acc_x 87.5000 (88.7500) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [10/36] time 0.189 (0.191) data 0.112 (0.113) loss_x loss_x 0.6387 (0.3885) acc_x 75.0000 (88.1250) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/36] time 0.185 (0.189) data 0.109 (0.112) loss_x loss_x 0.4956 (0.4389) acc_x 90.6250 (87.7083) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/36] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.4294 (0.4706) acc_x 90.6250 (87.1875) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [25/36] time 0.163 (0.186) data 0.087 (0.109) loss_x loss_x 0.2913 (0.4579) acc_x 93.7500 (87.5000) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [30/36] time 0.169 (0.184) data 0.092 (0.107) loss_x loss_x 0.7231 (0.4815) acc_x 84.3750 (86.9792) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [35/36] time 0.190 (0.183) data 0.113 (0.106) loss_x loss_x 0.4475 (0.4858) acc_x 87.5000 (87.1429) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/13] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.7349 (0.6612) acc_u 28.1250 (38.1250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [10/13] time 0.178 (0.183) data 0.101 (0.106) loss_u loss_u 0.7114 (0.6734) acc_u 31.2500 (36.5625) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 261
confident_label rate tensor(0.7400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1184
clean true:1184
clean false:0
clean_rate:1.0
noisy true:155
noisy false:261
after delete: len(clean_dataset) 1184
after delete: len(noisy_dataset) 416
epoch [162/200] batch [5/37] time 0.172 (0.178) data 0.095 (0.101) loss_x loss_x 0.0931 (0.4629) acc_x 100.0000 (88.7500) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [10/37] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.7456 (0.4642) acc_x 78.1250 (88.1250) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/37] time 0.172 (0.173) data 0.096 (0.097) loss_x loss_x 0.6367 (0.4758) acc_x 84.3750 (87.9167) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/37] time 0.165 (0.172) data 0.087 (0.096) loss_x loss_x 0.6260 (0.4875) acc_x 84.3750 (87.5000) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/37] time 0.166 (0.171) data 0.089 (0.095) loss_x loss_x 0.3840 (0.4524) acc_x 90.6250 (88.1250) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [30/37] time 0.176 (0.172) data 0.098 (0.095) loss_x loss_x 0.3755 (0.4397) acc_x 87.5000 (88.4375) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [35/37] time 0.177 (0.173) data 0.101 (0.096) loss_x loss_x 0.6826 (0.4307) acc_x 84.3750 (88.7500) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/13] time 0.174 (0.174) data 0.097 (0.097) loss_u loss_u 0.6924 (0.6936) acc_u 34.3750 (34.3750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [10/13] time 0.182 (0.174) data 0.103 (0.097) loss_u loss_u 0.5254 (0.7004) acc_u 53.1250 (33.4375) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 266
confident_label rate tensor(0.7462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1194
clean true:1193
clean false:1
clean_rate:0.9991624790619765
noisy true:141
noisy false:265
after delete: len(clean_dataset) 1194
after delete: len(noisy_dataset) 406
epoch [163/200] batch [5/37] time 0.166 (0.169) data 0.089 (0.092) loss_x loss_x 0.3113 (0.4627) acc_x 90.6250 (86.2500) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [10/37] time 0.165 (0.167) data 0.088 (0.090) loss_x loss_x 0.6968 (0.5083) acc_x 81.2500 (86.8750) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/37] time 0.170 (0.168) data 0.093 (0.091) loss_x loss_x 0.3398 (0.4756) acc_x 90.6250 (87.7083) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/37] time 0.173 (0.169) data 0.097 (0.093) loss_x loss_x 0.2485 (0.5016) acc_x 93.7500 (87.9688) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/37] time 0.179 (0.170) data 0.102 (0.094) loss_x loss_x 0.8193 (0.4938) acc_x 78.1250 (88.0000) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [30/37] time 0.171 (0.172) data 0.095 (0.095) loss_x loss_x 0.6714 (0.4930) acc_x 84.3750 (88.2292) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [35/37] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 0.4470 (0.4936) acc_x 87.5000 (88.2143) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/12] time 0.179 (0.173) data 0.103 (0.096) loss_u loss_u 0.6665 (0.6556) acc_u 40.6250 (41.2500) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [10/12] time 0.178 (0.173) data 0.101 (0.096) loss_u loss_u 0.7100 (0.6662) acc_u 37.5000 (40.0000) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 245
confident_label rate tensor(0.7544, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1207
clean true:1206
clean false:1
clean_rate:0.9991714995857498
noisy true:149
noisy false:244
after delete: len(clean_dataset) 1207
after delete: len(noisy_dataset) 393
epoch [164/200] batch [5/37] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.4248 (0.5418) acc_x 90.6250 (83.7500) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [10/37] time 0.172 (0.177) data 0.096 (0.101) loss_x loss_x 0.2751 (0.5032) acc_x 93.7500 (85.3125) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/37] time 0.177 (0.177) data 0.101 (0.100) loss_x loss_x 0.5356 (0.4702) acc_x 87.5000 (87.0833) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/37] time 0.173 (0.177) data 0.094 (0.100) loss_x loss_x 0.4126 (0.4737) acc_x 93.7500 (87.6562) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [25/37] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.2954 (0.4560) acc_x 90.6250 (88.1250) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [30/37] time 0.175 (0.174) data 0.098 (0.098) loss_x loss_x 0.5859 (0.4545) acc_x 75.0000 (87.8125) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [35/37] time 0.182 (0.174) data 0.106 (0.097) loss_x loss_x 0.0706 (0.4501) acc_x 100.0000 (88.1250) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/12] time 0.172 (0.173) data 0.092 (0.096) loss_u loss_u 0.8228 (0.7252) acc_u 18.7500 (30.0000) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [10/12] time 0.178 (0.172) data 0.101 (0.095) loss_u loss_u 0.6787 (0.7178) acc_u 37.5000 (31.5625) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 246
confident_label rate tensor(0.7494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1199
clean true:1198
clean false:1
clean_rate:0.9991659716430359
noisy true:156
noisy false:245
after delete: len(clean_dataset) 1199
after delete: len(noisy_dataset) 401
epoch [165/200] batch [5/37] time 0.181 (0.183) data 0.103 (0.106) loss_x loss_x 0.4373 (0.3553) acc_x 84.3750 (91.8750) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [10/37] time 0.174 (0.179) data 0.097 (0.102) loss_x loss_x 0.8174 (0.4787) acc_x 81.2500 (88.1250) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/37] time 0.169 (0.180) data 0.093 (0.103) loss_x loss_x 0.3855 (0.5016) acc_x 90.6250 (87.2917) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/37] time 0.169 (0.176) data 0.093 (0.100) loss_x loss_x 0.5552 (0.5036) acc_x 87.5000 (87.0312) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/37] time 0.179 (0.175) data 0.103 (0.099) loss_x loss_x 0.4700 (0.5108) acc_x 81.2500 (87.1250) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [30/37] time 0.187 (0.177) data 0.110 (0.100) loss_x loss_x 0.5244 (0.5262) acc_x 84.3750 (86.5625) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [35/37] time 0.188 (0.178) data 0.110 (0.102) loss_x loss_x 0.2139 (0.5010) acc_x 90.6250 (86.9643) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/12] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.7280 (0.6622) acc_u 34.3750 (37.5000) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/12] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.6465 (0.6767) acc_u 40.6250 (35.6250) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 248
confident_label rate tensor(0.7562, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1210
clean true:1210
clean false:0
clean_rate:1.0
noisy true:142
noisy false:248
after delete: len(clean_dataset) 1210
after delete: len(noisy_dataset) 390
epoch [166/200] batch [5/37] time 0.162 (0.162) data 0.085 (0.085) loss_x loss_x 0.5698 (0.5038) acc_x 84.3750 (89.3750) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [10/37] time 0.164 (0.162) data 0.086 (0.085) loss_x loss_x 0.6929 (0.5555) acc_x 78.1250 (86.8750) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/37] time 0.173 (0.164) data 0.097 (0.087) loss_x loss_x 0.7007 (0.5150) acc_x 78.1250 (86.6667) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/37] time 0.186 (0.168) data 0.110 (0.091) loss_x loss_x 0.5435 (0.5040) acc_x 90.6250 (87.1875) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/37] time 0.220 (0.172) data 0.144 (0.096) loss_x loss_x 0.3967 (0.4848) acc_x 90.6250 (87.3750) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [30/37] time 0.180 (0.174) data 0.102 (0.097) loss_x loss_x 0.4922 (0.4758) acc_x 87.5000 (87.6042) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [35/37] time 0.179 (0.175) data 0.102 (0.099) loss_x loss_x 0.5757 (0.4930) acc_x 84.3750 (87.0536) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/12] time 0.173 (0.176) data 0.096 (0.099) loss_u loss_u 0.6689 (0.6849) acc_u 34.3750 (33.7500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/12] time 0.173 (0.176) data 0.096 (0.099) loss_u loss_u 0.6685 (0.7005) acc_u 40.6250 (33.1250) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 255
confident_label rate tensor(0.7381, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1181
clean true:1180
clean false:1
clean_rate:0.9991532599491956
noisy true:165
noisy false:254
after delete: len(clean_dataset) 1181
after delete: len(noisy_dataset) 419
epoch [167/200] batch [5/36] time 0.182 (0.186) data 0.106 (0.110) loss_x loss_x 0.7363 (0.4952) acc_x 78.1250 (87.5000) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [10/36] time 0.185 (0.187) data 0.109 (0.111) loss_x loss_x 0.4858 (0.4626) acc_x 93.7500 (88.7500) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/36] time 0.173 (0.181) data 0.097 (0.105) loss_x loss_x 0.6431 (0.4304) acc_x 81.2500 (89.5833) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/36] time 0.169 (0.178) data 0.091 (0.101) loss_x loss_x 0.3313 (0.4255) acc_x 90.6250 (89.6875) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/36] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.6528 (0.4298) acc_x 78.1250 (89.2500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/36] time 0.172 (0.176) data 0.096 (0.100) loss_x loss_x 0.6543 (0.4241) acc_x 75.0000 (88.8542) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [35/36] time 0.162 (0.175) data 0.084 (0.098) loss_x loss_x 0.6680 (0.4318) acc_x 81.2500 (88.7500) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/13] time 0.182 (0.175) data 0.106 (0.099) loss_u loss_u 0.6685 (0.6294) acc_u 37.5000 (41.2500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/13] time 0.190 (0.176) data 0.113 (0.100) loss_u loss_u 0.8135 (0.6673) acc_u 28.1250 (37.5000) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 240
confident_label rate tensor(0.7512, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1202
clean true:1200
clean false:2
clean_rate:0.9983361064891847
noisy true:160
noisy false:238
after delete: len(clean_dataset) 1202
after delete: len(noisy_dataset) 398
epoch [168/200] batch [5/37] time 0.166 (0.163) data 0.089 (0.086) loss_x loss_x 0.3662 (0.4356) acc_x 87.5000 (88.7500) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [10/37] time 0.180 (0.170) data 0.103 (0.094) loss_x loss_x 0.6899 (0.4985) acc_x 87.5000 (87.5000) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [15/37] time 0.179 (0.173) data 0.102 (0.097) loss_x loss_x 0.5391 (0.4510) acc_x 84.3750 (87.9167) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/37] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 0.2007 (0.4219) acc_x 90.6250 (88.2812) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/37] time 0.178 (0.174) data 0.100 (0.098) loss_x loss_x 0.4548 (0.4314) acc_x 87.5000 (88.3750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [30/37] time 0.182 (0.175) data 0.104 (0.098) loss_x loss_x 0.2742 (0.4227) acc_x 90.6250 (88.6458) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [35/37] time 0.177 (0.175) data 0.101 (0.098) loss_x loss_x 0.2910 (0.4150) acc_x 90.6250 (88.9286) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/12] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.6694 (0.6709) acc_u 43.7500 (38.7500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [10/12] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.7588 (0.6849) acc_u 25.0000 (36.2500) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 227
confident_label rate tensor(0.7662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1226
clean true:1223
clean false:3
clean_rate:0.9975530179445351
noisy true:150
noisy false:224
after delete: len(clean_dataset) 1226
after delete: len(noisy_dataset) 374
epoch [169/200] batch [5/38] time 0.178 (0.176) data 0.102 (0.099) loss_x loss_x 0.5273 (0.4211) acc_x 87.5000 (88.7500) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [10/38] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 0.5049 (0.4830) acc_x 90.6250 (87.5000) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/38] time 0.174 (0.178) data 0.098 (0.101) loss_x loss_x 0.4009 (0.4595) acc_x 93.7500 (87.2917) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [20/38] time 0.172 (0.176) data 0.095 (0.099) loss_x loss_x 0.4902 (0.4649) acc_x 87.5000 (87.1875) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [25/38] time 0.176 (0.176) data 0.100 (0.099) loss_x loss_x 0.4041 (0.4698) acc_x 90.6250 (87.3750) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [30/38] time 0.174 (0.176) data 0.097 (0.099) loss_x loss_x 0.5371 (0.4865) acc_x 87.5000 (87.0833) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [35/38] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.4617 (0.4932) acc_x 90.6250 (86.8750) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/11] time 0.185 (0.174) data 0.109 (0.097) loss_u loss_u 0.8159 (0.7759) acc_u 21.8750 (26.8750) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/11] time 0.177 (0.175) data 0.098 (0.098) loss_u loss_u 0.5015 (0.7195) acc_u 56.2500 (32.5000) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 247
confident_label rate tensor(0.7525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1204
clean true:1203
clean false:1
clean_rate:0.9991694352159468
noisy true:150
noisy false:246
after delete: len(clean_dataset) 1204
after delete: len(noisy_dataset) 396
epoch [170/200] batch [5/37] time 0.183 (0.172) data 0.107 (0.094) loss_x loss_x 0.4863 (0.4101) acc_x 87.5000 (88.1250) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [10/37] time 0.179 (0.177) data 0.103 (0.100) loss_x loss_x 0.3640 (0.3794) acc_x 93.7500 (89.6875) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/37] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.6348 (0.4377) acc_x 84.3750 (87.9167) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/37] time 0.180 (0.179) data 0.104 (0.103) loss_x loss_x 0.5405 (0.4775) acc_x 84.3750 (86.8750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [25/37] time 0.169 (0.178) data 0.093 (0.101) loss_x loss_x 0.2598 (0.4642) acc_x 93.7500 (87.3750) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [30/37] time 0.176 (0.177) data 0.100 (0.100) loss_x loss_x 0.8838 (0.4700) acc_x 75.0000 (86.8750) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [35/37] time 0.176 (0.175) data 0.099 (0.099) loss_x loss_x 1.2607 (0.4846) acc_x 65.6250 (86.4286) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/12] time 0.162 (0.175) data 0.086 (0.098) loss_u loss_u 0.7192 (0.6743) acc_u 31.2500 (38.1250) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/12] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.7988 (0.6680) acc_u 18.7500 (37.8125) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 253
confident_label rate tensor(0.7444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1191
clean true:1189
clean false:2
clean_rate:0.998320738874895
noisy true:158
noisy false:251
after delete: len(clean_dataset) 1191
after delete: len(noisy_dataset) 409
epoch [171/200] batch [5/37] time 0.162 (0.163) data 0.086 (0.086) loss_x loss_x 0.4832 (0.3657) acc_x 78.1250 (88.1250) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [10/37] time 0.163 (0.173) data 0.087 (0.097) loss_x loss_x 0.5806 (0.4119) acc_x 78.1250 (88.7500) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/37] time 0.186 (0.174) data 0.110 (0.098) loss_x loss_x 0.3689 (0.3986) acc_x 90.6250 (89.3750) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [20/37] time 0.180 (0.176) data 0.102 (0.100) loss_x loss_x 0.4944 (0.4080) acc_x 90.6250 (89.0625) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/37] time 0.183 (0.177) data 0.107 (0.100) loss_x loss_x 0.4802 (0.4141) acc_x 84.3750 (89.1250) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [30/37] time 0.183 (0.178) data 0.107 (0.101) loss_x loss_x 0.5000 (0.4403) acc_x 81.2500 (88.2292) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [35/37] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.4714 (0.4385) acc_x 90.6250 (88.5714) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/12] time 0.213 (0.179) data 0.136 (0.103) loss_u loss_u 0.6831 (0.7084) acc_u 34.3750 (33.7500) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/12] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.5283 (0.6979) acc_u 50.0000 (33.7500) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 243
confident_label rate tensor(0.7506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1201
clean true:1201
clean false:0
clean_rate:1.0
noisy true:156
noisy false:243
after delete: len(clean_dataset) 1201
after delete: len(noisy_dataset) 399
epoch [172/200] batch [5/37] time 0.167 (0.184) data 0.091 (0.107) loss_x loss_x 0.5132 (0.4037) acc_x 84.3750 (90.0000) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [10/37] time 0.189 (0.185) data 0.112 (0.109) loss_x loss_x 0.4417 (0.5183) acc_x 90.6250 (86.5625) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [15/37] time 0.189 (0.185) data 0.113 (0.108) loss_x loss_x 0.9414 (0.5133) acc_x 68.7500 (85.8333) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [20/37] time 0.170 (0.183) data 0.094 (0.106) loss_x loss_x 0.6167 (0.5156) acc_x 81.2500 (85.7812) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [25/37] time 0.172 (0.181) data 0.094 (0.104) loss_x loss_x 0.4631 (0.4965) acc_x 84.3750 (86.2500) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [30/37] time 0.172 (0.181) data 0.096 (0.104) loss_x loss_x 0.7256 (0.4999) acc_x 84.3750 (86.3542) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [35/37] time 0.172 (0.179) data 0.096 (0.103) loss_x loss_x 0.2656 (0.4997) acc_x 90.6250 (86.2500) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/12] time 0.209 (0.180) data 0.132 (0.103) loss_u loss_u 0.6831 (0.7270) acc_u 37.5000 (35.6250) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [10/12] time 0.175 (0.180) data 0.099 (0.103) loss_u loss_u 0.6382 (0.6938) acc_u 40.6250 (37.1875) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 279
confident_label rate tensor(0.7356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1177
clean true:1177
clean false:0
clean_rate:1.0
noisy true:144
noisy false:279
after delete: len(clean_dataset) 1177
after delete: len(noisy_dataset) 423
epoch [173/200] batch [5/36] time 0.191 (0.186) data 0.114 (0.110) loss_x loss_x 0.3838 (0.5286) acc_x 90.6250 (87.5000) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [10/36] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.9429 (0.4721) acc_x 68.7500 (88.1250) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/36] time 0.171 (0.181) data 0.092 (0.104) loss_x loss_x 0.3364 (0.4613) acc_x 93.7500 (88.7500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/36] time 0.170 (0.178) data 0.094 (0.101) loss_x loss_x 0.1855 (0.4442) acc_x 96.8750 (89.6875) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/36] time 0.167 (0.178) data 0.091 (0.101) loss_x loss_x 0.5522 (0.4640) acc_x 84.3750 (88.6250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/36] time 0.169 (0.177) data 0.093 (0.101) loss_x loss_x 0.4492 (0.4634) acc_x 90.6250 (89.0625) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [35/36] time 0.173 (0.177) data 0.095 (0.100) loss_x loss_x 0.3425 (0.4524) acc_x 96.8750 (89.2857) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/13] time 0.168 (0.175) data 0.091 (0.099) loss_u loss_u 0.8003 (0.7047) acc_u 25.0000 (35.6250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/13] time 0.172 (0.175) data 0.096 (0.098) loss_u loss_u 0.6348 (0.7051) acc_u 40.6250 (34.6875) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 240
confident_label rate tensor(0.7537, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1206
clean true:1205
clean false:1
clean_rate:0.9991708126036484
noisy true:155
noisy false:239
after delete: len(clean_dataset) 1206
after delete: len(noisy_dataset) 394
epoch [174/200] batch [5/37] time 0.163 (0.167) data 0.086 (0.090) loss_x loss_x 0.3911 (0.4159) acc_x 90.6250 (90.6250) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [10/37] time 0.228 (0.172) data 0.152 (0.095) loss_x loss_x 0.2942 (0.3730) acc_x 93.7500 (91.5625) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/37] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.3984 (0.4317) acc_x 90.6250 (89.5833) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/37] time 0.161 (0.176) data 0.084 (0.099) loss_x loss_x 0.6562 (0.4403) acc_x 78.1250 (88.9062) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/37] time 0.200 (0.174) data 0.124 (0.098) loss_x loss_x 0.5532 (0.4654) acc_x 81.2500 (88.1250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [30/37] time 0.186 (0.176) data 0.110 (0.100) loss_x loss_x 0.5039 (0.4956) acc_x 87.5000 (87.6042) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [35/37] time 0.163 (0.177) data 0.087 (0.100) loss_x loss_x 0.1927 (0.4669) acc_x 96.8750 (88.3929) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/12] time 0.180 (0.176) data 0.104 (0.100) loss_u loss_u 0.7417 (0.7404) acc_u 25.0000 (28.7500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/12] time 0.190 (0.177) data 0.112 (0.100) loss_u loss_u 0.8394 (0.7295) acc_u 18.7500 (30.6250) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 255
confident_label rate tensor(0.7481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1197
clean true:1196
clean false:1
clean_rate:0.9991645781119465
noisy true:149
noisy false:254
after delete: len(clean_dataset) 1197
after delete: len(noisy_dataset) 403
epoch [175/200] batch [5/37] time 0.174 (0.183) data 0.097 (0.106) loss_x loss_x 0.4121 (0.3927) acc_x 90.6250 (90.6250) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [10/37] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.3936 (0.4023) acc_x 93.7500 (89.6875) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/37] time 0.169 (0.174) data 0.092 (0.098) loss_x loss_x 0.6118 (0.4531) acc_x 78.1250 (88.1250) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/37] time 0.181 (0.175) data 0.103 (0.098) loss_x loss_x 0.7456 (0.4628) acc_x 84.3750 (87.9688) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/37] time 0.181 (0.175) data 0.105 (0.099) loss_x loss_x 0.6426 (0.4712) acc_x 84.3750 (87.7500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [30/37] time 0.163 (0.174) data 0.087 (0.097) loss_x loss_x 0.6074 (0.4574) acc_x 75.0000 (87.8125) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [35/37] time 0.180 (0.173) data 0.103 (0.096) loss_x loss_x 0.4006 (0.4542) acc_x 93.7500 (87.9464) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/12] time 0.170 (0.173) data 0.094 (0.097) loss_u loss_u 0.7188 (0.6992) acc_u 28.1250 (32.5000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [10/12] time 0.168 (0.173) data 0.091 (0.096) loss_u loss_u 0.7729 (0.6765) acc_u 28.1250 (35.3125) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 254
confident_label rate tensor(0.7494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1199
clean true:1199
clean false:0
clean_rate:1.0
noisy true:147
noisy false:254
after delete: len(clean_dataset) 1199
after delete: len(noisy_dataset) 401
epoch [176/200] batch [5/37] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.5151 (0.4079) acc_x 84.3750 (90.0000) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [10/37] time 0.190 (0.186) data 0.112 (0.109) loss_x loss_x 0.1943 (0.4063) acc_x 96.8750 (90.0000) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [15/37] time 0.190 (0.186) data 0.114 (0.110) loss_x loss_x 0.3450 (0.4128) acc_x 90.6250 (90.2083) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [20/37] time 0.192 (0.186) data 0.115 (0.109) loss_x loss_x 0.4307 (0.4198) acc_x 84.3750 (89.8438) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [25/37] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.5811 (0.3980) acc_x 87.5000 (90.6250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [30/37] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.5210 (0.4167) acc_x 84.3750 (90.1042) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [35/37] time 0.180 (0.185) data 0.104 (0.109) loss_x loss_x 0.3313 (0.4630) acc_x 96.8750 (89.3750) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/12] time 0.174 (0.183) data 0.097 (0.107) loss_u loss_u 0.6309 (0.6870) acc_u 40.6250 (35.0000) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [10/12] time 0.175 (0.182) data 0.097 (0.105) loss_u loss_u 0.7026 (0.6890) acc_u 40.6250 (35.9375) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 241
confident_label rate tensor(0.7519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1203
clean true:1203
clean false:0
clean_rate:1.0
noisy true:156
noisy false:241
after delete: len(clean_dataset) 1203
after delete: len(noisy_dataset) 397
epoch [177/200] batch [5/37] time 0.181 (0.187) data 0.106 (0.111) loss_x loss_x 0.1401 (0.2791) acc_x 93.7500 (93.7500) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [10/37] time 0.185 (0.181) data 0.109 (0.105) loss_x loss_x 0.4209 (0.3586) acc_x 87.5000 (90.3125) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/37] time 0.163 (0.177) data 0.087 (0.101) loss_x loss_x 0.4819 (0.3654) acc_x 84.3750 (90.2083) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/37] time 0.191 (0.177) data 0.114 (0.101) loss_x loss_x 0.6387 (0.3972) acc_x 81.2500 (89.6875) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [25/37] time 0.186 (0.179) data 0.109 (0.102) loss_x loss_x 0.3726 (0.4061) acc_x 93.7500 (89.7500) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [30/37] time 0.185 (0.180) data 0.109 (0.104) loss_x loss_x 0.3308 (0.4129) acc_x 90.6250 (89.6875) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [35/37] time 0.172 (0.180) data 0.096 (0.104) loss_x loss_x 0.7314 (0.4377) acc_x 78.1250 (88.7500) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/12] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.8135 (0.7358) acc_u 21.8750 (29.3750) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/12] time 0.171 (0.180) data 0.093 (0.104) loss_u loss_u 0.6245 (0.7109) acc_u 46.8750 (32.1875) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 244
confident_label rate tensor(0.7537, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1206
clean true:1206
clean false:0
clean_rate:1.0
noisy true:150
noisy false:244
after delete: len(clean_dataset) 1206
after delete: len(noisy_dataset) 394
epoch [178/200] batch [5/37] time 0.163 (0.170) data 0.087 (0.093) loss_x loss_x 0.4885 (0.3913) acc_x 90.6250 (90.0000) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [10/37] time 0.174 (0.170) data 0.096 (0.093) loss_x loss_x 0.4443 (0.4266) acc_x 90.6250 (89.6875) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/37] time 0.170 (0.169) data 0.093 (0.093) loss_x loss_x 0.2393 (0.4156) acc_x 96.8750 (89.5833) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/37] time 0.161 (0.169) data 0.085 (0.093) loss_x loss_x 0.4841 (0.4536) acc_x 87.5000 (88.9062) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/37] time 0.185 (0.171) data 0.109 (0.094) loss_x loss_x 0.4397 (0.4542) acc_x 90.6250 (88.1250) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [30/37] time 0.176 (0.172) data 0.099 (0.095) loss_x loss_x 0.4861 (0.4696) acc_x 90.6250 (88.0208) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [35/37] time 0.181 (0.173) data 0.104 (0.097) loss_x loss_x 0.9053 (0.4820) acc_x 75.0000 (87.5000) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/12] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.6968 (0.7097) acc_u 34.3750 (33.7500) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [10/12] time 0.187 (0.174) data 0.109 (0.098) loss_u loss_u 0.7026 (0.6946) acc_u 34.3750 (35.3125) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 242
confident_label rate tensor(0.7494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1199
clean true:1199
clean false:0
clean_rate:1.0
noisy true:159
noisy false:242
after delete: len(clean_dataset) 1199
after delete: len(noisy_dataset) 401
epoch [179/200] batch [5/37] time 0.190 (0.189) data 0.113 (0.112) loss_x loss_x 0.2495 (0.4414) acc_x 93.7500 (88.7500) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [10/37] time 0.178 (0.185) data 0.101 (0.108) loss_x loss_x 0.3638 (0.4516) acc_x 96.8750 (88.7500) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [15/37] time 0.162 (0.182) data 0.085 (0.105) loss_x loss_x 0.4429 (0.4553) acc_x 84.3750 (88.7500) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [20/37] time 0.176 (0.183) data 0.100 (0.106) loss_x loss_x 0.2595 (0.4614) acc_x 93.7500 (88.1250) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [25/37] time 0.171 (0.180) data 0.095 (0.104) loss_x loss_x 0.4568 (0.4565) acc_x 90.6250 (88.1250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [30/37] time 0.177 (0.179) data 0.101 (0.103) loss_x loss_x 0.5605 (0.4452) acc_x 87.5000 (88.5417) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [35/37] time 0.179 (0.180) data 0.101 (0.103) loss_x loss_x 0.3716 (0.4288) acc_x 90.6250 (88.9286) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/12] time 0.190 (0.181) data 0.113 (0.104) loss_u loss_u 0.6138 (0.6848) acc_u 40.6250 (34.3750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/12] time 0.174 (0.181) data 0.097 (0.104) loss_u loss_u 0.5596 (0.6692) acc_u 50.0000 (35.9375) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 266
confident_label rate tensor(0.7406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1185
clean true:1183
clean false:2
clean_rate:0.9983122362869198
noisy true:151
noisy false:264
after delete: len(clean_dataset) 1185
after delete: len(noisy_dataset) 415
epoch [180/200] batch [5/37] time 0.176 (0.180) data 0.100 (0.103) loss_x loss_x 0.7026 (0.4437) acc_x 81.2500 (87.5000) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [10/37] time 0.170 (0.179) data 0.094 (0.103) loss_x loss_x 0.2505 (0.4589) acc_x 93.7500 (88.4375) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/37] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.4668 (0.4349) acc_x 90.6250 (89.1667) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/37] time 0.173 (0.178) data 0.097 (0.101) loss_x loss_x 0.4929 (0.4686) acc_x 90.6250 (88.5938) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [25/37] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.2500 (0.4235) acc_x 90.6250 (89.7500) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [30/37] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.4153 (0.4219) acc_x 87.5000 (89.5833) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [35/37] time 0.165 (0.177) data 0.088 (0.100) loss_x loss_x 0.4678 (0.4249) acc_x 87.5000 (89.2857) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/12] time 0.193 (0.179) data 0.117 (0.102) loss_u loss_u 0.6064 (0.6745) acc_u 43.7500 (37.5000) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/12] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.6543 (0.6535) acc_u 43.7500 (39.6875) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 245
confident_label rate tensor(0.7506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1201
clean true:1200
clean false:1
clean_rate:0.9991673605328892
noisy true:155
noisy false:244
after delete: len(clean_dataset) 1201
after delete: len(noisy_dataset) 399
epoch [181/200] batch [5/37] time 0.184 (0.181) data 0.108 (0.104) loss_x loss_x 0.3127 (0.3387) acc_x 93.7500 (91.8750) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [10/37] time 0.165 (0.176) data 0.089 (0.099) loss_x loss_x 0.7046 (0.4246) acc_x 84.3750 (89.0625) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/37] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.2625 (0.4157) acc_x 93.7500 (89.5833) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/37] time 0.169 (0.179) data 0.093 (0.102) loss_x loss_x 0.7236 (0.4929) acc_x 75.0000 (87.3438) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [25/37] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.2551 (0.4767) acc_x 96.8750 (87.5000) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [30/37] time 0.193 (0.181) data 0.117 (0.104) loss_x loss_x 0.5967 (0.4826) acc_x 87.5000 (87.0833) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [35/37] time 0.185 (0.181) data 0.109 (0.105) loss_x loss_x 0.3137 (0.4610) acc_x 87.5000 (87.6786) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/12] time 0.174 (0.181) data 0.094 (0.104) loss_u loss_u 0.7368 (0.7059) acc_u 28.1250 (31.8750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [10/12] time 0.172 (0.180) data 0.094 (0.104) loss_u loss_u 0.6533 (0.7312) acc_u 37.5000 (30.6250) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 248
confident_label rate tensor(0.7494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1199
clean true:1198
clean false:1
clean_rate:0.9991659716430359
noisy true:154
noisy false:247
after delete: len(clean_dataset) 1199
after delete: len(noisy_dataset) 401
epoch [182/200] batch [5/37] time 0.171 (0.182) data 0.095 (0.106) loss_x loss_x 0.7144 (0.4570) acc_x 75.0000 (86.8750) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [10/37] time 0.190 (0.182) data 0.114 (0.106) loss_x loss_x 0.3530 (0.5024) acc_x 87.5000 (85.9375) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/37] time 0.186 (0.183) data 0.109 (0.107) loss_x loss_x 0.6064 (0.4734) acc_x 84.3750 (86.8750) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [20/37] time 0.213 (0.190) data 0.136 (0.114) loss_x loss_x 0.2473 (0.4389) acc_x 96.8750 (88.2812) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [25/37] time 0.208 (0.194) data 0.130 (0.118) loss_x loss_x 0.3906 (0.4226) acc_x 93.7500 (89.0000) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [30/37] time 0.210 (0.196) data 0.133 (0.120) loss_x loss_x 0.2852 (0.4208) acc_x 93.7500 (88.8542) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [35/37] time 0.181 (0.195) data 0.104 (0.118) loss_x loss_x 0.2256 (0.4151) acc_x 90.6250 (89.0179) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/12] time 0.171 (0.192) data 0.094 (0.115) loss_u loss_u 0.9072 (0.7055) acc_u 9.3750 (33.1250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/12] time 0.168 (0.191) data 0.092 (0.114) loss_u loss_u 0.6748 (0.6884) acc_u 40.6250 (35.6250) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 250
confident_label rate tensor(0.7512, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1202
clean true:1202
clean false:0
clean_rate:1.0
noisy true:148
noisy false:250
after delete: len(clean_dataset) 1202
after delete: len(noisy_dataset) 398
epoch [183/200] batch [5/37] time 0.177 (0.185) data 0.100 (0.108) loss_x loss_x 0.2139 (0.3427) acc_x 96.8750 (91.8750) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [10/37] time 0.176 (0.176) data 0.098 (0.099) loss_x loss_x 0.4177 (0.3761) acc_x 90.6250 (90.3125) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/37] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 0.2356 (0.4079) acc_x 90.6250 (89.5833) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [20/37] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.5137 (0.4146) acc_x 90.6250 (88.9062) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [25/37] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.3472 (0.4155) acc_x 90.6250 (89.0000) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [30/37] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.3667 (0.4186) acc_x 90.6250 (89.0625) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [35/37] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.3542 (0.4300) acc_x 87.5000 (88.8393) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/12] time 0.189 (0.181) data 0.112 (0.103) loss_u loss_u 0.6782 (0.6923) acc_u 34.3750 (35.0000) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/12] time 0.191 (0.181) data 0.114 (0.104) loss_u loss_u 0.6748 (0.6688) acc_u 40.6250 (37.8125) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 261
confident_label rate tensor(0.7456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1193
clean true:1192
clean false:1
clean_rate:0.9991617770326907
noisy true:147
noisy false:260
after delete: len(clean_dataset) 1193
after delete: len(noisy_dataset) 407
epoch [184/200] batch [5/37] time 0.172 (0.182) data 0.096 (0.105) loss_x loss_x 0.8608 (0.5259) acc_x 81.2500 (88.7500) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [10/37] time 0.176 (0.176) data 0.099 (0.099) loss_x loss_x 0.8906 (0.4902) acc_x 81.2500 (88.7500) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/37] time 0.163 (0.175) data 0.087 (0.098) loss_x loss_x 0.2224 (0.4571) acc_x 96.8750 (88.7500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [20/37] time 0.171 (0.176) data 0.095 (0.099) loss_x loss_x 0.3381 (0.4579) acc_x 87.5000 (88.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/37] time 0.191 (0.176) data 0.115 (0.099) loss_x loss_x 0.9238 (0.4828) acc_x 78.1250 (87.5000) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [30/37] time 0.174 (0.176) data 0.097 (0.099) loss_x loss_x 0.7280 (0.4901) acc_x 81.2500 (87.6042) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [35/37] time 0.174 (0.175) data 0.098 (0.099) loss_x loss_x 0.2013 (0.4727) acc_x 93.7500 (87.9464) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/12] time 0.188 (0.176) data 0.112 (0.099) loss_u loss_u 0.6792 (0.6761) acc_u 31.2500 (36.8750) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [10/12] time 0.164 (0.176) data 0.087 (0.099) loss_u loss_u 0.6895 (0.6716) acc_u 34.3750 (37.5000) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 254
confident_label rate tensor(0.7462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1194
clean true:1194
clean false:0
clean_rate:1.0
noisy true:152
noisy false:254
after delete: len(clean_dataset) 1194
after delete: len(noisy_dataset) 406
epoch [185/200] batch [5/37] time 0.178 (0.184) data 0.101 (0.107) loss_x loss_x 0.4258 (0.4627) acc_x 90.6250 (88.1250) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [10/37] time 0.164 (0.179) data 0.087 (0.103) loss_x loss_x 0.3298 (0.4282) acc_x 84.3750 (88.1250) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/37] time 0.204 (0.183) data 0.127 (0.107) loss_x loss_x 0.3005 (0.4691) acc_x 87.5000 (87.0833) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [20/37] time 0.167 (0.184) data 0.090 (0.108) loss_x loss_x 0.3721 (0.4476) acc_x 96.8750 (87.8125) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [25/37] time 0.161 (0.181) data 0.084 (0.104) loss_x loss_x 0.3623 (0.4708) acc_x 90.6250 (87.6250) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [30/37] time 0.169 (0.178) data 0.092 (0.101) loss_x loss_x 0.5884 (0.4763) acc_x 84.3750 (87.2917) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [35/37] time 0.167 (0.177) data 0.089 (0.100) loss_x loss_x 0.3467 (0.4768) acc_x 87.5000 (87.0536) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/12] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.6743 (0.6952) acc_u 40.6250 (36.2500) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/12] time 0.174 (0.177) data 0.094 (0.100) loss_u loss_u 0.5459 (0.6784) acc_u 46.8750 (37.5000) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 250
confident_label rate tensor(0.7462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1194
clean true:1194
clean false:0
clean_rate:1.0
noisy true:156
noisy false:250
after delete: len(clean_dataset) 1194
after delete: len(noisy_dataset) 406
epoch [186/200] batch [5/37] time 0.169 (0.170) data 0.093 (0.093) loss_x loss_x 0.4832 (0.4050) acc_x 81.2500 (88.7500) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [10/37] time 0.186 (0.171) data 0.109 (0.094) loss_x loss_x 0.3262 (0.4209) acc_x 93.7500 (89.0625) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/37] time 0.165 (0.170) data 0.088 (0.093) loss_x loss_x 0.3152 (0.4280) acc_x 96.8750 (89.1667) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [20/37] time 0.171 (0.170) data 0.095 (0.093) loss_x loss_x 0.4990 (0.4421) acc_x 87.5000 (88.4375) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/37] time 0.194 (0.171) data 0.118 (0.095) loss_x loss_x 0.7231 (0.4639) acc_x 81.2500 (87.6250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [30/37] time 0.194 (0.175) data 0.118 (0.098) loss_x loss_x 0.1198 (0.4628) acc_x 100.0000 (88.0208) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [35/37] time 0.182 (0.176) data 0.107 (0.100) loss_x loss_x 0.5518 (0.4673) acc_x 81.2500 (87.6786) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/12] time 0.193 (0.178) data 0.114 (0.101) loss_u loss_u 0.7158 (0.6900) acc_u 28.1250 (33.7500) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [10/12] time 0.179 (0.178) data 0.100 (0.102) loss_u loss_u 0.7241 (0.7073) acc_u 31.2500 (32.1875) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 248
confident_label rate tensor(0.7500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1200
clean true:1198
clean false:2
clean_rate:0.9983333333333333
noisy true:154
noisy false:246
after delete: len(clean_dataset) 1200
after delete: len(noisy_dataset) 400
epoch [187/200] batch [5/37] time 0.173 (0.174) data 0.097 (0.098) loss_x loss_x 0.4595 (0.4044) acc_x 84.3750 (89.3750) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [10/37] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 0.2932 (0.4288) acc_x 90.6250 (88.4375) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/37] time 0.168 (0.171) data 0.092 (0.095) loss_x loss_x 0.3623 (0.4297) acc_x 87.5000 (88.7500) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/37] time 0.177 (0.172) data 0.101 (0.095) loss_x loss_x 0.3313 (0.4206) acc_x 90.6250 (89.2188) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/37] time 0.177 (0.173) data 0.101 (0.097) loss_x loss_x 0.5327 (0.4167) acc_x 75.0000 (88.6250) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [30/37] time 0.178 (0.174) data 0.099 (0.098) loss_x loss_x 1.1113 (0.4554) acc_x 78.1250 (88.3333) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [35/37] time 0.182 (0.175) data 0.106 (0.098) loss_x loss_x 0.3955 (0.4625) acc_x 84.3750 (88.2143) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/12] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.8105 (0.7322) acc_u 21.8750 (31.8750) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [10/12] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.8193 (0.6997) acc_u 21.8750 (34.6875) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 245
confident_label rate tensor(0.7469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1195
clean true:1195
clean false:0
clean_rate:1.0
noisy true:160
noisy false:245
after delete: len(clean_dataset) 1195
after delete: len(noisy_dataset) 405
epoch [188/200] batch [5/37] time 0.159 (0.177) data 0.083 (0.100) loss_x loss_x 0.5869 (0.4780) acc_x 81.2500 (85.6250) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [10/37] time 0.162 (0.176) data 0.086 (0.100) loss_x loss_x 0.5874 (0.4106) acc_x 87.5000 (89.3750) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/37] time 0.174 (0.174) data 0.098 (0.098) loss_x loss_x 0.4487 (0.4512) acc_x 87.5000 (88.3333) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/37] time 0.177 (0.174) data 0.100 (0.097) loss_x loss_x 0.9780 (0.5171) acc_x 81.2500 (86.7188) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/37] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.8301 (0.4994) acc_x 81.2500 (87.5000) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [30/37] time 0.180 (0.175) data 0.104 (0.098) loss_x loss_x 0.3469 (0.4772) acc_x 90.6250 (87.8125) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [35/37] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.4126 (0.4518) acc_x 87.5000 (88.4821) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/12] time 0.190 (0.176) data 0.114 (0.100) loss_u loss_u 0.5747 (0.6455) acc_u 43.7500 (39.3750) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/12] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.7192 (0.6871) acc_u 37.5000 (35.9375) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 250
confident_label rate tensor(0.7494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1199
clean true:1198
clean false:1
clean_rate:0.9991659716430359
noisy true:152
noisy false:249
after delete: len(clean_dataset) 1199
after delete: len(noisy_dataset) 401
epoch [189/200] batch [5/37] time 0.169 (0.175) data 0.093 (0.099) loss_x loss_x 0.2378 (0.4929) acc_x 90.6250 (88.7500) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [10/37] time 0.162 (0.168) data 0.086 (0.092) loss_x loss_x 0.2092 (0.4761) acc_x 96.8750 (88.7500) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/37] time 0.170 (0.167) data 0.093 (0.091) loss_x loss_x 0.1428 (0.4620) acc_x 96.8750 (88.5417) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/37] time 0.181 (0.169) data 0.103 (0.093) loss_x loss_x 0.3481 (0.4903) acc_x 87.5000 (87.5000) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/37] time 0.169 (0.169) data 0.093 (0.093) loss_x loss_x 0.3479 (0.4666) acc_x 90.6250 (87.7500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [30/37] time 0.169 (0.169) data 0.093 (0.093) loss_x loss_x 0.2346 (0.4335) acc_x 96.8750 (88.8542) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [35/37] time 0.190 (0.171) data 0.112 (0.094) loss_x loss_x 0.2319 (0.4374) acc_x 93.7500 (88.8393) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/12] time 0.194 (0.174) data 0.117 (0.097) loss_u loss_u 0.6943 (0.6768) acc_u 37.5000 (36.8750) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/12] time 0.215 (0.174) data 0.137 (0.098) loss_u loss_u 0.6333 (0.6719) acc_u 37.5000 (36.5625) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 230
confident_label rate tensor(0.7581, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1213
clean true:1213
clean false:0
clean_rate:1.0
noisy true:157
noisy false:230
after delete: len(clean_dataset) 1213
after delete: len(noisy_dataset) 387
epoch [190/200] batch [5/37] time 0.184 (0.189) data 0.107 (0.113) loss_x loss_x 0.5742 (0.4808) acc_x 84.3750 (87.5000) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [10/37] time 0.187 (0.188) data 0.111 (0.112) loss_x loss_x 0.4375 (0.4686) acc_x 87.5000 (87.1875) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [15/37] time 0.183 (0.187) data 0.107 (0.111) loss_x loss_x 0.3240 (0.4756) acc_x 90.6250 (88.1250) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [20/37] time 0.182 (0.186) data 0.104 (0.110) loss_x loss_x 0.2444 (0.4644) acc_x 93.7500 (88.1250) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [25/37] time 0.162 (0.184) data 0.086 (0.108) loss_x loss_x 0.1333 (0.4481) acc_x 100.0000 (88.3750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [30/37] time 0.173 (0.181) data 0.097 (0.105) loss_x loss_x 0.5527 (0.4425) acc_x 84.3750 (88.4375) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [35/37] time 0.186 (0.181) data 0.109 (0.105) loss_x loss_x 0.3652 (0.4470) acc_x 87.5000 (88.5714) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/12] time 0.164 (0.181) data 0.086 (0.105) loss_u loss_u 0.7979 (0.7235) acc_u 21.8750 (30.0000) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/12] time 0.193 (0.180) data 0.115 (0.104) loss_u loss_u 0.6807 (0.7442) acc_u 34.3750 (27.5000) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 256
confident_label rate tensor(0.7469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1195
clean true:1193
clean false:2
clean_rate:0.998326359832636
noisy true:151
noisy false:254
after delete: len(clean_dataset) 1195
after delete: len(noisy_dataset) 405
epoch [191/200] batch [5/37] time 0.184 (0.182) data 0.108 (0.105) loss_x loss_x 0.4614 (0.4365) acc_x 90.6250 (88.7500) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [10/37] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 0.4639 (0.4610) acc_x 90.6250 (88.1250) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/37] time 0.157 (0.182) data 0.080 (0.106) loss_x loss_x 0.7505 (0.4538) acc_x 81.2500 (88.5417) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [20/37] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.7168 (0.4837) acc_x 68.7500 (86.7188) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [25/37] time 0.185 (0.180) data 0.109 (0.104) loss_x loss_x 0.3037 (0.4715) acc_x 96.8750 (87.6250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [30/37] time 0.193 (0.181) data 0.116 (0.104) loss_x loss_x 0.5811 (0.4785) acc_x 87.5000 (87.5000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [35/37] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 0.3645 (0.4756) acc_x 87.5000 (87.6786) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/12] time 0.162 (0.178) data 0.084 (0.101) loss_u loss_u 0.5996 (0.6847) acc_u 46.8750 (35.6250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/12] time 0.174 (0.178) data 0.097 (0.101) loss_u loss_u 0.6489 (0.6737) acc_u 40.6250 (37.8125) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 238
confident_label rate tensor(0.7537, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1206
clean true:1205
clean false:1
clean_rate:0.9991708126036484
noisy true:157
noisy false:237
after delete: len(clean_dataset) 1206
after delete: len(noisy_dataset) 394
epoch [192/200] batch [5/37] time 0.188 (0.187) data 0.112 (0.111) loss_x loss_x 0.2002 (0.4078) acc_x 96.8750 (91.2500) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [10/37] time 0.184 (0.187) data 0.108 (0.110) loss_x loss_x 0.7783 (0.4350) acc_x 81.2500 (90.3125) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [15/37] time 0.180 (0.185) data 0.102 (0.108) loss_x loss_x 0.6260 (0.4212) acc_x 84.3750 (90.0000) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [20/37] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.8779 (0.4321) acc_x 75.0000 (88.7500) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [25/37] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.8052 (0.4450) acc_x 87.5000 (88.6250) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [30/37] time 0.163 (0.183) data 0.087 (0.107) loss_x loss_x 0.4482 (0.4612) acc_x 87.5000 (88.1250) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [35/37] time 0.192 (0.182) data 0.115 (0.106) loss_x loss_x 0.3467 (0.4625) acc_x 93.7500 (87.9464) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/12] time 0.178 (0.182) data 0.101 (0.106) loss_u loss_u 0.6787 (0.6726) acc_u 34.3750 (36.2500) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [10/12] time 0.167 (0.181) data 0.091 (0.104) loss_u loss_u 0.7153 (0.7177) acc_u 34.3750 (32.5000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 251
confident_label rate tensor(0.7431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1189
clean true:1189
clean false:0
clean_rate:1.0
noisy true:160
noisy false:251
after delete: len(clean_dataset) 1189
after delete: len(noisy_dataset) 411
epoch [193/200] batch [5/37] time 0.176 (0.169) data 0.100 (0.092) loss_x loss_x 0.2598 (0.4460) acc_x 90.6250 (87.5000) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [10/37] time 0.178 (0.172) data 0.102 (0.096) loss_x loss_x 0.3325 (0.4056) acc_x 90.6250 (88.7500) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [15/37] time 0.183 (0.172) data 0.106 (0.095) loss_x loss_x 0.7334 (0.4523) acc_x 75.0000 (87.5000) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/37] time 0.160 (0.170) data 0.084 (0.094) loss_x loss_x 0.3599 (0.4769) acc_x 87.5000 (86.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/37] time 0.188 (0.173) data 0.111 (0.097) loss_x loss_x 0.3401 (0.4735) acc_x 90.6250 (86.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [30/37] time 0.167 (0.174) data 0.090 (0.098) loss_x loss_x 0.0675 (0.4663) acc_x 100.0000 (87.1875) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [35/37] time 0.184 (0.176) data 0.108 (0.099) loss_x loss_x 0.2856 (0.4593) acc_x 96.8750 (87.6786) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/12] time 0.167 (0.176) data 0.091 (0.100) loss_u loss_u 0.7388 (0.6681) acc_u 34.3750 (37.5000) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/12] time 0.188 (0.176) data 0.112 (0.100) loss_u loss_u 0.6426 (0.6792) acc_u 40.6250 (36.8750) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 269
confident_label rate tensor(0.7425, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1188
clean true:1186
clean false:2
clean_rate:0.9983164983164983
noisy true:145
noisy false:267
after delete: len(clean_dataset) 1188
after delete: len(noisy_dataset) 412
epoch [194/200] batch [5/37] time 0.179 (0.186) data 0.103 (0.110) loss_x loss_x 0.5298 (0.4254) acc_x 84.3750 (85.6250) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [10/37] time 0.180 (0.185) data 0.102 (0.108) loss_x loss_x 0.4014 (0.4314) acc_x 87.5000 (88.1250) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/37] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.4072 (0.4394) acc_x 90.6250 (87.9167) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [20/37] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.1713 (0.4281) acc_x 93.7500 (88.9062) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [25/37] time 0.162 (0.180) data 0.085 (0.104) loss_x loss_x 0.3484 (0.4186) acc_x 87.5000 (88.3750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [30/37] time 0.164 (0.177) data 0.088 (0.101) loss_x loss_x 0.4871 (0.4345) acc_x 84.3750 (88.0208) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [35/37] time 0.186 (0.179) data 0.110 (0.102) loss_x loss_x 0.5229 (0.4425) acc_x 87.5000 (88.3036) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/12] time 0.193 (0.180) data 0.116 (0.104) loss_u loss_u 0.5923 (0.6510) acc_u 46.8750 (39.3750) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/12] time 0.175 (0.180) data 0.098 (0.103) loss_u loss_u 0.6323 (0.6694) acc_u 40.6250 (37.1875) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 256
confident_label rate tensor(0.7469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1195
clean true:1193
clean false:2
clean_rate:0.998326359832636
noisy true:151
noisy false:254
after delete: len(clean_dataset) 1195
after delete: len(noisy_dataset) 405
epoch [195/200] batch [5/37] time 0.177 (0.170) data 0.100 (0.093) loss_x loss_x 0.4360 (0.3978) acc_x 84.3750 (88.7500) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [10/37] time 0.171 (0.171) data 0.094 (0.095) loss_x loss_x 0.2578 (0.5071) acc_x 93.7500 (85.0000) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/37] time 0.169 (0.170) data 0.093 (0.093) loss_x loss_x 0.3096 (0.4562) acc_x 84.3750 (85.8333) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/37] time 0.165 (0.169) data 0.088 (0.092) loss_x loss_x 0.3704 (0.4596) acc_x 90.6250 (87.0312) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/37] time 0.179 (0.170) data 0.101 (0.093) loss_x loss_x 0.1528 (0.4540) acc_x 96.8750 (86.8750) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [30/37] time 0.167 (0.170) data 0.091 (0.094) loss_x loss_x 0.4814 (0.4768) acc_x 81.2500 (86.1458) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [35/37] time 0.174 (0.170) data 0.098 (0.094) loss_x loss_x 0.4788 (0.4635) acc_x 90.6250 (86.7857) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/12] time 0.177 (0.171) data 0.099 (0.094) loss_u loss_u 0.6860 (0.7172) acc_u 31.2500 (30.0000) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/12] time 0.175 (0.171) data 0.098 (0.094) loss_u loss_u 0.6143 (0.6932) acc_u 43.7500 (32.5000) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 256
confident_label rate tensor(0.7500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1200
clean true:1199
clean false:1
clean_rate:0.9991666666666666
noisy true:145
noisy false:255
after delete: len(clean_dataset) 1200
after delete: len(noisy_dataset) 400
epoch [196/200] batch [5/37] time 0.173 (0.180) data 0.097 (0.103) loss_x loss_x 0.3081 (0.4864) acc_x 90.6250 (88.1250) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [10/37] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.4734 (0.4794) acc_x 90.6250 (87.5000) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/37] time 0.171 (0.179) data 0.095 (0.102) loss_x loss_x 0.5923 (0.5193) acc_x 87.5000 (86.8750) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/37] time 0.167 (0.177) data 0.090 (0.100) loss_x loss_x 0.7812 (0.5155) acc_x 75.0000 (86.8750) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [25/37] time 0.164 (0.174) data 0.088 (0.098) loss_x loss_x 0.4316 (0.4943) acc_x 87.5000 (87.1250) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [30/37] time 0.163 (0.173) data 0.086 (0.096) loss_x loss_x 0.3533 (0.4871) acc_x 90.6250 (87.3958) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [35/37] time 0.175 (0.172) data 0.098 (0.095) loss_x loss_x 0.3320 (0.4736) acc_x 90.6250 (87.6786) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/12] time 0.188 (0.173) data 0.111 (0.097) loss_u loss_u 0.6299 (0.7122) acc_u 40.6250 (31.8750) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/12] time 0.175 (0.173) data 0.098 (0.096) loss_u loss_u 0.7212 (0.6862) acc_u 34.3750 (35.3125) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 231
confident_label rate tensor(0.7594, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1215
clean true:1213
clean false:2
clean_rate:0.9983539094650206
noisy true:156
noisy false:229
after delete: len(clean_dataset) 1215
after delete: len(noisy_dataset) 385
epoch [197/200] batch [5/37] time 0.169 (0.182) data 0.093 (0.106) loss_x loss_x 0.3169 (0.3104) acc_x 90.6250 (92.5000) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [10/37] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.3069 (0.4004) acc_x 93.7500 (90.6250) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [15/37] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.4097 (0.3934) acc_x 87.5000 (90.8333) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/37] time 0.224 (0.179) data 0.148 (0.103) loss_x loss_x 0.4719 (0.3830) acc_x 84.3750 (90.7812) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [25/37] time 0.169 (0.178) data 0.090 (0.101) loss_x loss_x 0.4685 (0.4020) acc_x 87.5000 (90.6250) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [30/37] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.3911 (0.4324) acc_x 93.7500 (89.4792) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [35/37] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.4812 (0.4309) acc_x 84.3750 (89.2857) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/12] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.7075 (0.6398) acc_u 31.2500 (40.6250) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [10/12] time 0.167 (0.181) data 0.089 (0.105) loss_u loss_u 0.6064 (0.6857) acc_u 43.7500 (35.3125) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 226
confident_label rate tensor(0.7619, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1219
clean true:1218
clean false:1
clean_rate:0.9991796554552912
noisy true:156
noisy false:225
after delete: len(clean_dataset) 1219
after delete: len(noisy_dataset) 381
epoch [198/200] batch [5/38] time 0.169 (0.189) data 0.091 (0.112) loss_x loss_x 0.6416 (0.5152) acc_x 87.5000 (87.5000) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [10/38] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.2335 (0.4974) acc_x 93.7500 (87.5000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/38] time 0.207 (0.179) data 0.131 (0.102) loss_x loss_x 0.8926 (0.4556) acc_x 84.3750 (88.5417) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [20/38] time 0.174 (0.178) data 0.098 (0.101) loss_x loss_x 0.2266 (0.4443) acc_x 96.8750 (88.9062) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [25/38] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.3093 (0.4398) acc_x 93.7500 (89.1250) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [30/38] time 0.190 (0.179) data 0.114 (0.102) loss_x loss_x 0.7227 (0.4663) acc_x 81.2500 (88.3333) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [35/38] time 0.184 (0.179) data 0.108 (0.103) loss_x loss_x 0.3452 (0.4494) acc_x 87.5000 (88.7500) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/11] time 0.171 (0.180) data 0.093 (0.103) loss_u loss_u 0.7285 (0.7013) acc_u 25.0000 (32.5000) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/11] time 0.168 (0.179) data 0.091 (0.102) loss_u loss_u 0.7344 (0.7045) acc_u 28.1250 (31.8750) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 226
confident_label rate tensor(0.7625, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1220
clean true:1218
clean false:2
clean_rate:0.9983606557377049
noisy true:156
noisy false:224
after delete: len(clean_dataset) 1220
after delete: len(noisy_dataset) 380
epoch [199/200] batch [5/38] time 0.181 (0.188) data 0.104 (0.111) loss_x loss_x 0.3960 (0.4663) acc_x 87.5000 (86.8750) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [10/38] time 0.194 (0.188) data 0.117 (0.111) loss_x loss_x 0.6099 (0.4827) acc_x 78.1250 (85.6250) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [15/38] time 0.165 (0.187) data 0.089 (0.110) loss_x loss_x 0.5986 (0.4846) acc_x 90.6250 (86.8750) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [20/38] time 0.169 (0.181) data 0.091 (0.104) loss_x loss_x 0.5537 (0.5226) acc_x 84.3750 (85.6250) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [25/38] time 0.167 (0.178) data 0.089 (0.101) loss_x loss_x 0.3696 (0.5335) acc_x 87.5000 (85.5000) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [30/38] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.4714 (0.5247) acc_x 93.7500 (86.1458) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [35/38] time 0.168 (0.176) data 0.090 (0.099) loss_x loss_x 0.7373 (0.5177) acc_x 81.2500 (86.3393) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/11] time 0.171 (0.175) data 0.093 (0.098) loss_u loss_u 0.8218 (0.7172) acc_u 21.8750 (34.3750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/11] time 0.175 (0.175) data 0.099 (0.098) loss_u loss_u 0.7344 (0.6858) acc_u 28.1250 (36.2500) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 249
confident_label rate tensor(0.7481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1197
clean true:1197
clean false:0
clean_rate:1.0
noisy true:154
noisy false:249
after delete: len(clean_dataset) 1197
after delete: len(noisy_dataset) 403
epoch [200/200] batch [5/37] time 0.189 (0.189) data 0.112 (0.112) loss_x loss_x 0.3823 (0.4631) acc_x 87.5000 (88.7500) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [10/37] time 0.179 (0.184) data 0.103 (0.107) loss_x loss_x 0.5283 (0.5851) acc_x 90.6250 (86.2500) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/37] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.6465 (0.5556) acc_x 84.3750 (86.8750) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [20/37] time 0.163 (0.181) data 0.087 (0.104) loss_x loss_x 0.3811 (0.5264) acc_x 90.6250 (87.1875) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [25/37] time 0.193 (0.178) data 0.117 (0.102) loss_x loss_x 0.7456 (0.5074) acc_x 78.1250 (87.1250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [30/37] time 0.159 (0.177) data 0.083 (0.100) loss_x loss_x 0.3276 (0.5061) acc_x 90.6250 (86.6667) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [35/37] time 0.160 (0.175) data 0.084 (0.098) loss_x loss_x 0.3723 (0.5046) acc_x 84.3750 (86.3393) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/12] time 0.224 (0.175) data 0.143 (0.098) loss_u loss_u 0.7690 (0.7151) acc_u 28.1250 (31.8750) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/12] time 0.188 (0.177) data 0.109 (0.100) loss_u loss_u 0.7568 (0.7179) acc_u 28.1250 (31.8750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,239
* accuracy: 90.8%
* error: 9.2%
* macro_f1: 87.2%
Elapsed: 0:58:00
