***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '100']
output_dir: output/caltech101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/caltech101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/caltech101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 845
confident_label rate tensor(0.2944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 471
clean true:469
clean false:2
clean_rate:0.9957537154989384
noisy true:286
noisy false:843
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1129
epoch [1/200] batch [5/14] time 0.189 (0.213) data 0.113 (0.119) loss_x loss_x 2.7363 (2.6562) acc_x 71.8750 (66.2500) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/14] time 0.211 (0.205) data 0.135 (0.119) loss_x loss_x 1.9951 (2.5335) acc_x 71.8750 (64.0625) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/35] time 0.197 (0.201) data 0.120 (0.119) loss_u loss_u 0.9590 (0.9499) acc_u 15.6250 (16.8750) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [10/35] time 0.201 (0.200) data 0.123 (0.118) loss_u loss_u 0.9019 (0.9340) acc_u 21.8750 (17.5000) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [15/35] time 0.197 (0.199) data 0.120 (0.118) loss_u loss_u 0.9082 (0.9316) acc_u 18.7500 (16.4583) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [20/35] time 0.197 (0.198) data 0.120 (0.118) loss_u loss_u 0.9478 (0.9301) acc_u 9.3750 (15.7812) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [25/35] time 0.210 (0.199) data 0.133 (0.119) loss_u loss_u 0.7969 (0.9187) acc_u 37.5000 (17.6250) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [30/35] time 0.193 (0.199) data 0.116 (0.119) loss_u loss_u 0.8931 (0.9135) acc_u 18.7500 (18.1250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [35/35] time 0.199 (0.198) data 0.122 (0.119) loss_u loss_u 0.8335 (0.9121) acc_u 28.1250 (18.5714) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 648
confident_label rate tensor(0.3794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 607
clean true:605
clean false:2
clean_rate:0.9967051070840197
noisy true:347
noisy false:646
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 993
epoch [2/200] batch [5/18] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 1.0273 (1.0486) acc_x 75.0000 (78.7500) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [10/18] time 0.185 (0.185) data 0.108 (0.109) loss_x loss_x 1.0820 (0.9481) acc_x 62.5000 (76.8750) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [15/18] time 0.181 (0.188) data 0.105 (0.112) loss_x loss_x 0.5811 (0.9602) acc_x 84.3750 (76.0417) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/31] time 0.182 (0.188) data 0.105 (0.111) loss_u loss_u 0.8203 (0.8568) acc_u 21.8750 (17.5000) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [10/31] time 0.179 (0.187) data 0.102 (0.110) loss_u loss_u 0.8574 (0.8750) acc_u 18.7500 (14.6875) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [15/31] time 0.186 (0.188) data 0.109 (0.111) loss_u loss_u 0.8555 (0.8448) acc_u 18.7500 (18.7500) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [20/31] time 0.185 (0.188) data 0.108 (0.111) loss_u loss_u 0.8472 (0.8284) acc_u 18.7500 (21.2500) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [25/31] time 0.177 (0.188) data 0.100 (0.112) loss_u loss_u 0.8535 (0.8310) acc_u 18.7500 (20.6250) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [30/31] time 0.190 (0.188) data 0.113 (0.111) loss_u loss_u 0.9238 (0.8280) acc_u 6.2500 (20.6250) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 463
confident_label rate tensor(0.4456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 713
clean true:711
clean false:2
clean_rate:0.9971949509116409
noisy true:426
noisy false:461
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 887
epoch [3/200] batch [5/22] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.8022 (0.8049) acc_x 75.0000 (78.7500) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [10/22] time 0.223 (0.187) data 0.147 (0.111) loss_x loss_x 0.8555 (0.7210) acc_x 78.1250 (80.6250) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [15/22] time 0.182 (0.188) data 0.106 (0.111) loss_x loss_x 0.7808 (0.7670) acc_x 81.2500 (80.4167) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [20/22] time 0.193 (0.187) data 0.117 (0.111) loss_x loss_x 0.6035 (0.7905) acc_x 87.5000 (79.6875) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/27] time 0.183 (0.187) data 0.106 (0.110) loss_u loss_u 0.8784 (0.8353) acc_u 15.6250 (18.7500) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/27] time 0.182 (0.186) data 0.105 (0.110) loss_u loss_u 0.7866 (0.8596) acc_u 21.8750 (15.6250) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/27] time 0.195 (0.188) data 0.118 (0.111) loss_u loss_u 0.8066 (0.8585) acc_u 21.8750 (16.0417) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/27] time 0.182 (0.188) data 0.105 (0.112) loss_u loss_u 0.8862 (0.8567) acc_u 12.5000 (16.0938) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [25/27] time 0.178 (0.187) data 0.102 (0.111) loss_u loss_u 0.9565 (0.8610) acc_u 6.2500 (15.7500) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.4694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 751
clean true:747
clean false:4
clean_rate:0.9946737683089214
noisy true:410
noisy false:439
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 849
epoch [4/200] batch [5/23] time 0.187 (0.183) data 0.110 (0.107) loss_x loss_x 0.3586 (0.8273) acc_x 93.7500 (82.5000) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [10/23] time 0.170 (0.182) data 0.093 (0.105) loss_x loss_x 0.4243 (0.7832) acc_x 87.5000 (80.9375) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/23] time 0.172 (0.182) data 0.097 (0.106) loss_x loss_x 1.3350 (0.8674) acc_x 68.7500 (78.5417) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [20/23] time 0.179 (0.183) data 0.103 (0.107) loss_x loss_x 0.8833 (0.8364) acc_x 71.8750 (78.4375) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/26] time 0.180 (0.186) data 0.104 (0.110) loss_u loss_u 0.9702 (0.9345) acc_u 6.2500 (8.7500) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [10/26] time 0.185 (0.186) data 0.109 (0.110) loss_u loss_u 0.8472 (0.9080) acc_u 15.6250 (11.2500) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/26] time 0.229 (0.187) data 0.153 (0.111) loss_u loss_u 0.9648 (0.8975) acc_u 3.1250 (12.0833) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/26] time 0.185 (0.188) data 0.109 (0.112) loss_u loss_u 0.9453 (0.8931) acc_u 6.2500 (12.6562) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [25/26] time 0.185 (0.187) data 0.108 (0.111) loss_u loss_u 0.8579 (0.8867) acc_u 12.5000 (13.1250) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 483
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 709
clean true:707
clean false:2
clean_rate:0.997179125528914
noisy true:410
noisy false:481
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 891
epoch [5/200] batch [5/22] time 0.187 (0.174) data 0.111 (0.098) loss_x loss_x 0.6494 (0.7563) acc_x 78.1250 (79.3750) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/22] time 0.184 (0.179) data 0.108 (0.103) loss_x loss_x 0.7773 (0.7562) acc_x 81.2500 (80.6250) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [15/22] time 0.189 (0.182) data 0.113 (0.106) loss_x loss_x 0.5962 (0.7131) acc_x 75.0000 (80.0000) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/22] time 0.183 (0.183) data 0.108 (0.107) loss_x loss_x 0.4485 (0.6938) acc_x 90.6250 (81.0938) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/27] time 0.203 (0.186) data 0.126 (0.109) loss_u loss_u 0.8311 (0.8174) acc_u 18.7500 (20.0000) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/27] time 0.219 (0.187) data 0.142 (0.110) loss_u loss_u 0.9463 (0.8274) acc_u 6.2500 (19.3750) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/27] time 0.182 (0.187) data 0.106 (0.110) loss_u loss_u 0.7979 (0.8272) acc_u 25.0000 (19.7917) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/27] time 0.195 (0.186) data 0.118 (0.110) loss_u loss_u 0.8579 (0.8385) acc_u 15.6250 (18.4375) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [25/27] time 0.182 (0.189) data 0.105 (0.112) loss_u loss_u 0.8247 (0.8478) acc_u 21.8750 (17.3750) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.4600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 736
clean true:732
clean false:4
clean_rate:0.9945652173913043
noisy true:416
noisy false:448
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 864
epoch [6/200] batch [5/23] time 0.185 (0.190) data 0.108 (0.114) loss_x loss_x 0.8833 (0.7664) acc_x 68.7500 (76.8750) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/23] time 0.179 (0.185) data 0.104 (0.109) loss_x loss_x 0.7671 (0.7038) acc_x 78.1250 (79.6875) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/23] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.8516 (0.8417) acc_x 78.1250 (76.8750) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [20/23] time 0.186 (0.186) data 0.109 (0.110) loss_x loss_x 0.7715 (0.7951) acc_x 75.0000 (78.4375) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/27] time 0.187 (0.188) data 0.110 (0.112) loss_u loss_u 0.8643 (0.8872) acc_u 15.6250 (11.8750) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/27] time 0.182 (0.187) data 0.105 (0.111) loss_u loss_u 0.8110 (0.8724) acc_u 25.0000 (14.0625) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/27] time 0.181 (0.187) data 0.104 (0.110) loss_u loss_u 0.8711 (0.8630) acc_u 15.6250 (15.4167) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/27] time 0.184 (0.187) data 0.107 (0.110) loss_u loss_u 0.7871 (0.8532) acc_u 21.8750 (16.8750) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [25/27] time 0.182 (0.186) data 0.105 (0.110) loss_u loss_u 0.8525 (0.8513) acc_u 18.7500 (17.3750) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.4575, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 732
clean true:727
clean false:5
clean_rate:0.9931693989071039
noisy true:417
noisy false:451
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 868
epoch [7/200] batch [5/22] time 0.211 (0.193) data 0.135 (0.117) loss_x loss_x 0.9214 (0.6578) acc_x 68.7500 (79.3750) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/22] time 0.185 (0.187) data 0.108 (0.111) loss_x loss_x 1.2412 (0.7499) acc_x 75.0000 (80.0000) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/22] time 0.192 (0.187) data 0.116 (0.110) loss_x loss_x 0.8257 (0.7199) acc_x 78.1250 (81.0417) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/22] time 0.167 (0.185) data 0.092 (0.108) loss_x loss_x 0.4285 (0.7379) acc_x 90.6250 (81.5625) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/27] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.9004 (0.8718) acc_u 12.5000 (14.3750) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/27] time 0.195 (0.184) data 0.118 (0.107) loss_u loss_u 0.8140 (0.8704) acc_u 18.7500 (14.6875) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [15/27] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9321 (0.8582) acc_u 6.2500 (15.0000) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [20/27] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8320 (0.8569) acc_u 15.6250 (15.1562) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [25/27] time 0.178 (0.183) data 0.102 (0.107) loss_u loss_u 0.9028 (0.8626) acc_u 12.5000 (14.6250) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.4619, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 739
clean true:736
clean false:3
clean_rate:0.9959404600811907
noisy true:418
noisy false:443
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 861
epoch [8/200] batch [5/23] time 0.163 (0.177) data 0.086 (0.101) loss_x loss_x 0.5381 (0.6120) acc_x 90.6250 (85.6250) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/23] time 0.197 (0.180) data 0.120 (0.104) loss_x loss_x 0.7051 (0.6417) acc_x 81.2500 (83.1250) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/23] time 0.186 (0.181) data 0.109 (0.105) loss_x loss_x 0.7402 (0.6795) acc_x 78.1250 (82.9167) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [20/23] time 0.178 (0.182) data 0.102 (0.106) loss_x loss_x 1.3047 (0.7383) acc_x 68.7500 (81.5625) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/26] time 0.183 (0.182) data 0.107 (0.106) loss_u loss_u 0.8643 (0.8543) acc_u 18.7500 (18.1250) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/26] time 0.186 (0.182) data 0.110 (0.106) loss_u loss_u 0.8765 (0.8605) acc_u 12.5000 (16.5625) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/26] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.8438 (0.8477) acc_u 18.7500 (17.9167) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/26] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.8857 (0.8539) acc_u 15.6250 (17.1875) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [25/26] time 0.182 (0.182) data 0.106 (0.106) loss_u loss_u 0.9219 (0.8616) acc_u 9.3750 (16.0000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 747
clean true:744
clean false:3
clean_rate:0.9959839357429718
noisy true:421
noisy false:432
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 853
epoch [9/200] batch [5/23] time 0.178 (0.181) data 0.103 (0.105) loss_x loss_x 0.6875 (0.8470) acc_x 84.3750 (80.0000) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/23] time 0.180 (0.182) data 0.105 (0.106) loss_x loss_x 0.5498 (0.8279) acc_x 81.2500 (78.7500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/23] time 0.188 (0.182) data 0.112 (0.106) loss_x loss_x 0.2275 (0.7764) acc_x 93.7500 (80.4167) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/23] time 0.180 (0.182) data 0.105 (0.106) loss_x loss_x 0.5410 (0.7576) acc_x 81.2500 (80.4688) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/26] time 0.188 (0.182) data 0.112 (0.107) loss_u loss_u 0.8838 (0.8720) acc_u 15.6250 (14.3750) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/26] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.9102 (0.8755) acc_u 9.3750 (14.3750) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/26] time 0.181 (0.184) data 0.105 (0.108) loss_u loss_u 0.8755 (0.8719) acc_u 12.5000 (15.0000) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/26] time 0.184 (0.183) data 0.108 (0.108) loss_u loss_u 0.7837 (0.8654) acc_u 21.8750 (15.3125) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [25/26] time 0.186 (0.184) data 0.110 (0.108) loss_u loss_u 0.8828 (0.8558) acc_u 12.5000 (16.2500) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.4600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 736
clean true:732
clean false:4
clean_rate:0.9945652173913043
noisy true:424
noisy false:440
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 864
epoch [10/200] batch [5/23] time 0.197 (0.191) data 0.121 (0.115) loss_x loss_x 0.8535 (0.8422) acc_x 81.2500 (78.1250) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/23] time 0.219 (0.190) data 0.143 (0.114) loss_x loss_x 0.8228 (0.7588) acc_x 78.1250 (80.0000) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/23] time 0.185 (0.192) data 0.110 (0.116) loss_x loss_x 0.5801 (0.7452) acc_x 84.3750 (80.2083) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/23] time 0.206 (0.191) data 0.130 (0.115) loss_x loss_x 0.6577 (0.7766) acc_x 78.1250 (80.1562) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/27] time 0.180 (0.192) data 0.104 (0.116) loss_u loss_u 0.8667 (0.8539) acc_u 15.6250 (14.3750) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/27] time 0.181 (0.191) data 0.105 (0.115) loss_u loss_u 0.8970 (0.8626) acc_u 9.3750 (14.6875) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [15/27] time 0.182 (0.190) data 0.106 (0.114) loss_u loss_u 0.9170 (0.8627) acc_u 9.3750 (15.2083) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [20/27] time 0.186 (0.190) data 0.110 (0.114) loss_u loss_u 0.7920 (0.8547) acc_u 25.0000 (16.2500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [25/27] time 0.179 (0.189) data 0.103 (0.113) loss_u loss_u 0.9023 (0.8579) acc_u 12.5000 (16.1250) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 427
confident_label rate tensor(0.4631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 741
clean true:739
clean false:2
clean_rate:0.9973009446693657
noisy true:434
noisy false:425
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 859
epoch [11/200] batch [5/23] time 0.192 (0.186) data 0.116 (0.111) loss_x loss_x 0.8452 (0.7220) acc_x 78.1250 (81.2500) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/23] time 0.217 (0.188) data 0.142 (0.113) loss_x loss_x 0.4790 (0.6539) acc_x 78.1250 (83.4375) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/23] time 0.188 (0.190) data 0.112 (0.114) loss_x loss_x 0.5479 (0.6565) acc_x 84.3750 (83.3333) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/23] time 0.181 (0.191) data 0.105 (0.115) loss_x loss_x 0.4370 (0.6585) acc_x 84.3750 (82.9688) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/26] time 0.185 (0.189) data 0.109 (0.113) loss_u loss_u 0.7534 (0.8046) acc_u 25.0000 (21.2500) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/26] time 0.193 (0.188) data 0.117 (0.112) loss_u loss_u 0.8291 (0.8334) acc_u 21.8750 (18.1250) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/26] time 0.183 (0.189) data 0.106 (0.113) loss_u loss_u 0.7676 (0.8326) acc_u 25.0000 (17.7083) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/26] time 0.181 (0.188) data 0.105 (0.112) loss_u loss_u 0.8481 (0.8430) acc_u 15.6250 (16.5625) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [25/26] time 0.180 (0.187) data 0.103 (0.111) loss_u loss_u 0.8999 (0.8498) acc_u 15.6250 (16.1250) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.4525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 724
clean true:722
clean false:2
clean_rate:0.9972375690607734
noisy true:412
noisy false:464
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 876
epoch [12/200] batch [5/22] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.6128 (0.7702) acc_x 84.3750 (80.6250) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/22] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 0.4133 (0.6765) acc_x 78.1250 (81.5625) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/22] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.7661 (0.6702) acc_x 81.2500 (82.9167) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/22] time 0.181 (0.181) data 0.105 (0.106) loss_x loss_x 0.8301 (0.6975) acc_x 71.8750 (80.9375) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/27] time 0.179 (0.181) data 0.103 (0.105) loss_u loss_u 0.8569 (0.8855) acc_u 21.8750 (14.3750) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/27] time 0.182 (0.181) data 0.106 (0.105) loss_u loss_u 0.8716 (0.8685) acc_u 12.5000 (15.3125) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/27] time 0.180 (0.181) data 0.104 (0.105) loss_u loss_u 0.8516 (0.8608) acc_u 12.5000 (15.8333) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/27] time 0.178 (0.181) data 0.101 (0.105) loss_u loss_u 0.7866 (0.8527) acc_u 25.0000 (16.7188) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [25/27] time 0.181 (0.181) data 0.104 (0.105) loss_u loss_u 0.7788 (0.8440) acc_u 25.0000 (17.6250) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.4769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 763
clean true:760
clean false:3
clean_rate:0.9960681520314548
noisy true:420
noisy false:417
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 837
epoch [13/200] batch [5/23] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.4573 (0.5262) acc_x 81.2500 (85.6250) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/23] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.9175 (0.6663) acc_x 78.1250 (82.8125) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/23] time 0.170 (0.181) data 0.093 (0.105) loss_x loss_x 0.4775 (0.6220) acc_x 87.5000 (83.5417) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/23] time 0.160 (0.178) data 0.084 (0.102) loss_x loss_x 0.5347 (0.6648) acc_x 84.3750 (82.3438) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/26] time 0.185 (0.179) data 0.107 (0.103) loss_u loss_u 0.8848 (0.8697) acc_u 15.6250 (15.6250) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/26] time 0.183 (0.180) data 0.107 (0.104) loss_u loss_u 0.8662 (0.8512) acc_u 12.5000 (16.8750) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/26] time 0.183 (0.180) data 0.107 (0.104) loss_u loss_u 0.8770 (0.8669) acc_u 15.6250 (15.6250) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/26] time 0.183 (0.180) data 0.107 (0.104) loss_u loss_u 0.8760 (0.8709) acc_u 15.6250 (15.0000) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [25/26] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8740 (0.8743) acc_u 12.5000 (14.5000) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 782
clean true:778
clean false:4
clean_rate:0.9948849104859335
noisy true:421
noisy false:397
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 818
epoch [14/200] batch [5/24] time 0.181 (0.184) data 0.105 (0.108) loss_x loss_x 0.4612 (0.5440) acc_x 87.5000 (86.8750) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/24] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.6592 (0.6062) acc_x 84.3750 (84.6875) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/24] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.3457 (0.5944) acc_x 90.6250 (84.3750) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/24] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.3923 (0.5759) acc_x 90.6250 (84.5312) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/25] time 0.179 (0.183) data 0.102 (0.106) loss_u loss_u 0.9668 (0.9027) acc_u 0.0000 (10.0000) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/25] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.9404 (0.8938) acc_u 6.2500 (10.9375) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/25] time 0.180 (0.182) data 0.104 (0.106) loss_u loss_u 0.9023 (0.8962) acc_u 9.3750 (11.0417) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/25] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.7627 (0.8807) acc_u 25.0000 (12.6562) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [25/25] time 0.182 (0.182) data 0.106 (0.106) loss_u loss_u 0.8491 (0.8761) acc_u 18.7500 (13.7500) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 419
confident_label rate tensor(0.4700, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 752
clean true:748
clean false:4
clean_rate:0.9946808510638298
noisy true:433
noisy false:415
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 848
epoch [15/200] batch [5/23] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.3748 (0.7116) acc_x 93.7500 (83.7500) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/23] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 1.0830 (0.7990) acc_x 75.0000 (80.9375) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/23] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.6133 (0.7909) acc_x 81.2500 (81.0417) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/23] time 0.218 (0.184) data 0.142 (0.108) loss_x loss_x 0.8838 (0.8200) acc_x 78.1250 (80.3125) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/26] time 0.217 (0.186) data 0.141 (0.110) loss_u loss_u 0.8081 (0.8442) acc_u 21.8750 (18.1250) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/26] time 0.182 (0.185) data 0.106 (0.109) loss_u loss_u 0.9473 (0.8443) acc_u 6.2500 (17.1875) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/26] time 0.176 (0.185) data 0.099 (0.109) loss_u loss_u 0.8555 (0.8469) acc_u 15.6250 (16.6667) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/26] time 0.207 (0.185) data 0.131 (0.109) loss_u loss_u 0.8926 (0.8562) acc_u 12.5000 (15.9375) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [25/26] time 0.179 (0.185) data 0.102 (0.109) loss_u loss_u 0.7964 (0.8538) acc_u 25.0000 (16.6250) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.4737, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 758
clean true:753
clean false:5
clean_rate:0.9934036939313984
noisy true:434
noisy false:408
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 842
epoch [16/200] batch [5/23] time 0.167 (0.176) data 0.091 (0.100) loss_x loss_x 0.6938 (0.6854) acc_x 78.1250 (83.7500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/23] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.7773 (0.7352) acc_x 84.3750 (83.4375) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/23] time 0.182 (0.179) data 0.106 (0.103) loss_x loss_x 0.6226 (0.7303) acc_x 84.3750 (82.7083) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/23] time 0.181 (0.180) data 0.105 (0.103) loss_x loss_x 1.0928 (0.7035) acc_x 81.2500 (83.4375) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/26] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.8608 (0.8735) acc_u 15.6250 (14.3750) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/26] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8809 (0.8463) acc_u 15.6250 (17.5000) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/26] time 0.177 (0.183) data 0.099 (0.106) loss_u loss_u 0.8647 (0.8636) acc_u 21.8750 (15.8333) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/26] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.8257 (0.8556) acc_u 18.7500 (16.4062) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [25/26] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.8569 (0.8584) acc_u 15.6250 (15.8750) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.4775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 764
clean true:761
clean false:3
clean_rate:0.9960732984293194
noisy true:435
noisy false:401
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 836
epoch [17/200] batch [5/23] time 0.201 (0.186) data 0.124 (0.110) loss_x loss_x 0.7910 (0.7223) acc_x 81.2500 (81.8750) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/23] time 0.202 (0.194) data 0.125 (0.117) loss_x loss_x 0.6694 (0.6323) acc_x 78.1250 (82.5000) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/23] time 0.215 (0.195) data 0.139 (0.119) loss_x loss_x 0.9209 (0.7131) acc_x 75.0000 (81.2500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/23] time 0.182 (0.192) data 0.107 (0.116) loss_x loss_x 0.5156 (0.6801) acc_x 87.5000 (81.7188) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/26] time 0.184 (0.188) data 0.108 (0.112) loss_u loss_u 0.8613 (0.8697) acc_u 12.5000 (13.1250) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/26] time 0.179 (0.187) data 0.103 (0.111) loss_u loss_u 0.8149 (0.8591) acc_u 18.7500 (15.3125) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/26] time 0.186 (0.186) data 0.110 (0.110) loss_u loss_u 0.8257 (0.8671) acc_u 15.6250 (14.3750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/26] time 0.186 (0.186) data 0.109 (0.110) loss_u loss_u 0.8101 (0.8609) acc_u 18.7500 (15.1562) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [25/26] time 0.182 (0.186) data 0.106 (0.110) loss_u loss_u 0.7686 (0.8542) acc_u 28.1250 (16.2500) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 772
clean true:768
clean false:4
clean_rate:0.9948186528497409
noisy true:429
noisy false:399
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 828
epoch [18/200] batch [5/24] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.6611 (0.5750) acc_x 84.3750 (83.1250) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/24] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.5513 (0.5926) acc_x 84.3750 (82.5000) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/24] time 0.168 (0.181) data 0.091 (0.105) loss_x loss_x 0.9731 (0.6812) acc_x 81.2500 (81.6667) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/24] time 0.185 (0.180) data 0.109 (0.104) loss_x loss_x 0.6934 (0.6804) acc_x 81.2500 (81.5625) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/25] time 0.180 (0.180) data 0.103 (0.104) loss_u loss_u 0.8193 (0.8368) acc_u 18.7500 (18.1250) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/25] time 0.179 (0.180) data 0.102 (0.104) loss_u loss_u 0.8359 (0.8397) acc_u 25.0000 (18.7500) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/25] time 0.187 (0.179) data 0.110 (0.103) loss_u loss_u 0.9307 (0.8652) acc_u 6.2500 (15.2083) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/25] time 0.195 (0.180) data 0.119 (0.103) loss_u loss_u 0.8682 (0.8693) acc_u 12.5000 (15.1562) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [25/25] time 0.176 (0.180) data 0.099 (0.103) loss_u loss_u 0.8608 (0.8701) acc_u 15.6250 (15.0000) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 434
confident_label rate tensor(0.4712, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 754
clean true:749
clean false:5
clean_rate:0.993368700265252
noisy true:417
noisy false:429
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 846
epoch [19/200] batch [5/23] time 0.159 (0.173) data 0.082 (0.097) loss_x loss_x 0.9531 (0.6579) acc_x 78.1250 (84.3750) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/23] time 0.180 (0.177) data 0.105 (0.101) loss_x loss_x 0.3806 (0.6363) acc_x 90.6250 (85.3125) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/23] time 0.183 (0.179) data 0.108 (0.103) loss_x loss_x 0.7549 (0.6289) acc_x 75.0000 (83.7500) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/23] time 0.182 (0.180) data 0.106 (0.104) loss_x loss_x 1.0000 (0.6400) acc_x 71.8750 (83.1250) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/26] time 0.180 (0.181) data 0.104 (0.105) loss_u loss_u 0.8530 (0.8317) acc_u 15.6250 (18.1250) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/26] time 0.179 (0.181) data 0.103 (0.105) loss_u loss_u 0.9116 (0.8437) acc_u 9.3750 (16.5625) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/26] time 0.189 (0.181) data 0.113 (0.105) loss_u loss_u 0.9116 (0.8468) acc_u 9.3750 (16.4583) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/26] time 0.181 (0.181) data 0.105 (0.105) loss_u loss_u 0.9131 (0.8526) acc_u 15.6250 (16.4062) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [25/26] time 0.180 (0.182) data 0.104 (0.106) loss_u loss_u 0.9048 (0.8534) acc_u 9.3750 (16.2500) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.4762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 762
clean true:759
clean false:3
clean_rate:0.9960629921259843
noisy true:434
noisy false:404
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 838
epoch [20/200] batch [5/23] time 0.183 (0.181) data 0.107 (0.106) loss_x loss_x 0.8931 (0.7046) acc_x 75.0000 (80.6250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/23] time 0.185 (0.183) data 0.109 (0.108) loss_x loss_x 0.5117 (0.5813) acc_x 81.2500 (84.6875) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/23] time 0.183 (0.183) data 0.108 (0.107) loss_x loss_x 0.7178 (0.6191) acc_x 78.1250 (82.7083) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/23] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.9478 (0.6717) acc_x 78.1250 (80.7812) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/26] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.9097 (0.8734) acc_u 9.3750 (14.3750) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/26] time 0.180 (0.183) data 0.104 (0.107) loss_u loss_u 0.8311 (0.8420) acc_u 21.8750 (19.0625) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/26] time 0.179 (0.182) data 0.103 (0.106) loss_u loss_u 0.8306 (0.8518) acc_u 18.7500 (17.7083) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/26] time 0.183 (0.183) data 0.105 (0.107) loss_u loss_u 0.9595 (0.8600) acc_u 3.1250 (16.5625) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [25/26] time 0.179 (0.183) data 0.103 (0.107) loss_u loss_u 0.8281 (0.8606) acc_u 18.7500 (16.1250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.4775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 764
clean true:762
clean false:2
clean_rate:0.9973821989528796
noisy true:436
noisy false:400
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 836
epoch [21/200] batch [5/23] time 0.160 (0.188) data 0.085 (0.112) loss_x loss_x 0.8354 (0.6344) acc_x 78.1250 (84.3750) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/23] time 0.177 (0.184) data 0.101 (0.108) loss_x loss_x 0.7212 (0.6780) acc_x 71.8750 (80.6250) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/23] time 0.180 (0.183) data 0.105 (0.107) loss_x loss_x 0.4248 (0.6384) acc_x 90.6250 (82.0833) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/23] time 0.195 (0.185) data 0.120 (0.109) loss_x loss_x 0.7964 (0.6723) acc_x 71.8750 (81.0938) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/26] time 0.214 (0.186) data 0.138 (0.110) loss_u loss_u 0.9102 (0.8269) acc_u 12.5000 (18.7500) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/26] time 0.189 (0.187) data 0.113 (0.112) loss_u loss_u 0.8989 (0.8483) acc_u 15.6250 (16.5625) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/26] time 0.199 (0.188) data 0.122 (0.112) loss_u loss_u 0.7983 (0.8538) acc_u 28.1250 (16.8750) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [20/26] time 0.185 (0.187) data 0.109 (0.111) loss_u loss_u 0.9185 (0.8564) acc_u 9.3750 (16.5625) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [25/26] time 0.203 (0.187) data 0.127 (0.111) loss_u loss_u 0.8403 (0.8572) acc_u 18.7500 (16.2500) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 774
clean true:772
clean false:2
clean_rate:0.9974160206718347
noisy true:427
noisy false:399
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 826
epoch [22/200] batch [5/24] time 0.241 (0.249) data 0.165 (0.173) loss_x loss_x 0.7002 (0.6467) acc_x 78.1250 (81.8750) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/24] time 0.178 (0.216) data 0.096 (0.140) loss_x loss_x 1.2910 (0.7465) acc_x 75.0000 (81.5625) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/24] time 0.184 (0.205) data 0.107 (0.128) loss_x loss_x 0.9185 (0.7562) acc_x 78.1250 (80.4167) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/24] time 0.214 (0.214) data 0.138 (0.138) loss_x loss_x 0.6011 (0.7308) acc_x 84.3750 (81.4062) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/25] time 0.195 (0.208) data 0.119 (0.132) loss_u loss_u 0.9106 (0.8844) acc_u 12.5000 (13.1250) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/25] time 0.182 (0.207) data 0.106 (0.130) loss_u loss_u 0.9316 (0.8867) acc_u 6.2500 (12.8125) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/25] time 0.182 (0.203) data 0.106 (0.127) loss_u loss_u 0.8120 (0.8688) acc_u 25.0000 (15.2083) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/25] time 0.184 (0.201) data 0.107 (0.125) loss_u loss_u 0.8770 (0.8707) acc_u 12.5000 (14.8438) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [25/25] time 0.200 (0.200) data 0.124 (0.123) loss_u loss_u 0.8623 (0.8716) acc_u 15.6250 (14.6250) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.4894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 783
clean true:780
clean false:3
clean_rate:0.9961685823754789
noisy true:429
noisy false:388
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 817
epoch [23/200] batch [5/24] time 0.182 (0.185) data 0.106 (0.109) loss_x loss_x 0.9194 (0.6185) acc_x 81.2500 (83.7500) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/24] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.3320 (0.6394) acc_x 87.5000 (82.8125) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/24] time 0.180 (0.184) data 0.104 (0.108) loss_x loss_x 0.0891 (0.6146) acc_x 100.0000 (84.3750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/24] time 0.165 (0.184) data 0.089 (0.108) loss_x loss_x 0.5518 (0.5943) acc_x 81.2500 (84.8438) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/25] time 0.186 (0.182) data 0.109 (0.106) loss_u loss_u 0.8164 (0.8644) acc_u 18.7500 (13.1250) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/25] time 0.182 (0.182) data 0.106 (0.106) loss_u loss_u 0.8760 (0.8625) acc_u 15.6250 (14.3750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/25] time 0.185 (0.182) data 0.108 (0.106) loss_u loss_u 0.9043 (0.8719) acc_u 9.3750 (13.3333) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/25] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.8354 (0.8643) acc_u 15.6250 (14.3750) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [25/25] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.8145 (0.8658) acc_u 21.8750 (14.2500) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.4769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 763
clean true:760
clean false:3
clean_rate:0.9960681520314548
noisy true:430
noisy false:407
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 837
epoch [24/200] batch [5/23] time 0.182 (0.201) data 0.106 (0.126) loss_x loss_x 0.6069 (0.7158) acc_x 87.5000 (83.7500) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/23] time 0.179 (0.192) data 0.103 (0.116) loss_x loss_x 0.3916 (0.6408) acc_x 90.6250 (83.1250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/23] time 0.184 (0.189) data 0.108 (0.114) loss_x loss_x 0.5352 (0.6542) acc_x 87.5000 (83.1250) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [20/23] time 0.181 (0.188) data 0.105 (0.112) loss_x loss_x 1.0664 (0.6236) acc_x 81.2500 (84.5312) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/26] time 0.186 (0.187) data 0.110 (0.111) loss_u loss_u 0.9019 (0.8612) acc_u 12.5000 (15.0000) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/26] time 0.187 (0.185) data 0.110 (0.109) loss_u loss_u 0.8555 (0.8632) acc_u 15.6250 (15.0000) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/26] time 0.182 (0.184) data 0.105 (0.108) loss_u loss_u 0.8618 (0.8535) acc_u 15.6250 (15.8333) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/26] time 0.166 (0.185) data 0.090 (0.109) loss_u loss_u 0.8550 (0.8569) acc_u 15.6250 (15.6250) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [25/26] time 0.187 (0.184) data 0.111 (0.108) loss_u loss_u 0.8882 (0.8567) acc_u 9.3750 (15.7500) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 775
clean true:771
clean false:4
clean_rate:0.9948387096774194
noisy true:447
noisy false:378
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 825
epoch [25/200] batch [5/24] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.8052 (0.7022) acc_x 75.0000 (78.1250) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/24] time 0.171 (0.184) data 0.095 (0.108) loss_x loss_x 0.4041 (0.7143) acc_x 90.6250 (79.6875) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/24] time 0.171 (0.180) data 0.095 (0.104) loss_x loss_x 0.6724 (0.7272) acc_x 81.2500 (80.4167) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/24] time 0.182 (0.180) data 0.106 (0.104) loss_x loss_x 0.8071 (0.7147) acc_x 75.0000 (80.9375) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/25] time 0.183 (0.180) data 0.107 (0.104) loss_u loss_u 0.9023 (0.8871) acc_u 15.6250 (14.3750) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/25] time 0.180 (0.180) data 0.104 (0.104) loss_u loss_u 0.8965 (0.8754) acc_u 12.5000 (15.9375) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/25] time 0.177 (0.180) data 0.101 (0.104) loss_u loss_u 0.8813 (0.8697) acc_u 12.5000 (16.4583) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/25] time 0.194 (0.180) data 0.118 (0.104) loss_u loss_u 0.9326 (0.8702) acc_u 9.3750 (16.2500) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [25/25] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.9248 (0.8654) acc_u 6.2500 (16.1250) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 771
clean true:766
clean false:5
clean_rate:0.993514915693904
noisy true:451
noisy false:378
after delete: len(clean_dataset) 771
after delete: len(noisy_dataset) 829
epoch [26/200] batch [5/24] time 0.181 (0.211) data 0.105 (0.135) loss_x loss_x 0.3762 (0.4983) acc_x 90.6250 (85.0000) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/24] time 0.180 (0.196) data 0.104 (0.121) loss_x loss_x 0.6372 (0.6370) acc_x 84.3750 (84.0625) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/24] time 0.185 (0.191) data 0.109 (0.115) loss_x loss_x 0.3486 (0.6206) acc_x 93.7500 (85.0000) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/24] time 0.180 (0.189) data 0.104 (0.113) loss_x loss_x 0.6914 (0.6221) acc_x 78.1250 (84.3750) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/25] time 0.181 (0.187) data 0.105 (0.111) loss_u loss_u 0.9229 (0.8551) acc_u 6.2500 (16.2500) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [10/25] time 0.179 (0.186) data 0.103 (0.110) loss_u loss_u 0.8975 (0.8572) acc_u 9.3750 (15.9375) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/25] time 0.183 (0.186) data 0.106 (0.110) loss_u loss_u 0.9375 (0.8586) acc_u 6.2500 (15.0000) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/25] time 0.183 (0.185) data 0.107 (0.109) loss_u loss_u 0.8564 (0.8600) acc_u 15.6250 (15.0000) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [25/25] time 0.184 (0.185) data 0.107 (0.109) loss_u loss_u 0.9170 (0.8587) acc_u 12.5000 (15.7500) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.4750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 760
clean true:757
clean false:3
clean_rate:0.9960526315789474
noisy true:430
noisy false:410
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 840
epoch [27/200] batch [5/23] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.5068 (0.7578) acc_x 84.3750 (80.0000) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/23] time 0.181 (0.182) data 0.106 (0.106) loss_x loss_x 0.5396 (0.6558) acc_x 81.2500 (82.1875) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/23] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.8462 (0.6760) acc_x 75.0000 (80.6250) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/23] time 0.182 (0.182) data 0.107 (0.106) loss_x loss_x 0.6338 (0.6622) acc_x 81.2500 (80.9375) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/26] time 0.166 (0.178) data 0.090 (0.102) loss_u loss_u 0.8584 (0.8661) acc_u 18.7500 (16.2500) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/26] time 0.210 (0.179) data 0.134 (0.103) loss_u loss_u 0.8799 (0.8380) acc_u 15.6250 (19.0625) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/26] time 0.172 (0.179) data 0.095 (0.103) loss_u loss_u 0.8145 (0.8526) acc_u 21.8750 (17.2917) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/26] time 0.183 (0.178) data 0.107 (0.102) loss_u loss_u 0.7964 (0.8489) acc_u 21.8750 (17.1875) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [25/26] time 0.199 (0.179) data 0.123 (0.103) loss_u loss_u 0.8652 (0.8517) acc_u 18.7500 (16.8750) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.4925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 788
clean true:783
clean false:5
clean_rate:0.9936548223350253
noisy true:424
noisy false:388
after delete: len(clean_dataset) 788
after delete: len(noisy_dataset) 812
epoch [28/200] batch [5/24] time 0.186 (0.182) data 0.110 (0.107) loss_x loss_x 0.4802 (0.4213) acc_x 81.2500 (88.1250) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [10/24] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.7178 (0.5001) acc_x 75.0000 (85.3125) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/24] time 0.181 (0.181) data 0.105 (0.106) loss_x loss_x 0.8247 (0.5737) acc_x 81.2500 (83.5417) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/24] time 0.184 (0.181) data 0.109 (0.106) loss_x loss_x 0.5713 (0.5874) acc_x 81.2500 (83.2812) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/25] time 0.181 (0.181) data 0.105 (0.106) loss_u loss_u 0.9155 (0.8895) acc_u 9.3750 (11.8750) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [10/25] time 0.184 (0.182) data 0.108 (0.106) loss_u loss_u 0.8716 (0.8893) acc_u 15.6250 (12.5000) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/25] time 0.181 (0.182) data 0.103 (0.106) loss_u loss_u 0.8325 (0.8804) acc_u 21.8750 (14.1667) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/25] time 0.207 (0.182) data 0.131 (0.106) loss_u loss_u 0.9189 (0.8777) acc_u 9.3750 (14.2188) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [25/25] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.8188 (0.8730) acc_u 21.8750 (14.6250) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 778
clean true:774
clean false:4
clean_rate:0.9948586118251928
noisy true:426
noisy false:396
after delete: len(clean_dataset) 778
after delete: len(noisy_dataset) 822
epoch [29/200] batch [5/24] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 1.1494 (0.7713) acc_x 71.8750 (80.0000) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/24] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.8042 (0.6932) acc_x 75.0000 (82.1875) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/24] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.8716 (0.6598) acc_x 71.8750 (83.3333) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/24] time 0.183 (0.182) data 0.108 (0.106) loss_x loss_x 0.2842 (0.6827) acc_x 90.6250 (83.2812) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/25] time 0.183 (0.181) data 0.107 (0.105) loss_u loss_u 0.8770 (0.8104) acc_u 18.7500 (21.2500) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/25] time 0.179 (0.181) data 0.103 (0.105) loss_u loss_u 0.8740 (0.8448) acc_u 12.5000 (17.5000) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/25] time 0.183 (0.181) data 0.107 (0.105) loss_u loss_u 0.8257 (0.8398) acc_u 15.6250 (17.5000) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/25] time 0.178 (0.181) data 0.102 (0.105) loss_u loss_u 0.8516 (0.8448) acc_u 15.6250 (17.1875) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [25/25] time 0.184 (0.182) data 0.108 (0.106) loss_u loss_u 0.8311 (0.8495) acc_u 18.7500 (16.7500) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 782
clean true:780
clean false:2
clean_rate:0.9974424552429667
noisy true:433
noisy false:385
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 818
epoch [30/200] batch [5/24] time 0.185 (0.206) data 0.109 (0.130) loss_x loss_x 0.7437 (0.6145) acc_x 84.3750 (83.1250) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/24] time 0.185 (0.195) data 0.109 (0.119) loss_x loss_x 0.4709 (0.5961) acc_x 84.3750 (83.4375) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/24] time 0.187 (0.191) data 0.111 (0.115) loss_x loss_x 0.5083 (0.6733) acc_x 90.6250 (82.5000) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/24] time 0.186 (0.189) data 0.110 (0.113) loss_x loss_x 0.4377 (0.6643) acc_x 87.5000 (82.8125) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/25] time 0.178 (0.187) data 0.102 (0.111) loss_u loss_u 0.8818 (0.8629) acc_u 12.5000 (15.6250) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/25] time 0.185 (0.186) data 0.109 (0.110) loss_u loss_u 0.8247 (0.8532) acc_u 21.8750 (15.9375) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/25] time 0.178 (0.186) data 0.102 (0.110) loss_u loss_u 0.8589 (0.8413) acc_u 15.6250 (17.0833) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/25] time 0.196 (0.186) data 0.120 (0.110) loss_u loss_u 0.8994 (0.8549) acc_u 15.6250 (16.0938) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [25/25] time 0.222 (0.187) data 0.146 (0.111) loss_u loss_u 0.8174 (0.8590) acc_u 21.8750 (15.6250) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 803
clean true:799
clean false:4
clean_rate:0.9950186799501868
noisy true:437
noisy false:360
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 797
epoch [31/200] batch [5/25] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.7295 (0.8487) acc_x 81.2500 (78.7500) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/25] time 0.190 (0.184) data 0.114 (0.108) loss_x loss_x 0.4341 (0.6816) acc_x 87.5000 (83.1250) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/25] time 0.188 (0.185) data 0.112 (0.109) loss_x loss_x 0.4663 (0.6266) acc_x 90.6250 (84.1667) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/25] time 0.182 (0.184) data 0.107 (0.109) loss_x loss_x 0.8472 (0.6335) acc_x 75.0000 (84.0625) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [25/25] time 0.183 (0.184) data 0.108 (0.108) loss_x loss_x 0.4375 (0.6106) acc_x 87.5000 (84.5000) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/24] time 0.183 (0.184) data 0.106 (0.108) loss_u loss_u 0.7974 (0.8649) acc_u 21.8750 (15.0000) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/24] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.7754 (0.8649) acc_u 25.0000 (15.3125) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/24] time 0.173 (0.182) data 0.097 (0.106) loss_u loss_u 0.8447 (0.8719) acc_u 18.7500 (14.5833) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/24] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.9238 (0.8749) acc_u 6.2500 (14.2188) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 791
clean true:787
clean false:4
clean_rate:0.9949431099873578
noisy true:451
noisy false:358
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 809
epoch [32/200] batch [5/24] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 1.0293 (0.6220) acc_x 71.8750 (83.1250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/24] time 0.180 (0.181) data 0.105 (0.106) loss_x loss_x 0.7876 (0.6435) acc_x 84.3750 (82.5000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/24] time 0.186 (0.182) data 0.110 (0.106) loss_x loss_x 0.3059 (0.5876) acc_x 90.6250 (83.9583) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/24] time 0.182 (0.182) data 0.107 (0.106) loss_x loss_x 0.7383 (0.5902) acc_x 78.1250 (84.2188) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/25] time 0.182 (0.183) data 0.106 (0.107) loss_u loss_u 0.9019 (0.8610) acc_u 9.3750 (15.6250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/25] time 0.187 (0.183) data 0.110 (0.107) loss_u loss_u 0.8350 (0.8517) acc_u 21.8750 (17.1875) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/25] time 0.179 (0.182) data 0.103 (0.106) loss_u loss_u 0.8970 (0.8601) acc_u 12.5000 (16.2500) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/25] time 0.178 (0.182) data 0.102 (0.106) loss_u loss_u 0.8896 (0.8724) acc_u 9.3750 (14.6875) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [25/25] time 0.190 (0.182) data 0.113 (0.106) loss_u loss_u 0.8838 (0.8743) acc_u 12.5000 (14.2500) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 796
clean true:791
clean false:5
clean_rate:0.9937185929648241
noisy true:432
noisy false:372
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 804
epoch [33/200] batch [5/24] time 0.194 (0.188) data 0.118 (0.112) loss_x loss_x 0.7134 (0.7261) acc_x 75.0000 (78.7500) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/24] time 0.180 (0.184) data 0.104 (0.109) loss_x loss_x 0.8755 (0.7006) acc_x 81.2500 (81.2500) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/24] time 0.185 (0.184) data 0.109 (0.109) loss_x loss_x 0.5386 (0.6572) acc_x 84.3750 (82.2917) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/24] time 0.184 (0.184) data 0.109 (0.108) loss_x loss_x 0.3647 (0.6522) acc_x 93.7500 (82.5000) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/25] time 0.183 (0.184) data 0.107 (0.108) loss_u loss_u 0.8745 (0.8892) acc_u 15.6250 (13.1250) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/25] time 0.183 (0.183) data 0.107 (0.108) loss_u loss_u 0.8838 (0.8855) acc_u 9.3750 (13.1250) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/25] time 0.184 (0.183) data 0.108 (0.108) loss_u loss_u 0.8149 (0.8683) acc_u 18.7500 (14.5833) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/25] time 0.180 (0.183) data 0.103 (0.107) loss_u loss_u 0.8984 (0.8643) acc_u 9.3750 (15.1562) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [25/25] time 0.203 (0.184) data 0.127 (0.108) loss_u loss_u 0.8179 (0.8637) acc_u 18.7500 (15.1250) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.4937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 790
clean true:788
clean false:2
clean_rate:0.9974683544303797
noisy true:458
noisy false:352
after delete: len(clean_dataset) 790
after delete: len(noisy_dataset) 810
epoch [34/200] batch [5/24] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 1.2520 (0.8148) acc_x 68.7500 (80.0000) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/24] time 0.179 (0.182) data 0.104 (0.106) loss_x loss_x 0.7109 (0.7462) acc_x 87.5000 (81.8750) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/24] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.3792 (0.6745) acc_x 84.3750 (82.2917) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/24] time 0.182 (0.181) data 0.107 (0.106) loss_x loss_x 0.6694 (0.6560) acc_x 81.2500 (82.8125) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/25] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.8599 (0.8495) acc_u 15.6250 (16.2500) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/25] time 0.183 (0.182) data 0.107 (0.106) loss_u loss_u 0.7827 (0.8478) acc_u 25.0000 (17.1875) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/25] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.9126 (0.8684) acc_u 9.3750 (14.7917) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/25] time 0.180 (0.182) data 0.104 (0.106) loss_u loss_u 0.7671 (0.8541) acc_u 25.0000 (16.7188) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [25/25] time 0.183 (0.182) data 0.107 (0.106) loss_u loss_u 0.8037 (0.8550) acc_u 21.8750 (16.3750) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 405
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 772
clean true:767
clean false:5
clean_rate:0.9935233160621761
noisy true:428
noisy false:400
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 828
epoch [35/200] batch [5/24] time 0.177 (0.177) data 0.102 (0.100) loss_x loss_x 0.8184 (0.8284) acc_x 78.1250 (82.5000) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/24] time 0.182 (0.180) data 0.106 (0.104) loss_x loss_x 0.4385 (0.7717) acc_x 87.5000 (81.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/24] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.5552 (0.6916) acc_x 78.1250 (82.7083) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/24] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.5361 (0.6534) acc_x 81.2500 (83.4375) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/25] time 0.180 (0.182) data 0.103 (0.106) loss_u loss_u 0.9067 (0.8745) acc_u 12.5000 (15.0000) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/25] time 0.179 (0.182) data 0.103 (0.106) loss_u loss_u 0.7490 (0.8400) acc_u 28.1250 (17.8125) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/25] time 0.179 (0.182) data 0.103 (0.106) loss_u loss_u 0.8853 (0.8459) acc_u 12.5000 (16.8750) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/25] time 0.194 (0.182) data 0.117 (0.106) loss_u loss_u 0.8496 (0.8407) acc_u 18.7500 (17.6562) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [25/25] time 0.177 (0.182) data 0.101 (0.106) loss_u loss_u 0.7632 (0.8444) acc_u 28.1250 (17.2500) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 808
clean true:802
clean false:6
clean_rate:0.9925742574257426
noisy true:424
noisy false:368
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 792
epoch [36/200] batch [5/25] time 0.180 (0.185) data 0.105 (0.110) loss_x loss_x 0.1819 (0.4725) acc_x 90.6250 (87.5000) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/25] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.9834 (0.4759) acc_x 84.3750 (88.4375) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/25] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.3376 (0.5507) acc_x 84.3750 (85.6250) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/25] time 0.214 (0.187) data 0.138 (0.112) loss_x loss_x 1.3271 (0.6105) acc_x 68.7500 (84.6875) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [25/25] time 0.184 (0.185) data 0.108 (0.110) loss_x loss_x 0.5371 (0.6428) acc_x 87.5000 (84.1250) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/24] time 0.182 (0.185) data 0.106 (0.109) loss_u loss_u 0.8657 (0.8566) acc_u 15.6250 (16.2500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/24] time 0.187 (0.184) data 0.111 (0.109) loss_u loss_u 0.9634 (0.8776) acc_u 3.1250 (14.6875) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/24] time 0.181 (0.184) data 0.105 (0.108) loss_u loss_u 0.8452 (0.8772) acc_u 12.5000 (14.3750) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/24] time 0.182 (0.184) data 0.106 (0.108) loss_u loss_u 0.9165 (0.8796) acc_u 6.2500 (14.3750) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.4956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 793
clean true:791
clean false:2
clean_rate:0.9974779319041615
noisy true:424
noisy false:383
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 807
epoch [37/200] batch [5/24] time 0.214 (0.197) data 0.138 (0.121) loss_x loss_x 0.6885 (0.6067) acc_x 81.2500 (83.7500) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/24] time 0.186 (0.187) data 0.110 (0.111) loss_x loss_x 0.4514 (0.6155) acc_x 87.5000 (83.1250) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/24] time 0.183 (0.190) data 0.107 (0.114) loss_x loss_x 0.6362 (0.6532) acc_x 81.2500 (82.7083) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/24] time 0.180 (0.188) data 0.104 (0.112) loss_x loss_x 0.3713 (0.6412) acc_x 96.8750 (82.6562) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/25] time 0.179 (0.186) data 0.103 (0.110) loss_u loss_u 0.8716 (0.8713) acc_u 15.6250 (14.3750) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/25] time 0.180 (0.186) data 0.104 (0.110) loss_u loss_u 0.8906 (0.8700) acc_u 12.5000 (15.3125) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/25] time 0.178 (0.185) data 0.102 (0.109) loss_u loss_u 0.8398 (0.8716) acc_u 18.7500 (15.2083) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/25] time 0.192 (0.185) data 0.115 (0.109) loss_u loss_u 0.9224 (0.8696) acc_u 9.3750 (15.0000) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [25/25] time 0.184 (0.184) data 0.108 (0.108) loss_u loss_u 0.7939 (0.8586) acc_u 21.8750 (15.8750) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.5025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 804
clean true:798
clean false:6
clean_rate:0.9925373134328358
noisy true:428
noisy false:368
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 796
epoch [38/200] batch [5/25] time 0.229 (0.191) data 0.154 (0.114) loss_x loss_x 0.5684 (0.4584) acc_x 87.5000 (86.2500) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/25] time 0.215 (0.189) data 0.139 (0.113) loss_x loss_x 1.1826 (0.5448) acc_x 71.8750 (85.0000) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/25] time 0.179 (0.193) data 0.103 (0.116) loss_x loss_x 0.6504 (0.5827) acc_x 81.2500 (84.1667) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/25] time 0.183 (0.189) data 0.107 (0.112) loss_x loss_x 0.3428 (0.6232) acc_x 90.6250 (83.4375) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [25/25] time 0.181 (0.187) data 0.104 (0.111) loss_x loss_x 0.5864 (0.6227) acc_x 84.3750 (83.5000) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/24] time 0.158 (0.185) data 0.081 (0.109) loss_u loss_u 0.9336 (0.8940) acc_u 6.2500 (11.2500) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/24] time 0.181 (0.185) data 0.104 (0.108) loss_u loss_u 0.8833 (0.8756) acc_u 12.5000 (14.3750) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/24] time 0.214 (0.186) data 0.138 (0.110) loss_u loss_u 0.9702 (0.8883) acc_u 3.1250 (13.1250) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/24] time 0.207 (0.191) data 0.131 (0.114) loss_u loss_u 0.7388 (0.8801) acc_u 34.3750 (13.9062) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 795
clean true:788
clean false:7
clean_rate:0.9911949685534591
noisy true:420
noisy false:385
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 805
epoch [39/200] batch [5/24] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4229 (0.6400) acc_x 87.5000 (83.7500) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/24] time 0.177 (0.183) data 0.101 (0.106) loss_x loss_x 0.4763 (0.5457) acc_x 84.3750 (85.6250) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/24] time 0.188 (0.183) data 0.112 (0.106) loss_x loss_x 0.4438 (0.6098) acc_x 87.5000 (83.1250) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/24] time 0.185 (0.183) data 0.108 (0.107) loss_x loss_x 0.4219 (0.5952) acc_x 87.5000 (83.1250) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/25] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.8584 (0.8525) acc_u 18.7500 (16.8750) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/25] time 0.166 (0.179) data 0.090 (0.102) loss_u loss_u 0.8828 (0.8506) acc_u 12.5000 (16.5625) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/25] time 0.175 (0.179) data 0.099 (0.102) loss_u loss_u 0.7954 (0.8530) acc_u 21.8750 (16.4583) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/25] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8472 (0.8520) acc_u 15.6250 (16.4062) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [25/25] time 0.182 (0.180) data 0.106 (0.103) loss_u loss_u 0.9321 (0.8551) acc_u 9.3750 (16.6250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 791
clean true:789
clean false:2
clean_rate:0.9974715549936789
noisy true:434
noisy false:375
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 809
epoch [40/200] batch [5/24] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.6152 (0.6526) acc_x 81.2500 (81.2500) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/24] time 0.186 (0.182) data 0.110 (0.106) loss_x loss_x 0.4236 (0.5703) acc_x 81.2500 (83.7500) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/24] time 0.179 (0.181) data 0.103 (0.105) loss_x loss_x 0.3074 (0.5767) acc_x 90.6250 (83.7500) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/24] time 0.185 (0.182) data 0.109 (0.106) loss_x loss_x 0.4382 (0.5406) acc_x 93.7500 (84.5312) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/25] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.8457 (0.8611) acc_u 18.7500 (15.0000) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/25] time 0.185 (0.182) data 0.109 (0.106) loss_u loss_u 0.9380 (0.8658) acc_u 6.2500 (15.3125) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/25] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.8569 (0.8642) acc_u 15.6250 (15.2083) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/25] time 0.165 (0.182) data 0.088 (0.105) loss_u loss_u 0.8511 (0.8659) acc_u 18.7500 (15.1562) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [25/25] time 0.180 (0.181) data 0.104 (0.105) loss_u loss_u 0.8716 (0.8699) acc_u 15.6250 (14.8750) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.4881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 781
clean true:778
clean false:3
clean_rate:0.9961587708066582
noisy true:425
noisy false:394
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 819
epoch [41/200] batch [5/24] time 0.179 (0.187) data 0.103 (0.112) loss_x loss_x 0.4563 (0.5062) acc_x 90.6250 (88.1250) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/24] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.5869 (0.5478) acc_x 84.3750 (86.2500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/24] time 0.170 (0.181) data 0.093 (0.105) loss_x loss_x 0.5112 (0.4992) acc_x 78.1250 (87.2917) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/24] time 0.182 (0.178) data 0.106 (0.102) loss_x loss_x 0.4067 (0.4799) acc_x 87.5000 (87.5000) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/25] time 0.173 (0.175) data 0.096 (0.099) loss_u loss_u 0.8257 (0.8733) acc_u 21.8750 (15.6250) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/25] time 0.175 (0.175) data 0.097 (0.098) loss_u loss_u 0.8970 (0.8614) acc_u 9.3750 (16.2500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/25] time 0.183 (0.175) data 0.106 (0.099) loss_u loss_u 0.7993 (0.8598) acc_u 25.0000 (16.6667) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/25] time 0.180 (0.178) data 0.103 (0.101) loss_u loss_u 0.8467 (0.8716) acc_u 18.7500 (15.1562) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [25/25] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.7559 (0.8600) acc_u 31.2500 (16.1250) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 805
clean true:800
clean false:5
clean_rate:0.9937888198757764
noisy true:425
noisy false:370
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 795
epoch [42/200] batch [5/25] time 0.170 (0.180) data 0.093 (0.104) loss_x loss_x 1.0674 (0.7430) acc_x 75.0000 (81.2500) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/25] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 0.2754 (0.6422) acc_x 96.8750 (84.0625) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/25] time 0.181 (0.178) data 0.105 (0.101) loss_x loss_x 0.3794 (0.6140) acc_x 84.3750 (84.7917) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/25] time 0.180 (0.179) data 0.104 (0.102) loss_x loss_x 0.7202 (0.6370) acc_x 84.3750 (84.5312) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [25/25] time 0.181 (0.179) data 0.105 (0.103) loss_x loss_x 0.5610 (0.6331) acc_x 81.2500 (83.6250) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/24] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.8657 (0.8570) acc_u 12.5000 (15.0000) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/24] time 0.179 (0.178) data 0.102 (0.102) loss_u loss_u 0.9448 (0.8677) acc_u 6.2500 (14.3750) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/24] time 0.201 (0.179) data 0.124 (0.103) loss_u loss_u 0.9512 (0.8704) acc_u 6.2500 (14.3750) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/24] time 0.174 (0.180) data 0.098 (0.104) loss_u loss_u 0.6797 (0.8673) acc_u 34.3750 (14.6875) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.5100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 816
clean true:811
clean false:5
clean_rate:0.9938725490196079
noisy true:429
noisy false:355
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 784
epoch [43/200] batch [5/25] time 0.185 (0.180) data 0.109 (0.104) loss_x loss_x 0.3862 (0.5950) acc_x 90.6250 (85.0000) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/25] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.5723 (0.6473) acc_x 84.3750 (83.7500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/25] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.6465 (0.6324) acc_x 84.3750 (84.3750) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/25] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.3406 (0.6537) acc_x 90.6250 (84.5312) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [25/25] time 0.180 (0.182) data 0.105 (0.106) loss_x loss_x 0.6201 (0.6561) acc_x 84.3750 (83.7500) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/24] time 0.182 (0.182) data 0.106 (0.106) loss_u loss_u 0.9229 (0.8944) acc_u 9.3750 (12.5000) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/24] time 0.183 (0.181) data 0.106 (0.105) loss_u loss_u 0.8047 (0.8898) acc_u 21.8750 (13.4375) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/24] time 0.180 (0.181) data 0.103 (0.105) loss_u loss_u 0.8560 (0.8910) acc_u 21.8750 (13.5417) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/24] time 0.182 (0.181) data 0.106 (0.105) loss_u loss_u 0.8408 (0.8942) acc_u 18.7500 (12.8125) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.5069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 811
clean true:807
clean false:4
clean_rate:0.9950678175092479
noisy true:428
noisy false:361
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 789
epoch [44/200] batch [5/25] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 0.7344 (0.6793) acc_x 84.3750 (83.7500) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/25] time 0.183 (0.182) data 0.108 (0.106) loss_x loss_x 0.7783 (0.6166) acc_x 78.1250 (83.4375) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/25] time 0.182 (0.182) data 0.107 (0.106) loss_x loss_x 0.2859 (0.5813) acc_x 93.7500 (84.5833) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/25] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.6538 (0.5911) acc_x 84.3750 (83.7500) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [25/25] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.5264 (0.5668) acc_x 81.2500 (84.7500) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/24] time 0.176 (0.182) data 0.100 (0.106) loss_u loss_u 0.9209 (0.8814) acc_u 9.3750 (13.1250) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/24] time 0.183 (0.181) data 0.107 (0.106) loss_u loss_u 0.8003 (0.8736) acc_u 25.0000 (14.3750) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/24] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.8574 (0.8647) acc_u 15.6250 (15.4167) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/24] time 0.187 (0.182) data 0.111 (0.106) loss_u loss_u 0.8892 (0.8761) acc_u 12.5000 (13.9062) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 790
clean true:786
clean false:4
clean_rate:0.9949367088607595
noisy true:433
noisy false:377
after delete: len(clean_dataset) 790
after delete: len(noisy_dataset) 810
epoch [45/200] batch [5/24] time 0.177 (0.186) data 0.101 (0.109) loss_x loss_x 0.2778 (0.4773) acc_x 93.7500 (87.5000) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/24] time 0.176 (0.181) data 0.100 (0.105) loss_x loss_x 0.7178 (0.5407) acc_x 78.1250 (85.3125) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/24] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.3918 (0.5322) acc_x 90.6250 (86.0417) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/24] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.9106 (0.5458) acc_x 87.5000 (86.0938) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/25] time 0.182 (0.183) data 0.105 (0.107) loss_u loss_u 0.8057 (0.8867) acc_u 21.8750 (11.2500) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/25] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.8726 (0.8844) acc_u 15.6250 (12.5000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/25] time 0.179 (0.183) data 0.103 (0.107) loss_u loss_u 0.8213 (0.8728) acc_u 18.7500 (13.9583) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/25] time 0.212 (0.184) data 0.136 (0.107) loss_u loss_u 0.8784 (0.8530) acc_u 12.5000 (16.0938) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [25/25] time 0.181 (0.184) data 0.105 (0.107) loss_u loss_u 0.9307 (0.8547) acc_u 6.2500 (15.8750) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.4937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 790
clean true:785
clean false:5
clean_rate:0.9936708860759493
noisy true:424
noisy false:386
after delete: len(clean_dataset) 790
after delete: len(noisy_dataset) 810
epoch [46/200] batch [5/24] time 0.167 (0.175) data 0.091 (0.099) loss_x loss_x 0.6968 (0.7204) acc_x 84.3750 (85.0000) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/24] time 0.183 (0.180) data 0.107 (0.104) loss_x loss_x 0.5972 (0.7084) acc_x 84.3750 (83.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/24] time 0.180 (0.180) data 0.105 (0.104) loss_x loss_x 0.6929 (0.6735) acc_x 78.1250 (84.1667) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/24] time 0.184 (0.181) data 0.108 (0.105) loss_x loss_x 0.3928 (0.6767) acc_x 90.6250 (83.7500) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/25] time 0.187 (0.181) data 0.111 (0.105) loss_u loss_u 0.9336 (0.8558) acc_u 6.2500 (15.6250) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/25] time 0.180 (0.181) data 0.104 (0.105) loss_u loss_u 0.8838 (0.8570) acc_u 15.6250 (15.9375) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/25] time 0.183 (0.181) data 0.107 (0.105) loss_u loss_u 0.8931 (0.8548) acc_u 9.3750 (16.0417) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/25] time 0.178 (0.181) data 0.102 (0.105) loss_u loss_u 0.9585 (0.8700) acc_u 6.2500 (14.5312) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [25/25] time 0.186 (0.181) data 0.110 (0.105) loss_u loss_u 0.9375 (0.8650) acc_u 9.3750 (15.1250) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:810
clean false:3
clean_rate:0.996309963099631
noisy true:436
noisy false:351
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [47/200] batch [5/25] time 0.185 (0.182) data 0.109 (0.106) loss_x loss_x 0.4011 (0.6540) acc_x 81.2500 (78.7500) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/25] time 0.177 (0.181) data 0.101 (0.105) loss_x loss_x 0.7583 (0.5812) acc_x 81.2500 (81.5625) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/25] time 0.182 (0.181) data 0.107 (0.105) loss_x loss_x 0.9072 (0.6381) acc_x 71.8750 (81.6667) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/25] time 0.187 (0.182) data 0.111 (0.106) loss_x loss_x 0.7939 (0.6254) acc_x 84.3750 (82.3438) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [25/25] time 0.178 (0.182) data 0.102 (0.106) loss_x loss_x 0.3335 (0.5965) acc_x 90.6250 (82.8750) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/24] time 0.185 (0.182) data 0.108 (0.107) loss_u loss_u 0.9043 (0.8790) acc_u 12.5000 (12.5000) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/24] time 0.182 (0.182) data 0.106 (0.107) loss_u loss_u 0.9043 (0.8806) acc_u 12.5000 (13.4375) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/24] time 0.180 (0.182) data 0.104 (0.106) loss_u loss_u 0.8428 (0.8832) acc_u 21.8750 (13.1250) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/24] time 0.182 (0.182) data 0.106 (0.106) loss_u loss_u 0.9023 (0.8875) acc_u 12.5000 (12.6562) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 799
clean true:796
clean false:3
clean_rate:0.9962453066332916
noisy true:427
noisy false:374
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 801
epoch [48/200] batch [5/24] time 0.184 (0.181) data 0.108 (0.106) loss_x loss_x 0.8770 (0.7021) acc_x 81.2500 (80.0000) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/24] time 0.181 (0.185) data 0.105 (0.109) loss_x loss_x 0.3816 (0.6577) acc_x 93.7500 (81.8750) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/24] time 0.181 (0.183) data 0.106 (0.108) loss_x loss_x 0.6172 (0.6540) acc_x 81.2500 (81.8750) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/24] time 0.180 (0.183) data 0.105 (0.107) loss_x loss_x 0.6064 (0.6617) acc_x 87.5000 (82.3438) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/25] time 0.182 (0.184) data 0.107 (0.108) loss_u loss_u 0.9346 (0.8954) acc_u 6.2500 (11.2500) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/25] time 0.179 (0.183) data 0.102 (0.108) loss_u loss_u 0.8447 (0.8860) acc_u 18.7500 (12.5000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/25] time 0.181 (0.183) data 0.104 (0.108) loss_u loss_u 0.8574 (0.8659) acc_u 15.6250 (14.7917) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/25] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.8408 (0.8617) acc_u 15.6250 (15.3125) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [25/25] time 0.202 (0.183) data 0.126 (0.108) loss_u loss_u 0.8574 (0.8647) acc_u 18.7500 (15.2500) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 791
clean true:787
clean false:4
clean_rate:0.9949431099873578
noisy true:427
noisy false:382
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 809
epoch [49/200] batch [5/24] time 0.222 (0.195) data 0.147 (0.119) loss_x loss_x 0.5381 (0.7421) acc_x 90.6250 (83.7500) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/24] time 0.186 (0.189) data 0.110 (0.113) loss_x loss_x 0.3723 (0.5429) acc_x 93.7500 (87.8125) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/24] time 0.182 (0.187) data 0.106 (0.111) loss_x loss_x 0.5537 (0.5546) acc_x 81.2500 (86.8750) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/24] time 0.184 (0.186) data 0.108 (0.111) loss_x loss_x 0.4631 (0.5833) acc_x 87.5000 (85.4688) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/25] time 0.185 (0.186) data 0.108 (0.110) loss_u loss_u 0.8745 (0.8600) acc_u 15.6250 (17.5000) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/25] time 0.181 (0.186) data 0.104 (0.109) loss_u loss_u 0.8735 (0.8550) acc_u 12.5000 (17.1875) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/25] time 0.181 (0.185) data 0.104 (0.109) loss_u loss_u 0.9326 (0.8533) acc_u 9.3750 (16.6667) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/25] time 0.178 (0.185) data 0.102 (0.109) loss_u loss_u 0.8687 (0.8504) acc_u 12.5000 (16.8750) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [25/25] time 0.182 (0.185) data 0.104 (0.108) loss_u loss_u 0.9136 (0.8513) acc_u 6.2500 (16.3750) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 803
clean true:801
clean false:2
clean_rate:0.9975093399750934
noisy true:431
noisy false:366
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 797
epoch [50/200] batch [5/25] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.5034 (0.5764) acc_x 87.5000 (84.3750) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/25] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.5093 (0.6502) acc_x 87.5000 (84.0625) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/25] time 0.170 (0.178) data 0.094 (0.102) loss_x loss_x 0.8525 (0.6378) acc_x 78.1250 (83.5417) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/25] time 0.178 (0.177) data 0.102 (0.100) loss_x loss_x 0.5752 (0.6094) acc_x 84.3750 (83.5938) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [25/25] time 0.176 (0.176) data 0.099 (0.100) loss_x loss_x 0.7573 (0.6114) acc_x 78.1250 (82.6250) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/24] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.8687 (0.8677) acc_u 12.5000 (15.0000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/24] time 0.179 (0.179) data 0.103 (0.103) loss_u loss_u 0.7881 (0.8548) acc_u 21.8750 (16.5625) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/24] time 0.184 (0.179) data 0.108 (0.103) loss_u loss_u 0.7593 (0.8431) acc_u 25.0000 (17.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/24] time 0.185 (0.180) data 0.109 (0.104) loss_u loss_u 0.8403 (0.8436) acc_u 18.7500 (17.8125) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:811
clean false:4
clean_rate:0.9950920245398773
noisy true:421
noisy false:364
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [51/200] batch [5/25] time 0.185 (0.181) data 0.109 (0.105) loss_x loss_x 0.8169 (0.6835) acc_x 78.1250 (84.3750) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/25] time 0.184 (0.181) data 0.108 (0.105) loss_x loss_x 0.5068 (0.6858) acc_x 81.2500 (82.8125) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/25] time 0.181 (0.182) data 0.106 (0.106) loss_x loss_x 0.7935 (0.6143) acc_x 78.1250 (84.1667) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/25] time 0.183 (0.182) data 0.108 (0.106) loss_x loss_x 0.7046 (0.6083) acc_x 78.1250 (82.9688) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [25/25] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.4338 (0.5852) acc_x 87.5000 (83.6250) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/24] time 0.182 (0.183) data 0.106 (0.107) loss_u loss_u 0.6860 (0.8023) acc_u 34.3750 (23.1250) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/24] time 0.184 (0.183) data 0.108 (0.107) loss_u loss_u 0.9214 (0.8451) acc_u 6.2500 (17.5000) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/24] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.9287 (0.8631) acc_u 9.3750 (15.2083) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/24] time 0.184 (0.183) data 0.108 (0.107) loss_u loss_u 0.9297 (0.8728) acc_u 9.3750 (14.3750) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 802
clean true:795
clean false:7
clean_rate:0.9912718204488778
noisy true:432
noisy false:366
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 798
epoch [52/200] batch [5/25] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.3337 (0.5734) acc_x 87.5000 (83.1250) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/25] time 0.180 (0.182) data 0.104 (0.107) loss_x loss_x 1.0137 (0.6237) acc_x 71.8750 (82.8125) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/25] time 0.183 (0.182) data 0.107 (0.107) loss_x loss_x 0.4717 (0.6222) acc_x 87.5000 (83.9583) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/25] time 0.186 (0.183) data 0.111 (0.107) loss_x loss_x 0.5562 (0.6332) acc_x 84.3750 (84.2188) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [25/25] time 0.182 (0.183) data 0.107 (0.107) loss_x loss_x 0.8770 (0.6311) acc_x 81.2500 (84.2500) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/24] time 0.184 (0.183) data 0.107 (0.108) loss_u loss_u 0.8120 (0.8215) acc_u 18.7500 (18.7500) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/24] time 0.158 (0.182) data 0.082 (0.107) loss_u loss_u 0.8438 (0.8519) acc_u 18.7500 (16.2500) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/24] time 0.169 (0.181) data 0.093 (0.105) loss_u loss_u 0.8301 (0.8513) acc_u 18.7500 (16.8750) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/24] time 0.182 (0.181) data 0.105 (0.105) loss_u loss_u 0.8418 (0.8503) acc_u 18.7500 (17.0312) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 805
clean true:802
clean false:3
clean_rate:0.9962732919254659
noisy true:428
noisy false:367
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 795
epoch [53/200] batch [5/25] time 0.219 (0.198) data 0.142 (0.122) loss_x loss_x 0.7158 (0.6131) acc_x 84.3750 (84.3750) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/25] time 0.181 (0.193) data 0.105 (0.117) loss_x loss_x 0.3948 (0.5214) acc_x 93.7500 (85.3125) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/25] time 0.176 (0.186) data 0.100 (0.110) loss_x loss_x 0.2242 (0.4919) acc_x 93.7500 (86.4583) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/25] time 0.189 (0.185) data 0.113 (0.109) loss_x loss_x 0.1387 (0.5119) acc_x 93.7500 (85.6250) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [25/25] time 0.190 (0.186) data 0.114 (0.110) loss_x loss_x 0.5474 (0.5385) acc_x 87.5000 (85.3750) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/24] time 0.181 (0.185) data 0.104 (0.108) loss_u loss_u 0.8867 (0.8479) acc_u 12.5000 (17.5000) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/24] time 0.179 (0.185) data 0.102 (0.108) loss_u loss_u 0.8604 (0.8599) acc_u 15.6250 (15.9375) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/24] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9136 (0.8543) acc_u 9.3750 (16.6667) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/24] time 0.179 (0.183) data 0.103 (0.106) loss_u loss_u 0.9102 (0.8575) acc_u 9.3750 (16.0938) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.5131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 821
clean true:816
clean false:5
clean_rate:0.9939098660170523
noisy true:432
noisy false:347
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 779
epoch [54/200] batch [5/25] time 0.179 (0.204) data 0.103 (0.128) loss_x loss_x 0.4294 (0.6063) acc_x 87.5000 (83.7500) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/25] time 0.183 (0.192) data 0.106 (0.116) loss_x loss_x 0.3738 (0.5380) acc_x 87.5000 (85.6250) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/25] time 0.174 (0.187) data 0.097 (0.111) loss_x loss_x 0.6475 (0.5123) acc_x 78.1250 (86.2500) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/25] time 0.190 (0.186) data 0.113 (0.110) loss_x loss_x 0.3921 (0.4989) acc_x 90.6250 (86.5625) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [25/25] time 0.185 (0.185) data 0.108 (0.109) loss_x loss_x 0.7495 (0.4935) acc_x 81.2500 (87.2500) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/24] time 0.184 (0.185) data 0.107 (0.109) loss_u loss_u 0.9399 (0.8583) acc_u 6.2500 (15.6250) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/24] time 0.200 (0.185) data 0.123 (0.109) loss_u loss_u 0.9062 (0.8777) acc_u 9.3750 (13.1250) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/24] time 0.179 (0.185) data 0.103 (0.108) loss_u loss_u 0.8350 (0.8705) acc_u 18.7500 (13.9583) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/24] time 0.182 (0.183) data 0.105 (0.107) loss_u loss_u 0.9346 (0.8774) acc_u 9.3750 (13.4375) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 814
clean true:807
clean false:7
clean_rate:0.9914004914004914
noisy true:422
noisy false:364
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 786
epoch [55/200] batch [5/25] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.9126 (0.5243) acc_x 75.0000 (86.8750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/25] time 0.183 (0.182) data 0.108 (0.107) loss_x loss_x 0.2382 (0.4649) acc_x 93.7500 (87.8125) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/25] time 0.177 (0.181) data 0.101 (0.105) loss_x loss_x 1.0605 (0.5165) acc_x 71.8750 (85.8333) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [20/25] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.3987 (0.5188) acc_x 84.3750 (85.6250) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [25/25] time 0.189 (0.182) data 0.112 (0.106) loss_x loss_x 0.7295 (0.5593) acc_x 81.2500 (85.0000) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/24] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.8540 (0.8960) acc_u 15.6250 (11.2500) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/24] time 0.184 (0.183) data 0.108 (0.106) loss_u loss_u 0.9111 (0.8915) acc_u 9.3750 (11.5625) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/24] time 0.186 (0.183) data 0.109 (0.107) loss_u loss_u 0.9551 (0.8795) acc_u 6.2500 (12.9167) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [20/24] time 0.180 (0.183) data 0.103 (0.106) loss_u loss_u 0.8164 (0.8743) acc_u 18.7500 (13.5938) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:809
clean false:4
clean_rate:0.995079950799508
noisy true:416
noisy false:371
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [56/200] batch [5/25] time 0.204 (0.188) data 0.128 (0.112) loss_x loss_x 0.5000 (0.6501) acc_x 84.3750 (83.1250) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/25] time 0.180 (0.185) data 0.105 (0.109) loss_x loss_x 0.5088 (0.5754) acc_x 84.3750 (84.3750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/25] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.6978 (0.5790) acc_x 84.3750 (84.7917) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/25] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.5527 (0.5553) acc_x 90.6250 (85.6250) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [25/25] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.3650 (0.5427) acc_x 90.6250 (86.0000) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/24] time 0.182 (0.182) data 0.106 (0.107) loss_u loss_u 0.8696 (0.8570) acc_u 12.5000 (15.0000) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/24] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.9028 (0.8665) acc_u 12.5000 (14.0625) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/24] time 0.184 (0.182) data 0.108 (0.106) loss_u loss_u 0.8428 (0.8561) acc_u 18.7500 (15.8333) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/24] time 0.184 (0.182) data 0.108 (0.106) loss_u loss_u 0.9463 (0.8608) acc_u 3.1250 (15.4688) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 816
clean true:811
clean false:5
clean_rate:0.9938725490196079
noisy true:453
noisy false:331
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 784
epoch [57/200] batch [5/25] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.8066 (0.8142) acc_x 81.2500 (81.2500) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/25] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 1.1465 (0.7527) acc_x 68.7500 (81.2500) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/25] time 0.179 (0.182) data 0.104 (0.106) loss_x loss_x 0.7266 (0.6985) acc_x 87.5000 (82.7083) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/25] time 0.178 (0.182) data 0.102 (0.106) loss_x loss_x 0.4878 (0.6670) acc_x 87.5000 (83.9062) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [25/25] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.3875 (0.6526) acc_x 87.5000 (84.1250) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/24] time 0.191 (0.181) data 0.115 (0.105) loss_u loss_u 0.9307 (0.8652) acc_u 6.2500 (15.6250) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/24] time 0.223 (0.185) data 0.147 (0.109) loss_u loss_u 0.8564 (0.8444) acc_u 15.6250 (17.5000) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/24] time 0.189 (0.185) data 0.113 (0.109) loss_u loss_u 0.8833 (0.8648) acc_u 12.5000 (15.6250) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/24] time 0.183 (0.185) data 0.107 (0.109) loss_u loss_u 0.8154 (0.8650) acc_u 21.8750 (15.4688) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 338
confident_label rate tensor(0.5100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 816
clean true:814
clean false:2
clean_rate:0.9975490196078431
noisy true:448
noisy false:336
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 784
epoch [58/200] batch [5/25] time 0.185 (0.189) data 0.109 (0.112) loss_x loss_x 0.8071 (0.6071) acc_x 81.2500 (83.7500) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/25] time 0.188 (0.186) data 0.112 (0.110) loss_x loss_x 0.3240 (0.6019) acc_x 84.3750 (81.8750) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/25] time 0.181 (0.186) data 0.105 (0.110) loss_x loss_x 0.5239 (0.5806) acc_x 90.6250 (83.5417) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/25] time 0.180 (0.185) data 0.104 (0.109) loss_x loss_x 0.4016 (0.5725) acc_x 90.6250 (83.4375) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [25/25] time 0.184 (0.184) data 0.108 (0.109) loss_x loss_x 0.3647 (0.5607) acc_x 87.5000 (83.3750) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/24] time 0.176 (0.184) data 0.100 (0.108) loss_u loss_u 0.8687 (0.8672) acc_u 12.5000 (14.3750) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/24] time 0.183 (0.184) data 0.107 (0.108) loss_u loss_u 0.8979 (0.8855) acc_u 15.6250 (13.4375) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/24] time 0.190 (0.184) data 0.114 (0.108) loss_u loss_u 0.7998 (0.8805) acc_u 25.0000 (13.5417) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/24] time 0.178 (0.184) data 0.102 (0.108) loss_u loss_u 0.8252 (0.8791) acc_u 21.8750 (14.0625) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 821
clean true:813
clean false:8
clean_rate:0.9902557856272838
noisy true:451
noisy false:328
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 779
epoch [59/200] batch [5/25] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.6733 (0.5520) acc_x 75.0000 (80.0000) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/25] time 0.181 (0.197) data 0.106 (0.121) loss_x loss_x 0.2388 (0.5325) acc_x 96.8750 (82.8125) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/25] time 0.163 (0.192) data 0.086 (0.116) loss_x loss_x 0.7295 (0.5389) acc_x 78.1250 (83.3333) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/25] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.5640 (0.5221) acc_x 81.2500 (84.2188) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [25/25] time 0.181 (0.186) data 0.106 (0.109) loss_x loss_x 0.3523 (0.5315) acc_x 93.7500 (84.5000) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/24] time 0.188 (0.185) data 0.112 (0.109) loss_u loss_u 0.9585 (0.8665) acc_u 6.2500 (15.0000) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/24] time 0.179 (0.185) data 0.103 (0.109) loss_u loss_u 0.8403 (0.8625) acc_u 18.7500 (15.3125) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/24] time 0.181 (0.185) data 0.105 (0.109) loss_u loss_u 0.8374 (0.8639) acc_u 15.6250 (15.0000) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/24] time 0.184 (0.185) data 0.108 (0.108) loss_u loss_u 0.9326 (0.8642) acc_u 6.2500 (15.0000) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 802
clean true:798
clean false:4
clean_rate:0.9950124688279302
noisy true:431
noisy false:367
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 798
epoch [60/200] batch [5/25] time 0.206 (0.185) data 0.130 (0.109) loss_x loss_x 0.5347 (0.5218) acc_x 84.3750 (83.1250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/25] time 0.171 (0.181) data 0.094 (0.105) loss_x loss_x 0.3164 (0.5467) acc_x 90.6250 (83.4375) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/25] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.4148 (0.5946) acc_x 84.3750 (83.9583) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/25] time 0.194 (0.182) data 0.118 (0.106) loss_x loss_x 0.5356 (0.5730) acc_x 87.5000 (85.3125) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [25/25] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.3665 (0.5605) acc_x 87.5000 (85.5000) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/24] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.8325 (0.8124) acc_u 15.6250 (21.2500) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/24] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.7808 (0.8402) acc_u 21.8750 (17.8125) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/24] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.8301 (0.8433) acc_u 21.8750 (17.7083) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/24] time 0.180 (0.182) data 0.104 (0.106) loss_u loss_u 0.7798 (0.8391) acc_u 25.0000 (18.1250) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 827
clean true:820
clean false:7
clean_rate:0.9915356711003628
noisy true:427
noisy false:346
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 773
epoch [61/200] batch [5/25] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.2725 (0.4447) acc_x 90.6250 (88.1250) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/25] time 0.185 (0.183) data 0.109 (0.108) loss_x loss_x 0.5127 (0.3992) acc_x 90.6250 (90.9375) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/25] time 0.183 (0.184) data 0.108 (0.109) loss_x loss_x 0.4475 (0.5071) acc_x 87.5000 (87.7083) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/25] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.3503 (0.5294) acc_x 93.7500 (87.1875) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [25/25] time 0.184 (0.183) data 0.108 (0.108) loss_x loss_x 0.5947 (0.5557) acc_x 87.5000 (86.7500) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/24] time 0.178 (0.184) data 0.102 (0.108) loss_u loss_u 0.8232 (0.8186) acc_u 15.6250 (19.3750) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/24] time 0.187 (0.184) data 0.111 (0.108) loss_u loss_u 0.8477 (0.8491) acc_u 18.7500 (16.5625) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/24] time 0.174 (0.184) data 0.098 (0.108) loss_u loss_u 0.8472 (0.8564) acc_u 18.7500 (15.8333) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/24] time 0.171 (0.182) data 0.094 (0.106) loss_u loss_u 0.7969 (0.8594) acc_u 21.8750 (15.4688) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 345
confident_label rate tensor(0.5169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 827
clean true:819
clean false:8
clean_rate:0.9903264812575574
noisy true:436
noisy false:337
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 773
epoch [62/200] batch [5/25] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.4802 (0.4197) acc_x 81.2500 (88.1250) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/25] time 0.191 (0.183) data 0.115 (0.107) loss_x loss_x 0.4724 (0.4666) acc_x 78.1250 (85.9375) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/25] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.6118 (0.5299) acc_x 87.5000 (86.0417) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/25] time 0.178 (0.183) data 0.102 (0.107) loss_x loss_x 0.9570 (0.5415) acc_x 78.1250 (85.9375) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [25/25] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.3352 (0.5467) acc_x 87.5000 (85.6250) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/24] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.8438 (0.8567) acc_u 15.6250 (15.6250) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/24] time 0.180 (0.182) data 0.104 (0.106) loss_u loss_u 0.8813 (0.8663) acc_u 12.5000 (14.3750) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/24] time 0.185 (0.182) data 0.109 (0.106) loss_u loss_u 0.8931 (0.8650) acc_u 12.5000 (14.1667) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/24] time 0.183 (0.182) data 0.107 (0.106) loss_u loss_u 0.8179 (0.8655) acc_u 18.7500 (14.3750) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 330
confident_label rate tensor(0.5225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 836
clean true:831
clean false:5
clean_rate:0.9940191387559809
noisy true:439
noisy false:325
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 764
epoch [63/200] batch [5/26] time 0.190 (0.186) data 0.114 (0.110) loss_x loss_x 0.6343 (0.5271) acc_x 78.1250 (85.0000) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/26] time 0.161 (0.183) data 0.085 (0.107) loss_x loss_x 0.6392 (0.6113) acc_x 87.5000 (85.3125) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/26] time 0.173 (0.181) data 0.097 (0.105) loss_x loss_x 0.3220 (0.6010) acc_x 90.6250 (85.6250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/26] time 0.188 (0.181) data 0.112 (0.105) loss_x loss_x 0.1698 (0.6207) acc_x 100.0000 (85.1562) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/26] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.4854 (0.5935) acc_x 84.3750 (85.5000) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/23] time 0.179 (0.180) data 0.102 (0.104) loss_u loss_u 0.8921 (0.8695) acc_u 12.5000 (15.6250) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/23] time 0.189 (0.180) data 0.112 (0.104) loss_u loss_u 0.9258 (0.8812) acc_u 12.5000 (13.7500) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/23] time 0.207 (0.180) data 0.131 (0.103) loss_u loss_u 0.9531 (0.8896) acc_u 6.2500 (13.1250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/23] time 0.184 (0.182) data 0.108 (0.106) loss_u loss_u 0.9102 (0.8917) acc_u 9.3750 (12.3438) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:800
clean false:7
clean_rate:0.9913258983890955
noisy true:402
noisy false:391
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [64/200] batch [5/25] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.2935 (0.3979) acc_x 93.7500 (89.3750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/25] time 0.182 (0.183) data 0.106 (0.108) loss_x loss_x 0.4412 (0.4986) acc_x 90.6250 (86.8750) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/25] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.5269 (0.5387) acc_x 84.3750 (85.8333) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/25] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.2866 (0.5314) acc_x 90.6250 (85.9375) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [25/25] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.4436 (0.5236) acc_x 84.3750 (86.3750) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/24] time 0.182 (0.184) data 0.106 (0.107) loss_u loss_u 0.8188 (0.8398) acc_u 18.7500 (16.8750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/24] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.8330 (0.8548) acc_u 21.8750 (15.9375) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/24] time 0.185 (0.184) data 0.109 (0.108) loss_u loss_u 0.8516 (0.8598) acc_u 18.7500 (15.6250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/24] time 0.177 (0.184) data 0.101 (0.108) loss_u loss_u 0.9019 (0.8564) acc_u 12.5000 (15.9375) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 814
clean true:809
clean false:5
clean_rate:0.9938574938574939
noisy true:422
noisy false:364
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 786
epoch [65/200] batch [5/25] time 0.161 (0.191) data 0.084 (0.115) loss_x loss_x 0.5615 (0.5543) acc_x 84.3750 (86.8750) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/25] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.6821 (0.5016) acc_x 78.1250 (86.8750) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/25] time 0.180 (0.180) data 0.104 (0.104) loss_x loss_x 0.4683 (0.4878) acc_x 87.5000 (87.2917) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/25] time 0.180 (0.180) data 0.103 (0.104) loss_x loss_x 0.5142 (0.5163) acc_x 84.3750 (87.1875) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [25/25] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 0.3821 (0.4958) acc_x 81.2500 (87.1250) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/24] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9321 (0.8544) acc_u 6.2500 (16.8750) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/24] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.8281 (0.8703) acc_u 18.7500 (14.3750) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/24] time 0.159 (0.182) data 0.082 (0.105) loss_u loss_u 0.9004 (0.8581) acc_u 12.5000 (15.8333) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/24] time 0.165 (0.181) data 0.089 (0.104) loss_u loss_u 0.9062 (0.8534) acc_u 9.3750 (16.2500) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 810
clean true:803
clean false:7
clean_rate:0.991358024691358
noisy true:426
noisy false:364
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 790
epoch [66/200] batch [5/25] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.3765 (0.3553) acc_x 87.5000 (89.3750) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/25] time 0.186 (0.184) data 0.110 (0.107) loss_x loss_x 0.9771 (0.4695) acc_x 81.2500 (88.4375) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/25] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.6748 (0.4903) acc_x 84.3750 (88.1250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/25] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.5513 (0.5018) acc_x 81.2500 (87.1875) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [25/25] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.5957 (0.5340) acc_x 84.3750 (86.2500) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/24] time 0.180 (0.184) data 0.104 (0.108) loss_u loss_u 0.8462 (0.8708) acc_u 12.5000 (14.3750) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/24] time 0.182 (0.184) data 0.106 (0.108) loss_u loss_u 0.8770 (0.8778) acc_u 12.5000 (13.4375) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/24] time 0.187 (0.184) data 0.110 (0.108) loss_u loss_u 0.8911 (0.8712) acc_u 12.5000 (14.1667) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/24] time 0.186 (0.185) data 0.109 (0.108) loss_u loss_u 0.7773 (0.8602) acc_u 25.0000 (15.3125) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 355
confident_label rate tensor(0.5119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 819
clean true:811
clean false:8
clean_rate:0.9902319902319903
noisy true:434
noisy false:347
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 781
epoch [67/200] batch [5/25] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.2632 (0.3865) acc_x 90.6250 (89.3750) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/25] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.3743 (0.4354) acc_x 90.6250 (88.4375) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/25] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.3176 (0.5168) acc_x 87.5000 (86.6667) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [20/25] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.3804 (0.5054) acc_x 90.6250 (87.0312) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [25/25] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.2366 (0.5102) acc_x 93.7500 (87.1250) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/24] time 0.179 (0.182) data 0.103 (0.106) loss_u loss_u 0.8599 (0.8569) acc_u 15.6250 (17.5000) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/24] time 0.188 (0.182) data 0.110 (0.106) loss_u loss_u 0.8989 (0.8733) acc_u 12.5000 (15.6250) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/24] time 0.185 (0.182) data 0.108 (0.106) loss_u loss_u 0.8262 (0.8677) acc_u 18.7500 (15.6250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [20/24] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.9297 (0.8650) acc_u 9.3750 (15.9375) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 802
clean true:797
clean false:5
clean_rate:0.9937655860349127
noisy true:426
noisy false:372
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 798
epoch [68/200] batch [5/25] time 0.185 (0.190) data 0.108 (0.113) loss_x loss_x 0.4136 (0.4159) acc_x 93.7500 (87.5000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/25] time 0.183 (0.187) data 0.107 (0.111) loss_x loss_x 0.6064 (0.4407) acc_x 84.3750 (86.8750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/25] time 0.185 (0.186) data 0.108 (0.110) loss_x loss_x 0.2571 (0.4434) acc_x 93.7500 (86.8750) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/25] time 0.180 (0.185) data 0.104 (0.109) loss_x loss_x 0.6499 (0.4652) acc_x 81.2500 (85.6250) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [25/25] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.4263 (0.4842) acc_x 90.6250 (85.6250) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/24] time 0.183 (0.185) data 0.105 (0.108) loss_u loss_u 0.8921 (0.8574) acc_u 12.5000 (16.2500) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/24] time 0.185 (0.185) data 0.109 (0.108) loss_u loss_u 0.7544 (0.8344) acc_u 28.1250 (19.3750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/24] time 0.182 (0.184) data 0.106 (0.108) loss_u loss_u 0.9087 (0.8484) acc_u 9.3750 (17.7083) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/24] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.7476 (0.8427) acc_u 28.1250 (17.9688) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 334
confident_label rate tensor(0.5131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 821
clean true:818
clean false:3
clean_rate:0.9963459196102314
noisy true:448
noisy false:331
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 779
epoch [69/200] batch [5/25] time 0.172 (0.178) data 0.096 (0.102) loss_x loss_x 0.1547 (0.5236) acc_x 96.8750 (84.3750) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/25] time 0.185 (0.179) data 0.109 (0.103) loss_x loss_x 0.5312 (0.5261) acc_x 81.2500 (85.6250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/25] time 0.177 (0.178) data 0.100 (0.102) loss_x loss_x 0.5146 (0.5152) acc_x 90.6250 (86.6667) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/25] time 0.183 (0.179) data 0.106 (0.103) loss_x loss_x 0.5493 (0.5101) acc_x 87.5000 (86.8750) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [25/25] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 0.5718 (0.5164) acc_x 84.3750 (86.2500) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/24] time 0.186 (0.180) data 0.109 (0.104) loss_u loss_u 0.8530 (0.8758) acc_u 15.6250 (14.3750) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/24] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8096 (0.8646) acc_u 21.8750 (15.6250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/24] time 0.175 (0.181) data 0.098 (0.104) loss_u loss_u 0.8467 (0.8629) acc_u 15.6250 (15.6250) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/24] time 0.198 (0.180) data 0.122 (0.103) loss_u loss_u 0.9375 (0.8624) acc_u 6.2500 (15.6250) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 322
confident_label rate tensor(0.5269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 843
clean true:840
clean false:3
clean_rate:0.99644128113879
noisy true:438
noisy false:319
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 757
epoch [70/200] batch [5/26] time 0.180 (0.180) data 0.104 (0.104) loss_x loss_x 0.7173 (0.6193) acc_x 81.2500 (81.8750) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/26] time 0.179 (0.181) data 0.103 (0.105) loss_x loss_x 0.6733 (0.6958) acc_x 84.3750 (81.8750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/26] time 0.186 (0.182) data 0.110 (0.106) loss_x loss_x 0.8267 (0.6526) acc_x 78.1250 (82.9167) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/26] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.5308 (0.6188) acc_x 84.3750 (84.2188) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [25/26] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.3591 (0.5830) acc_x 87.5000 (84.5000) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/23] time 0.191 (0.184) data 0.114 (0.108) loss_u loss_u 0.7686 (0.8532) acc_u 28.1250 (16.8750) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/23] time 0.183 (0.184) data 0.106 (0.108) loss_u loss_u 0.9062 (0.8768) acc_u 9.3750 (13.7500) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/23] time 0.180 (0.184) data 0.104 (0.108) loss_u loss_u 0.8901 (0.8857) acc_u 15.6250 (12.9167) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/23] time 0.179 (0.184) data 0.102 (0.107) loss_u loss_u 0.8115 (0.8785) acc_u 18.7500 (13.5938) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 355
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 808
clean true:805
clean false:3
clean_rate:0.9962871287128713
noisy true:440
noisy false:352
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 792
epoch [71/200] batch [5/25] time 0.174 (0.176) data 0.098 (0.100) loss_x loss_x 0.4211 (0.4961) acc_x 90.6250 (86.8750) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/25] time 0.181 (0.177) data 0.105 (0.101) loss_x loss_x 0.5884 (0.4756) acc_x 87.5000 (88.4375) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/25] time 0.176 (0.175) data 0.100 (0.099) loss_x loss_x 0.4001 (0.4697) acc_x 81.2500 (86.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [20/25] time 0.179 (0.177) data 0.102 (0.101) loss_x loss_x 0.7026 (0.4836) acc_x 81.2500 (87.1875) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [25/25] time 0.190 (0.179) data 0.114 (0.103) loss_x loss_x 0.4189 (0.4920) acc_x 90.6250 (86.8750) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/24] time 0.183 (0.179) data 0.106 (0.103) loss_u loss_u 0.9111 (0.8630) acc_u 9.3750 (15.6250) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/24] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.7593 (0.8537) acc_u 28.1250 (16.5625) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/24] time 0.172 (0.179) data 0.095 (0.102) loss_u loss_u 0.7700 (0.8513) acc_u 28.1250 (16.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [20/24] time 0.167 (0.178) data 0.089 (0.101) loss_u loss_u 0.8521 (0.8509) acc_u 18.7500 (17.3438) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.5194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 831
clean true:826
clean false:5
clean_rate:0.9939831528279182
noisy true:450
noisy false:319
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 769
epoch [72/200] batch [5/25] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.6821 (0.5285) acc_x 81.2500 (86.8750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/25] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 1.0488 (0.5617) acc_x 68.7500 (84.6875) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/25] time 0.178 (0.183) data 0.103 (0.107) loss_x loss_x 1.1328 (0.6089) acc_x 71.8750 (83.9583) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/25] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.7720 (0.6077) acc_x 84.3750 (85.0000) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [25/25] time 0.185 (0.183) data 0.108 (0.107) loss_x loss_x 0.3555 (0.5805) acc_x 87.5000 (85.5000) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/24] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.7959 (0.8280) acc_u 21.8750 (19.3750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/24] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.8999 (0.8394) acc_u 12.5000 (18.1250) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/24] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.9448 (0.8639) acc_u 6.2500 (15.4167) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/24] time 0.179 (0.183) data 0.103 (0.107) loss_u loss_u 0.8413 (0.8643) acc_u 15.6250 (15.0000) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 826
clean true:825
clean false:1
clean_rate:0.9987893462469734
noisy true:418
noisy false:356
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 774
epoch [73/200] batch [5/25] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.7666 (0.7433) acc_x 81.2500 (78.1250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/25] time 0.181 (0.176) data 0.105 (0.100) loss_x loss_x 0.4841 (0.6007) acc_x 87.5000 (82.5000) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/25] time 0.183 (0.177) data 0.107 (0.101) loss_x loss_x 0.4365 (0.5705) acc_x 90.6250 (83.7500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [20/25] time 0.178 (0.179) data 0.101 (0.103) loss_x loss_x 0.3000 (0.5512) acc_x 87.5000 (84.5312) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [25/25] time 0.180 (0.180) data 0.104 (0.104) loss_x loss_x 0.4736 (0.5325) acc_x 84.3750 (84.6250) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/24] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8638 (0.8408) acc_u 15.6250 (17.5000) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/24] time 0.183 (0.181) data 0.106 (0.105) loss_u loss_u 0.8350 (0.8492) acc_u 15.6250 (16.8750) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/24] time 0.183 (0.181) data 0.106 (0.105) loss_u loss_u 0.9644 (0.8604) acc_u 3.1250 (15.4167) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [20/24] time 0.174 (0.181) data 0.097 (0.104) loss_u loss_u 0.8242 (0.8683) acc_u 21.8750 (15.0000) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.5106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 817
clean true:813
clean false:4
clean_rate:0.9951040391676866
noisy true:428
noisy false:355
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 783
epoch [74/200] batch [5/25] time 0.187 (0.181) data 0.111 (0.105) loss_x loss_x 0.8164 (0.5427) acc_x 81.2500 (85.6250) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/25] time 0.179 (0.179) data 0.103 (0.103) loss_x loss_x 0.2238 (0.5416) acc_x 90.6250 (85.6250) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/25] time 0.182 (0.180) data 0.106 (0.104) loss_x loss_x 0.7559 (0.5756) acc_x 87.5000 (85.0000) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [20/25] time 0.182 (0.181) data 0.107 (0.105) loss_x loss_x 0.7446 (0.5872) acc_x 81.2500 (85.1562) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [25/25] time 0.184 (0.181) data 0.108 (0.105) loss_x loss_x 0.2810 (0.5710) acc_x 90.6250 (84.7500) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/24] time 0.183 (0.181) data 0.106 (0.105) loss_u loss_u 0.9365 (0.8863) acc_u 6.2500 (12.5000) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/24] time 0.183 (0.182) data 0.107 (0.106) loss_u loss_u 0.7773 (0.8467) acc_u 25.0000 (16.8750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/24] time 0.189 (0.182) data 0.113 (0.106) loss_u loss_u 0.8677 (0.8513) acc_u 12.5000 (16.0417) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [20/24] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.8711 (0.8604) acc_u 15.6250 (15.0000) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:821
clean false:4
clean_rate:0.9951515151515151
noisy true:414
noisy false:361
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [75/200] batch [5/25] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.5913 (0.8256) acc_x 84.3750 (80.0000) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/25] time 0.184 (0.182) data 0.109 (0.107) loss_x loss_x 0.8252 (0.6857) acc_x 81.2500 (83.4375) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/25] time 0.184 (0.182) data 0.109 (0.106) loss_x loss_x 0.5498 (0.6370) acc_x 84.3750 (84.5833) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/25] time 0.176 (0.179) data 0.101 (0.103) loss_x loss_x 0.5327 (0.5930) acc_x 90.6250 (85.6250) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [25/25] time 0.160 (0.177) data 0.083 (0.101) loss_x loss_x 0.5854 (0.5813) acc_x 84.3750 (85.2500) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/24] time 0.167 (0.175) data 0.089 (0.099) loss_u loss_u 0.9502 (0.8899) acc_u 6.2500 (13.1250) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/24] time 0.183 (0.176) data 0.107 (0.100) loss_u loss_u 0.8989 (0.8796) acc_u 15.6250 (14.0625) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/24] time 0.182 (0.177) data 0.106 (0.101) loss_u loss_u 0.8462 (0.8704) acc_u 15.6250 (14.5833) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/24] time 0.183 (0.178) data 0.107 (0.102) loss_u loss_u 0.8975 (0.8693) acc_u 9.3750 (14.6875) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:809
clean false:4
clean_rate:0.995079950799508
noisy true:435
noisy false:352
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [76/200] batch [5/25] time 0.210 (0.203) data 0.134 (0.127) loss_x loss_x 0.5596 (0.4763) acc_x 84.3750 (86.2500) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [10/25] time 0.212 (0.204) data 0.136 (0.128) loss_x loss_x 0.7471 (0.4772) acc_x 87.5000 (87.5000) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/25] time 0.172 (0.200) data 0.095 (0.124) loss_x loss_x 0.2634 (0.4549) acc_x 96.8750 (87.7083) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/25] time 0.180 (0.192) data 0.104 (0.116) loss_x loss_x 0.4546 (0.4857) acc_x 87.5000 (87.1875) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [25/25] time 0.165 (0.187) data 0.089 (0.111) loss_x loss_x 0.5464 (0.4990) acc_x 87.5000 (86.8750) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/24] time 0.195 (0.185) data 0.117 (0.108) loss_u loss_u 0.7954 (0.8520) acc_u 21.8750 (15.6250) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/24] time 0.172 (0.184) data 0.095 (0.108) loss_u loss_u 0.7988 (0.8465) acc_u 25.0000 (16.5625) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/24] time 0.178 (0.183) data 0.101 (0.107) loss_u loss_u 0.8008 (0.8434) acc_u 21.8750 (17.0833) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/24] time 0.180 (0.182) data 0.104 (0.106) loss_u loss_u 0.7534 (0.8430) acc_u 28.1250 (17.3438) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 337
confident_label rate tensor(0.5206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 833
clean true:830
clean false:3
clean_rate:0.9963985594237695
noisy true:433
noisy false:334
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 767
epoch [77/200] batch [5/26] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.5967 (0.5466) acc_x 90.6250 (86.8750) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/26] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.4434 (0.6089) acc_x 87.5000 (86.8750) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/26] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.5059 (0.6196) acc_x 81.2500 (85.2083) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/26] time 0.182 (0.185) data 0.105 (0.109) loss_x loss_x 0.5581 (0.5956) acc_x 84.3750 (85.6250) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [25/26] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.6650 (0.6043) acc_x 84.3750 (85.2500) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/23] time 0.181 (0.184) data 0.104 (0.108) loss_u loss_u 0.9043 (0.8827) acc_u 15.6250 (15.0000) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/23] time 0.181 (0.184) data 0.104 (0.108) loss_u loss_u 0.8892 (0.8756) acc_u 15.6250 (15.0000) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/23] time 0.186 (0.184) data 0.110 (0.107) loss_u loss_u 0.8149 (0.8751) acc_u 21.8750 (14.7917) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [20/23] time 0.181 (0.183) data 0.105 (0.107) loss_u loss_u 0.8247 (0.8783) acc_u 21.8750 (14.8438) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 832
clean true:826
clean false:6
clean_rate:0.9927884615384616
noisy true:438
noisy false:330
after delete: len(clean_dataset) 832
after delete: len(noisy_dataset) 768
epoch [78/200] batch [5/26] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.4326 (0.4508) acc_x 84.3750 (88.1250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/26] time 0.184 (0.186) data 0.109 (0.110) loss_x loss_x 0.4585 (0.5023) acc_x 90.6250 (87.5000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/26] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.8369 (0.5025) acc_x 81.2500 (87.0833) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/26] time 0.181 (0.185) data 0.106 (0.109) loss_x loss_x 0.5610 (0.5272) acc_x 84.3750 (86.4062) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [25/26] time 0.184 (0.185) data 0.109 (0.109) loss_x loss_x 0.3403 (0.5009) acc_x 93.7500 (86.7500) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/24] time 0.185 (0.185) data 0.109 (0.109) loss_u loss_u 0.8159 (0.8154) acc_u 21.8750 (20.0000) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/24] time 0.184 (0.185) data 0.108 (0.109) loss_u loss_u 0.8745 (0.8623) acc_u 12.5000 (15.3125) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/24] time 0.182 (0.185) data 0.105 (0.109) loss_u loss_u 0.8887 (0.8618) acc_u 12.5000 (15.4167) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/24] time 0.180 (0.184) data 0.104 (0.108) loss_u loss_u 0.8853 (0.8612) acc_u 12.5000 (15.3125) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.5163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 826
clean true:820
clean false:6
clean_rate:0.9927360774818402
noisy true:431
noisy false:343
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 774
epoch [79/200] batch [5/25] time 0.190 (0.184) data 0.115 (0.108) loss_x loss_x 0.3467 (0.5515) acc_x 90.6250 (83.1250) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/25] time 0.186 (0.186) data 0.110 (0.110) loss_x loss_x 0.2827 (0.5286) acc_x 90.6250 (85.6250) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/25] time 0.178 (0.183) data 0.102 (0.107) loss_x loss_x 0.6426 (0.5912) acc_x 84.3750 (83.9583) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/25] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.1892 (0.5612) acc_x 93.7500 (84.3750) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [25/25] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.7231 (0.5719) acc_x 87.5000 (85.0000) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/24] time 0.179 (0.182) data 0.102 (0.105) loss_u loss_u 0.8838 (0.8849) acc_u 15.6250 (13.1250) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/24] time 0.193 (0.182) data 0.116 (0.106) loss_u loss_u 0.8457 (0.8572) acc_u 18.7500 (15.9375) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/24] time 0.197 (0.182) data 0.120 (0.106) loss_u loss_u 0.8994 (0.8664) acc_u 12.5000 (14.7917) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/24] time 0.179 (0.181) data 0.103 (0.104) loss_u loss_u 0.8809 (0.8666) acc_u 12.5000 (14.6875) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 321
confident_label rate tensor(0.5256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 841
clean true:834
clean false:7
clean_rate:0.9916765755053508
noisy true:445
noisy false:314
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 759
epoch [80/200] batch [5/26] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.6294 (0.4807) acc_x 84.3750 (84.3750) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/26] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.1798 (0.4890) acc_x 93.7500 (86.2500) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/26] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.5625 (0.5105) acc_x 93.7500 (87.0833) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/26] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 1.1230 (0.5476) acc_x 81.2500 (87.3438) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [25/26] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.5254 (0.5554) acc_x 90.6250 (86.7500) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/23] time 0.179 (0.182) data 0.103 (0.106) loss_u loss_u 0.8687 (0.8278) acc_u 15.6250 (21.2500) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/23] time 0.184 (0.182) data 0.108 (0.106) loss_u loss_u 0.9180 (0.8644) acc_u 12.5000 (16.5625) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/23] time 0.184 (0.183) data 0.108 (0.107) loss_u loss_u 0.8999 (0.8725) acc_u 9.3750 (15.2083) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [20/23] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.8926 (0.8695) acc_u 15.6250 (15.3125) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 337
confident_label rate tensor(0.5244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 839
clean true:834
clean false:5
clean_rate:0.9940405244338498
noisy true:429
noisy false:332
after delete: len(clean_dataset) 839
after delete: len(noisy_dataset) 761
epoch [81/200] batch [5/26] time 0.187 (0.183) data 0.111 (0.107) loss_x loss_x 0.3835 (0.4874) acc_x 93.7500 (87.5000) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/26] time 0.182 (0.186) data 0.106 (0.110) loss_x loss_x 0.5513 (0.5166) acc_x 84.3750 (87.8125) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/26] time 0.183 (0.185) data 0.107 (0.110) loss_x loss_x 0.8120 (0.5287) acc_x 87.5000 (88.1250) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/26] time 0.175 (0.182) data 0.099 (0.106) loss_x loss_x 0.5137 (0.5412) acc_x 84.3750 (87.8125) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [25/26] time 0.186 (0.181) data 0.109 (0.105) loss_x loss_x 0.8032 (0.5539) acc_x 75.0000 (87.2500) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/23] time 0.184 (0.181) data 0.107 (0.105) loss_u loss_u 0.8872 (0.8844) acc_u 12.5000 (12.5000) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/23] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.7241 (0.8623) acc_u 31.2500 (15.0000) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/23] time 0.186 (0.182) data 0.109 (0.106) loss_u loss_u 0.8486 (0.8615) acc_u 15.6250 (15.4167) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [20/23] time 0.161 (0.181) data 0.085 (0.105) loss_u loss_u 0.8047 (0.8669) acc_u 21.8750 (14.8438) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 338
confident_label rate tensor(0.5163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 826
clean true:823
clean false:3
clean_rate:0.9963680387409201
noisy true:439
noisy false:335
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 774
epoch [82/200] batch [5/25] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.7393 (0.6423) acc_x 78.1250 (83.1250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/25] time 0.187 (0.182) data 0.111 (0.106) loss_x loss_x 0.9521 (0.6245) acc_x 78.1250 (84.0625) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/25] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.4707 (0.6161) acc_x 90.6250 (83.9583) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/25] time 0.174 (0.182) data 0.098 (0.106) loss_x loss_x 0.1759 (0.5705) acc_x 96.8750 (84.8438) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [25/25] time 0.187 (0.181) data 0.111 (0.104) loss_x loss_x 0.3020 (0.5411) acc_x 87.5000 (85.5000) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/24] time 0.201 (0.181) data 0.125 (0.105) loss_u loss_u 0.8394 (0.8771) acc_u 21.8750 (15.0000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/24] time 0.250 (0.188) data 0.174 (0.112) loss_u loss_u 0.8145 (0.8782) acc_u 18.7500 (14.0625) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/24] time 0.220 (0.191) data 0.143 (0.115) loss_u loss_u 0.8057 (0.8577) acc_u 21.8750 (16.0417) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/24] time 0.188 (0.192) data 0.111 (0.116) loss_u loss_u 0.8335 (0.8604) acc_u 18.7500 (16.0938) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.5312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 850
clean true:841
clean false:9
clean_rate:0.9894117647058823
noisy true:418
noisy false:332
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 750
epoch [83/200] batch [5/26] time 0.177 (0.170) data 0.102 (0.094) loss_x loss_x 0.4094 (0.5461) acc_x 90.6250 (85.6250) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/26] time 0.196 (0.182) data 0.121 (0.106) loss_x loss_x 0.3723 (0.4922) acc_x 87.5000 (86.2500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/26] time 0.163 (0.179) data 0.087 (0.103) loss_x loss_x 0.8008 (0.5084) acc_x 81.2500 (86.2500) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/26] time 0.181 (0.178) data 0.104 (0.102) loss_x loss_x 0.5874 (0.4965) acc_x 81.2500 (85.7812) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [25/26] time 0.184 (0.179) data 0.108 (0.103) loss_x loss_x 0.6748 (0.5078) acc_x 84.3750 (85.8750) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/23] time 0.182 (0.180) data 0.105 (0.104) loss_u loss_u 0.8804 (0.8869) acc_u 12.5000 (12.5000) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/23] time 0.174 (0.183) data 0.097 (0.107) loss_u loss_u 0.8965 (0.8845) acc_u 12.5000 (13.1250) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/23] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9282 (0.8783) acc_u 9.3750 (13.7500) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/23] time 0.169 (0.183) data 0.093 (0.107) loss_u loss_u 0.7769 (0.8769) acc_u 25.0000 (14.2188) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.5281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 845
clean true:839
clean false:6
clean_rate:0.9928994082840237
noisy true:420
noisy false:335
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 755
epoch [84/200] batch [5/26] time 0.166 (0.171) data 0.091 (0.095) loss_x loss_x 0.2810 (0.4578) acc_x 93.7500 (90.0000) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/26] time 0.162 (0.168) data 0.086 (0.092) loss_x loss_x 0.5347 (0.4969) acc_x 84.3750 (87.1875) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/26] time 0.162 (0.166) data 0.086 (0.090) loss_x loss_x 0.6958 (0.5351) acc_x 84.3750 (86.0417) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/26] time 0.162 (0.165) data 0.086 (0.089) loss_x loss_x 0.4331 (0.5380) acc_x 90.6250 (85.9375) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [25/26] time 0.162 (0.165) data 0.085 (0.088) loss_x loss_x 0.6538 (0.5592) acc_x 84.3750 (85.7500) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/23] time 0.183 (0.168) data 0.107 (0.091) loss_u loss_u 0.9087 (0.8514) acc_u 9.3750 (15.6250) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/23] time 0.219 (0.172) data 0.143 (0.096) loss_u loss_u 0.9307 (0.8573) acc_u 6.2500 (15.3125) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/23] time 0.223 (0.176) data 0.146 (0.100) loss_u loss_u 0.8896 (0.8717) acc_u 15.6250 (13.9583) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/23] time 0.175 (0.177) data 0.099 (0.101) loss_u loss_u 0.8789 (0.8712) acc_u 12.5000 (13.9062) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 833
clean true:828
clean false:5
clean_rate:0.9939975990396158
noisy true:437
noisy false:330
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 767
epoch [85/200] batch [5/26] time 0.158 (0.184) data 0.082 (0.108) loss_x loss_x 0.6924 (0.5538) acc_x 78.1250 (86.2500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/26] time 0.179 (0.179) data 0.103 (0.102) loss_x loss_x 0.9473 (0.6016) acc_x 87.5000 (85.9375) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/26] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.8228 (0.6114) acc_x 75.0000 (85.4167) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/26] time 0.179 (0.180) data 0.103 (0.104) loss_x loss_x 0.8550 (0.6152) acc_x 68.7500 (84.8438) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [25/26] time 0.183 (0.180) data 0.107 (0.104) loss_x loss_x 0.2952 (0.5883) acc_x 90.6250 (85.1250) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/23] time 0.182 (0.181) data 0.105 (0.105) loss_u loss_u 0.8696 (0.8883) acc_u 12.5000 (13.1250) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/23] time 0.176 (0.181) data 0.099 (0.105) loss_u loss_u 0.8564 (0.8693) acc_u 15.6250 (15.0000) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/23] time 0.168 (0.181) data 0.092 (0.104) loss_u loss_u 0.9507 (0.8767) acc_u 6.2500 (14.1667) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/23] time 0.189 (0.181) data 0.112 (0.104) loss_u loss_u 0.9336 (0.8771) acc_u 6.2500 (14.0625) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.5250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 840
clean true:831
clean false:9
clean_rate:0.9892857142857143
noisy true:409
noisy false:351
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 760
epoch [86/200] batch [5/26] time 0.191 (0.184) data 0.114 (0.108) loss_x loss_x 1.0898 (0.7374) acc_x 81.2500 (84.3750) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/26] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 0.6587 (0.6324) acc_x 90.6250 (86.8750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/26] time 0.180 (0.179) data 0.104 (0.103) loss_x loss_x 0.5566 (0.5870) acc_x 84.3750 (86.4583) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/26] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.4946 (0.5874) acc_x 84.3750 (86.0938) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [25/26] time 0.186 (0.183) data 0.109 (0.107) loss_x loss_x 0.7881 (0.5864) acc_x 90.6250 (86.0000) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/23] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.8213 (0.8584) acc_u 21.8750 (16.2500) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/23] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.8413 (0.8640) acc_u 15.6250 (15.0000) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/23] time 0.182 (0.182) data 0.105 (0.106) loss_u loss_u 0.7954 (0.8598) acc_u 25.0000 (15.8333) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/23] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.9800 (0.8709) acc_u 3.1250 (14.5312) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.5194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 831
clean true:822
clean false:9
clean_rate:0.9891696750902527
noisy true:427
noisy false:342
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 769
epoch [87/200] batch [5/25] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.4617 (0.4514) acc_x 90.6250 (90.0000) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/25] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.3521 (0.4703) acc_x 93.7500 (87.8125) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/25] time 0.184 (0.183) data 0.109 (0.107) loss_x loss_x 0.7031 (0.4796) acc_x 84.3750 (88.1250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/25] time 0.177 (0.181) data 0.101 (0.105) loss_x loss_x 0.3381 (0.4638) acc_x 87.5000 (87.8125) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [25/25] time 0.167 (0.180) data 0.091 (0.104) loss_x loss_x 1.0703 (0.5250) acc_x 75.0000 (86.6250) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/24] time 0.178 (0.179) data 0.101 (0.103) loss_u loss_u 0.8838 (0.8154) acc_u 12.5000 (19.3750) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/24] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9058 (0.8407) acc_u 9.3750 (16.8750) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/24] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.9023 (0.8557) acc_u 9.3750 (15.4167) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/24] time 0.160 (0.180) data 0.083 (0.103) loss_u loss_u 0.8755 (0.8574) acc_u 12.5000 (15.4688) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 317
confident_label rate tensor(0.5244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 839
clean true:834
clean false:5
clean_rate:0.9940405244338498
noisy true:449
noisy false:312
after delete: len(clean_dataset) 839
after delete: len(noisy_dataset) 761
epoch [88/200] batch [5/26] time 0.165 (0.166) data 0.089 (0.090) loss_x loss_x 0.8252 (0.5489) acc_x 81.2500 (86.8750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/26] time 0.162 (0.165) data 0.087 (0.089) loss_x loss_x 0.2115 (0.5368) acc_x 87.5000 (85.6250) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/26] time 0.156 (0.163) data 0.080 (0.087) loss_x loss_x 0.2391 (0.5818) acc_x 93.7500 (84.7917) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/26] time 0.158 (0.163) data 0.081 (0.087) loss_x loss_x 0.5156 (0.6031) acc_x 87.5000 (84.2188) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [25/26] time 0.164 (0.163) data 0.088 (0.087) loss_x loss_x 0.4453 (0.5731) acc_x 84.3750 (84.5000) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/23] time 0.162 (0.163) data 0.086 (0.087) loss_u loss_u 0.8413 (0.8556) acc_u 18.7500 (16.2500) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/23] time 0.158 (0.163) data 0.082 (0.086) loss_u loss_u 0.9146 (0.8635) acc_u 9.3750 (15.3125) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/23] time 0.164 (0.163) data 0.088 (0.087) loss_u loss_u 0.8760 (0.8720) acc_u 15.6250 (14.7917) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/23] time 0.173 (0.163) data 0.096 (0.087) loss_u loss_u 0.8174 (0.8639) acc_u 18.7500 (15.6250) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 358
confident_label rate tensor(0.5188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 830
clean true:823
clean false:7
clean_rate:0.9915662650602409
noisy true:419
noisy false:351
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 770
epoch [89/200] batch [5/25] time 0.171 (0.174) data 0.095 (0.098) loss_x loss_x 0.3372 (0.6567) acc_x 93.7500 (84.3750) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/25] time 0.170 (0.174) data 0.094 (0.098) loss_x loss_x 0.3965 (0.5823) acc_x 93.7500 (85.3125) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/25] time 0.160 (0.170) data 0.084 (0.094) loss_x loss_x 1.1338 (0.6108) acc_x 68.7500 (85.2083) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/25] time 0.159 (0.167) data 0.083 (0.091) loss_x loss_x 0.5942 (0.6043) acc_x 81.2500 (85.3125) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [25/25] time 0.162 (0.166) data 0.086 (0.090) loss_x loss_x 0.3577 (0.5801) acc_x 90.6250 (86.0000) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/24] time 0.166 (0.167) data 0.090 (0.091) loss_u loss_u 0.8931 (0.8521) acc_u 15.6250 (16.8750) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/24] time 0.161 (0.166) data 0.085 (0.090) loss_u loss_u 0.8608 (0.8571) acc_u 15.6250 (15.9375) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/24] time 0.161 (0.166) data 0.085 (0.090) loss_u loss_u 0.7983 (0.8658) acc_u 25.0000 (15.4167) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/24] time 0.162 (0.166) data 0.085 (0.089) loss_u loss_u 0.7817 (0.8632) acc_u 25.0000 (15.3125) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.5288, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 846
clean true:837
clean false:9
clean_rate:0.9893617021276596
noisy true:414
noisy false:340
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 754
epoch [90/200] batch [5/26] time 0.171 (0.169) data 0.095 (0.093) loss_x loss_x 0.1560 (0.4695) acc_x 100.0000 (88.1250) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/26] time 0.158 (0.166) data 0.082 (0.090) loss_x loss_x 0.6333 (0.5691) acc_x 87.5000 (85.6250) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/26] time 0.163 (0.167) data 0.087 (0.091) loss_x loss_x 0.9141 (0.6294) acc_x 75.0000 (84.5833) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/26] time 0.159 (0.165) data 0.083 (0.089) loss_x loss_x 0.6445 (0.5884) acc_x 84.3750 (85.3125) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [25/26] time 0.161 (0.165) data 0.085 (0.089) loss_x loss_x 0.4778 (0.5716) acc_x 90.6250 (85.5000) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/23] time 0.183 (0.167) data 0.107 (0.091) loss_u loss_u 0.8638 (0.8602) acc_u 15.6250 (16.2500) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/23] time 0.177 (0.170) data 0.101 (0.094) loss_u loss_u 0.8369 (0.8715) acc_u 18.7500 (15.0000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/23] time 0.178 (0.172) data 0.102 (0.095) loss_u loss_u 0.8696 (0.8689) acc_u 15.6250 (15.4167) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/23] time 0.185 (0.173) data 0.108 (0.097) loss_u loss_u 0.8452 (0.8681) acc_u 15.6250 (15.1562) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5238, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 838
clean true:831
clean false:7
clean_rate:0.9916467780429594
noisy true:433
noisy false:329
after delete: len(clean_dataset) 838
after delete: len(noisy_dataset) 762
epoch [91/200] batch [5/26] time 0.185 (0.185) data 0.108 (0.109) loss_x loss_x 0.5127 (0.7990) acc_x 84.3750 (81.2500) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/26] time 0.181 (0.187) data 0.105 (0.110) loss_x loss_x 0.3906 (0.6495) acc_x 93.7500 (85.0000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/26] time 0.180 (0.186) data 0.104 (0.109) loss_x loss_x 0.3328 (0.6048) acc_x 93.7500 (85.8333) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/26] time 0.182 (0.185) data 0.106 (0.109) loss_x loss_x 0.5332 (0.5695) acc_x 87.5000 (86.2500) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [25/26] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.5093 (0.5581) acc_x 87.5000 (86.7500) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/23] time 0.177 (0.182) data 0.101 (0.106) loss_u loss_u 0.8809 (0.8497) acc_u 12.5000 (16.8750) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/23] time 0.164 (0.182) data 0.087 (0.105) loss_u loss_u 0.8398 (0.8444) acc_u 18.7500 (17.5000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/23] time 0.211 (0.181) data 0.135 (0.104) loss_u loss_u 0.8857 (0.8556) acc_u 12.5000 (16.2500) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/23] time 0.157 (0.181) data 0.081 (0.105) loss_u loss_u 0.8765 (0.8630) acc_u 15.6250 (15.6250) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 839
clean true:833
clean false:6
clean_rate:0.9928486293206198
noisy true:431
noisy false:330
after delete: len(clean_dataset) 839
after delete: len(noisy_dataset) 761
epoch [92/200] batch [5/26] time 0.183 (0.198) data 0.107 (0.122) loss_x loss_x 0.6108 (0.4729) acc_x 84.3750 (88.7500) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [10/26] time 0.183 (0.190) data 0.107 (0.114) loss_x loss_x 0.3738 (0.4619) acc_x 84.3750 (86.2500) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [15/26] time 0.182 (0.190) data 0.106 (0.114) loss_x loss_x 0.1989 (0.4369) acc_x 96.8750 (87.5000) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/26] time 0.184 (0.189) data 0.108 (0.113) loss_x loss_x 0.5977 (0.4302) acc_x 87.5000 (87.8125) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [25/26] time 0.185 (0.188) data 0.108 (0.112) loss_x loss_x 0.4004 (0.4309) acc_x 90.6250 (87.7500) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/23] time 0.180 (0.187) data 0.104 (0.111) loss_u loss_u 0.8179 (0.8537) acc_u 18.7500 (16.2500) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/23] time 0.181 (0.186) data 0.104 (0.110) loss_u loss_u 0.8560 (0.8643) acc_u 18.7500 (15.6250) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/23] time 0.185 (0.186) data 0.109 (0.110) loss_u loss_u 0.8491 (0.8662) acc_u 15.6250 (15.2083) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/23] time 0.182 (0.186) data 0.106 (0.110) loss_u loss_u 0.9438 (0.8634) acc_u 3.1250 (15.6250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.5362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 858
clean true:852
clean false:6
clean_rate:0.993006993006993
noisy true:422
noisy false:320
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 742
epoch [93/200] batch [5/26] time 0.179 (0.182) data 0.102 (0.106) loss_x loss_x 0.3750 (0.4401) acc_x 87.5000 (88.1250) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/26] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.2302 (0.4388) acc_x 93.7500 (89.0625) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/26] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.3215 (0.4515) acc_x 93.7500 (88.3333) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/26] time 0.194 (0.188) data 0.119 (0.112) loss_x loss_x 0.8687 (0.4949) acc_x 81.2500 (87.3438) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [25/26] time 0.184 (0.187) data 0.108 (0.111) loss_x loss_x 0.8354 (0.4817) acc_x 75.0000 (87.7500) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/23] time 0.186 (0.187) data 0.110 (0.110) loss_u loss_u 0.8394 (0.8773) acc_u 18.7500 (13.7500) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/23] time 0.181 (0.186) data 0.104 (0.109) loss_u loss_u 0.8657 (0.8830) acc_u 12.5000 (13.4375) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/23] time 0.185 (0.185) data 0.109 (0.109) loss_u loss_u 0.8774 (0.8853) acc_u 12.5000 (13.1250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/23] time 0.178 (0.185) data 0.102 (0.109) loss_u loss_u 0.9194 (0.8749) acc_u 9.3750 (14.0625) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.5288, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 846
clean true:840
clean false:6
clean_rate:0.9929078014184397
noisy true:418
noisy false:336
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 754
epoch [94/200] batch [5/26] time 0.194 (0.184) data 0.118 (0.108) loss_x loss_x 0.3770 (0.4661) acc_x 87.5000 (90.0000) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/26] time 0.185 (0.186) data 0.110 (0.111) loss_x loss_x 0.2517 (0.4423) acc_x 96.8750 (90.3125) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/26] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.4065 (0.4861) acc_x 87.5000 (88.7500) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/26] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.2566 (0.5052) acc_x 96.8750 (88.2812) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [25/26] time 0.183 (0.184) data 0.108 (0.109) loss_x loss_x 0.6392 (0.4935) acc_x 78.1250 (88.0000) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/23] time 0.218 (0.188) data 0.141 (0.113) loss_u loss_u 0.8892 (0.8645) acc_u 12.5000 (15.0000) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/23] time 0.170 (0.187) data 0.093 (0.111) loss_u loss_u 0.8628 (0.8664) acc_u 15.6250 (15.0000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/23] time 0.180 (0.186) data 0.103 (0.110) loss_u loss_u 0.8242 (0.8646) acc_u 21.8750 (15.4167) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/23] time 0.172 (0.185) data 0.095 (0.109) loss_u loss_u 0.9175 (0.8650) acc_u 9.3750 (15.1562) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:859
clean false:8
clean_rate:0.9907727797001153
noisy true:434
noisy false:299
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [95/200] batch [5/27] time 0.181 (0.183) data 0.106 (0.107) loss_x loss_x 0.6621 (0.5448) acc_x 84.3750 (88.1250) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/27] time 0.186 (0.183) data 0.110 (0.108) loss_x loss_x 0.4978 (0.4930) acc_x 84.3750 (87.8125) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [15/27] time 0.181 (0.189) data 0.105 (0.114) loss_x loss_x 0.5596 (0.4760) acc_x 84.3750 (87.5000) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/27] time 0.166 (0.185) data 0.091 (0.109) loss_x loss_x 0.4854 (0.4575) acc_x 84.3750 (87.6562) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [25/27] time 0.167 (0.180) data 0.091 (0.105) loss_x loss_x 0.7817 (0.4779) acc_x 84.3750 (87.1250) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/22] time 0.163 (0.176) data 0.087 (0.101) loss_u loss_u 0.8130 (0.8964) acc_u 21.8750 (13.1250) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/22] time 0.159 (0.174) data 0.082 (0.098) loss_u loss_u 0.8994 (0.8790) acc_u 12.5000 (14.0625) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/22] time 0.162 (0.173) data 0.085 (0.097) loss_u loss_u 0.9199 (0.8911) acc_u 12.5000 (12.5000) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/22] time 0.189 (0.173) data 0.113 (0.097) loss_u loss_u 0.9282 (0.8883) acc_u 6.2500 (12.9688) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.5312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 850
clean true:844
clean false:6
clean_rate:0.9929411764705882
noisy true:430
noisy false:320
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 750
epoch [96/200] batch [5/26] time 0.216 (0.192) data 0.139 (0.115) loss_x loss_x 0.6753 (0.6011) acc_x 84.3750 (85.6250) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [10/26] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 0.3335 (0.5414) acc_x 93.7500 (85.9375) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [15/26] time 0.174 (0.185) data 0.097 (0.108) loss_x loss_x 0.5503 (0.5706) acc_x 90.6250 (85.8333) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [20/26] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.2294 (0.5181) acc_x 93.7500 (86.8750) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [25/26] time 0.178 (0.183) data 0.101 (0.107) loss_x loss_x 0.4517 (0.5164) acc_x 90.6250 (87.1250) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/23] time 0.179 (0.183) data 0.102 (0.106) loss_u loss_u 0.8599 (0.8617) acc_u 15.6250 (15.0000) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/23] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.7622 (0.8564) acc_u 25.0000 (16.8750) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/23] time 0.180 (0.183) data 0.103 (0.106) loss_u loss_u 0.8662 (0.8715) acc_u 15.6250 (15.0000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/23] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.8389 (0.8828) acc_u 15.6250 (13.4375) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 843
clean true:839
clean false:4
clean_rate:0.9952550415183867
noisy true:426
noisy false:331
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 757
epoch [97/200] batch [5/26] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.4468 (0.4757) acc_x 87.5000 (88.1250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/26] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.2389 (0.4378) acc_x 96.8750 (89.0625) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/26] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.3992 (0.4504) acc_x 90.6250 (87.9167) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/26] time 0.181 (0.186) data 0.104 (0.110) loss_x loss_x 0.2522 (0.4555) acc_x 90.6250 (87.1875) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [25/26] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.2341 (0.4571) acc_x 96.8750 (87.8750) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/23] time 0.187 (0.185) data 0.110 (0.109) loss_u loss_u 0.8613 (0.8452) acc_u 15.6250 (18.7500) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/23] time 0.177 (0.185) data 0.100 (0.109) loss_u loss_u 0.9541 (0.8574) acc_u 6.2500 (16.2500) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/23] time 0.190 (0.185) data 0.113 (0.109) loss_u loss_u 0.9546 (0.8728) acc_u 6.2500 (14.1667) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/23] time 0.166 (0.183) data 0.089 (0.107) loss_u loss_u 0.8672 (0.8665) acc_u 15.6250 (15.1562) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.5312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 850
clean true:843
clean false:7
clean_rate:0.991764705882353
noisy true:431
noisy false:319
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 750
epoch [98/200] batch [5/26] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.4114 (0.4694) acc_x 87.5000 (88.1250) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/26] time 0.178 (0.184) data 0.101 (0.108) loss_x loss_x 0.5566 (0.5018) acc_x 81.2500 (85.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/26] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.4570 (0.4850) acc_x 81.2500 (85.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [20/26] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.3223 (0.4658) acc_x 93.7500 (86.4062) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [25/26] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.3618 (0.4948) acc_x 87.5000 (86.1250) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/23] time 0.179 (0.183) data 0.103 (0.107) loss_u loss_u 0.8887 (0.8640) acc_u 15.6250 (16.2500) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/23] time 0.181 (0.183) data 0.104 (0.107) loss_u loss_u 0.8643 (0.8771) acc_u 15.6250 (15.3125) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/23] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.8926 (0.8821) acc_u 12.5000 (14.3750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/23] time 0.185 (0.183) data 0.109 (0.107) loss_u loss_u 0.8623 (0.8816) acc_u 18.7500 (14.3750) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 295
confident_label rate tensor(0.5412, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 866
clean true:862
clean false:4
clean_rate:0.9953810623556582
noisy true:443
noisy false:291
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 734
epoch [99/200] batch [5/27] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.3303 (0.3246) acc_x 90.6250 (91.2500) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/27] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 0.2358 (0.3750) acc_x 96.8750 (90.9375) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [15/27] time 0.178 (0.182) data 0.103 (0.107) loss_x loss_x 0.3230 (0.3966) acc_x 90.6250 (90.0000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/27] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.6162 (0.4285) acc_x 78.1250 (89.3750) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [25/27] time 0.184 (0.182) data 0.108 (0.107) loss_x loss_x 0.3701 (0.4180) acc_x 87.5000 (89.0000) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/22] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.9028 (0.8848) acc_u 15.6250 (14.3750) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/22] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.9624 (0.8933) acc_u 3.1250 (12.8125) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/22] time 0.201 (0.184) data 0.124 (0.108) loss_u loss_u 0.9453 (0.8962) acc_u 6.2500 (12.0833) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/22] time 0.191 (0.184) data 0.114 (0.108) loss_u loss_u 0.9326 (0.8967) acc_u 6.2500 (11.8750) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.5281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 845
clean true:840
clean false:5
clean_rate:0.9940828402366864
noisy true:431
noisy false:324
all clean rate:  [0.9957537154989384, 0.9967051070840197, 0.9971949509116409, 0.9946737683089214, 0.997179125528914, 0.9945652173913043, 0.9931693989071039, 0.9959404600811907, 0.9959839357429718, 0.9945652173913043, 0.9973009446693657, 0.9972375690607734, 0.9960681520314548, 0.9948849104859335, 0.9946808510638298, 0.9934036939313984, 0.9960732984293194, 0.9948186528497409, 0.993368700265252, 0.9960629921259843, 0.9973821989528796, 0.9974160206718347, 0.9961685823754789, 0.9960681520314548, 0.9948387096774194, 0.993514915693904, 0.9960526315789474, 0.9936548223350253, 0.9948586118251928, 0.9974424552429667, 0.9950186799501868, 0.9949431099873578, 0.9937185929648241, 0.9974683544303797, 0.9935233160621761, 0.9925742574257426, 0.9974779319041615, 0.9925373134328358, 0.9911949685534591, 0.9974715549936789, 0.9961587708066582, 0.9937888198757764, 0.9938725490196079, 0.9950678175092479, 0.9949367088607595, 0.9936708860759493, 0.996309963099631, 0.9962453066332916, 0.9949431099873578, 0.9975093399750934, 0.9950920245398773, 0.9912718204488778, 0.9962732919254659, 0.9939098660170523, 0.9914004914004914, 0.995079950799508, 0.9938725490196079, 0.9975490196078431, 0.9902557856272838, 0.9950124688279302, 0.9915356711003628, 0.9903264812575574, 0.9940191387559809, 0.9913258983890955, 0.9938574938574939, 0.991358024691358, 0.9902319902319903, 0.9937655860349127, 0.9963459196102314, 0.99644128113879, 0.9962871287128713, 0.9939831528279182, 0.9987893462469734, 0.9951040391676866, 0.9951515151515151, 0.995079950799508, 0.9963985594237695, 0.9927884615384616, 0.9927360774818402, 0.9916765755053508, 0.9940405244338498, 0.9963680387409201, 0.9894117647058823, 0.9928994082840237, 0.9939975990396158, 0.9892857142857143, 0.9891696750902527, 0.9940405244338498, 0.9915662650602409, 0.9893617021276596, 0.9916467780429594, 0.9928486293206198, 0.993006993006993, 0.9929078014184397, 0.9907727797001153, 0.9929411764705882, 0.9952550415183867, 0.991764705882353, 0.9953810623556582, 0.9940828402366864]
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 755
epoch [100/200] batch [5/26] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.7407 (0.5313) acc_x 84.3750 (85.0000) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/26] time 0.200 (0.183) data 0.124 (0.107) loss_x loss_x 0.4150 (0.4612) acc_x 90.6250 (87.5000) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/26] time 0.190 (0.183) data 0.113 (0.107) loss_x loss_x 0.4355 (0.4808) acc_x 81.2500 (86.2500) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [20/26] time 0.182 (0.183) data 0.105 (0.107) loss_x loss_x 0.1196 (0.4549) acc_x 96.8750 (87.0312) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [25/26] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.3037 (0.4668) acc_x 87.5000 (86.6250) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/23] time 0.179 (0.183) data 0.103 (0.107) loss_u loss_u 0.8516 (0.9034) acc_u 18.7500 (11.2500) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/23] time 0.179 (0.183) data 0.103 (0.107) loss_u loss_u 0.8794 (0.8933) acc_u 12.5000 (12.1875) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/23] time 0.177 (0.182) data 0.101 (0.106) loss_u loss_u 0.9048 (0.8807) acc_u 12.5000 (13.5417) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/23] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.8730 (0.8717) acc_u 15.6250 (14.5312) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 315
confident_label rate tensor(0.5319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 851
clean true:844
clean false:7
clean_rate:0.9917743830787309
noisy true:441
noisy false:308
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 749
epoch [101/200] batch [5/26] time 0.161 (0.164) data 0.085 (0.087) loss_x loss_x 0.4980 (0.4551) acc_x 84.3750 (86.8750) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/26] time 0.161 (0.163) data 0.085 (0.087) loss_x loss_x 0.7432 (0.4259) acc_x 75.0000 (87.8125) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/26] time 0.162 (0.163) data 0.087 (0.087) loss_x loss_x 0.6230 (0.4651) acc_x 81.2500 (86.8750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/26] time 0.162 (0.163) data 0.086 (0.087) loss_x loss_x 0.3914 (0.5423) acc_x 87.5000 (85.1562) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [25/26] time 0.166 (0.163) data 0.090 (0.087) loss_x loss_x 0.7959 (0.5333) acc_x 81.2500 (85.5000) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/23] time 0.162 (0.163) data 0.086 (0.087) loss_u loss_u 0.8389 (0.8271) acc_u 18.7500 (18.7500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/23] time 0.165 (0.163) data 0.088 (0.087) loss_u loss_u 0.8623 (0.8571) acc_u 15.6250 (15.3125) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/23] time 0.164 (0.163) data 0.088 (0.087) loss_u loss_u 0.8931 (0.8691) acc_u 12.5000 (14.3750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/23] time 0.165 (0.163) data 0.088 (0.087) loss_u loss_u 0.8760 (0.8660) acc_u 12.5000 (14.6875) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.5362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 858
clean true:851
clean false:7
clean_rate:0.9918414918414918
noisy true:422
noisy false:320
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 742
epoch [102/200] batch [5/26] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.3115 (0.4333) acc_x 93.7500 (90.0000) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/26] time 0.185 (0.182) data 0.110 (0.106) loss_x loss_x 0.6724 (0.4634) acc_x 84.3750 (89.0625) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/26] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.2002 (0.4445) acc_x 96.8750 (89.7917) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/26] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.6934 (0.4835) acc_x 84.3750 (88.1250) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [25/26] time 0.180 (0.182) data 0.105 (0.106) loss_x loss_x 0.9678 (0.4996) acc_x 84.3750 (88.2500) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/23] time 0.168 (0.182) data 0.092 (0.106) loss_u loss_u 0.8687 (0.8854) acc_u 12.5000 (12.5000) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/23] time 0.186 (0.183) data 0.110 (0.106) loss_u loss_u 0.8652 (0.8694) acc_u 12.5000 (14.0625) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/23] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.8691 (0.8589) acc_u 15.6250 (15.2083) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/23] time 0.182 (0.183) data 0.106 (0.107) loss_u loss_u 0.9287 (0.8676) acc_u 6.2500 (14.2188) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 321
confident_label rate tensor(0.5256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 841
clean true:834
clean false:7
clean_rate:0.9916765755053508
noisy true:445
noisy false:314
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 759
epoch [103/200] batch [5/26] time 0.172 (0.172) data 0.096 (0.096) loss_x loss_x 0.4749 (0.4139) acc_x 90.6250 (90.0000) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/26] time 0.184 (0.173) data 0.108 (0.097) loss_x loss_x 0.2805 (0.4163) acc_x 90.6250 (90.0000) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/26] time 0.181 (0.176) data 0.105 (0.100) loss_x loss_x 0.5713 (0.4328) acc_x 84.3750 (89.3750) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/26] time 0.182 (0.178) data 0.106 (0.102) loss_x loss_x 0.7578 (0.4561) acc_x 78.1250 (88.5938) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [25/26] time 0.183 (0.179) data 0.107 (0.103) loss_x loss_x 0.5576 (0.4745) acc_x 78.1250 (87.3750) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/23] time 0.206 (0.181) data 0.129 (0.105) loss_u loss_u 0.8291 (0.8793) acc_u 18.7500 (13.7500) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/23] time 0.159 (0.181) data 0.083 (0.105) loss_u loss_u 0.8530 (0.8799) acc_u 18.7500 (14.0625) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/23] time 0.171 (0.180) data 0.094 (0.104) loss_u loss_u 0.8838 (0.8618) acc_u 12.5000 (15.8333) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/23] time 0.187 (0.179) data 0.111 (0.103) loss_u loss_u 0.8965 (0.8662) acc_u 12.5000 (15.1562) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.5263, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 842
clean true:837
clean false:5
clean_rate:0.994061757719715
noisy true:438
noisy false:320
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 758
epoch [104/200] batch [5/26] time 0.180 (0.185) data 0.105 (0.109) loss_x loss_x 0.4294 (0.5422) acc_x 84.3750 (83.1250) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/26] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.4414 (0.4082) acc_x 87.5000 (89.0625) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/26] time 0.189 (0.184) data 0.114 (0.109) loss_x loss_x 0.2003 (0.4162) acc_x 93.7500 (89.1667) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [20/26] time 0.184 (0.184) data 0.109 (0.108) loss_x loss_x 0.6558 (0.4531) acc_x 75.0000 (87.6562) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [25/26] time 0.190 (0.185) data 0.114 (0.110) loss_x loss_x 0.7515 (0.4706) acc_x 81.2500 (87.2500) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/23] time 0.186 (0.186) data 0.110 (0.110) loss_u loss_u 0.9033 (0.8733) acc_u 9.3750 (14.3750) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/23] time 0.184 (0.185) data 0.108 (0.109) loss_u loss_u 0.7295 (0.8493) acc_u 31.2500 (17.5000) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/23] time 0.186 (0.185) data 0.110 (0.109) loss_u loss_u 0.8638 (0.8598) acc_u 18.7500 (16.4583) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/23] time 0.182 (0.185) data 0.106 (0.109) loss_u loss_u 0.8770 (0.8694) acc_u 15.6250 (15.1562) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.5350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 856
clean true:852
clean false:4
clean_rate:0.9953271028037384
noisy true:450
noisy false:294
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 744
epoch [105/200] batch [5/26] time 0.182 (0.184) data 0.107 (0.108) loss_x loss_x 0.9150 (0.5815) acc_x 75.0000 (87.5000) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/26] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.5098 (0.5554) acc_x 90.6250 (86.5625) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/26] time 0.182 (0.185) data 0.106 (0.109) loss_x loss_x 0.2152 (0.4881) acc_x 93.7500 (87.5000) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/26] time 0.188 (0.185) data 0.112 (0.109) loss_x loss_x 0.5229 (0.4806) acc_x 90.6250 (87.5000) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [25/26] time 0.181 (0.184) data 0.105 (0.108) loss_x loss_x 0.9175 (0.5132) acc_x 65.6250 (86.0000) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/23] time 0.186 (0.184) data 0.109 (0.108) loss_u loss_u 0.9351 (0.8654) acc_u 9.3750 (15.6250) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/23] time 0.177 (0.184) data 0.100 (0.108) loss_u loss_u 0.8491 (0.8669) acc_u 18.7500 (15.3125) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/23] time 0.182 (0.184) data 0.106 (0.107) loss_u loss_u 0.9854 (0.8749) acc_u 3.1250 (14.3750) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/23] time 0.181 (0.183) data 0.105 (0.107) loss_u loss_u 0.8994 (0.8741) acc_u 12.5000 (14.3750) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 296
confident_label rate tensor(0.5312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 850
clean true:842
clean false:8
clean_rate:0.9905882352941177
noisy true:462
noisy false:288
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 750
epoch [106/200] batch [5/26] time 0.241 (0.199) data 0.165 (0.122) loss_x loss_x 0.4441 (0.4646) acc_x 87.5000 (86.2500) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [10/26] time 0.218 (0.194) data 0.142 (0.118) loss_x loss_x 0.4817 (0.4902) acc_x 84.3750 (85.9375) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [15/26] time 0.183 (0.190) data 0.107 (0.114) loss_x loss_x 0.3145 (0.5375) acc_x 93.7500 (85.0000) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [20/26] time 0.191 (0.190) data 0.115 (0.114) loss_x loss_x 0.2147 (0.5282) acc_x 96.8750 (85.9375) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [25/26] time 0.184 (0.189) data 0.108 (0.113) loss_x loss_x 0.5889 (0.5297) acc_x 87.5000 (86.5000) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/23] time 0.183 (0.188) data 0.107 (0.112) loss_u loss_u 0.9297 (0.8651) acc_u 9.3750 (15.0000) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/23] time 0.182 (0.188) data 0.106 (0.111) loss_u loss_u 0.9170 (0.8762) acc_u 9.3750 (14.0625) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/23] time 0.186 (0.187) data 0.110 (0.111) loss_u loss_u 0.8496 (0.8785) acc_u 15.6250 (13.9583) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/23] time 0.184 (0.187) data 0.107 (0.111) loss_u loss_u 0.8779 (0.8615) acc_u 12.5000 (15.6250) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 303
confident_label rate tensor(0.5331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 853
clean true:849
clean false:4
clean_rate:0.9953106682297772
noisy true:448
noisy false:299
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 747
epoch [107/200] batch [5/26] time 0.187 (0.188) data 0.111 (0.112) loss_x loss_x 0.4043 (0.4580) acc_x 93.7500 (90.0000) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/26] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.3235 (0.4559) acc_x 93.7500 (88.7500) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/26] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.8062 (0.5068) acc_x 84.3750 (87.7083) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/26] time 0.186 (0.185) data 0.109 (0.109) loss_x loss_x 0.7192 (0.5078) acc_x 75.0000 (87.0312) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [25/26] time 0.193 (0.186) data 0.116 (0.109) loss_x loss_x 0.2369 (0.4686) acc_x 96.8750 (88.3750) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/23] time 0.184 (0.186) data 0.107 (0.110) loss_u loss_u 0.9209 (0.8534) acc_u 9.3750 (16.2500) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/23] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.9189 (0.8747) acc_u 6.2500 (13.7500) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/23] time 0.183 (0.187) data 0.107 (0.110) loss_u loss_u 0.8789 (0.8827) acc_u 12.5000 (12.9167) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/23] time 0.184 (0.187) data 0.108 (0.110) loss_u loss_u 0.9131 (0.8713) acc_u 9.3750 (14.2188) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 306
confident_label rate tensor(0.5412, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 866
clean true:857
clean false:9
clean_rate:0.9896073903002309
noisy true:437
noisy false:297
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 734
epoch [108/200] batch [5/27] time 0.186 (0.185) data 0.110 (0.109) loss_x loss_x 0.4072 (0.4835) acc_x 90.6250 (88.1250) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [10/27] time 0.162 (0.178) data 0.086 (0.102) loss_x loss_x 0.9312 (0.5160) acc_x 71.8750 (86.2500) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [15/27] time 0.166 (0.177) data 0.090 (0.101) loss_x loss_x 0.2659 (0.4806) acc_x 93.7500 (87.7083) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [20/27] time 0.178 (0.176) data 0.101 (0.100) loss_x loss_x 0.3735 (0.5135) acc_x 90.6250 (86.8750) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [25/27] time 0.182 (0.177) data 0.105 (0.101) loss_x loss_x 0.3574 (0.4926) acc_x 93.7500 (87.3750) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/22] time 0.187 (0.178) data 0.110 (0.102) loss_u loss_u 0.9072 (0.9066) acc_u 9.3750 (10.0000) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/22] time 0.188 (0.179) data 0.111 (0.103) loss_u loss_u 0.8936 (0.8884) acc_u 9.3750 (11.8750) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/22] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8765 (0.8834) acc_u 15.6250 (12.5000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/22] time 0.171 (0.179) data 0.094 (0.103) loss_u loss_u 0.9160 (0.8764) acc_u 9.3750 (13.5938) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 320
confident_label rate tensor(0.5319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 851
clean true:844
clean false:7
clean_rate:0.9917743830787309
noisy true:436
noisy false:313
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 749
epoch [109/200] batch [5/26] time 0.164 (0.178) data 0.088 (0.102) loss_x loss_x 0.2251 (0.4092) acc_x 93.7500 (89.3750) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/26] time 0.180 (0.177) data 0.105 (0.101) loss_x loss_x 0.2961 (0.4479) acc_x 93.7500 (87.8125) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/26] time 0.181 (0.178) data 0.105 (0.103) loss_x loss_x 0.4478 (0.4397) acc_x 93.7500 (88.5417) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/26] time 0.183 (0.179) data 0.107 (0.103) loss_x loss_x 0.4744 (0.4454) acc_x 87.5000 (88.2812) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [25/26] time 0.183 (0.180) data 0.108 (0.104) loss_x loss_x 0.6465 (0.4604) acc_x 78.1250 (88.0000) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/23] time 0.182 (0.180) data 0.106 (0.104) loss_u loss_u 0.8608 (0.8319) acc_u 18.7500 (18.7500) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/23] time 0.182 (0.181) data 0.106 (0.105) loss_u loss_u 0.8843 (0.8583) acc_u 12.5000 (16.5625) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/23] time 0.182 (0.181) data 0.106 (0.105) loss_u loss_u 0.9160 (0.8688) acc_u 12.5000 (15.6250) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/23] time 0.179 (0.181) data 0.103 (0.105) loss_u loss_u 0.9727 (0.8740) acc_u 3.1250 (15.0000) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.5312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 850
clean true:845
clean false:5
clean_rate:0.9941176470588236
noisy true:429
noisy false:321
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 750
epoch [110/200] batch [5/26] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.5498 (0.4786) acc_x 84.3750 (89.3750) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/26] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.1151 (0.4830) acc_x 100.0000 (88.4375) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/26] time 0.165 (0.177) data 0.089 (0.101) loss_x loss_x 0.5532 (0.4858) acc_x 81.2500 (87.5000) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/26] time 0.179 (0.175) data 0.103 (0.099) loss_x loss_x 0.4128 (0.5195) acc_x 90.6250 (87.5000) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [25/26] time 0.165 (0.173) data 0.089 (0.097) loss_x loss_x 0.3738 (0.5012) acc_x 87.5000 (87.5000) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/23] time 0.176 (0.173) data 0.100 (0.097) loss_u loss_u 0.9116 (0.8652) acc_u 9.3750 (15.0000) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/23] time 0.195 (0.174) data 0.118 (0.098) loss_u loss_u 0.8574 (0.8598) acc_u 15.6250 (15.9375) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/23] time 0.184 (0.174) data 0.108 (0.098) loss_u loss_u 0.9653 (0.8722) acc_u 3.1250 (14.7917) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/23] time 0.184 (0.175) data 0.108 (0.099) loss_u loss_u 0.8940 (0.8723) acc_u 12.5000 (14.8438) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 331
confident_label rate tensor(0.5281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 845
clean true:840
clean false:5
clean_rate:0.9940828402366864
noisy true:429
noisy false:326
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 755
epoch [111/200] batch [5/26] time 0.178 (0.178) data 0.103 (0.102) loss_x loss_x 0.2944 (0.5474) acc_x 93.7500 (84.3750) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/26] time 0.179 (0.180) data 0.104 (0.104) loss_x loss_x 0.6323 (0.5462) acc_x 81.2500 (85.0000) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/26] time 0.186 (0.181) data 0.110 (0.105) loss_x loss_x 0.3110 (0.4566) acc_x 93.7500 (87.5000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/26] time 0.201 (0.182) data 0.125 (0.106) loss_x loss_x 0.3455 (0.4448) acc_x 93.7500 (88.4375) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [25/26] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 0.4365 (0.4593) acc_x 90.6250 (88.5000) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/23] time 0.181 (0.181) data 0.105 (0.105) loss_u loss_u 0.8057 (0.8945) acc_u 25.0000 (11.8750) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/23] time 0.179 (0.181) data 0.103 (0.105) loss_u loss_u 0.9438 (0.8878) acc_u 6.2500 (13.1250) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/23] time 0.182 (0.181) data 0.106 (0.105) loss_u loss_u 0.9014 (0.8783) acc_u 12.5000 (13.9583) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/23] time 0.183 (0.181) data 0.107 (0.105) loss_u loss_u 0.7744 (0.8741) acc_u 25.0000 (14.3750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 317
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:858
clean false:9
clean_rate:0.9896193771626297
noisy true:425
noisy false:308
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [112/200] batch [5/27] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.5703 (0.4677) acc_x 90.6250 (88.7500) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/27] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.8320 (0.5700) acc_x 78.1250 (85.6250) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [15/27] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.5454 (0.5486) acc_x 84.3750 (85.4167) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [20/27] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 0.9380 (0.5396) acc_x 78.1250 (86.0938) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [25/27] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.5249 (0.5398) acc_x 84.3750 (85.6250) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/22] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.9302 (0.8622) acc_u 6.2500 (16.8750) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/22] time 0.168 (0.180) data 0.091 (0.104) loss_u loss_u 0.8486 (0.8708) acc_u 15.6250 (15.0000) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/22] time 0.158 (0.178) data 0.082 (0.101) loss_u loss_u 0.8975 (0.8818) acc_u 9.3750 (13.7500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/22] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.8882 (0.8914) acc_u 15.6250 (12.6562) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.5356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 857
clean true:850
clean false:7
clean_rate:0.9918319719953326
noisy true:439
noisy false:304
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 743
epoch [113/200] batch [5/26] time 0.171 (0.179) data 0.095 (0.103) loss_x loss_x 0.5386 (0.3675) acc_x 84.3750 (87.5000) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/26] time 0.182 (0.175) data 0.106 (0.098) loss_x loss_x 0.5659 (0.4872) acc_x 84.3750 (85.3125) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/26] time 0.185 (0.180) data 0.110 (0.103) loss_x loss_x 0.7046 (0.5275) acc_x 84.3750 (85.6250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/26] time 0.185 (0.181) data 0.109 (0.104) loss_x loss_x 0.8071 (0.5410) acc_x 87.5000 (85.6250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [25/26] time 0.187 (0.181) data 0.111 (0.105) loss_x loss_x 0.3303 (0.5246) acc_x 93.7500 (86.0000) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/23] time 0.163 (0.181) data 0.087 (0.105) loss_u loss_u 0.8687 (0.8445) acc_u 12.5000 (18.7500) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/23] time 0.184 (0.182) data 0.108 (0.106) loss_u loss_u 0.9287 (0.8674) acc_u 9.3750 (15.3125) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/23] time 0.182 (0.182) data 0.106 (0.106) loss_u loss_u 0.8823 (0.8764) acc_u 12.5000 (13.9583) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/23] time 0.185 (0.182) data 0.109 (0.106) loss_u loss_u 0.8110 (0.8742) acc_u 25.0000 (14.2188) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 319
confident_label rate tensor(0.5256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 841
clean true:833
clean false:8
clean_rate:0.990487514863258
noisy true:448
noisy false:311
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 759
epoch [114/200] batch [5/26] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.3557 (0.3991) acc_x 90.6250 (86.8750) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/26] time 0.195 (0.185) data 0.119 (0.109) loss_x loss_x 1.0791 (0.5461) acc_x 78.1250 (85.0000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/26] time 0.217 (0.190) data 0.141 (0.114) loss_x loss_x 0.2499 (0.5189) acc_x 93.7500 (85.8333) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/26] time 0.180 (0.190) data 0.104 (0.114) loss_x loss_x 0.8184 (0.5099) acc_x 78.1250 (85.9375) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [25/26] time 0.185 (0.189) data 0.109 (0.113) loss_x loss_x 0.2284 (0.5068) acc_x 90.6250 (85.8750) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/23] time 0.180 (0.188) data 0.103 (0.112) loss_u loss_u 0.8809 (0.8946) acc_u 15.6250 (12.5000) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/23] time 0.174 (0.186) data 0.096 (0.110) loss_u loss_u 0.8994 (0.8733) acc_u 12.5000 (15.0000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/23] time 0.180 (0.186) data 0.103 (0.110) loss_u loss_u 0.8760 (0.8735) acc_u 15.6250 (14.7917) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/23] time 0.192 (0.186) data 0.115 (0.109) loss_u loss_u 0.8789 (0.8720) acc_u 12.5000 (14.8438) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.5312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 850
clean true:845
clean false:5
clean_rate:0.9941176470588236
noisy true:432
noisy false:318
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 750
epoch [115/200] batch [5/26] time 0.186 (0.182) data 0.111 (0.106) loss_x loss_x 0.2350 (0.3343) acc_x 96.8750 (93.7500) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/26] time 0.173 (0.179) data 0.096 (0.103) loss_x loss_x 0.5986 (0.4278) acc_x 81.2500 (89.6875) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/26] time 0.165 (0.175) data 0.090 (0.098) loss_x loss_x 0.3669 (0.4494) acc_x 90.6250 (88.1250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/26] time 0.182 (0.177) data 0.106 (0.100) loss_x loss_x 0.2231 (0.4588) acc_x 90.6250 (87.9688) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [25/26] time 0.182 (0.178) data 0.106 (0.102) loss_x loss_x 0.4941 (0.4632) acc_x 87.5000 (88.2500) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/23] time 0.181 (0.179) data 0.104 (0.103) loss_u loss_u 0.8418 (0.8738) acc_u 18.7500 (15.0000) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/23] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8896 (0.8819) acc_u 15.6250 (13.7500) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/23] time 0.181 (0.180) data 0.105 (0.104) loss_u loss_u 0.8335 (0.8719) acc_u 18.7500 (15.0000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/23] time 0.185 (0.180) data 0.108 (0.104) loss_u loss_u 0.7949 (0.8636) acc_u 25.0000 (15.7812) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.5325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 852
clean true:846
clean false:6
clean_rate:0.9929577464788732
noisy true:425
noisy false:323
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 748
epoch [116/200] batch [5/26] time 0.182 (0.185) data 0.107 (0.109) loss_x loss_x 0.4639 (0.5245) acc_x 87.5000 (86.8750) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/26] time 0.183 (0.183) data 0.108 (0.107) loss_x loss_x 0.3799 (0.5435) acc_x 93.7500 (86.5625) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/26] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.1661 (0.4962) acc_x 100.0000 (88.3333) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [20/26] time 0.185 (0.183) data 0.109 (0.108) loss_x loss_x 0.4927 (0.4758) acc_x 87.5000 (88.1250) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [25/26] time 0.187 (0.183) data 0.111 (0.107) loss_x loss_x 0.5928 (0.5045) acc_x 81.2500 (87.1250) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/23] time 0.186 (0.183) data 0.110 (0.107) loss_u loss_u 0.8320 (0.8901) acc_u 15.6250 (11.8750) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/23] time 0.172 (0.183) data 0.095 (0.107) loss_u loss_u 0.8042 (0.8696) acc_u 18.7500 (14.3750) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/23] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.8750 (0.8696) acc_u 12.5000 (13.9583) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/23] time 0.185 (0.183) data 0.108 (0.107) loss_u loss_u 0.8984 (0.8711) acc_u 9.3750 (13.9062) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.5337, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 854
clean true:848
clean false:6
clean_rate:0.9929742388758782
noisy true:427
noisy false:319
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 746
epoch [117/200] batch [5/26] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.2114 (0.3575) acc_x 96.8750 (91.8750) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/26] time 0.177 (0.180) data 0.100 (0.103) loss_x loss_x 0.1212 (0.3789) acc_x 96.8750 (90.3125) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/26] time 0.208 (0.182) data 0.131 (0.106) loss_x loss_x 0.2822 (0.3972) acc_x 87.5000 (89.5833) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [20/26] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.5791 (0.4370) acc_x 84.3750 (88.5938) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [25/26] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.3210 (0.4214) acc_x 90.6250 (89.0000) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/23] time 0.173 (0.183) data 0.096 (0.106) loss_u loss_u 0.8955 (0.9128) acc_u 12.5000 (8.7500) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/23] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.8901 (0.8865) acc_u 9.3750 (12.1875) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/23] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8711 (0.8693) acc_u 12.5000 (14.3750) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/23] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9663 (0.8766) acc_u 3.1250 (13.5938) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.5263, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 842
clean true:835
clean false:7
clean_rate:0.9916864608076009
noisy true:423
noisy false:335
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 758
epoch [118/200] batch [5/26] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.2219 (0.4196) acc_x 96.8750 (91.2500) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/26] time 0.163 (0.183) data 0.086 (0.107) loss_x loss_x 0.2898 (0.3621) acc_x 93.7500 (92.5000) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/26] time 0.182 (0.186) data 0.105 (0.110) loss_x loss_x 0.3811 (0.4188) acc_x 90.6250 (90.2083) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/26] time 0.172 (0.187) data 0.096 (0.111) loss_x loss_x 0.4724 (0.3914) acc_x 90.6250 (90.9375) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [25/26] time 0.181 (0.187) data 0.105 (0.111) loss_x loss_x 0.4075 (0.3956) acc_x 87.5000 (90.6250) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/23] time 0.184 (0.186) data 0.108 (0.110) loss_u loss_u 0.8638 (0.8745) acc_u 15.6250 (14.3750) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/23] time 0.179 (0.185) data 0.102 (0.108) loss_u loss_u 0.9336 (0.8678) acc_u 9.3750 (15.3125) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/23] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.8511 (0.8702) acc_u 15.6250 (14.7917) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/23] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.8828 (0.8577) acc_u 12.5000 (16.2500) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 863
clean true:858
clean false:5
clean_rate:0.9942062572421785
noisy true:432
noisy false:305
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 737
epoch [119/200] batch [5/26] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.3613 (0.3510) acc_x 90.6250 (90.0000) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/26] time 0.219 (0.187) data 0.143 (0.110) loss_x loss_x 0.5259 (0.4588) acc_x 87.5000 (87.8125) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/26] time 0.203 (0.187) data 0.127 (0.111) loss_x loss_x 0.3611 (0.4879) acc_x 87.5000 (87.7083) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [20/26] time 0.169 (0.186) data 0.093 (0.110) loss_x loss_x 0.2625 (0.4831) acc_x 96.8750 (88.1250) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [25/26] time 0.180 (0.184) data 0.103 (0.108) loss_x loss_x 0.4812 (0.4738) acc_x 87.5000 (88.5000) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/23] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9019 (0.8896) acc_u 9.3750 (12.5000) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/23] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.9355 (0.8952) acc_u 9.3750 (11.5625) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/23] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.9185 (0.8928) acc_u 12.5000 (12.0833) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/23] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8613 (0.8847) acc_u 18.7500 (13.1250) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.5331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 853
clean true:845
clean false:8
clean_rate:0.9906213364595545
noisy true:432
noisy false:315
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 747
epoch [120/200] batch [5/26] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.3765 (0.3642) acc_x 90.6250 (91.2500) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/26] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.2812 (0.3414) acc_x 93.7500 (90.6250) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/26] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.4578 (0.3851) acc_x 87.5000 (89.1667) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [20/26] time 0.200 (0.184) data 0.124 (0.108) loss_x loss_x 0.7275 (0.4570) acc_x 81.2500 (88.2812) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [25/26] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.4697 (0.4553) acc_x 93.7500 (88.8750) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/23] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.8496 (0.8708) acc_u 15.6250 (13.7500) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/23] time 0.189 (0.183) data 0.113 (0.107) loss_u loss_u 0.8457 (0.8618) acc_u 12.5000 (14.3750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/23] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.6626 (0.8571) acc_u 34.3750 (14.7917) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/23] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.8701 (0.8612) acc_u 15.6250 (14.6875) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 313
confident_label rate tensor(0.5375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 860
clean true:855
clean false:5
clean_rate:0.9941860465116279
noisy true:432
noisy false:308
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 740
epoch [121/200] batch [5/26] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.9912 (0.4337) acc_x 78.1250 (86.2500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/26] time 0.170 (0.183) data 0.094 (0.107) loss_x loss_x 0.5220 (0.4063) acc_x 87.5000 (88.7500) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/26] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.2659 (0.4237) acc_x 93.7500 (88.7500) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/26] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.5562 (0.4598) acc_x 90.6250 (88.4375) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [25/26] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.2952 (0.4507) acc_x 93.7500 (88.8750) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/23] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.8105 (0.8863) acc_u 18.7500 (11.8750) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/23] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9277 (0.8702) acc_u 6.2500 (13.7500) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/23] time 0.202 (0.184) data 0.125 (0.108) loss_u loss_u 0.9194 (0.8800) acc_u 12.5000 (12.7083) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/23] time 0.188 (0.187) data 0.112 (0.110) loss_u loss_u 0.8687 (0.8802) acc_u 15.6250 (13.1250) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 874
clean true:866
clean false:8
clean_rate:0.9908466819221968
noisy true:424
noisy false:302
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 726
epoch [122/200] batch [5/27] time 0.181 (0.182) data 0.106 (0.106) loss_x loss_x 0.4458 (0.4216) acc_x 84.3750 (88.7500) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/27] time 0.169 (0.180) data 0.092 (0.104) loss_x loss_x 0.2155 (0.4724) acc_x 93.7500 (87.1875) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [15/27] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.2930 (0.5073) acc_x 96.8750 (86.4583) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [20/27] time 0.193 (0.181) data 0.117 (0.104) loss_x loss_x 0.3794 (0.5121) acc_x 93.7500 (87.0312) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [25/27] time 0.186 (0.181) data 0.109 (0.105) loss_x loss_x 0.4077 (0.4930) acc_x 87.5000 (87.2500) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/22] time 0.196 (0.182) data 0.119 (0.106) loss_u loss_u 0.8369 (0.8828) acc_u 18.7500 (12.5000) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/22] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.8477 (0.8795) acc_u 15.6250 (13.1250) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/22] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9351 (0.8847) acc_u 6.2500 (12.5000) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/22] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9292 (0.8886) acc_u 6.2500 (12.3438) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.5387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 862
clean true:853
clean false:9
clean_rate:0.9895591647331786
noisy true:436
noisy false:302
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 738
epoch [123/200] batch [5/26] time 0.163 (0.172) data 0.086 (0.096) loss_x loss_x 0.5229 (0.5806) acc_x 90.6250 (86.2500) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/26] time 0.183 (0.175) data 0.107 (0.099) loss_x loss_x 0.1857 (0.4520) acc_x 93.7500 (88.7500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/26] time 0.182 (0.178) data 0.106 (0.101) loss_x loss_x 0.6113 (0.4536) acc_x 81.2500 (88.9583) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/26] time 0.208 (0.180) data 0.131 (0.104) loss_x loss_x 0.3677 (0.4403) acc_x 90.6250 (89.0625) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [25/26] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.4351 (0.4476) acc_x 90.6250 (89.0000) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/23] time 0.176 (0.181) data 0.099 (0.104) loss_u loss_u 0.8682 (0.8832) acc_u 15.6250 (13.7500) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/23] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8833 (0.8829) acc_u 12.5000 (13.1250) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/23] time 0.182 (0.181) data 0.105 (0.105) loss_u loss_u 0.8325 (0.8909) acc_u 15.6250 (11.8750) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/23] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8828 (0.8893) acc_u 12.5000 (12.3438) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 300
confident_label rate tensor(0.5375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 860
clean true:853
clean false:7
clean_rate:0.9918604651162791
noisy true:447
noisy false:293
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 740
epoch [124/200] batch [5/26] time 0.183 (0.193) data 0.107 (0.117) loss_x loss_x 0.8823 (0.5126) acc_x 84.3750 (86.8750) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/26] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.9043 (0.5390) acc_x 75.0000 (86.8750) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/26] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.5171 (0.5217) acc_x 87.5000 (86.6667) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [20/26] time 0.184 (0.182) data 0.109 (0.106) loss_x loss_x 0.5718 (0.5256) acc_x 84.3750 (86.8750) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [25/26] time 0.219 (0.185) data 0.144 (0.109) loss_x loss_x 0.4094 (0.4828) acc_x 90.6250 (87.8750) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/23] time 0.179 (0.185) data 0.102 (0.109) loss_u loss_u 0.8735 (0.8485) acc_u 12.5000 (17.5000) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/23] time 0.179 (0.185) data 0.102 (0.108) loss_u loss_u 0.8862 (0.8628) acc_u 12.5000 (15.9375) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/23] time 0.183 (0.185) data 0.107 (0.108) loss_u loss_u 0.9282 (0.8701) acc_u 6.2500 (15.0000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/23] time 0.182 (0.184) data 0.105 (0.108) loss_u loss_u 0.9170 (0.8765) acc_u 12.5000 (14.2188) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5238, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 838
clean true:829
clean false:9
clean_rate:0.9892601431980907
noisy true:423
noisy false:339
after delete: len(clean_dataset) 838
after delete: len(noisy_dataset) 762
epoch [125/200] batch [5/26] time 0.189 (0.184) data 0.112 (0.108) loss_x loss_x 0.6748 (0.4784) acc_x 84.3750 (85.0000) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/26] time 0.220 (0.188) data 0.144 (0.111) loss_x loss_x 0.2612 (0.4463) acc_x 90.6250 (86.8750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [15/26] time 0.187 (0.189) data 0.112 (0.113) loss_x loss_x 0.3394 (0.4446) acc_x 90.6250 (87.2917) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/26] time 0.178 (0.186) data 0.101 (0.109) loss_x loss_x 0.2134 (0.4369) acc_x 93.7500 (87.8125) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [25/26] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.2910 (0.4456) acc_x 87.5000 (87.7500) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/23] time 0.185 (0.184) data 0.108 (0.108) loss_u loss_u 0.8643 (0.8710) acc_u 12.5000 (13.7500) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/23] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.7983 (0.8717) acc_u 21.8750 (13.7500) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/23] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8628 (0.8658) acc_u 15.6250 (15.2083) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/23] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.9062 (0.8664) acc_u 9.3750 (15.0000) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.5319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 851
clean true:845
clean false:6
clean_rate:0.9929494712103408
noisy true:431
noisy false:318
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 749
epoch [126/200] batch [5/26] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.6235 (0.4392) acc_x 84.3750 (87.5000) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/26] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.6816 (0.4259) acc_x 81.2500 (87.8125) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/26] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.4473 (0.4587) acc_x 87.5000 (87.9167) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/26] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.3333 (0.4729) acc_x 87.5000 (87.6562) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [25/26] time 0.178 (0.184) data 0.102 (0.108) loss_x loss_x 0.3118 (0.4470) acc_x 90.6250 (88.7500) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/23] time 0.171 (0.184) data 0.094 (0.108) loss_u loss_u 0.9038 (0.8470) acc_u 9.3750 (16.8750) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/23] time 0.201 (0.184) data 0.124 (0.108) loss_u loss_u 0.8091 (0.8525) acc_u 21.8750 (17.1875) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/23] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8965 (0.8590) acc_u 9.3750 (16.6667) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/23] time 0.196 (0.184) data 0.119 (0.108) loss_u loss_u 0.9517 (0.8651) acc_u 3.1250 (15.9375) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.5350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 856
clean true:848
clean false:8
clean_rate:0.9906542056074766
noisy true:426
noisy false:318
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 744
epoch [127/200] batch [5/26] time 0.188 (0.185) data 0.112 (0.109) loss_x loss_x 0.6255 (0.4588) acc_x 84.3750 (86.8750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/26] time 0.181 (0.184) data 0.105 (0.108) loss_x loss_x 0.2155 (0.4562) acc_x 96.8750 (87.5000) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/26] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.3601 (0.4416) acc_x 93.7500 (87.7083) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [20/26] time 0.181 (0.183) data 0.105 (0.108) loss_x loss_x 0.3645 (0.4375) acc_x 90.6250 (87.8125) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [25/26] time 0.186 (0.183) data 0.110 (0.108) loss_x loss_x 0.5322 (0.4508) acc_x 87.5000 (88.1250) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/23] time 0.187 (0.184) data 0.111 (0.108) loss_u loss_u 0.9292 (0.8840) acc_u 6.2500 (11.8750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/23] time 0.184 (0.183) data 0.108 (0.107) loss_u loss_u 0.8286 (0.8772) acc_u 18.7500 (13.4375) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/23] time 0.184 (0.183) data 0.108 (0.107) loss_u loss_u 0.7925 (0.8729) acc_u 25.0000 (14.1667) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/23] time 0.186 (0.183) data 0.110 (0.107) loss_u loss_u 0.8799 (0.8744) acc_u 12.5000 (13.9062) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 305
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:859
clean false:8
clean_rate:0.9907727797001153
noisy true:436
noisy false:297
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [128/200] batch [5/27] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.4851 (0.6488) acc_x 84.3750 (84.3750) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/27] time 0.185 (0.182) data 0.109 (0.106) loss_x loss_x 0.1681 (0.5906) acc_x 96.8750 (85.9375) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [15/27] time 0.186 (0.182) data 0.110 (0.107) loss_x loss_x 0.4661 (0.5624) acc_x 90.6250 (86.2500) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [20/27] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.6577 (0.5593) acc_x 87.5000 (86.0938) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [25/27] time 0.164 (0.182) data 0.088 (0.106) loss_x loss_x 0.5640 (0.5171) acc_x 81.2500 (86.8750) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/22] time 0.180 (0.181) data 0.104 (0.105) loss_u loss_u 0.9365 (0.8620) acc_u 6.2500 (15.0000) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/22] time 0.172 (0.180) data 0.095 (0.104) loss_u loss_u 0.7798 (0.8369) acc_u 25.0000 (17.8125) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/22] time 0.182 (0.180) data 0.105 (0.104) loss_u loss_u 0.9121 (0.8548) acc_u 9.3750 (15.8333) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/22] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.9204 (0.8680) acc_u 12.5000 (14.6875) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 841
clean true:835
clean false:6
clean_rate:0.9928656361474435
noisy true:430
noisy false:329
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 759
epoch [129/200] batch [5/26] time 0.159 (0.164) data 0.083 (0.088) loss_x loss_x 0.4434 (0.4991) acc_x 78.1250 (85.6250) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/26] time 0.185 (0.175) data 0.109 (0.099) loss_x loss_x 0.5439 (0.4566) acc_x 87.5000 (87.8125) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/26] time 0.184 (0.178) data 0.108 (0.102) loss_x loss_x 0.2954 (0.4609) acc_x 93.7500 (87.9167) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/26] time 0.179 (0.179) data 0.102 (0.103) loss_x loss_x 0.6157 (0.4543) acc_x 78.1250 (87.9688) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [25/26] time 0.180 (0.180) data 0.104 (0.105) loss_x loss_x 0.3337 (0.4641) acc_x 84.3750 (87.2500) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/23] time 0.184 (0.181) data 0.107 (0.105) loss_u loss_u 0.8672 (0.8360) acc_u 15.6250 (18.7500) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/23] time 0.182 (0.181) data 0.106 (0.105) loss_u loss_u 0.8262 (0.8423) acc_u 18.7500 (17.5000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/23] time 0.213 (0.182) data 0.135 (0.106) loss_u loss_u 0.8525 (0.8409) acc_u 15.6250 (17.0833) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/23] time 0.182 (0.184) data 0.105 (0.108) loss_u loss_u 0.8750 (0.8528) acc_u 15.6250 (15.7812) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 289
confident_label rate tensor(0.5500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 880
clean true:873
clean false:7
clean_rate:0.9920454545454546
noisy true:438
noisy false:282
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 720
epoch [130/200] batch [5/27] time 0.164 (0.180) data 0.087 (0.104) loss_x loss_x 0.3171 (0.4904) acc_x 90.6250 (86.8750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/27] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.6138 (0.4683) acc_x 87.5000 (87.1875) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [15/27] time 0.182 (0.179) data 0.105 (0.103) loss_x loss_x 0.3152 (0.4568) acc_x 96.8750 (87.7083) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [20/27] time 0.177 (0.180) data 0.100 (0.104) loss_x loss_x 0.5039 (0.4983) acc_x 90.6250 (86.7188) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [25/27] time 0.196 (0.182) data 0.119 (0.105) loss_x loss_x 0.3152 (0.5071) acc_x 90.6250 (86.0000) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/22] time 0.188 (0.183) data 0.112 (0.107) loss_u loss_u 0.8901 (0.8525) acc_u 12.5000 (16.8750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/22] time 0.182 (0.183) data 0.106 (0.107) loss_u loss_u 0.8906 (0.8649) acc_u 12.5000 (15.0000) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/22] time 0.187 (0.183) data 0.111 (0.107) loss_u loss_u 0.9126 (0.8829) acc_u 9.3750 (12.7083) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/22] time 0.185 (0.183) data 0.108 (0.107) loss_u loss_u 0.9043 (0.8890) acc_u 9.3750 (12.1875) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 313
confident_label rate tensor(0.5356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 857
clean true:852
clean false:5
clean_rate:0.9941656942823804
noisy true:435
noisy false:308
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 743
epoch [131/200] batch [5/26] time 0.183 (0.184) data 0.107 (0.109) loss_x loss_x 0.3105 (0.4016) acc_x 93.7500 (88.7500) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/26] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.7583 (0.4920) acc_x 71.8750 (86.2500) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/26] time 0.190 (0.184) data 0.115 (0.109) loss_x loss_x 0.1089 (0.4283) acc_x 100.0000 (88.1250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/26] time 0.184 (0.184) data 0.109 (0.108) loss_x loss_x 0.4937 (0.4483) acc_x 93.7500 (88.1250) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [25/26] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.6748 (0.4676) acc_x 78.1250 (87.6250) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/23] time 0.183 (0.184) data 0.107 (0.108) loss_u loss_u 0.9185 (0.8876) acc_u 9.3750 (13.7500) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/23] time 0.179 (0.183) data 0.103 (0.107) loss_u loss_u 0.9399 (0.8827) acc_u 9.3750 (13.4375) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/23] time 0.184 (0.183) data 0.108 (0.108) loss_u loss_u 0.8428 (0.8839) acc_u 15.6250 (13.1250) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/23] time 0.182 (0.183) data 0.106 (0.107) loss_u loss_u 0.9043 (0.8833) acc_u 6.2500 (12.6562) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 306
confident_label rate tensor(0.5369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 859
clean true:852
clean false:7
clean_rate:0.9918509895227008
noisy true:442
noisy false:299
after delete: len(clean_dataset) 859
after delete: len(noisy_dataset) 741
epoch [132/200] batch [5/26] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.8203 (0.5620) acc_x 68.7500 (85.6250) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/26] time 0.181 (0.183) data 0.106 (0.107) loss_x loss_x 0.8169 (0.5737) acc_x 75.0000 (84.0625) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/26] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.3250 (0.5099) acc_x 90.6250 (85.6250) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [20/26] time 0.197 (0.184) data 0.121 (0.108) loss_x loss_x 0.2649 (0.4964) acc_x 93.7500 (85.9375) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [25/26] time 0.184 (0.184) data 0.109 (0.108) loss_x loss_x 0.4290 (0.5004) acc_x 87.5000 (86.5000) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/23] time 0.185 (0.184) data 0.109 (0.108) loss_u loss_u 0.8423 (0.8292) acc_u 18.7500 (19.3750) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/23] time 0.184 (0.184) data 0.108 (0.108) loss_u loss_u 0.9385 (0.8632) acc_u 6.2500 (15.9375) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/23] time 0.186 (0.183) data 0.110 (0.108) loss_u loss_u 0.8467 (0.8773) acc_u 15.6250 (14.3750) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/23] time 0.222 (0.185) data 0.146 (0.109) loss_u loss_u 0.8311 (0.8733) acc_u 18.7500 (14.6875) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.5400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 864
clean true:858
clean false:6
clean_rate:0.9930555555555556
noisy true:433
noisy false:303
after delete: len(clean_dataset) 864
after delete: len(noisy_dataset) 736
epoch [133/200] batch [5/27] time 0.168 (0.181) data 0.091 (0.105) loss_x loss_x 0.3184 (0.5279) acc_x 90.6250 (88.1250) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/27] time 0.179 (0.179) data 0.103 (0.103) loss_x loss_x 0.5391 (0.4995) acc_x 84.3750 (89.0625) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [15/27] time 0.186 (0.180) data 0.110 (0.104) loss_x loss_x 0.4124 (0.4915) acc_x 93.7500 (88.7500) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/27] time 0.184 (0.181) data 0.108 (0.105) loss_x loss_x 0.4890 (0.5214) acc_x 90.6250 (87.9688) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [25/27] time 0.175 (0.181) data 0.099 (0.105) loss_x loss_x 0.5732 (0.5067) acc_x 81.2500 (87.8750) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/23] time 0.196 (0.182) data 0.118 (0.105) loss_u loss_u 0.8833 (0.9360) acc_u 12.5000 (6.8750) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/23] time 0.216 (0.183) data 0.140 (0.106) loss_u loss_u 0.8589 (0.9106) acc_u 12.5000 (9.6875) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/23] time 0.182 (0.184) data 0.105 (0.108) loss_u loss_u 0.8955 (0.8973) acc_u 9.3750 (11.2500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/23] time 0.182 (0.184) data 0.105 (0.108) loss_u loss_u 0.8325 (0.8873) acc_u 18.7500 (12.3438) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 318
confident_label rate tensor(0.5350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 856
clean true:850
clean false:6
clean_rate:0.9929906542056075
noisy true:432
noisy false:312
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 744
epoch [134/200] batch [5/26] time 0.182 (0.184) data 0.107 (0.108) loss_x loss_x 0.2610 (0.3834) acc_x 90.6250 (90.0000) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/26] time 0.185 (0.183) data 0.109 (0.108) loss_x loss_x 0.3257 (0.4167) acc_x 96.8750 (90.3125) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/26] time 0.186 (0.184) data 0.111 (0.108) loss_x loss_x 0.2452 (0.4830) acc_x 93.7500 (88.5417) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/26] time 0.185 (0.183) data 0.110 (0.107) loss_x loss_x 0.4431 (0.5058) acc_x 87.5000 (87.9688) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [25/26] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.4282 (0.4946) acc_x 84.3750 (88.1250) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/23] time 0.184 (0.184) data 0.108 (0.108) loss_u loss_u 0.8159 (0.8427) acc_u 21.8750 (17.5000) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/23] time 0.187 (0.184) data 0.111 (0.108) loss_u loss_u 0.8760 (0.8625) acc_u 12.5000 (15.6250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/23] time 0.181 (0.184) data 0.105 (0.108) loss_u loss_u 0.8105 (0.8690) acc_u 21.8750 (14.5833) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/23] time 0.180 (0.184) data 0.104 (0.108) loss_u loss_u 0.9155 (0.8772) acc_u 9.3750 (13.4375) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.5337, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 854
clean true:846
clean false:8
clean_rate:0.990632318501171
noisy true:429
noisy false:317
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 746
epoch [135/200] batch [5/26] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.6353 (0.4368) acc_x 78.1250 (85.6250) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/26] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.1964 (0.4250) acc_x 96.8750 (87.1875) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/26] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.3210 (0.4315) acc_x 96.8750 (88.3333) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [20/26] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.7534 (0.4430) acc_x 81.2500 (88.2812) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [25/26] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.2751 (0.4432) acc_x 93.7500 (87.8750) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/23] time 0.184 (0.184) data 0.108 (0.108) loss_u loss_u 0.8364 (0.8310) acc_u 18.7500 (19.3750) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/23] time 0.191 (0.184) data 0.114 (0.108) loss_u loss_u 0.8594 (0.8588) acc_u 15.6250 (15.6250) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/23] time 0.173 (0.183) data 0.096 (0.106) loss_u loss_u 0.7812 (0.8481) acc_u 25.0000 (16.6667) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/23] time 0.165 (0.181) data 0.087 (0.105) loss_u loss_u 0.9424 (0.8528) acc_u 6.2500 (16.2500) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 293
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:861
clean false:6
clean_rate:0.9930795847750865
noisy true:446
noisy false:287
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [136/200] batch [5/27] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.6235 (0.4669) acc_x 78.1250 (86.2500) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/27] time 0.164 (0.180) data 0.088 (0.104) loss_x loss_x 0.2334 (0.4366) acc_x 96.8750 (88.1250) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [15/27] time 0.183 (0.178) data 0.107 (0.102) loss_x loss_x 0.2532 (0.4620) acc_x 96.8750 (87.2917) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/27] time 0.186 (0.180) data 0.110 (0.104) loss_x loss_x 0.6025 (0.4687) acc_x 84.3750 (87.3438) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [25/27] time 0.202 (0.183) data 0.126 (0.107) loss_x loss_x 0.4805 (0.4591) acc_x 87.5000 (87.5000) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/22] time 0.195 (0.184) data 0.119 (0.108) loss_u loss_u 0.8838 (0.8697) acc_u 12.5000 (13.7500) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/22] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.8774 (0.8686) acc_u 12.5000 (14.3750) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/22] time 0.185 (0.184) data 0.109 (0.108) loss_u loss_u 0.7983 (0.8671) acc_u 25.0000 (15.0000) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/22] time 0.186 (0.184) data 0.110 (0.108) loss_u loss_u 0.9399 (0.8728) acc_u 6.2500 (14.3750) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 319
confident_label rate tensor(0.5375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 860
clean true:854
clean false:6
clean_rate:0.9930232558139535
noisy true:427
noisy false:313
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 740
epoch [137/200] batch [5/26] time 0.185 (0.193) data 0.109 (0.117) loss_x loss_x 0.3311 (0.4286) acc_x 93.7500 (91.2500) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/26] time 0.182 (0.188) data 0.107 (0.112) loss_x loss_x 0.6318 (0.3961) acc_x 81.2500 (90.0000) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [15/26] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.2366 (0.4268) acc_x 90.6250 (89.3750) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [20/26] time 0.182 (0.187) data 0.106 (0.111) loss_x loss_x 0.2739 (0.4089) acc_x 90.6250 (89.8438) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [25/26] time 0.179 (0.186) data 0.103 (0.110) loss_x loss_x 0.6387 (0.4217) acc_x 78.1250 (89.6250) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/23] time 0.180 (0.186) data 0.104 (0.110) loss_u loss_u 0.9116 (0.8844) acc_u 9.3750 (12.5000) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/23] time 0.182 (0.185) data 0.106 (0.110) loss_u loss_u 0.8301 (0.8854) acc_u 18.7500 (12.8125) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/23] time 0.186 (0.185) data 0.110 (0.109) loss_u loss_u 0.8975 (0.8797) acc_u 9.3750 (13.3333) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/23] time 0.161 (0.185) data 0.084 (0.109) loss_u loss_u 0.9766 (0.8831) acc_u 3.1250 (12.8125) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 862
clean true:856
clean false:6
clean_rate:0.9930394431554525
noisy true:434
noisy false:304
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 738
epoch [138/200] batch [5/26] time 0.193 (0.187) data 0.117 (0.111) loss_x loss_x 0.4761 (0.4034) acc_x 84.3750 (86.2500) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/26] time 0.181 (0.185) data 0.106 (0.109) loss_x loss_x 0.3713 (0.4950) acc_x 90.6250 (86.5625) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/26] time 0.183 (0.186) data 0.106 (0.110) loss_x loss_x 0.6089 (0.5008) acc_x 78.1250 (86.2500) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [20/26] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.4141 (0.4933) acc_x 87.5000 (86.8750) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [25/26] time 0.187 (0.186) data 0.111 (0.110) loss_x loss_x 0.3982 (0.5252) acc_x 87.5000 (86.3750) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/23] time 0.189 (0.185) data 0.112 (0.109) loss_u loss_u 0.8892 (0.8762) acc_u 12.5000 (14.3750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/23] time 0.184 (0.188) data 0.107 (0.112) loss_u loss_u 0.8896 (0.8783) acc_u 15.6250 (13.4375) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/23] time 0.187 (0.189) data 0.110 (0.113) loss_u loss_u 0.7822 (0.8659) acc_u 25.0000 (15.4167) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/23] time 0.186 (0.188) data 0.109 (0.112) loss_u loss_u 0.8145 (0.8642) acc_u 21.8750 (15.4688) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 320
confident_label rate tensor(0.5344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 855
clean true:847
clean false:8
clean_rate:0.9906432748538012
noisy true:433
noisy false:312
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 745
epoch [139/200] batch [5/26] time 0.172 (0.187) data 0.096 (0.111) loss_x loss_x 0.5347 (0.4086) acc_x 90.6250 (90.6250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/26] time 0.181 (0.184) data 0.105 (0.108) loss_x loss_x 0.2712 (0.4211) acc_x 93.7500 (89.6875) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/26] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.4353 (0.4315) acc_x 87.5000 (89.1667) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [20/26] time 0.210 (0.185) data 0.134 (0.109) loss_x loss_x 0.4502 (0.4517) acc_x 81.2500 (88.1250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [25/26] time 0.173 (0.183) data 0.097 (0.107) loss_x loss_x 0.3760 (0.4579) acc_x 93.7500 (88.2500) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/23] time 0.172 (0.184) data 0.095 (0.108) loss_u loss_u 0.7925 (0.8630) acc_u 21.8750 (14.3750) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/23] time 0.181 (0.183) data 0.104 (0.107) loss_u loss_u 0.8711 (0.8607) acc_u 12.5000 (15.3125) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/23] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9482 (0.8716) acc_u 3.1250 (14.3750) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/23] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.9746 (0.8756) acc_u 3.1250 (14.2188) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 321
confident_label rate tensor(0.5300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 848
clean true:844
clean false:4
clean_rate:0.9952830188679245
noisy true:435
noisy false:317
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 752
epoch [140/200] batch [5/26] time 0.220 (0.201) data 0.143 (0.125) loss_x loss_x 0.3628 (0.5850) acc_x 93.7500 (86.8750) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/26] time 0.186 (0.197) data 0.109 (0.121) loss_x loss_x 0.3083 (0.4998) acc_x 90.6250 (87.5000) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [15/26] time 0.182 (0.195) data 0.106 (0.119) loss_x loss_x 0.4990 (0.5481) acc_x 84.3750 (85.6250) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/26] time 0.184 (0.192) data 0.108 (0.116) loss_x loss_x 0.4509 (0.5345) acc_x 87.5000 (86.2500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [25/26] time 0.223 (0.194) data 0.147 (0.118) loss_x loss_x 0.4592 (0.5425) acc_x 90.6250 (85.6250) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/23] time 0.169 (0.191) data 0.092 (0.115) loss_u loss_u 0.9082 (0.8791) acc_u 9.3750 (13.7500) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/23] time 0.178 (0.189) data 0.101 (0.113) loss_u loss_u 0.9028 (0.8835) acc_u 9.3750 (13.1250) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/23] time 0.184 (0.189) data 0.107 (0.112) loss_u loss_u 0.8364 (0.8785) acc_u 15.6250 (13.7500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/23] time 0.185 (0.188) data 0.108 (0.112) loss_u loss_u 0.8511 (0.8676) acc_u 15.6250 (15.0000) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 318
confident_label rate tensor(0.5350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 856
clean true:850
clean false:6
clean_rate:0.9929906542056075
noisy true:432
noisy false:312
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 744
epoch [141/200] batch [5/26] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.5195 (0.5986) acc_x 87.5000 (86.8750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/26] time 0.215 (0.188) data 0.140 (0.112) loss_x loss_x 0.8066 (0.5661) acc_x 75.0000 (85.6250) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [15/26] time 0.221 (0.197) data 0.146 (0.121) loss_x loss_x 0.1489 (0.4956) acc_x 100.0000 (87.7083) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [20/26] time 0.220 (0.198) data 0.144 (0.122) loss_x loss_x 0.7197 (0.5039) acc_x 84.3750 (87.6562) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [25/26] time 0.184 (0.199) data 0.107 (0.123) loss_x loss_x 0.4297 (0.4979) acc_x 93.7500 (87.5000) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/23] time 0.218 (0.198) data 0.141 (0.122) loss_u loss_u 0.9365 (0.9330) acc_u 9.3750 (8.1250) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/23] time 0.184 (0.199) data 0.107 (0.123) loss_u loss_u 0.8105 (0.8892) acc_u 25.0000 (12.5000) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/23] time 0.191 (0.200) data 0.115 (0.123) loss_u loss_u 0.8174 (0.8853) acc_u 18.7500 (13.1250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/23] time 0.188 (0.199) data 0.111 (0.123) loss_u loss_u 0.8296 (0.8800) acc_u 18.7500 (13.5938) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 344
confident_label rate tensor(0.5406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 865
clean true:856
clean false:9
clean_rate:0.9895953757225433
noisy true:400
noisy false:335
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 735
epoch [142/200] batch [5/27] time 0.183 (0.185) data 0.106 (0.109) loss_x loss_x 0.4971 (0.4948) acc_x 78.1250 (86.8750) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [10/27] time 0.180 (0.188) data 0.103 (0.112) loss_x loss_x 0.3174 (0.4818) acc_x 90.6250 (86.8750) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [15/27] time 0.171 (0.185) data 0.094 (0.108) loss_x loss_x 0.2300 (0.4916) acc_x 93.7500 (86.8750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [20/27] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.2186 (0.4861) acc_x 93.7500 (87.1875) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [25/27] time 0.192 (0.184) data 0.115 (0.107) loss_x loss_x 0.3359 (0.4625) acc_x 93.7500 (88.0000) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/22] time 0.200 (0.185) data 0.123 (0.109) loss_u loss_u 0.8755 (0.8772) acc_u 15.6250 (14.3750) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/22] time 0.202 (0.189) data 0.126 (0.112) loss_u loss_u 0.8711 (0.8669) acc_u 15.6250 (16.5625) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/22] time 0.184 (0.188) data 0.108 (0.111) loss_u loss_u 0.7998 (0.8762) acc_u 21.8750 (15.2083) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/22] time 0.178 (0.186) data 0.101 (0.109) loss_u loss_u 0.9019 (0.8815) acc_u 9.3750 (14.0625) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.5487, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 878
clean true:869
clean false:9
clean_rate:0.989749430523918
noisy true:433
noisy false:289
after delete: len(clean_dataset) 878
after delete: len(noisy_dataset) 722
epoch [143/200] batch [5/27] time 0.200 (0.189) data 0.124 (0.113) loss_x loss_x 0.6357 (0.5851) acc_x 81.2500 (85.0000) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/27] time 0.186 (0.193) data 0.110 (0.117) loss_x loss_x 0.5156 (0.5496) acc_x 81.2500 (85.9375) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [15/27] time 0.184 (0.193) data 0.109 (0.117) loss_x loss_x 1.1348 (0.5546) acc_x 75.0000 (85.2083) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/27] time 0.218 (0.198) data 0.141 (0.122) loss_x loss_x 0.4180 (0.5224) acc_x 93.7500 (86.2500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [25/27] time 0.175 (0.192) data 0.099 (0.116) loss_x loss_x 0.7451 (0.5273) acc_x 78.1250 (85.8750) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/22] time 0.201 (0.190) data 0.124 (0.114) loss_u loss_u 0.8936 (0.9134) acc_u 12.5000 (10.0000) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/22] time 0.174 (0.190) data 0.097 (0.114) loss_u loss_u 0.8398 (0.9007) acc_u 18.7500 (10.9375) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/22] time 0.196 (0.189) data 0.119 (0.113) loss_u loss_u 0.9648 (0.8914) acc_u 3.1250 (11.8750) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/22] time 0.164 (0.190) data 0.086 (0.114) loss_u loss_u 0.9253 (0.8798) acc_u 12.5000 (13.5938) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 318
confident_label rate tensor(0.5412, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 866
clean true:856
clean false:10
clean_rate:0.9884526558891455
noisy true:426
noisy false:308
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 734
epoch [144/200] batch [5/27] time 0.183 (0.187) data 0.107 (0.111) loss_x loss_x 0.3572 (0.4070) acc_x 93.7500 (91.2500) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/27] time 0.191 (0.188) data 0.114 (0.112) loss_x loss_x 0.5908 (0.3537) acc_x 87.5000 (92.1875) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/27] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.4966 (0.3651) acc_x 87.5000 (90.8333) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [20/27] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.4724 (0.3751) acc_x 90.6250 (90.7812) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [25/27] time 0.185 (0.186) data 0.109 (0.110) loss_x loss_x 0.1594 (0.3981) acc_x 96.8750 (90.0000) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/22] time 0.188 (0.186) data 0.111 (0.110) loss_u loss_u 0.8643 (0.8783) acc_u 15.6250 (13.1250) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/22] time 0.192 (0.187) data 0.115 (0.110) loss_u loss_u 0.7783 (0.8669) acc_u 21.8750 (14.6875) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/22] time 0.190 (0.187) data 0.113 (0.111) loss_u loss_u 0.9678 (0.8761) acc_u 3.1250 (13.7500) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/22] time 0.183 (0.187) data 0.106 (0.111) loss_u loss_u 0.8462 (0.8794) acc_u 15.6250 (13.7500) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 859
clean true:852
clean false:7
clean_rate:0.9918509895227008
noisy true:438
noisy false:303
after delete: len(clean_dataset) 859
after delete: len(noisy_dataset) 741
epoch [145/200] batch [5/26] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.2749 (0.3465) acc_x 93.7500 (89.3750) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/26] time 0.168 (0.184) data 0.092 (0.108) loss_x loss_x 0.4014 (0.3838) acc_x 90.6250 (88.7500) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/26] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.3000 (0.3869) acc_x 90.6250 (88.7500) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/26] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.4297 (0.4375) acc_x 84.3750 (87.8125) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [25/26] time 0.187 (0.182) data 0.112 (0.106) loss_x loss_x 0.4895 (0.4404) acc_x 87.5000 (87.5000) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/23] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.9434 (0.8500) acc_u 6.2500 (16.8750) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/23] time 0.185 (0.182) data 0.109 (0.106) loss_u loss_u 0.8496 (0.8496) acc_u 18.7500 (17.1875) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/23] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.8545 (0.8652) acc_u 15.6250 (15.4167) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/23] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.8799 (0.8696) acc_u 12.5000 (14.6875) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.5387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 862
clean true:855
clean false:7
clean_rate:0.9918793503480279
noisy true:416
noisy false:322
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 738
epoch [146/200] batch [5/26] time 0.183 (0.192) data 0.107 (0.117) loss_x loss_x 0.4802 (0.4804) acc_x 90.6250 (87.5000) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/26] time 0.185 (0.188) data 0.109 (0.112) loss_x loss_x 0.3953 (0.4581) acc_x 84.3750 (89.0625) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/26] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.3752 (0.4321) acc_x 87.5000 (89.7917) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/26] time 0.181 (0.186) data 0.105 (0.110) loss_x loss_x 0.5605 (0.4632) acc_x 87.5000 (89.3750) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [25/26] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.2590 (0.4421) acc_x 93.7500 (89.5000) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/23] time 0.193 (0.186) data 0.116 (0.110) loss_u loss_u 0.9253 (0.9290) acc_u 6.2500 (8.7500) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/23] time 0.184 (0.186) data 0.108 (0.110) loss_u loss_u 0.8745 (0.9057) acc_u 12.5000 (10.3125) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/23] time 0.184 (0.186) data 0.108 (0.110) loss_u loss_u 0.8179 (0.8895) acc_u 18.7500 (11.8750) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/23] time 0.184 (0.186) data 0.108 (0.110) loss_u loss_u 0.8750 (0.8835) acc_u 12.5000 (12.5000) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.5350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 856
clean true:848
clean false:8
clean_rate:0.9906542056074766
noisy true:429
noisy false:315
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 744
epoch [147/200] batch [5/26] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.2896 (0.2196) acc_x 93.7500 (95.0000) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/26] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.3889 (0.3308) acc_x 93.7500 (91.8750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/26] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.4453 (0.3795) acc_x 90.6250 (90.4167) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [20/26] time 0.180 (0.186) data 0.104 (0.110) loss_x loss_x 0.3794 (0.3899) acc_x 84.3750 (90.1562) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [25/26] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.3584 (0.4416) acc_x 90.6250 (89.6250) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/23] time 0.185 (0.185) data 0.108 (0.109) loss_u loss_u 0.8745 (0.8589) acc_u 12.5000 (15.0000) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/23] time 0.178 (0.184) data 0.101 (0.107) loss_u loss_u 0.8066 (0.8507) acc_u 18.7500 (16.2500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/23] time 0.185 (0.183) data 0.107 (0.107) loss_u loss_u 0.9072 (0.8468) acc_u 9.3750 (16.6667) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/23] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.8682 (0.8559) acc_u 12.5000 (15.6250) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 853
clean true:844
clean false:9
clean_rate:0.9894490035169988
noisy true:420
noisy false:327
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 747
epoch [148/200] batch [5/26] time 0.205 (0.188) data 0.129 (0.112) loss_x loss_x 0.4131 (0.4867) acc_x 87.5000 (83.7500) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/26] time 0.189 (0.186) data 0.114 (0.110) loss_x loss_x 0.3164 (0.3834) acc_x 93.7500 (88.4375) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/26] time 0.187 (0.186) data 0.112 (0.110) loss_x loss_x 0.3289 (0.3969) acc_x 90.6250 (88.7500) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/26] time 0.180 (0.185) data 0.104 (0.109) loss_x loss_x 0.5513 (0.4179) acc_x 87.5000 (87.9688) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [25/26] time 0.186 (0.189) data 0.110 (0.113) loss_x loss_x 0.5981 (0.4409) acc_x 81.2500 (87.5000) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/23] time 0.184 (0.187) data 0.108 (0.112) loss_u loss_u 0.8501 (0.8765) acc_u 18.7500 (13.7500) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/23] time 0.183 (0.187) data 0.106 (0.111) loss_u loss_u 0.8018 (0.8826) acc_u 25.0000 (13.4375) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/23] time 0.185 (0.187) data 0.109 (0.111) loss_u loss_u 0.7861 (0.8754) acc_u 25.0000 (14.1667) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/23] time 0.181 (0.186) data 0.105 (0.110) loss_u loss_u 0.7788 (0.8672) acc_u 28.1250 (15.4688) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 305
confident_label rate tensor(0.5462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 874
clean true:863
clean false:11
clean_rate:0.9874141876430206
noisy true:432
noisy false:294
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 726
epoch [149/200] batch [5/27] time 0.179 (0.183) data 0.104 (0.108) loss_x loss_x 0.4570 (0.4235) acc_x 93.7500 (91.8750) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/27] time 0.185 (0.183) data 0.109 (0.108) loss_x loss_x 0.2681 (0.4915) acc_x 90.6250 (88.1250) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [15/27] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.1869 (0.4446) acc_x 96.8750 (88.9583) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/27] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.5283 (0.4318) acc_x 84.3750 (89.3750) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [25/27] time 0.183 (0.183) data 0.108 (0.107) loss_x loss_x 0.2876 (0.4434) acc_x 93.7500 (89.2500) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/22] time 0.184 (0.183) data 0.108 (0.107) loss_u loss_u 0.9380 (0.9036) acc_u 6.2500 (10.0000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/22] time 0.185 (0.183) data 0.109 (0.107) loss_u loss_u 0.9429 (0.8907) acc_u 6.2500 (12.1875) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/22] time 0.174 (0.182) data 0.098 (0.106) loss_u loss_u 0.7935 (0.8804) acc_u 28.1250 (13.5417) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/22] time 0.193 (0.182) data 0.117 (0.106) loss_u loss_u 0.9316 (0.8831) acc_u 6.2500 (13.1250) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.5350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 856
clean true:847
clean false:9
clean_rate:0.9894859813084113
noisy true:421
noisy false:323
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 744
epoch [150/200] batch [5/26] time 0.189 (0.186) data 0.112 (0.109) loss_x loss_x 0.4561 (0.5279) acc_x 87.5000 (86.2500) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/26] time 0.185 (0.186) data 0.109 (0.110) loss_x loss_x 0.3696 (0.4340) acc_x 93.7500 (88.4375) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/26] time 0.176 (0.184) data 0.100 (0.108) loss_x loss_x 0.9023 (0.5210) acc_x 81.2500 (87.0833) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [20/26] time 0.165 (0.181) data 0.088 (0.104) loss_x loss_x 0.3347 (0.4914) acc_x 90.6250 (87.9688) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [25/26] time 0.174 (0.180) data 0.098 (0.104) loss_x loss_x 0.2350 (0.4684) acc_x 93.7500 (88.6250) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/23] time 0.176 (0.179) data 0.099 (0.103) loss_u loss_u 0.8569 (0.8930) acc_u 15.6250 (12.5000) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/23] time 0.184 (0.180) data 0.106 (0.104) loss_u loss_u 0.7847 (0.8832) acc_u 25.0000 (14.0625) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/23] time 0.189 (0.180) data 0.112 (0.104) loss_u loss_u 0.8330 (0.8740) acc_u 18.7500 (14.5833) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/23] time 0.182 (0.180) data 0.105 (0.104) loss_u loss_u 0.7832 (0.8729) acc_u 21.8750 (14.0625) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 302
confident_label rate tensor(0.5481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 877
clean true:869
clean false:8
clean_rate:0.9908779931584949
noisy true:429
noisy false:294
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 723
epoch [151/200] batch [5/27] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.4023 (0.3086) acc_x 87.5000 (90.6250) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/27] time 0.208 (0.187) data 0.132 (0.111) loss_x loss_x 0.2979 (0.3597) acc_x 84.3750 (90.3125) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [15/27] time 0.184 (0.188) data 0.108 (0.112) loss_x loss_x 0.8857 (0.4147) acc_x 81.2500 (89.3750) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [20/27] time 0.182 (0.189) data 0.107 (0.113) loss_x loss_x 0.5537 (0.4674) acc_x 87.5000 (88.1250) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [25/27] time 0.184 (0.188) data 0.108 (0.112) loss_x loss_x 0.5522 (0.4587) acc_x 78.1250 (87.8750) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/22] time 0.186 (0.187) data 0.110 (0.111) loss_u loss_u 0.8564 (0.8781) acc_u 15.6250 (13.7500) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/22] time 0.198 (0.187) data 0.122 (0.111) loss_u loss_u 0.8911 (0.8960) acc_u 12.5000 (11.5625) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/22] time 0.182 (0.187) data 0.105 (0.111) loss_u loss_u 0.9585 (0.8944) acc_u 3.1250 (12.0833) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/22] time 0.188 (0.187) data 0.111 (0.110) loss_u loss_u 0.8813 (0.8914) acc_u 12.5000 (12.1875) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.5281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 845
clean true:834
clean false:11
clean_rate:0.98698224852071
noisy true:419
noisy false:336
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 755
epoch [152/200] batch [5/26] time 0.167 (0.181) data 0.090 (0.105) loss_x loss_x 0.3337 (0.4377) acc_x 87.5000 (90.0000) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/26] time 0.183 (0.180) data 0.107 (0.104) loss_x loss_x 0.6504 (0.4330) acc_x 81.2500 (89.0625) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/26] time 0.185 (0.179) data 0.109 (0.103) loss_x loss_x 0.2981 (0.4577) acc_x 90.6250 (88.5417) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/26] time 0.178 (0.178) data 0.101 (0.102) loss_x loss_x 0.4338 (0.4322) acc_x 90.6250 (89.3750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [25/26] time 0.183 (0.179) data 0.107 (0.102) loss_x loss_x 0.6631 (0.4590) acc_x 81.2500 (88.6250) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/23] time 0.183 (0.180) data 0.105 (0.103) loss_u loss_u 0.8530 (0.8540) acc_u 18.7500 (17.5000) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/23] time 0.185 (0.180) data 0.108 (0.104) loss_u loss_u 0.8677 (0.8661) acc_u 12.5000 (15.0000) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/23] time 0.184 (0.180) data 0.107 (0.104) loss_u loss_u 0.8721 (0.8607) acc_u 12.5000 (15.4167) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/23] time 0.186 (0.180) data 0.109 (0.104) loss_u loss_u 0.8120 (0.8591) acc_u 21.8750 (15.7812) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 305
confident_label rate tensor(0.5456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 873
clean true:869
clean false:4
clean_rate:0.995418098510882
noisy true:426
noisy false:301
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 727
epoch [153/200] batch [5/27] time 0.181 (0.190) data 0.105 (0.114) loss_x loss_x 0.7021 (0.5787) acc_x 78.1250 (82.5000) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/27] time 0.189 (0.188) data 0.113 (0.112) loss_x loss_x 0.1724 (0.4566) acc_x 93.7500 (86.2500) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [15/27] time 0.170 (0.185) data 0.094 (0.108) loss_x loss_x 0.4663 (0.4999) acc_x 90.6250 (86.6667) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/27] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.4275 (0.5027) acc_x 87.5000 (87.1875) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [25/27] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.4392 (0.5225) acc_x 87.5000 (86.5000) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/22] time 0.186 (0.185) data 0.110 (0.109) loss_u loss_u 0.9136 (0.9123) acc_u 9.3750 (10.0000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/22] time 0.181 (0.184) data 0.104 (0.108) loss_u loss_u 0.8345 (0.8982) acc_u 18.7500 (10.9375) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/22] time 0.181 (0.184) data 0.105 (0.108) loss_u loss_u 0.9043 (0.8968) acc_u 9.3750 (11.2500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/22] time 0.182 (0.184) data 0.106 (0.107) loss_u loss_u 0.9111 (0.8892) acc_u 9.3750 (12.0312) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.5469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 875
clean true:871
clean false:4
clean_rate:0.9954285714285714
noisy true:430
noisy false:295
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 725
epoch [154/200] batch [5/27] time 0.186 (0.186) data 0.110 (0.109) loss_x loss_x 0.4919 (0.3939) acc_x 84.3750 (86.2500) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/27] time 0.192 (0.186) data 0.116 (0.109) loss_x loss_x 0.2725 (0.3739) acc_x 90.6250 (88.7500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [15/27] time 0.207 (0.187) data 0.130 (0.111) loss_x loss_x 0.4238 (0.3761) acc_x 90.6250 (89.7917) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/27] time 0.181 (0.187) data 0.106 (0.111) loss_x loss_x 0.4849 (0.4036) acc_x 81.2500 (88.7500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [25/27] time 0.185 (0.186) data 0.110 (0.110) loss_x loss_x 0.1865 (0.4258) acc_x 93.7500 (88.5000) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/22] time 0.186 (0.186) data 0.110 (0.110) loss_u loss_u 0.8916 (0.9052) acc_u 12.5000 (10.6250) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/22] time 0.180 (0.186) data 0.104 (0.110) loss_u loss_u 0.8213 (0.8829) acc_u 21.8750 (12.8125) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/22] time 0.196 (0.186) data 0.120 (0.110) loss_u loss_u 0.8984 (0.8787) acc_u 12.5000 (13.7500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/22] time 0.185 (0.187) data 0.108 (0.111) loss_u loss_u 0.8687 (0.8794) acc_u 12.5000 (13.5938) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 312
confident_label rate tensor(0.5394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 863
clean true:858
clean false:5
clean_rate:0.9942062572421785
noisy true:430
noisy false:307
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 737
epoch [155/200] batch [5/26] time 0.171 (0.182) data 0.094 (0.106) loss_x loss_x 0.2749 (0.4189) acc_x 93.7500 (86.8750) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/26] time 0.182 (0.180) data 0.106 (0.104) loss_x loss_x 0.2737 (0.4346) acc_x 96.8750 (86.8750) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/26] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.3586 (0.4097) acc_x 90.6250 (87.2917) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/26] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.1469 (0.3760) acc_x 96.8750 (88.4375) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [25/26] time 0.203 (0.183) data 0.126 (0.107) loss_x loss_x 0.4009 (0.3862) acc_x 90.6250 (88.0000) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/23] time 0.195 (0.186) data 0.118 (0.110) loss_u loss_u 0.8994 (0.9276) acc_u 12.5000 (10.0000) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/23] time 0.185 (0.185) data 0.109 (0.109) loss_u loss_u 0.8726 (0.8999) acc_u 12.5000 (11.8750) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/23] time 0.187 (0.185) data 0.111 (0.109) loss_u loss_u 0.7974 (0.8852) acc_u 21.8750 (12.9167) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/23] time 0.183 (0.185) data 0.106 (0.109) loss_u loss_u 0.9556 (0.8852) acc_u 6.2500 (12.9688) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 302
confident_label rate tensor(0.5362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 858
clean true:851
clean false:7
clean_rate:0.9918414918414918
noisy true:447
noisy false:295
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 742
epoch [156/200] batch [5/26] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.5688 (0.3946) acc_x 81.2500 (88.7500) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/26] time 0.182 (0.180) data 0.106 (0.104) loss_x loss_x 0.6489 (0.4648) acc_x 84.3750 (88.7500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/26] time 0.219 (0.185) data 0.142 (0.109) loss_x loss_x 0.3923 (0.4125) acc_x 93.7500 (90.6250) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/26] time 0.180 (0.190) data 0.104 (0.114) loss_x loss_x 0.7842 (0.4615) acc_x 81.2500 (89.2188) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [25/26] time 0.193 (0.194) data 0.117 (0.118) loss_x loss_x 0.5181 (0.4824) acc_x 87.5000 (88.5000) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/23] time 0.220 (0.196) data 0.144 (0.120) loss_u loss_u 0.8950 (0.8632) acc_u 12.5000 (16.8750) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/23] time 0.188 (0.195) data 0.111 (0.119) loss_u loss_u 0.7783 (0.8643) acc_u 25.0000 (15.6250) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/23] time 0.182 (0.194) data 0.104 (0.118) loss_u loss_u 0.7544 (0.8671) acc_u 25.0000 (15.0000) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/23] time 0.185 (0.193) data 0.108 (0.116) loss_u loss_u 0.8711 (0.8676) acc_u 12.5000 (14.8438) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 292
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:862
clean false:5
clean_rate:0.994232987312572
noisy true:446
noisy false:287
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [157/200] batch [5/27] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.4922 (0.4664) acc_x 90.6250 (90.0000) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/27] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.4897 (0.4824) acc_x 87.5000 (88.1250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/27] time 0.163 (0.179) data 0.087 (0.103) loss_x loss_x 0.3608 (0.4375) acc_x 87.5000 (88.3333) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/27] time 0.164 (0.175) data 0.088 (0.099) loss_x loss_x 0.3569 (0.4066) acc_x 90.6250 (88.5938) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [25/27] time 0.161 (0.174) data 0.085 (0.098) loss_x loss_x 0.7422 (0.4144) acc_x 75.0000 (88.5000) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/22] time 0.169 (0.173) data 0.092 (0.097) loss_u loss_u 0.8364 (0.8718) acc_u 15.6250 (14.3750) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/22] time 0.162 (0.172) data 0.085 (0.095) loss_u loss_u 0.8267 (0.8689) acc_u 18.7500 (14.0625) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/22] time 0.177 (0.171) data 0.101 (0.095) loss_u loss_u 0.8687 (0.8685) acc_u 18.7500 (14.5833) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/22] time 0.188 (0.172) data 0.110 (0.095) loss_u loss_u 0.8394 (0.8732) acc_u 15.6250 (14.0625) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.5481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 877
clean true:867
clean false:10
clean_rate:0.9885974914481186
noisy true:424
noisy false:299
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 723
epoch [158/200] batch [5/27] time 0.182 (0.175) data 0.106 (0.099) loss_x loss_x 0.5449 (0.5791) acc_x 90.6250 (86.2500) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/27] time 0.188 (0.180) data 0.111 (0.104) loss_x loss_x 0.2607 (0.4947) acc_x 96.8750 (86.8750) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [15/27] time 0.190 (0.181) data 0.114 (0.105) loss_x loss_x 0.5337 (0.5137) acc_x 90.6250 (86.4583) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/27] time 0.177 (0.179) data 0.101 (0.103) loss_x loss_x 0.2476 (0.4911) acc_x 96.8750 (86.7188) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [25/27] time 0.188 (0.180) data 0.112 (0.104) loss_x loss_x 0.6699 (0.4724) acc_x 87.5000 (87.5000) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/22] time 0.190 (0.181) data 0.114 (0.105) loss_u loss_u 0.9185 (0.8601) acc_u 9.3750 (16.2500) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/22] time 0.185 (0.181) data 0.109 (0.105) loss_u loss_u 0.9482 (0.8870) acc_u 6.2500 (13.1250) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/22] time 0.162 (0.180) data 0.085 (0.104) loss_u loss_u 0.9482 (0.8892) acc_u 3.1250 (12.2917) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/22] time 0.167 (0.179) data 0.091 (0.103) loss_u loss_u 0.8799 (0.8877) acc_u 12.5000 (12.3438) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.5381, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 861
clean true:853
clean false:8
clean_rate:0.9907084785133565
noisy true:431
noisy false:308
after delete: len(clean_dataset) 861
after delete: len(noisy_dataset) 739
epoch [159/200] batch [5/26] time 0.182 (0.185) data 0.107 (0.109) loss_x loss_x 0.4497 (0.4290) acc_x 87.5000 (86.8750) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/26] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.6084 (0.4849) acc_x 84.3750 (87.1875) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/26] time 0.179 (0.183) data 0.103 (0.107) loss_x loss_x 0.4302 (0.4829) acc_x 90.6250 (87.2917) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/26] time 0.190 (0.184) data 0.115 (0.108) loss_x loss_x 0.5054 (0.4489) acc_x 90.6250 (88.1250) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [25/26] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.4014 (0.4315) acc_x 93.7500 (88.6250) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/23] time 0.182 (0.184) data 0.106 (0.108) loss_u loss_u 0.9443 (0.8585) acc_u 6.2500 (16.2500) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/23] time 0.187 (0.184) data 0.111 (0.109) loss_u loss_u 0.9434 (0.8829) acc_u 6.2500 (13.1250) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/23] time 0.185 (0.184) data 0.109 (0.108) loss_u loss_u 0.8516 (0.8736) acc_u 15.6250 (14.1667) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/23] time 0.181 (0.184) data 0.105 (0.108) loss_u loss_u 0.7788 (0.8724) acc_u 25.0000 (14.3750) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 306
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:858
clean false:9
clean_rate:0.9896193771626297
noisy true:436
noisy false:297
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [160/200] batch [5/27] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.2369 (0.3637) acc_x 90.6250 (89.3750) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/27] time 0.182 (0.179) data 0.106 (0.103) loss_x loss_x 0.8081 (0.5020) acc_x 78.1250 (86.8750) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [15/27] time 0.182 (0.179) data 0.106 (0.103) loss_x loss_x 0.4839 (0.4222) acc_x 93.7500 (89.5833) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/27] time 0.179 (0.181) data 0.104 (0.105) loss_x loss_x 0.2737 (0.4213) acc_x 90.6250 (89.6875) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [25/27] time 0.194 (0.182) data 0.118 (0.106) loss_x loss_x 0.2168 (0.3965) acc_x 93.7500 (89.5000) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/22] time 0.188 (0.183) data 0.112 (0.107) loss_u loss_u 0.9507 (0.8849) acc_u 6.2500 (13.1250) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/22] time 0.187 (0.183) data 0.111 (0.107) loss_u loss_u 0.8555 (0.8778) acc_u 15.6250 (13.7500) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/22] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.8428 (0.8774) acc_u 18.7500 (13.9583) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/22] time 0.185 (0.183) data 0.109 (0.107) loss_u loss_u 0.9458 (0.8736) acc_u 9.3750 (14.6875) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 883
clean true:873
clean false:10
clean_rate:0.9886749716874292
noisy true:417
noisy false:300
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 717
epoch [161/200] batch [5/27] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.4746 (0.5420) acc_x 87.5000 (85.6250) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/27] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.4402 (0.4951) acc_x 84.3750 (87.5000) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [15/27] time 0.188 (0.185) data 0.113 (0.109) loss_x loss_x 0.3203 (0.4425) acc_x 93.7500 (89.1667) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/27] time 0.180 (0.185) data 0.104 (0.109) loss_x loss_x 0.1367 (0.4271) acc_x 96.8750 (89.6875) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [25/27] time 0.188 (0.184) data 0.112 (0.109) loss_x loss_x 0.3684 (0.4532) acc_x 84.3750 (88.7500) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/22] time 0.183 (0.184) data 0.107 (0.108) loss_u loss_u 0.8750 (0.8856) acc_u 12.5000 (13.1250) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/22] time 0.179 (0.184) data 0.103 (0.108) loss_u loss_u 0.9302 (0.8780) acc_u 9.3750 (13.4375) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/22] time 0.183 (0.184) data 0.107 (0.108) loss_u loss_u 0.8970 (0.8839) acc_u 12.5000 (12.9167) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/22] time 0.182 (0.184) data 0.105 (0.108) loss_u loss_u 0.9575 (0.8865) acc_u 6.2500 (12.8125) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.5437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 870
clean true:863
clean false:7
clean_rate:0.9919540229885058
noisy true:438
noisy false:292
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 730
epoch [162/200] batch [5/27] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.3369 (0.4154) acc_x 87.5000 (90.6250) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/27] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.5239 (0.4615) acc_x 87.5000 (88.4375) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [15/27] time 0.180 (0.184) data 0.104 (0.108) loss_x loss_x 0.5356 (0.4528) acc_x 78.1250 (87.9167) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/27] time 0.184 (0.185) data 0.109 (0.109) loss_x loss_x 1.1387 (0.4892) acc_x 68.7500 (87.6562) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [25/27] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.5435 (0.4821) acc_x 78.1250 (87.5000) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/22] time 0.185 (0.184) data 0.109 (0.108) loss_u loss_u 0.9014 (0.8534) acc_u 9.3750 (15.6250) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/22] time 0.181 (0.184) data 0.104 (0.108) loss_u loss_u 0.9106 (0.8873) acc_u 9.3750 (12.1875) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/22] time 0.180 (0.184) data 0.104 (0.108) loss_u loss_u 0.8423 (0.8836) acc_u 18.7500 (12.9167) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/22] time 0.185 (0.184) data 0.109 (0.108) loss_u loss_u 0.9053 (0.8844) acc_u 9.3750 (12.6562) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 256
confident_label rate tensor(0.5575, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 892
clean true:883
clean false:9
clean_rate:0.9899103139013453
noisy true:461
noisy false:247
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 708
epoch [163/200] batch [5/27] time 0.181 (0.186) data 0.105 (0.110) loss_x loss_x 0.1748 (0.4762) acc_x 96.8750 (89.3750) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/27] time 0.179 (0.185) data 0.103 (0.109) loss_x loss_x 0.5381 (0.4729) acc_x 87.5000 (88.7500) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [15/27] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.3679 (0.4899) acc_x 90.6250 (87.7083) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/27] time 0.186 (0.184) data 0.111 (0.108) loss_x loss_x 0.7910 (0.5281) acc_x 81.2500 (86.5625) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [25/27] time 0.180 (0.184) data 0.105 (0.108) loss_x loss_x 0.5947 (0.5196) acc_x 90.6250 (86.5000) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/22] time 0.182 (0.183) data 0.105 (0.107) loss_u loss_u 0.9858 (0.9111) acc_u 0.0000 (9.3750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/22] time 0.181 (0.184) data 0.105 (0.108) loss_u loss_u 0.8911 (0.8987) acc_u 12.5000 (11.5625) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/22] time 0.173 (0.183) data 0.096 (0.107) loss_u loss_u 0.9351 (0.9117) acc_u 6.2500 (9.7917) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/22] time 0.176 (0.182) data 0.099 (0.106) loss_u loss_u 0.9160 (0.9007) acc_u 9.3750 (10.9375) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 860
clean true:855
clean false:5
clean_rate:0.9941860465116279
noisy true:435
noisy false:305
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 740
epoch [164/200] batch [5/26] time 0.181 (0.186) data 0.105 (0.110) loss_x loss_x 0.4033 (0.4203) acc_x 90.6250 (87.5000) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/26] time 0.195 (0.188) data 0.119 (0.112) loss_x loss_x 0.3616 (0.4170) acc_x 93.7500 (89.0625) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/26] time 0.182 (0.186) data 0.106 (0.110) loss_x loss_x 0.3445 (0.3690) acc_x 93.7500 (90.2083) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/26] time 0.189 (0.186) data 0.113 (0.110) loss_x loss_x 0.5581 (0.3830) acc_x 84.3750 (89.2188) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [25/26] time 0.182 (0.185) data 0.106 (0.109) loss_x loss_x 0.3127 (0.3747) acc_x 84.3750 (89.2500) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/23] time 0.182 (0.185) data 0.105 (0.109) loss_u loss_u 0.9351 (0.9088) acc_u 9.3750 (10.6250) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/23] time 0.181 (0.185) data 0.104 (0.109) loss_u loss_u 0.8877 (0.8790) acc_u 9.3750 (13.4375) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/23] time 0.185 (0.185) data 0.108 (0.109) loss_u loss_u 0.8301 (0.8776) acc_u 15.6250 (13.5417) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/23] time 0.182 (0.184) data 0.106 (0.108) loss_u loss_u 0.8604 (0.8742) acc_u 15.6250 (13.9062) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 334
confident_label rate tensor(0.5319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 851
clean true:842
clean false:9
clean_rate:0.9894242068155111
noisy true:424
noisy false:325
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 749
epoch [165/200] batch [5/26] time 0.187 (0.185) data 0.112 (0.109) loss_x loss_x 0.5293 (0.4496) acc_x 87.5000 (86.8750) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/26] time 0.186 (0.185) data 0.111 (0.109) loss_x loss_x 0.2159 (0.4068) acc_x 93.7500 (89.6875) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/26] time 0.192 (0.185) data 0.116 (0.109) loss_x loss_x 0.4353 (0.3936) acc_x 93.7500 (90.0000) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/26] time 0.180 (0.184) data 0.104 (0.108) loss_x loss_x 0.3350 (0.4019) acc_x 90.6250 (89.6875) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [25/26] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.4478 (0.4289) acc_x 87.5000 (88.8750) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/23] time 0.197 (0.184) data 0.120 (0.109) loss_u loss_u 0.8579 (0.8806) acc_u 15.6250 (13.7500) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/23] time 0.178 (0.183) data 0.102 (0.107) loss_u loss_u 0.8730 (0.8725) acc_u 15.6250 (15.3125) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/23] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.8818 (0.8676) acc_u 12.5000 (15.6250) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/23] time 0.178 (0.183) data 0.102 (0.107) loss_u loss_u 0.8394 (0.8584) acc_u 18.7500 (17.0312) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.5481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 877
clean true:870
clean false:7
clean_rate:0.992018244013683
noisy true:423
noisy false:300
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 723
epoch [166/200] batch [5/27] time 0.190 (0.185) data 0.114 (0.109) loss_x loss_x 0.2888 (0.4075) acc_x 90.6250 (89.3750) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [10/27] time 0.181 (0.184) data 0.105 (0.108) loss_x loss_x 0.3650 (0.4019) acc_x 93.7500 (88.7500) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [15/27] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.2017 (0.3813) acc_x 93.7500 (88.9583) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/27] time 0.183 (0.184) data 0.106 (0.109) loss_x loss_x 0.1808 (0.3808) acc_x 100.0000 (88.9062) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [25/27] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.1838 (0.3776) acc_x 93.7500 (89.1250) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/22] time 0.179 (0.184) data 0.103 (0.108) loss_u loss_u 0.9238 (0.9167) acc_u 6.2500 (8.7500) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/22] time 0.185 (0.184) data 0.109 (0.108) loss_u loss_u 0.9453 (0.8916) acc_u 6.2500 (11.2500) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/22] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.9355 (0.8787) acc_u 9.3750 (13.5417) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/22] time 0.188 (0.185) data 0.111 (0.108) loss_u loss_u 0.8569 (0.8790) acc_u 15.6250 (13.4375) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 286
confident_label rate tensor(0.5412, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 866
clean true:857
clean false:9
clean_rate:0.9896073903002309
noisy true:457
noisy false:277
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 734
epoch [167/200] batch [5/27] time 0.174 (0.183) data 0.098 (0.107) loss_x loss_x 0.4365 (0.3684) acc_x 87.5000 (90.6250) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/27] time 0.178 (0.179) data 0.101 (0.103) loss_x loss_x 0.2998 (0.3340) acc_x 93.7500 (91.2500) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/27] time 0.181 (0.180) data 0.105 (0.104) loss_x loss_x 0.4336 (0.3988) acc_x 90.6250 (89.5833) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/27] time 0.179 (0.181) data 0.102 (0.105) loss_x loss_x 0.5254 (0.4208) acc_x 84.3750 (88.9062) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [25/27] time 0.189 (0.182) data 0.112 (0.106) loss_x loss_x 0.3721 (0.4437) acc_x 93.7500 (88.3750) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/22] time 0.182 (0.182) data 0.105 (0.106) loss_u loss_u 0.8716 (0.8614) acc_u 15.6250 (15.6250) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/22] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9082 (0.8762) acc_u 9.3750 (13.4375) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/22] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9663 (0.8816) acc_u 3.1250 (12.7083) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/22] time 0.170 (0.182) data 0.093 (0.106) loss_u loss_u 0.8408 (0.8701) acc_u 15.6250 (14.0625) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 293
confident_label rate tensor(0.5519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 883
clean true:873
clean false:10
clean_rate:0.9886749716874292
noisy true:434
noisy false:283
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 717
epoch [168/200] batch [5/27] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.6177 (0.4630) acc_x 90.6250 (90.6250) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/27] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.4280 (0.4185) acc_x 90.6250 (90.3125) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/27] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.3811 (0.4456) acc_x 90.6250 (89.3750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/27] time 0.182 (0.184) data 0.107 (0.108) loss_x loss_x 0.5024 (0.4373) acc_x 90.6250 (89.8438) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [25/27] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.2988 (0.4420) acc_x 93.7500 (89.6250) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/22] time 0.186 (0.184) data 0.108 (0.108) loss_u loss_u 0.8657 (0.8787) acc_u 12.5000 (13.1250) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/22] time 0.186 (0.184) data 0.109 (0.108) loss_u loss_u 0.8418 (0.8728) acc_u 18.7500 (13.7500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/22] time 0.180 (0.183) data 0.103 (0.107) loss_u loss_u 0.8857 (0.8794) acc_u 12.5000 (13.1250) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/22] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.8696 (0.8861) acc_u 15.6250 (12.6562) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 319
confident_label rate tensor(0.5406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 865
clean true:858
clean false:7
clean_rate:0.991907514450867
noisy true:423
noisy false:312
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 735
epoch [169/200] batch [5/27] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.3674 (0.4287) acc_x 84.3750 (86.8750) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/27] time 0.212 (0.185) data 0.136 (0.110) loss_x loss_x 0.4470 (0.3528) acc_x 87.5000 (90.3125) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/27] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.3391 (0.3761) acc_x 90.6250 (90.2083) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/27] time 0.184 (0.189) data 0.108 (0.114) loss_x loss_x 0.4805 (0.3684) acc_x 87.5000 (90.6250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [25/27] time 0.166 (0.187) data 0.090 (0.111) loss_x loss_x 0.0696 (0.3792) acc_x 96.8750 (90.5000) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/22] time 0.185 (0.186) data 0.109 (0.110) loss_u loss_u 0.9160 (0.8884) acc_u 9.3750 (13.1250) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/22] time 0.185 (0.186) data 0.109 (0.110) loss_u loss_u 0.8208 (0.8646) acc_u 18.7500 (15.0000) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/22] time 0.183 (0.185) data 0.107 (0.109) loss_u loss_u 0.8628 (0.8820) acc_u 15.6250 (13.1250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/22] time 0.185 (0.185) data 0.109 (0.109) loss_u loss_u 0.9023 (0.8883) acc_u 12.5000 (12.3438) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.5437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 870
clean true:862
clean false:8
clean_rate:0.9908045977011494
noisy true:422
noisy false:308
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 730
epoch [170/200] batch [5/27] time 0.178 (0.184) data 0.102 (0.108) loss_x loss_x 0.4670 (0.3423) acc_x 81.2500 (89.3750) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/27] time 0.161 (0.183) data 0.084 (0.107) loss_x loss_x 0.2069 (0.3593) acc_x 96.8750 (89.3750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/27] time 0.175 (0.182) data 0.098 (0.105) loss_x loss_x 0.3303 (0.3860) acc_x 93.7500 (88.9583) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/27] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 0.2646 (0.4351) acc_x 96.8750 (87.8125) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [25/27] time 0.175 (0.181) data 0.099 (0.105) loss_x loss_x 0.6494 (0.4459) acc_x 84.3750 (88.0000) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/22] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9062 (0.8979) acc_u 9.3750 (11.2500) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/22] time 0.188 (0.182) data 0.111 (0.106) loss_u loss_u 0.9209 (0.8932) acc_u 9.3750 (11.8750) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/22] time 0.171 (0.183) data 0.094 (0.106) loss_u loss_u 0.8379 (0.8806) acc_u 15.6250 (12.9167) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/22] time 0.189 (0.182) data 0.113 (0.105) loss_u loss_u 0.8540 (0.8788) acc_u 15.6250 (13.2812) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 856
clean true:848
clean false:8
clean_rate:0.9906542056074766
noisy true:417
noisy false:327
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 744
epoch [171/200] batch [5/26] time 0.174 (0.181) data 0.097 (0.104) loss_x loss_x 0.3486 (0.3951) acc_x 90.6250 (87.5000) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/26] time 0.168 (0.176) data 0.092 (0.099) loss_x loss_x 0.1832 (0.3883) acc_x 93.7500 (89.6875) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/26] time 0.176 (0.174) data 0.099 (0.098) loss_x loss_x 0.6396 (0.4410) acc_x 81.2500 (88.1250) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/26] time 0.183 (0.176) data 0.107 (0.100) loss_x loss_x 0.7021 (0.4617) acc_x 81.2500 (87.5000) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [25/26] time 0.194 (0.178) data 0.117 (0.102) loss_x loss_x 0.6069 (0.4462) acc_x 81.2500 (87.7500) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/23] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.8955 (0.8573) acc_u 12.5000 (15.6250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/23] time 0.184 (0.179) data 0.107 (0.103) loss_u loss_u 0.8657 (0.8635) acc_u 15.6250 (15.0000) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/23] time 0.192 (0.180) data 0.115 (0.103) loss_u loss_u 0.9087 (0.8702) acc_u 9.3750 (14.3750) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/23] time 0.187 (0.180) data 0.111 (0.103) loss_u loss_u 0.9399 (0.8666) acc_u 6.2500 (14.8438) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 283
confident_label rate tensor(0.5581, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 893
clean true:884
clean false:9
clean_rate:0.9899216125419933
noisy true:433
noisy false:274
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 707
epoch [172/200] batch [5/27] time 0.168 (0.182) data 0.091 (0.106) loss_x loss_x 0.6167 (0.6973) acc_x 84.3750 (83.1250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/27] time 0.171 (0.177) data 0.095 (0.101) loss_x loss_x 0.5830 (0.6411) acc_x 84.3750 (84.3750) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/27] time 0.183 (0.179) data 0.107 (0.103) loss_x loss_x 0.4438 (0.5597) acc_x 93.7500 (85.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/27] time 0.188 (0.181) data 0.112 (0.104) loss_x loss_x 0.1793 (0.5026) acc_x 96.8750 (87.6562) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [25/27] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.3584 (0.5064) acc_x 93.7500 (87.6250) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/22] time 0.186 (0.182) data 0.109 (0.106) loss_u loss_u 0.8804 (0.8779) acc_u 12.5000 (13.7500) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/22] time 0.183 (0.182) data 0.107 (0.106) loss_u loss_u 0.8101 (0.8783) acc_u 18.7500 (14.0625) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/22] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8276 (0.8794) acc_u 18.7500 (13.7500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/22] time 0.191 (0.183) data 0.115 (0.107) loss_u loss_u 0.8516 (0.8844) acc_u 15.6250 (13.1250) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 865
clean true:855
clean false:10
clean_rate:0.9884393063583815
noisy true:410
noisy false:325
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 735
epoch [173/200] batch [5/27] time 0.181 (0.185) data 0.105 (0.109) loss_x loss_x 0.3584 (0.5570) acc_x 87.5000 (86.8750) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/27] time 0.186 (0.184) data 0.111 (0.109) loss_x loss_x 0.6094 (0.5595) acc_x 84.3750 (85.0000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [15/27] time 0.180 (0.186) data 0.105 (0.110) loss_x loss_x 0.3491 (0.5056) acc_x 87.5000 (85.8333) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/27] time 0.184 (0.185) data 0.109 (0.109) loss_x loss_x 0.7339 (0.5179) acc_x 84.3750 (86.0938) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [25/27] time 0.180 (0.184) data 0.104 (0.109) loss_x loss_x 0.4221 (0.5382) acc_x 87.5000 (86.3750) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/22] time 0.182 (0.184) data 0.106 (0.108) loss_u loss_u 0.9126 (0.8812) acc_u 9.3750 (13.7500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/22] time 0.185 (0.184) data 0.109 (0.108) loss_u loss_u 0.8022 (0.8591) acc_u 21.8750 (16.5625) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/22] time 0.183 (0.184) data 0.107 (0.108) loss_u loss_u 0.8965 (0.8708) acc_u 12.5000 (15.2083) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/22] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.8008 (0.8646) acc_u 21.8750 (15.7812) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 300
confident_label rate tensor(0.5456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 873
clean true:863
clean false:10
clean_rate:0.9885452462772051
noisy true:437
noisy false:290
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 727
epoch [174/200] batch [5/27] time 0.166 (0.176) data 0.090 (0.100) loss_x loss_x 0.1388 (0.3914) acc_x 100.0000 (90.6250) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/27] time 0.163 (0.172) data 0.087 (0.095) loss_x loss_x 0.6938 (0.4658) acc_x 84.3750 (87.8125) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/27] time 0.188 (0.172) data 0.112 (0.096) loss_x loss_x 0.2534 (0.4269) acc_x 93.7500 (88.9583) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/27] time 0.190 (0.175) data 0.114 (0.099) loss_x loss_x 0.5234 (0.4046) acc_x 81.2500 (89.0625) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [25/27] time 0.188 (0.179) data 0.112 (0.103) loss_x loss_x 0.3701 (0.4187) acc_x 90.6250 (89.0000) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/22] time 0.183 (0.180) data 0.107 (0.104) loss_u loss_u 0.9033 (0.8963) acc_u 15.6250 (12.5000) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/22] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.9263 (0.8876) acc_u 6.2500 (12.8125) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/22] time 0.179 (0.181) data 0.103 (0.105) loss_u loss_u 0.9243 (0.8897) acc_u 6.2500 (12.7083) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/22] time 0.183 (0.181) data 0.107 (0.105) loss_u loss_u 0.8076 (0.8824) acc_u 21.8750 (13.5938) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 321
confident_label rate tensor(0.5456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 873
clean true:863
clean false:10
clean_rate:0.9885452462772051
noisy true:416
noisy false:311
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 727
epoch [175/200] batch [5/27] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.3374 (0.3171) acc_x 90.6250 (92.5000) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/27] time 0.175 (0.181) data 0.099 (0.105) loss_x loss_x 0.4460 (0.3574) acc_x 90.6250 (91.8750) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [15/27] time 0.175 (0.179) data 0.099 (0.103) loss_x loss_x 0.1929 (0.3498) acc_x 96.8750 (91.2500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/27] time 0.172 (0.177) data 0.095 (0.101) loss_x loss_x 0.2986 (0.3981) acc_x 87.5000 (90.0000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [25/27] time 0.192 (0.178) data 0.116 (0.102) loss_x loss_x 0.6880 (0.4237) acc_x 84.3750 (89.6250) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/22] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8545 (0.8877) acc_u 15.6250 (13.7500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/22] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.9238 (0.8935) acc_u 9.3750 (12.1875) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/22] time 0.161 (0.179) data 0.084 (0.102) loss_u loss_u 0.8755 (0.8888) acc_u 18.7500 (13.1250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/22] time 0.184 (0.179) data 0.108 (0.102) loss_u loss_u 0.8979 (0.8898) acc_u 9.3750 (12.8125) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.5562, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 890
clean true:881
clean false:9
clean_rate:0.9898876404494382
noisy true:420
noisy false:290
after delete: len(clean_dataset) 890
after delete: len(noisy_dataset) 710
epoch [176/200] batch [5/27] time 0.187 (0.183) data 0.111 (0.108) loss_x loss_x 0.4314 (0.4131) acc_x 87.5000 (90.6250) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/27] time 0.187 (0.183) data 0.111 (0.107) loss_x loss_x 0.2196 (0.3788) acc_x 96.8750 (91.2500) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/27] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.4639 (0.4106) acc_x 90.6250 (90.2083) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/27] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.2893 (0.4373) acc_x 90.6250 (89.2188) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [25/27] time 0.184 (0.184) data 0.108 (0.109) loss_x loss_x 0.1836 (0.4012) acc_x 96.8750 (90.0000) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/22] time 0.184 (0.186) data 0.108 (0.110) loss_u loss_u 0.9761 (0.9193) acc_u 3.1250 (10.0000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/22] time 0.181 (0.185) data 0.105 (0.109) loss_u loss_u 0.9238 (0.9086) acc_u 9.3750 (11.2500) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/22] time 0.180 (0.185) data 0.104 (0.109) loss_u loss_u 0.8984 (0.9061) acc_u 9.3750 (11.0417) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/22] time 0.187 (0.185) data 0.111 (0.109) loss_u loss_u 0.8179 (0.9002) acc_u 18.7500 (11.7188) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:859
clean false:8
clean_rate:0.9907727797001153
noisy true:443
noisy false:290
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [177/200] batch [5/27] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.4319 (0.4205) acc_x 84.3750 (88.1250) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/27] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.1357 (0.3908) acc_x 93.7500 (89.0625) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [15/27] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.2937 (0.3931) acc_x 90.6250 (89.1667) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/27] time 0.179 (0.183) data 0.104 (0.107) loss_x loss_x 0.1910 (0.3845) acc_x 93.7500 (89.6875) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [25/27] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.4028 (0.3893) acc_x 87.5000 (89.6250) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/22] time 0.185 (0.183) data 0.109 (0.107) loss_u loss_u 0.8994 (0.8947) acc_u 12.5000 (11.8750) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/22] time 0.172 (0.182) data 0.096 (0.106) loss_u loss_u 0.9307 (0.8823) acc_u 9.3750 (13.4375) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/22] time 0.182 (0.182) data 0.105 (0.106) loss_u loss_u 0.9639 (0.8819) acc_u 3.1250 (13.3333) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/22] time 0.169 (0.181) data 0.093 (0.105) loss_u loss_u 0.8086 (0.8789) acc_u 21.8750 (13.7500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.5469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 875
clean true:867
clean false:8
clean_rate:0.9908571428571429
noisy true:426
noisy false:299
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 725
epoch [178/200] batch [5/27] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.6040 (0.4503) acc_x 87.5000 (89.3750) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/27] time 0.187 (0.183) data 0.111 (0.107) loss_x loss_x 0.6675 (0.5030) acc_x 87.5000 (88.1250) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/27] time 0.184 (0.183) data 0.108 (0.108) loss_x loss_x 0.2896 (0.4593) acc_x 90.6250 (88.7500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/27] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.2166 (0.4869) acc_x 93.7500 (88.1250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [25/27] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.4441 (0.4695) acc_x 87.5000 (88.3750) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/22] time 0.177 (0.184) data 0.099 (0.108) loss_u loss_u 0.9106 (0.8903) acc_u 9.3750 (13.1250) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/22] time 0.185 (0.184) data 0.107 (0.108) loss_u loss_u 0.7495 (0.8711) acc_u 28.1250 (15.3125) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/22] time 0.183 (0.185) data 0.106 (0.109) loss_u loss_u 0.8945 (0.8701) acc_u 12.5000 (15.2083) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/22] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9399 (0.8775) acc_u 6.2500 (14.2188) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.5512, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 882
clean true:871
clean false:11
clean_rate:0.9875283446712018
noisy true:430
noisy false:288
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 718
epoch [179/200] batch [5/27] time 0.186 (0.202) data 0.109 (0.125) loss_x loss_x 0.1609 (0.3955) acc_x 96.8750 (90.6250) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/27] time 0.174 (0.200) data 0.098 (0.124) loss_x loss_x 0.2686 (0.3338) acc_x 93.7500 (92.5000) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/27] time 0.175 (0.190) data 0.099 (0.114) loss_x loss_x 0.4695 (0.4077) acc_x 87.5000 (90.2083) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/27] time 0.174 (0.187) data 0.097 (0.111) loss_x loss_x 0.5464 (0.4140) acc_x 75.0000 (89.3750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [25/27] time 0.175 (0.186) data 0.098 (0.110) loss_x loss_x 0.6855 (0.4215) acc_x 81.2500 (89.0000) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/22] time 0.179 (0.185) data 0.102 (0.109) loss_u loss_u 0.8701 (0.8876) acc_u 12.5000 (12.5000) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/22] time 0.187 (0.185) data 0.110 (0.109) loss_u loss_u 0.8984 (0.8857) acc_u 12.5000 (12.5000) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/22] time 0.186 (0.185) data 0.108 (0.109) loss_u loss_u 0.8579 (0.8871) acc_u 15.6250 (12.2917) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/22] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.8613 (0.8865) acc_u 15.6250 (12.5000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 281
confident_label rate tensor(0.5544, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 887
clean true:878
clean false:9
clean_rate:0.9898534385569335
noisy true:441
noisy false:272
after delete: len(clean_dataset) 887
after delete: len(noisy_dataset) 713
epoch [180/200] batch [5/27] time 0.208 (0.187) data 0.131 (0.111) loss_x loss_x 0.2649 (0.3095) acc_x 93.7500 (93.1250) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/27] time 0.177 (0.180) data 0.101 (0.104) loss_x loss_x 0.6362 (0.3718) acc_x 81.2500 (90.3125) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/27] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.4124 (0.4389) acc_x 84.3750 (88.1250) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/27] time 0.185 (0.182) data 0.110 (0.105) loss_x loss_x 0.4583 (0.4211) acc_x 84.3750 (89.0625) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [25/27] time 0.182 (0.182) data 0.107 (0.106) loss_x loss_x 0.5137 (0.4290) acc_x 84.3750 (89.1250) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/22] time 0.185 (0.184) data 0.109 (0.108) loss_u loss_u 0.8149 (0.8756) acc_u 21.8750 (15.0000) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/22] time 0.179 (0.184) data 0.103 (0.108) loss_u loss_u 0.9712 (0.8976) acc_u 3.1250 (12.1875) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/22] time 0.186 (0.184) data 0.110 (0.108) loss_u loss_u 0.9126 (0.8999) acc_u 9.3750 (11.8750) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/22] time 0.210 (0.185) data 0.132 (0.109) loss_u loss_u 0.7378 (0.8879) acc_u 28.1250 (12.8125) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.5312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 850
clean true:841
clean false:9
clean_rate:0.9894117647058823
noisy true:430
noisy false:320
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 750
epoch [181/200] batch [5/26] time 0.185 (0.182) data 0.109 (0.106) loss_x loss_x 0.2393 (0.4204) acc_x 93.7500 (87.5000) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/26] time 0.192 (0.184) data 0.116 (0.108) loss_x loss_x 0.1913 (0.4082) acc_x 96.8750 (87.8125) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/26] time 0.174 (0.180) data 0.098 (0.104) loss_x loss_x 0.4856 (0.4465) acc_x 87.5000 (87.5000) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/26] time 0.178 (0.181) data 0.101 (0.105) loss_x loss_x 0.4182 (0.4535) acc_x 90.6250 (87.8125) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [25/26] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.1138 (0.4535) acc_x 96.8750 (88.1250) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/23] time 0.185 (0.181) data 0.108 (0.105) loss_u loss_u 0.9292 (0.8403) acc_u 9.3750 (17.5000) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/23] time 0.196 (0.185) data 0.120 (0.108) loss_u loss_u 0.9077 (0.8679) acc_u 9.3750 (14.0625) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/23] time 0.178 (0.185) data 0.102 (0.109) loss_u loss_u 0.9360 (0.8617) acc_u 6.2500 (15.2083) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/23] time 0.184 (0.185) data 0.107 (0.109) loss_u loss_u 0.9409 (0.8631) acc_u 6.2500 (15.3125) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 314
confident_label rate tensor(0.5481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 877
clean true:865
clean false:12
clean_rate:0.9863169897377423
noisy true:421
noisy false:302
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 723
epoch [182/200] batch [5/27] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.3279 (0.2870) acc_x 90.6250 (92.5000) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/27] time 0.187 (0.184) data 0.111 (0.109) loss_x loss_x 0.3535 (0.3317) acc_x 90.6250 (91.2500) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/27] time 0.189 (0.185) data 0.112 (0.109) loss_x loss_x 0.2179 (0.3482) acc_x 96.8750 (91.0417) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/27] time 0.187 (0.187) data 0.111 (0.111) loss_x loss_x 0.1183 (0.3679) acc_x 96.8750 (91.0938) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [25/27] time 0.191 (0.186) data 0.115 (0.110) loss_x loss_x 0.3086 (0.4085) acc_x 93.7500 (90.6250) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/22] time 0.186 (0.186) data 0.110 (0.110) loss_u loss_u 0.8823 (0.8821) acc_u 15.6250 (13.7500) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/22] time 0.185 (0.186) data 0.108 (0.110) loss_u loss_u 0.8745 (0.8681) acc_u 12.5000 (15.0000) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/22] time 0.188 (0.186) data 0.110 (0.110) loss_u loss_u 0.9917 (0.8898) acc_u 3.1250 (12.5000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/22] time 0.185 (0.186) data 0.109 (0.110) loss_u loss_u 0.7837 (0.8766) acc_u 25.0000 (13.9062) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 300
confident_label rate tensor(0.5500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 880
clean true:871
clean false:9
clean_rate:0.9897727272727272
noisy true:429
noisy false:291
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 720
epoch [183/200] batch [5/27] time 0.171 (0.180) data 0.094 (0.104) loss_x loss_x 0.2317 (0.3630) acc_x 93.7500 (87.5000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/27] time 0.180 (0.178) data 0.104 (0.102) loss_x loss_x 0.5420 (0.4184) acc_x 87.5000 (87.8125) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/27] time 0.183 (0.180) data 0.106 (0.104) loss_x loss_x 0.5835 (0.4320) acc_x 90.6250 (88.1250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/27] time 0.182 (0.180) data 0.105 (0.104) loss_x loss_x 0.4221 (0.4061) acc_x 84.3750 (88.7500) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [25/27] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.0646 (0.4098) acc_x 100.0000 (88.3750) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/22] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9033 (0.9259) acc_u 9.3750 (8.1250) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/22] time 0.176 (0.182) data 0.099 (0.105) loss_u loss_u 0.8804 (0.8944) acc_u 12.5000 (11.5625) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/22] time 0.179 (0.182) data 0.101 (0.105) loss_u loss_u 0.8984 (0.8895) acc_u 12.5000 (12.2917) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/22] time 0.179 (0.181) data 0.102 (0.105) loss_u loss_u 0.8555 (0.8847) acc_u 15.6250 (12.8125) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.5437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 870
clean true:862
clean false:8
clean_rate:0.9908045977011494
noisy true:429
noisy false:301
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 730
epoch [184/200] batch [5/27] time 0.232 (0.188) data 0.155 (0.111) loss_x loss_x 0.3857 (0.4172) acc_x 90.6250 (87.5000) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/27] time 0.166 (0.190) data 0.091 (0.114) loss_x loss_x 0.3469 (0.3462) acc_x 90.6250 (90.6250) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/27] time 0.206 (0.199) data 0.131 (0.122) loss_x loss_x 0.2605 (0.3755) acc_x 93.7500 (89.5833) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/27] time 0.183 (0.195) data 0.108 (0.119) loss_x loss_x 0.4180 (0.3813) acc_x 93.7500 (90.0000) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [25/27] time 0.183 (0.193) data 0.107 (0.117) loss_x loss_x 0.2014 (0.4196) acc_x 96.8750 (89.2500) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/22] time 0.187 (0.194) data 0.111 (0.118) loss_u loss_u 0.9160 (0.9089) acc_u 12.5000 (11.2500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/22] time 0.182 (0.195) data 0.106 (0.119) loss_u loss_u 0.8438 (0.8776) acc_u 15.6250 (14.3750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/22] time 0.189 (0.194) data 0.111 (0.117) loss_u loss_u 0.8340 (0.8697) acc_u 18.7500 (15.6250) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/22] time 0.210 (0.194) data 0.134 (0.118) loss_u loss_u 0.8374 (0.8781) acc_u 18.7500 (14.5312) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 306
confident_label rate tensor(0.5531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 885
clean true:877
clean false:8
clean_rate:0.9909604519774011
noisy true:417
noisy false:298
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 715
epoch [185/200] batch [5/27] time 0.180 (0.181) data 0.105 (0.105) loss_x loss_x 0.2300 (0.3601) acc_x 100.0000 (93.1250) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/27] time 0.178 (0.181) data 0.102 (0.106) loss_x loss_x 0.4128 (0.3808) acc_x 87.5000 (90.6250) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/27] time 0.173 (0.180) data 0.097 (0.104) loss_x loss_x 0.3594 (0.3636) acc_x 90.6250 (90.8333) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/27] time 0.170 (0.177) data 0.094 (0.101) loss_x loss_x 0.2551 (0.3624) acc_x 90.6250 (90.9375) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [25/27] time 0.173 (0.177) data 0.096 (0.101) loss_x loss_x 0.2314 (0.3673) acc_x 96.8750 (90.8750) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/22] time 0.177 (0.177) data 0.100 (0.101) loss_u loss_u 0.8745 (0.8750) acc_u 15.6250 (14.3750) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/22] time 0.184 (0.178) data 0.107 (0.102) loss_u loss_u 0.9067 (0.8831) acc_u 9.3750 (13.1250) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/22] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.8311 (0.8812) acc_u 15.6250 (13.1250) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/22] time 0.186 (0.179) data 0.109 (0.103) loss_u loss_u 0.8535 (0.8888) acc_u 15.6250 (12.0312) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 297
confident_label rate tensor(0.5556, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 889
clean true:878
clean false:11
clean_rate:0.9876265466816648
noisy true:425
noisy false:286
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 711
epoch [186/200] batch [5/27] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.6602 (0.4433) acc_x 81.2500 (88.7500) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/27] time 0.166 (0.181) data 0.089 (0.105) loss_x loss_x 0.0597 (0.3943) acc_x 100.0000 (90.6250) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/27] time 0.184 (0.179) data 0.108 (0.103) loss_x loss_x 0.4375 (0.3866) acc_x 84.3750 (89.5833) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/27] time 0.184 (0.181) data 0.108 (0.105) loss_x loss_x 0.5425 (0.3896) acc_x 93.7500 (89.5312) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [25/27] time 0.190 (0.181) data 0.115 (0.106) loss_x loss_x 0.2147 (0.4072) acc_x 93.7500 (89.2500) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/22] time 0.169 (0.182) data 0.092 (0.106) loss_u loss_u 0.8789 (0.9139) acc_u 15.6250 (9.3750) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/22] time 0.196 (0.182) data 0.119 (0.106) loss_u loss_u 0.9878 (0.9120) acc_u 0.0000 (9.3750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/22] time 0.186 (0.181) data 0.110 (0.105) loss_u loss_u 0.9199 (0.9068) acc_u 9.3750 (10.4167) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/22] time 0.183 (0.181) data 0.106 (0.105) loss_u loss_u 0.9258 (0.9035) acc_u 9.3750 (10.9375) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 302
confident_label rate tensor(0.5431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 869
clean true:864
clean false:5
clean_rate:0.9942462600690449
noisy true:434
noisy false:297
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 731
epoch [187/200] batch [5/27] time 0.188 (0.204) data 0.111 (0.128) loss_x loss_x 0.5049 (0.5158) acc_x 90.6250 (88.1250) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/27] time 0.219 (0.202) data 0.142 (0.126) loss_x loss_x 0.1121 (0.3820) acc_x 96.8750 (90.9375) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/27] time 0.231 (0.212) data 0.155 (0.136) loss_x loss_x 0.2042 (0.3707) acc_x 93.7500 (91.0417) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/27] time 0.199 (0.211) data 0.122 (0.135) loss_x loss_x 0.5493 (0.3556) acc_x 78.1250 (90.7812) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [25/27] time 0.182 (0.210) data 0.106 (0.134) loss_x loss_x 0.3381 (0.3729) acc_x 90.6250 (90.6250) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/22] time 0.178 (0.203) data 0.101 (0.127) loss_u loss_u 0.9409 (0.8857) acc_u 6.2500 (12.5000) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/22] time 0.190 (0.201) data 0.112 (0.125) loss_u loss_u 0.8047 (0.8671) acc_u 18.7500 (13.7500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/22] time 0.187 (0.199) data 0.110 (0.123) loss_u loss_u 0.8174 (0.8606) acc_u 18.7500 (15.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/22] time 0.190 (0.198) data 0.114 (0.122) loss_u loss_u 0.8682 (0.8694) acc_u 15.6250 (13.9062) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 303
confident_label rate tensor(0.5450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 872
clean true:863
clean false:9
clean_rate:0.9896788990825688
noisy true:434
noisy false:294
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 728
epoch [188/200] batch [5/27] time 0.188 (0.184) data 0.112 (0.108) loss_x loss_x 0.6880 (0.4239) acc_x 84.3750 (90.6250) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/27] time 0.182 (0.183) data 0.105 (0.107) loss_x loss_x 0.2688 (0.4260) acc_x 90.6250 (90.0000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/27] time 0.187 (0.183) data 0.111 (0.107) loss_x loss_x 0.3579 (0.4094) acc_x 90.6250 (89.7917) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/27] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.2991 (0.3935) acc_x 90.6250 (90.4688) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [25/27] time 0.184 (0.183) data 0.108 (0.108) loss_x loss_x 0.3271 (0.3927) acc_x 90.6250 (90.5000) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/22] time 0.181 (0.184) data 0.105 (0.108) loss_u loss_u 0.8970 (0.8582) acc_u 9.3750 (15.0000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/22] time 0.182 (0.184) data 0.106 (0.108) loss_u loss_u 0.9692 (0.8491) acc_u 6.2500 (17.1875) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/22] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.8760 (0.8637) acc_u 15.6250 (15.4167) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/22] time 0.183 (0.184) data 0.107 (0.108) loss_u loss_u 0.9297 (0.8662) acc_u 6.2500 (15.0000) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 308
confident_label rate tensor(0.5494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 879
clean true:872
clean false:7
clean_rate:0.9920364050056882
noisy true:420
noisy false:301
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 721
epoch [189/200] batch [5/27] time 0.166 (0.180) data 0.090 (0.104) loss_x loss_x 0.5127 (0.6337) acc_x 87.5000 (83.1250) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/27] time 0.174 (0.177) data 0.098 (0.100) loss_x loss_x 0.4934 (0.5033) acc_x 84.3750 (86.8750) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/27] time 0.183 (0.179) data 0.106 (0.103) loss_x loss_x 0.5664 (0.5087) acc_x 90.6250 (87.2917) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/27] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.4021 (0.4874) acc_x 90.6250 (87.3438) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [25/27] time 0.178 (0.181) data 0.102 (0.104) loss_x loss_x 0.2861 (0.4590) acc_x 96.8750 (88.7500) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/22] time 0.177 (0.180) data 0.101 (0.103) loss_u loss_u 0.9111 (0.9020) acc_u 9.3750 (12.5000) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/22] time 0.185 (0.180) data 0.109 (0.103) loss_u loss_u 0.9092 (0.8932) acc_u 9.3750 (12.5000) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/22] time 0.179 (0.180) data 0.103 (0.104) loss_u loss_u 0.8779 (0.8926) acc_u 12.5000 (12.5000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/22] time 0.219 (0.182) data 0.142 (0.106) loss_u loss_u 0.8481 (0.8842) acc_u 15.6250 (13.4375) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 313
confident_label rate tensor(0.5412, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 866
clean true:858
clean false:8
clean_rate:0.9907621247113164
noisy true:429
noisy false:305
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 734
epoch [190/200] batch [5/27] time 0.181 (0.187) data 0.105 (0.112) loss_x loss_x 0.2272 (0.3721) acc_x 93.7500 (88.7500) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/27] time 0.185 (0.187) data 0.109 (0.111) loss_x loss_x 0.3184 (0.4165) acc_x 90.6250 (87.5000) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [15/27] time 0.187 (0.186) data 0.111 (0.110) loss_x loss_x 0.4031 (0.4288) acc_x 87.5000 (87.9167) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/27] time 0.180 (0.186) data 0.104 (0.110) loss_x loss_x 0.4470 (0.4544) acc_x 87.5000 (87.6562) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [25/27] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.3782 (0.4523) acc_x 87.5000 (87.8750) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/22] time 0.189 (0.186) data 0.113 (0.109) loss_u loss_u 0.8882 (0.8543) acc_u 12.5000 (16.8750) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/22] time 0.187 (0.185) data 0.110 (0.109) loss_u loss_u 0.8569 (0.8617) acc_u 15.6250 (15.3125) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/22] time 0.188 (0.186) data 0.111 (0.109) loss_u loss_u 0.9062 (0.8703) acc_u 12.5000 (14.3750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/22] time 0.178 (0.186) data 0.102 (0.109) loss_u loss_u 0.8711 (0.8670) acc_u 12.5000 (14.5312) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.5400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 864
clean true:855
clean false:9
clean_rate:0.9895833333333334
noisy true:429
noisy false:307
after delete: len(clean_dataset) 864
after delete: len(noisy_dataset) 736
epoch [191/200] batch [5/27] time 0.166 (0.181) data 0.090 (0.105) loss_x loss_x 0.6968 (0.4260) acc_x 81.2500 (88.7500) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/27] time 0.167 (0.180) data 0.091 (0.104) loss_x loss_x 0.3669 (0.4630) acc_x 93.7500 (87.5000) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/27] time 0.178 (0.178) data 0.101 (0.102) loss_x loss_x 0.5186 (0.4425) acc_x 87.5000 (88.7500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/27] time 0.188 (0.180) data 0.112 (0.104) loss_x loss_x 0.8584 (0.4962) acc_x 75.0000 (87.1875) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [25/27] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.4199 (0.4913) acc_x 90.6250 (87.5000) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/23] time 0.189 (0.186) data 0.113 (0.109) loss_u loss_u 0.8057 (0.8510) acc_u 21.8750 (16.8750) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/23] time 0.184 (0.185) data 0.108 (0.109) loss_u loss_u 0.8906 (0.8627) acc_u 12.5000 (15.3125) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/23] time 0.182 (0.185) data 0.106 (0.109) loss_u loss_u 0.9067 (0.8753) acc_u 9.3750 (13.7500) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/23] time 0.227 (0.186) data 0.151 (0.109) loss_u loss_u 0.9092 (0.8783) acc_u 9.3750 (13.7500) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 313
confident_label rate tensor(0.5394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 863
clean true:857
clean false:6
clean_rate:0.9930475086906141
noisy true:430
noisy false:307
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 737
epoch [192/200] batch [5/26] time 0.189 (0.203) data 0.113 (0.127) loss_x loss_x 0.1823 (0.3313) acc_x 93.7500 (90.6250) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/26] time 0.183 (0.195) data 0.107 (0.119) loss_x loss_x 0.3142 (0.3455) acc_x 90.6250 (90.6250) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/26] time 0.179 (0.191) data 0.104 (0.115) loss_x loss_x 0.6113 (0.3992) acc_x 90.6250 (89.3750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/26] time 0.200 (0.193) data 0.124 (0.117) loss_x loss_x 0.3521 (0.4076) acc_x 87.5000 (89.0625) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [25/26] time 0.171 (0.190) data 0.094 (0.114) loss_x loss_x 0.6230 (0.4308) acc_x 87.5000 (88.3750) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/23] time 0.183 (0.188) data 0.105 (0.112) loss_u loss_u 0.9219 (0.8768) acc_u 9.3750 (13.7500) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/23] time 0.189 (0.187) data 0.112 (0.111) loss_u loss_u 0.8999 (0.8778) acc_u 12.5000 (13.7500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/23] time 0.212 (0.186) data 0.136 (0.110) loss_u loss_u 0.8550 (0.8625) acc_u 15.6250 (15.4167) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/23] time 0.184 (0.186) data 0.108 (0.110) loss_u loss_u 0.9282 (0.8662) acc_u 9.3750 (14.8438) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.5531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 885
clean true:874
clean false:11
clean_rate:0.9875706214689266
noisy true:419
noisy false:296
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 715
epoch [193/200] batch [5/27] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.1285 (0.2650) acc_x 96.8750 (92.5000) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/27] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.4436 (0.3867) acc_x 90.6250 (90.9375) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/27] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.6558 (0.4223) acc_x 78.1250 (89.5833) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/27] time 0.167 (0.185) data 0.090 (0.109) loss_x loss_x 0.6714 (0.4373) acc_x 84.3750 (88.5938) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [25/27] time 0.186 (0.185) data 0.110 (0.109) loss_x loss_x 0.5679 (0.4498) acc_x 81.2500 (88.6250) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/22] time 0.181 (0.185) data 0.104 (0.109) loss_u loss_u 0.8555 (0.8724) acc_u 18.7500 (15.6250) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/22] time 0.190 (0.184) data 0.114 (0.108) loss_u loss_u 0.9302 (0.8749) acc_u 9.3750 (15.6250) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/22] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.7793 (0.8862) acc_u 21.8750 (13.5417) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/22] time 0.187 (0.185) data 0.110 (0.108) loss_u loss_u 0.8540 (0.8842) acc_u 15.6250 (13.4375) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 315
confident_label rate tensor(0.5425, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 868
clean true:859
clean false:9
clean_rate:0.9896313364055299
noisy true:426
noisy false:306
after delete: len(clean_dataset) 868
after delete: len(noisy_dataset) 732
epoch [194/200] batch [5/27] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.3418 (0.4049) acc_x 81.2500 (89.3750) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/27] time 0.171 (0.179) data 0.094 (0.103) loss_x loss_x 0.4783 (0.5016) acc_x 84.3750 (86.8750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/27] time 0.181 (0.178) data 0.104 (0.102) loss_x loss_x 0.5967 (0.4865) acc_x 84.3750 (87.9167) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/27] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 0.5483 (0.4829) acc_x 87.5000 (88.4375) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [25/27] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.0963 (0.4615) acc_x 100.0000 (89.1250) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/22] time 0.187 (0.181) data 0.110 (0.104) loss_u loss_u 0.9019 (0.8761) acc_u 12.5000 (14.3750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/22] time 0.189 (0.182) data 0.112 (0.105) loss_u loss_u 0.9268 (0.8861) acc_u 6.2500 (13.1250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/22] time 0.189 (0.183) data 0.112 (0.106) loss_u loss_u 0.9082 (0.8819) acc_u 9.3750 (13.3333) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/22] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.8408 (0.8776) acc_u 18.7500 (13.9062) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 879
clean true:872
clean false:7
clean_rate:0.9920364050056882
noisy true:418
noisy false:303
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 721
epoch [195/200] batch [5/27] time 0.180 (0.186) data 0.104 (0.110) loss_x loss_x 0.3530 (0.4163) acc_x 93.7500 (88.1250) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/27] time 0.186 (0.187) data 0.110 (0.111) loss_x loss_x 0.4211 (0.4261) acc_x 96.8750 (89.3750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/27] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.3691 (0.4405) acc_x 87.5000 (88.3333) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/27] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.3459 (0.3993) acc_x 93.7500 (89.3750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [25/27] time 0.199 (0.185) data 0.122 (0.108) loss_x loss_x 0.3540 (0.3895) acc_x 90.6250 (89.6250) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/22] time 0.238 (0.192) data 0.162 (0.116) loss_u loss_u 0.7822 (0.8406) acc_u 21.8750 (16.8750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/22] time 0.181 (0.194) data 0.104 (0.117) loss_u loss_u 0.9014 (0.8741) acc_u 12.5000 (13.7500) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/22] time 0.187 (0.193) data 0.110 (0.116) loss_u loss_u 0.9185 (0.8822) acc_u 9.3750 (13.1250) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/22] time 0.180 (0.192) data 0.104 (0.115) loss_u loss_u 0.9375 (0.8868) acc_u 6.2500 (12.9688) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 284
confident_label rate tensor(0.5531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 885
clean true:876
clean false:9
clean_rate:0.9898305084745763
noisy true:440
noisy false:275
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 715
epoch [196/200] batch [5/27] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.2656 (0.3619) acc_x 90.6250 (90.6250) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/27] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.2786 (0.3464) acc_x 93.7500 (90.9375) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/27] time 0.181 (0.185) data 0.105 (0.109) loss_x loss_x 0.5059 (0.4049) acc_x 90.6250 (90.4167) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/27] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.3733 (0.4128) acc_x 90.6250 (90.3125) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [25/27] time 0.181 (0.184) data 0.106 (0.108) loss_x loss_x 0.3623 (0.4174) acc_x 90.6250 (90.2500) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/22] time 0.224 (0.192) data 0.147 (0.116) loss_u loss_u 0.8945 (0.8972) acc_u 12.5000 (12.5000) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/22] time 0.187 (0.192) data 0.110 (0.115) loss_u loss_u 0.7803 (0.8711) acc_u 25.0000 (14.6875) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/22] time 0.180 (0.191) data 0.104 (0.115) loss_u loss_u 0.9829 (0.8870) acc_u 0.0000 (12.7083) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/22] time 0.198 (0.193) data 0.122 (0.117) loss_u loss_u 0.9014 (0.8865) acc_u 9.3750 (12.8125) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 304
confident_label rate tensor(0.5494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 879
clean true:870
clean false:9
clean_rate:0.9897610921501706
noisy true:426
noisy false:295
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 721
epoch [197/200] batch [5/27] time 0.184 (0.200) data 0.109 (0.124) loss_x loss_x 0.3682 (0.4302) acc_x 84.3750 (85.0000) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/27] time 0.182 (0.192) data 0.106 (0.116) loss_x loss_x 0.3977 (0.3733) acc_x 87.5000 (87.5000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/27] time 0.186 (0.190) data 0.110 (0.115) loss_x loss_x 0.2837 (0.4070) acc_x 93.7500 (87.0833) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/27] time 0.186 (0.189) data 0.110 (0.113) loss_x loss_x 0.4399 (0.4527) acc_x 93.7500 (87.0312) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [25/27] time 0.221 (0.189) data 0.145 (0.113) loss_x loss_x 0.2153 (0.4536) acc_x 93.7500 (87.2500) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/22] time 0.216 (0.195) data 0.140 (0.119) loss_u loss_u 0.9424 (0.8850) acc_u 6.2500 (13.7500) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/22] time 0.255 (0.198) data 0.178 (0.122) loss_u loss_u 0.8584 (0.8873) acc_u 12.5000 (12.5000) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/22] time 0.208 (0.198) data 0.132 (0.122) loss_u loss_u 0.8911 (0.8979) acc_u 12.5000 (11.0417) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/22] time 0.198 (0.205) data 0.121 (0.128) loss_u loss_u 0.9102 (0.8860) acc_u 12.5000 (12.8125) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 300
confident_label rate tensor(0.5412, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 866
clean true:859
clean false:7
clean_rate:0.9919168591224018
noisy true:441
noisy false:293
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 734
epoch [198/200] batch [5/27] time 0.171 (0.183) data 0.094 (0.107) loss_x loss_x 0.4133 (0.3897) acc_x 84.3750 (90.0000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/27] time 0.195 (0.185) data 0.118 (0.109) loss_x loss_x 0.1844 (0.4381) acc_x 100.0000 (90.0000) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/27] time 0.203 (0.187) data 0.127 (0.111) loss_x loss_x 0.5264 (0.4508) acc_x 90.6250 (88.7500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/27] time 0.183 (0.187) data 0.107 (0.111) loss_x loss_x 0.2930 (0.4516) acc_x 90.6250 (88.7500) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [25/27] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.2881 (0.4557) acc_x 90.6250 (88.7500) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/22] time 0.168 (0.190) data 0.091 (0.113) loss_u loss_u 0.9258 (0.8980) acc_u 9.3750 (11.8750) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/22] time 0.183 (0.189) data 0.106 (0.113) loss_u loss_u 0.9126 (0.9062) acc_u 9.3750 (10.3125) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/22] time 0.187 (0.189) data 0.109 (0.112) loss_u loss_u 0.7588 (0.8813) acc_u 28.1250 (13.3333) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/22] time 0.185 (0.189) data 0.109 (0.112) loss_u loss_u 0.8525 (0.8834) acc_u 18.7500 (13.2812) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.5494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 879
clean true:869
clean false:10
clean_rate:0.9886234357224118
noisy true:421
noisy false:300
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 721
epoch [199/200] batch [5/27] time 0.182 (0.207) data 0.106 (0.131) loss_x loss_x 0.4097 (0.4403) acc_x 90.6250 (86.8750) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/27] time 0.220 (0.203) data 0.144 (0.127) loss_x loss_x 0.5537 (0.4664) acc_x 87.5000 (86.2500) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/27] time 0.217 (0.204) data 0.142 (0.128) loss_x loss_x 0.2576 (0.4771) acc_x 90.6250 (86.4583) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/27] time 0.182 (0.205) data 0.106 (0.129) loss_x loss_x 0.4429 (0.4541) acc_x 87.5000 (87.1875) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [25/27] time 0.219 (0.208) data 0.142 (0.132) loss_x loss_x 0.2817 (0.4507) acc_x 90.6250 (87.3750) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/22] time 0.187 (0.207) data 0.110 (0.131) loss_u loss_u 0.8657 (0.9080) acc_u 15.6250 (11.2500) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/22] time 0.191 (0.205) data 0.115 (0.128) loss_u loss_u 0.9355 (0.9125) acc_u 6.2500 (10.3125) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/22] time 0.197 (0.203) data 0.120 (0.127) loss_u loss_u 0.7881 (0.8845) acc_u 25.0000 (13.1250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/22] time 0.182 (0.203) data 0.106 (0.127) loss_u loss_u 0.8315 (0.8888) acc_u 18.7500 (12.9688) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 305
confident_label rate tensor(0.5419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 867
clean true:860
clean false:7
clean_rate:0.9919261822376009
noisy true:435
noisy false:298
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 733
epoch [200/200] batch [5/27] time 0.202 (0.187) data 0.126 (0.111) loss_x loss_x 0.5396 (0.5495) acc_x 84.3750 (85.6250) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/27] time 0.207 (0.186) data 0.131 (0.110) loss_x loss_x 0.3513 (0.4417) acc_x 87.5000 (88.1250) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/27] time 0.183 (0.185) data 0.108 (0.109) loss_x loss_x 0.1919 (0.4181) acc_x 96.8750 (89.1667) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/27] time 0.177 (0.185) data 0.102 (0.109) loss_x loss_x 0.2856 (0.4155) acc_x 96.8750 (89.0625) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [25/27] time 0.192 (0.185) data 0.117 (0.110) loss_x loss_x 0.6948 (0.4426) acc_x 87.5000 (88.8750) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/22] time 0.175 (0.185) data 0.098 (0.109) loss_u loss_u 0.8208 (0.8786) acc_u 21.8750 (14.3750) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/22] time 0.185 (0.186) data 0.108 (0.110) loss_u loss_u 0.9346 (0.8774) acc_u 6.2500 (14.0625) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/22] time 0.183 (0.186) data 0.107 (0.109) loss_u loss_u 0.8906 (0.8762) acc_u 12.5000 (14.1667) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/22] time 0.405 (0.190) data 0.328 (0.114) loss_u loss_u 0.7402 (0.8711) acc_u 28.1250 (14.6875) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/caltech101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,211
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 84.9%
Elapsed: 1:00:01
