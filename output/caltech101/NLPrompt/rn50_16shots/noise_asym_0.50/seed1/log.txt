***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '100']
output_dir: output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 846
confident_label rate tensor(0.2394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 383
clean true:373
clean false:10
clean_rate:0.9738903394255874
noisy true:381
noisy false:836
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1217
epoch [1/200] batch [5/11] time 0.202 (0.219) data 0.125 (0.121) loss_x loss_x 2.8730 (2.7879) acc_x 62.5000 (65.0000) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/11] time 0.196 (0.214) data 0.119 (0.126) loss_x loss_x 2.3555 (2.5629) acc_x 62.5000 (67.5000) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/38] time 0.191 (0.209) data 0.113 (0.123) loss_u loss_u 0.9639 (0.9592) acc_u 9.3750 (12.5000) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [10/38] time 0.188 (0.204) data 0.112 (0.121) loss_u loss_u 0.9648 (0.9598) acc_u 9.3750 (10.9375) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [15/38] time 0.211 (0.204) data 0.134 (0.122) loss_u loss_u 0.9429 (0.9560) acc_u 15.6250 (11.2500) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [20/38] time 0.228 (0.205) data 0.151 (0.123) loss_u loss_u 0.9434 (0.9513) acc_u 9.3750 (12.0312) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [25/38] time 0.191 (0.203) data 0.114 (0.122) loss_u loss_u 0.9341 (0.9482) acc_u 18.7500 (12.5000) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [30/38] time 0.218 (0.203) data 0.141 (0.123) loss_u loss_u 0.9658 (0.9462) acc_u 9.3750 (12.7083) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [35/38] time 0.180 (0.203) data 0.098 (0.123) loss_u loss_u 0.9341 (0.9450) acc_u 9.3750 (12.7679) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 679
confident_label rate tensor(0.3000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 480
clean true:468
clean false:12
clean_rate:0.975
noisy true:453
noisy false:667
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1120
epoch [2/200] batch [5/15] time 0.177 (0.170) data 0.101 (0.093) loss_x loss_x 1.1338 (1.3307) acc_x 68.7500 (67.5000) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/15] time 0.161 (0.171) data 0.086 (0.095) loss_x loss_x 0.9331 (1.1421) acc_x 68.7500 (70.6250) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [15/15] time 0.189 (0.172) data 0.112 (0.095) loss_x loss_x 0.7114 (1.1216) acc_x 78.1250 (71.4583) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/35] time 0.186 (0.175) data 0.109 (0.098) loss_u loss_u 0.9561 (0.8905) acc_u 3.1250 (13.1250) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [10/35] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.9214 (0.8688) acc_u 9.3750 (16.8750) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [15/35] time 0.183 (0.176) data 0.107 (0.100) loss_u loss_u 0.8145 (0.8672) acc_u 21.8750 (16.2500) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [20/35] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.8345 (0.8689) acc_u 18.7500 (15.4688) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [25/35] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.8901 (0.8646) acc_u 15.6250 (16.2500) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [30/35] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.9185 (0.8665) acc_u 9.3750 (15.8333) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [35/35] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.8364 (0.8656) acc_u 25.0000 (15.9821) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.3569, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 571
clean true:565
clean false:6
clean_rate:0.989492119089317
noisy true:550
noisy false:479
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1029
epoch [3/200] batch [5/17] time 0.185 (0.181) data 0.109 (0.105) loss_x loss_x 0.8286 (1.1406) acc_x 81.2500 (73.1250) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/17] time 0.185 (0.180) data 0.109 (0.104) loss_x loss_x 0.4753 (0.9773) acc_x 90.6250 (74.6875) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/17] time 0.171 (0.177) data 0.095 (0.101) loss_x loss_x 1.0371 (0.9703) acc_x 71.8750 (75.0000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/32] time 0.175 (0.177) data 0.098 (0.101) loss_u loss_u 0.9019 (0.9341) acc_u 12.5000 (8.7500) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/32] time 0.182 (0.178) data 0.106 (0.102) loss_u loss_u 0.9087 (0.9139) acc_u 9.3750 (10.3125) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/32] time 0.190 (0.178) data 0.114 (0.102) loss_u loss_u 0.9121 (0.9092) acc_u 12.5000 (10.8333) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [20/32] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.7593 (0.9053) acc_u 28.1250 (11.2500) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [25/32] time 0.178 (0.179) data 0.100 (0.103) loss_u loss_u 0.9609 (0.9024) acc_u 6.2500 (11.7500) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [30/32] time 0.179 (0.180) data 0.101 (0.103) loss_u loss_u 0.8994 (0.9017) acc_u 15.6250 (12.1875) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 515
confident_label rate tensor(0.3388, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 542
clean true:541
clean false:1
clean_rate:0.9981549815498155
noisy true:544
noisy false:514
after delete: len(clean_dataset) 542
after delete: len(noisy_dataset) 1058
epoch [4/200] batch [5/16] time 0.173 (0.168) data 0.097 (0.092) loss_x loss_x 0.7285 (0.7010) acc_x 71.8750 (81.2500) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/16] time 0.175 (0.168) data 0.099 (0.092) loss_x loss_x 0.7007 (0.6799) acc_x 81.2500 (81.2500) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [15/16] time 0.160 (0.169) data 0.084 (0.093) loss_x loss_x 1.0439 (0.7758) acc_x 68.7500 (80.0000) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/33] time 0.167 (0.169) data 0.090 (0.092) loss_u loss_u 0.9033 (0.9201) acc_u 9.3750 (6.8750) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/33] time 0.172 (0.171) data 0.096 (0.094) loss_u loss_u 0.8530 (0.8659) acc_u 15.6250 (13.7500) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/33] time 0.165 (0.171) data 0.088 (0.094) loss_u loss_u 0.8730 (0.8737) acc_u 15.6250 (13.5417) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [20/33] time 0.163 (0.169) data 0.086 (0.093) loss_u loss_u 0.8589 (0.8803) acc_u 15.6250 (13.2812) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [25/33] time 0.169 (0.168) data 0.091 (0.092) loss_u loss_u 0.9453 (0.8881) acc_u 6.2500 (12.2500) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [30/33] time 0.164 (0.168) data 0.088 (0.091) loss_u loss_u 0.9004 (0.8829) acc_u 15.6250 (12.9167) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.3644, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 583
clean true:576
clean false:7
clean_rate:0.9879931389365352
noisy true:550
noisy false:467
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1017
epoch [5/200] batch [5/18] time 0.162 (0.172) data 0.086 (0.096) loss_x loss_x 0.9463 (0.7940) acc_x 75.0000 (77.5000) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/18] time 0.171 (0.173) data 0.095 (0.097) loss_x loss_x 0.4788 (0.7322) acc_x 84.3750 (80.0000) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/18] time 0.169 (0.171) data 0.094 (0.095) loss_x loss_x 1.0986 (0.7900) acc_x 65.6250 (78.3333) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/31] time 0.163 (0.169) data 0.086 (0.093) loss_u loss_u 0.8291 (0.8771) acc_u 15.6250 (14.3750) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/31] time 0.175 (0.170) data 0.097 (0.094) loss_u loss_u 0.8921 (0.8945) acc_u 9.3750 (12.1875) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/31] time 0.185 (0.172) data 0.108 (0.096) loss_u loss_u 0.9165 (0.8904) acc_u 12.5000 (12.7083) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/31] time 0.172 (0.174) data 0.096 (0.097) loss_u loss_u 0.9155 (0.8973) acc_u 9.3750 (12.1875) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [25/31] time 0.180 (0.174) data 0.103 (0.098) loss_u loss_u 0.9590 (0.9060) acc_u 9.3750 (11.5000) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [30/31] time 0.183 (0.175) data 0.105 (0.098) loss_u loss_u 0.9463 (0.9064) acc_u 6.2500 (11.0417) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 598
clean true:593
clean false:5
clean_rate:0.9916387959866221
noisy true:559
noisy false:443
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1002
epoch [6/200] batch [5/18] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 1.0068 (0.9332) acc_x 78.1250 (76.2500) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/18] time 0.163 (0.176) data 0.087 (0.100) loss_x loss_x 0.8203 (0.7991) acc_x 78.1250 (78.7500) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [15/18] time 0.180 (0.177) data 0.103 (0.101) loss_x loss_x 0.9902 (0.8263) acc_x 78.1250 (78.9583) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/31] time 0.178 (0.178) data 0.102 (0.102) loss_u loss_u 0.8511 (0.9056) acc_u 18.7500 (10.6250) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/31] time 0.178 (0.179) data 0.102 (0.102) loss_u loss_u 0.9570 (0.9306) acc_u 3.1250 (7.5000) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/31] time 0.182 (0.179) data 0.106 (0.103) loss_u loss_u 0.9526 (0.9361) acc_u 3.1250 (6.4583) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/31] time 0.188 (0.179) data 0.111 (0.103) loss_u loss_u 0.8799 (0.9251) acc_u 12.5000 (7.6562) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [25/31] time 0.186 (0.180) data 0.110 (0.103) loss_u loss_u 0.9199 (0.9163) acc_u 6.2500 (9.0000) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [30/31] time 0.182 (0.180) data 0.106 (0.104) loss_u loss_u 0.9165 (0.9173) acc_u 9.3750 (8.8542) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 500
confident_label rate tensor(0.3581, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 573
clean true:568
clean false:5
clean_rate:0.9912739965095986
noisy true:532
noisy false:495
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 1027
epoch [7/200] batch [5/17] time 0.185 (0.181) data 0.108 (0.105) loss_x loss_x 0.5742 (0.7574) acc_x 81.2500 (78.1250) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/17] time 0.175 (0.180) data 0.099 (0.104) loss_x loss_x 0.7734 (0.7916) acc_x 78.1250 (78.7500) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [15/17] time 0.181 (0.180) data 0.105 (0.104) loss_x loss_x 0.9985 (0.7747) acc_x 68.7500 (79.5833) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/32] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.8960 (0.9166) acc_u 9.3750 (9.3750) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/32] time 0.180 (0.181) data 0.104 (0.104) loss_u loss_u 0.8877 (0.9012) acc_u 9.3750 (11.5625) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [15/32] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.9180 (0.8942) acc_u 6.2500 (12.0833) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/32] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.9185 (0.8917) acc_u 12.5000 (12.5000) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [25/32] time 0.164 (0.179) data 0.087 (0.102) loss_u loss_u 0.8706 (0.8927) acc_u 18.7500 (12.6250) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [30/32] time 0.161 (0.177) data 0.083 (0.100) loss_u loss_u 0.8833 (0.8944) acc_u 9.3750 (12.1875) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 592
clean true:587
clean false:5
clean_rate:0.9915540540540541
noisy true:581
noisy false:427
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1008
epoch [8/200] batch [5/18] time 0.171 (0.176) data 0.093 (0.099) loss_x loss_x 1.6143 (0.8779) acc_x 68.7500 (80.0000) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/18] time 0.181 (0.174) data 0.106 (0.098) loss_x loss_x 1.0107 (0.7467) acc_x 75.0000 (81.8750) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/18] time 0.186 (0.178) data 0.110 (0.101) loss_x loss_x 0.7573 (0.7335) acc_x 78.1250 (81.4583) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/31] time 0.164 (0.177) data 0.086 (0.100) loss_u loss_u 0.8130 (0.8699) acc_u 21.8750 (15.6250) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/31] time 0.188 (0.175) data 0.111 (0.099) loss_u loss_u 0.9546 (0.8901) acc_u 6.2500 (13.7500) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/31] time 0.182 (0.176) data 0.104 (0.100) loss_u loss_u 0.9346 (0.8933) acc_u 3.1250 (12.2917) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/31] time 0.167 (0.176) data 0.090 (0.099) loss_u loss_u 0.8755 (0.8951) acc_u 15.6250 (12.0312) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [25/31] time 0.179 (0.176) data 0.102 (0.100) loss_u loss_u 0.8394 (0.8985) acc_u 15.6250 (11.5000) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [30/31] time 0.180 (0.177) data 0.103 (0.100) loss_u loss_u 0.8750 (0.9006) acc_u 9.3750 (11.3542) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 449
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 601
clean true:593
clean false:8
clean_rate:0.9866888519134775
noisy true:558
noisy false:441
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 999
epoch [9/200] batch [5/18] time 0.186 (0.177) data 0.110 (0.100) loss_x loss_x 0.8135 (0.6673) acc_x 75.0000 (84.3750) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/18] time 0.165 (0.177) data 0.087 (0.100) loss_x loss_x 0.7134 (0.7493) acc_x 75.0000 (80.9375) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [15/18] time 0.164 (0.172) data 0.088 (0.096) loss_x loss_x 0.6494 (0.7489) acc_x 81.2500 (80.6250) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/31] time 0.173 (0.174) data 0.096 (0.098) loss_u loss_u 0.8765 (0.8886) acc_u 12.5000 (11.2500) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/31] time 0.190 (0.176) data 0.112 (0.099) loss_u loss_u 0.9180 (0.8928) acc_u 9.3750 (11.5625) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/31] time 0.180 (0.177) data 0.103 (0.100) loss_u loss_u 0.8525 (0.8955) acc_u 15.6250 (11.4583) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/31] time 0.179 (0.177) data 0.102 (0.100) loss_u loss_u 0.9409 (0.9063) acc_u 3.1250 (10.3125) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [25/31] time 0.181 (0.178) data 0.105 (0.101) loss_u loss_u 0.8984 (0.9057) acc_u 12.5000 (10.5000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [30/31] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.9512 (0.9055) acc_u 3.1250 (10.6250) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.3637, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 582
clean true:578
clean false:4
clean_rate:0.993127147766323
noisy true:567
noisy false:451
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1018
epoch [10/200] batch [5/18] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 1.0605 (0.7694) acc_x 71.8750 (77.5000) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/18] time 0.166 (0.182) data 0.089 (0.106) loss_x loss_x 0.8008 (0.7598) acc_x 81.2500 (78.4375) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [15/18] time 0.165 (0.181) data 0.089 (0.105) loss_x loss_x 0.6904 (0.7063) acc_x 84.3750 (81.0417) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/31] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9072 (0.8812) acc_u 12.5000 (13.7500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/31] time 0.164 (0.178) data 0.088 (0.101) loss_u loss_u 0.9312 (0.8871) acc_u 6.2500 (11.8750) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [15/31] time 0.182 (0.178) data 0.105 (0.102) loss_u loss_u 0.9053 (0.8856) acc_u 9.3750 (12.0833) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [20/31] time 0.171 (0.178) data 0.095 (0.101) loss_u loss_u 0.9404 (0.8915) acc_u 6.2500 (11.2500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [25/31] time 0.166 (0.177) data 0.090 (0.101) loss_u loss_u 0.8911 (0.8966) acc_u 12.5000 (11.1250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [30/31] time 0.172 (0.177) data 0.096 (0.101) loss_u loss_u 0.7979 (0.8932) acc_u 21.8750 (11.7708) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.3675, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 588
clean true:582
clean false:6
clean_rate:0.9897959183673469
noisy true:553
noisy false:459
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1012
epoch [11/200] batch [5/18] time 0.199 (0.167) data 0.123 (0.091) loss_x loss_x 0.8682 (0.7352) acc_x 81.2500 (80.0000) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/18] time 0.171 (0.172) data 0.095 (0.096) loss_x loss_x 0.7754 (0.7214) acc_x 84.3750 (81.5625) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/18] time 0.195 (0.177) data 0.119 (0.100) loss_x loss_x 0.3779 (0.6970) acc_x 90.6250 (81.4583) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/31] time 0.183 (0.176) data 0.106 (0.100) loss_u loss_u 0.9712 (0.9213) acc_u 3.1250 (8.7500) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/31] time 0.183 (0.177) data 0.106 (0.101) loss_u loss_u 0.9141 (0.9184) acc_u 9.3750 (9.0625) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/31] time 0.182 (0.178) data 0.106 (0.102) loss_u loss_u 0.8325 (0.8989) acc_u 18.7500 (11.4583) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/31] time 0.208 (0.180) data 0.130 (0.103) loss_u loss_u 0.8472 (0.8949) acc_u 18.7500 (12.3438) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [25/31] time 0.201 (0.181) data 0.124 (0.104) loss_u loss_u 0.9370 (0.8962) acc_u 9.3750 (12.2500) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [30/31] time 0.168 (0.179) data 0.091 (0.103) loss_u loss_u 0.9233 (0.8945) acc_u 9.3750 (12.6042) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 597
clean true:591
clean false:6
clean_rate:0.9899497487437185
noisy true:573
noisy false:430
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1003
epoch [12/200] batch [5/18] time 0.180 (0.192) data 0.102 (0.116) loss_x loss_x 0.7661 (0.6217) acc_x 81.2500 (80.0000) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/18] time 0.169 (0.187) data 0.093 (0.110) loss_x loss_x 0.6328 (0.6721) acc_x 78.1250 (79.6875) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [15/18] time 0.184 (0.183) data 0.106 (0.107) loss_x loss_x 0.5986 (0.6650) acc_x 78.1250 (79.7917) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/31] time 0.167 (0.181) data 0.089 (0.104) loss_u loss_u 0.8677 (0.9072) acc_u 12.5000 (10.0000) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/31] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8691 (0.8985) acc_u 12.5000 (10.3125) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/31] time 0.166 (0.180) data 0.088 (0.103) loss_u loss_u 0.8896 (0.9012) acc_u 18.7500 (11.2500) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/31] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9390 (0.9047) acc_u 6.2500 (10.9375) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [25/31] time 0.181 (0.180) data 0.105 (0.104) loss_u loss_u 0.8789 (0.9050) acc_u 12.5000 (10.8750) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [30/31] time 0.163 (0.179) data 0.086 (0.102) loss_u loss_u 0.9116 (0.8994) acc_u 9.3750 (11.4583) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 612
clean true:607
clean false:5
clean_rate:0.9918300653594772
noisy true:581
noisy false:407
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 988
epoch [13/200] batch [5/19] time 0.186 (0.182) data 0.109 (0.106) loss_x loss_x 1.0107 (0.8349) acc_x 81.2500 (82.5000) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/19] time 0.190 (0.183) data 0.113 (0.106) loss_x loss_x 0.2607 (0.7764) acc_x 96.8750 (83.1250) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [15/19] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.5854 (0.7177) acc_x 78.1250 (82.5000) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/30] time 0.186 (0.180) data 0.110 (0.103) loss_u loss_u 0.8901 (0.8890) acc_u 9.3750 (12.5000) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/30] time 0.186 (0.181) data 0.110 (0.104) loss_u loss_u 0.8574 (0.8899) acc_u 15.6250 (12.5000) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [15/30] time 0.163 (0.179) data 0.086 (0.103) loss_u loss_u 0.9810 (0.9052) acc_u 3.1250 (10.8333) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/30] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.8398 (0.9066) acc_u 25.0000 (10.9375) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [25/30] time 0.186 (0.179) data 0.110 (0.102) loss_u loss_u 0.8784 (0.9100) acc_u 12.5000 (10.3750) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [30/30] time 0.180 (0.179) data 0.103 (0.103) loss_u loss_u 0.7969 (0.9073) acc_u 25.0000 (10.7292) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 434
confident_label rate tensor(0.3869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 619
clean true:615
clean false:4
clean_rate:0.9935379644588045
noisy true:551
noisy false:430
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 981
epoch [14/200] batch [5/19] time 0.189 (0.191) data 0.113 (0.114) loss_x loss_x 0.3628 (0.5432) acc_x 90.6250 (83.1250) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/19] time 0.168 (0.191) data 0.092 (0.114) loss_x loss_x 0.7964 (0.6673) acc_x 71.8750 (81.2500) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [15/19] time 0.177 (0.185) data 0.100 (0.109) loss_x loss_x 0.5293 (0.6333) acc_x 90.6250 (82.9167) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/30] time 0.177 (0.177) data 0.101 (0.101) loss_u loss_u 0.9673 (0.9055) acc_u 3.1250 (11.2500) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/30] time 0.181 (0.178) data 0.105 (0.101) loss_u loss_u 0.8691 (0.9130) acc_u 15.6250 (9.6875) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [15/30] time 0.178 (0.179) data 0.101 (0.102) loss_u loss_u 0.8999 (0.9129) acc_u 9.3750 (9.7917) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [20/30] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8857 (0.9136) acc_u 15.6250 (10.3125) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [25/30] time 0.165 (0.179) data 0.088 (0.102) loss_u loss_u 0.9390 (0.9166) acc_u 3.1250 (9.5000) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [30/30] time 0.194 (0.178) data 0.118 (0.102) loss_u loss_u 0.8169 (0.9128) acc_u 21.8750 (9.6875) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.3812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 610
clean true:605
clean false:5
clean_rate:0.9918032786885246
noisy true:563
noisy false:427
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 990
epoch [15/200] batch [5/19] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.3479 (0.7179) acc_x 87.5000 (83.7500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/19] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 0.9058 (0.7533) acc_x 78.1250 (82.8125) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [15/19] time 0.164 (0.173) data 0.086 (0.096) loss_x loss_x 0.7168 (0.6733) acc_x 84.3750 (83.7500) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/30] time 0.164 (0.171) data 0.087 (0.094) loss_u loss_u 0.8550 (0.9060) acc_u 12.5000 (10.0000) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [10/30] time 0.182 (0.173) data 0.104 (0.096) loss_u loss_u 0.8511 (0.9021) acc_u 18.7500 (11.8750) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [15/30] time 0.190 (0.175) data 0.112 (0.098) loss_u loss_u 0.8862 (0.8909) acc_u 15.6250 (13.1250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/30] time 0.195 (0.179) data 0.119 (0.102) loss_u loss_u 0.8960 (0.9004) acc_u 12.5000 (12.1875) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [25/30] time 0.165 (0.180) data 0.088 (0.103) loss_u loss_u 0.9077 (0.9049) acc_u 9.3750 (11.3750) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [30/30] time 0.193 (0.181) data 0.117 (0.103) loss_u loss_u 0.8433 (0.9042) acc_u 15.6250 (11.3542) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 595
clean true:587
clean false:8
clean_rate:0.9865546218487395
noisy true:573
noisy false:432
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1005
epoch [16/200] batch [5/18] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 0.6392 (0.7094) acc_x 81.2500 (80.0000) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/18] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.7856 (0.6946) acc_x 78.1250 (79.6875) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [15/18] time 0.187 (0.189) data 0.111 (0.112) loss_x loss_x 0.3142 (0.6354) acc_x 90.6250 (81.4583) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/31] time 0.213 (0.188) data 0.137 (0.111) loss_u loss_u 0.8501 (0.9143) acc_u 15.6250 (8.7500) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [10/31] time 0.165 (0.186) data 0.089 (0.109) loss_u loss_u 0.8926 (0.9156) acc_u 12.5000 (9.0625) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [15/31] time 0.168 (0.184) data 0.090 (0.107) loss_u loss_u 0.9092 (0.9135) acc_u 9.3750 (9.3750) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/31] time 0.164 (0.184) data 0.087 (0.107) loss_u loss_u 0.9360 (0.9008) acc_u 6.2500 (10.6250) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [25/31] time 0.193 (0.182) data 0.116 (0.106) loss_u loss_u 0.7866 (0.8976) acc_u 31.2500 (11.5000) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [30/31] time 0.196 (0.182) data 0.118 (0.106) loss_u loss_u 0.8682 (0.8986) acc_u 12.5000 (11.1458) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.3975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 636
clean true:631
clean false:5
clean_rate:0.9921383647798742
noisy true:569
noisy false:395
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 964
epoch [17/200] batch [5/19] time 0.178 (0.185) data 0.102 (0.109) loss_x loss_x 0.9722 (0.7993) acc_x 78.1250 (81.8750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/19] time 0.182 (0.186) data 0.107 (0.110) loss_x loss_x 0.6797 (0.7849) acc_x 84.3750 (80.3125) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [15/19] time 0.155 (0.178) data 0.079 (0.102) loss_x loss_x 0.8604 (0.7899) acc_x 75.0000 (80.2083) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/30] time 0.163 (0.176) data 0.086 (0.100) loss_u loss_u 0.9517 (0.9204) acc_u 6.2500 (8.7500) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [10/30] time 0.179 (0.177) data 0.102 (0.100) loss_u loss_u 0.8506 (0.9034) acc_u 18.7500 (11.5625) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/30] time 0.170 (0.177) data 0.094 (0.100) loss_u loss_u 0.9438 (0.9150) acc_u 6.2500 (10.0000) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/30] time 0.159 (0.177) data 0.082 (0.100) loss_u loss_u 0.8667 (0.9094) acc_u 12.5000 (10.3125) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [25/30] time 0.167 (0.176) data 0.090 (0.099) loss_u loss_u 0.9014 (0.9112) acc_u 15.6250 (10.3750) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [30/30] time 0.169 (0.175) data 0.092 (0.099) loss_u loss_u 0.9399 (0.9128) acc_u 9.3750 (10.2083) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.3869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 619
clean true:611
clean false:8
clean_rate:0.9870759289176091
noisy true:561
noisy false:420
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 981
epoch [18/200] batch [5/19] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.9595 (0.7311) acc_x 81.2500 (81.8750) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/19] time 0.166 (0.179) data 0.090 (0.102) loss_x loss_x 1.1465 (0.8199) acc_x 65.6250 (79.0625) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [15/19] time 0.179 (0.179) data 0.103 (0.103) loss_x loss_x 0.5615 (0.8275) acc_x 87.5000 (80.0000) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/30] time 0.159 (0.179) data 0.081 (0.103) loss_u loss_u 0.8691 (0.8971) acc_u 15.6250 (11.2500) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [10/30] time 0.177 (0.179) data 0.099 (0.102) loss_u loss_u 0.8325 (0.8998) acc_u 21.8750 (11.8750) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/30] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.8838 (0.8963) acc_u 12.5000 (12.5000) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/30] time 0.184 (0.178) data 0.108 (0.101) loss_u loss_u 0.9375 (0.9018) acc_u 6.2500 (11.5625) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [25/30] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8623 (0.9011) acc_u 9.3750 (11.0000) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [30/30] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.8574 (0.9008) acc_u 15.6250 (10.9375) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 601
clean true:594
clean false:7
clean_rate:0.9883527454242929
noisy true:556
noisy false:443
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 999
epoch [19/200] batch [5/18] time 0.179 (0.180) data 0.103 (0.104) loss_x loss_x 0.6216 (0.6102) acc_x 84.3750 (83.1250) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [10/18] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.8198 (0.6289) acc_x 71.8750 (82.1875) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [15/18] time 0.160 (0.179) data 0.084 (0.102) loss_x loss_x 0.5850 (0.6558) acc_x 78.1250 (81.8750) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/31] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.8931 (0.8527) acc_u 12.5000 (19.3750) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [10/31] time 0.184 (0.180) data 0.106 (0.104) loss_u loss_u 0.8467 (0.8844) acc_u 15.6250 (14.3750) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/31] time 0.165 (0.180) data 0.088 (0.104) loss_u loss_u 0.8936 (0.8910) acc_u 9.3750 (13.7500) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [20/31] time 0.176 (0.179) data 0.099 (0.103) loss_u loss_u 0.8682 (0.8920) acc_u 18.7500 (13.5938) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [25/31] time 0.183 (0.180) data 0.107 (0.103) loss_u loss_u 0.8530 (0.8936) acc_u 18.7500 (13.3750) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [30/31] time 0.181 (0.180) data 0.103 (0.104) loss_u loss_u 0.8584 (0.8936) acc_u 15.6250 (13.2292) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 609
clean true:603
clean false:6
clean_rate:0.9901477832512315
noisy true:588
noisy false:403
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 991
epoch [20/200] batch [5/19] time 0.165 (0.169) data 0.089 (0.093) loss_x loss_x 0.5918 (0.6745) acc_x 84.3750 (81.2500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [10/19] time 0.183 (0.172) data 0.107 (0.096) loss_x loss_x 0.6675 (0.6778) acc_x 84.3750 (81.5625) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [15/19] time 0.178 (0.173) data 0.101 (0.096) loss_x loss_x 0.3811 (0.6584) acc_x 90.6250 (82.5000) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/30] time 0.161 (0.171) data 0.085 (0.094) loss_u loss_u 0.8525 (0.8768) acc_u 15.6250 (14.3750) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/30] time 0.171 (0.171) data 0.094 (0.094) loss_u loss_u 0.9443 (0.9086) acc_u 9.3750 (10.6250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/30] time 0.189 (0.173) data 0.112 (0.096) loss_u loss_u 0.8687 (0.8995) acc_u 15.6250 (11.2500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/30] time 0.184 (0.174) data 0.107 (0.098) loss_u loss_u 0.9146 (0.8976) acc_u 12.5000 (11.5625) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [25/30] time 0.173 (0.176) data 0.096 (0.099) loss_u loss_u 0.9106 (0.8960) acc_u 9.3750 (11.7500) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [30/30] time 0.183 (0.176) data 0.107 (0.099) loss_u loss_u 0.9082 (0.8967) acc_u 9.3750 (11.6667) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.3887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 622
clean true:617
clean false:5
clean_rate:0.9919614147909968
noisy true:573
noisy false:405
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 978
epoch [21/200] batch [5/19] time 0.182 (0.171) data 0.106 (0.095) loss_x loss_x 0.5757 (0.7270) acc_x 78.1250 (78.1250) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [10/19] time 0.160 (0.167) data 0.083 (0.091) loss_x loss_x 0.5220 (0.6430) acc_x 84.3750 (80.0000) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [15/19] time 0.189 (0.167) data 0.113 (0.090) loss_x loss_x 0.9961 (0.6742) acc_x 71.8750 (79.1667) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/30] time 0.180 (0.169) data 0.103 (0.093) loss_u loss_u 0.9834 (0.9359) acc_u 3.1250 (6.8750) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [10/30] time 0.187 (0.172) data 0.110 (0.095) loss_u loss_u 0.8706 (0.9217) acc_u 12.5000 (8.7500) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [15/30] time 0.175 (0.172) data 0.098 (0.096) loss_u loss_u 0.9185 (0.9122) acc_u 9.3750 (10.0000) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [20/30] time 0.181 (0.173) data 0.103 (0.096) loss_u loss_u 0.8862 (0.9115) acc_u 12.5000 (10.4688) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [25/30] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.9204 (0.9098) acc_u 6.2500 (10.5000) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [30/30] time 0.176 (0.174) data 0.099 (0.098) loss_u loss_u 0.8867 (0.9131) acc_u 9.3750 (9.7917) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 618
clean true:611
clean false:7
clean_rate:0.988673139158576
noisy true:577
noisy false:405
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 982
epoch [22/200] batch [5/19] time 0.162 (0.163) data 0.085 (0.086) loss_x loss_x 0.6172 (0.6800) acc_x 81.2500 (84.3750) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/19] time 0.172 (0.168) data 0.096 (0.091) loss_x loss_x 0.4871 (0.7323) acc_x 87.5000 (82.1875) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [15/19] time 0.179 (0.172) data 0.103 (0.095) loss_x loss_x 0.2583 (0.6096) acc_x 96.8750 (83.9583) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/30] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.9189 (0.8966) acc_u 6.2500 (11.2500) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/30] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9795 (0.9029) acc_u 3.1250 (10.6250) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/30] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.9038 (0.9055) acc_u 12.5000 (10.4167) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/30] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8779 (0.9041) acc_u 12.5000 (10.4688) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [25/30] time 0.186 (0.179) data 0.110 (0.103) loss_u loss_u 0.8496 (0.8995) acc_u 15.6250 (11.0000) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [30/30] time 0.190 (0.180) data 0.114 (0.103) loss_u loss_u 0.9189 (0.9015) acc_u 9.3750 (10.6250) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 442
confident_label rate tensor(0.3881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 621
clean true:611
clean false:10
clean_rate:0.9838969404186796
noisy true:547
noisy false:432
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 979
epoch [23/200] batch [5/19] time 0.176 (0.189) data 0.100 (0.112) loss_x loss_x 0.9111 (0.6480) acc_x 75.0000 (84.3750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [10/19] time 0.165 (0.182) data 0.089 (0.105) loss_x loss_x 0.7886 (0.6212) acc_x 78.1250 (83.4375) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [15/19] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.4346 (0.6510) acc_x 90.6250 (82.9167) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/30] time 0.157 (0.176) data 0.080 (0.099) loss_u loss_u 0.8960 (0.9324) acc_u 12.5000 (8.7500) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [10/30] time 0.174 (0.176) data 0.097 (0.099) loss_u loss_u 0.9380 (0.9247) acc_u 6.2500 (8.7500) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/30] time 0.181 (0.176) data 0.104 (0.100) loss_u loss_u 0.8579 (0.9245) acc_u 15.6250 (8.5417) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [20/30] time 0.181 (0.177) data 0.105 (0.100) loss_u loss_u 0.9355 (0.9266) acc_u 6.2500 (7.8125) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [25/30] time 0.187 (0.177) data 0.110 (0.101) loss_u loss_u 0.9561 (0.9187) acc_u 3.1250 (8.8750) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [30/30] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9043 (0.9124) acc_u 9.3750 (9.6875) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 419
confident_label rate tensor(0.3856, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 617
clean true:612
clean false:5
clean_rate:0.9918962722852512
noisy true:569
noisy false:414
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 983
epoch [24/200] batch [5/19] time 0.174 (0.176) data 0.098 (0.100) loss_x loss_x 0.9634 (0.6316) acc_x 78.1250 (85.6250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/19] time 0.166 (0.171) data 0.090 (0.095) loss_x loss_x 0.6689 (0.6283) acc_x 90.6250 (83.7500) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [15/19] time 0.170 (0.171) data 0.093 (0.095) loss_x loss_x 0.7461 (0.6617) acc_x 84.3750 (82.5000) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/30] time 0.155 (0.173) data 0.079 (0.096) loss_u loss_u 0.9102 (0.9050) acc_u 3.1250 (8.1250) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [10/30] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.8965 (0.9024) acc_u 9.3750 (10.3125) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [15/30] time 0.155 (0.172) data 0.079 (0.095) loss_u loss_u 0.8789 (0.8971) acc_u 12.5000 (10.6250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/30] time 0.185 (0.171) data 0.108 (0.095) loss_u loss_u 0.9888 (0.9033) acc_u 0.0000 (10.0000) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [25/30] time 0.182 (0.173) data 0.105 (0.096) loss_u loss_u 0.9136 (0.9054) acc_u 12.5000 (10.0000) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [30/30] time 0.186 (0.174) data 0.109 (0.097) loss_u loss_u 0.9385 (0.9126) acc_u 12.5000 (9.3750) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.3887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 622
clean true:612
clean false:10
clean_rate:0.9839228295819936
noisy true:559
noisy false:419
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 978
epoch [25/200] batch [5/19] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 1.0049 (0.6536) acc_x 71.8750 (81.8750) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/19] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 0.7637 (0.7307) acc_x 81.2500 (82.1875) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [15/19] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.6968 (0.7151) acc_x 84.3750 (82.2917) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/30] time 0.183 (0.182) data 0.105 (0.106) loss_u loss_u 0.8975 (0.8974) acc_u 9.3750 (11.8750) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [10/30] time 0.185 (0.183) data 0.109 (0.106) loss_u loss_u 0.9077 (0.9012) acc_u 9.3750 (10.9375) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/30] time 0.178 (0.183) data 0.101 (0.106) loss_u loss_u 0.9160 (0.8991) acc_u 9.3750 (11.2500) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [20/30] time 0.160 (0.181) data 0.083 (0.104) loss_u loss_u 0.8789 (0.8955) acc_u 15.6250 (11.7188) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [25/30] time 0.160 (0.178) data 0.083 (0.102) loss_u loss_u 0.9663 (0.8952) acc_u 3.1250 (11.6250) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [30/30] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.9648 (0.8981) acc_u 3.1250 (11.3542) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.3862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 618
clean true:609
clean false:9
clean_rate:0.9854368932038835
noisy true:567
noisy false:415
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 982
epoch [26/200] batch [5/19] time 0.166 (0.169) data 0.089 (0.093) loss_x loss_x 0.6309 (0.6640) acc_x 84.3750 (83.7500) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/19] time 0.173 (0.173) data 0.096 (0.096) loss_x loss_x 0.4688 (0.6383) acc_x 90.6250 (85.9375) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/19] time 0.183 (0.175) data 0.107 (0.098) loss_x loss_x 1.3867 (0.7394) acc_x 71.8750 (82.5000) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/30] time 0.176 (0.175) data 0.099 (0.099) loss_u loss_u 0.9155 (0.8968) acc_u 9.3750 (11.2500) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/30] time 0.166 (0.175) data 0.089 (0.098) loss_u loss_u 0.9165 (0.8886) acc_u 9.3750 (11.5625) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [15/30] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.8188 (0.8884) acc_u 21.8750 (11.8750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/30] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.9634 (0.8903) acc_u 3.1250 (12.1875) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [25/30] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.9619 (0.8976) acc_u 3.1250 (11.3750) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [30/30] time 0.183 (0.175) data 0.107 (0.099) loss_u loss_u 0.8828 (0.9000) acc_u 12.5000 (10.9375) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 419
confident_label rate tensor(0.3887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 622
clean true:613
clean false:9
clean_rate:0.9855305466237942
noisy true:568
noisy false:410
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 978
epoch [27/200] batch [5/19] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.7798 (0.6493) acc_x 81.2500 (81.8750) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/19] time 0.178 (0.178) data 0.102 (0.102) loss_x loss_x 0.4351 (0.6502) acc_x 87.5000 (81.8750) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/19] time 0.176 (0.179) data 0.100 (0.103) loss_x loss_x 0.9175 (0.6684) acc_x 75.0000 (82.2917) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/30] time 0.159 (0.177) data 0.083 (0.100) loss_u loss_u 0.8638 (0.8845) acc_u 18.7500 (13.1250) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/30] time 0.166 (0.176) data 0.089 (0.099) loss_u loss_u 0.9873 (0.8807) acc_u 0.0000 (12.8125) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [15/30] time 0.178 (0.175) data 0.100 (0.099) loss_u loss_u 0.9736 (0.8919) acc_u 3.1250 (11.2500) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/30] time 0.177 (0.176) data 0.100 (0.099) loss_u loss_u 0.9131 (0.8952) acc_u 9.3750 (11.0938) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [25/30] time 0.172 (0.176) data 0.094 (0.099) loss_u loss_u 0.9521 (0.8973) acc_u 6.2500 (11.0000) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [30/30] time 0.189 (0.176) data 0.111 (0.100) loss_u loss_u 0.9102 (0.8976) acc_u 6.2500 (10.9375) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.3944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 631
clean true:626
clean false:5
clean_rate:0.9920760697305864
noisy true:567
noisy false:402
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 969
epoch [28/200] batch [5/19] time 0.181 (0.177) data 0.105 (0.101) loss_x loss_x 0.8042 (0.7676) acc_x 81.2500 (79.3750) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/19] time 0.184 (0.181) data 0.107 (0.105) loss_x loss_x 0.9688 (0.7162) acc_x 68.7500 (79.0625) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/19] time 0.177 (0.181) data 0.101 (0.105) loss_x loss_x 1.0146 (0.7266) acc_x 84.3750 (79.7917) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/30] time 0.167 (0.179) data 0.091 (0.102) loss_u loss_u 0.8569 (0.9081) acc_u 12.5000 (10.6250) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/30] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9155 (0.9003) acc_u 9.3750 (10.9375) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/30] time 0.162 (0.175) data 0.086 (0.099) loss_u loss_u 0.8882 (0.9060) acc_u 12.5000 (10.4167) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/30] time 0.185 (0.177) data 0.109 (0.100) loss_u loss_u 0.8794 (0.9015) acc_u 18.7500 (11.4062) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [25/30] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.8340 (0.8984) acc_u 15.6250 (11.3750) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [30/30] time 0.172 (0.177) data 0.094 (0.100) loss_u loss_u 0.9590 (0.9040) acc_u 3.1250 (10.7292) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.3962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 634
clean true:627
clean false:7
clean_rate:0.9889589905362776
noisy true:576
noisy false:390
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 966
epoch [29/200] batch [5/19] time 0.172 (0.173) data 0.095 (0.097) loss_x loss_x 0.6274 (0.7863) acc_x 75.0000 (78.7500) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/19] time 0.201 (0.176) data 0.125 (0.100) loss_x loss_x 1.2588 (0.7730) acc_x 65.6250 (79.0625) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/19] time 0.171 (0.174) data 0.094 (0.097) loss_x loss_x 0.5742 (0.7178) acc_x 81.2500 (80.4167) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/30] time 0.169 (0.175) data 0.092 (0.099) loss_u loss_u 0.8940 (0.8822) acc_u 12.5000 (12.5000) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/30] time 0.161 (0.174) data 0.084 (0.097) loss_u loss_u 0.9062 (0.9029) acc_u 9.3750 (10.0000) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [15/30] time 0.187 (0.175) data 0.110 (0.098) loss_u loss_u 0.9053 (0.9083) acc_u 9.3750 (10.0000) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/30] time 0.187 (0.176) data 0.111 (0.099) loss_u loss_u 0.9150 (0.9089) acc_u 9.3750 (9.8438) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [25/30] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9160 (0.9069) acc_u 6.2500 (9.8750) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [30/30] time 0.183 (0.177) data 0.106 (0.101) loss_u loss_u 0.9121 (0.9035) acc_u 9.3750 (10.5208) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.3894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 623
clean true:616
clean false:7
clean_rate:0.9887640449438202
noisy true:562
noisy false:415
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 977
epoch [30/200] batch [5/19] time 0.184 (0.187) data 0.108 (0.111) loss_x loss_x 0.6558 (0.4099) acc_x 84.3750 (88.7500) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/19] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.4514 (0.3740) acc_x 81.2500 (88.7500) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/19] time 0.173 (0.180) data 0.097 (0.104) loss_x loss_x 0.8940 (0.4736) acc_x 87.5000 (87.0833) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/30] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.9785 (0.9276) acc_u 0.0000 (7.5000) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [10/30] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.8955 (0.9354) acc_u 9.3750 (6.5625) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [15/30] time 0.175 (0.175) data 0.098 (0.099) loss_u loss_u 0.9131 (0.9261) acc_u 9.3750 (7.9167) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [20/30] time 0.186 (0.175) data 0.110 (0.099) loss_u loss_u 0.9707 (0.9212) acc_u 3.1250 (8.9062) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [25/30] time 0.180 (0.176) data 0.101 (0.100) loss_u loss_u 0.9121 (0.9114) acc_u 9.3750 (10.1250) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [30/30] time 0.192 (0.177) data 0.114 (0.101) loss_u loss_u 0.8525 (0.9081) acc_u 15.6250 (10.5208) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:637
clean false:10
clean_rate:0.9845440494590417
noisy true:570
noisy false:383
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [31/200] batch [5/20] time 0.168 (0.176) data 0.092 (0.099) loss_x loss_x 0.8647 (0.7122) acc_x 84.3750 (81.8750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/20] time 0.181 (0.177) data 0.106 (0.101) loss_x loss_x 0.9370 (0.7675) acc_x 71.8750 (80.0000) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/20] time 0.185 (0.178) data 0.109 (0.101) loss_x loss_x 0.9834 (0.7408) acc_x 87.5000 (81.6667) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [20/20] time 0.196 (0.178) data 0.120 (0.101) loss_x loss_x 0.7900 (0.7216) acc_x 81.2500 (82.1875) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/29] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8774 (0.9163) acc_u 12.5000 (10.0000) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/29] time 0.157 (0.176) data 0.079 (0.099) loss_u loss_u 0.9141 (0.9185) acc_u 9.3750 (9.6875) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/29] time 0.186 (0.176) data 0.109 (0.099) loss_u loss_u 0.8813 (0.9210) acc_u 15.6250 (9.3750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/29] time 0.178 (0.177) data 0.100 (0.100) loss_u loss_u 0.8022 (0.9196) acc_u 21.8750 (9.5312) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [25/29] time 0.176 (0.176) data 0.100 (0.100) loss_u loss_u 0.9209 (0.9228) acc_u 6.2500 (9.0000) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 649
clean true:639
clean false:10
clean_rate:0.9845916795069337
noisy true:559
noisy false:392
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 951
epoch [32/200] batch [5/20] time 0.181 (0.196) data 0.105 (0.120) loss_x loss_x 0.4958 (0.4365) acc_x 87.5000 (85.6250) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/20] time 0.157 (0.186) data 0.080 (0.110) loss_x loss_x 1.0928 (0.6116) acc_x 71.8750 (82.5000) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/20] time 0.186 (0.183) data 0.109 (0.107) loss_x loss_x 0.5405 (0.6316) acc_x 84.3750 (82.2917) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [20/20] time 0.189 (0.184) data 0.113 (0.107) loss_x loss_x 1.0039 (0.6635) acc_x 78.1250 (81.8750) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/29] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9395 (0.9343) acc_u 6.2500 (7.5000) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/29] time 0.184 (0.184) data 0.108 (0.107) loss_u loss_u 0.9678 (0.9206) acc_u 3.1250 (8.4375) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [15/29] time 0.181 (0.184) data 0.103 (0.107) loss_u loss_u 0.9155 (0.9128) acc_u 9.3750 (10.0000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/29] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9409 (0.9133) acc_u 6.2500 (10.0000) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [25/29] time 0.163 (0.182) data 0.086 (0.105) loss_u loss_u 0.8730 (0.9159) acc_u 12.5000 (9.7500) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.3919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 627
clean true:622
clean false:5
clean_rate:0.9920255183413078
noisy true:586
noisy false:387
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 973
epoch [33/200] batch [5/19] time 0.161 (0.162) data 0.085 (0.086) loss_x loss_x 0.5298 (0.7892) acc_x 84.3750 (80.0000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/19] time 0.161 (0.162) data 0.084 (0.085) loss_x loss_x 0.5044 (0.7089) acc_x 84.3750 (80.9375) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/19] time 0.186 (0.166) data 0.110 (0.089) loss_x loss_x 0.6333 (0.7134) acc_x 87.5000 (81.8750) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/30] time 0.187 (0.172) data 0.109 (0.096) loss_u loss_u 0.8867 (0.9289) acc_u 15.6250 (9.3750) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/30] time 0.187 (0.175) data 0.111 (0.098) loss_u loss_u 0.8418 (0.9143) acc_u 12.5000 (10.0000) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/30] time 0.187 (0.176) data 0.110 (0.100) loss_u loss_u 0.8013 (0.9022) acc_u 21.8750 (11.0417) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/30] time 0.179 (0.177) data 0.103 (0.100) loss_u loss_u 0.9731 (0.9045) acc_u 3.1250 (11.0938) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [25/30] time 0.180 (0.178) data 0.102 (0.101) loss_u loss_u 0.8804 (0.9024) acc_u 12.5000 (11.2500) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [30/30] time 0.187 (0.178) data 0.110 (0.101) loss_u loss_u 0.9849 (0.9047) acc_u 0.0000 (11.0417) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.3925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 628
clean true:615
clean false:13
clean_rate:0.9792993630573248
noisy true:559
noisy false:413
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 972
epoch [34/200] batch [5/19] time 0.162 (0.182) data 0.086 (0.106) loss_x loss_x 0.4438 (0.4923) acc_x 87.5000 (88.1250) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/19] time 0.191 (0.176) data 0.115 (0.099) loss_x loss_x 0.7095 (0.6479) acc_x 87.5000 (85.0000) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/19] time 0.175 (0.176) data 0.099 (0.100) loss_x loss_x 0.4341 (0.5951) acc_x 84.3750 (85.2083) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/30] time 0.196 (0.175) data 0.120 (0.099) loss_u loss_u 0.9268 (0.9132) acc_u 6.2500 (8.7500) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/30] time 0.166 (0.173) data 0.088 (0.097) loss_u loss_u 0.9546 (0.9235) acc_u 6.2500 (7.8125) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [15/30] time 0.185 (0.175) data 0.109 (0.098) loss_u loss_u 0.9614 (0.9270) acc_u 3.1250 (7.5000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/30] time 0.170 (0.176) data 0.094 (0.099) loss_u loss_u 0.9395 (0.9152) acc_u 3.1250 (8.9062) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [25/30] time 0.193 (0.175) data 0.116 (0.099) loss_u loss_u 0.8462 (0.9076) acc_u 18.7500 (10.1250) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [30/30] time 0.182 (0.176) data 0.106 (0.100) loss_u loss_u 0.8843 (0.8999) acc_u 12.5000 (11.0417) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.3994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 639
clean true:632
clean false:7
clean_rate:0.9890453834115805
noisy true:586
noisy false:375
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 961
epoch [35/200] batch [5/19] time 0.194 (0.189) data 0.118 (0.113) loss_x loss_x 0.3176 (0.5001) acc_x 87.5000 (85.0000) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/19] time 0.188 (0.186) data 0.111 (0.110) loss_x loss_x 1.0566 (0.6171) acc_x 81.2500 (82.5000) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/19] time 0.166 (0.184) data 0.089 (0.108) loss_x loss_x 0.6206 (0.5984) acc_x 90.6250 (83.7500) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/30] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.8813 (0.9197) acc_u 12.5000 (9.3750) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/30] time 0.183 (0.179) data 0.107 (0.103) loss_u loss_u 0.8560 (0.9100) acc_u 15.6250 (10.3125) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/30] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.9326 (0.9139) acc_u 6.2500 (9.7917) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/30] time 0.164 (0.180) data 0.087 (0.103) loss_u loss_u 0.8940 (0.9156) acc_u 12.5000 (9.3750) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [25/30] time 0.177 (0.180) data 0.100 (0.103) loss_u loss_u 0.8662 (0.9110) acc_u 15.6250 (10.1250) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [30/30] time 0.175 (0.179) data 0.097 (0.102) loss_u loss_u 0.8662 (0.9065) acc_u 12.5000 (10.5208) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 629
clean true:619
clean false:10
clean_rate:0.9841017488076311
noisy true:575
noisy false:396
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 971
epoch [36/200] batch [5/19] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.5146 (0.5005) acc_x 87.5000 (85.6250) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/19] time 0.187 (0.178) data 0.111 (0.102) loss_x loss_x 0.8755 (0.5320) acc_x 71.8750 (83.7500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/19] time 0.185 (0.181) data 0.109 (0.105) loss_x loss_x 0.6353 (0.5332) acc_x 78.1250 (85.2083) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/30] time 0.167 (0.180) data 0.090 (0.103) loss_u loss_u 0.8745 (0.9044) acc_u 12.5000 (8.7500) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [10/30] time 0.168 (0.179) data 0.092 (0.103) loss_u loss_u 0.8936 (0.9086) acc_u 15.6250 (9.6875) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [15/30] time 0.188 (0.178) data 0.110 (0.101) loss_u loss_u 0.8706 (0.9063) acc_u 15.6250 (10.4167) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [20/30] time 0.192 (0.178) data 0.115 (0.101) loss_u loss_u 0.8130 (0.9003) acc_u 18.7500 (10.9375) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [25/30] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8594 (0.8980) acc_u 15.6250 (11.1250) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [30/30] time 0.188 (0.180) data 0.111 (0.103) loss_u loss_u 0.7593 (0.8879) acc_u 25.0000 (12.1875) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 394
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 649
clean true:643
clean false:6
clean_rate:0.9907550077041603
noisy true:563
noisy false:388
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 951
epoch [37/200] batch [5/20] time 0.180 (0.184) data 0.104 (0.107) loss_x loss_x 0.4290 (0.5293) acc_x 84.3750 (84.3750) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/20] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.4377 (0.5898) acc_x 90.6250 (83.7500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/20] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.2239 (0.5958) acc_x 90.6250 (83.7500) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [20/20] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4077 (0.6131) acc_x 90.6250 (84.0625) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/29] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.9595 (0.9491) acc_u 6.2500 (6.2500) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/29] time 0.188 (0.182) data 0.111 (0.106) loss_u loss_u 0.8794 (0.9280) acc_u 15.6250 (8.7500) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/29] time 0.180 (0.182) data 0.104 (0.106) loss_u loss_u 0.8955 (0.9241) acc_u 12.5000 (9.1667) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/29] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.9043 (0.9182) acc_u 12.5000 (9.3750) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [25/29] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.9048 (0.9133) acc_u 12.5000 (10.1250) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.4000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 640
clean true:632
clean false:8
clean_rate:0.9875
noisy true:559
noisy false:401
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 960
epoch [38/200] batch [5/20] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.7588 (0.6266) acc_x 75.0000 (82.5000) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/20] time 0.182 (0.187) data 0.106 (0.111) loss_x loss_x 0.4412 (0.6323) acc_x 90.6250 (82.8125) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/20] time 0.178 (0.186) data 0.101 (0.109) loss_x loss_x 0.9722 (0.6416) acc_x 78.1250 (82.2917) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [20/20] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.4548 (0.5903) acc_x 84.3750 (83.9062) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/30] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.8936 (0.8862) acc_u 12.5000 (13.1250) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [10/30] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9297 (0.8951) acc_u 6.2500 (11.8750) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/30] time 0.178 (0.183) data 0.102 (0.107) loss_u loss_u 0.9312 (0.8994) acc_u 3.1250 (11.0417) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [20/30] time 0.177 (0.183) data 0.100 (0.106) loss_u loss_u 0.9648 (0.9017) acc_u 3.1250 (11.2500) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [25/30] time 0.190 (0.183) data 0.111 (0.107) loss_u loss_u 0.9102 (0.8996) acc_u 9.3750 (11.3750) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [30/30] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9829 (0.9025) acc_u 0.0000 (11.1458) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.4038, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 646
clean true:643
clean false:3
clean_rate:0.9953560371517027
noisy true:535
noisy false:419
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 954
epoch [39/200] batch [5/20] time 0.177 (0.173) data 0.101 (0.097) loss_x loss_x 1.1719 (0.8268) acc_x 65.6250 (78.7500) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/20] time 0.182 (0.172) data 0.106 (0.095) loss_x loss_x 0.3328 (0.6745) acc_x 93.7500 (84.6875) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/20] time 0.167 (0.172) data 0.091 (0.095) loss_x loss_x 0.6743 (0.6915) acc_x 78.1250 (82.7083) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [20/20] time 0.174 (0.173) data 0.097 (0.097) loss_x loss_x 0.9951 (0.6871) acc_x 71.8750 (82.6562) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/29] time 0.157 (0.173) data 0.080 (0.096) loss_u loss_u 0.9116 (0.9169) acc_u 9.3750 (8.1250) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [10/29] time 0.176 (0.173) data 0.099 (0.096) loss_u loss_u 0.9141 (0.9024) acc_u 9.3750 (10.0000) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [15/29] time 0.186 (0.174) data 0.110 (0.098) loss_u loss_u 0.8945 (0.9060) acc_u 12.5000 (10.2083) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [20/29] time 0.176 (0.175) data 0.100 (0.098) loss_u loss_u 0.8877 (0.9068) acc_u 15.6250 (10.0000) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [25/29] time 0.187 (0.175) data 0.110 (0.099) loss_u loss_u 0.9463 (0.9116) acc_u 9.3750 (9.6250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 636
clean true:624
clean false:12
clean_rate:0.9811320754716981
noisy true:561
noisy false:403
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 964
epoch [40/200] batch [5/19] time 0.181 (0.179) data 0.105 (0.102) loss_x loss_x 0.4570 (0.7541) acc_x 84.3750 (78.1250) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/19] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.8193 (0.7371) acc_x 78.1250 (80.9375) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/19] time 0.187 (0.179) data 0.110 (0.103) loss_x loss_x 0.5347 (0.7171) acc_x 84.3750 (81.0417) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/30] time 0.161 (0.176) data 0.084 (0.100) loss_u loss_u 0.9097 (0.8890) acc_u 9.3750 (12.5000) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/30] time 0.167 (0.175) data 0.089 (0.098) loss_u loss_u 0.9072 (0.8989) acc_u 9.3750 (11.5625) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [15/30] time 0.168 (0.173) data 0.090 (0.096) loss_u loss_u 0.8496 (0.8927) acc_u 18.7500 (11.8750) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [20/30] time 0.176 (0.172) data 0.098 (0.096) loss_u loss_u 0.9219 (0.9035) acc_u 9.3750 (10.6250) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [25/30] time 0.175 (0.172) data 0.099 (0.096) loss_u loss_u 0.9365 (0.9054) acc_u 6.2500 (10.2500) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [30/30] time 0.164 (0.172) data 0.087 (0.096) loss_u loss_u 0.8379 (0.8995) acc_u 21.8750 (11.2500) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.4025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 644
clean true:634
clean false:10
clean_rate:0.984472049689441
noisy true:557
noisy false:399
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 956
epoch [41/200] batch [5/20] time 0.181 (0.178) data 0.105 (0.102) loss_x loss_x 0.3728 (0.4624) acc_x 90.6250 (86.2500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/20] time 0.185 (0.181) data 0.109 (0.105) loss_x loss_x 0.7529 (0.5810) acc_x 81.2500 (84.3750) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/20] time 0.178 (0.182) data 0.102 (0.106) loss_x loss_x 0.6504 (0.5909) acc_x 81.2500 (84.5833) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [20/20] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.2233 (0.5796) acc_x 93.7500 (85.1562) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/29] time 0.168 (0.179) data 0.090 (0.102) loss_u loss_u 0.9990 (0.9294) acc_u 0.0000 (6.8750) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [10/29] time 0.158 (0.177) data 0.082 (0.100) loss_u loss_u 0.9434 (0.9116) acc_u 6.2500 (9.3750) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [15/29] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9243 (0.9146) acc_u 9.3750 (9.1667) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [20/29] time 0.193 (0.180) data 0.112 (0.103) loss_u loss_u 0.9180 (0.9163) acc_u 12.5000 (9.3750) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [25/29] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9404 (0.9123) acc_u 6.2500 (9.8750) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 405
confident_label rate tensor(0.3950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 632
clean true:624
clean false:8
clean_rate:0.9873417721518988
noisy true:571
noisy false:397
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 968
epoch [42/200] batch [5/19] time 0.171 (0.177) data 0.095 (0.100) loss_x loss_x 0.2839 (0.5499) acc_x 93.7500 (83.7500) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/19] time 0.191 (0.183) data 0.113 (0.106) loss_x loss_x 0.3333 (0.5663) acc_x 93.7500 (85.6250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/19] time 0.172 (0.181) data 0.095 (0.104) loss_x loss_x 0.2576 (0.5602) acc_x 93.7500 (85.4167) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/30] time 0.175 (0.178) data 0.099 (0.101) loss_u loss_u 0.8369 (0.8656) acc_u 18.7500 (15.0000) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/30] time 0.165 (0.176) data 0.087 (0.099) loss_u loss_u 0.8872 (0.8892) acc_u 15.6250 (12.5000) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/30] time 0.191 (0.176) data 0.115 (0.099) loss_u loss_u 0.9082 (0.8888) acc_u 12.5000 (12.7083) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/30] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.9199 (0.8942) acc_u 9.3750 (12.3438) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [25/30] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.9038 (0.8963) acc_u 12.5000 (12.0000) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [30/30] time 0.191 (0.178) data 0.114 (0.101) loss_u loss_u 0.9302 (0.8978) acc_u 9.3750 (11.8750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.4025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 644
clean true:632
clean false:12
clean_rate:0.9813664596273292
noisy true:566
noisy false:390
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 956
epoch [43/200] batch [5/20] time 0.188 (0.185) data 0.111 (0.108) loss_x loss_x 0.7847 (0.5993) acc_x 78.1250 (83.7500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/20] time 0.190 (0.187) data 0.113 (0.109) loss_x loss_x 0.8677 (0.6167) acc_x 81.2500 (83.1250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/20] time 0.181 (0.185) data 0.105 (0.107) loss_x loss_x 0.6538 (0.5990) acc_x 78.1250 (84.3750) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [20/20] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.6987 (0.5928) acc_x 75.0000 (84.2188) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/29] time 0.178 (0.184) data 0.101 (0.107) loss_u loss_u 0.9009 (0.9313) acc_u 9.3750 (8.1250) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/29] time 0.178 (0.184) data 0.102 (0.107) loss_u loss_u 0.9561 (0.9148) acc_u 3.1250 (9.3750) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/29] time 0.173 (0.183) data 0.096 (0.106) loss_u loss_u 0.9263 (0.9194) acc_u 6.2500 (9.1667) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [20/29] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9141 (0.9127) acc_u 9.3750 (9.6875) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [25/29] time 0.176 (0.182) data 0.098 (0.105) loss_u loss_u 0.8374 (0.9104) acc_u 18.7500 (9.8750) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:641
clean false:12
clean_rate:0.9816232771822359
noisy true:569
noisy false:378
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [44/200] batch [5/20] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.4836 (0.6613) acc_x 84.3750 (82.5000) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/20] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.4666 (0.5202) acc_x 87.5000 (86.2500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/20] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.7593 (0.5249) acc_x 81.2500 (85.6250) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [20/20] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.4604 (0.5142) acc_x 84.3750 (86.0938) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/29] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.9028 (0.9011) acc_u 9.3750 (12.5000) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [10/29] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9365 (0.9030) acc_u 9.3750 (12.5000) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [15/29] time 0.178 (0.176) data 0.101 (0.100) loss_u loss_u 0.9937 (0.9160) acc_u 0.0000 (10.4167) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [20/29] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.9819 (0.9201) acc_u 3.1250 (9.6875) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [25/29] time 0.175 (0.176) data 0.098 (0.099) loss_u loss_u 0.9155 (0.9209) acc_u 12.5000 (9.5000) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 394
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:631
clean false:12
clean_rate:0.9813374805598756
noisy true:575
noisy false:382
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [45/200] batch [5/20] time 0.177 (0.172) data 0.101 (0.096) loss_x loss_x 0.6587 (0.5926) acc_x 81.2500 (83.7500) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/20] time 0.176 (0.177) data 0.100 (0.101) loss_x loss_x 0.4622 (0.6255) acc_x 87.5000 (82.1875) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/20] time 0.181 (0.180) data 0.105 (0.104) loss_x loss_x 0.7959 (0.6814) acc_x 78.1250 (80.8333) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [20/20] time 0.180 (0.180) data 0.104 (0.104) loss_x loss_x 0.7886 (0.6538) acc_x 78.1250 (81.4062) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/29] time 0.177 (0.181) data 0.101 (0.104) loss_u loss_u 0.8628 (0.8806) acc_u 15.6250 (13.1250) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/29] time 0.177 (0.180) data 0.100 (0.103) loss_u loss_u 0.8901 (0.8951) acc_u 12.5000 (11.5625) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [15/29] time 0.164 (0.178) data 0.087 (0.102) loss_u loss_u 0.9121 (0.8954) acc_u 9.3750 (11.6667) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/29] time 0.160 (0.177) data 0.084 (0.100) loss_u loss_u 0.9058 (0.9032) acc_u 9.3750 (10.7812) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [25/29] time 0.176 (0.176) data 0.099 (0.100) loss_u loss_u 0.9126 (0.9012) acc_u 12.5000 (11.1250) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:655
clean false:11
clean_rate:0.9834834834834835
noisy true:586
noisy false:348
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [46/200] batch [5/20] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.3115 (0.4327) acc_x 90.6250 (86.2500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/20] time 0.169 (0.179) data 0.092 (0.103) loss_x loss_x 0.3557 (0.4364) acc_x 90.6250 (87.8125) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/20] time 0.180 (0.175) data 0.104 (0.099) loss_x loss_x 0.4746 (0.4678) acc_x 78.1250 (87.2917) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [20/20] time 0.189 (0.178) data 0.112 (0.101) loss_x loss_x 0.8086 (0.5116) acc_x 78.1250 (85.9375) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/29] time 0.177 (0.178) data 0.101 (0.102) loss_u loss_u 0.9199 (0.8654) acc_u 6.2500 (14.3750) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [10/29] time 0.161 (0.177) data 0.084 (0.101) loss_u loss_u 0.8906 (0.8852) acc_u 12.5000 (12.1875) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/29] time 0.160 (0.175) data 0.082 (0.099) loss_u loss_u 0.9121 (0.8914) acc_u 12.5000 (12.0833) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/29] time 0.158 (0.174) data 0.082 (0.097) loss_u loss_u 0.9971 (0.9105) acc_u 0.0000 (10.0000) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [25/29] time 0.160 (0.173) data 0.084 (0.096) loss_u loss_u 0.9482 (0.9118) acc_u 6.2500 (9.6250) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.4031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 645
clean true:632
clean false:13
clean_rate:0.9798449612403101
noisy true:551
noisy false:404
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 955
epoch [47/200] batch [5/20] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.5640 (0.5163) acc_x 87.5000 (87.5000) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/20] time 0.188 (0.181) data 0.111 (0.104) loss_x loss_x 0.4053 (0.5966) acc_x 84.3750 (83.7500) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/20] time 0.183 (0.180) data 0.107 (0.104) loss_x loss_x 0.6709 (0.5903) acc_x 78.1250 (83.1250) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [20/20] time 0.166 (0.177) data 0.088 (0.100) loss_x loss_x 0.3491 (0.5664) acc_x 93.7500 (84.2188) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/29] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.8960 (0.8966) acc_u 12.5000 (11.8750) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [10/29] time 0.171 (0.176) data 0.095 (0.099) loss_u loss_u 0.8535 (0.9056) acc_u 15.6250 (10.3125) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/29] time 0.180 (0.176) data 0.102 (0.099) loss_u loss_u 0.8364 (0.8964) acc_u 21.8750 (11.6667) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/29] time 0.193 (0.176) data 0.116 (0.099) loss_u loss_u 0.8657 (0.9023) acc_u 18.7500 (11.0938) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [25/29] time 0.192 (0.176) data 0.115 (0.100) loss_u loss_u 0.9194 (0.9027) acc_u 12.5000 (11.5000) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:640
clean false:13
clean_rate:0.9800918836140888
noisy true:568
noisy false:379
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [48/200] batch [5/20] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.4807 (0.5785) acc_x 81.2500 (81.8750) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/20] time 0.177 (0.177) data 0.100 (0.101) loss_x loss_x 0.7280 (0.6609) acc_x 81.2500 (80.3125) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/20] time 0.186 (0.177) data 0.109 (0.101) loss_x loss_x 0.5474 (0.6038) acc_x 84.3750 (82.5000) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [20/20] time 0.172 (0.177) data 0.095 (0.101) loss_x loss_x 0.7158 (0.6294) acc_x 81.2500 (82.1875) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/29] time 0.186 (0.178) data 0.110 (0.101) loss_u loss_u 0.9189 (0.9184) acc_u 9.3750 (8.7500) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/29] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.8335 (0.9094) acc_u 15.6250 (9.6875) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/29] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9814 (0.9043) acc_u 0.0000 (10.2083) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/29] time 0.165 (0.180) data 0.088 (0.103) loss_u loss_u 0.9248 (0.9020) acc_u 12.5000 (11.0938) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [25/29] time 0.169 (0.180) data 0.093 (0.103) loss_u loss_u 0.8872 (0.8953) acc_u 12.5000 (11.8750) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:636
clean false:11
clean_rate:0.9829984544049459
noisy true:578
noisy false:375
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [49/200] batch [5/20] time 0.165 (0.168) data 0.088 (0.092) loss_x loss_x 0.4702 (0.6145) acc_x 84.3750 (81.2500) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/20] time 0.177 (0.172) data 0.100 (0.096) loss_x loss_x 0.5244 (0.6538) acc_x 87.5000 (81.5625) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/20] time 0.188 (0.174) data 0.112 (0.097) loss_x loss_x 1.0684 (0.6577) acc_x 78.1250 (82.2917) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [20/20] time 0.172 (0.172) data 0.095 (0.095) loss_x loss_x 0.8569 (0.6445) acc_x 68.7500 (82.6562) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/29] time 0.173 (0.172) data 0.096 (0.096) loss_u loss_u 0.7866 (0.8535) acc_u 21.8750 (15.6250) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [10/29] time 0.170 (0.172) data 0.094 (0.096) loss_u loss_u 0.9575 (0.8930) acc_u 3.1250 (10.9375) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [15/29] time 0.177 (0.173) data 0.099 (0.097) loss_u loss_u 0.9268 (0.9063) acc_u 3.1250 (9.5833) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [20/29] time 0.173 (0.173) data 0.096 (0.096) loss_u loss_u 0.8882 (0.9048) acc_u 12.5000 (10.0000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [25/29] time 0.175 (0.173) data 0.099 (0.096) loss_u loss_u 0.9722 (0.9063) acc_u 3.1250 (10.1250) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 396
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:642
clean false:12
clean_rate:0.981651376146789
noisy true:562
noisy false:384
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [50/200] batch [5/20] time 0.174 (0.182) data 0.098 (0.105) loss_x loss_x 0.4448 (0.6212) acc_x 87.5000 (81.2500) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/20] time 0.186 (0.179) data 0.110 (0.103) loss_x loss_x 0.4204 (0.5815) acc_x 87.5000 (83.7500) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/20] time 0.178 (0.176) data 0.101 (0.100) loss_x loss_x 0.6597 (0.5851) acc_x 78.1250 (82.9167) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [20/20] time 0.159 (0.174) data 0.083 (0.098) loss_x loss_x 0.8569 (0.5911) acc_x 78.1250 (83.2812) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/29] time 0.177 (0.173) data 0.101 (0.097) loss_u loss_u 0.8228 (0.8672) acc_u 15.6250 (15.0000) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [10/29] time 0.179 (0.174) data 0.103 (0.097) loss_u loss_u 0.9937 (0.8794) acc_u 3.1250 (14.6875) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/29] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.9111 (0.8808) acc_u 9.3750 (14.3750) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [20/29] time 0.176 (0.175) data 0.100 (0.099) loss_u loss_u 0.8994 (0.8888) acc_u 9.3750 (12.9688) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [25/29] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.9517 (0.8916) acc_u 6.2500 (12.5000) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:650
clean false:12
clean_rate:0.9818731117824774
noisy true:574
noisy false:364
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [51/200] batch [5/20] time 0.165 (0.167) data 0.088 (0.090) loss_x loss_x 0.8379 (0.7136) acc_x 78.1250 (81.8750) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/20] time 0.175 (0.169) data 0.099 (0.092) loss_x loss_x 0.8799 (0.7271) acc_x 71.8750 (81.2500) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/20] time 0.187 (0.173) data 0.111 (0.096) loss_x loss_x 0.5205 (0.6616) acc_x 81.2500 (82.5000) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [20/20] time 0.180 (0.175) data 0.104 (0.098) loss_x loss_x 0.6216 (0.6595) acc_x 78.1250 (82.6562) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/29] time 0.181 (0.176) data 0.104 (0.100) loss_u loss_u 0.9438 (0.9226) acc_u 6.2500 (7.5000) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/29] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.9160 (0.9240) acc_u 9.3750 (8.1250) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [15/29] time 0.183 (0.178) data 0.106 (0.102) loss_u loss_u 0.9521 (0.9227) acc_u 6.2500 (8.3333) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [20/29] time 0.161 (0.178) data 0.084 (0.102) loss_u loss_u 0.9824 (0.9212) acc_u 3.1250 (8.4375) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [25/29] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.9839 (0.9164) acc_u 0.0000 (9.0000) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.4000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 640
clean true:631
clean false:9
clean_rate:0.9859375
noisy true:572
noisy false:388
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 960
epoch [52/200] batch [5/20] time 0.170 (0.176) data 0.094 (0.100) loss_x loss_x 1.1270 (0.6237) acc_x 62.5000 (80.6250) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/20] time 0.171 (0.174) data 0.095 (0.097) loss_x loss_x 0.8418 (0.6425) acc_x 81.2500 (81.5625) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/20] time 0.165 (0.172) data 0.089 (0.095) loss_x loss_x 0.3506 (0.5560) acc_x 87.5000 (83.7500) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [20/20] time 0.182 (0.173) data 0.106 (0.096) loss_x loss_x 0.7397 (0.5879) acc_x 78.1250 (82.9688) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/30] time 0.162 (0.172) data 0.085 (0.095) loss_u loss_u 0.9233 (0.8935) acc_u 12.5000 (12.5000) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/30] time 0.160 (0.170) data 0.083 (0.093) loss_u loss_u 0.8848 (0.8929) acc_u 12.5000 (12.5000) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/30] time 0.169 (0.169) data 0.091 (0.093) loss_u loss_u 0.9082 (0.8986) acc_u 12.5000 (11.6667) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [20/30] time 0.189 (0.169) data 0.109 (0.092) loss_u loss_u 0.9819 (0.9061) acc_u 3.1250 (10.9375) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [25/30] time 0.183 (0.171) data 0.105 (0.094) loss_u loss_u 0.8638 (0.9035) acc_u 15.6250 (11.1250) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [30/30] time 0.171 (0.171) data 0.095 (0.095) loss_u loss_u 0.8677 (0.9044) acc_u 15.6250 (10.9375) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.4144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 663
clean true:650
clean false:13
clean_rate:0.9803921568627451
noisy true:582
noisy false:355
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 937
epoch [53/200] batch [5/20] time 0.171 (0.178) data 0.094 (0.101) loss_x loss_x 0.5190 (0.5649) acc_x 90.6250 (84.3750) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/20] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 0.7480 (0.5703) acc_x 78.1250 (83.4375) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/20] time 0.186 (0.180) data 0.110 (0.103) loss_x loss_x 0.6626 (0.6206) acc_x 78.1250 (82.2917) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [20/20] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.6899 (0.6162) acc_x 75.0000 (81.8750) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/29] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.9688 (0.9037) acc_u 3.1250 (10.0000) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/29] time 0.182 (0.182) data 0.103 (0.105) loss_u loss_u 0.9229 (0.9104) acc_u 6.2500 (9.3750) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/29] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8765 (0.9036) acc_u 15.6250 (10.4167) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [20/29] time 0.164 (0.182) data 0.086 (0.105) loss_u loss_u 0.9170 (0.9083) acc_u 9.3750 (10.1562) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [25/29] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.9370 (0.9060) acc_u 6.2500 (10.3750) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 656
clean true:646
clean false:10
clean_rate:0.9847560975609756
noisy true:577
noisy false:367
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 944
epoch [54/200] batch [5/20] time 0.182 (0.184) data 0.107 (0.108) loss_x loss_x 0.4075 (0.5533) acc_x 90.6250 (87.5000) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/20] time 0.167 (0.178) data 0.091 (0.102) loss_x loss_x 0.7803 (0.6358) acc_x 84.3750 (85.3125) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/20] time 0.158 (0.173) data 0.081 (0.096) loss_x loss_x 0.6914 (0.5733) acc_x 78.1250 (85.6250) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [20/20] time 0.183 (0.174) data 0.106 (0.098) loss_x loss_x 0.4998 (0.5986) acc_x 90.6250 (85.1562) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/29] time 0.161 (0.176) data 0.084 (0.100) loss_u loss_u 0.9785 (0.9222) acc_u 3.1250 (8.7500) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/29] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.9307 (0.9192) acc_u 6.2500 (8.7500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/29] time 0.181 (0.179) data 0.105 (0.102) loss_u loss_u 0.8945 (0.9118) acc_u 9.3750 (9.3750) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/29] time 0.168 (0.179) data 0.092 (0.102) loss_u loss_u 0.9180 (0.9050) acc_u 6.2500 (10.1562) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [25/29] time 0.171 (0.178) data 0.094 (0.101) loss_u loss_u 0.8984 (0.8931) acc_u 9.3750 (11.6250) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.4356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 697
clean true:684
clean false:13
clean_rate:0.9813486370157819
noisy true:559
noisy false:344
after delete: len(clean_dataset) 697
after delete: len(noisy_dataset) 903
epoch [55/200] batch [5/21] time 0.193 (0.184) data 0.116 (0.108) loss_x loss_x 0.1930 (0.6537) acc_x 93.7500 (81.8750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/21] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.3528 (0.5782) acc_x 87.5000 (82.8125) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/21] time 0.178 (0.183) data 0.102 (0.106) loss_x loss_x 0.5342 (0.5455) acc_x 84.3750 (84.5833) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [20/21] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.6582 (0.5827) acc_x 78.1250 (83.5938) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/28] time 0.158 (0.180) data 0.081 (0.103) loss_u loss_u 0.9912 (0.9477) acc_u 0.0000 (5.6250) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [10/28] time 0.166 (0.177) data 0.089 (0.101) loss_u loss_u 0.8472 (0.9262) acc_u 15.6250 (8.1250) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/28] time 0.181 (0.176) data 0.104 (0.100) loss_u loss_u 0.9365 (0.9335) acc_u 6.2500 (7.0833) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/28] time 0.179 (0.177) data 0.102 (0.100) loss_u loss_u 0.9424 (0.9308) acc_u 6.2500 (7.5000) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [25/28] time 0.178 (0.177) data 0.100 (0.100) loss_u loss_u 0.9482 (0.9255) acc_u 9.3750 (8.5000) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.4175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 668
clean true:654
clean false:14
clean_rate:0.9790419161676647
noisy true:568
noisy false:364
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 932
epoch [56/200] batch [5/20] time 0.172 (0.176) data 0.096 (0.100) loss_x loss_x 0.4600 (0.6345) acc_x 81.2500 (80.0000) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/20] time 0.177 (0.173) data 0.100 (0.097) loss_x loss_x 1.0225 (0.6555) acc_x 81.2500 (81.5625) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/20] time 0.169 (0.172) data 0.092 (0.096) loss_x loss_x 0.7603 (0.6846) acc_x 81.2500 (81.8750) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [20/20] time 0.159 (0.170) data 0.083 (0.093) loss_x loss_x 0.5254 (0.6354) acc_x 84.3750 (82.9688) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/29] time 0.170 (0.170) data 0.094 (0.094) loss_u loss_u 0.9062 (0.9015) acc_u 12.5000 (11.8750) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [10/29] time 0.179 (0.171) data 0.102 (0.095) loss_u loss_u 0.9155 (0.9140) acc_u 12.5000 (10.0000) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [15/29] time 0.182 (0.173) data 0.105 (0.096) loss_u loss_u 0.8804 (0.9087) acc_u 12.5000 (10.4167) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/29] time 0.181 (0.174) data 0.104 (0.098) loss_u loss_u 0.8550 (0.9036) acc_u 15.6250 (10.9375) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [25/29] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.9121 (0.9073) acc_u 9.3750 (10.3750) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.4100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 656
clean true:642
clean false:14
clean_rate:0.9786585365853658
noisy true:552
noisy false:392
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 944
epoch [57/200] batch [5/20] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 0.4390 (0.6442) acc_x 84.3750 (80.6250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/20] time 0.159 (0.176) data 0.083 (0.100) loss_x loss_x 0.3242 (0.5802) acc_x 90.6250 (82.1875) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/20] time 0.168 (0.173) data 0.092 (0.097) loss_x loss_x 0.2905 (0.6083) acc_x 93.7500 (82.9167) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [20/20] time 0.172 (0.172) data 0.096 (0.095) loss_x loss_x 0.4966 (0.6525) acc_x 84.3750 (81.4062) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/29] time 0.165 (0.171) data 0.089 (0.095) loss_u loss_u 0.9648 (0.9105) acc_u 3.1250 (10.6250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/29] time 0.183 (0.171) data 0.104 (0.094) loss_u loss_u 0.9526 (0.9204) acc_u 6.2500 (9.6875) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/29] time 0.203 (0.172) data 0.126 (0.096) loss_u loss_u 0.9009 (0.9109) acc_u 12.5000 (11.0417) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [20/29] time 0.164 (0.173) data 0.087 (0.096) loss_u loss_u 0.8262 (0.9104) acc_u 18.7500 (10.7812) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [25/29] time 0.180 (0.173) data 0.103 (0.096) loss_u loss_u 0.9360 (0.9123) acc_u 6.2500 (10.5000) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 672
clean true:660
clean false:12
clean_rate:0.9821428571428571
noisy true:557
noisy false:371
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 928
epoch [58/200] batch [5/21] time 0.176 (0.179) data 0.100 (0.103) loss_x loss_x 0.4729 (0.5744) acc_x 87.5000 (87.5000) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/21] time 0.185 (0.176) data 0.109 (0.100) loss_x loss_x 0.5317 (0.6289) acc_x 87.5000 (85.6250) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/21] time 0.161 (0.174) data 0.085 (0.097) loss_x loss_x 0.4158 (0.6355) acc_x 87.5000 (85.8333) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/21] time 0.174 (0.172) data 0.098 (0.096) loss_x loss_x 0.3303 (0.6016) acc_x 93.7500 (86.2500) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/29] time 0.173 (0.173) data 0.096 (0.097) loss_u loss_u 0.8413 (0.8756) acc_u 15.6250 (13.7500) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/29] time 0.181 (0.175) data 0.103 (0.098) loss_u loss_u 0.8818 (0.8833) acc_u 12.5000 (13.1250) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/29] time 0.180 (0.175) data 0.103 (0.099) loss_u loss_u 0.9492 (0.8991) acc_u 6.2500 (11.2500) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [20/29] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.9214 (0.9030) acc_u 6.2500 (10.7812) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [25/29] time 0.180 (0.177) data 0.102 (0.100) loss_u loss_u 0.9258 (0.9017) acc_u 6.2500 (10.8750) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.4119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 659
clean true:648
clean false:11
clean_rate:0.9833080424886191
noisy true:560
noisy false:381
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 941
epoch [59/200] batch [5/20] time 0.181 (0.180) data 0.105 (0.104) loss_x loss_x 0.5928 (0.6079) acc_x 87.5000 (81.8750) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/20] time 0.171 (0.174) data 0.093 (0.097) loss_x loss_x 0.4185 (0.6137) acc_x 84.3750 (81.5625) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/20] time 0.167 (0.172) data 0.090 (0.095) loss_x loss_x 1.2158 (0.5911) acc_x 68.7500 (83.1250) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [20/20] time 0.182 (0.172) data 0.105 (0.095) loss_x loss_x 0.6914 (0.5816) acc_x 81.2500 (83.1250) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/29] time 0.188 (0.174) data 0.112 (0.097) loss_u loss_u 0.8267 (0.9050) acc_u 18.7500 (11.2500) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [10/29] time 0.160 (0.174) data 0.083 (0.097) loss_u loss_u 0.8892 (0.8948) acc_u 12.5000 (12.1875) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/29] time 0.169 (0.173) data 0.091 (0.096) loss_u loss_u 0.9082 (0.8912) acc_u 9.3750 (12.7083) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [20/29] time 0.159 (0.172) data 0.081 (0.095) loss_u loss_u 0.9233 (0.8997) acc_u 9.3750 (11.5625) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [25/29] time 0.162 (0.171) data 0.085 (0.094) loss_u loss_u 0.9165 (0.9042) acc_u 12.5000 (11.2500) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.4206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 673
clean true:661
clean false:12
clean_rate:0.9821693907875185
noisy true:575
noisy false:352
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 927
epoch [60/200] batch [5/21] time 0.191 (0.187) data 0.113 (0.110) loss_x loss_x 0.5024 (0.5034) acc_x 87.5000 (90.0000) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/21] time 0.208 (0.190) data 0.131 (0.114) loss_x loss_x 0.7095 (0.6135) acc_x 78.1250 (86.5625) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/21] time 0.186 (0.186) data 0.110 (0.110) loss_x loss_x 0.9756 (0.5869) acc_x 78.1250 (86.2500) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/21] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.3972 (0.5521) acc_x 90.6250 (86.2500) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/28] time 0.160 (0.180) data 0.083 (0.104) loss_u loss_u 0.9639 (0.9130) acc_u 6.2500 (10.0000) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/28] time 0.182 (0.180) data 0.105 (0.104) loss_u loss_u 0.9385 (0.9013) acc_u 9.3750 (10.9375) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/28] time 0.185 (0.181) data 0.109 (0.104) loss_u loss_u 0.8999 (0.9001) acc_u 12.5000 (11.0417) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/28] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9331 (0.9032) acc_u 9.3750 (10.9375) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [25/28] time 0.181 (0.181) data 0.105 (0.104) loss_u loss_u 0.8555 (0.9061) acc_u 15.6250 (10.6250) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.4025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 644
clean true:627
clean false:17
clean_rate:0.9736024844720497
noisy true:553
noisy false:403
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 956
epoch [61/200] batch [5/20] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 1.0059 (0.5134) acc_x 78.1250 (88.1250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/20] time 0.184 (0.185) data 0.107 (0.109) loss_x loss_x 0.5112 (0.5450) acc_x 81.2500 (84.0625) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/20] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.4731 (0.5483) acc_x 90.6250 (84.3750) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [20/20] time 0.188 (0.185) data 0.112 (0.108) loss_x loss_x 0.4370 (0.5310) acc_x 90.6250 (84.8438) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/29] time 0.180 (0.185) data 0.103 (0.108) loss_u loss_u 0.9072 (0.9295) acc_u 9.3750 (8.7500) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/29] time 0.182 (0.184) data 0.105 (0.108) loss_u loss_u 0.8633 (0.8983) acc_u 15.6250 (11.8750) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/29] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9155 (0.8938) acc_u 9.3750 (11.8750) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/29] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8247 (0.8823) acc_u 21.8750 (13.1250) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [25/29] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9458 (0.8892) acc_u 9.3750 (12.6250) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.4225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 676
clean true:664
clean false:12
clean_rate:0.9822485207100592
noisy true:564
noisy false:360
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 924
epoch [62/200] batch [5/21] time 0.173 (0.165) data 0.095 (0.088) loss_x loss_x 0.8599 (0.6198) acc_x 81.2500 (84.3750) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/21] time 0.181 (0.171) data 0.105 (0.094) loss_x loss_x 0.6045 (0.5724) acc_x 81.2500 (83.7500) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/21] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.6128 (0.5605) acc_x 84.3750 (84.3750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/21] time 0.184 (0.177) data 0.108 (0.100) loss_x loss_x 0.4592 (0.5454) acc_x 87.5000 (85.1562) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/28] time 0.180 (0.178) data 0.101 (0.101) loss_u loss_u 0.8438 (0.9063) acc_u 18.7500 (10.0000) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [10/28] time 0.196 (0.181) data 0.118 (0.104) loss_u loss_u 0.9019 (0.9147) acc_u 12.5000 (8.7500) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/28] time 0.191 (0.184) data 0.113 (0.106) loss_u loss_u 0.8276 (0.8986) acc_u 15.6250 (10.6250) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/28] time 0.188 (0.184) data 0.110 (0.106) loss_u loss_u 0.9951 (0.9120) acc_u 0.0000 (9.5312) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [25/28] time 0.187 (0.184) data 0.110 (0.107) loss_u loss_u 0.9761 (0.9165) acc_u 3.1250 (9.1250) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 658
clean true:642
clean false:16
clean_rate:0.9756838905775076
noisy true:547
noisy false:395
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 942
epoch [63/200] batch [5/20] time 0.173 (0.169) data 0.096 (0.093) loss_x loss_x 0.4443 (0.5347) acc_x 84.3750 (85.6250) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/20] time 0.188 (0.174) data 0.112 (0.097) loss_x loss_x 0.7881 (0.5732) acc_x 84.3750 (85.6250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/20] time 0.160 (0.174) data 0.084 (0.098) loss_x loss_x 0.7739 (0.5547) acc_x 78.1250 (86.2500) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [20/20] time 0.173 (0.175) data 0.097 (0.098) loss_x loss_x 0.4873 (0.5472) acc_x 84.3750 (85.9375) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/29] time 0.177 (0.175) data 0.101 (0.099) loss_u loss_u 0.8574 (0.8826) acc_u 15.6250 (14.3750) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [10/29] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.8999 (0.8911) acc_u 12.5000 (13.4375) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/29] time 0.190 (0.177) data 0.114 (0.100) loss_u loss_u 0.9395 (0.9034) acc_u 6.2500 (11.6667) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/29] time 0.185 (0.177) data 0.107 (0.101) loss_u loss_u 0.9629 (0.9036) acc_u 3.1250 (11.7188) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/29] time 0.181 (0.178) data 0.102 (0.102) loss_u loss_u 0.8955 (0.9037) acc_u 9.3750 (11.5000) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 664
clean true:648
clean false:16
clean_rate:0.9759036144578314
noisy true:552
noisy false:384
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 936
epoch [64/200] batch [5/20] time 0.171 (0.174) data 0.094 (0.098) loss_x loss_x 0.9268 (0.7157) acc_x 71.8750 (82.5000) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/20] time 0.189 (0.174) data 0.113 (0.097) loss_x loss_x 0.4275 (0.6125) acc_x 84.3750 (83.7500) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/20] time 0.181 (0.173) data 0.104 (0.096) loss_x loss_x 0.7656 (0.5933) acc_x 75.0000 (84.3750) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [20/20] time 0.172 (0.171) data 0.096 (0.094) loss_x loss_x 0.2537 (0.6225) acc_x 90.6250 (83.7500) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/29] time 0.176 (0.170) data 0.099 (0.093) loss_u loss_u 0.9482 (0.9106) acc_u 3.1250 (9.3750) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/29] time 0.179 (0.172) data 0.103 (0.095) loss_u loss_u 0.8335 (0.8990) acc_u 15.6250 (11.2500) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/29] time 0.174 (0.172) data 0.097 (0.095) loss_u loss_u 0.9175 (0.8983) acc_u 9.3750 (10.8333) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/29] time 0.175 (0.172) data 0.098 (0.095) loss_u loss_u 0.8882 (0.8981) acc_u 9.3750 (10.7812) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [25/29] time 0.187 (0.173) data 0.111 (0.096) loss_u loss_u 0.9229 (0.8947) acc_u 9.3750 (11.3750) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:648
clean false:14
clean_rate:0.9788519637462235
noisy true:551
noisy false:387
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [65/200] batch [5/20] time 0.169 (0.178) data 0.093 (0.101) loss_x loss_x 0.8267 (0.8268) acc_x 81.2500 (81.8750) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/20] time 0.180 (0.176) data 0.104 (0.100) loss_x loss_x 0.3782 (0.6383) acc_x 90.6250 (84.3750) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/20] time 0.163 (0.174) data 0.086 (0.097) loss_x loss_x 1.0762 (0.6288) acc_x 75.0000 (84.3750) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [20/20] time 0.181 (0.172) data 0.104 (0.095) loss_x loss_x 0.8447 (0.6208) acc_x 84.3750 (84.5312) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/29] time 0.181 (0.174) data 0.104 (0.097) loss_u loss_u 0.9160 (0.8849) acc_u 9.3750 (13.7500) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [10/29] time 0.178 (0.175) data 0.101 (0.098) loss_u loss_u 0.8774 (0.8905) acc_u 15.6250 (13.4375) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/29] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.9150 (0.8994) acc_u 9.3750 (12.2917) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [20/29] time 0.186 (0.175) data 0.109 (0.099) loss_u loss_u 0.8857 (0.9040) acc_u 15.6250 (11.4062) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [25/29] time 0.185 (0.176) data 0.108 (0.100) loss_u loss_u 0.8457 (0.9017) acc_u 15.6250 (11.3750) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 681
clean true:666
clean false:15
clean_rate:0.9779735682819384
noisy true:552
noisy false:367
after delete: len(clean_dataset) 681
after delete: len(noisy_dataset) 919
epoch [66/200] batch [5/21] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.3462 (0.4693) acc_x 87.5000 (84.3750) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/21] time 0.173 (0.179) data 0.097 (0.103) loss_x loss_x 0.9893 (0.5128) acc_x 65.6250 (82.8125) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/21] time 0.186 (0.177) data 0.110 (0.101) loss_x loss_x 0.7310 (0.5961) acc_x 71.8750 (81.8750) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/21] time 0.159 (0.176) data 0.083 (0.099) loss_x loss_x 0.6543 (0.5857) acc_x 87.5000 (82.5000) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/28] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.8745 (0.9192) acc_u 12.5000 (8.7500) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [10/28] time 0.185 (0.174) data 0.107 (0.097) loss_u loss_u 0.9023 (0.9159) acc_u 12.5000 (9.0625) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/28] time 0.173 (0.174) data 0.096 (0.098) loss_u loss_u 0.8325 (0.9052) acc_u 15.6250 (10.2083) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/28] time 0.168 (0.174) data 0.092 (0.097) loss_u loss_u 0.8511 (0.8993) acc_u 15.6250 (10.6250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [25/28] time 0.176 (0.173) data 0.098 (0.097) loss_u loss_u 0.8833 (0.9016) acc_u 12.5000 (10.5000) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 657
clean true:647
clean false:10
clean_rate:0.984779299847793
noisy true:576
noisy false:367
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 943
epoch [67/200] batch [5/20] time 0.159 (0.166) data 0.083 (0.089) loss_x loss_x 0.9414 (0.5518) acc_x 84.3750 (86.2500) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/20] time 0.184 (0.170) data 0.108 (0.093) loss_x loss_x 0.4937 (0.5017) acc_x 87.5000 (86.2500) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/20] time 0.184 (0.174) data 0.108 (0.098) loss_x loss_x 0.4634 (0.5192) acc_x 87.5000 (86.6667) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [20/20] time 0.158 (0.172) data 0.081 (0.095) loss_x loss_x 0.3630 (0.4783) acc_x 90.6250 (87.6562) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/29] time 0.164 (0.169) data 0.087 (0.093) loss_u loss_u 0.8516 (0.8949) acc_u 15.6250 (11.8750) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/29] time 0.163 (0.168) data 0.087 (0.091) loss_u loss_u 0.9521 (0.8965) acc_u 3.1250 (11.5625) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/29] time 0.162 (0.169) data 0.085 (0.092) loss_u loss_u 0.8472 (0.8968) acc_u 21.8750 (11.4583) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/29] time 0.159 (0.168) data 0.083 (0.091) loss_u loss_u 0.8135 (0.8961) acc_u 18.7500 (11.0938) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [25/29] time 0.171 (0.168) data 0.094 (0.091) loss_u loss_u 0.9316 (0.8954) acc_u 6.2500 (11.5000) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:651
clean false:15
clean_rate:0.9774774774774775
noisy true:569
noisy false:365
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [68/200] batch [5/20] time 0.162 (0.171) data 0.085 (0.094) loss_x loss_x 0.5659 (0.6128) acc_x 90.6250 (85.0000) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [10/20] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.4517 (0.5481) acc_x 87.5000 (86.8750) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [15/20] time 0.186 (0.176) data 0.110 (0.100) loss_x loss_x 0.7266 (0.5273) acc_x 87.5000 (87.5000) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [20/20] time 0.182 (0.176) data 0.105 (0.100) loss_x loss_x 0.4849 (0.5208) acc_x 87.5000 (87.3438) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/29] time 0.188 (0.178) data 0.111 (0.101) loss_u loss_u 0.9546 (0.8761) acc_u 6.2500 (15.0000) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [10/29] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.9248 (0.8960) acc_u 6.2500 (11.2500) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/29] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.9062 (0.8968) acc_u 9.3750 (10.8333) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/29] time 0.183 (0.180) data 0.105 (0.104) loss_u loss_u 0.9438 (0.9022) acc_u 6.2500 (10.3125) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [25/29] time 0.188 (0.181) data 0.111 (0.105) loss_u loss_u 0.8794 (0.8979) acc_u 12.5000 (11.0000) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.4244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 679
clean true:662
clean false:17
clean_rate:0.9749631811487481
noisy true:541
noisy false:380
after delete: len(clean_dataset) 679
after delete: len(noisy_dataset) 921
epoch [69/200] batch [5/21] time 0.176 (0.171) data 0.099 (0.095) loss_x loss_x 0.5625 (0.5001) acc_x 84.3750 (87.5000) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/21] time 0.168 (0.173) data 0.091 (0.096) loss_x loss_x 0.6406 (0.5516) acc_x 87.5000 (86.5625) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/21] time 0.173 (0.174) data 0.097 (0.097) loss_x loss_x 0.3354 (0.4972) acc_x 93.7500 (87.7083) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/21] time 0.182 (0.174) data 0.105 (0.098) loss_x loss_x 0.6001 (0.5412) acc_x 78.1250 (86.0938) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/28] time 0.191 (0.175) data 0.114 (0.098) loss_u loss_u 0.9380 (0.9033) acc_u 9.3750 (11.2500) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/28] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9272 (0.8978) acc_u 6.2500 (10.9375) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/28] time 0.180 (0.177) data 0.104 (0.101) loss_u loss_u 0.9263 (0.9053) acc_u 9.3750 (10.4167) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/28] time 0.182 (0.178) data 0.104 (0.101) loss_u loss_u 0.9385 (0.9111) acc_u 6.2500 (9.6875) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [25/28] time 0.156 (0.177) data 0.079 (0.101) loss_u loss_u 0.9077 (0.9130) acc_u 9.3750 (9.2500) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 396
confident_label rate tensor(0.4244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 679
clean true:665
clean false:14
clean_rate:0.979381443298969
noisy true:539
noisy false:382
after delete: len(clean_dataset) 679
after delete: len(noisy_dataset) 921
epoch [70/200] batch [5/21] time 0.175 (0.182) data 0.098 (0.106) loss_x loss_x 0.3911 (0.5826) acc_x 87.5000 (82.5000) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/21] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.3982 (0.5758) acc_x 87.5000 (84.3750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/21] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.2520 (0.5531) acc_x 96.8750 (85.0000) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/21] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.5225 (0.5654) acc_x 87.5000 (85.1562) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/28] time 0.186 (0.183) data 0.110 (0.107) loss_u loss_u 0.9561 (0.9237) acc_u 6.2500 (8.1250) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [10/28] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.9858 (0.9228) acc_u 0.0000 (8.4375) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/28] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.8193 (0.9068) acc_u 18.7500 (10.4167) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/28] time 0.172 (0.182) data 0.095 (0.106) loss_u loss_u 0.7856 (0.9041) acc_u 21.8750 (11.0938) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [25/28] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.9502 (0.9131) acc_u 6.2500 (10.1250) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.4106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 657
clean true:642
clean false:15
clean_rate:0.9771689497716894
noisy true:545
noisy false:398
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 943
epoch [71/200] batch [5/20] time 0.163 (0.160) data 0.087 (0.084) loss_x loss_x 0.8936 (0.7583) acc_x 81.2500 (84.3750) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/20] time 0.168 (0.164) data 0.091 (0.088) loss_x loss_x 0.9780 (0.6510) acc_x 81.2500 (86.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/20] time 0.164 (0.164) data 0.086 (0.088) loss_x loss_x 0.2932 (0.5599) acc_x 93.7500 (87.7083) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [20/20] time 0.193 (0.167) data 0.116 (0.090) loss_x loss_x 0.6309 (0.5662) acc_x 87.5000 (86.8750) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/29] time 0.160 (0.169) data 0.083 (0.092) loss_u loss_u 0.9688 (0.9226) acc_u 3.1250 (8.7500) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [10/29] time 0.180 (0.170) data 0.104 (0.093) loss_u loss_u 0.9292 (0.9202) acc_u 6.2500 (9.0625) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/29] time 0.183 (0.172) data 0.107 (0.095) loss_u loss_u 0.8369 (0.9135) acc_u 15.6250 (9.5833) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/29] time 0.183 (0.173) data 0.107 (0.097) loss_u loss_u 0.8604 (0.9115) acc_u 15.6250 (9.8438) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [25/29] time 0.182 (0.174) data 0.105 (0.098) loss_u loss_u 0.9722 (0.9068) acc_u 3.1250 (10.5000) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.4194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 671
clean true:657
clean false:14
clean_rate:0.9791356184798807
noisy true:572
noisy false:357
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 929
epoch [72/200] batch [5/20] time 0.181 (0.177) data 0.105 (0.100) loss_x loss_x 0.4458 (0.4503) acc_x 96.8750 (90.0000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/20] time 0.162 (0.181) data 0.085 (0.104) loss_x loss_x 0.1582 (0.5446) acc_x 90.6250 (85.9375) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/20] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.6318 (0.5149) acc_x 84.3750 (86.6667) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [20/20] time 0.180 (0.180) data 0.103 (0.104) loss_x loss_x 0.9536 (0.5358) acc_x 78.1250 (85.9375) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/29] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9541 (0.9232) acc_u 9.3750 (9.3750) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [10/29] time 0.181 (0.181) data 0.104 (0.105) loss_u loss_u 0.9375 (0.9180) acc_u 6.2500 (9.3750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [15/29] time 0.187 (0.182) data 0.109 (0.105) loss_u loss_u 0.9346 (0.9135) acc_u 6.2500 (9.5833) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/29] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8564 (0.9167) acc_u 15.6250 (9.2188) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [25/29] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.9570 (0.9121) acc_u 6.2500 (9.7500) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.4225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 676
clean true:659
clean false:17
clean_rate:0.9748520710059172
noisy true:543
noisy false:381
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 924
epoch [73/200] batch [5/21] time 0.181 (0.175) data 0.105 (0.098) loss_x loss_x 0.5615 (0.4980) acc_x 90.6250 (88.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/21] time 0.175 (0.178) data 0.098 (0.102) loss_x loss_x 0.2742 (0.5318) acc_x 100.0000 (86.5625) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/21] time 0.178 (0.177) data 0.101 (0.100) loss_x loss_x 0.4177 (0.4829) acc_x 81.2500 (86.6667) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [20/21] time 0.160 (0.174) data 0.084 (0.097) loss_x loss_x 0.4163 (0.5046) acc_x 87.5000 (85.4688) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/28] time 0.206 (0.174) data 0.129 (0.098) loss_u loss_u 0.8960 (0.8790) acc_u 9.3750 (11.8750) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [10/28] time 0.175 (0.174) data 0.098 (0.098) loss_u loss_u 0.9092 (0.8969) acc_u 12.5000 (11.2500) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/28] time 0.175 (0.174) data 0.098 (0.098) loss_u loss_u 0.9780 (0.9160) acc_u 3.1250 (9.1667) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/28] time 0.180 (0.175) data 0.103 (0.098) loss_u loss_u 0.8755 (0.9105) acc_u 15.6250 (9.8438) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [25/28] time 0.168 (0.175) data 0.090 (0.098) loss_u loss_u 0.9521 (0.9093) acc_u 3.1250 (9.8750) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.4181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 669
clean true:647
clean false:22
clean_rate:0.9671150971599403
noisy true:563
noisy false:368
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 931
epoch [74/200] batch [5/20] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.6284 (0.5409) acc_x 81.2500 (88.7500) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [10/20] time 0.184 (0.178) data 0.108 (0.101) loss_x loss_x 0.3308 (0.5281) acc_x 93.7500 (87.1875) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/20] time 0.172 (0.174) data 0.095 (0.097) loss_x loss_x 0.9160 (0.5859) acc_x 84.3750 (86.6667) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [20/20] time 0.165 (0.171) data 0.088 (0.095) loss_x loss_x 0.6313 (0.6100) acc_x 87.5000 (85.7812) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/29] time 0.173 (0.171) data 0.096 (0.094) loss_u loss_u 0.9570 (0.9395) acc_u 3.1250 (6.2500) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [10/29] time 0.170 (0.170) data 0.092 (0.093) loss_u loss_u 0.9683 (0.9366) acc_u 3.1250 (7.5000) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/29] time 0.172 (0.171) data 0.095 (0.094) loss_u loss_u 0.8047 (0.9178) acc_u 21.8750 (9.3750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/29] time 0.161 (0.170) data 0.085 (0.093) loss_u loss_u 0.9570 (0.9093) acc_u 3.1250 (10.1562) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [25/29] time 0.172 (0.170) data 0.095 (0.093) loss_u loss_u 0.9297 (0.9081) acc_u 9.3750 (10.3750) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.4187, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 670
clean true:652
clean false:18
clean_rate:0.9731343283582089
noisy true:541
noisy false:389
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 930
epoch [75/200] batch [5/20] time 0.187 (0.184) data 0.111 (0.107) loss_x loss_x 0.6270 (0.6686) acc_x 87.5000 (84.3750) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/20] time 0.176 (0.184) data 0.100 (0.107) loss_x loss_x 0.8813 (0.6329) acc_x 71.8750 (83.7500) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/20] time 0.166 (0.182) data 0.090 (0.106) loss_x loss_x 0.4683 (0.5719) acc_x 81.2500 (85.2083) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [20/20] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.4102 (0.5603) acc_x 84.3750 (85.3125) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/29] time 0.175 (0.177) data 0.098 (0.101) loss_u loss_u 0.8965 (0.9018) acc_u 12.5000 (11.2500) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [10/29] time 0.177 (0.177) data 0.099 (0.100) loss_u loss_u 0.9717 (0.9160) acc_u 0.0000 (9.0625) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/29] time 0.172 (0.179) data 0.096 (0.102) loss_u loss_u 0.9521 (0.9193) acc_u 3.1250 (8.5417) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [20/29] time 0.173 (0.179) data 0.097 (0.103) loss_u loss_u 0.8823 (0.9070) acc_u 15.6250 (10.0000) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [25/29] time 0.194 (0.180) data 0.117 (0.104) loss_u loss_u 0.9106 (0.9097) acc_u 9.3750 (9.8750) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 680
clean true:664
clean false:16
clean_rate:0.9764705882352941
noisy true:547
noisy false:373
after delete: len(clean_dataset) 680
after delete: len(noisy_dataset) 920
epoch [76/200] batch [5/21] time 0.177 (0.194) data 0.100 (0.118) loss_x loss_x 0.9233 (0.5815) acc_x 84.3750 (84.3750) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/21] time 0.162 (0.186) data 0.086 (0.109) loss_x loss_x 0.7285 (0.6060) acc_x 87.5000 (85.9375) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/21] time 0.174 (0.180) data 0.098 (0.103) loss_x loss_x 0.5923 (0.5487) acc_x 81.2500 (86.6667) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/21] time 0.179 (0.179) data 0.103 (0.103) loss_x loss_x 0.4946 (0.5865) acc_x 90.6250 (85.4688) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/28] time 0.181 (0.180) data 0.105 (0.104) loss_u loss_u 0.8511 (0.8708) acc_u 15.6250 (15.0000) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [10/28] time 0.187 (0.181) data 0.111 (0.104) loss_u loss_u 0.9033 (0.8864) acc_u 12.5000 (12.8125) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/28] time 0.184 (0.181) data 0.107 (0.105) loss_u loss_u 0.9028 (0.8939) acc_u 9.3750 (11.8750) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/28] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.9976 (0.9029) acc_u 0.0000 (10.7812) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [25/28] time 0.182 (0.182) data 0.106 (0.106) loss_u loss_u 0.9536 (0.9080) acc_u 6.2500 (10.1250) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.4131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 661
clean true:647
clean false:14
clean_rate:0.9788199697428139
noisy true:550
noisy false:389
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 939
epoch [77/200] batch [5/20] time 0.187 (0.191) data 0.111 (0.114) loss_x loss_x 0.2751 (0.4963) acc_x 93.7500 (88.1250) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/20] time 0.183 (0.187) data 0.107 (0.111) loss_x loss_x 0.3406 (0.4731) acc_x 87.5000 (87.5000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/20] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.7622 (0.4838) acc_x 87.5000 (87.7083) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [20/20] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.2771 (0.4705) acc_x 87.5000 (88.1250) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/29] time 0.159 (0.182) data 0.081 (0.106) loss_u loss_u 0.7734 (0.8898) acc_u 25.0000 (11.8750) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [10/29] time 0.166 (0.179) data 0.089 (0.102) loss_u loss_u 0.9644 (0.9080) acc_u 6.2500 (10.6250) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/29] time 0.196 (0.180) data 0.119 (0.104) loss_u loss_u 0.9458 (0.9063) acc_u 6.2500 (10.6250) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/29] time 0.171 (0.180) data 0.094 (0.103) loss_u loss_u 0.8789 (0.8975) acc_u 12.5000 (11.5625) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [25/29] time 0.189 (0.179) data 0.113 (0.103) loss_u loss_u 0.7993 (0.8961) acc_u 25.0000 (12.0000) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 652
clean true:631
clean false:21
clean_rate:0.9677914110429447
noisy true:559
noisy false:389
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 948
epoch [78/200] batch [5/20] time 0.161 (0.161) data 0.084 (0.085) loss_x loss_x 0.6826 (0.5797) acc_x 81.2500 (83.1250) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/20] time 0.164 (0.161) data 0.088 (0.085) loss_x loss_x 0.5737 (0.5736) acc_x 78.1250 (83.4375) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/20] time 0.167 (0.162) data 0.091 (0.086) loss_x loss_x 0.3696 (0.5207) acc_x 87.5000 (85.2083) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [20/20] time 0.164 (0.163) data 0.088 (0.087) loss_x loss_x 0.5830 (0.5266) acc_x 87.5000 (85.6250) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/29] time 0.158 (0.165) data 0.081 (0.089) loss_u loss_u 0.8911 (0.8905) acc_u 12.5000 (13.1250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/29] time 0.162 (0.165) data 0.086 (0.088) loss_u loss_u 0.8306 (0.8810) acc_u 18.7500 (13.1250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/29] time 0.167 (0.165) data 0.088 (0.088) loss_u loss_u 0.9341 (0.8888) acc_u 9.3750 (12.2917) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/29] time 0.177 (0.165) data 0.099 (0.088) loss_u loss_u 0.7954 (0.8898) acc_u 21.8750 (11.8750) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [25/29] time 0.170 (0.165) data 0.094 (0.089) loss_u loss_u 0.8604 (0.8848) acc_u 18.7500 (12.7500) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.4287, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 686
clean true:670
clean false:16
clean_rate:0.9766763848396501
noisy true:560
noisy false:354
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 914
epoch [79/200] batch [5/21] time 0.170 (0.174) data 0.094 (0.098) loss_x loss_x 0.4453 (0.5280) acc_x 87.5000 (84.3750) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/21] time 0.172 (0.173) data 0.093 (0.097) loss_x loss_x 0.6743 (0.6329) acc_x 87.5000 (84.0625) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/21] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.3535 (0.5817) acc_x 87.5000 (84.7917) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/21] time 0.188 (0.175) data 0.113 (0.099) loss_x loss_x 0.5581 (0.5820) acc_x 87.5000 (85.1562) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/28] time 0.191 (0.178) data 0.114 (0.102) loss_u loss_u 0.9443 (0.9376) acc_u 9.3750 (6.8750) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [10/28] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.8770 (0.9014) acc_u 12.5000 (10.9375) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [15/28] time 0.159 (0.177) data 0.083 (0.100) loss_u loss_u 0.8745 (0.9067) acc_u 12.5000 (10.0000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/28] time 0.187 (0.177) data 0.110 (0.100) loss_u loss_u 0.8506 (0.9047) acc_u 18.7500 (10.3125) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [25/28] time 0.165 (0.176) data 0.089 (0.099) loss_u loss_u 0.8096 (0.9006) acc_u 21.8750 (10.7500) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.4169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 667
clean true:643
clean false:24
clean_rate:0.9640179910044977
noisy true:572
noisy false:361
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 933
epoch [80/200] batch [5/20] time 0.181 (0.189) data 0.105 (0.112) loss_x loss_x 0.3818 (0.5542) acc_x 93.7500 (88.1250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/20] time 0.185 (0.187) data 0.109 (0.111) loss_x loss_x 1.2266 (0.6306) acc_x 75.0000 (85.0000) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/20] time 0.183 (0.187) data 0.107 (0.111) loss_x loss_x 0.1515 (0.5314) acc_x 93.7500 (86.6667) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [20/20] time 0.180 (0.186) data 0.103 (0.110) loss_x loss_x 0.4597 (0.5579) acc_x 87.5000 (85.4688) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/29] time 0.170 (0.185) data 0.092 (0.108) loss_u loss_u 0.9053 (0.8699) acc_u 12.5000 (15.6250) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [10/29] time 0.157 (0.181) data 0.081 (0.104) loss_u loss_u 0.9912 (0.8906) acc_u 0.0000 (12.8125) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [15/29] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.8740 (0.8885) acc_u 12.5000 (12.7083) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/29] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.9570 (0.8884) acc_u 6.2500 (12.9688) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [25/29] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.9824 (0.8952) acc_u 3.1250 (12.0000) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.4156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 665
clean true:644
clean false:21
clean_rate:0.968421052631579
noisy true:540
noisy false:395
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 935
epoch [81/200] batch [5/20] time 0.162 (0.166) data 0.085 (0.089) loss_x loss_x 0.3916 (0.6554) acc_x 87.5000 (80.6250) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/20] time 0.168 (0.166) data 0.092 (0.090) loss_x loss_x 0.7627 (0.5844) acc_x 78.1250 (82.8125) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/20] time 0.180 (0.170) data 0.104 (0.094) loss_x loss_x 0.6548 (0.5563) acc_x 84.3750 (84.1667) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [20/20] time 0.182 (0.170) data 0.105 (0.094) loss_x loss_x 0.9805 (0.5597) acc_x 75.0000 (84.8438) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/29] time 0.162 (0.171) data 0.085 (0.094) loss_u loss_u 0.9097 (0.9212) acc_u 12.5000 (9.3750) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/29] time 0.157 (0.169) data 0.081 (0.092) loss_u loss_u 0.8745 (0.9059) acc_u 15.6250 (10.9375) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/29] time 0.163 (0.168) data 0.086 (0.091) loss_u loss_u 0.8833 (0.8994) acc_u 12.5000 (11.4583) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/29] time 0.163 (0.167) data 0.086 (0.090) loss_u loss_u 0.9678 (0.9047) acc_u 3.1250 (10.7812) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [25/29] time 0.167 (0.168) data 0.089 (0.091) loss_u loss_u 0.8550 (0.8962) acc_u 12.5000 (11.6250) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.4250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 680
clean true:658
clean false:22
clean_rate:0.9676470588235294
noisy true:547
noisy false:373
after delete: len(clean_dataset) 680
after delete: len(noisy_dataset) 920
epoch [82/200] batch [5/21] time 0.184 (0.200) data 0.107 (0.123) loss_x loss_x 0.3408 (0.3716) acc_x 87.5000 (90.0000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/21] time 0.172 (0.195) data 0.095 (0.118) loss_x loss_x 0.6724 (0.4711) acc_x 81.2500 (87.8125) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/21] time 0.185 (0.191) data 0.109 (0.114) loss_x loss_x 0.5957 (0.5001) acc_x 81.2500 (86.8750) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/21] time 0.208 (0.194) data 0.130 (0.117) loss_x loss_x 0.3999 (0.4976) acc_x 84.3750 (86.5625) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/28] time 0.166 (0.190) data 0.088 (0.113) loss_u loss_u 0.8916 (0.9137) acc_u 12.5000 (8.7500) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [10/28] time 0.183 (0.189) data 0.106 (0.112) loss_u loss_u 0.8672 (0.9009) acc_u 15.6250 (10.0000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [15/28] time 0.184 (0.188) data 0.107 (0.111) loss_u loss_u 0.8735 (0.8870) acc_u 15.6250 (12.0833) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [20/28] time 0.162 (0.187) data 0.085 (0.110) loss_u loss_u 0.9409 (0.8971) acc_u 6.2500 (11.2500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [25/28] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.7549 (0.8928) acc_u 28.1250 (11.7500) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 678
clean true:659
clean false:19
clean_rate:0.971976401179941
noisy true:558
noisy false:364
after delete: len(clean_dataset) 678
after delete: len(noisy_dataset) 922
epoch [83/200] batch [5/21] time 0.176 (0.181) data 0.099 (0.105) loss_x loss_x 0.6699 (0.6800) acc_x 90.6250 (83.7500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/21] time 0.161 (0.176) data 0.085 (0.099) loss_x loss_x 0.5215 (0.5944) acc_x 84.3750 (83.4375) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/21] time 0.180 (0.173) data 0.104 (0.096) loss_x loss_x 0.2590 (0.5451) acc_x 90.6250 (84.5833) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/21] time 0.172 (0.175) data 0.095 (0.099) loss_x loss_x 0.5288 (0.5569) acc_x 87.5000 (85.0000) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/28] time 0.174 (0.173) data 0.095 (0.097) loss_u loss_u 0.8804 (0.8984) acc_u 12.5000 (11.2500) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/28] time 0.181 (0.176) data 0.103 (0.099) loss_u loss_u 0.9058 (0.9048) acc_u 12.5000 (10.6250) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/28] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.9648 (0.9090) acc_u 3.1250 (10.2083) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/28] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.8491 (0.8992) acc_u 18.7500 (11.5625) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [25/28] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9009 (0.8980) acc_u 9.3750 (11.5000) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.4231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 677
clean true:661
clean false:16
clean_rate:0.9763663220088626
noisy true:569
noisy false:354
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 923
epoch [84/200] batch [5/21] time 0.175 (0.181) data 0.099 (0.105) loss_x loss_x 0.4636 (0.5196) acc_x 84.3750 (85.6250) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [10/21] time 0.166 (0.178) data 0.088 (0.101) loss_x loss_x 0.2903 (0.4440) acc_x 93.7500 (87.8125) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/21] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.7261 (0.5022) acc_x 75.0000 (85.8333) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/21] time 0.178 (0.175) data 0.101 (0.099) loss_x loss_x 0.4751 (0.4902) acc_x 84.3750 (86.2500) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/28] time 0.192 (0.177) data 0.115 (0.100) loss_u loss_u 0.9106 (0.8954) acc_u 9.3750 (11.8750) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/28] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.9814 (0.9061) acc_u 3.1250 (10.9375) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/28] time 0.179 (0.175) data 0.102 (0.098) loss_u loss_u 0.8936 (0.9020) acc_u 12.5000 (11.0417) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/28] time 0.187 (0.175) data 0.111 (0.099) loss_u loss_u 0.8760 (0.9018) acc_u 12.5000 (11.0938) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [25/28] time 0.181 (0.176) data 0.102 (0.099) loss_u loss_u 0.9834 (0.9062) acc_u 3.1250 (10.7500) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 678
clean true:660
clean false:18
clean_rate:0.9734513274336283
noisy true:565
noisy false:357
after delete: len(clean_dataset) 678
after delete: len(noisy_dataset) 922
epoch [85/200] batch [5/21] time 0.170 (0.173) data 0.094 (0.096) loss_x loss_x 0.4890 (0.5250) acc_x 81.2500 (83.7500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [10/21] time 0.182 (0.176) data 0.105 (0.100) loss_x loss_x 0.4492 (0.5315) acc_x 90.6250 (85.9375) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/21] time 0.161 (0.172) data 0.084 (0.095) loss_x loss_x 0.4277 (0.5153) acc_x 84.3750 (85.8333) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/21] time 0.169 (0.171) data 0.092 (0.094) loss_x loss_x 1.2012 (0.5444) acc_x 71.8750 (85.6250) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/28] time 0.184 (0.171) data 0.106 (0.094) loss_u loss_u 0.9658 (0.9474) acc_u 3.1250 (5.0000) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/28] time 0.184 (0.173) data 0.107 (0.096) loss_u loss_u 0.9062 (0.9109) acc_u 12.5000 (9.3750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [15/28] time 0.184 (0.174) data 0.108 (0.097) loss_u loss_u 0.8862 (0.9083) acc_u 12.5000 (10.0000) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [20/28] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.9399 (0.9054) acc_u 6.2500 (10.4688) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [25/28] time 0.192 (0.177) data 0.114 (0.100) loss_u loss_u 0.9419 (0.9043) acc_u 6.2500 (10.5000) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.4262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 682
clean true:662
clean false:20
clean_rate:0.9706744868035191
noisy true:564
noisy false:354
after delete: len(clean_dataset) 682
after delete: len(noisy_dataset) 918
epoch [86/200] batch [5/21] time 0.185 (0.186) data 0.109 (0.110) loss_x loss_x 0.6621 (0.6300) acc_x 81.2500 (83.1250) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/21] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.6680 (0.5693) acc_x 81.2500 (84.3750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/21] time 0.182 (0.185) data 0.104 (0.109) loss_x loss_x 0.2296 (0.5543) acc_x 93.7500 (84.3750) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/21] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.5098 (0.5638) acc_x 87.5000 (84.8438) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/28] time 0.178 (0.184) data 0.101 (0.108) loss_u loss_u 0.8975 (0.9277) acc_u 12.5000 (8.1250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [10/28] time 0.181 (0.184) data 0.104 (0.108) loss_u loss_u 0.8926 (0.9233) acc_u 12.5000 (8.4375) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [15/28] time 0.181 (0.183) data 0.103 (0.107) loss_u loss_u 0.8740 (0.9077) acc_u 12.5000 (10.4167) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/28] time 0.197 (0.183) data 0.120 (0.106) loss_u loss_u 0.7661 (0.9055) acc_u 25.0000 (10.7812) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [25/28] time 0.199 (0.182) data 0.122 (0.106) loss_u loss_u 0.9409 (0.9104) acc_u 6.2500 (10.3750) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.4325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 692
clean true:671
clean false:21
clean_rate:0.9696531791907514
noisy true:550
noisy false:358
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 908
epoch [87/200] batch [5/21] time 0.186 (0.179) data 0.110 (0.102) loss_x loss_x 0.3708 (0.5100) acc_x 87.5000 (85.0000) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/21] time 0.180 (0.180) data 0.104 (0.104) loss_x loss_x 0.5444 (0.5515) acc_x 84.3750 (83.1250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/21] time 0.183 (0.182) data 0.108 (0.106) loss_x loss_x 0.4180 (0.5400) acc_x 90.6250 (83.7500) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/21] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.4153 (0.5278) acc_x 90.6250 (84.2188) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/28] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.8911 (0.8964) acc_u 12.5000 (11.8750) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [10/28] time 0.166 (0.181) data 0.089 (0.105) loss_u loss_u 0.8999 (0.9062) acc_u 9.3750 (10.9375) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [15/28] time 0.174 (0.179) data 0.096 (0.103) loss_u loss_u 0.9409 (0.9111) acc_u 6.2500 (10.4167) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/28] time 0.167 (0.177) data 0.089 (0.101) loss_u loss_u 0.9897 (0.9104) acc_u 3.1250 (10.4688) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [25/28] time 0.182 (0.178) data 0.105 (0.102) loss_u loss_u 0.9502 (0.9138) acc_u 6.2500 (10.0000) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 676
clean true:657
clean false:19
clean_rate:0.9718934911242604
noisy true:556
noisy false:368
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 924
epoch [88/200] batch [5/21] time 0.189 (0.184) data 0.112 (0.108) loss_x loss_x 0.4319 (0.6552) acc_x 84.3750 (83.7500) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/21] time 0.169 (0.186) data 0.092 (0.109) loss_x loss_x 0.4065 (0.6023) acc_x 90.6250 (85.0000) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/21] time 0.164 (0.179) data 0.087 (0.103) loss_x loss_x 0.4590 (0.6024) acc_x 84.3750 (85.0000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/21] time 0.174 (0.179) data 0.097 (0.103) loss_x loss_x 0.5928 (0.6056) acc_x 78.1250 (84.3750) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/28] time 0.182 (0.178) data 0.105 (0.102) loss_u loss_u 0.8740 (0.9026) acc_u 12.5000 (11.2500) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/28] time 0.172 (0.177) data 0.094 (0.100) loss_u loss_u 0.9209 (0.9127) acc_u 9.3750 (10.0000) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [15/28] time 0.159 (0.176) data 0.082 (0.099) loss_u loss_u 0.8574 (0.9108) acc_u 15.6250 (10.0000) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [20/28] time 0.186 (0.175) data 0.109 (0.099) loss_u loss_u 0.8794 (0.9142) acc_u 12.5000 (9.6875) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [25/28] time 0.184 (0.176) data 0.108 (0.100) loss_u loss_u 0.9482 (0.9163) acc_u 6.2500 (9.6250) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.4225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 676
clean true:660
clean false:16
clean_rate:0.9763313609467456
noisy true:547
noisy false:377
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 924
epoch [89/200] batch [5/21] time 0.176 (0.173) data 0.098 (0.096) loss_x loss_x 0.7407 (0.6977) acc_x 75.0000 (81.8750) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/21] time 0.169 (0.175) data 0.092 (0.098) loss_x loss_x 0.4397 (0.5995) acc_x 90.6250 (85.3125) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/21] time 0.165 (0.172) data 0.088 (0.095) loss_x loss_x 0.6582 (0.5643) acc_x 84.3750 (86.0417) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/21] time 0.159 (0.171) data 0.083 (0.094) loss_x loss_x 0.4128 (0.5465) acc_x 90.6250 (85.9375) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/28] time 0.178 (0.171) data 0.100 (0.094) loss_u loss_u 0.9321 (0.9042) acc_u 6.2500 (10.6250) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/28] time 0.180 (0.172) data 0.102 (0.095) loss_u loss_u 0.9463 (0.9137) acc_u 6.2500 (9.3750) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [15/28] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.8867 (0.9029) acc_u 15.6250 (11.2500) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/28] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.8408 (0.9008) acc_u 15.6250 (11.4062) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [25/28] time 0.189 (0.175) data 0.111 (0.098) loss_u loss_u 0.9233 (0.9016) acc_u 9.3750 (11.2500) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 680
clean true:660
clean false:20
clean_rate:0.9705882352941176
noisy true:553
noisy false:367
after delete: len(clean_dataset) 680
after delete: len(noisy_dataset) 920
epoch [90/200] batch [5/21] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.6665 (0.5899) acc_x 75.0000 (82.5000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/21] time 0.188 (0.179) data 0.110 (0.102) loss_x loss_x 0.5093 (0.5648) acc_x 90.6250 (85.6250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/21] time 0.170 (0.175) data 0.094 (0.098) loss_x loss_x 0.3987 (0.6010) acc_x 93.7500 (85.0000) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/21] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 0.6094 (0.5946) acc_x 81.2500 (85.1562) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/28] time 0.160 (0.172) data 0.084 (0.096) loss_u loss_u 0.9370 (0.8930) acc_u 6.2500 (12.5000) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/28] time 0.164 (0.172) data 0.087 (0.095) loss_u loss_u 0.8564 (0.8998) acc_u 15.6250 (11.5625) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [15/28] time 0.162 (0.171) data 0.085 (0.094) loss_u loss_u 0.9414 (0.8989) acc_u 6.2500 (11.2500) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [20/28] time 0.185 (0.171) data 0.107 (0.094) loss_u loss_u 0.9009 (0.9014) acc_u 9.3750 (10.7812) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [25/28] time 0.184 (0.172) data 0.107 (0.095) loss_u loss_u 0.8916 (0.9036) acc_u 12.5000 (10.6250) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 691
clean true:668
clean false:23
clean_rate:0.9667149059334298
noisy true:555
noisy false:354
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 909
epoch [91/200] batch [5/21] time 0.171 (0.176) data 0.095 (0.099) loss_x loss_x 0.6665 (0.5476) acc_x 84.3750 (87.5000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/21] time 0.163 (0.172) data 0.086 (0.095) loss_x loss_x 0.6201 (0.5493) acc_x 84.3750 (87.5000) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/21] time 0.175 (0.169) data 0.097 (0.093) loss_x loss_x 0.3740 (0.5261) acc_x 87.5000 (87.0833) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/21] time 0.158 (0.168) data 0.082 (0.092) loss_x loss_x 0.6274 (0.5209) acc_x 84.3750 (87.6562) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/28] time 0.167 (0.168) data 0.089 (0.091) loss_u loss_u 0.9585 (0.9065) acc_u 3.1250 (10.6250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/28] time 0.183 (0.169) data 0.106 (0.092) loss_u loss_u 0.9141 (0.9159) acc_u 9.3750 (10.0000) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [15/28] time 0.185 (0.171) data 0.108 (0.094) loss_u loss_u 0.9658 (0.9151) acc_u 3.1250 (9.7917) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/28] time 0.183 (0.172) data 0.106 (0.095) loss_u loss_u 0.8301 (0.9095) acc_u 15.6250 (10.3125) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [25/28] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.8857 (0.9043) acc_u 12.5000 (10.6250) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 696
clean true:674
clean false:22
clean_rate:0.9683908045977011
noisy true:562
noisy false:342
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 904
epoch [92/200] batch [5/21] time 0.187 (0.178) data 0.109 (0.101) loss_x loss_x 0.5161 (0.6153) acc_x 81.2500 (81.8750) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/21] time 0.176 (0.177) data 0.098 (0.100) loss_x loss_x 0.5820 (0.6031) acc_x 84.3750 (83.7500) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [15/21] time 0.187 (0.177) data 0.110 (0.100) loss_x loss_x 0.2688 (0.5954) acc_x 93.7500 (83.5417) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/21] time 0.166 (0.177) data 0.090 (0.101) loss_x loss_x 0.7998 (0.6038) acc_x 84.3750 (83.9062) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/28] time 0.161 (0.174) data 0.084 (0.097) loss_u loss_u 0.9209 (0.9200) acc_u 9.3750 (8.7500) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [10/28] time 0.164 (0.172) data 0.088 (0.095) loss_u loss_u 0.9194 (0.9115) acc_u 9.3750 (9.6875) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [15/28] time 0.186 (0.173) data 0.109 (0.097) loss_u loss_u 0.9712 (0.9148) acc_u 3.1250 (9.3750) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/28] time 0.189 (0.176) data 0.112 (0.099) loss_u loss_u 0.9683 (0.9148) acc_u 3.1250 (9.3750) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [25/28] time 0.183 (0.176) data 0.107 (0.100) loss_u loss_u 0.8970 (0.9136) acc_u 12.5000 (9.7500) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 672
clean true:657
clean false:15
clean_rate:0.9776785714285714
noisy true:568
noisy false:360
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 928
epoch [93/200] batch [5/21] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.3020 (0.3883) acc_x 90.6250 (86.8750) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/21] time 0.170 (0.178) data 0.094 (0.102) loss_x loss_x 0.6406 (0.5168) acc_x 90.6250 (85.0000) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/21] time 0.158 (0.172) data 0.081 (0.095) loss_x loss_x 0.4758 (0.5131) acc_x 90.6250 (85.6250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/21] time 0.163 (0.169) data 0.086 (0.092) loss_x loss_x 0.5674 (0.5187) acc_x 78.1250 (85.7812) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/29] time 0.162 (0.167) data 0.085 (0.090) loss_u loss_u 0.8823 (0.9335) acc_u 12.5000 (7.5000) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [10/29] time 0.202 (0.170) data 0.125 (0.093) loss_u loss_u 0.9204 (0.9066) acc_u 9.3750 (11.5625) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [15/29] time 0.184 (0.171) data 0.106 (0.094) loss_u loss_u 0.8823 (0.8938) acc_u 12.5000 (12.7083) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/29] time 0.215 (0.173) data 0.139 (0.096) loss_u loss_u 0.9014 (0.8949) acc_u 12.5000 (12.6562) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [25/29] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.9165 (0.8975) acc_u 9.3750 (12.2500) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 685
clean true:666
clean false:19
clean_rate:0.9722627737226277
noisy true:557
noisy false:358
after delete: len(clean_dataset) 685
after delete: len(noisy_dataset) 915
epoch [94/200] batch [5/21] time 0.183 (0.185) data 0.107 (0.107) loss_x loss_x 0.7920 (0.5653) acc_x 78.1250 (85.0000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/21] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 0.3486 (0.6003) acc_x 93.7500 (84.6875) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/21] time 0.166 (0.184) data 0.090 (0.107) loss_x loss_x 0.5688 (0.5471) acc_x 84.3750 (86.0417) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/21] time 0.172 (0.182) data 0.096 (0.105) loss_x loss_x 0.4692 (0.5479) acc_x 87.5000 (86.4062) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/28] time 0.160 (0.178) data 0.081 (0.101) loss_u loss_u 0.9824 (0.9250) acc_u 0.0000 (8.7500) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [10/28] time 0.175 (0.180) data 0.098 (0.103) loss_u loss_u 0.9155 (0.9170) acc_u 9.3750 (10.0000) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [15/28] time 0.168 (0.179) data 0.090 (0.102) loss_u loss_u 0.8457 (0.9011) acc_u 18.7500 (11.4583) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/28] time 0.159 (0.177) data 0.082 (0.100) loss_u loss_u 0.9487 (0.9046) acc_u 6.2500 (10.9375) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [25/28] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.8862 (0.9006) acc_u 15.6250 (11.5000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.4250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 680
clean true:656
clean false:24
clean_rate:0.9647058823529412
noisy true:534
noisy false:386
after delete: len(clean_dataset) 680
after delete: len(noisy_dataset) 920
epoch [95/200] batch [5/21] time 0.163 (0.182) data 0.086 (0.105) loss_x loss_x 0.3713 (0.4417) acc_x 87.5000 (86.8750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/21] time 0.161 (0.171) data 0.085 (0.095) loss_x loss_x 0.4165 (0.4677) acc_x 90.6250 (87.1875) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [15/21] time 0.179 (0.171) data 0.102 (0.095) loss_x loss_x 0.4829 (0.5192) acc_x 87.5000 (86.0417) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/21] time 0.180 (0.174) data 0.104 (0.097) loss_x loss_x 0.1694 (0.4786) acc_x 93.7500 (87.0312) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/28] time 0.187 (0.176) data 0.111 (0.099) loss_u loss_u 0.9082 (0.9050) acc_u 12.5000 (11.2500) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/28] time 0.198 (0.176) data 0.120 (0.099) loss_u loss_u 0.9214 (0.9067) acc_u 9.3750 (10.6250) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [15/28] time 0.185 (0.177) data 0.109 (0.100) loss_u loss_u 0.9507 (0.9009) acc_u 6.2500 (11.0417) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/28] time 0.183 (0.178) data 0.106 (0.102) loss_u loss_u 0.9507 (0.9093) acc_u 6.2500 (10.1562) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [25/28] time 0.183 (0.179) data 0.106 (0.103) loss_u loss_u 0.8784 (0.9105) acc_u 12.5000 (10.1250) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.4319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 691
clean true:670
clean false:21
clean_rate:0.9696092619392185
noisy true:568
noisy false:341
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 909
epoch [96/200] batch [5/21] time 0.184 (0.180) data 0.106 (0.103) loss_x loss_x 0.6465 (0.5842) acc_x 84.3750 (86.2500) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/21] time 0.187 (0.182) data 0.110 (0.106) loss_x loss_x 0.4673 (0.5549) acc_x 87.5000 (85.6250) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/21] time 0.218 (0.185) data 0.141 (0.109) loss_x loss_x 0.3975 (0.5618) acc_x 90.6250 (84.7917) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/21] time 0.181 (0.184) data 0.105 (0.108) loss_x loss_x 0.2413 (0.5368) acc_x 93.7500 (85.3125) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/28] time 0.180 (0.184) data 0.102 (0.108) loss_u loss_u 0.9111 (0.8887) acc_u 9.3750 (12.5000) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [10/28] time 0.224 (0.186) data 0.147 (0.110) loss_u loss_u 0.9175 (0.9152) acc_u 9.3750 (10.0000) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [15/28] time 0.183 (0.186) data 0.106 (0.109) loss_u loss_u 0.9546 (0.9229) acc_u 3.1250 (8.9583) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [20/28] time 0.190 (0.185) data 0.113 (0.108) loss_u loss_u 0.9326 (0.9198) acc_u 6.2500 (9.2188) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [25/28] time 0.174 (0.183) data 0.097 (0.106) loss_u loss_u 0.8916 (0.9213) acc_u 15.6250 (9.5000) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.4275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 684
clean true:665
clean false:19
clean_rate:0.9722222222222222
noisy true:561
noisy false:355
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 916
epoch [97/200] batch [5/21] time 0.182 (0.188) data 0.106 (0.111) loss_x loss_x 0.7393 (0.6295) acc_x 81.2500 (84.3750) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/21] time 0.183 (0.187) data 0.107 (0.111) loss_x loss_x 0.5938 (0.6235) acc_x 87.5000 (86.2500) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/21] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.5840 (0.6221) acc_x 81.2500 (84.7917) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/21] time 0.187 (0.187) data 0.111 (0.110) loss_x loss_x 0.3962 (0.5695) acc_x 87.5000 (86.5625) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/28] time 0.188 (0.187) data 0.111 (0.110) loss_u loss_u 0.8804 (0.9213) acc_u 12.5000 (8.7500) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [10/28] time 0.186 (0.186) data 0.109 (0.110) loss_u loss_u 0.9351 (0.9065) acc_u 6.2500 (10.0000) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [15/28] time 0.184 (0.186) data 0.107 (0.110) loss_u loss_u 0.8472 (0.9000) acc_u 15.6250 (11.0417) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/28] time 0.188 (0.186) data 0.111 (0.109) loss_u loss_u 0.9985 (0.9100) acc_u 0.0000 (10.0000) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [25/28] time 0.172 (0.183) data 0.095 (0.107) loss_u loss_u 0.9277 (0.9122) acc_u 9.3750 (9.7500) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.4269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 683
clean true:660
clean false:23
clean_rate:0.9663250366032211
noisy true:537
noisy false:380
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 917
epoch [98/200] batch [5/21] time 0.189 (0.183) data 0.113 (0.106) loss_x loss_x 0.5498 (0.5197) acc_x 81.2500 (86.2500) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/21] time 0.174 (0.178) data 0.098 (0.101) loss_x loss_x 0.4084 (0.4613) acc_x 90.6250 (87.5000) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/21] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 0.6572 (0.5062) acc_x 78.1250 (86.8750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/21] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 0.2279 (0.4836) acc_x 90.6250 (87.1875) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/28] time 0.187 (0.171) data 0.109 (0.095) loss_u loss_u 0.8159 (0.8785) acc_u 18.7500 (13.7500) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/28] time 0.161 (0.170) data 0.083 (0.093) loss_u loss_u 0.8628 (0.8792) acc_u 15.6250 (12.8125) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [15/28] time 0.160 (0.170) data 0.083 (0.094) loss_u loss_u 0.9507 (0.8944) acc_u 6.2500 (11.2500) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [20/28] time 0.165 (0.170) data 0.088 (0.093) loss_u loss_u 0.8809 (0.8922) acc_u 12.5000 (11.7188) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [25/28] time 0.168 (0.169) data 0.092 (0.092) loss_u loss_u 0.9106 (0.8964) acc_u 9.3750 (11.2500) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.4419, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 707
clean true:684
clean false:23
clean_rate:0.9674681753889675
noisy true:563
noisy false:330
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 893
epoch [99/200] batch [5/22] time 0.175 (0.182) data 0.098 (0.105) loss_x loss_x 0.7090 (0.5754) acc_x 81.2500 (83.1250) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/22] time 0.178 (0.179) data 0.100 (0.101) loss_x loss_x 0.6875 (0.6028) acc_x 84.3750 (84.6875) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/22] time 0.182 (0.179) data 0.106 (0.102) loss_x loss_x 0.4121 (0.5961) acc_x 90.6250 (84.7917) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/22] time 0.185 (0.178) data 0.107 (0.101) loss_x loss_x 0.1815 (0.5456) acc_x 93.7500 (86.0938) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/27] time 0.178 (0.177) data 0.101 (0.100) loss_u loss_u 0.8955 (0.9210) acc_u 12.5000 (8.1250) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/27] time 0.182 (0.178) data 0.104 (0.101) loss_u loss_u 0.8960 (0.9176) acc_u 9.3750 (8.7500) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [15/27] time 0.164 (0.179) data 0.086 (0.102) loss_u loss_u 0.8604 (0.9156) acc_u 18.7500 (9.3750) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/27] time 0.176 (0.178) data 0.098 (0.101) loss_u loss_u 0.9971 (0.9220) acc_u 0.0000 (8.5938) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [25/27] time 0.188 (0.178) data 0.112 (0.100) loss_u loss_u 0.9263 (0.9172) acc_u 9.3750 (9.2500) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 696
clean true:675
clean false:21
clean_rate:0.9698275862068966
noisy true:573
noisy false:331
all clean rate:  [0.9738903394255874, 0.975, 0.989492119089317, 0.9981549815498155, 0.9879931389365352, 0.9916387959866221, 0.9912739965095986, 0.9915540540540541, 0.9866888519134775, 0.993127147766323, 0.9897959183673469, 0.9899497487437185, 0.9918300653594772, 0.9935379644588045, 0.9918032786885246, 0.9865546218487395, 0.9921383647798742, 0.9870759289176091, 0.9883527454242929, 0.9901477832512315, 0.9919614147909968, 0.988673139158576, 0.9838969404186796, 0.9918962722852512, 0.9839228295819936, 0.9854368932038835, 0.9855305466237942, 0.9920760697305864, 0.9889589905362776, 0.9887640449438202, 0.9845440494590417, 0.9845916795069337, 0.9920255183413078, 0.9792993630573248, 0.9890453834115805, 0.9841017488076311, 0.9907550077041603, 0.9875, 0.9953560371517027, 0.9811320754716981, 0.984472049689441, 0.9873417721518988, 0.9813664596273292, 0.9816232771822359, 0.9813374805598756, 0.9834834834834835, 0.9798449612403101, 0.9800918836140888, 0.9829984544049459, 0.981651376146789, 0.9818731117824774, 0.9859375, 0.9803921568627451, 0.9847560975609756, 0.9813486370157819, 0.9790419161676647, 0.9786585365853658, 0.9821428571428571, 0.9833080424886191, 0.9821693907875185, 0.9736024844720497, 0.9822485207100592, 0.9756838905775076, 0.9759036144578314, 0.9788519637462235, 0.9779735682819384, 0.984779299847793, 0.9774774774774775, 0.9749631811487481, 0.979381443298969, 0.9771689497716894, 0.9791356184798807, 0.9748520710059172, 0.9671150971599403, 0.9731343283582089, 0.9764705882352941, 0.9788199697428139, 0.9677914110429447, 0.9766763848396501, 0.9640179910044977, 0.968421052631579, 0.9676470588235294, 0.971976401179941, 0.9763663220088626, 0.9734513274336283, 0.9706744868035191, 0.9696531791907514, 0.9718934911242604, 0.9763313609467456, 0.9705882352941176, 0.9667149059334298, 0.9683908045977011, 0.9776785714285714, 0.9722627737226277, 0.9647058823529412, 0.9696092619392185, 0.9722222222222222, 0.9663250366032211, 0.9674681753889675, 0.9698275862068966]
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 904
epoch [100/200] batch [5/21] time 0.186 (0.186) data 0.110 (0.109) loss_x loss_x 0.2917 (0.4047) acc_x 87.5000 (90.0000) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/21] time 0.190 (0.185) data 0.114 (0.109) loss_x loss_x 0.3557 (0.4694) acc_x 90.6250 (87.8125) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/21] time 0.176 (0.184) data 0.099 (0.108) loss_x loss_x 0.6011 (0.5072) acc_x 90.6250 (87.5000) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/21] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.4863 (0.4938) acc_x 84.3750 (87.5000) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/28] time 0.183 (0.184) data 0.106 (0.108) loss_u loss_u 0.9141 (0.9336) acc_u 9.3750 (6.8750) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [10/28] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9619 (0.9127) acc_u 3.1250 (9.3750) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [15/28] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.8936 (0.9155) acc_u 12.5000 (9.3750) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [20/28] time 0.180 (0.184) data 0.104 (0.107) loss_u loss_u 0.9399 (0.9146) acc_u 9.3750 (9.6875) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [25/28] time 0.175 (0.183) data 0.098 (0.106) loss_u loss_u 0.8066 (0.9122) acc_u 21.8750 (10.1250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.4281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 685
clean true:667
clean false:18
clean_rate:0.9737226277372263
noisy true:561
noisy false:354
after delete: len(clean_dataset) 685
after delete: len(noisy_dataset) 915
epoch [101/200] batch [5/21] time 0.190 (0.171) data 0.113 (0.094) loss_x loss_x 0.3589 (0.3315) acc_x 93.7500 (91.2500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/21] time 0.176 (0.171) data 0.099 (0.095) loss_x loss_x 0.3665 (0.4207) acc_x 90.6250 (89.0625) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [15/21] time 0.176 (0.175) data 0.100 (0.098) loss_x loss_x 0.6626 (0.4508) acc_x 84.3750 (88.7500) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/21] time 0.188 (0.176) data 0.111 (0.099) loss_x loss_x 0.2886 (0.4568) acc_x 93.7500 (88.7500) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/28] time 0.195 (0.176) data 0.118 (0.100) loss_u loss_u 0.8633 (0.8940) acc_u 15.6250 (13.1250) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [10/28] time 0.176 (0.177) data 0.097 (0.100) loss_u loss_u 0.8589 (0.8926) acc_u 15.6250 (12.1875) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [15/28] time 0.180 (0.177) data 0.103 (0.101) loss_u loss_u 0.8682 (0.8970) acc_u 12.5000 (11.2500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/28] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.8315 (0.8999) acc_u 18.7500 (10.9375) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [25/28] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9019 (0.9045) acc_u 12.5000 (10.6250) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 699
clean true:678
clean false:21
clean_rate:0.9699570815450643
noisy true:551
noisy false:350
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 901
epoch [102/200] batch [5/21] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.5342 (0.4856) acc_x 84.3750 (88.1250) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [10/21] time 0.183 (0.180) data 0.107 (0.104) loss_x loss_x 0.4465 (0.5318) acc_x 90.6250 (87.8125) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/21] time 0.173 (0.180) data 0.097 (0.104) loss_x loss_x 0.9150 (0.5387) acc_x 81.2500 (86.6667) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/21] time 0.199 (0.182) data 0.123 (0.105) loss_x loss_x 0.4995 (0.5826) acc_x 87.5000 (85.9375) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/28] time 0.177 (0.180) data 0.100 (0.103) loss_u loss_u 0.7969 (0.8874) acc_u 18.7500 (11.8750) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/28] time 0.153 (0.178) data 0.077 (0.102) loss_u loss_u 0.8833 (0.9083) acc_u 15.6250 (10.3125) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [15/28] time 0.162 (0.176) data 0.085 (0.099) loss_u loss_u 0.9492 (0.9158) acc_u 3.1250 (9.1667) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/28] time 0.171 (0.175) data 0.095 (0.098) loss_u loss_u 0.9697 (0.9156) acc_u 6.2500 (9.3750) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [25/28] time 0.166 (0.174) data 0.087 (0.098) loss_u loss_u 0.9502 (0.9178) acc_u 3.1250 (8.8750) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 358
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 704
clean true:683
clean false:21
clean_rate:0.9701704545454546
noisy true:559
noisy false:337
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 896
epoch [103/200] batch [5/22] time 0.169 (0.162) data 0.092 (0.086) loss_x loss_x 0.2341 (0.4554) acc_x 93.7500 (89.3750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/22] time 0.171 (0.167) data 0.095 (0.091) loss_x loss_x 0.1932 (0.4498) acc_x 93.7500 (89.6875) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/22] time 0.187 (0.170) data 0.110 (0.094) loss_x loss_x 0.7344 (0.5298) acc_x 81.2500 (87.0833) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/22] time 0.176 (0.173) data 0.100 (0.097) loss_x loss_x 0.5283 (0.5680) acc_x 84.3750 (85.7812) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/28] time 0.165 (0.172) data 0.088 (0.096) loss_u loss_u 0.9414 (0.8664) acc_u 6.2500 (13.7500) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/28] time 0.167 (0.172) data 0.090 (0.095) loss_u loss_u 0.9727 (0.8895) acc_u 3.1250 (11.8750) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [15/28] time 0.176 (0.172) data 0.099 (0.095) loss_u loss_u 0.9087 (0.8978) acc_u 9.3750 (11.2500) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [20/28] time 0.188 (0.173) data 0.111 (0.096) loss_u loss_u 0.9336 (0.9019) acc_u 9.3750 (10.7812) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [25/28] time 0.178 (0.174) data 0.099 (0.097) loss_u loss_u 0.9956 (0.9069) acc_u 0.0000 (10.3750) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 399
confident_label rate tensor(0.4325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 692
clean true:667
clean false:25
clean_rate:0.9638728323699421
noisy true:534
noisy false:374
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 908
epoch [104/200] batch [5/21] time 0.172 (0.184) data 0.095 (0.107) loss_x loss_x 0.4070 (0.4562) acc_x 84.3750 (86.8750) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/21] time 0.177 (0.181) data 0.100 (0.104) loss_x loss_x 0.3506 (0.5018) acc_x 93.7500 (87.5000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [15/21] time 0.160 (0.179) data 0.084 (0.102) loss_x loss_x 0.7617 (0.5615) acc_x 84.3750 (86.0417) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/21] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.8018 (0.5659) acc_x 78.1250 (85.9375) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/28] time 0.175 (0.175) data 0.099 (0.099) loss_u loss_u 0.9648 (0.9275) acc_u 3.1250 (7.5000) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/28] time 0.160 (0.175) data 0.082 (0.098) loss_u loss_u 0.9653 (0.9208) acc_u 3.1250 (7.8125) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [15/28] time 0.167 (0.175) data 0.090 (0.098) loss_u loss_u 0.9326 (0.9158) acc_u 9.3750 (8.9583) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [20/28] time 0.186 (0.175) data 0.110 (0.098) loss_u loss_u 0.8135 (0.9114) acc_u 21.8750 (9.5312) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [25/28] time 0.184 (0.176) data 0.108 (0.099) loss_u loss_u 0.9077 (0.9123) acc_u 9.3750 (9.5000) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 679
clean true:660
clean false:19
clean_rate:0.9720176730486009
noisy true:559
noisy false:362
after delete: len(clean_dataset) 679
after delete: len(noisy_dataset) 921
epoch [105/200] batch [5/21] time 0.173 (0.166) data 0.096 (0.090) loss_x loss_x 0.4570 (0.5754) acc_x 87.5000 (86.8750) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/21] time 0.164 (0.168) data 0.088 (0.091) loss_x loss_x 0.5776 (0.5132) acc_x 90.6250 (88.1250) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [15/21] time 0.172 (0.169) data 0.095 (0.093) loss_x loss_x 0.9058 (0.5268) acc_x 78.1250 (87.5000) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/21] time 0.173 (0.171) data 0.097 (0.095) loss_x loss_x 0.7339 (0.5723) acc_x 81.2500 (86.7188) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/28] time 0.167 (0.172) data 0.090 (0.096) loss_u loss_u 0.8364 (0.8817) acc_u 18.7500 (12.5000) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/28] time 0.187 (0.174) data 0.110 (0.097) loss_u loss_u 0.8965 (0.8798) acc_u 15.6250 (13.4375) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [15/28] time 0.165 (0.174) data 0.088 (0.097) loss_u loss_u 0.9292 (0.8837) acc_u 6.2500 (12.9167) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/28] time 0.163 (0.173) data 0.085 (0.096) loss_u loss_u 0.9355 (0.8883) acc_u 6.2500 (12.5000) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [25/28] time 0.177 (0.173) data 0.100 (0.097) loss_u loss_u 0.9009 (0.8938) acc_u 9.3750 (12.1250) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.4450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 712
clean true:689
clean false:23
clean_rate:0.9676966292134831
noisy true:552
noisy false:336
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 888
epoch [106/200] batch [5/22] time 0.160 (0.162) data 0.083 (0.086) loss_x loss_x 0.4766 (0.5572) acc_x 87.5000 (86.8750) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/22] time 0.159 (0.162) data 0.083 (0.086) loss_x loss_x 0.6318 (0.5583) acc_x 81.2500 (85.9375) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/22] time 0.161 (0.161) data 0.085 (0.085) loss_x loss_x 0.6138 (0.5610) acc_x 84.3750 (85.8333) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/22] time 0.183 (0.164) data 0.107 (0.088) loss_x loss_x 0.4773 (0.5834) acc_x 90.6250 (85.6250) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/27] time 0.168 (0.167) data 0.091 (0.090) loss_u loss_u 0.9297 (0.9066) acc_u 6.2500 (11.8750) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/27] time 0.171 (0.167) data 0.094 (0.091) loss_u loss_u 0.9517 (0.9004) acc_u 3.1250 (11.8750) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/27] time 0.181 (0.168) data 0.104 (0.091) loss_u loss_u 0.9307 (0.9093) acc_u 9.3750 (10.8333) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [20/27] time 0.188 (0.169) data 0.112 (0.093) loss_u loss_u 0.9331 (0.9107) acc_u 6.2500 (10.4688) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [25/27] time 0.180 (0.171) data 0.103 (0.094) loss_u loss_u 0.9546 (0.9097) acc_u 6.2500 (10.5000) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 699
clean true:675
clean false:24
clean_rate:0.9656652360515021
noisy true:557
noisy false:344
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 901
epoch [107/200] batch [5/21] time 0.176 (0.167) data 0.100 (0.091) loss_x loss_x 0.7285 (0.5241) acc_x 81.2500 (84.3750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/21] time 0.169 (0.170) data 0.093 (0.093) loss_x loss_x 0.5615 (0.4731) acc_x 87.5000 (87.1875) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/21] time 0.158 (0.169) data 0.082 (0.092) loss_x loss_x 0.8115 (0.5202) acc_x 81.2500 (85.0000) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/21] time 0.176 (0.170) data 0.099 (0.094) loss_x loss_x 0.7788 (0.5130) acc_x 84.3750 (85.6250) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/28] time 0.181 (0.173) data 0.104 (0.096) loss_u loss_u 0.8203 (0.9143) acc_u 21.8750 (10.6250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/28] time 0.168 (0.173) data 0.091 (0.096) loss_u loss_u 0.9351 (0.9136) acc_u 9.3750 (10.6250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [15/28] time 0.176 (0.173) data 0.100 (0.097) loss_u loss_u 0.9131 (0.9044) acc_u 12.5000 (11.2500) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/28] time 0.187 (0.174) data 0.110 (0.097) loss_u loss_u 0.9482 (0.9154) acc_u 9.3750 (10.1562) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [25/28] time 0.188 (0.175) data 0.112 (0.098) loss_u loss_u 0.8745 (0.9102) acc_u 15.6250 (10.6250) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 682
clean true:663
clean false:19
clean_rate:0.9721407624633431
noisy true:551
noisy false:367
after delete: len(clean_dataset) 682
after delete: len(noisy_dataset) 918
epoch [108/200] batch [5/21] time 0.175 (0.177) data 0.096 (0.100) loss_x loss_x 0.3621 (0.3928) acc_x 93.7500 (90.6250) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/21] time 0.176 (0.177) data 0.098 (0.100) loss_x loss_x 0.5503 (0.3870) acc_x 87.5000 (90.9375) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/21] time 0.169 (0.174) data 0.093 (0.097) loss_x loss_x 0.1685 (0.4254) acc_x 96.8750 (88.9583) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/21] time 0.188 (0.173) data 0.112 (0.096) loss_x loss_x 0.5317 (0.4615) acc_x 90.6250 (88.4375) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/28] time 0.168 (0.173) data 0.091 (0.096) loss_u loss_u 0.9648 (0.9294) acc_u 3.1250 (6.8750) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/28] time 0.166 (0.172) data 0.089 (0.095) loss_u loss_u 0.9473 (0.9242) acc_u 6.2500 (8.4375) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [15/28] time 0.161 (0.170) data 0.084 (0.093) loss_u loss_u 0.9204 (0.9120) acc_u 9.3750 (9.7917) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [20/28] time 0.179 (0.171) data 0.102 (0.094) loss_u loss_u 0.8989 (0.8990) acc_u 12.5000 (11.4062) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [25/28] time 0.182 (0.172) data 0.105 (0.095) loss_u loss_u 0.8882 (0.9054) acc_u 12.5000 (10.7500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 705
clean true:679
clean false:26
clean_rate:0.9631205673758865
noisy true:550
noisy false:345
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 895
epoch [109/200] batch [5/22] time 0.168 (0.167) data 0.091 (0.090) loss_x loss_x 0.6733 (0.5343) acc_x 87.5000 (88.1250) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [10/22] time 0.176 (0.171) data 0.100 (0.095) loss_x loss_x 0.7651 (0.4776) acc_x 75.0000 (87.1875) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/22] time 0.175 (0.173) data 0.097 (0.096) loss_x loss_x 0.6685 (0.5110) acc_x 87.5000 (87.7083) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/22] time 0.184 (0.177) data 0.106 (0.100) loss_x loss_x 0.6992 (0.4986) acc_x 81.2500 (87.9688) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/27] time 0.178 (0.179) data 0.101 (0.102) loss_u loss_u 0.9541 (0.9152) acc_u 6.2500 (10.0000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/27] time 0.182 (0.179) data 0.106 (0.103) loss_u loss_u 0.9482 (0.9292) acc_u 6.2500 (8.7500) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [15/27] time 0.170 (0.179) data 0.091 (0.102) loss_u loss_u 0.8638 (0.9241) acc_u 12.5000 (8.7500) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [20/27] time 0.170 (0.178) data 0.093 (0.101) loss_u loss_u 0.9263 (0.9218) acc_u 6.2500 (9.0625) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [25/27] time 0.168 (0.177) data 0.090 (0.100) loss_u loss_u 0.8721 (0.9205) acc_u 12.5000 (9.0000) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 695
clean true:672
clean false:23
clean_rate:0.9669064748201439
noisy true:543
noisy false:362
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 905
epoch [110/200] batch [5/21] time 0.182 (0.169) data 0.106 (0.092) loss_x loss_x 0.4219 (0.5671) acc_x 87.5000 (85.6250) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [10/21] time 0.160 (0.168) data 0.084 (0.091) loss_x loss_x 0.5518 (0.6129) acc_x 81.2500 (82.8125) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/21] time 0.174 (0.172) data 0.098 (0.095) loss_x loss_x 0.4973 (0.5608) acc_x 84.3750 (84.5833) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/21] time 0.184 (0.175) data 0.107 (0.099) loss_x loss_x 0.1774 (0.5751) acc_x 96.8750 (85.1562) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/28] time 0.199 (0.183) data 0.122 (0.106) loss_u loss_u 0.8481 (0.9057) acc_u 18.7500 (11.8750) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/28] time 0.173 (0.183) data 0.096 (0.106) loss_u loss_u 0.9365 (0.9131) acc_u 12.5000 (11.2500) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [15/28] time 0.169 (0.182) data 0.093 (0.105) loss_u loss_u 0.9092 (0.9124) acc_u 9.3750 (10.6250) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [20/28] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.8965 (0.9138) acc_u 12.5000 (10.1562) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [25/28] time 0.157 (0.178) data 0.081 (0.101) loss_u loss_u 0.9321 (0.9173) acc_u 9.3750 (9.8750) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.4231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 677
clean true:651
clean false:26
clean_rate:0.9615952732644018
noisy true:558
noisy false:365
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 923
epoch [111/200] batch [5/21] time 0.173 (0.167) data 0.096 (0.091) loss_x loss_x 0.3396 (0.4853) acc_x 90.6250 (86.2500) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [10/21] time 0.167 (0.171) data 0.091 (0.094) loss_x loss_x 0.5811 (0.5057) acc_x 81.2500 (86.2500) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/21] time 0.172 (0.169) data 0.096 (0.092) loss_x loss_x 0.1165 (0.4854) acc_x 100.0000 (86.8750) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/21] time 0.188 (0.173) data 0.112 (0.096) loss_x loss_x 0.2798 (0.4682) acc_x 93.7500 (87.5000) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/28] time 0.178 (0.172) data 0.101 (0.096) loss_u loss_u 0.9062 (0.8531) acc_u 9.3750 (16.8750) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/28] time 0.185 (0.174) data 0.108 (0.098) loss_u loss_u 0.9102 (0.8793) acc_u 9.3750 (14.0625) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [15/28] time 0.166 (0.173) data 0.089 (0.097) loss_u loss_u 0.9131 (0.8883) acc_u 12.5000 (13.1250) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [20/28] time 0.171 (0.174) data 0.094 (0.097) loss_u loss_u 0.8232 (0.8912) acc_u 18.7500 (12.5000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [25/28] time 0.184 (0.173) data 0.107 (0.097) loss_u loss_u 0.8096 (0.8881) acc_u 18.7500 (13.0000) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.4338, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 694
clean true:677
clean false:17
clean_rate:0.9755043227665706
noisy true:560
noisy false:346
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 906
epoch [112/200] batch [5/21] time 0.191 (0.185) data 0.114 (0.109) loss_x loss_x 0.9375 (0.5500) acc_x 75.0000 (83.7500) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [10/21] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.2986 (0.5203) acc_x 96.8750 (85.3125) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/21] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.9497 (0.5707) acc_x 75.0000 (84.5833) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/21] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.2722 (0.5535) acc_x 93.7500 (85.3125) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/28] time 0.183 (0.185) data 0.107 (0.109) loss_u loss_u 0.8789 (0.8789) acc_u 15.6250 (14.3750) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/28] time 0.184 (0.185) data 0.107 (0.109) loss_u loss_u 0.7964 (0.8869) acc_u 21.8750 (13.1250) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [15/28] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.8813 (0.9016) acc_u 12.5000 (11.0417) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [20/28] time 0.188 (0.185) data 0.111 (0.109) loss_u loss_u 0.8726 (0.9041) acc_u 15.6250 (10.7812) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [25/28] time 0.182 (0.185) data 0.105 (0.108) loss_u loss_u 0.9331 (0.9035) acc_u 9.3750 (11.1250) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 704
clean true:681
clean false:23
clean_rate:0.9673295454545454
noisy true:578
noisy false:318
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 896
epoch [113/200] batch [5/22] time 0.169 (0.167) data 0.092 (0.090) loss_x loss_x 0.1283 (0.4207) acc_x 100.0000 (91.8750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/22] time 0.183 (0.174) data 0.105 (0.097) loss_x loss_x 0.3042 (0.4139) acc_x 93.7500 (91.2500) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/22] time 0.172 (0.174) data 0.095 (0.097) loss_x loss_x 0.6133 (0.4058) acc_x 87.5000 (90.6250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/22] time 0.180 (0.175) data 0.104 (0.099) loss_x loss_x 0.8306 (0.4488) acc_x 78.1250 (89.0625) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/28] time 0.170 (0.174) data 0.092 (0.097) loss_u loss_u 0.9683 (0.9180) acc_u 3.1250 (9.3750) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/28] time 0.180 (0.174) data 0.101 (0.097) loss_u loss_u 0.9487 (0.9261) acc_u 3.1250 (8.7500) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [15/28] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.8286 (0.9182) acc_u 18.7500 (9.1667) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/28] time 0.183 (0.177) data 0.107 (0.100) loss_u loss_u 0.9624 (0.9155) acc_u 3.1250 (9.6875) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [25/28] time 0.162 (0.177) data 0.084 (0.100) loss_u loss_u 0.9028 (0.9183) acc_u 12.5000 (9.5000) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 695
clean true:672
clean false:23
clean_rate:0.9669064748201439
noisy true:547
noisy false:358
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 905
epoch [114/200] batch [5/21] time 0.176 (0.182) data 0.100 (0.105) loss_x loss_x 0.2605 (0.5184) acc_x 93.7500 (84.3750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/21] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.2091 (0.4857) acc_x 90.6250 (86.5625) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/21] time 0.181 (0.180) data 0.104 (0.104) loss_x loss_x 0.3777 (0.4650) acc_x 90.6250 (87.5000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/21] time 0.171 (0.180) data 0.095 (0.104) loss_x loss_x 0.6113 (0.4808) acc_x 87.5000 (87.1875) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/28] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.9233 (0.9256) acc_u 9.3750 (10.0000) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/28] time 0.174 (0.178) data 0.096 (0.101) loss_u loss_u 0.9346 (0.9076) acc_u 9.3750 (11.2500) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [15/28] time 0.168 (0.177) data 0.091 (0.101) loss_u loss_u 0.8838 (0.8984) acc_u 12.5000 (11.6667) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/28] time 0.163 (0.176) data 0.085 (0.099) loss_u loss_u 0.8130 (0.8953) acc_u 21.8750 (12.0312) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [25/28] time 0.163 (0.174) data 0.085 (0.097) loss_u loss_u 0.9604 (0.9015) acc_u 3.1250 (11.2500) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 704
clean true:679
clean false:25
clean_rate:0.9644886363636364
noisy true:569
noisy false:327
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 896
epoch [115/200] batch [5/22] time 0.161 (0.171) data 0.085 (0.095) loss_x loss_x 0.5654 (0.5581) acc_x 87.5000 (86.2500) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [10/22] time 0.166 (0.174) data 0.090 (0.097) loss_x loss_x 0.2991 (0.5304) acc_x 90.6250 (85.6250) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/22] time 0.181 (0.175) data 0.104 (0.099) loss_x loss_x 0.4749 (0.4881) acc_x 90.6250 (87.2917) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/22] time 0.175 (0.174) data 0.098 (0.097) loss_x loss_x 0.5532 (0.4646) acc_x 90.6250 (88.5938) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/28] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.8760 (0.9248) acc_u 15.6250 (8.7500) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/28] time 0.184 (0.176) data 0.106 (0.100) loss_u loss_u 0.9072 (0.9055) acc_u 9.3750 (10.6250) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [15/28] time 0.184 (0.176) data 0.107 (0.100) loss_u loss_u 0.9668 (0.9068) acc_u 3.1250 (10.2083) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [20/28] time 0.158 (0.175) data 0.081 (0.099) loss_u loss_u 0.9038 (0.9064) acc_u 9.3750 (10.3125) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [25/28] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.8691 (0.9100) acc_u 12.5000 (10.1250) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 704
clean true:679
clean false:25
clean_rate:0.9644886363636364
noisy true:560
noisy false:336
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 896
epoch [116/200] batch [5/22] time 0.161 (0.163) data 0.086 (0.087) loss_x loss_x 0.3367 (0.4734) acc_x 93.7500 (87.5000) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/22] time 0.171 (0.165) data 0.094 (0.089) loss_x loss_x 0.7261 (0.4733) acc_x 81.2500 (87.8125) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [15/22] time 0.184 (0.170) data 0.108 (0.093) loss_x loss_x 0.3853 (0.4507) acc_x 90.6250 (88.3333) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/22] time 0.167 (0.169) data 0.091 (0.092) loss_x loss_x 0.3875 (0.4841) acc_x 84.3750 (87.8125) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/28] time 0.165 (0.170) data 0.088 (0.094) loss_u loss_u 0.9224 (0.9144) acc_u 12.5000 (11.2500) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/28] time 0.184 (0.173) data 0.107 (0.096) loss_u loss_u 0.9038 (0.9108) acc_u 9.3750 (10.6250) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [15/28] time 0.186 (0.173) data 0.107 (0.096) loss_u loss_u 0.9082 (0.9147) acc_u 9.3750 (9.7917) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [20/28] time 0.162 (0.173) data 0.085 (0.096) loss_u loss_u 0.8950 (0.9052) acc_u 12.5000 (10.7812) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [25/28] time 0.186 (0.173) data 0.109 (0.097) loss_u loss_u 0.8418 (0.9049) acc_u 15.6250 (10.8750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 706
clean true:685
clean false:21
clean_rate:0.9702549575070821
noisy true:563
noisy false:331
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 894
epoch [117/200] batch [5/22] time 0.173 (0.179) data 0.096 (0.103) loss_x loss_x 0.4683 (0.5301) acc_x 87.5000 (85.6250) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/22] time 0.170 (0.176) data 0.094 (0.099) loss_x loss_x 0.6172 (0.5423) acc_x 78.1250 (85.0000) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/22] time 0.187 (0.178) data 0.110 (0.102) loss_x loss_x 0.2788 (0.5491) acc_x 96.8750 (84.5833) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/22] time 0.231 (0.182) data 0.155 (0.106) loss_x loss_x 0.5171 (0.5537) acc_x 84.3750 (84.8438) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/27] time 0.201 (0.183) data 0.124 (0.107) loss_u loss_u 0.9097 (0.9047) acc_u 9.3750 (11.2500) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [10/27] time 0.170 (0.183) data 0.093 (0.106) loss_u loss_u 0.9316 (0.9074) acc_u 9.3750 (11.2500) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [15/27] time 0.177 (0.183) data 0.099 (0.106) loss_u loss_u 0.9160 (0.9159) acc_u 9.3750 (10.0000) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [20/27] time 0.172 (0.181) data 0.095 (0.105) loss_u loss_u 0.8867 (0.9118) acc_u 15.6250 (10.1562) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [25/27] time 0.177 (0.180) data 0.100 (0.103) loss_u loss_u 0.8530 (0.9075) acc_u 15.6250 (10.7500) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 700
clean true:676
clean false:24
clean_rate:0.9657142857142857
noisy true:559
noisy false:341
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 900
epoch [118/200] batch [5/21] time 0.173 (0.170) data 0.097 (0.093) loss_x loss_x 0.4705 (0.5461) acc_x 81.2500 (86.2500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/21] time 0.167 (0.172) data 0.091 (0.096) loss_x loss_x 0.6733 (0.5534) acc_x 78.1250 (84.0625) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [15/21] time 0.172 (0.173) data 0.096 (0.097) loss_x loss_x 0.5269 (0.5842) acc_x 84.3750 (84.3750) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/21] time 0.176 (0.174) data 0.100 (0.097) loss_x loss_x 0.4092 (0.5361) acc_x 84.3750 (85.0000) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/28] time 0.186 (0.176) data 0.108 (0.099) loss_u loss_u 0.8965 (0.8701) acc_u 12.5000 (13.7500) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/28] time 0.181 (0.177) data 0.103 (0.100) loss_u loss_u 0.9541 (0.8857) acc_u 6.2500 (12.8125) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [15/28] time 0.183 (0.178) data 0.107 (0.102) loss_u loss_u 0.9414 (0.8951) acc_u 6.2500 (11.6667) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/28] time 0.188 (0.179) data 0.111 (0.102) loss_u loss_u 0.8853 (0.8943) acc_u 12.5000 (11.8750) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [25/28] time 0.164 (0.178) data 0.087 (0.101) loss_u loss_u 0.9009 (0.8950) acc_u 12.5000 (11.6250) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.4294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 687
clean true:670
clean false:17
clean_rate:0.975254730713246
noisy true:563
noisy false:350
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 913
epoch [119/200] batch [5/21] time 0.185 (0.183) data 0.109 (0.106) loss_x loss_x 0.5288 (0.4444) acc_x 87.5000 (88.7500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/21] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.4805 (0.5318) acc_x 90.6250 (86.5625) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/21] time 0.214 (0.196) data 0.137 (0.119) loss_x loss_x 0.7324 (0.5183) acc_x 81.2500 (86.8750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/21] time 0.179 (0.192) data 0.103 (0.116) loss_x loss_x 0.4785 (0.4821) acc_x 84.3750 (87.6562) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/28] time 0.186 (0.190) data 0.109 (0.113) loss_u loss_u 0.9819 (0.9048) acc_u 3.1250 (11.2500) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/28] time 0.185 (0.189) data 0.108 (0.113) loss_u loss_u 0.8633 (0.9011) acc_u 15.6250 (10.9375) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [15/28] time 0.188 (0.189) data 0.111 (0.112) loss_u loss_u 0.8555 (0.8973) acc_u 15.6250 (11.6667) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [20/28] time 0.170 (0.187) data 0.093 (0.111) loss_u loss_u 0.9365 (0.9080) acc_u 9.3750 (10.3125) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [25/28] time 0.161 (0.185) data 0.083 (0.108) loss_u loss_u 0.8418 (0.8986) acc_u 15.6250 (11.0000) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 696
clean true:677
clean false:19
clean_rate:0.9727011494252874
noisy true:570
noisy false:334
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 904
epoch [120/200] batch [5/21] time 0.198 (0.171) data 0.121 (0.095) loss_x loss_x 0.1442 (0.3870) acc_x 96.8750 (91.2500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/21] time 0.184 (0.172) data 0.108 (0.095) loss_x loss_x 0.4822 (0.3793) acc_x 87.5000 (90.6250) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [15/21] time 0.167 (0.171) data 0.089 (0.094) loss_x loss_x 0.1957 (0.4545) acc_x 93.7500 (88.7500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/21] time 0.184 (0.174) data 0.108 (0.098) loss_x loss_x 0.2152 (0.4706) acc_x 93.7500 (88.2812) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/28] time 0.173 (0.175) data 0.094 (0.098) loss_u loss_u 0.9180 (0.9407) acc_u 12.5000 (6.8750) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/28] time 0.176 (0.175) data 0.097 (0.099) loss_u loss_u 0.8696 (0.9286) acc_u 12.5000 (7.8125) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [15/28] time 0.177 (0.175) data 0.101 (0.098) loss_u loss_u 0.8901 (0.9212) acc_u 12.5000 (8.9583) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [20/28] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.8745 (0.9170) acc_u 15.6250 (9.3750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [25/28] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.9312 (0.9073) acc_u 6.2500 (10.3750) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 697
clean true:676
clean false:21
clean_rate:0.96987087517934
noisy true:548
noisy false:355
after delete: len(clean_dataset) 697
after delete: len(noisy_dataset) 903
epoch [121/200] batch [5/21] time 0.169 (0.175) data 0.093 (0.098) loss_x loss_x 0.5508 (0.5966) acc_x 84.3750 (83.7500) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [10/21] time 0.175 (0.172) data 0.098 (0.095) loss_x loss_x 0.7080 (0.6090) acc_x 81.2500 (84.6875) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [15/21] time 0.179 (0.174) data 0.103 (0.098) loss_x loss_x 0.7246 (0.5788) acc_x 78.1250 (85.2083) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/21] time 0.182 (0.174) data 0.106 (0.098) loss_x loss_x 0.6157 (0.5512) acc_x 84.3750 (86.0938) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/28] time 0.168 (0.175) data 0.092 (0.098) loss_u loss_u 0.9302 (0.9060) acc_u 6.2500 (10.6250) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/28] time 0.182 (0.173) data 0.106 (0.097) loss_u loss_u 0.9727 (0.8970) acc_u 3.1250 (10.9375) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [15/28] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.8716 (0.8904) acc_u 15.6250 (12.0833) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [20/28] time 0.179 (0.176) data 0.101 (0.099) loss_u loss_u 0.9028 (0.9012) acc_u 9.3750 (10.9375) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [25/28] time 0.166 (0.175) data 0.089 (0.099) loss_u loss_u 0.9907 (0.9040) acc_u 0.0000 (10.7500) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.4237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 678
clean true:651
clean false:27
clean_rate:0.9601769911504425
noisy true:565
noisy false:357
after delete: len(clean_dataset) 678
after delete: len(noisy_dataset) 922
epoch [122/200] batch [5/21] time 0.165 (0.180) data 0.089 (0.103) loss_x loss_x 0.3420 (0.3197) acc_x 90.6250 (91.2500) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [10/21] time 0.172 (0.175) data 0.096 (0.098) loss_x loss_x 0.5684 (0.3705) acc_x 87.5000 (90.3125) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [15/21] time 0.178 (0.176) data 0.101 (0.100) loss_x loss_x 0.4158 (0.3949) acc_x 90.6250 (89.1667) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/21] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.2207 (0.3898) acc_x 93.7500 (89.2188) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/28] time 0.189 (0.175) data 0.111 (0.099) loss_u loss_u 0.8560 (0.9027) acc_u 18.7500 (10.6250) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/28] time 0.187 (0.177) data 0.110 (0.100) loss_u loss_u 0.9258 (0.8831) acc_u 6.2500 (13.1250) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [15/28] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.8945 (0.8927) acc_u 12.5000 (12.0833) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [20/28] time 0.176 (0.177) data 0.100 (0.100) loss_u loss_u 0.9062 (0.8948) acc_u 9.3750 (11.5625) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [25/28] time 0.176 (0.177) data 0.099 (0.100) loss_u loss_u 0.8657 (0.8948) acc_u 15.6250 (11.6250) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 698
clean true:677
clean false:21
clean_rate:0.9699140401146131
noisy true:545
noisy false:357
after delete: len(clean_dataset) 698
after delete: len(noisy_dataset) 902
epoch [123/200] batch [5/21] time 0.162 (0.174) data 0.085 (0.098) loss_x loss_x 0.3000 (0.4103) acc_x 96.8750 (91.2500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/21] time 0.193 (0.171) data 0.117 (0.095) loss_x loss_x 0.2072 (0.4564) acc_x 93.7500 (88.4375) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [15/21] time 0.185 (0.176) data 0.109 (0.100) loss_x loss_x 0.3201 (0.4331) acc_x 90.6250 (88.3333) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/21] time 0.167 (0.175) data 0.091 (0.098) loss_x loss_x 0.4175 (0.4581) acc_x 93.7500 (87.9688) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/28] time 0.168 (0.175) data 0.091 (0.099) loss_u loss_u 0.9248 (0.9301) acc_u 9.3750 (7.5000) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/28] time 0.171 (0.175) data 0.094 (0.098) loss_u loss_u 0.8516 (0.9249) acc_u 18.7500 (8.7500) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [15/28] time 0.184 (0.175) data 0.108 (0.098) loss_u loss_u 0.9565 (0.9140) acc_u 6.2500 (10.0000) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [20/28] time 0.166 (0.175) data 0.090 (0.099) loss_u loss_u 0.8970 (0.9102) acc_u 9.3750 (10.3125) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [25/28] time 0.189 (0.175) data 0.111 (0.099) loss_u loss_u 0.8926 (0.9110) acc_u 12.5000 (10.3750) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 358
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 702
clean true:675
clean false:27
clean_rate:0.9615384615384616
noisy true:567
noisy false:331
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 898
epoch [124/200] batch [5/21] time 0.179 (0.183) data 0.103 (0.106) loss_x loss_x 0.3831 (0.5681) acc_x 93.7500 (85.6250) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [10/21] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.2323 (0.5942) acc_x 90.6250 (85.0000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [15/21] time 0.174 (0.178) data 0.098 (0.101) loss_x loss_x 0.8687 (0.5690) acc_x 75.0000 (85.8333) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/21] time 0.181 (0.177) data 0.105 (0.101) loss_x loss_x 0.4419 (0.5460) acc_x 87.5000 (86.7188) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/28] time 0.188 (0.179) data 0.111 (0.102) loss_u loss_u 0.8979 (0.8952) acc_u 15.6250 (13.1250) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/28] time 0.183 (0.180) data 0.107 (0.103) loss_u loss_u 0.9717 (0.9148) acc_u 3.1250 (10.3125) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [15/28] time 0.168 (0.179) data 0.091 (0.103) loss_u loss_u 0.8901 (0.9083) acc_u 12.5000 (11.0417) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [20/28] time 0.167 (0.179) data 0.091 (0.102) loss_u loss_u 0.9111 (0.8999) acc_u 12.5000 (11.7188) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [25/28] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9214 (0.9077) acc_u 9.3750 (10.8750) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.4444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 711
clean true:687
clean false:24
clean_rate:0.9662447257383966
noisy true:546
noisy false:343
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 889
epoch [125/200] batch [5/22] time 0.177 (0.186) data 0.100 (0.109) loss_x loss_x 0.8613 (0.5988) acc_x 78.1250 (85.0000) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/22] time 0.174 (0.181) data 0.098 (0.104) loss_x loss_x 0.4915 (0.5076) acc_x 87.5000 (86.8750) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/22] time 0.180 (0.180) data 0.103 (0.104) loss_x loss_x 0.5122 (0.4897) acc_x 84.3750 (87.5000) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/22] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.2878 (0.4616) acc_x 96.8750 (88.1250) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/27] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.9268 (0.9220) acc_u 12.5000 (10.6250) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/27] time 0.175 (0.178) data 0.099 (0.102) loss_u loss_u 0.8882 (0.9055) acc_u 12.5000 (12.1875) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [15/27] time 0.179 (0.179) data 0.102 (0.102) loss_u loss_u 0.9590 (0.9062) acc_u 3.1250 (11.4583) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/27] time 0.183 (0.179) data 0.107 (0.102) loss_u loss_u 0.9575 (0.9173) acc_u 3.1250 (10.0000) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [25/27] time 0.176 (0.179) data 0.099 (0.102) loss_u loss_u 0.8413 (0.9040) acc_u 15.6250 (11.3750) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 705
clean true:674
clean false:31
clean_rate:0.9560283687943263
noisy true:553
noisy false:342
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 895
epoch [126/200] batch [5/22] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.5815 (0.6072) acc_x 84.3750 (83.7500) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/22] time 0.178 (0.180) data 0.102 (0.104) loss_x loss_x 0.3289 (0.5274) acc_x 87.5000 (86.5625) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/22] time 0.175 (0.180) data 0.098 (0.104) loss_x loss_x 0.4229 (0.4663) acc_x 90.6250 (88.3333) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/22] time 0.185 (0.180) data 0.109 (0.104) loss_x loss_x 0.2612 (0.4980) acc_x 90.6250 (87.1875) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/27] time 0.168 (0.179) data 0.090 (0.103) loss_u loss_u 0.9316 (0.9053) acc_u 6.2500 (11.8750) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/27] time 0.169 (0.177) data 0.092 (0.101) loss_u loss_u 0.9033 (0.9136) acc_u 9.3750 (10.0000) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [15/27] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.8184 (0.9012) acc_u 21.8750 (11.6667) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/27] time 0.202 (0.179) data 0.125 (0.102) loss_u loss_u 0.9580 (0.9032) acc_u 3.1250 (11.4062) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [25/27] time 0.226 (0.181) data 0.150 (0.104) loss_u loss_u 0.9399 (0.9043) acc_u 6.2500 (11.2500) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.4531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 725
clean true:704
clean false:21
clean_rate:0.9710344827586207
noisy true:530
noisy false:345
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 875
epoch [127/200] batch [5/22] time 0.179 (0.184) data 0.103 (0.107) loss_x loss_x 0.2208 (0.4536) acc_x 96.8750 (88.7500) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/22] time 0.172 (0.177) data 0.096 (0.100) loss_x loss_x 0.2153 (0.4590) acc_x 96.8750 (88.7500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/22] time 0.187 (0.175) data 0.111 (0.099) loss_x loss_x 0.3569 (0.4233) acc_x 90.6250 (89.5833) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/22] time 0.184 (0.175) data 0.108 (0.099) loss_x loss_x 0.2542 (0.4343) acc_x 90.6250 (88.9062) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/27] time 0.170 (0.173) data 0.093 (0.097) loss_u loss_u 0.9062 (0.9096) acc_u 9.3750 (10.6250) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/27] time 0.188 (0.172) data 0.111 (0.096) loss_u loss_u 0.9521 (0.9035) acc_u 6.2500 (10.9375) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/27] time 0.165 (0.172) data 0.088 (0.096) loss_u loss_u 0.9453 (0.9094) acc_u 6.2500 (10.4167) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [20/27] time 0.180 (0.172) data 0.103 (0.096) loss_u loss_u 0.9619 (0.9175) acc_u 3.1250 (9.2188) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [25/27] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.9341 (0.9194) acc_u 6.2500 (9.5000) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.4481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 717
clean true:690
clean false:27
clean_rate:0.9623430962343096
noisy true:549
noisy false:334
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 883
epoch [128/200] batch [5/22] time 0.158 (0.179) data 0.082 (0.103) loss_x loss_x 0.2578 (0.4876) acc_x 96.8750 (88.1250) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/22] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.3022 (0.4199) acc_x 90.6250 (90.0000) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/22] time 0.185 (0.180) data 0.109 (0.104) loss_x loss_x 0.5254 (0.4456) acc_x 87.5000 (88.9583) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/22] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.4263 (0.4724) acc_x 90.6250 (87.6562) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/27] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9121 (0.9040) acc_u 12.5000 (10.6250) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/27] time 0.184 (0.182) data 0.108 (0.106) loss_u loss_u 0.8843 (0.8977) acc_u 12.5000 (11.8750) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [15/27] time 0.192 (0.183) data 0.116 (0.106) loss_u loss_u 0.9141 (0.9063) acc_u 9.3750 (10.6250) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [20/27] time 0.174 (0.182) data 0.097 (0.106) loss_u loss_u 0.9316 (0.9067) acc_u 9.3750 (10.6250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [25/27] time 0.168 (0.182) data 0.092 (0.105) loss_u loss_u 0.8750 (0.9142) acc_u 12.5000 (9.6250) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.4450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 712
clean true:690
clean false:22
clean_rate:0.9691011235955056
noisy true:550
noisy false:338
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 888
epoch [129/200] batch [5/22] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.2952 (0.3027) acc_x 93.7500 (93.1250) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/22] time 0.183 (0.180) data 0.107 (0.103) loss_x loss_x 0.4978 (0.4522) acc_x 90.6250 (90.3125) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/22] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.4773 (0.4734) acc_x 90.6250 (88.9583) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/22] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.5396 (0.4445) acc_x 90.6250 (90.1562) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/27] time 0.168 (0.179) data 0.091 (0.102) loss_u loss_u 0.8794 (0.9042) acc_u 15.6250 (11.2500) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/27] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8555 (0.9024) acc_u 18.7500 (11.5625) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [15/27] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.8823 (0.9106) acc_u 12.5000 (10.6250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [20/27] time 0.162 (0.176) data 0.084 (0.100) loss_u loss_u 0.8862 (0.9135) acc_u 12.5000 (10.4688) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [25/27] time 0.164 (0.175) data 0.087 (0.098) loss_u loss_u 0.9399 (0.9152) acc_u 6.2500 (10.1250) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 338
confident_label rate tensor(0.4519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 723
clean true:699
clean false:24
clean_rate:0.966804979253112
noisy true:563
noisy false:314
after delete: len(clean_dataset) 723
after delete: len(noisy_dataset) 877
epoch [130/200] batch [5/22] time 0.174 (0.179) data 0.097 (0.102) loss_x loss_x 0.1768 (0.3540) acc_x 96.8750 (91.2500) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/22] time 0.175 (0.174) data 0.098 (0.098) loss_x loss_x 0.3640 (0.4299) acc_x 90.6250 (89.3750) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/22] time 0.183 (0.177) data 0.105 (0.100) loss_x loss_x 0.5220 (0.4464) acc_x 84.3750 (88.5417) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/22] time 0.168 (0.176) data 0.092 (0.100) loss_x loss_x 0.8940 (0.4590) acc_x 81.2500 (88.2812) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/27] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.8643 (0.9157) acc_u 15.6250 (9.3750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/27] time 0.186 (0.176) data 0.109 (0.100) loss_u loss_u 0.9683 (0.9359) acc_u 0.0000 (6.2500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/27] time 0.161 (0.176) data 0.084 (0.099) loss_u loss_u 0.9482 (0.9262) acc_u 6.2500 (7.7083) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [20/27] time 0.185 (0.176) data 0.109 (0.099) loss_u loss_u 0.9692 (0.9251) acc_u 3.1250 (7.9688) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [25/27] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.9180 (0.9225) acc_u 9.3750 (8.5000) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.4481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 717
clean true:693
clean false:24
clean_rate:0.9665271966527197
noisy true:543
noisy false:340
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 883
epoch [131/200] batch [5/22] time 0.171 (0.170) data 0.095 (0.093) loss_x loss_x 0.1112 (0.2725) acc_x 96.8750 (91.8750) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/22] time 0.164 (0.166) data 0.087 (0.089) loss_x loss_x 0.5625 (0.3840) acc_x 84.3750 (89.0625) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [15/22] time 0.171 (0.167) data 0.095 (0.090) loss_x loss_x 0.4861 (0.4129) acc_x 87.5000 (89.1667) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/22] time 0.183 (0.170) data 0.107 (0.094) loss_x loss_x 0.8364 (0.4321) acc_x 84.3750 (89.3750) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/27] time 0.184 (0.174) data 0.108 (0.097) loss_u loss_u 0.9629 (0.9193) acc_u 6.2500 (10.0000) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/27] time 0.182 (0.175) data 0.104 (0.099) loss_u loss_u 0.9722 (0.9150) acc_u 3.1250 (9.6875) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/27] time 0.168 (0.175) data 0.090 (0.098) loss_u loss_u 0.8647 (0.9069) acc_u 18.7500 (10.6250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/27] time 0.177 (0.175) data 0.101 (0.098) loss_u loss_u 0.9062 (0.9109) acc_u 9.3750 (10.3125) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [25/27] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.9277 (0.9138) acc_u 9.3750 (9.8750) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 705
clean true:679
clean false:26
clean_rate:0.9631205673758865
noisy true:556
noisy false:339
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 895
epoch [132/200] batch [5/22] time 0.161 (0.161) data 0.085 (0.085) loss_x loss_x 0.3696 (0.6434) acc_x 87.5000 (84.3750) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/22] time 0.163 (0.162) data 0.086 (0.085) loss_x loss_x 0.5215 (0.6523) acc_x 81.2500 (82.8125) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/22] time 0.179 (0.163) data 0.104 (0.086) loss_x loss_x 0.5635 (0.6165) acc_x 84.3750 (83.9583) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/22] time 0.178 (0.169) data 0.102 (0.093) loss_x loss_x 0.4663 (0.6158) acc_x 90.6250 (83.7500) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/27] time 0.181 (0.173) data 0.103 (0.096) loss_u loss_u 0.8003 (0.8712) acc_u 25.0000 (14.3750) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/27] time 0.172 (0.173) data 0.095 (0.096) loss_u loss_u 0.9668 (0.9041) acc_u 3.1250 (11.2500) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/27] time 0.172 (0.172) data 0.095 (0.096) loss_u loss_u 0.9043 (0.8935) acc_u 9.3750 (12.2917) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [20/27] time 0.183 (0.172) data 0.106 (0.096) loss_u loss_u 0.8398 (0.8992) acc_u 18.7500 (11.5625) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [25/27] time 0.168 (0.173) data 0.090 (0.096) loss_u loss_u 0.9277 (0.8974) acc_u 6.2500 (11.6250) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.4469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 715
clean true:694
clean false:21
clean_rate:0.9706293706293706
noisy true:554
noisy false:331
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 885
epoch [133/200] batch [5/22] time 0.165 (0.164) data 0.089 (0.088) loss_x loss_x 0.2515 (0.6690) acc_x 90.6250 (81.8750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/22] time 0.173 (0.167) data 0.097 (0.091) loss_x loss_x 0.6201 (0.5707) acc_x 81.2500 (85.6250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/22] time 0.164 (0.168) data 0.088 (0.092) loss_x loss_x 0.7461 (0.5968) acc_x 81.2500 (84.3750) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/22] time 0.176 (0.172) data 0.099 (0.096) loss_x loss_x 0.2939 (0.5420) acc_x 96.8750 (86.4062) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/27] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.8662 (0.8967) acc_u 15.6250 (11.8750) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/27] time 0.169 (0.179) data 0.092 (0.103) loss_u loss_u 0.9043 (0.9136) acc_u 12.5000 (10.3125) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [15/27] time 0.159 (0.177) data 0.082 (0.101) loss_u loss_u 0.9189 (0.9072) acc_u 9.3750 (11.0417) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/27] time 0.165 (0.177) data 0.088 (0.100) loss_u loss_u 0.9321 (0.9101) acc_u 6.2500 (10.6250) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [25/27] time 0.175 (0.177) data 0.098 (0.101) loss_u loss_u 0.9004 (0.9116) acc_u 9.3750 (10.2500) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 711
clean true:682
clean false:29
clean_rate:0.9592123769338959
noisy true:538
noisy false:351
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 889
epoch [134/200] batch [5/22] time 0.194 (0.168) data 0.118 (0.092) loss_x loss_x 0.4705 (0.6099) acc_x 90.6250 (85.6250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/22] time 0.186 (0.176) data 0.109 (0.100) loss_x loss_x 0.1432 (0.4937) acc_x 96.8750 (88.7500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/22] time 0.183 (0.180) data 0.105 (0.103) loss_x loss_x 0.4822 (0.4781) acc_x 87.5000 (88.7500) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/22] time 0.183 (0.180) data 0.107 (0.104) loss_x loss_x 0.3225 (0.4571) acc_x 93.7500 (89.2188) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/27] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.9087 (0.8874) acc_u 12.5000 (15.0000) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/27] time 0.173 (0.177) data 0.095 (0.101) loss_u loss_u 0.9546 (0.8988) acc_u 3.1250 (12.1875) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [15/27] time 0.169 (0.176) data 0.092 (0.100) loss_u loss_u 0.9424 (0.9044) acc_u 6.2500 (11.2500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/27] time 0.166 (0.175) data 0.090 (0.099) loss_u loss_u 0.8521 (0.9044) acc_u 15.6250 (10.9375) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [25/27] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.9570 (0.9130) acc_u 6.2500 (9.8750) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 704
clean true:677
clean false:27
clean_rate:0.9616477272727273
noisy true:560
noisy false:336
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 896
epoch [135/200] batch [5/22] time 0.178 (0.175) data 0.101 (0.099) loss_x loss_x 0.3752 (0.4190) acc_x 90.6250 (89.3750) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [10/22] time 0.188 (0.178) data 0.111 (0.102) loss_x loss_x 0.4819 (0.4881) acc_x 90.6250 (88.1250) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/22] time 0.173 (0.179) data 0.097 (0.102) loss_x loss_x 0.4839 (0.4341) acc_x 81.2500 (89.3750) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/22] time 0.165 (0.175) data 0.089 (0.098) loss_x loss_x 0.2720 (0.4359) acc_x 87.5000 (89.0625) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/28] time 0.186 (0.172) data 0.109 (0.096) loss_u loss_u 0.9473 (0.8942) acc_u 6.2500 (10.6250) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/28] time 0.181 (0.174) data 0.104 (0.097) loss_u loss_u 0.9316 (0.8997) acc_u 9.3750 (10.9375) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [15/28] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.9658 (0.9140) acc_u 6.2500 (9.7917) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [20/28] time 0.183 (0.174) data 0.107 (0.097) loss_u loss_u 0.9683 (0.9132) acc_u 0.0000 (9.5312) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [25/28] time 0.189 (0.176) data 0.112 (0.099) loss_u loss_u 0.9663 (0.9108) acc_u 3.1250 (9.8750) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.4331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 693
clean true:667
clean false:26
clean_rate:0.9624819624819625
noisy true:560
noisy false:347
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 907
epoch [136/200] batch [5/21] time 0.161 (0.163) data 0.084 (0.086) loss_x loss_x 0.3555 (0.3902) acc_x 90.6250 (90.6250) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [10/21] time 0.165 (0.164) data 0.089 (0.087) loss_x loss_x 0.3665 (0.4086) acc_x 87.5000 (89.6875) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [15/21] time 0.172 (0.167) data 0.095 (0.091) loss_x loss_x 0.5811 (0.4465) acc_x 84.3750 (88.5417) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/21] time 0.170 (0.168) data 0.093 (0.092) loss_x loss_x 0.6650 (0.4738) acc_x 87.5000 (88.5938) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/28] time 0.168 (0.169) data 0.091 (0.092) loss_u loss_u 0.7754 (0.8962) acc_u 25.0000 (11.2500) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/28] time 0.173 (0.169) data 0.095 (0.092) loss_u loss_u 0.8413 (0.8964) acc_u 21.8750 (11.8750) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [15/28] time 0.186 (0.170) data 0.109 (0.093) loss_u loss_u 0.9673 (0.9003) acc_u 3.1250 (11.6667) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/28] time 0.186 (0.172) data 0.108 (0.095) loss_u loss_u 0.9053 (0.9001) acc_u 9.3750 (12.0312) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [25/28] time 0.182 (0.173) data 0.105 (0.096) loss_u loss_u 0.9253 (0.8984) acc_u 9.3750 (12.1250) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 711
clean true:683
clean false:28
clean_rate:0.960618846694796
noisy true:548
noisy false:341
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 889
epoch [137/200] batch [5/22] time 0.167 (0.182) data 0.090 (0.106) loss_x loss_x 0.4722 (0.3667) acc_x 87.5000 (91.2500) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/22] time 0.161 (0.172) data 0.084 (0.095) loss_x loss_x 0.4399 (0.3573) acc_x 90.6250 (90.9375) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/22] time 0.182 (0.172) data 0.106 (0.096) loss_x loss_x 0.4302 (0.4029) acc_x 87.5000 (89.7917) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/22] time 0.183 (0.175) data 0.107 (0.099) loss_x loss_x 0.8892 (0.4515) acc_x 75.0000 (88.1250) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/27] time 0.185 (0.178) data 0.107 (0.102) loss_u loss_u 0.9429 (0.8839) acc_u 6.2500 (13.7500) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/27] time 0.160 (0.179) data 0.083 (0.103) loss_u loss_u 0.9492 (0.9041) acc_u 6.2500 (11.2500) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [15/27] time 0.171 (0.178) data 0.095 (0.102) loss_u loss_u 0.8057 (0.9035) acc_u 21.8750 (11.0417) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [20/27] time 0.171 (0.178) data 0.095 (0.101) loss_u loss_u 0.9019 (0.9013) acc_u 12.5000 (11.5625) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [25/27] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.8979 (0.9038) acc_u 15.6250 (11.3750) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.4481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 717
clean true:694
clean false:23
clean_rate:0.9679218967921897
noisy true:543
noisy false:340
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 883
epoch [138/200] batch [5/22] time 0.179 (0.183) data 0.101 (0.106) loss_x loss_x 0.5522 (0.5946) acc_x 84.3750 (84.3750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/22] time 0.176 (0.175) data 0.100 (0.098) loss_x loss_x 0.4878 (0.5445) acc_x 87.5000 (85.6250) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/22] time 0.187 (0.176) data 0.111 (0.099) loss_x loss_x 0.7349 (0.5320) acc_x 81.2500 (86.6667) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/22] time 0.175 (0.175) data 0.099 (0.099) loss_x loss_x 0.7402 (0.5301) acc_x 81.2500 (86.5625) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/27] time 0.185 (0.177) data 0.108 (0.101) loss_u loss_u 0.9170 (0.9429) acc_u 9.3750 (6.2500) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/27] time 0.173 (0.178) data 0.095 (0.101) loss_u loss_u 0.9116 (0.9098) acc_u 9.3750 (10.9375) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [15/27] time 0.164 (0.177) data 0.087 (0.100) loss_u loss_u 0.9956 (0.9188) acc_u 0.0000 (9.5833) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [20/27] time 0.191 (0.177) data 0.114 (0.100) loss_u loss_u 0.9263 (0.9187) acc_u 9.3750 (9.5312) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [25/27] time 0.169 (0.177) data 0.093 (0.100) loss_u loss_u 0.9619 (0.9203) acc_u 3.1250 (9.3750) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 333
confident_label rate tensor(0.4512, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 722
clean true:693
clean false:29
clean_rate:0.9598337950138505
noisy true:574
noisy false:304
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 878
epoch [139/200] batch [5/22] time 0.179 (0.181) data 0.103 (0.104) loss_x loss_x 0.3965 (0.4611) acc_x 93.7500 (88.1250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/22] time 0.174 (0.173) data 0.098 (0.096) loss_x loss_x 0.3403 (0.4665) acc_x 84.3750 (85.9375) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/22] time 0.164 (0.171) data 0.088 (0.095) loss_x loss_x 0.1681 (0.4227) acc_x 100.0000 (88.5417) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/22] time 0.167 (0.169) data 0.090 (0.093) loss_x loss_x 0.2303 (0.4446) acc_x 90.6250 (88.9062) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/27] time 0.181 (0.169) data 0.104 (0.092) loss_u loss_u 0.8081 (0.8786) acc_u 21.8750 (13.7500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/27] time 0.189 (0.172) data 0.110 (0.095) loss_u loss_u 0.9805 (0.8991) acc_u 3.1250 (11.5625) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/27] time 0.175 (0.173) data 0.098 (0.096) loss_u loss_u 0.9590 (0.9134) acc_u 3.1250 (10.0000) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [20/27] time 0.188 (0.173) data 0.111 (0.096) loss_u loss_u 0.9263 (0.9194) acc_u 9.3750 (9.2188) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [25/27] time 0.172 (0.173) data 0.095 (0.096) loss_u loss_u 0.9258 (0.9178) acc_u 6.2500 (9.2500) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.4481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 717
clean true:691
clean false:26
clean_rate:0.9637377963737797
noisy true:531
noisy false:352
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 883
epoch [140/200] batch [5/22] time 0.159 (0.166) data 0.082 (0.089) loss_x loss_x 0.8682 (0.5316) acc_x 84.3750 (87.5000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/22] time 0.178 (0.170) data 0.102 (0.093) loss_x loss_x 0.5503 (0.5029) acc_x 90.6250 (87.8125) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/22] time 0.178 (0.172) data 0.102 (0.095) loss_x loss_x 0.4739 (0.4310) acc_x 90.6250 (89.3750) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/22] time 0.171 (0.172) data 0.094 (0.096) loss_x loss_x 0.9854 (0.4387) acc_x 78.1250 (89.3750) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/27] time 0.182 (0.174) data 0.103 (0.097) loss_u loss_u 0.9399 (0.8927) acc_u 6.2500 (11.2500) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/27] time 0.168 (0.174) data 0.091 (0.097) loss_u loss_u 0.9302 (0.9027) acc_u 6.2500 (10.0000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/27] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.8828 (0.8923) acc_u 12.5000 (11.0417) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/27] time 0.163 (0.174) data 0.086 (0.097) loss_u loss_u 0.9619 (0.9004) acc_u 3.1250 (9.8438) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [25/27] time 0.167 (0.174) data 0.090 (0.097) loss_u loss_u 0.8979 (0.9102) acc_u 9.3750 (8.8750) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 712
clean true:682
clean false:30
clean_rate:0.9578651685393258
noisy true:549
noisy false:339
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 888
epoch [141/200] batch [5/22] time 0.174 (0.166) data 0.098 (0.090) loss_x loss_x 0.8589 (0.5608) acc_x 84.3750 (87.5000) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [10/22] time 0.177 (0.173) data 0.101 (0.097) loss_x loss_x 0.7422 (0.5034) acc_x 81.2500 (88.4375) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/22] time 0.161 (0.173) data 0.085 (0.096) loss_x loss_x 0.4971 (0.5192) acc_x 87.5000 (87.5000) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/22] time 0.170 (0.171) data 0.094 (0.095) loss_x loss_x 0.5542 (0.5343) acc_x 81.2500 (86.7188) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/27] time 0.179 (0.172) data 0.102 (0.096) loss_u loss_u 0.9233 (0.9325) acc_u 9.3750 (7.5000) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/27] time 0.174 (0.173) data 0.097 (0.096) loss_u loss_u 0.9131 (0.9322) acc_u 12.5000 (8.1250) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/27] time 0.213 (0.174) data 0.137 (0.097) loss_u loss_u 0.9438 (0.9230) acc_u 6.2500 (8.7500) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [20/27] time 0.186 (0.175) data 0.110 (0.098) loss_u loss_u 0.8350 (0.9108) acc_u 18.7500 (10.1562) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [25/27] time 0.183 (0.176) data 0.107 (0.100) loss_u loss_u 0.9199 (0.9077) acc_u 9.3750 (10.5000) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 714
clean true:687
clean false:27
clean_rate:0.9621848739495799
noisy true:553
noisy false:333
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 886
epoch [142/200] batch [5/22] time 0.163 (0.178) data 0.087 (0.102) loss_x loss_x 0.5591 (0.4457) acc_x 84.3750 (88.7500) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/22] time 0.173 (0.171) data 0.097 (0.095) loss_x loss_x 0.5161 (0.5344) acc_x 87.5000 (87.1875) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/22] time 0.184 (0.175) data 0.109 (0.098) loss_x loss_x 0.5547 (0.5688) acc_x 87.5000 (86.0417) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/22] time 0.182 (0.177) data 0.106 (0.101) loss_x loss_x 0.3806 (0.5516) acc_x 87.5000 (86.0938) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/27] time 0.165 (0.176) data 0.088 (0.100) loss_u loss_u 0.9692 (0.9224) acc_u 3.1250 (8.1250) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/27] time 0.168 (0.175) data 0.092 (0.098) loss_u loss_u 0.8818 (0.9167) acc_u 12.5000 (9.3750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/27] time 0.175 (0.175) data 0.099 (0.098) loss_u loss_u 0.9707 (0.9110) acc_u 3.1250 (9.7917) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [20/27] time 0.170 (0.175) data 0.092 (0.098) loss_u loss_u 0.9668 (0.9099) acc_u 3.1250 (9.6875) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [25/27] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.9414 (0.9086) acc_u 6.2500 (10.1250) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.4525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 724
clean true:696
clean false:28
clean_rate:0.9613259668508287
noisy true:537
noisy false:339
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 876
epoch [143/200] batch [5/22] time 0.186 (0.182) data 0.110 (0.105) loss_x loss_x 0.5015 (0.4793) acc_x 90.6250 (90.0000) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/22] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 0.3154 (0.4308) acc_x 90.6250 (90.6250) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/22] time 0.187 (0.179) data 0.111 (0.103) loss_x loss_x 0.7891 (0.4726) acc_x 87.5000 (88.9583) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/22] time 0.170 (0.177) data 0.094 (0.101) loss_x loss_x 0.3708 (0.4688) acc_x 93.7500 (89.0625) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/27] time 0.176 (0.176) data 0.100 (0.099) loss_u loss_u 0.8452 (0.8731) acc_u 18.7500 (15.6250) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/27] time 0.169 (0.175) data 0.093 (0.098) loss_u loss_u 0.9189 (0.8967) acc_u 9.3750 (13.1250) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/27] time 0.165 (0.175) data 0.088 (0.098) loss_u loss_u 0.9717 (0.9103) acc_u 3.1250 (11.6667) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/27] time 0.165 (0.174) data 0.088 (0.097) loss_u loss_u 0.9067 (0.9093) acc_u 9.3750 (11.2500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [25/27] time 0.173 (0.173) data 0.097 (0.097) loss_u loss_u 0.9810 (0.9139) acc_u 3.1250 (10.6250) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 692
clean true:669
clean false:23
clean_rate:0.9667630057803468
noisy true:555
noisy false:353
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 908
epoch [144/200] batch [5/21] time 0.160 (0.168) data 0.083 (0.091) loss_x loss_x 0.1315 (0.2941) acc_x 96.8750 (91.8750) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/21] time 0.169 (0.169) data 0.093 (0.092) loss_x loss_x 0.2319 (0.3210) acc_x 93.7500 (90.9375) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [15/21] time 0.187 (0.172) data 0.111 (0.096) loss_x loss_x 0.4858 (0.3307) acc_x 90.6250 (91.4583) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/21] time 0.168 (0.174) data 0.092 (0.098) loss_x loss_x 0.6636 (0.3964) acc_x 84.3750 (89.8438) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/28] time 0.172 (0.174) data 0.096 (0.097) loss_u loss_u 0.9951 (0.9005) acc_u 0.0000 (11.2500) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/28] time 0.184 (0.174) data 0.107 (0.098) loss_u loss_u 0.9072 (0.8987) acc_u 9.3750 (11.2500) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/28] time 0.172 (0.173) data 0.095 (0.097) loss_u loss_u 0.8989 (0.8995) acc_u 12.5000 (11.2500) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [20/28] time 0.167 (0.173) data 0.090 (0.096) loss_u loss_u 0.8027 (0.9008) acc_u 21.8750 (11.2500) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [25/28] time 0.166 (0.173) data 0.089 (0.096) loss_u loss_u 0.9150 (0.9019) acc_u 9.3750 (11.1250) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.4444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 711
clean true:684
clean false:27
clean_rate:0.9620253164556962
noisy true:555
noisy false:334
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 889
epoch [145/200] batch [5/22] time 0.167 (0.177) data 0.091 (0.100) loss_x loss_x 0.2454 (0.5086) acc_x 96.8750 (87.5000) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/22] time 0.190 (0.177) data 0.113 (0.100) loss_x loss_x 0.6309 (0.4863) acc_x 84.3750 (86.8750) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/22] time 0.176 (0.178) data 0.100 (0.101) loss_x loss_x 0.5908 (0.5191) acc_x 87.5000 (86.8750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/22] time 0.179 (0.175) data 0.103 (0.099) loss_x loss_x 0.4124 (0.5063) acc_x 93.7500 (87.0312) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/27] time 0.170 (0.174) data 0.094 (0.098) loss_u loss_u 0.9209 (0.9138) acc_u 9.3750 (10.0000) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/27] time 0.166 (0.173) data 0.088 (0.097) loss_u loss_u 0.9131 (0.9057) acc_u 9.3750 (10.9375) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/27] time 0.169 (0.172) data 0.093 (0.096) loss_u loss_u 0.8340 (0.8918) acc_u 18.7500 (12.9167) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/27] time 0.194 (0.173) data 0.118 (0.097) loss_u loss_u 0.9526 (0.8991) acc_u 6.2500 (11.7188) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [25/27] time 0.177 (0.174) data 0.099 (0.098) loss_u loss_u 0.9087 (0.9049) acc_u 9.3750 (11.0000) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.4475, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 716
clean true:685
clean false:31
clean_rate:0.9567039106145251
noisy true:559
noisy false:325
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 884
epoch [146/200] batch [5/22] time 0.171 (0.178) data 0.095 (0.102) loss_x loss_x 0.7769 (0.5200) acc_x 81.2500 (87.5000) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/22] time 0.176 (0.177) data 0.100 (0.100) loss_x loss_x 0.6367 (0.5292) acc_x 78.1250 (86.2500) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/22] time 0.168 (0.180) data 0.092 (0.103) loss_x loss_x 0.1890 (0.5425) acc_x 93.7500 (85.8333) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/22] time 0.180 (0.179) data 0.104 (0.102) loss_x loss_x 0.3875 (0.5084) acc_x 87.5000 (86.7188) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/27] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.9155 (0.9112) acc_u 9.3750 (10.0000) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/27] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.9170 (0.9024) acc_u 12.5000 (11.2500) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/27] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.9272 (0.9001) acc_u 6.2500 (11.0417) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/27] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.9404 (0.9062) acc_u 6.2500 (10.3125) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [25/27] time 0.180 (0.182) data 0.103 (0.104) loss_u loss_u 0.9614 (0.9100) acc_u 6.2500 (10.0000) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 358
confident_label rate tensor(0.4550, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 728
clean true:700
clean false:28
clean_rate:0.9615384615384616
noisy true:542
noisy false:330
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 872
epoch [147/200] batch [5/22] time 0.160 (0.177) data 0.083 (0.100) loss_x loss_x 0.7598 (0.4363) acc_x 84.3750 (91.8750) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/22] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.4348 (0.4318) acc_x 84.3750 (90.3125) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/22] time 0.183 (0.179) data 0.107 (0.102) loss_x loss_x 0.7021 (0.4288) acc_x 78.1250 (90.0000) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/22] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.6797 (0.4295) acc_x 81.2500 (89.3750) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/27] time 0.186 (0.183) data 0.109 (0.107) loss_u loss_u 0.9316 (0.9278) acc_u 6.2500 (8.7500) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/27] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8442 (0.9087) acc_u 15.6250 (10.6250) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/27] time 0.170 (0.183) data 0.093 (0.106) loss_u loss_u 0.8354 (0.9151) acc_u 18.7500 (9.5833) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [20/27] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.9653 (0.9252) acc_u 3.1250 (8.5938) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [25/27] time 0.179 (0.181) data 0.102 (0.105) loss_u loss_u 0.9087 (0.9174) acc_u 9.3750 (9.2500) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 695
clean true:668
clean false:27
clean_rate:0.9611510791366906
noisy true:558
noisy false:347
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 905
epoch [148/200] batch [5/21] time 0.166 (0.172) data 0.089 (0.096) loss_x loss_x 0.3713 (0.5703) acc_x 90.6250 (85.0000) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [10/21] time 0.175 (0.173) data 0.099 (0.097) loss_x loss_x 0.5918 (0.5612) acc_x 84.3750 (83.7500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [15/21] time 0.170 (0.171) data 0.094 (0.094) loss_x loss_x 0.3428 (0.5016) acc_x 90.6250 (85.4167) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/21] time 0.171 (0.172) data 0.094 (0.095) loss_x loss_x 0.5156 (0.4960) acc_x 87.5000 (86.4062) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/28] time 0.165 (0.171) data 0.088 (0.094) loss_u loss_u 0.9614 (0.9215) acc_u 6.2500 (8.7500) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/28] time 0.184 (0.173) data 0.107 (0.096) loss_u loss_u 0.9160 (0.9218) acc_u 9.3750 (9.3750) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [15/28] time 0.163 (0.172) data 0.087 (0.095) loss_u loss_u 0.9131 (0.9170) acc_u 9.3750 (9.5833) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/28] time 0.166 (0.172) data 0.090 (0.095) loss_u loss_u 0.8369 (0.9082) acc_u 18.7500 (10.4688) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [25/28] time 0.185 (0.173) data 0.109 (0.096) loss_u loss_u 0.8184 (0.8964) acc_u 18.7500 (11.7500) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 710
clean true:681
clean false:29
clean_rate:0.9591549295774648
noisy true:552
noisy false:338
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 890
epoch [149/200] batch [5/22] time 0.179 (0.181) data 0.102 (0.105) loss_x loss_x 0.2703 (0.3566) acc_x 93.7500 (91.8750) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/22] time 0.179 (0.179) data 0.103 (0.103) loss_x loss_x 0.5981 (0.4803) acc_x 84.3750 (88.1250) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/22] time 0.180 (0.179) data 0.104 (0.103) loss_x loss_x 0.4932 (0.5062) acc_x 90.6250 (87.0833) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/22] time 0.177 (0.179) data 0.101 (0.102) loss_x loss_x 0.3911 (0.4785) acc_x 93.7500 (88.4375) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/27] time 0.176 (0.178) data 0.100 (0.102) loss_u loss_u 0.8398 (0.8634) acc_u 18.7500 (15.0000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/27] time 0.191 (0.179) data 0.114 (0.103) loss_u loss_u 0.9062 (0.8846) acc_u 9.3750 (12.1875) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [15/27] time 0.186 (0.179) data 0.108 (0.103) loss_u loss_u 0.8887 (0.8877) acc_u 15.6250 (12.2917) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/27] time 0.166 (0.180) data 0.090 (0.104) loss_u loss_u 0.9463 (0.8966) acc_u 6.2500 (11.4062) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [25/27] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.8853 (0.8969) acc_u 15.6250 (11.7500) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.4556, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 729
clean true:705
clean false:24
clean_rate:0.9670781893004116
noisy true:547
noisy false:324
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 871
epoch [150/200] batch [5/22] time 0.161 (0.172) data 0.084 (0.095) loss_x loss_x 0.3569 (0.4927) acc_x 93.7500 (88.1250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/22] time 0.178 (0.172) data 0.102 (0.095) loss_x loss_x 0.5449 (0.4493) acc_x 78.1250 (87.5000) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/22] time 0.180 (0.177) data 0.104 (0.101) loss_x loss_x 0.4299 (0.4443) acc_x 87.5000 (87.7083) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/22] time 0.182 (0.178) data 0.106 (0.102) loss_x loss_x 0.4419 (0.4495) acc_x 87.5000 (87.9688) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/27] time 0.182 (0.180) data 0.104 (0.103) loss_u loss_u 0.9409 (0.9276) acc_u 6.2500 (8.7500) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/27] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9253 (0.9183) acc_u 9.3750 (9.6875) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [15/27] time 0.176 (0.181) data 0.100 (0.104) loss_u loss_u 0.9448 (0.9291) acc_u 3.1250 (8.1250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [20/27] time 0.182 (0.181) data 0.106 (0.104) loss_u loss_u 0.8418 (0.9225) acc_u 18.7500 (8.7500) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [25/27] time 0.183 (0.181) data 0.107 (0.105) loss_u loss_u 0.8857 (0.9275) acc_u 12.5000 (8.2500) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 313
confident_label rate tensor(0.4600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 736
clean true:706
clean false:30
clean_rate:0.9592391304347826
noisy true:581
noisy false:283
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 864
epoch [151/200] batch [5/23] time 0.172 (0.180) data 0.096 (0.104) loss_x loss_x 0.2651 (0.3580) acc_x 93.7500 (91.2500) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/23] time 0.164 (0.173) data 0.087 (0.096) loss_x loss_x 0.5518 (0.4516) acc_x 81.2500 (88.4375) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/23] time 0.172 (0.170) data 0.096 (0.094) loss_x loss_x 0.5103 (0.4588) acc_x 81.2500 (88.3333) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/23] time 0.164 (0.170) data 0.087 (0.094) loss_x loss_x 0.6616 (0.4658) acc_x 81.2500 (88.1250) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/27] time 0.168 (0.172) data 0.091 (0.095) loss_u loss_u 0.9761 (0.9406) acc_u 3.1250 (5.6250) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/27] time 0.186 (0.174) data 0.110 (0.097) loss_u loss_u 0.9253 (0.9367) acc_u 9.3750 (6.5625) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/27] time 0.186 (0.175) data 0.109 (0.099) loss_u loss_u 0.9126 (0.9319) acc_u 12.5000 (7.7083) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [20/27] time 0.181 (0.176) data 0.104 (0.100) loss_u loss_u 0.9390 (0.9229) acc_u 9.3750 (8.7500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [25/27] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9644 (0.9237) acc_u 3.1250 (8.7500) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.4506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 721
clean true:692
clean false:29
clean_rate:0.9597780859916782
noisy true:558
noisy false:321
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 879
epoch [152/200] batch [5/22] time 0.158 (0.180) data 0.082 (0.103) loss_x loss_x 0.7070 (0.4056) acc_x 81.2500 (88.7500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/22] time 0.166 (0.175) data 0.090 (0.099) loss_x loss_x 0.3892 (0.4028) acc_x 96.8750 (90.6250) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/22] time 0.176 (0.173) data 0.100 (0.097) loss_x loss_x 0.4592 (0.4100) acc_x 87.5000 (89.7917) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/22] time 0.162 (0.174) data 0.086 (0.097) loss_x loss_x 0.3074 (0.4155) acc_x 93.7500 (89.6875) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/27] time 0.181 (0.174) data 0.104 (0.098) loss_u loss_u 0.9326 (0.9003) acc_u 6.2500 (10.0000) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/27] time 0.174 (0.174) data 0.098 (0.098) loss_u loss_u 0.8218 (0.9031) acc_u 25.0000 (10.6250) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/27] time 0.165 (0.175) data 0.089 (0.098) loss_u loss_u 0.9546 (0.9086) acc_u 6.2500 (10.6250) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/27] time 0.159 (0.173) data 0.083 (0.096) loss_u loss_u 0.9204 (0.9117) acc_u 9.3750 (10.4688) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [25/27] time 0.158 (0.172) data 0.081 (0.095) loss_u loss_u 0.9106 (0.9168) acc_u 12.5000 (9.8750) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.4531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 725
clean true:699
clean false:26
clean_rate:0.9641379310344828
noisy true:542
noisy false:333
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 875
epoch [153/200] batch [5/22] time 0.186 (0.179) data 0.110 (0.102) loss_x loss_x 0.9888 (0.4978) acc_x 78.1250 (87.5000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/22] time 0.181 (0.173) data 0.105 (0.096) loss_x loss_x 1.1250 (0.6117) acc_x 84.3750 (87.1875) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/22] time 0.177 (0.177) data 0.101 (0.101) loss_x loss_x 0.4077 (0.5299) acc_x 90.6250 (88.5417) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/22] time 0.163 (0.175) data 0.086 (0.099) loss_x loss_x 0.8037 (0.5778) acc_x 75.0000 (86.8750) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/27] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.9336 (0.9405) acc_u 6.2500 (6.2500) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/27] time 0.165 (0.175) data 0.088 (0.099) loss_u loss_u 0.8755 (0.9077) acc_u 12.5000 (10.0000) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/27] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.8540 (0.9096) acc_u 15.6250 (9.5833) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/27] time 0.182 (0.176) data 0.105 (0.100) loss_u loss_u 0.8936 (0.9135) acc_u 12.5000 (9.3750) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [25/27] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.8770 (0.9174) acc_u 12.5000 (8.8750) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 355
confident_label rate tensor(0.4469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 715
clean true:694
clean false:21
clean_rate:0.9706293706293706
noisy true:551
noisy false:334
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 885
epoch [154/200] batch [5/22] time 0.165 (0.168) data 0.089 (0.092) loss_x loss_x 0.4629 (0.4563) acc_x 84.3750 (89.3750) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [10/22] time 0.179 (0.174) data 0.102 (0.097) loss_x loss_x 0.3694 (0.4767) acc_x 90.6250 (88.4375) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/22] time 0.173 (0.173) data 0.096 (0.096) loss_x loss_x 0.6689 (0.4766) acc_x 87.5000 (87.9167) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/22] time 0.175 (0.173) data 0.099 (0.096) loss_x loss_x 0.5259 (0.4386) acc_x 84.3750 (88.9062) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/27] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.9146 (0.8983) acc_u 12.5000 (11.2500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/27] time 0.188 (0.174) data 0.111 (0.097) loss_u loss_u 0.8735 (0.9110) acc_u 15.6250 (10.0000) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/27] time 0.168 (0.174) data 0.090 (0.097) loss_u loss_u 0.9668 (0.9159) acc_u 6.2500 (10.0000) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/27] time 0.169 (0.173) data 0.093 (0.096) loss_u loss_u 0.9668 (0.9213) acc_u 3.1250 (9.0625) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [25/27] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.7803 (0.9164) acc_u 25.0000 (9.7500) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 345
confident_label rate tensor(0.4525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 724
clean true:696
clean false:28
clean_rate:0.9613259668508287
noisy true:559
noisy false:317
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 876
epoch [155/200] batch [5/22] time 0.168 (0.178) data 0.092 (0.102) loss_x loss_x 0.7578 (0.6297) acc_x 81.2500 (86.2500) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/22] time 0.169 (0.173) data 0.093 (0.097) loss_x loss_x 0.4192 (0.5515) acc_x 87.5000 (85.9375) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/22] time 0.185 (0.172) data 0.108 (0.095) loss_x loss_x 0.3281 (0.5025) acc_x 87.5000 (86.8750) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/22] time 0.158 (0.171) data 0.081 (0.094) loss_x loss_x 0.3469 (0.4697) acc_x 96.8750 (87.6562) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/27] time 0.163 (0.170) data 0.085 (0.093) loss_u loss_u 0.9028 (0.9213) acc_u 12.5000 (8.7500) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/27] time 0.166 (0.169) data 0.089 (0.092) loss_u loss_u 0.9673 (0.9206) acc_u 3.1250 (8.7500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/27] time 0.206 (0.170) data 0.129 (0.093) loss_u loss_u 0.9424 (0.9309) acc_u 6.2500 (7.5000) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [20/27] time 0.202 (0.174) data 0.125 (0.097) loss_u loss_u 0.8975 (0.9220) acc_u 12.5000 (8.5938) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [25/27] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.9399 (0.9172) acc_u 6.2500 (9.0000) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.4500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 720
clean true:694
clean false:26
clean_rate:0.9638888888888889
noisy true:545
noisy false:335
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 880
epoch [156/200] batch [5/22] time 0.178 (0.186) data 0.101 (0.110) loss_x loss_x 0.5405 (0.3922) acc_x 84.3750 (89.3750) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/22] time 0.183 (0.179) data 0.106 (0.103) loss_x loss_x 0.7622 (0.4942) acc_x 81.2500 (85.6250) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/22] time 0.171 (0.175) data 0.095 (0.098) loss_x loss_x 0.5977 (0.4773) acc_x 81.2500 (86.0417) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/22] time 0.186 (0.174) data 0.110 (0.097) loss_x loss_x 0.6279 (0.4517) acc_x 84.3750 (87.1875) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/27] time 0.164 (0.173) data 0.086 (0.096) loss_u loss_u 0.9399 (0.9147) acc_u 6.2500 (9.3750) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/27] time 0.169 (0.172) data 0.090 (0.095) loss_u loss_u 0.8892 (0.9146) acc_u 12.5000 (9.6875) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/27] time 0.166 (0.170) data 0.090 (0.094) loss_u loss_u 0.9976 (0.9199) acc_u 0.0000 (8.9583) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/27] time 0.166 (0.170) data 0.089 (0.093) loss_u loss_u 0.8970 (0.9161) acc_u 12.5000 (9.6875) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [25/27] time 0.166 (0.170) data 0.090 (0.093) loss_u loss_u 0.8379 (0.9121) acc_u 21.8750 (10.5000) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 710
clean true:682
clean false:28
clean_rate:0.9605633802816902
noisy true:548
noisy false:342
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 890
epoch [157/200] batch [5/22] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.4575 (0.4360) acc_x 87.5000 (86.8750) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/22] time 0.175 (0.181) data 0.099 (0.105) loss_x loss_x 0.6372 (0.3894) acc_x 81.2500 (88.1250) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/22] time 0.163 (0.176) data 0.086 (0.100) loss_x loss_x 0.2095 (0.3620) acc_x 90.6250 (88.9583) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/22] time 0.167 (0.174) data 0.091 (0.097) loss_x loss_x 0.5132 (0.3520) acc_x 87.5000 (89.5312) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/27] time 0.180 (0.174) data 0.103 (0.098) loss_u loss_u 0.9526 (0.9016) acc_u 6.2500 (11.2500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/27] time 0.180 (0.174) data 0.103 (0.098) loss_u loss_u 0.8960 (0.8957) acc_u 9.3750 (11.8750) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/27] time 0.165 (0.173) data 0.086 (0.097) loss_u loss_u 0.9434 (0.9026) acc_u 6.2500 (10.8333) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/27] time 0.164 (0.173) data 0.088 (0.096) loss_u loss_u 0.9043 (0.8989) acc_u 12.5000 (11.5625) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [25/27] time 0.162 (0.172) data 0.085 (0.095) loss_u loss_u 0.8950 (0.8975) acc_u 12.5000 (11.6250) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 710
clean true:684
clean false:26
clean_rate:0.9633802816901409
noisy true:541
noisy false:349
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 890
epoch [158/200] batch [5/22] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.2384 (0.4483) acc_x 93.7500 (86.8750) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/22] time 0.195 (0.186) data 0.118 (0.109) loss_x loss_x 0.6377 (0.4564) acc_x 78.1250 (87.1875) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/22] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.4436 (0.5279) acc_x 87.5000 (85.0000) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/22] time 0.181 (0.186) data 0.105 (0.109) loss_x loss_x 0.8452 (0.5435) acc_x 75.0000 (85.0000) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/27] time 0.163 (0.182) data 0.086 (0.105) loss_u loss_u 0.8760 (0.8690) acc_u 12.5000 (14.3750) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/27] time 0.173 (0.179) data 0.096 (0.103) loss_u loss_u 0.9521 (0.8920) acc_u 6.2500 (11.8750) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [15/27] time 0.184 (0.178) data 0.108 (0.102) loss_u loss_u 0.8311 (0.8847) acc_u 18.7500 (12.9167) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/27] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8867 (0.8959) acc_u 12.5000 (11.4062) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [25/27] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.9185 (0.8978) acc_u 9.3750 (11.2500) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4550, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 728
clean true:698
clean false:30
clean_rate:0.9587912087912088
noisy true:533
noisy false:339
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 872
epoch [159/200] batch [5/22] time 0.178 (0.174) data 0.101 (0.097) loss_x loss_x 0.5420 (0.3948) acc_x 75.0000 (88.7500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/22] time 0.156 (0.173) data 0.079 (0.097) loss_x loss_x 0.3152 (0.3521) acc_x 93.7500 (90.9375) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/22] time 0.171 (0.172) data 0.095 (0.095) loss_x loss_x 0.5908 (0.3894) acc_x 84.3750 (90.0000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/22] time 0.160 (0.169) data 0.083 (0.093) loss_x loss_x 0.4619 (0.3757) acc_x 87.5000 (90.0000) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/27] time 0.168 (0.170) data 0.092 (0.094) loss_u loss_u 0.8896 (0.9201) acc_u 12.5000 (10.0000) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/27] time 0.178 (0.171) data 0.102 (0.095) loss_u loss_u 0.8564 (0.9247) acc_u 15.6250 (8.4375) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/27] time 0.184 (0.173) data 0.107 (0.096) loss_u loss_u 0.8647 (0.9165) acc_u 15.6250 (9.3750) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/27] time 0.188 (0.174) data 0.111 (0.098) loss_u loss_u 0.8813 (0.9113) acc_u 12.5000 (10.0000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [25/27] time 0.164 (0.174) data 0.087 (0.097) loss_u loss_u 0.9175 (0.9151) acc_u 9.3750 (9.5000) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 334
confident_label rate tensor(0.4525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 724
clean true:700
clean false:24
clean_rate:0.9668508287292817
noisy true:566
noisy false:310
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 876
epoch [160/200] batch [5/22] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.6143 (0.4688) acc_x 87.5000 (87.5000) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/22] time 0.173 (0.179) data 0.097 (0.103) loss_x loss_x 0.2419 (0.4311) acc_x 90.6250 (87.5000) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/22] time 0.173 (0.174) data 0.097 (0.098) loss_x loss_x 0.2007 (0.4481) acc_x 96.8750 (87.7083) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/22] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.4153 (0.4587) acc_x 90.6250 (87.5000) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/27] time 0.184 (0.172) data 0.107 (0.096) loss_u loss_u 0.9370 (0.8967) acc_u 6.2500 (11.8750) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/27] time 0.170 (0.172) data 0.093 (0.096) loss_u loss_u 0.8989 (0.8853) acc_u 12.5000 (13.4375) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/27] time 0.177 (0.171) data 0.099 (0.094) loss_u loss_u 0.9653 (0.8944) acc_u 6.2500 (12.2917) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/27] time 0.168 (0.171) data 0.091 (0.094) loss_u loss_u 0.8882 (0.8997) acc_u 12.5000 (11.7188) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [25/27] time 0.181 (0.171) data 0.104 (0.095) loss_u loss_u 0.8447 (0.9034) acc_u 18.7500 (11.2500) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.4231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 677
clean true:652
clean false:25
clean_rate:0.9630723781388478
noisy true:556
noisy false:367
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 923
epoch [161/200] batch [5/21] time 0.185 (0.181) data 0.109 (0.105) loss_x loss_x 0.5679 (0.4263) acc_x 84.3750 (88.1250) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/21] time 0.188 (0.184) data 0.112 (0.108) loss_x loss_x 0.7832 (0.5186) acc_x 78.1250 (85.9375) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/21] time 0.224 (0.184) data 0.147 (0.108) loss_x loss_x 0.4358 (0.4821) acc_x 84.3750 (87.5000) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/21] time 0.174 (0.183) data 0.098 (0.107) loss_x loss_x 0.4675 (0.4927) acc_x 87.5000 (87.5000) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/28] time 0.188 (0.180) data 0.112 (0.104) loss_u loss_u 0.9497 (0.8913) acc_u 6.2500 (15.0000) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/28] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9043 (0.8828) acc_u 9.3750 (14.0625) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [15/28] time 0.167 (0.179) data 0.091 (0.102) loss_u loss_u 0.9058 (0.8757) acc_u 9.3750 (14.3750) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/28] time 0.184 (0.179) data 0.108 (0.102) loss_u loss_u 0.8657 (0.8706) acc_u 12.5000 (14.6875) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [25/28] time 0.177 (0.179) data 0.099 (0.102) loss_u loss_u 0.9761 (0.8821) acc_u 0.0000 (13.2500) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.4537, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 726
clean true:698
clean false:28
clean_rate:0.9614325068870524
noisy true:563
noisy false:311
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 874
epoch [162/200] batch [5/22] time 0.173 (0.181) data 0.097 (0.105) loss_x loss_x 0.3284 (0.2763) acc_x 93.7500 (94.3750) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/22] time 0.166 (0.175) data 0.089 (0.099) loss_x loss_x 0.7520 (0.3912) acc_x 87.5000 (92.1875) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/22] time 0.166 (0.172) data 0.090 (0.095) loss_x loss_x 0.1718 (0.3683) acc_x 90.6250 (91.8750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/22] time 0.178 (0.174) data 0.101 (0.098) loss_x loss_x 0.5576 (0.3747) acc_x 87.5000 (91.0938) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/27] time 0.184 (0.175) data 0.107 (0.099) loss_u loss_u 0.8389 (0.8884) acc_u 18.7500 (12.5000) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/27] time 0.165 (0.175) data 0.088 (0.098) loss_u loss_u 0.9790 (0.9169) acc_u 3.1250 (9.3750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/27] time 0.174 (0.174) data 0.096 (0.098) loss_u loss_u 0.8481 (0.9190) acc_u 15.6250 (8.7500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/27] time 0.182 (0.175) data 0.105 (0.098) loss_u loss_u 0.8457 (0.9197) acc_u 15.6250 (8.9062) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [25/27] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.9146 (0.9225) acc_u 9.3750 (8.7500) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 709
clean true:679
clean false:30
clean_rate:0.9576868829337094
noisy true:549
noisy false:342
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 891
epoch [163/200] batch [5/22] time 0.186 (0.186) data 0.109 (0.110) loss_x loss_x 0.2922 (0.5301) acc_x 93.7500 (88.1250) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/22] time 0.179 (0.181) data 0.102 (0.105) loss_x loss_x 0.5942 (0.4799) acc_x 87.5000 (88.4375) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/22] time 0.164 (0.181) data 0.087 (0.104) loss_x loss_x 0.3203 (0.4218) acc_x 93.7500 (90.0000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/22] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.1891 (0.4104) acc_x 96.8750 (89.8438) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/27] time 0.183 (0.184) data 0.106 (0.108) loss_u loss_u 0.9097 (0.9119) acc_u 6.2500 (8.7500) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/27] time 0.165 (0.183) data 0.088 (0.106) loss_u loss_u 0.9360 (0.9116) acc_u 6.2500 (9.6875) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [15/27] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.8521 (0.9063) acc_u 21.8750 (11.0417) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/27] time 0.186 (0.182) data 0.109 (0.106) loss_u loss_u 0.7866 (0.9023) acc_u 25.0000 (11.2500) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [25/27] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.8994 (0.8982) acc_u 9.3750 (11.6250) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.4469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 715
clean true:684
clean false:31
clean_rate:0.9566433566433566
noisy true:559
noisy false:326
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 885
epoch [164/200] batch [5/22] time 0.185 (0.190) data 0.108 (0.113) loss_x loss_x 0.2805 (0.5017) acc_x 93.7500 (88.1250) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/22] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.5254 (0.5849) acc_x 87.5000 (85.9375) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/22] time 0.188 (0.184) data 0.112 (0.107) loss_x loss_x 0.2098 (0.5385) acc_x 96.8750 (87.2917) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/22] time 0.187 (0.182) data 0.111 (0.106) loss_x loss_x 0.1060 (0.5244) acc_x 96.8750 (87.1875) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/27] time 0.189 (0.183) data 0.112 (0.107) loss_u loss_u 0.9204 (0.9342) acc_u 9.3750 (7.5000) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/27] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.9097 (0.9346) acc_u 9.3750 (7.5000) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/27] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9141 (0.9118) acc_u 9.3750 (10.2083) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/27] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.8877 (0.9083) acc_u 9.3750 (10.3125) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [25/27] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.8936 (0.9049) acc_u 15.6250 (10.7500) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.4519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 723
clean true:693
clean false:30
clean_rate:0.9585062240663901
noisy true:536
noisy false:341
after delete: len(clean_dataset) 723
after delete: len(noisy_dataset) 877
epoch [165/200] batch [5/22] time 0.169 (0.179) data 0.093 (0.103) loss_x loss_x 0.7451 (0.5015) acc_x 78.1250 (86.8750) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/22] time 0.161 (0.173) data 0.084 (0.096) loss_x loss_x 0.8555 (0.5108) acc_x 75.0000 (85.9375) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/22] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.6455 (0.5344) acc_x 87.5000 (86.6667) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/22] time 0.189 (0.178) data 0.112 (0.101) loss_x loss_x 0.1770 (0.5183) acc_x 100.0000 (87.5000) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/27] time 0.193 (0.181) data 0.115 (0.104) loss_u loss_u 0.9268 (0.9259) acc_u 6.2500 (8.1250) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/27] time 0.175 (0.180) data 0.099 (0.103) loss_u loss_u 0.9336 (0.9155) acc_u 6.2500 (9.3750) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [15/27] time 0.175 (0.180) data 0.097 (0.103) loss_u loss_u 0.9463 (0.9094) acc_u 6.2500 (10.2083) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/27] time 0.161 (0.178) data 0.083 (0.101) loss_u loss_u 0.8848 (0.9113) acc_u 15.6250 (10.1562) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [25/27] time 0.162 (0.176) data 0.085 (0.099) loss_u loss_u 0.9380 (0.9058) acc_u 9.3750 (10.8750) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.4425, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 708
clean true:684
clean false:24
clean_rate:0.9661016949152542
noisy true:544
noisy false:348
after delete: len(clean_dataset) 708
after delete: len(noisy_dataset) 892
epoch [166/200] batch [5/22] time 0.175 (0.188) data 0.099 (0.112) loss_x loss_x 0.4048 (0.5125) acc_x 90.6250 (88.1250) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/22] time 0.159 (0.181) data 0.083 (0.105) loss_x loss_x 0.4504 (0.4357) acc_x 90.6250 (89.0625) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/22] time 0.176 (0.179) data 0.100 (0.103) loss_x loss_x 0.4519 (0.4304) acc_x 87.5000 (88.7500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/22] time 0.185 (0.179) data 0.109 (0.103) loss_x loss_x 0.2200 (0.4493) acc_x 93.7500 (87.6562) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/27] time 0.182 (0.177) data 0.105 (0.101) loss_u loss_u 0.8428 (0.8733) acc_u 18.7500 (14.3750) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/27] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.8540 (0.8821) acc_u 15.6250 (13.4375) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [15/27] time 0.169 (0.177) data 0.092 (0.101) loss_u loss_u 0.8022 (0.8874) acc_u 21.8750 (12.7083) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/27] time 0.180 (0.177) data 0.103 (0.101) loss_u loss_u 0.9692 (0.8996) acc_u 3.1250 (11.4062) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [25/27] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9175 (0.8974) acc_u 9.3750 (11.5000) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.4525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 724
clean true:699
clean false:25
clean_rate:0.9654696132596685
noisy true:552
noisy false:324
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 876
epoch [167/200] batch [5/22] time 0.245 (0.209) data 0.168 (0.132) loss_x loss_x 0.3418 (0.3975) acc_x 90.6250 (88.7500) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/22] time 0.162 (0.200) data 0.086 (0.123) loss_x loss_x 0.4011 (0.4619) acc_x 84.3750 (87.5000) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/22] time 0.186 (0.195) data 0.109 (0.118) loss_x loss_x 0.2744 (0.4585) acc_x 93.7500 (87.9167) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/22] time 0.170 (0.189) data 0.094 (0.112) loss_x loss_x 0.6353 (0.4852) acc_x 81.2500 (87.1875) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/27] time 0.176 (0.185) data 0.100 (0.109) loss_u loss_u 0.9263 (0.9349) acc_u 9.3750 (7.5000) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/27] time 0.161 (0.182) data 0.084 (0.106) loss_u loss_u 0.9180 (0.9185) acc_u 9.3750 (9.3750) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/27] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.8848 (0.9153) acc_u 15.6250 (9.5833) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/27] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9087 (0.9146) acc_u 9.3750 (9.5312) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [25/27] time 0.188 (0.182) data 0.112 (0.106) loss_u loss_u 0.9346 (0.9101) acc_u 9.3750 (10.2500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 709
clean true:685
clean false:24
clean_rate:0.9661495063469676
noisy true:565
noisy false:326
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 891
epoch [168/200] batch [5/22] time 0.174 (0.176) data 0.097 (0.100) loss_x loss_x 0.4326 (0.4170) acc_x 90.6250 (88.7500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/22] time 0.183 (0.172) data 0.106 (0.096) loss_x loss_x 0.2456 (0.3891) acc_x 93.7500 (89.6875) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/22] time 0.175 (0.175) data 0.098 (0.098) loss_x loss_x 0.5757 (0.4525) acc_x 81.2500 (87.9167) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/22] time 0.177 (0.175) data 0.100 (0.099) loss_x loss_x 0.4382 (0.4374) acc_x 87.5000 (87.9688) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/27] time 0.173 (0.175) data 0.096 (0.099) loss_u loss_u 0.9668 (0.9233) acc_u 3.1250 (8.1250) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/27] time 0.167 (0.174) data 0.090 (0.098) loss_u loss_u 0.8955 (0.9063) acc_u 12.5000 (10.3125) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/27] time 0.159 (0.173) data 0.082 (0.096) loss_u loss_u 0.8618 (0.9107) acc_u 15.6250 (10.2083) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/27] time 0.162 (0.172) data 0.084 (0.095) loss_u loss_u 0.8281 (0.9016) acc_u 18.7500 (11.2500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [25/27] time 0.200 (0.172) data 0.124 (0.095) loss_u loss_u 0.8418 (0.9009) acc_u 18.7500 (11.2500) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.4562, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 730
clean true:702
clean false:28
clean_rate:0.9616438356164384
noisy true:549
noisy false:321
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 870
epoch [169/200] batch [5/22] time 0.194 (0.186) data 0.118 (0.110) loss_x loss_x 0.5991 (0.4265) acc_x 87.5000 (90.6250) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/22] time 0.165 (0.178) data 0.088 (0.102) loss_x loss_x 0.5337 (0.5216) acc_x 90.6250 (86.2500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/22] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 0.3367 (0.4826) acc_x 90.6250 (86.8750) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/22] time 0.189 (0.180) data 0.113 (0.103) loss_x loss_x 0.3130 (0.4433) acc_x 90.6250 (88.1250) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/27] time 0.185 (0.181) data 0.109 (0.105) loss_u loss_u 0.9492 (0.9175) acc_u 6.2500 (9.3750) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/27] time 0.186 (0.182) data 0.110 (0.105) loss_u loss_u 0.9580 (0.9271) acc_u 3.1250 (8.4375) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/27] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8403 (0.9207) acc_u 18.7500 (8.9583) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/27] time 0.191 (0.182) data 0.114 (0.106) loss_u loss_u 0.8462 (0.9196) acc_u 18.7500 (9.2188) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [25/27] time 0.191 (0.183) data 0.114 (0.106) loss_u loss_u 0.9380 (0.9235) acc_u 6.2500 (8.5000) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 714
clean true:683
clean false:31
clean_rate:0.9565826330532213
noisy true:542
noisy false:344
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 886
epoch [170/200] batch [5/22] time 0.172 (0.173) data 0.095 (0.096) loss_x loss_x 0.2903 (0.3398) acc_x 93.7500 (91.8750) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/22] time 0.169 (0.175) data 0.092 (0.098) loss_x loss_x 0.4373 (0.4134) acc_x 84.3750 (88.7500) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/22] time 0.174 (0.172) data 0.098 (0.096) loss_x loss_x 0.7271 (0.4349) acc_x 84.3750 (88.9583) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/22] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 0.4524 (0.4522) acc_x 84.3750 (88.5938) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/27] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.8081 (0.9080) acc_u 21.8750 (10.6250) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/27] time 0.179 (0.175) data 0.102 (0.098) loss_u loss_u 0.8857 (0.9066) acc_u 12.5000 (10.6250) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/27] time 0.189 (0.176) data 0.113 (0.099) loss_u loss_u 0.9258 (0.9123) acc_u 6.2500 (9.5833) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/27] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.8188 (0.9035) acc_u 21.8750 (10.9375) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [25/27] time 0.180 (0.178) data 0.102 (0.101) loss_u loss_u 0.8818 (0.9064) acc_u 15.6250 (10.8750) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.4519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 723
clean true:697
clean false:26
clean_rate:0.9640387275242047
noisy true:544
noisy false:333
after delete: len(clean_dataset) 723
after delete: len(noisy_dataset) 877
epoch [171/200] batch [5/22] time 0.187 (0.178) data 0.111 (0.102) loss_x loss_x 0.2273 (0.4242) acc_x 93.7500 (89.3750) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/22] time 0.186 (0.179) data 0.110 (0.103) loss_x loss_x 0.4097 (0.4261) acc_x 87.5000 (89.3750) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/22] time 0.159 (0.174) data 0.083 (0.098) loss_x loss_x 0.1865 (0.4005) acc_x 93.7500 (89.1667) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/22] time 0.164 (0.170) data 0.087 (0.094) loss_x loss_x 0.5605 (0.4065) acc_x 81.2500 (88.4375) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/27] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.9429 (0.9101) acc_u 3.1250 (10.0000) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/27] time 0.171 (0.176) data 0.094 (0.100) loss_u loss_u 0.9619 (0.9137) acc_u 6.2500 (10.0000) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/27] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.8989 (0.9155) acc_u 12.5000 (10.0000) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/27] time 0.187 (0.176) data 0.110 (0.100) loss_u loss_u 0.9409 (0.9155) acc_u 6.2500 (9.6875) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [25/27] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9551 (0.9176) acc_u 3.1250 (9.1250) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.4531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 725
clean true:697
clean false:28
clean_rate:0.9613793103448276
noisy true:556
noisy false:319
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 875
epoch [172/200] batch [5/22] time 0.175 (0.184) data 0.099 (0.108) loss_x loss_x 0.3181 (0.4263) acc_x 93.7500 (89.3750) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/22] time 0.173 (0.182) data 0.097 (0.105) loss_x loss_x 0.5977 (0.4560) acc_x 78.1250 (87.5000) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/22] time 0.161 (0.180) data 0.085 (0.103) loss_x loss_x 0.9971 (0.4918) acc_x 78.1250 (87.0833) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/22] time 0.160 (0.177) data 0.084 (0.100) loss_x loss_x 0.5620 (0.5088) acc_x 90.6250 (87.1875) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/27] time 0.181 (0.177) data 0.104 (0.101) loss_u loss_u 0.9189 (0.9035) acc_u 9.3750 (10.6250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/27] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.9375 (0.9084) acc_u 6.2500 (10.0000) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/27] time 0.174 (0.178) data 0.098 (0.101) loss_u loss_u 0.9131 (0.9201) acc_u 9.3750 (8.9583) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/27] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9580 (0.9142) acc_u 6.2500 (9.6875) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [25/27] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8594 (0.9110) acc_u 15.6250 (10.0000) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 721
clean true:691
clean false:30
clean_rate:0.9583911234396671
noisy true:529
noisy false:350
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 879
epoch [173/200] batch [5/22] time 0.176 (0.181) data 0.099 (0.105) loss_x loss_x 0.5825 (0.6644) acc_x 87.5000 (82.5000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/22] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 0.1771 (0.5869) acc_x 93.7500 (84.3750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/22] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.6323 (0.5701) acc_x 84.3750 (85.0000) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/22] time 0.181 (0.176) data 0.104 (0.099) loss_x loss_x 0.4663 (0.5144) acc_x 90.6250 (86.2500) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/27] time 0.195 (0.175) data 0.117 (0.099) loss_u loss_u 0.9224 (0.8966) acc_u 9.3750 (11.2500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/27] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.9277 (0.9189) acc_u 12.5000 (9.3750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/27] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.9365 (0.9073) acc_u 6.2500 (11.0417) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/27] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.8569 (0.9118) acc_u 15.6250 (10.1562) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [25/27] time 0.179 (0.177) data 0.102 (0.100) loss_u loss_u 0.8667 (0.9064) acc_u 15.6250 (10.7500) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.4531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 725
clean true:697
clean false:28
clean_rate:0.9613793103448276
noisy true:555
noisy false:320
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 875
epoch [174/200] batch [5/22] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.3411 (0.3535) acc_x 84.3750 (89.3750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/22] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.3926 (0.4194) acc_x 90.6250 (88.7500) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/22] time 0.161 (0.176) data 0.085 (0.100) loss_x loss_x 0.4929 (0.4784) acc_x 87.5000 (87.2917) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/22] time 0.177 (0.176) data 0.101 (0.100) loss_x loss_x 0.5317 (0.4626) acc_x 84.3750 (87.5000) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/27] time 0.175 (0.174) data 0.099 (0.098) loss_u loss_u 0.8926 (0.8936) acc_u 12.5000 (11.2500) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/27] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.8999 (0.9077) acc_u 9.3750 (9.6875) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/27] time 0.162 (0.175) data 0.086 (0.099) loss_u loss_u 0.9165 (0.9056) acc_u 9.3750 (10.4167) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/27] time 0.189 (0.176) data 0.112 (0.100) loss_u loss_u 0.8398 (0.9053) acc_u 21.8750 (10.4688) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [25/27] time 0.205 (0.179) data 0.128 (0.102) loss_u loss_u 0.9619 (0.9103) acc_u 3.1250 (9.8750) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 337
confident_label rate tensor(0.4569, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 731
clean true:704
clean false:27
clean_rate:0.9630642954856361
noisy true:559
noisy false:310
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 869
epoch [175/200] batch [5/22] time 0.174 (0.179) data 0.098 (0.102) loss_x loss_x 0.2350 (0.5340) acc_x 96.8750 (87.5000) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/22] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.7124 (0.4662) acc_x 78.1250 (88.7500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/22] time 0.179 (0.175) data 0.102 (0.099) loss_x loss_x 0.4175 (0.4619) acc_x 87.5000 (87.5000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/22] time 0.164 (0.175) data 0.088 (0.099) loss_x loss_x 0.4009 (0.4369) acc_x 93.7500 (88.5938) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/27] time 0.182 (0.175) data 0.105 (0.099) loss_u loss_u 0.9375 (0.9146) acc_u 6.2500 (8.7500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/27] time 0.176 (0.175) data 0.098 (0.099) loss_u loss_u 0.8750 (0.9010) acc_u 12.5000 (10.9375) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/27] time 0.170 (0.175) data 0.093 (0.098) loss_u loss_u 0.8779 (0.9052) acc_u 15.6250 (10.6250) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/27] time 0.160 (0.173) data 0.083 (0.096) loss_u loss_u 0.9409 (0.9118) acc_u 9.3750 (10.0000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [25/27] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.9214 (0.9143) acc_u 6.2500 (9.5000) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.4494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 719
clean true:687
clean false:32
clean_rate:0.9554937413073713
noisy true:547
noisy false:334
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 881
epoch [176/200] batch [5/22] time 0.187 (0.187) data 0.111 (0.110) loss_x loss_x 0.8057 (0.5039) acc_x 81.2500 (86.2500) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/22] time 0.186 (0.188) data 0.110 (0.111) loss_x loss_x 0.6118 (0.5396) acc_x 84.3750 (85.0000) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/22] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.3315 (0.5276) acc_x 87.5000 (85.6250) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/22] time 0.192 (0.184) data 0.117 (0.108) loss_x loss_x 0.7607 (0.5317) acc_x 81.2500 (86.2500) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/27] time 0.171 (0.180) data 0.095 (0.104) loss_u loss_u 0.8945 (0.9340) acc_u 12.5000 (6.8750) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/27] time 0.171 (0.179) data 0.095 (0.103) loss_u loss_u 0.9614 (0.9023) acc_u 6.2500 (10.6250) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/27] time 0.174 (0.178) data 0.096 (0.102) loss_u loss_u 0.8394 (0.9065) acc_u 18.7500 (10.6250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/27] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8936 (0.9010) acc_u 12.5000 (11.5625) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [25/27] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.9204 (0.9057) acc_u 6.2500 (10.8750) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.4494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 719
clean true:694
clean false:25
clean_rate:0.9652294853963839
noisy true:553
noisy false:328
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 881
epoch [177/200] batch [5/22] time 0.170 (0.182) data 0.093 (0.105) loss_x loss_x 0.1843 (0.4228) acc_x 93.7500 (87.5000) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/22] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.3142 (0.3622) acc_x 93.7500 (90.3125) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/22] time 0.184 (0.177) data 0.108 (0.101) loss_x loss_x 0.3865 (0.3849) acc_x 87.5000 (90.0000) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/22] time 0.181 (0.178) data 0.105 (0.102) loss_x loss_x 0.8179 (0.4214) acc_x 78.1250 (88.7500) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/27] time 0.180 (0.179) data 0.103 (0.103) loss_u loss_u 0.9106 (0.9021) acc_u 12.5000 (13.1250) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/27] time 0.185 (0.180) data 0.106 (0.103) loss_u loss_u 0.9272 (0.9186) acc_u 12.5000 (10.3125) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [15/27] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9160 (0.9249) acc_u 9.3750 (9.1667) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/27] time 0.187 (0.181) data 0.110 (0.104) loss_u loss_u 0.8687 (0.9147) acc_u 15.6250 (10.3125) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [25/27] time 0.172 (0.181) data 0.093 (0.104) loss_u loss_u 0.7891 (0.9091) acc_u 21.8750 (10.7500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 704
clean true:674
clean false:30
clean_rate:0.9573863636363636
noisy true:549
noisy false:347
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 896
epoch [178/200] batch [5/22] time 0.194 (0.188) data 0.117 (0.112) loss_x loss_x 0.3381 (0.5334) acc_x 90.6250 (84.3750) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/22] time 0.182 (0.187) data 0.106 (0.110) loss_x loss_x 0.6050 (0.4932) acc_x 87.5000 (87.1875) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/22] time 0.178 (0.185) data 0.101 (0.109) loss_x loss_x 0.2822 (0.4620) acc_x 93.7500 (87.5000) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/22] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.7007 (0.4683) acc_x 78.1250 (87.3438) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/28] time 0.183 (0.185) data 0.107 (0.108) loss_u loss_u 0.8193 (0.8801) acc_u 18.7500 (13.7500) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/28] time 0.188 (0.185) data 0.111 (0.108) loss_u loss_u 0.9219 (0.8915) acc_u 9.3750 (12.5000) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/28] time 0.182 (0.185) data 0.106 (0.108) loss_u loss_u 0.8569 (0.8869) acc_u 15.6250 (13.3333) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/28] time 0.189 (0.185) data 0.111 (0.108) loss_u loss_u 0.9365 (0.8928) acc_u 6.2500 (12.5000) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [25/28] time 0.168 (0.183) data 0.091 (0.107) loss_u loss_u 0.9473 (0.8929) acc_u 6.2500 (12.5000) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.4569, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 731
clean true:698
clean false:33
clean_rate:0.9548563611491108
noisy true:551
noisy false:318
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 869
epoch [179/200] batch [5/22] time 0.166 (0.170) data 0.089 (0.093) loss_x loss_x 0.8345 (0.5419) acc_x 81.2500 (87.5000) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/22] time 0.176 (0.176) data 0.099 (0.100) loss_x loss_x 0.2351 (0.4195) acc_x 93.7500 (90.6250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/22] time 0.168 (0.174) data 0.092 (0.097) loss_x loss_x 0.5112 (0.4537) acc_x 87.5000 (89.1667) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/22] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.4150 (0.4545) acc_x 87.5000 (89.0625) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/27] time 0.176 (0.173) data 0.100 (0.097) loss_u loss_u 0.9141 (0.9059) acc_u 9.3750 (9.3750) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/27] time 0.186 (0.174) data 0.109 (0.097) loss_u loss_u 0.9546 (0.9220) acc_u 3.1250 (7.8125) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/27] time 0.165 (0.174) data 0.088 (0.097) loss_u loss_u 0.9365 (0.9193) acc_u 6.2500 (8.1250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/27] time 0.162 (0.173) data 0.086 (0.096) loss_u loss_u 0.8848 (0.9119) acc_u 12.5000 (9.2188) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [25/27] time 0.161 (0.172) data 0.084 (0.095) loss_u loss_u 0.9243 (0.9153) acc_u 6.2500 (8.7500) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.4481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 717
clean true:688
clean false:29
clean_rate:0.9595536959553695
noisy true:551
noisy false:332
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 883
epoch [180/200] batch [5/22] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.4453 (0.4275) acc_x 87.5000 (90.0000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/22] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.5625 (0.4134) acc_x 84.3750 (89.3750) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/22] time 0.181 (0.176) data 0.105 (0.099) loss_x loss_x 0.3320 (0.3704) acc_x 93.7500 (90.6250) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/22] time 0.186 (0.175) data 0.110 (0.099) loss_x loss_x 0.3223 (0.3778) acc_x 90.6250 (90.3125) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/27] time 0.165 (0.174) data 0.089 (0.097) loss_u loss_u 0.8618 (0.8868) acc_u 15.6250 (12.5000) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/27] time 0.174 (0.173) data 0.098 (0.097) loss_u loss_u 0.9531 (0.9054) acc_u 3.1250 (10.3125) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/27] time 0.178 (0.174) data 0.102 (0.098) loss_u loss_u 0.9224 (0.8997) acc_u 9.3750 (11.4583) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/27] time 0.187 (0.176) data 0.111 (0.099) loss_u loss_u 0.9487 (0.9001) acc_u 9.3750 (11.5625) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [25/27] time 0.171 (0.176) data 0.093 (0.099) loss_u loss_u 0.9951 (0.9062) acc_u 0.0000 (10.7500) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.4394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 703
clean true:678
clean false:25
clean_rate:0.9644381223328592
noisy true:557
noisy false:340
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 897
epoch [181/200] batch [5/21] time 0.185 (0.187) data 0.109 (0.111) loss_x loss_x 0.2103 (0.3998) acc_x 93.7500 (90.6250) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/21] time 0.190 (0.187) data 0.114 (0.111) loss_x loss_x 0.4922 (0.4757) acc_x 90.6250 (89.3750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/21] time 0.193 (0.186) data 0.116 (0.110) loss_x loss_x 0.5386 (0.4503) acc_x 87.5000 (89.3750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/21] time 0.176 (0.183) data 0.099 (0.107) loss_x loss_x 0.3940 (0.4117) acc_x 93.7500 (90.3125) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/28] time 0.173 (0.181) data 0.096 (0.105) loss_u loss_u 0.9253 (0.8774) acc_u 6.2500 (13.1250) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/28] time 0.171 (0.179) data 0.094 (0.102) loss_u loss_u 0.9233 (0.8934) acc_u 9.3750 (11.8750) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/28] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.8784 (0.9063) acc_u 15.6250 (10.6250) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/28] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.8286 (0.8958) acc_u 15.6250 (11.4062) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [25/28] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.9385 (0.8975) acc_u 6.2500 (11.1250) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 702
clean true:679
clean false:23
clean_rate:0.9672364672364673
noisy true:553
noisy false:345
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 898
epoch [182/200] batch [5/21] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.6772 (0.4303) acc_x 81.2500 (89.3750) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/21] time 0.181 (0.178) data 0.104 (0.102) loss_x loss_x 0.3792 (0.3988) acc_x 90.6250 (89.0625) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/21] time 0.191 (0.180) data 0.115 (0.103) loss_x loss_x 0.2559 (0.4005) acc_x 96.8750 (89.7917) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/21] time 0.164 (0.178) data 0.088 (0.102) loss_x loss_x 0.0922 (0.4266) acc_x 100.0000 (89.6875) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/28] time 0.186 (0.179) data 0.110 (0.102) loss_u loss_u 0.9614 (0.8961) acc_u 6.2500 (10.6250) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/28] time 0.188 (0.179) data 0.111 (0.103) loss_u loss_u 0.9048 (0.8984) acc_u 12.5000 (10.6250) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/28] time 0.169 (0.178) data 0.092 (0.101) loss_u loss_u 0.8828 (0.8912) acc_u 15.6250 (12.0833) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/28] time 0.162 (0.177) data 0.085 (0.100) loss_u loss_u 0.9272 (0.8902) acc_u 9.3750 (12.1875) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [25/28] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.7935 (0.8917) acc_u 21.8750 (11.8750) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.4487, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 718
clean true:689
clean false:29
clean_rate:0.9596100278551533
noisy true:545
noisy false:337
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 882
epoch [183/200] batch [5/22] time 0.167 (0.179) data 0.091 (0.102) loss_x loss_x 0.2886 (0.3730) acc_x 90.6250 (91.8750) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/22] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.6367 (0.4609) acc_x 84.3750 (89.6875) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/22] time 0.175 (0.180) data 0.099 (0.103) loss_x loss_x 0.9492 (0.4251) acc_x 75.0000 (90.2083) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/22] time 0.192 (0.179) data 0.115 (0.103) loss_x loss_x 0.1209 (0.4313) acc_x 96.8750 (89.8438) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/27] time 0.164 (0.177) data 0.085 (0.100) loss_u loss_u 0.9102 (0.9115) acc_u 9.3750 (10.0000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/27] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.9624 (0.9125) acc_u 3.1250 (9.6875) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/27] time 0.188 (0.179) data 0.112 (0.102) loss_u loss_u 0.9717 (0.9156) acc_u 6.2500 (9.7917) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/27] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.9307 (0.9158) acc_u 9.3750 (9.6875) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [25/27] time 0.187 (0.180) data 0.110 (0.104) loss_u loss_u 0.9326 (0.9119) acc_u 9.3750 (10.1250) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.4506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 721
clean true:694
clean false:27
clean_rate:0.9625520110957004
noisy true:549
noisy false:330
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 879
epoch [184/200] batch [5/22] time 0.167 (0.173) data 0.090 (0.097) loss_x loss_x 0.9082 (0.6047) acc_x 78.1250 (85.0000) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/22] time 0.161 (0.172) data 0.084 (0.096) loss_x loss_x 0.6597 (0.5334) acc_x 81.2500 (85.3125) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/22] time 0.175 (0.171) data 0.099 (0.094) loss_x loss_x 0.3455 (0.5235) acc_x 90.6250 (85.6250) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/22] time 0.174 (0.174) data 0.096 (0.097) loss_x loss_x 0.3853 (0.4812) acc_x 87.5000 (86.7188) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/27] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9175 (0.9136) acc_u 9.3750 (10.0000) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/27] time 0.187 (0.178) data 0.110 (0.101) loss_u loss_u 0.9536 (0.9158) acc_u 6.2500 (10.0000) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/27] time 0.169 (0.178) data 0.091 (0.101) loss_u loss_u 0.8452 (0.9044) acc_u 15.6250 (11.0417) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/27] time 0.157 (0.176) data 0.081 (0.099) loss_u loss_u 0.9761 (0.9128) acc_u 3.1250 (10.0000) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [25/27] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.9409 (0.9110) acc_u 6.2500 (10.2500) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 700
clean true:677
clean false:23
clean_rate:0.9671428571428572
noisy true:550
noisy false:350
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 900
epoch [185/200] batch [5/21] time 0.183 (0.191) data 0.107 (0.114) loss_x loss_x 0.1093 (0.2515) acc_x 96.8750 (91.8750) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/21] time 0.182 (0.188) data 0.106 (0.112) loss_x loss_x 0.5703 (0.3803) acc_x 87.5000 (90.3125) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/21] time 0.185 (0.187) data 0.107 (0.110) loss_x loss_x 0.6475 (0.4005) acc_x 81.2500 (90.0000) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/21] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.4805 (0.4332) acc_x 87.5000 (88.9062) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/28] time 0.179 (0.186) data 0.102 (0.109) loss_u loss_u 0.9312 (0.9088) acc_u 6.2500 (10.6250) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/28] time 0.174 (0.183) data 0.097 (0.106) loss_u loss_u 0.8472 (0.8967) acc_u 15.6250 (11.8750) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/28] time 0.175 (0.182) data 0.098 (0.105) loss_u loss_u 0.9268 (0.8966) acc_u 12.5000 (11.8750) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/28] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.9053 (0.8983) acc_u 9.3750 (11.7188) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [25/28] time 0.173 (0.181) data 0.096 (0.104) loss_u loss_u 0.9395 (0.8984) acc_u 9.3750 (11.6250) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.4569, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 731
clean true:699
clean false:32
clean_rate:0.9562243502051984
noisy true:550
noisy false:319
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 869
epoch [186/200] batch [5/22] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.2632 (0.3749) acc_x 93.7500 (91.8750) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/22] time 0.158 (0.180) data 0.082 (0.104) loss_x loss_x 0.3110 (0.4070) acc_x 90.6250 (89.0625) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/22] time 0.168 (0.176) data 0.091 (0.100) loss_x loss_x 0.4429 (0.3902) acc_x 87.5000 (89.7917) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/22] time 0.159 (0.174) data 0.083 (0.098) loss_x loss_x 0.4153 (0.3952) acc_x 90.6250 (90.0000) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/27] time 0.171 (0.172) data 0.094 (0.095) loss_u loss_u 0.8872 (0.9167) acc_u 12.5000 (8.7500) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/27] time 0.173 (0.172) data 0.095 (0.095) loss_u loss_u 0.9023 (0.9079) acc_u 12.5000 (10.6250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/27] time 0.172 (0.172) data 0.095 (0.095) loss_u loss_u 0.9644 (0.9114) acc_u 3.1250 (10.0000) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/27] time 0.185 (0.173) data 0.108 (0.097) loss_u loss_u 0.9756 (0.9044) acc_u 3.1250 (10.6250) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [25/27] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.9756 (0.9133) acc_u 3.1250 (9.7500) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.4481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 717
clean true:692
clean false:25
clean_rate:0.9651324965132496
noisy true:552
noisy false:331
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 883
epoch [187/200] batch [5/22] time 0.189 (0.181) data 0.111 (0.104) loss_x loss_x 0.4185 (0.3817) acc_x 87.5000 (90.0000) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/22] time 0.159 (0.177) data 0.080 (0.100) loss_x loss_x 0.3684 (0.3878) acc_x 87.5000 (90.6250) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/22] time 0.172 (0.177) data 0.096 (0.100) loss_x loss_x 0.4236 (0.4234) acc_x 87.5000 (89.7917) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/22] time 0.185 (0.175) data 0.108 (0.098) loss_x loss_x 0.5996 (0.4789) acc_x 84.3750 (87.5000) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/27] time 0.173 (0.175) data 0.095 (0.098) loss_u loss_u 0.9692 (0.9216) acc_u 3.1250 (8.7500) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/27] time 0.221 (0.177) data 0.143 (0.100) loss_u loss_u 0.8833 (0.9080) acc_u 12.5000 (10.0000) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/27] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.8340 (0.9028) acc_u 15.6250 (11.4583) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/27] time 0.190 (0.179) data 0.112 (0.102) loss_u loss_u 0.9209 (0.9058) acc_u 9.3750 (11.0938) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [25/27] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.9570 (0.9049) acc_u 6.2500 (11.1250) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 709
clean true:681
clean false:28
clean_rate:0.9605077574047954
noisy true:542
noisy false:349
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 891
epoch [188/200] batch [5/22] time 0.171 (0.174) data 0.095 (0.098) loss_x loss_x 0.5029 (0.4792) acc_x 87.5000 (88.7500) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/22] time 0.185 (0.179) data 0.109 (0.102) loss_x loss_x 0.8418 (0.4828) acc_x 81.2500 (88.4375) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/22] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 0.2404 (0.4521) acc_x 93.7500 (89.1667) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/22] time 0.183 (0.179) data 0.107 (0.102) loss_x loss_x 0.6230 (0.4668) acc_x 84.3750 (88.1250) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/27] time 0.179 (0.179) data 0.102 (0.102) loss_u loss_u 0.9033 (0.9164) acc_u 9.3750 (9.3750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/27] time 0.188 (0.180) data 0.110 (0.103) loss_u loss_u 0.9409 (0.9082) acc_u 6.2500 (10.9375) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/27] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.8394 (0.8865) acc_u 15.6250 (12.7083) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/27] time 0.190 (0.181) data 0.113 (0.104) loss_u loss_u 0.8716 (0.8896) acc_u 18.7500 (12.8125) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [25/27] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.8364 (0.8908) acc_u 15.6250 (12.5000) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 702
clean true:675
clean false:27
clean_rate:0.9615384615384616
noisy true:555
noisy false:343
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 898
epoch [189/200] batch [5/21] time 0.179 (0.177) data 0.102 (0.101) loss_x loss_x 0.7769 (0.5068) acc_x 78.1250 (86.2500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/21] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.3928 (0.4809) acc_x 87.5000 (87.5000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/21] time 0.175 (0.175) data 0.098 (0.099) loss_x loss_x 0.4231 (0.4954) acc_x 87.5000 (86.2500) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/21] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 0.6328 (0.4929) acc_x 87.5000 (87.0312) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/28] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.8213 (0.8780) acc_u 18.7500 (11.8750) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/28] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.8442 (0.8804) acc_u 15.6250 (12.8125) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/28] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.9453 (0.8916) acc_u 9.3750 (12.0833) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/28] time 0.190 (0.178) data 0.113 (0.101) loss_u loss_u 0.9419 (0.8918) acc_u 9.3750 (12.5000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [25/28] time 0.176 (0.178) data 0.098 (0.101) loss_u loss_u 0.8530 (0.8889) acc_u 15.6250 (12.7500) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.4550, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 728
clean true:700
clean false:28
clean_rate:0.9615384615384616
noisy true:552
noisy false:320
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 872
epoch [190/200] batch [5/22] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.3320 (0.2992) acc_x 87.5000 (93.1250) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/22] time 0.157 (0.177) data 0.080 (0.100) loss_x loss_x 0.6104 (0.4015) acc_x 87.5000 (90.6250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/22] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.1942 (0.4263) acc_x 93.7500 (90.4167) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/22] time 0.187 (0.177) data 0.111 (0.100) loss_x loss_x 0.5356 (0.4300) acc_x 84.3750 (89.8438) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/27] time 0.165 (0.175) data 0.089 (0.099) loss_u loss_u 0.8882 (0.8821) acc_u 12.5000 (12.5000) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/27] time 0.160 (0.174) data 0.084 (0.097) loss_u loss_u 0.9531 (0.9154) acc_u 3.1250 (9.6875) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/27] time 0.193 (0.175) data 0.116 (0.098) loss_u loss_u 0.8589 (0.9081) acc_u 15.6250 (10.6250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/27] time 0.184 (0.176) data 0.108 (0.099) loss_u loss_u 0.8999 (0.9120) acc_u 9.3750 (10.0000) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [25/27] time 0.188 (0.177) data 0.110 (0.100) loss_u loss_u 0.9282 (0.9219) acc_u 6.2500 (8.7500) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.4512, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 722
clean true:698
clean false:24
clean_rate:0.9667590027700831
noisy true:552
noisy false:326
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 878
epoch [191/200] batch [5/22] time 0.193 (0.188) data 0.117 (0.112) loss_x loss_x 0.3486 (0.6000) acc_x 93.7500 (85.0000) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/22] time 0.185 (0.183) data 0.109 (0.106) loss_x loss_x 0.7314 (0.5389) acc_x 75.0000 (85.6250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/22] time 0.157 (0.177) data 0.081 (0.100) loss_x loss_x 0.2104 (0.4977) acc_x 93.7500 (86.4583) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/22] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.3042 (0.4543) acc_x 90.6250 (87.6562) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/27] time 0.170 (0.172) data 0.093 (0.095) loss_u loss_u 0.8765 (0.9094) acc_u 12.5000 (10.0000) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/27] time 0.184 (0.174) data 0.108 (0.097) loss_u loss_u 0.8862 (0.8953) acc_u 12.5000 (11.5625) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/27] time 0.185 (0.175) data 0.108 (0.099) loss_u loss_u 0.8901 (0.9082) acc_u 9.3750 (10.0000) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/27] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8101 (0.9121) acc_u 25.0000 (9.6875) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [25/27] time 0.192 (0.178) data 0.115 (0.101) loss_u loss_u 0.8950 (0.9128) acc_u 12.5000 (9.5000) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.4531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 725
clean true:695
clean false:30
clean_rate:0.9586206896551724
noisy true:554
noisy false:321
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 875
epoch [192/200] batch [5/22] time 0.169 (0.185) data 0.092 (0.108) loss_x loss_x 0.4211 (0.3780) acc_x 93.7500 (90.6250) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/22] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.2605 (0.4304) acc_x 93.7500 (89.3750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/22] time 0.190 (0.179) data 0.113 (0.103) loss_x loss_x 0.3826 (0.4238) acc_x 84.3750 (89.3750) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/22] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.4736 (0.4136) acc_x 87.5000 (89.5312) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/27] time 0.166 (0.182) data 0.089 (0.105) loss_u loss_u 0.9180 (0.9173) acc_u 6.2500 (8.7500) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/27] time 0.189 (0.182) data 0.112 (0.105) loss_u loss_u 0.9058 (0.9167) acc_u 12.5000 (9.6875) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/27] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.9263 (0.9192) acc_u 9.3750 (9.3750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/27] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.9536 (0.9091) acc_u 3.1250 (10.1562) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [25/27] time 0.168 (0.182) data 0.090 (0.105) loss_u loss_u 0.8140 (0.9104) acc_u 15.6250 (9.8750) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 358
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 706
clean true:679
clean false:27
clean_rate:0.9617563739376771
noisy true:563
noisy false:331
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 894
epoch [193/200] batch [5/22] time 0.189 (0.187) data 0.112 (0.111) loss_x loss_x 0.3633 (0.5233) acc_x 87.5000 (84.3750) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/22] time 0.180 (0.186) data 0.104 (0.109) loss_x loss_x 0.5630 (0.4992) acc_x 84.3750 (85.0000) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/22] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.9287 (0.5045) acc_x 78.1250 (85.6250) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/22] time 0.174 (0.179) data 0.097 (0.103) loss_x loss_x 0.3494 (0.4996) acc_x 93.7500 (86.8750) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/27] time 0.161 (0.179) data 0.083 (0.103) loss_u loss_u 0.8994 (0.8886) acc_u 12.5000 (11.8750) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/27] time 0.181 (0.177) data 0.105 (0.101) loss_u loss_u 0.9604 (0.8847) acc_u 6.2500 (13.1250) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/27] time 0.160 (0.175) data 0.083 (0.099) loss_u loss_u 0.9146 (0.8904) acc_u 9.3750 (12.5000) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/27] time 0.179 (0.176) data 0.102 (0.100) loss_u loss_u 0.9082 (0.8917) acc_u 12.5000 (12.3438) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [25/27] time 0.185 (0.177) data 0.108 (0.101) loss_u loss_u 0.8418 (0.8945) acc_u 18.7500 (12.1250) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.4450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 712
clean true:684
clean false:28
clean_rate:0.9606741573033708
noisy true:549
noisy false:339
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 888
epoch [194/200] batch [5/22] time 0.167 (0.176) data 0.090 (0.099) loss_x loss_x 0.6655 (0.4875) acc_x 81.2500 (87.5000) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/22] time 0.188 (0.177) data 0.111 (0.101) loss_x loss_x 0.4185 (0.4971) acc_x 84.3750 (87.1875) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/22] time 0.185 (0.178) data 0.109 (0.102) loss_x loss_x 0.2253 (0.4942) acc_x 93.7500 (87.5000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/22] time 0.184 (0.180) data 0.107 (0.104) loss_x loss_x 0.4185 (0.4696) acc_x 87.5000 (88.1250) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/27] time 0.191 (0.182) data 0.114 (0.105) loss_u loss_u 0.9609 (0.9104) acc_u 3.1250 (10.0000) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/27] time 0.163 (0.182) data 0.086 (0.105) loss_u loss_u 0.8936 (0.9086) acc_u 12.5000 (10.3125) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/27] time 0.189 (0.182) data 0.112 (0.105) loss_u loss_u 0.9551 (0.9118) acc_u 9.3750 (10.2083) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/27] time 0.161 (0.181) data 0.083 (0.105) loss_u loss_u 0.9102 (0.9083) acc_u 9.3750 (10.4688) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [25/27] time 0.193 (0.180) data 0.117 (0.103) loss_u loss_u 0.9404 (0.9063) acc_u 6.2500 (10.5000) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4494, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 719
clean true:691
clean false:28
clean_rate:0.96105702364395
noisy true:540
noisy false:341
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 881
epoch [195/200] batch [5/22] time 0.172 (0.178) data 0.095 (0.101) loss_x loss_x 0.2170 (0.3705) acc_x 90.6250 (90.0000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/22] time 0.170 (0.176) data 0.094 (0.100) loss_x loss_x 0.3811 (0.3974) acc_x 87.5000 (90.0000) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/22] time 0.179 (0.178) data 0.102 (0.101) loss_x loss_x 0.4768 (0.4459) acc_x 84.3750 (88.1250) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/22] time 0.171 (0.178) data 0.094 (0.102) loss_x loss_x 0.1332 (0.4543) acc_x 96.8750 (87.8125) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/27] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8755 (0.8832) acc_u 12.5000 (13.7500) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/27] time 0.161 (0.180) data 0.083 (0.103) loss_u loss_u 0.9102 (0.8961) acc_u 9.3750 (11.8750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/27] time 0.164 (0.178) data 0.087 (0.101) loss_u loss_u 0.9414 (0.9004) acc_u 6.2500 (11.0417) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/27] time 0.179 (0.178) data 0.103 (0.101) loss_u loss_u 0.8989 (0.8981) acc_u 12.5000 (11.5625) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [25/27] time 0.179 (0.178) data 0.103 (0.101) loss_u loss_u 0.8726 (0.8961) acc_u 12.5000 (11.7500) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.4531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 725
clean true:696
clean false:29
clean_rate:0.96
noisy true:563
noisy false:312
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 875
epoch [196/200] batch [5/22] time 0.160 (0.166) data 0.084 (0.089) loss_x loss_x 0.4512 (0.6096) acc_x 87.5000 (85.6250) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/22] time 0.181 (0.167) data 0.102 (0.090) loss_x loss_x 0.4148 (0.5241) acc_x 93.7500 (86.5625) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/22] time 0.183 (0.168) data 0.106 (0.092) loss_x loss_x 0.5400 (0.5483) acc_x 90.6250 (86.0417) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/22] time 0.168 (0.170) data 0.091 (0.094) loss_x loss_x 0.8584 (0.5459) acc_x 87.5000 (86.7188) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/27] time 0.189 (0.172) data 0.113 (0.095) loss_u loss_u 0.9136 (0.9394) acc_u 9.3750 (6.2500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/27] time 0.164 (0.172) data 0.088 (0.095) loss_u loss_u 0.9282 (0.9119) acc_u 9.3750 (9.3750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/27] time 0.189 (0.173) data 0.111 (0.096) loss_u loss_u 0.9146 (0.9160) acc_u 9.3750 (8.9583) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/27] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.8066 (0.9092) acc_u 28.1250 (10.1562) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [25/27] time 0.160 (0.173) data 0.084 (0.096) loss_u loss_u 0.9028 (0.9176) acc_u 9.3750 (9.2500) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.4469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 715
clean true:687
clean false:28
clean_rate:0.9608391608391609
noisy true:556
noisy false:329
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 885
epoch [197/200] batch [5/22] time 0.178 (0.176) data 0.102 (0.100) loss_x loss_x 0.5864 (0.5821) acc_x 84.3750 (83.1250) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/22] time 0.169 (0.170) data 0.093 (0.094) loss_x loss_x 0.5254 (0.6013) acc_x 84.3750 (83.7500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/22] time 0.189 (0.171) data 0.113 (0.095) loss_x loss_x 0.2644 (0.5257) acc_x 96.8750 (86.8750) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/22] time 0.182 (0.175) data 0.105 (0.099) loss_x loss_x 0.5815 (0.5030) acc_x 81.2500 (86.5625) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/27] time 0.188 (0.178) data 0.110 (0.101) loss_u loss_u 0.9033 (0.9146) acc_u 9.3750 (10.0000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/27] time 0.159 (0.178) data 0.082 (0.101) loss_u loss_u 0.9229 (0.9196) acc_u 9.3750 (10.3125) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/27] time 0.164 (0.176) data 0.087 (0.099) loss_u loss_u 0.8560 (0.9042) acc_u 15.6250 (11.8750) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/27] time 0.175 (0.175) data 0.099 (0.098) loss_u loss_u 0.9360 (0.9042) acc_u 9.3750 (11.5625) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [25/27] time 0.178 (0.175) data 0.102 (0.099) loss_u loss_u 0.8989 (0.9062) acc_u 12.5000 (11.1250) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.4425, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 708
clean true:679
clean false:29
clean_rate:0.9590395480225988
noisy true:550
noisy false:342
after delete: len(clean_dataset) 708
after delete: len(noisy_dataset) 892
epoch [198/200] batch [5/22] time 0.183 (0.184) data 0.108 (0.108) loss_x loss_x 0.3813 (0.4263) acc_x 84.3750 (86.8750) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/22] time 0.189 (0.187) data 0.113 (0.111) loss_x loss_x 0.6846 (0.4187) acc_x 90.6250 (88.1250) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/22] time 0.190 (0.187) data 0.113 (0.111) loss_x loss_x 0.3711 (0.4771) acc_x 84.3750 (87.2917) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/22] time 0.175 (0.187) data 0.098 (0.111) loss_x loss_x 0.3457 (0.4930) acc_x 90.6250 (86.8750) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/27] time 0.202 (0.185) data 0.125 (0.108) loss_u loss_u 0.8828 (0.8921) acc_u 12.5000 (11.8750) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/27] time 0.174 (0.182) data 0.095 (0.106) loss_u loss_u 0.8799 (0.8954) acc_u 12.5000 (11.8750) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/27] time 0.173 (0.180) data 0.096 (0.104) loss_u loss_u 0.9185 (0.9039) acc_u 9.3750 (10.6250) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/27] time 0.181 (0.180) data 0.104 (0.104) loss_u loss_u 0.8701 (0.8958) acc_u 12.5000 (11.4062) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [25/27] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.8677 (0.8931) acc_u 15.6250 (11.6250) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.4544, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 727
clean true:698
clean false:29
clean_rate:0.9601100412654745
noisy true:546
noisy false:327
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 873
epoch [199/200] batch [5/22] time 0.188 (0.188) data 0.112 (0.112) loss_x loss_x 0.6699 (0.5107) acc_x 87.5000 (91.2500) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/22] time 0.181 (0.186) data 0.105 (0.110) loss_x loss_x 0.3091 (0.4261) acc_x 96.8750 (91.8750) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/22] time 0.180 (0.185) data 0.104 (0.109) loss_x loss_x 0.6831 (0.4741) acc_x 75.0000 (88.7500) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/22] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.3140 (0.4657) acc_x 93.7500 (89.2188) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/27] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.8237 (0.9117) acc_u 18.7500 (10.0000) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/27] time 0.176 (0.183) data 0.098 (0.107) loss_u loss_u 0.9683 (0.9222) acc_u 3.1250 (8.4375) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/27] time 0.163 (0.181) data 0.086 (0.105) loss_u loss_u 0.9331 (0.9060) acc_u 6.2500 (10.0000) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/27] time 0.177 (0.181) data 0.101 (0.104) loss_u loss_u 0.8115 (0.9074) acc_u 18.7500 (9.6875) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [25/27] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9331 (0.9069) acc_u 6.2500 (9.8750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 714
clean true:686
clean false:28
clean_rate:0.9607843137254902
noisy true:551
noisy false:335
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 886
epoch [200/200] batch [5/22] time 0.177 (0.181) data 0.101 (0.105) loss_x loss_x 0.3486 (0.3995) acc_x 87.5000 (88.7500) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/22] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.2029 (0.4149) acc_x 96.8750 (89.0625) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/22] time 0.163 (0.174) data 0.087 (0.097) loss_x loss_x 0.7363 (0.4435) acc_x 84.3750 (88.5417) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/22] time 0.184 (0.175) data 0.109 (0.099) loss_x loss_x 0.5918 (0.4745) acc_x 90.6250 (88.2812) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/27] time 0.175 (0.177) data 0.098 (0.100) loss_u loss_u 0.9087 (0.8928) acc_u 9.3750 (13.1250) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/27] time 0.190 (0.178) data 0.113 (0.101) loss_u loss_u 0.8755 (0.8976) acc_u 12.5000 (11.5625) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/27] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.9292 (0.9123) acc_u 9.3750 (9.7917) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/27] time 0.176 (0.176) data 0.099 (0.099) loss_u loss_u 0.8164 (0.9032) acc_u 21.8750 (10.9375) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [25/27] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.8662 (0.9040) acc_u 15.6250 (10.7500) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/caltech101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,199
* accuracy: 89.2%
* error: 10.8%
* macro_f1: 84.3%
Elapsed: 0:58:04
