***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_pets.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '37']
output_dir: output/oxford_pets/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordPets
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 37
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/oxford_pets/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordPets
Reading split from /home/convex/datasets/nlprompt/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_pets/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 18
Data loader size: 2
Data loader size: 37
---------  ----------
Dataset    OxfordPets
# classes  37
# train_x  592
# val      148
# test     3,669
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/oxford_pets/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 333
confident_label rate tensor(0.1453, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 86
clean true:73
clean false:13
clean_rate:0.8488372093023255
noisy true:186
noisy false:320
after delete: len(clean_dataset) 86
after delete: len(noisy_dataset) 506
epoch [1/200] batch [1/2] time 0.356 (0.356) data 0.222 (0.222) loss_x loss_x 2.6465 (2.6465) acc_x 25.0000 (25.0000) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [2/2] time 0.271 (0.313) data 0.228 (0.225) loss_x loss_x 2.3867 (2.5166) acc_x 28.1250 (26.5625) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/15] time 0.272 (0.279) data 0.229 (0.221) loss_u loss_u 0.9404 (0.9590) acc_u 9.3750 (3.7500) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [10/15] time 0.260 (0.269) data 0.216 (0.218) loss_u loss_u 0.9795 (0.9599) acc_u 0.0000 (4.0625) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [15/15] time 0.251 (0.266) data 0.209 (0.217) loss_u loss_u 0.9609 (0.9604) acc_u 3.1250 (3.7500) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 301
confident_label rate tensor(0.1571, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 93
clean true:78
clean false:15
clean_rate:0.8387096774193549
noisy true:213
noisy false:286
after delete: len(clean_dataset) 93
after delete: len(noisy_dataset) 499
epoch [2/200] batch [1/2] time 0.284 (0.284) data 0.242 (0.242) loss_x loss_x 1.7256 (1.7256) acc_x 62.5000 (62.5000) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [2/2] time 0.284 (0.284) data 0.242 (0.242) loss_x loss_x 0.9512 (1.3384) acc_x 75.0000 (68.7500) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/15] time 0.263 (0.267) data 0.219 (0.224) loss_u loss_u 0.9326 (0.9223) acc_u 9.3750 (8.7500) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [10/15] time 0.265 (0.266) data 0.221 (0.223) loss_u loss_u 0.9639 (0.9234) acc_u 3.1250 (7.8125) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [15/15] time 0.256 (0.262) data 0.214 (0.219) loss_u loss_u 0.8618 (0.9217) acc_u 12.5000 (7.9167) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 183
confident_label rate tensor(0.1875, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 111
clean true:101
clean false:10
clean_rate:0.9099099099099099
noisy true:308
noisy false:173
after delete: len(clean_dataset) 111
after delete: len(noisy_dataset) 481
epoch [3/200] batch [1/3] time 0.243 (0.243) data 0.201 (0.201) loss_x loss_x 0.6680 (0.6680) acc_x 75.0000 (75.0000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [2/3] time 0.260 (0.251) data 0.217 (0.209) loss_x loss_x 1.0273 (0.8477) acc_x 75.0000 (75.0000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [3/3] time 0.295 (0.266) data 0.254 (0.224) loss_x loss_x 0.9062 (0.8672) acc_x 75.0000 (75.0000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/15] time 0.256 (0.271) data 0.213 (0.229) loss_u loss_u 0.9297 (0.9123) acc_u 6.2500 (8.7500) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/15] time 0.273 (0.268) data 0.228 (0.226) loss_u loss_u 0.9429 (0.9298) acc_u 3.1250 (6.8750) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/15] time 0.266 (0.268) data 0.221 (0.226) loss_u loss_u 0.8408 (0.9225) acc_u 18.7500 (7.9167) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 164
confident_label rate tensor(0.2010, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 119
clean true:111
clean false:8
clean_rate:0.9327731092436975
noisy true:317
noisy false:156
after delete: len(clean_dataset) 119
after delete: len(noisy_dataset) 473
epoch [4/200] batch [1/3] time 0.278 (0.278) data 0.237 (0.237) loss_x loss_x 0.6421 (0.6421) acc_x 90.6250 (90.6250) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [2/3] time 0.239 (0.259) data 0.196 (0.216) loss_x loss_x 0.6743 (0.6582) acc_x 84.3750 (87.5000) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [3/3] time 0.262 (0.260) data 0.220 (0.218) loss_x loss_x 0.8218 (0.7127) acc_x 78.1250 (84.3750) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/14] time 0.278 (0.263) data 0.229 (0.219) loss_u loss_u 0.9536 (0.9316) acc_u 12.5000 (9.3750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/14] time 0.262 (0.260) data 0.220 (0.217) loss_u loss_u 0.9624 (0.9458) acc_u 6.2500 (6.8750) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 170
confident_label rate tensor(0.2061, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 122
clean true:111
clean false:11
clean_rate:0.9098360655737705
noisy true:311
noisy false:159
after delete: len(clean_dataset) 122
after delete: len(noisy_dataset) 470
epoch [5/200] batch [1/3] time 0.271 (0.271) data 0.230 (0.230) loss_x loss_x 0.8062 (0.8062) acc_x 71.8750 (71.8750) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [2/3] time 0.266 (0.269) data 0.225 (0.227) loss_x loss_x 0.7969 (0.8015) acc_x 78.1250 (75.0000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [3/3] time 0.281 (0.273) data 0.239 (0.231) loss_x loss_x 0.6528 (0.7520) acc_x 81.2500 (77.0833) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/14] time 0.268 (0.266) data 0.222 (0.223) loss_u loss_u 0.9668 (0.9413) acc_u 3.1250 (6.2500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/14] time 0.264 (0.264) data 0.223 (0.221) loss_u loss_u 0.9312 (0.9402) acc_u 6.2500 (6.2500) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 155
confident_label rate tensor(0.2196, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 130
clean true:122
clean false:8
clean_rate:0.9384615384615385
noisy true:315
noisy false:147
after delete: len(clean_dataset) 130
after delete: len(noisy_dataset) 462
epoch [6/200] batch [1/4] time 0.285 (0.285) data 0.243 (0.243) loss_x loss_x 0.7563 (0.7563) acc_x 75.0000 (75.0000) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [2/4] time 0.270 (0.277) data 0.228 (0.236) loss_x loss_x 0.7271 (0.7417) acc_x 75.0000 (75.0000) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [3/4] time 0.259 (0.271) data 0.217 (0.230) loss_x loss_x 0.5884 (0.6906) acc_x 84.3750 (78.1250) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [4/4] time 0.267 (0.270) data 0.225 (0.228) loss_x loss_x 0.8706 (0.7356) acc_x 78.1250 (78.1250) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/14] time 0.255 (0.268) data 0.211 (0.226) loss_u loss_u 0.9717 (0.9503) acc_u 3.1250 (4.3750) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/14] time 0.252 (0.266) data 0.209 (0.224) loss_u loss_u 0.8970 (0.9393) acc_u 9.3750 (5.6250) lr 1.9980e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 186
confident_label rate tensor(0.1976, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 117
clean true:103
clean false:14
clean_rate:0.8803418803418803
noisy true:303
noisy false:172
after delete: len(clean_dataset) 117
after delete: len(noisy_dataset) 475
epoch [7/200] batch [1/3] time 0.282 (0.282) data 0.240 (0.240) loss_x loss_x 1.0293 (1.0293) acc_x 75.0000 (75.0000) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [2/3] time 0.258 (0.270) data 0.216 (0.228) loss_x loss_x 0.6704 (0.8499) acc_x 75.0000 (75.0000) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [3/3] time 0.281 (0.274) data 0.239 (0.232) loss_x loss_x 0.5239 (0.7412) acc_x 93.7500 (81.2500) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/14] time 0.283 (0.273) data 0.240 (0.231) loss_u loss_u 0.8716 (0.9238) acc_u 12.5000 (7.5000) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/14] time 0.252 (0.268) data 0.210 (0.226) loss_u loss_u 0.9482 (0.9295) acc_u 6.2500 (6.8750) lr 1.9969e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 149
confident_label rate tensor(0.2297, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 136
clean true:123
clean false:13
clean_rate:0.9044117647058824
noisy true:320
noisy false:136
after delete: len(clean_dataset) 136
after delete: len(noisy_dataset) 456
epoch [8/200] batch [1/4] time 0.267 (0.267) data 0.225 (0.225) loss_x loss_x 0.6699 (0.6699) acc_x 84.3750 (84.3750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [2/4] time 0.297 (0.282) data 0.254 (0.239) loss_x loss_x 0.5649 (0.6174) acc_x 84.3750 (84.3750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [3/4] time 0.284 (0.283) data 0.241 (0.240) loss_x loss_x 0.6660 (0.6336) acc_x 81.2500 (83.3333) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [4/4] time 0.268 (0.279) data 0.226 (0.236) loss_x loss_x 0.6123 (0.6283) acc_x 81.2500 (82.8125) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/14] time 0.265 (0.268) data 0.223 (0.225) loss_u loss_u 0.9609 (0.9398) acc_u 3.1250 (6.8750) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/14] time 0.282 (0.270) data 0.240 (0.227) loss_u loss_u 0.9453 (0.9498) acc_u 3.1250 (5.6250) lr 1.9956e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 155
confident_label rate tensor(0.2162, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 128
clean true:118
clean false:10
clean_rate:0.921875
noisy true:319
noisy false:145
after delete: len(clean_dataset) 128
after delete: len(noisy_dataset) 464
epoch [9/200] batch [1/4] time 0.291 (0.291) data 0.249 (0.249) loss_x loss_x 0.6406 (0.6406) acc_x 84.3750 (84.3750) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [2/4] time 0.272 (0.282) data 0.229 (0.239) loss_x loss_x 0.5903 (0.6155) acc_x 84.3750 (84.3750) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [3/4] time 0.300 (0.288) data 0.257 (0.245) loss_x loss_x 0.5986 (0.6099) acc_x 81.2500 (83.3333) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [4/4] time 0.288 (0.288) data 0.245 (0.245) loss_x loss_x 0.4866 (0.5790) acc_x 87.5000 (84.3750) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/14] time 0.234 (0.278) data 0.192 (0.235) loss_u loss_u 0.9355 (0.9481) acc_u 6.2500 (6.2500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/14] time 0.270 (0.271) data 0.227 (0.228) loss_u loss_u 0.8867 (0.9367) acc_u 12.5000 (7.1875) lr 1.9940e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 145
confident_label rate tensor(0.2111, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 125
clean true:114
clean false:11
clean_rate:0.912
noisy true:333
noisy false:134
after delete: len(clean_dataset) 125
after delete: len(noisy_dataset) 467
epoch [10/200] batch [1/3] time 0.275 (0.275) data 0.232 (0.232) loss_x loss_x 0.3105 (0.3105) acc_x 90.6250 (90.6250) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [2/3] time 0.263 (0.269) data 0.222 (0.227) loss_x loss_x 0.7163 (0.5134) acc_x 75.0000 (82.8125) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [3/3] time 0.275 (0.271) data 0.233 (0.229) loss_x loss_x 0.7329 (0.5866) acc_x 90.6250 (85.4167) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/14] time 0.279 (0.266) data 0.236 (0.224) loss_u loss_u 0.9204 (0.9351) acc_u 12.5000 (6.8750) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/14] time 0.262 (0.271) data 0.219 (0.228) loss_u loss_u 0.9526 (0.9238) acc_u 6.2500 (8.1250) lr 1.9921e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 152
confident_label rate tensor(0.2280, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 135
clean true:117
clean false:18
clean_rate:0.8666666666666667
noisy true:323
noisy false:134
after delete: len(clean_dataset) 135
after delete: len(noisy_dataset) 457
epoch [11/200] batch [1/4] time 0.236 (0.236) data 0.193 (0.193) loss_x loss_x 0.3745 (0.3745) acc_x 84.3750 (84.3750) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [2/4] time 0.313 (0.274) data 0.271 (0.232) loss_x loss_x 0.5723 (0.4734) acc_x 81.2500 (82.8125) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [3/4] time 0.268 (0.272) data 0.226 (0.230) loss_x loss_x 0.6577 (0.5348) acc_x 81.2500 (82.2917) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [4/4] time 0.278 (0.273) data 0.236 (0.232) loss_x loss_x 0.7754 (0.5950) acc_x 71.8750 (79.6875) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/14] time 0.283 (0.277) data 0.242 (0.235) loss_u loss_u 0.9434 (0.9249) acc_u 6.2500 (6.8750) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/14] time 0.269 (0.271) data 0.227 (0.228) loss_u loss_u 0.9521 (0.9260) acc_u 6.2500 (7.8125) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 166
confident_label rate tensor(0.2280, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 135
clean true:112
clean false:23
clean_rate:0.8296296296296296
noisy true:314
noisy false:143
after delete: len(clean_dataset) 135
after delete: len(noisy_dataset) 457
epoch [12/200] batch [1/4] time 0.295 (0.295) data 0.252 (0.252) loss_x loss_x 0.5635 (0.5635) acc_x 84.3750 (84.3750) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [2/4] time 0.261 (0.278) data 0.219 (0.236) loss_x loss_x 0.8120 (0.6877) acc_x 81.2500 (82.8125) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [3/4] time 0.299 (0.285) data 0.257 (0.243) loss_x loss_x 0.4512 (0.6089) acc_x 87.5000 (84.3750) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [4/4] time 0.289 (0.286) data 0.246 (0.244) loss_x loss_x 0.6606 (0.6218) acc_x 81.2500 (83.5938) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/14] time 0.255 (0.275) data 0.213 (0.232) loss_u loss_u 0.9473 (0.9283) acc_u 6.2500 (7.5000) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/14] time 0.282 (0.273) data 0.240 (0.231) loss_u loss_u 0.9243 (0.9243) acc_u 9.3750 (7.8125) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 169
confident_label rate tensor(0.2196, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 130
clean true:110
clean false:20
clean_rate:0.8461538461538461
noisy true:313
noisy false:149
after delete: len(clean_dataset) 130
after delete: len(noisy_dataset) 462
epoch [13/200] batch [1/4] time 0.281 (0.281) data 0.238 (0.238) loss_x loss_x 0.5166 (0.5166) acc_x 81.2500 (81.2500) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [2/4] time 0.314 (0.298) data 0.272 (0.255) loss_x loss_x 0.7930 (0.6548) acc_x 78.1250 (79.6875) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [3/4] time 0.260 (0.285) data 0.219 (0.243) loss_x loss_x 0.4634 (0.5910) acc_x 81.2500 (80.2083) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [4/4] time 0.278 (0.283) data 0.236 (0.241) loss_x loss_x 0.7065 (0.6199) acc_x 81.2500 (80.4688) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/14] time 0.277 (0.276) data 0.235 (0.234) loss_u loss_u 0.9424 (0.9354) acc_u 6.2500 (7.5000) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/14] time 0.277 (0.278) data 0.235 (0.236) loss_u loss_u 0.9033 (0.9353) acc_u 15.6250 (7.8125) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 165
confident_label rate tensor(0.2280, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 135
clean true:114
clean false:21
clean_rate:0.8444444444444444
noisy true:313
noisy false:144
after delete: len(clean_dataset) 135
after delete: len(noisy_dataset) 457
epoch [14/200] batch [1/4] time 0.289 (0.289) data 0.245 (0.245) loss_x loss_x 0.8574 (0.8574) acc_x 75.0000 (75.0000) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [2/4] time 0.280 (0.285) data 0.238 (0.241) loss_x loss_x 0.6079 (0.7327) acc_x 81.2500 (78.1250) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [3/4] time 0.294 (0.288) data 0.251 (0.245) loss_x loss_x 0.5449 (0.6701) acc_x 81.2500 (79.1667) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [4/4] time 0.264 (0.282) data 0.223 (0.239) loss_x loss_x 0.7144 (0.6812) acc_x 81.2500 (79.6875) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/14] time 0.258 (0.277) data 0.216 (0.234) loss_u loss_u 0.9214 (0.9472) acc_u 6.2500 (5.0000) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/14] time 0.266 (0.271) data 0.223 (0.228) loss_u loss_u 0.9111 (0.9366) acc_u 9.3750 (6.5625) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 159
confident_label rate tensor(0.2213, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 131
clean true:115
clean false:16
clean_rate:0.8778625954198473
noisy true:318
noisy false:143
after delete: len(clean_dataset) 131
after delete: len(noisy_dataset) 461
epoch [15/200] batch [1/4] time 0.296 (0.296) data 0.254 (0.254) loss_x loss_x 0.8721 (0.8721) acc_x 68.7500 (68.7500) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [2/4] time 0.278 (0.287) data 0.236 (0.245) loss_x loss_x 0.7500 (0.8110) acc_x 71.8750 (70.3125) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [3/4] time 0.254 (0.276) data 0.212 (0.234) loss_x loss_x 0.2146 (0.6122) acc_x 93.7500 (78.1250) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [4/4] time 0.267 (0.274) data 0.225 (0.232) loss_x loss_x 0.5234 (0.5900) acc_x 84.3750 (79.6875) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/14] time 0.281 (0.268) data 0.238 (0.226) loss_u loss_u 0.9736 (0.9179) acc_u 0.0000 (8.1250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/14] time 0.293 (0.269) data 0.251 (0.226) loss_u loss_u 0.8979 (0.9185) acc_u 15.6250 (9.3750) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 163
confident_label rate tensor(0.2416, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 143
clean true:123
clean false:20
clean_rate:0.8601398601398601
noisy true:306
noisy false:143
after delete: len(clean_dataset) 143
after delete: len(noisy_dataset) 449
epoch [16/200] batch [1/4] time 0.296 (0.296) data 0.254 (0.254) loss_x loss_x 0.7803 (0.7803) acc_x 78.1250 (78.1250) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [2/4] time 0.270 (0.283) data 0.228 (0.241) loss_x loss_x 0.5254 (0.6528) acc_x 81.2500 (79.6875) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [3/4] time 0.247 (0.271) data 0.205 (0.229) loss_x loss_x 0.3718 (0.5592) acc_x 93.7500 (84.3750) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [4/4] time 0.269 (0.270) data 0.227 (0.228) loss_x loss_x 0.4812 (0.5397) acc_x 81.2500 (83.5938) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/14] time 0.256 (0.268) data 0.213 (0.226) loss_u loss_u 0.9653 (0.9220) acc_u 3.1250 (8.1250) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/14] time 0.278 (0.267) data 0.236 (0.225) loss_u loss_u 0.9033 (0.9242) acc_u 9.3750 (7.8125) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 164
confident_label rate tensor(0.2466, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 146
clean true:120
clean false:26
clean_rate:0.821917808219178
noisy true:308
noisy false:138
after delete: len(clean_dataset) 146
after delete: len(noisy_dataset) 446
epoch [17/200] batch [1/4] time 0.321 (0.321) data 0.279 (0.279) loss_x loss_x 0.7881 (0.7881) acc_x 81.2500 (81.2500) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [2/4] time 0.279 (0.300) data 0.237 (0.258) loss_x loss_x 0.8384 (0.8132) acc_x 78.1250 (79.6875) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [3/4] time 0.279 (0.293) data 0.237 (0.251) loss_x loss_x 0.4744 (0.7003) acc_x 87.5000 (82.2917) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [4/4] time 0.267 (0.287) data 0.225 (0.245) loss_x loss_x 0.8540 (0.7387) acc_x 68.7500 (78.9062) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/13] time 0.266 (0.276) data 0.223 (0.234) loss_u loss_u 0.9502 (0.9154) acc_u 3.1250 (10.0000) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/13] time 0.259 (0.268) data 0.217 (0.225) loss_u loss_u 0.9619 (0.9229) acc_u 3.1250 (8.7500) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 167
confident_label rate tensor(0.2382, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 141
clean true:114
clean false:27
clean_rate:0.8085106382978723
noisy true:311
noisy false:140
after delete: len(clean_dataset) 141
after delete: len(noisy_dataset) 451
epoch [18/200] batch [1/4] time 0.288 (0.288) data 0.246 (0.246) loss_x loss_x 0.5420 (0.5420) acc_x 84.3750 (84.3750) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [2/4] time 0.273 (0.280) data 0.231 (0.239) loss_x loss_x 0.4543 (0.4982) acc_x 78.1250 (81.2500) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [3/4] time 0.264 (0.275) data 0.222 (0.233) loss_x loss_x 0.6216 (0.5393) acc_x 78.1250 (80.2083) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [4/4] time 0.282 (0.277) data 0.240 (0.235) loss_x loss_x 0.4661 (0.5210) acc_x 90.6250 (82.8125) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/14] time 0.283 (0.274) data 0.241 (0.233) loss_u loss_u 0.9619 (0.8821) acc_u 6.2500 (13.7500) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/14] time 0.246 (0.270) data 0.202 (0.228) loss_u loss_u 0.8364 (0.8869) acc_u 21.8750 (13.7500) lr 1.9686e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 201
confident_label rate tensor(0.2466, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 146
clean true:108
clean false:38
clean_rate:0.7397260273972602
noisy true:283
noisy false:163
after delete: len(clean_dataset) 146
after delete: len(noisy_dataset) 446
epoch [19/200] batch [1/4] time 0.288 (0.288) data 0.241 (0.241) loss_x loss_x 0.3181 (0.3181) acc_x 93.7500 (93.7500) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [2/4] time 0.311 (0.299) data 0.265 (0.253) loss_x loss_x 1.1602 (0.7391) acc_x 71.8750 (82.8125) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [3/4] time 0.258 (0.285) data 0.216 (0.241) loss_x loss_x 0.5708 (0.6830) acc_x 84.3750 (83.3333) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [4/4] time 0.276 (0.283) data 0.234 (0.239) loss_x loss_x 0.6880 (0.6843) acc_x 87.5000 (84.3750) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/13] time 0.255 (0.277) data 0.212 (0.234) loss_u loss_u 0.8496 (0.9190) acc_u 15.6250 (9.3750) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [10/13] time 0.251 (0.272) data 0.209 (0.229) loss_u loss_u 0.8945 (0.9185) acc_u 12.5000 (9.0625) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 194
confident_label rate tensor(0.2568, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 152
clean true:116
clean false:36
clean_rate:0.7631578947368421
noisy true:282
noisy false:158
after delete: len(clean_dataset) 152
after delete: len(noisy_dataset) 440
epoch [20/200] batch [1/4] time 0.255 (0.255) data 0.213 (0.213) loss_x loss_x 0.9639 (0.9639) acc_x 84.3750 (84.3750) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [2/4] time 0.273 (0.264) data 0.231 (0.222) loss_x loss_x 0.9990 (0.9814) acc_x 68.7500 (76.5625) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [3/4] time 0.317 (0.282) data 0.275 (0.240) loss_x loss_x 0.9019 (0.9549) acc_x 87.5000 (80.2083) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [4/4] time 0.277 (0.281) data 0.234 (0.238) loss_x loss_x 0.5708 (0.8589) acc_x 84.3750 (81.2500) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/13] time 0.256 (0.271) data 0.214 (0.229) loss_u loss_u 0.9043 (0.9196) acc_u 9.3750 (9.3750) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [10/13] time 0.276 (0.270) data 0.233 (0.228) loss_u loss_u 0.9619 (0.9043) acc_u 6.2500 (11.8750) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 197
confident_label rate tensor(0.2466, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 146
clean true:108
clean false:38
clean_rate:0.7397260273972602
noisy true:287
noisy false:159
after delete: len(clean_dataset) 146
after delete: len(noisy_dataset) 446
epoch [21/200] batch [1/4] time 0.277 (0.277) data 0.234 (0.234) loss_x loss_x 0.6372 (0.6372) acc_x 81.2500 (81.2500) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [2/4] time 0.277 (0.277) data 0.235 (0.234) loss_x loss_x 0.9507 (0.7939) acc_x 68.7500 (75.0000) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [3/4] time 0.280 (0.278) data 0.239 (0.236) loss_x loss_x 1.1094 (0.8991) acc_x 75.0000 (75.0000) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [4/4] time 0.271 (0.276) data 0.230 (0.234) loss_x loss_x 0.7959 (0.8733) acc_x 84.3750 (77.3438) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/13] time 0.252 (0.267) data 0.209 (0.225) loss_u loss_u 0.9370 (0.9071) acc_u 9.3750 (10.0000) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [10/13] time 0.258 (0.266) data 0.216 (0.224) loss_u loss_u 0.8823 (0.9099) acc_u 15.6250 (10.0000) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 173
confident_label rate tensor(0.2483, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 147
clean true:117
clean false:30
clean_rate:0.7959183673469388
noisy true:302
noisy false:143
after delete: len(clean_dataset) 147
after delete: len(noisy_dataset) 445
epoch [22/200] batch [1/4] time 0.262 (0.262) data 0.217 (0.217) loss_x loss_x 0.3545 (0.3545) acc_x 90.6250 (90.6250) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [2/4] time 0.266 (0.264) data 0.224 (0.221) loss_x loss_x 0.5811 (0.4678) acc_x 87.5000 (89.0625) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [3/4] time 0.290 (0.273) data 0.247 (0.230) loss_x loss_x 0.3667 (0.4341) acc_x 90.6250 (89.5833) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [4/4] time 0.327 (0.287) data 0.285 (0.243) loss_x loss_x 0.4910 (0.4483) acc_x 87.5000 (89.0625) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/13] time 0.293 (0.275) data 0.235 (0.231) loss_u loss_u 0.9600 (0.9291) acc_u 3.1250 (7.5000) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/13] time 0.272 (0.272) data 0.228 (0.229) loss_u loss_u 0.9067 (0.9104) acc_u 12.5000 (10.0000) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 184
confident_label rate tensor(0.2382, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 141
clean true:109
clean false:32
clean_rate:0.7730496453900709
noisy true:299
noisy false:152
after delete: len(clean_dataset) 141
after delete: len(noisy_dataset) 451
epoch [23/200] batch [1/4] time 0.297 (0.297) data 0.254 (0.254) loss_x loss_x 0.4741 (0.4741) acc_x 87.5000 (87.5000) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [2/4] time 0.298 (0.297) data 0.256 (0.255) loss_x loss_x 0.6147 (0.5444) acc_x 81.2500 (84.3750) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [3/4] time 0.269 (0.288) data 0.227 (0.246) loss_x loss_x 0.4543 (0.5144) acc_x 90.6250 (86.4583) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [4/4] time 0.273 (0.284) data 0.231 (0.242) loss_x loss_x 0.5596 (0.5257) acc_x 84.3750 (85.9375) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/14] time 0.270 (0.271) data 0.227 (0.228) loss_u loss_u 0.8306 (0.8900) acc_u 18.7500 (11.8750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [10/14] time 0.244 (0.269) data 0.198 (0.226) loss_u loss_u 0.9023 (0.9026) acc_u 9.3750 (10.3125) lr 1.9461e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 170
confident_label rate tensor(0.2432, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 144
clean true:110
clean false:34
clean_rate:0.7638888888888888
noisy true:312
noisy false:136
after delete: len(clean_dataset) 144
after delete: len(noisy_dataset) 448
epoch [24/200] batch [1/4] time 0.323 (0.323) data 0.281 (0.281) loss_x loss_x 0.6138 (0.6138) acc_x 81.2500 (81.2500) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [2/4] time 0.295 (0.309) data 0.253 (0.267) loss_x loss_x 0.3806 (0.4972) acc_x 90.6250 (85.9375) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [3/4] time 0.289 (0.302) data 0.247 (0.260) loss_x loss_x 0.5610 (0.5185) acc_x 84.3750 (85.4167) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [4/4] time 0.281 (0.297) data 0.240 (0.255) loss_x loss_x 1.1006 (0.6640) acc_x 65.6250 (80.4688) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/14] time 0.278 (0.282) data 0.236 (0.240) loss_u loss_u 0.9009 (0.9281) acc_u 9.3750 (7.5000) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/14] time 0.241 (0.271) data 0.199 (0.229) loss_u loss_u 0.9800 (0.9254) acc_u 3.1250 (8.7500) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 196
confident_label rate tensor(0.2483, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 147
clean true:112
clean false:35
clean_rate:0.7619047619047619
noisy true:284
noisy false:161
after delete: len(clean_dataset) 147
after delete: len(noisy_dataset) 445
epoch [25/200] batch [1/4] time 0.271 (0.271) data 0.229 (0.229) loss_x loss_x 0.7246 (0.7246) acc_x 75.0000 (75.0000) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [2/4] time 0.278 (0.274) data 0.234 (0.231) loss_x loss_x 0.5039 (0.6143) acc_x 81.2500 (78.1250) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [3/4] time 0.292 (0.280) data 0.249 (0.237) loss_x loss_x 0.3682 (0.5322) acc_x 90.6250 (82.2917) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [4/4] time 0.326 (0.292) data 0.281 (0.248) loss_x loss_x 0.2795 (0.4691) acc_x 87.5000 (83.5938) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/13] time 0.272 (0.284) data 0.230 (0.242) loss_u loss_u 0.9502 (0.9171) acc_u 9.3750 (9.3750) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/13] time 0.259 (0.277) data 0.217 (0.235) loss_u loss_u 0.9482 (0.9195) acc_u 0.0000 (8.4375) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 191
confident_label rate tensor(0.2551, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 151
clean true:111
clean false:40
clean_rate:0.7350993377483444
noisy true:290
noisy false:151
after delete: len(clean_dataset) 151
after delete: len(noisy_dataset) 441
epoch [26/200] batch [1/4] time 0.265 (0.265) data 0.222 (0.222) loss_x loss_x 0.4180 (0.4180) acc_x 87.5000 (87.5000) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [2/4] time 0.280 (0.272) data 0.238 (0.230) loss_x loss_x 0.7754 (0.5967) acc_x 84.3750 (85.9375) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [3/4] time 0.271 (0.272) data 0.229 (0.230) loss_x loss_x 0.4778 (0.5570) acc_x 87.5000 (86.4583) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [4/4] time 0.293 (0.277) data 0.251 (0.235) loss_x loss_x 0.9565 (0.6569) acc_x 78.1250 (84.3750) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/13] time 0.269 (0.271) data 0.226 (0.228) loss_u loss_u 0.8818 (0.8956) acc_u 12.5000 (13.1250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/13] time 0.272 (0.269) data 0.229 (0.226) loss_u loss_u 0.8911 (0.9125) acc_u 12.5000 (10.3125) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 182
confident_label rate tensor(0.2517, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 149
clean true:111
clean false:38
clean_rate:0.7449664429530202
noisy true:299
noisy false:144
after delete: len(clean_dataset) 149
after delete: len(noisy_dataset) 443
epoch [27/200] batch [1/4] time 0.286 (0.286) data 0.244 (0.244) loss_x loss_x 0.7534 (0.7534) acc_x 78.1250 (78.1250) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [2/4] time 0.256 (0.271) data 0.215 (0.229) loss_x loss_x 0.8213 (0.7874) acc_x 87.5000 (82.8125) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [3/4] time 0.265 (0.269) data 0.224 (0.228) loss_x loss_x 0.5552 (0.7100) acc_x 87.5000 (84.3750) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [4/4] time 0.262 (0.267) data 0.220 (0.226) loss_x loss_x 0.9858 (0.7789) acc_x 81.2500 (83.5938) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/13] time 0.268 (0.264) data 0.225 (0.223) loss_u loss_u 0.8965 (0.9055) acc_u 12.5000 (11.8750) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/13] time 0.253 (0.264) data 0.210 (0.222) loss_u loss_u 0.9263 (0.9193) acc_u 6.2500 (10.0000) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 200
confident_label rate tensor(0.2635, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 156
clean true:112
clean false:44
clean_rate:0.717948717948718
noisy true:280
noisy false:156
after delete: len(clean_dataset) 156
after delete: len(noisy_dataset) 436
epoch [28/200] batch [1/4] time 0.269 (0.269) data 0.227 (0.227) loss_x loss_x 1.4092 (1.4092) acc_x 68.7500 (68.7500) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [2/4] time 0.281 (0.275) data 0.239 (0.233) loss_x loss_x 0.4258 (0.9175) acc_x 84.3750 (76.5625) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [3/4] time 0.274 (0.274) data 0.232 (0.233) loss_x loss_x 0.4868 (0.7739) acc_x 90.6250 (81.2500) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [4/4] time 0.300 (0.281) data 0.258 (0.239) loss_x loss_x 0.3748 (0.6741) acc_x 87.5000 (82.8125) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/13] time 0.265 (0.270) data 0.223 (0.228) loss_u loss_u 0.8931 (0.9150) acc_u 12.5000 (10.6250) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/13] time 0.251 (0.265) data 0.209 (0.223) loss_u loss_u 0.9097 (0.9178) acc_u 12.5000 (10.6250) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 178
confident_label rate tensor(0.2584, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 153
clean true:115
clean false:38
clean_rate:0.7516339869281046
noisy true:299
noisy false:140
after delete: len(clean_dataset) 153
after delete: len(noisy_dataset) 439
epoch [29/200] batch [1/4] time 0.265 (0.265) data 0.223 (0.223) loss_x loss_x 0.6812 (0.6812) acc_x 75.0000 (75.0000) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [2/4] time 0.274 (0.269) data 0.232 (0.227) loss_x loss_x 0.5186 (0.5999) acc_x 81.2500 (78.1250) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [3/4] time 0.268 (0.269) data 0.227 (0.227) loss_x loss_x 0.4868 (0.5622) acc_x 90.6250 (82.2917) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [4/4] time 0.279 (0.272) data 0.237 (0.230) loss_x loss_x 0.6006 (0.5718) acc_x 87.5000 (83.5938) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/13] time 0.275 (0.275) data 0.233 (0.233) loss_u loss_u 0.9341 (0.9178) acc_u 6.2500 (9.3750) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/13] time 0.262 (0.270) data 0.220 (0.228) loss_u loss_u 0.9087 (0.9214) acc_u 9.3750 (9.0625) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 191
confident_label rate tensor(0.2551, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 151
clean true:114
clean false:37
clean_rate:0.7549668874172185
noisy true:287
noisy false:154
after delete: len(clean_dataset) 151
after delete: len(noisy_dataset) 441
epoch [30/200] batch [1/4] time 0.280 (0.280) data 0.238 (0.238) loss_x loss_x 0.5488 (0.5488) acc_x 87.5000 (87.5000) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [2/4] time 0.285 (0.282) data 0.243 (0.240) loss_x loss_x 0.7153 (0.6321) acc_x 81.2500 (84.3750) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [3/4] time 0.279 (0.281) data 0.237 (0.239) loss_x loss_x 0.4045 (0.5562) acc_x 87.5000 (85.4167) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [4/4] time 0.257 (0.275) data 0.216 (0.233) loss_x loss_x 0.6587 (0.5818) acc_x 87.5000 (85.9375) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/13] time 0.285 (0.268) data 0.243 (0.226) loss_u loss_u 0.8706 (0.9047) acc_u 12.5000 (9.3750) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/13] time 0.255 (0.268) data 0.212 (0.226) loss_u loss_u 0.9282 (0.9158) acc_u 6.2500 (7.8125) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 227
confident_label rate tensor(0.2432, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 144
clean true:102
clean false:42
clean_rate:0.7083333333333334
noisy true:263
noisy false:185
after delete: len(clean_dataset) 144
after delete: len(noisy_dataset) 448
epoch [31/200] batch [1/4] time 0.293 (0.293) data 0.250 (0.250) loss_x loss_x 0.9556 (0.9556) acc_x 78.1250 (78.1250) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [2/4] time 0.274 (0.283) data 0.232 (0.241) loss_x loss_x 0.5063 (0.7310) acc_x 90.6250 (84.3750) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [3/4] time 0.294 (0.287) data 0.253 (0.245) loss_x loss_x 0.5903 (0.6841) acc_x 87.5000 (85.4167) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [4/4] time 0.283 (0.286) data 0.240 (0.244) loss_x loss_x 0.5464 (0.6497) acc_x 87.5000 (85.9375) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/14] time 0.255 (0.275) data 0.213 (0.233) loss_u loss_u 0.9253 (0.8793) acc_u 6.2500 (13.7500) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/14] time 0.258 (0.270) data 0.216 (0.228) loss_u loss_u 0.8267 (0.8831) acc_u 18.7500 (12.1875) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 172
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 148
clean true:110
clean false:38
clean_rate:0.7432432432432432
noisy true:310
noisy false:134
after delete: len(clean_dataset) 148
after delete: len(noisy_dataset) 444
epoch [32/200] batch [1/4] time 0.308 (0.308) data 0.265 (0.265) loss_x loss_x 0.4231 (0.4231) acc_x 87.5000 (87.5000) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [2/4] time 0.279 (0.294) data 0.238 (0.251) loss_x loss_x 0.3345 (0.3788) acc_x 93.7500 (90.6250) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [3/4] time 0.276 (0.288) data 0.234 (0.246) loss_x loss_x 0.5234 (0.4270) acc_x 71.8750 (84.3750) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [4/4] time 0.273 (0.284) data 0.231 (0.242) loss_x loss_x 0.4741 (0.4388) acc_x 84.3750 (84.3750) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/13] time 0.261 (0.273) data 0.218 (0.230) loss_u loss_u 0.9624 (0.9326) acc_u 6.2500 (6.8750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/13] time 0.262 (0.268) data 0.220 (0.226) loss_u loss_u 0.8701 (0.9235) acc_u 15.6250 (8.1250) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 191
confident_label rate tensor(0.2449, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 145
clean true:113
clean false:32
clean_rate:0.7793103448275862
noisy true:288
noisy false:159
after delete: len(clean_dataset) 145
after delete: len(noisy_dataset) 447
epoch [33/200] batch [1/4] time 0.248 (0.248) data 0.201 (0.201) loss_x loss_x 1.1670 (1.1670) acc_x 75.0000 (75.0000) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [2/4] time 0.291 (0.269) data 0.249 (0.225) loss_x loss_x 0.4407 (0.8038) acc_x 84.3750 (79.6875) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [3/4] time 0.271 (0.270) data 0.230 (0.227) loss_x loss_x 0.3743 (0.6606) acc_x 90.6250 (83.3333) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [4/4] time 0.274 (0.271) data 0.231 (0.228) loss_x loss_x 1.2168 (0.7997) acc_x 78.1250 (82.0312) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/13] time 0.250 (0.263) data 0.208 (0.221) loss_u loss_u 0.8789 (0.9095) acc_u 12.5000 (10.0000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/13] time 0.280 (0.263) data 0.238 (0.220) loss_u loss_u 0.8301 (0.9061) acc_u 15.6250 (9.6875) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 204
confident_label rate tensor(0.2618, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 155
clean true:115
clean false:40
clean_rate:0.7419354838709677
noisy true:273
noisy false:164
after delete: len(clean_dataset) 155
after delete: len(noisy_dataset) 437
epoch [34/200] batch [1/4] time 0.291 (0.291) data 0.249 (0.249) loss_x loss_x 0.8140 (0.8140) acc_x 75.0000 (75.0000) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [2/4] time 0.260 (0.275) data 0.218 (0.233) loss_x loss_x 0.4414 (0.6277) acc_x 84.3750 (79.6875) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [3/4] time 0.238 (0.263) data 0.193 (0.220) loss_x loss_x 0.6465 (0.6340) acc_x 81.2500 (80.2083) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [4/4] time 0.253 (0.260) data 0.211 (0.218) loss_x loss_x 0.8823 (0.6960) acc_x 71.8750 (78.1250) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/13] time 0.271 (0.258) data 0.228 (0.216) loss_u loss_u 0.9307 (0.9293) acc_u 6.2500 (8.7500) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/13] time 0.247 (0.255) data 0.205 (0.213) loss_u loss_u 0.8535 (0.9006) acc_u 18.7500 (11.5625) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 215
confident_label rate tensor(0.2787, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 165
clean true:113
clean false:52
clean_rate:0.6848484848484848
noisy true:264
noisy false:163
after delete: len(clean_dataset) 165
after delete: len(noisy_dataset) 427
epoch [35/200] batch [5/5] time 0.287 (0.279) data 0.245 (0.237) loss_x loss_x 0.6626 (0.9584) acc_x 81.2500 (77.5000) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/13] time 0.256 (0.275) data 0.214 (0.232) loss_u loss_u 0.9365 (0.8880) acc_u 6.2500 (11.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/13] time 0.270 (0.271) data 0.228 (0.229) loss_u loss_u 0.8887 (0.9024) acc_u 12.5000 (11.2500) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 233
confident_label rate tensor(0.2736, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 162
clean true:108
clean false:54
clean_rate:0.6666666666666666
noisy true:251
noisy false:179
after delete: len(clean_dataset) 162
after delete: len(noisy_dataset) 430
epoch [36/200] batch [5/5] time 0.303 (0.278) data 0.262 (0.236) loss_x loss_x 0.5913 (0.6661) acc_x 84.3750 (81.8750) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/13] time 0.264 (0.271) data 0.222 (0.229) loss_u loss_u 0.8999 (0.9146) acc_u 9.3750 (8.7500) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/13] time 0.266 (0.270) data 0.223 (0.228) loss_u loss_u 0.8281 (0.9025) acc_u 15.6250 (10.0000) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 217
confident_label rate tensor(0.2601, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 154
clean true:104
clean false:50
clean_rate:0.6753246753246753
noisy true:271
noisy false:167
after delete: len(clean_dataset) 154
after delete: len(noisy_dataset) 438
epoch [37/200] batch [1/4] time 0.304 (0.304) data 0.262 (0.262) loss_x loss_x 0.5664 (0.5664) acc_x 87.5000 (87.5000) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [2/4] time 0.318 (0.311) data 0.276 (0.269) loss_x loss_x 0.4536 (0.5100) acc_x 90.6250 (89.0625) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [3/4] time 0.258 (0.293) data 0.215 (0.251) loss_x loss_x 0.6304 (0.5501) acc_x 81.2500 (86.4583) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [4/4] time 0.278 (0.289) data 0.236 (0.247) loss_x loss_x 0.3521 (0.5006) acc_x 90.6250 (87.5000) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/13] time 0.255 (0.276) data 0.213 (0.233) loss_u loss_u 0.8418 (0.8765) acc_u 18.7500 (14.3750) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/13] time 0.267 (0.271) data 0.224 (0.229) loss_u loss_u 0.8711 (0.8865) acc_u 15.6250 (13.7500) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 211
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 159
clean true:114
clean false:45
clean_rate:0.7169811320754716
noisy true:267
noisy false:166
after delete: len(clean_dataset) 159
after delete: len(noisy_dataset) 433
epoch [38/200] batch [1/4] time 0.289 (0.289) data 0.247 (0.247) loss_x loss_x 0.4648 (0.4648) acc_x 87.5000 (87.5000) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [2/4] time 0.261 (0.275) data 0.219 (0.233) loss_x loss_x 0.8047 (0.6348) acc_x 78.1250 (82.8125) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [3/4] time 0.267 (0.272) data 0.225 (0.230) loss_x loss_x 0.9907 (0.7534) acc_x 68.7500 (78.1250) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [4/4] time 0.301 (0.280) data 0.256 (0.237) loss_x loss_x 0.6187 (0.7197) acc_x 87.5000 (80.4688) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/13] time 0.262 (0.268) data 0.219 (0.225) loss_u loss_u 0.9277 (0.9038) acc_u 12.5000 (11.8750) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/13] time 0.246 (0.267) data 0.204 (0.224) loss_u loss_u 0.9165 (0.9038) acc_u 9.3750 (11.2500) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 233
confident_label rate tensor(0.2821, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 167
clean true:111
clean false:56
clean_rate:0.6646706586826348
noisy true:248
noisy false:177
after delete: len(clean_dataset) 167
after delete: len(noisy_dataset) 425
epoch [39/200] batch [5/5] time 0.264 (0.277) data 0.222 (0.234) loss_x loss_x 0.5186 (0.5118) acc_x 90.6250 (86.2500) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/13] time 0.273 (0.271) data 0.230 (0.229) loss_u loss_u 0.8774 (0.9076) acc_u 12.5000 (10.6250) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/13] time 0.255 (0.268) data 0.211 (0.225) loss_u loss_u 0.9688 (0.9147) acc_u 3.1250 (10.0000) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 222
confident_label rate tensor(0.2804, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 166
clean true:112
clean false:54
clean_rate:0.6746987951807228
noisy true:258
noisy false:168
after delete: len(clean_dataset) 166
after delete: len(noisy_dataset) 426
epoch [40/200] batch [5/5] time 0.255 (0.278) data 0.213 (0.236) loss_x loss_x 0.6133 (0.5895) acc_x 84.3750 (83.7500) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/13] time 0.275 (0.272) data 0.233 (0.230) loss_u loss_u 0.9336 (0.9228) acc_u 6.2500 (9.3750) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/13] time 0.272 (0.268) data 0.227 (0.226) loss_u loss_u 0.9399 (0.9069) acc_u 6.2500 (10.3125) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 226
confident_label rate tensor(0.2770, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 164
clean true:109
clean false:55
clean_rate:0.6646341463414634
noisy true:257
noisy false:171
after delete: len(clean_dataset) 164
after delete: len(noisy_dataset) 428
epoch [41/200] batch [5/5] time 0.299 (0.286) data 0.256 (0.243) loss_x loss_x 0.2281 (0.7079) acc_x 96.8750 (85.0000) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/13] time 0.245 (0.275) data 0.203 (0.233) loss_u loss_u 0.8496 (0.8969) acc_u 15.6250 (11.8750) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/13] time 0.235 (0.267) data 0.192 (0.225) loss_u loss_u 0.8857 (0.9052) acc_u 15.6250 (11.5625) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 258
confident_label rate tensor(0.2804, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 166
clean true:103
clean false:63
clean_rate:0.6204819277108434
noisy true:231
noisy false:195
after delete: len(clean_dataset) 166
after delete: len(noisy_dataset) 426
epoch [42/200] batch [5/5] time 0.280 (0.274) data 0.237 (0.232) loss_x loss_x 0.6577 (0.7404) acc_x 78.1250 (80.6250) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/13] time 0.263 (0.270) data 0.221 (0.228) loss_u loss_u 0.9438 (0.8938) acc_u 6.2500 (13.1250) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/13] time 0.261 (0.266) data 0.219 (0.224) loss_u loss_u 0.9312 (0.8842) acc_u 6.2500 (14.3750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 212
confident_label rate tensor(0.2787, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 165
clean true:114
clean false:51
clean_rate:0.6909090909090909
noisy true:266
noisy false:161
after delete: len(clean_dataset) 165
after delete: len(noisy_dataset) 427
epoch [43/200] batch [5/5] time 0.289 (0.272) data 0.247 (0.229) loss_x loss_x 0.3452 (0.5446) acc_x 93.7500 (84.3750) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/13] time 0.298 (0.269) data 0.255 (0.226) loss_u loss_u 0.8198 (0.8929) acc_u 18.7500 (12.5000) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/13] time 0.267 (0.269) data 0.224 (0.226) loss_u loss_u 0.8496 (0.8793) acc_u 18.7500 (14.3750) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 237
confident_label rate tensor(0.2973, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 176
clean true:112
clean false:64
clean_rate:0.6363636363636364
noisy true:243
noisy false:173
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 416
epoch [44/200] batch [5/5] time 0.281 (0.269) data 0.239 (0.227) loss_x loss_x 0.5737 (0.6776) acc_x 78.1250 (81.8750) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/13] time 0.295 (0.271) data 0.251 (0.229) loss_u loss_u 0.9956 (0.9177) acc_u 0.0000 (9.3750) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/13] time 0.266 (0.267) data 0.223 (0.225) loss_u loss_u 0.8896 (0.8974) acc_u 12.5000 (11.5625) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 259
confident_label rate tensor(0.2821, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 167
clean true:104
clean false:63
clean_rate:0.6227544910179641
noisy true:229
noisy false:196
after delete: len(clean_dataset) 167
after delete: len(noisy_dataset) 425
epoch [45/200] batch [5/5] time 0.262 (0.274) data 0.221 (0.231) loss_x loss_x 0.7148 (0.7461) acc_x 81.2500 (80.0000) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/13] time 0.269 (0.267) data 0.226 (0.225) loss_u loss_u 0.8975 (0.8882) acc_u 12.5000 (12.5000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/13] time 0.267 (0.271) data 0.225 (0.229) loss_u loss_u 0.9414 (0.8932) acc_u 6.2500 (11.5625) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 242
confident_label rate tensor(0.2973, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 176
clean true:115
clean false:61
clean_rate:0.6534090909090909
noisy true:235
noisy false:181
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 416
epoch [46/200] batch [5/5] time 0.266 (0.275) data 0.223 (0.233) loss_x loss_x 0.5474 (0.6410) acc_x 87.5000 (81.8750) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/13] time 0.250 (0.269) data 0.205 (0.226) loss_u loss_u 0.9155 (0.9035) acc_u 12.5000 (11.2500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/13] time 0.256 (0.267) data 0.199 (0.223) loss_u loss_u 0.8447 (0.9005) acc_u 15.6250 (10.9375) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 239
confident_label rate tensor(0.2990, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 177
clean true:117
clean false:60
clean_rate:0.6610169491525424
noisy true:236
noisy false:179
after delete: len(clean_dataset) 177
after delete: len(noisy_dataset) 415
epoch [47/200] batch [5/5] time 0.265 (0.273) data 0.223 (0.231) loss_x loss_x 0.7705 (0.7487) acc_x 81.2500 (80.0000) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/12] time 0.286 (0.272) data 0.244 (0.229) loss_u loss_u 0.9316 (0.9147) acc_u 9.3750 (9.3750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/12] time 0.274 (0.273) data 0.232 (0.231) loss_u loss_u 0.9165 (0.9047) acc_u 9.3750 (10.6250) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 251
confident_label rate tensor(0.2905, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 172
clean true:113
clean false:59
clean_rate:0.6569767441860465
noisy true:228
noisy false:192
after delete: len(clean_dataset) 172
after delete: len(noisy_dataset) 420
epoch [48/200] batch [5/5] time 0.270 (0.285) data 0.228 (0.243) loss_x loss_x 0.6572 (0.7270) acc_x 84.3750 (81.8750) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/13] time 0.273 (0.276) data 0.231 (0.233) loss_u loss_u 0.7725 (0.8688) acc_u 25.0000 (13.1250) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/13] time 0.281 (0.273) data 0.238 (0.231) loss_u loss_u 0.8486 (0.8694) acc_u 15.6250 (13.4375) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 238
confident_label rate tensor(0.2922, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 173
clean true:115
clean false:58
clean_rate:0.6647398843930635
noisy true:239
noisy false:180
after delete: len(clean_dataset) 173
after delete: len(noisy_dataset) 419
epoch [49/200] batch [5/5] time 0.280 (0.282) data 0.237 (0.240) loss_x loss_x 0.3079 (0.5663) acc_x 93.7500 (88.1250) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/13] time 0.269 (0.272) data 0.227 (0.230) loss_u loss_u 0.9189 (0.8963) acc_u 6.2500 (12.5000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/13] time 0.232 (0.267) data 0.191 (0.224) loss_u loss_u 0.8647 (0.9016) acc_u 18.7500 (11.8750) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 237
confident_label rate tensor(0.2821, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 167
clean true:111
clean false:56
clean_rate:0.6646706586826348
noisy true:244
noisy false:181
after delete: len(clean_dataset) 167
after delete: len(noisy_dataset) 425
epoch [50/200] batch [5/5] time 0.260 (0.269) data 0.218 (0.227) loss_x loss_x 0.5054 (0.5804) acc_x 78.1250 (83.7500) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/13] time 0.220 (0.262) data 0.177 (0.220) loss_u loss_u 0.9575 (0.8857) acc_u 3.1250 (13.7500) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/13] time 0.244 (0.256) data 0.202 (0.214) loss_u loss_u 0.8564 (0.8629) acc_u 15.6250 (16.2500) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 259
confident_label rate tensor(0.2973, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 176
clean true:112
clean false:64
clean_rate:0.6363636363636364
noisy true:221
noisy false:195
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 416
epoch [51/200] batch [5/5] time 0.267 (0.288) data 0.225 (0.245) loss_x loss_x 0.7803 (0.6230) acc_x 81.2500 (83.7500) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/13] time 0.277 (0.275) data 0.232 (0.232) loss_u loss_u 0.8940 (0.8920) acc_u 12.5000 (11.8750) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/13] time 0.252 (0.272) data 0.210 (0.229) loss_u loss_u 0.8740 (0.8907) acc_u 18.7500 (12.1875) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 227
confident_label rate tensor(0.3159, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 187
clean true:117
clean false:70
clean_rate:0.6256684491978609
noisy true:248
noisy false:157
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 405
epoch [52/200] batch [5/5] time 0.300 (0.281) data 0.258 (0.239) loss_x loss_x 0.5044 (0.5132) acc_x 87.5000 (86.2500) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/12] time 0.259 (0.272) data 0.217 (0.230) loss_u loss_u 0.7695 (0.8681) acc_u 28.1250 (15.0000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/12] time 0.272 (0.266) data 0.228 (0.223) loss_u loss_u 0.8906 (0.8743) acc_u 12.5000 (14.0625) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 266
confident_label rate tensor(0.3176, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 188
clean true:107
clean false:81
clean_rate:0.5691489361702128
noisy true:219
noisy false:185
after delete: len(clean_dataset) 188
after delete: len(noisy_dataset) 404
epoch [53/200] batch [5/5] time 0.266 (0.281) data 0.223 (0.238) loss_x loss_x 0.9316 (0.6067) acc_x 81.2500 (85.0000) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/12] time 0.238 (0.272) data 0.195 (0.229) loss_u loss_u 0.9199 (0.8509) acc_u 9.3750 (16.8750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/12] time 0.284 (0.267) data 0.242 (0.224) loss_u loss_u 0.9150 (0.8764) acc_u 12.5000 (14.3750) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 284
confident_label rate tensor(0.2922, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 173
clean true:96
clean false:77
clean_rate:0.5549132947976878
noisy true:212
noisy false:207
after delete: len(clean_dataset) 173
after delete: len(noisy_dataset) 419
epoch [54/200] batch [5/5] time 0.310 (0.281) data 0.268 (0.239) loss_x loss_x 0.5845 (0.6399) acc_x 87.5000 (87.5000) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/13] time 0.272 (0.270) data 0.228 (0.228) loss_u loss_u 0.7881 (0.8628) acc_u 25.0000 (16.2500) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/13] time 0.270 (0.267) data 0.228 (0.224) loss_u loss_u 0.8789 (0.8577) acc_u 9.3750 (15.9375) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 271
confident_label rate tensor(0.3142, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 186
clean true:108
clean false:78
clean_rate:0.5806451612903226
noisy true:213
noisy false:193
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 406
epoch [55/200] batch [5/5] time 0.264 (0.278) data 0.220 (0.236) loss_x loss_x 0.4104 (0.6146) acc_x 93.7500 (85.0000) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/12] time 0.258 (0.265) data 0.215 (0.223) loss_u loss_u 0.8994 (0.8944) acc_u 9.3750 (11.8750) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/12] time 0.254 (0.263) data 0.211 (0.221) loss_u loss_u 0.8447 (0.8839) acc_u 21.8750 (13.7500) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 270
confident_label rate tensor(0.3361, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 199
clean true:113
clean false:86
clean_rate:0.5678391959798995
noisy true:209
noisy false:184
after delete: len(clean_dataset) 199
after delete: len(noisy_dataset) 393
epoch [56/200] batch [5/6] time 0.267 (0.280) data 0.225 (0.238) loss_x loss_x 0.7026 (0.6849) acc_x 78.1250 (78.1250) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/12] time 0.254 (0.271) data 0.212 (0.229) loss_u loss_u 0.8384 (0.8955) acc_u 18.7500 (13.1250) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/12] time 0.250 (0.269) data 0.208 (0.226) loss_u loss_u 0.9214 (0.8928) acc_u 9.3750 (12.1875) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 297
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 192
clean true:104
clean false:88
clean_rate:0.5416666666666666
noisy true:191
noisy false:209
after delete: len(clean_dataset) 192
after delete: len(noisy_dataset) 400
epoch [57/200] batch [5/6] time 0.279 (0.287) data 0.236 (0.245) loss_x loss_x 0.5996 (0.6234) acc_x 84.3750 (84.3750) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/12] time 0.249 (0.275) data 0.207 (0.233) loss_u loss_u 0.8638 (0.8758) acc_u 15.6250 (13.7500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/12] time 0.252 (0.270) data 0.209 (0.228) loss_u loss_u 0.9316 (0.8727) acc_u 6.2500 (14.6875) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 279
confident_label rate tensor(0.3260, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 193
clean true:111
clean false:82
clean_rate:0.5751295336787565
noisy true:202
noisy false:197
after delete: len(clean_dataset) 193
after delete: len(noisy_dataset) 399
epoch [58/200] batch [5/6] time 0.308 (0.289) data 0.267 (0.247) loss_x loss_x 0.4219 (0.5080) acc_x 90.6250 (83.7500) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/12] time 0.333 (0.281) data 0.291 (0.238) loss_u loss_u 0.9038 (0.8894) acc_u 12.5000 (13.7500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/12] time 0.245 (0.277) data 0.203 (0.234) loss_u loss_u 0.9609 (0.8866) acc_u 3.1250 (12.8125) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 286
confident_label rate tensor(0.3074, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 182
clean true:96
clean false:86
clean_rate:0.5274725274725275
noisy true:210
noisy false:200
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 410
epoch [59/200] batch [5/5] time 0.290 (0.276) data 0.248 (0.233) loss_x loss_x 0.5884 (0.4964) acc_x 78.1250 (83.7500) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/12] time 0.255 (0.270) data 0.213 (0.227) loss_u loss_u 0.7979 (0.8985) acc_u 28.1250 (11.8750) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/12] time 0.272 (0.267) data 0.230 (0.225) loss_u loss_u 0.7920 (0.8666) acc_u 28.1250 (16.2500) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 293
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 196
clean true:106
clean false:90
clean_rate:0.5408163265306123
noisy true:193
noisy false:203
after delete: len(clean_dataset) 196
after delete: len(noisy_dataset) 396
epoch [60/200] batch [5/6] time 0.283 (0.280) data 0.241 (0.237) loss_x loss_x 0.7749 (0.7238) acc_x 84.3750 (83.1250) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/12] time 0.266 (0.270) data 0.220 (0.226) loss_u loss_u 0.8809 (0.8734) acc_u 15.6250 (13.7500) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/12] time 0.266 (0.270) data 0.224 (0.227) loss_u loss_u 0.8755 (0.8663) acc_u 18.7500 (15.6250) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 304
confident_label rate tensor(0.3260, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 193
clean true:101
clean false:92
clean_rate:0.5233160621761658
noisy true:187
noisy false:212
after delete: len(clean_dataset) 193
after delete: len(noisy_dataset) 399
epoch [61/200] batch [5/6] time 0.285 (0.279) data 0.243 (0.237) loss_x loss_x 0.4121 (0.5086) acc_x 87.5000 (87.5000) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/12] time 0.252 (0.266) data 0.210 (0.223) loss_u loss_u 0.9268 (0.8814) acc_u 6.2500 (13.1250) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/12] time 0.287 (0.265) data 0.245 (0.223) loss_u loss_u 0.8389 (0.8617) acc_u 18.7500 (15.0000) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 287
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 196
clean true:101
clean false:95
clean_rate:0.5153061224489796
noisy true:204
noisy false:192
after delete: len(clean_dataset) 196
after delete: len(noisy_dataset) 396
epoch [62/200] batch [5/6] time 0.294 (0.295) data 0.251 (0.252) loss_x loss_x 0.3022 (0.5756) acc_x 96.8750 (85.0000) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/12] time 0.235 (0.276) data 0.192 (0.233) loss_u loss_u 0.8652 (0.8850) acc_u 15.6250 (11.8750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [10/12] time 0.259 (0.272) data 0.217 (0.230) loss_u loss_u 0.8188 (0.8686) acc_u 18.7500 (14.0625) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 295
confident_label rate tensor(0.3395, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 201
clean true:106
clean false:95
clean_rate:0.527363184079602
noisy true:191
noisy false:200
after delete: len(clean_dataset) 201
after delete: len(noisy_dataset) 391
epoch [63/200] batch [5/6] time 0.278 (0.272) data 0.236 (0.229) loss_x loss_x 0.7432 (0.6148) acc_x 78.1250 (82.5000) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/12] time 0.268 (0.262) data 0.226 (0.219) loss_u loss_u 0.8931 (0.8605) acc_u 9.3750 (15.0000) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/12] time 0.262 (0.264) data 0.220 (0.222) loss_u loss_u 0.8506 (0.8609) acc_u 18.7500 (15.9375) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 277
confident_label rate tensor(0.3480, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 206
clean true:107
clean false:99
clean_rate:0.5194174757281553
noisy true:208
noisy false:178
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 386
epoch [64/200] batch [5/6] time 0.268 (0.286) data 0.225 (0.242) loss_x loss_x 0.5317 (0.5655) acc_x 90.6250 (84.3750) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/12] time 0.258 (0.275) data 0.214 (0.232) loss_u loss_u 0.8359 (0.8525) acc_u 18.7500 (16.8750) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/12] time 0.250 (0.270) data 0.208 (0.227) loss_u loss_u 0.9102 (0.8708) acc_u 9.3750 (14.6875) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 305
confident_label rate tensor(0.3429, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 203
clean true:99
clean false:104
clean_rate:0.4876847290640394
noisy true:188
noisy false:201
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 389
epoch [65/200] batch [5/6] time 0.290 (0.278) data 0.248 (0.235) loss_x loss_x 0.3896 (0.7224) acc_x 90.6250 (84.3750) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/12] time 0.259 (0.270) data 0.217 (0.228) loss_u loss_u 0.8618 (0.8757) acc_u 15.6250 (15.0000) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [10/12] time 0.247 (0.268) data 0.205 (0.225) loss_u loss_u 0.8857 (0.8795) acc_u 15.6250 (14.0625) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 289
confident_label rate tensor(0.3429, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 203
clean true:104
clean false:99
clean_rate:0.5123152709359606
noisy true:199
noisy false:190
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 389
epoch [66/200] batch [5/6] time 0.295 (0.272) data 0.253 (0.230) loss_x loss_x 0.2252 (0.5101) acc_x 96.8750 (83.1250) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/12] time 0.262 (0.265) data 0.220 (0.222) loss_u loss_u 0.9507 (0.8870) acc_u 3.1250 (11.2500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/12] time 0.260 (0.267) data 0.217 (0.225) loss_u loss_u 0.9224 (0.8866) acc_u 9.3750 (11.8750) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 308
confident_label rate tensor(0.3260, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 193
clean true:98
clean false:95
clean_rate:0.5077720207253886
noisy true:186
noisy false:213
after delete: len(clean_dataset) 193
after delete: len(noisy_dataset) 399
epoch [67/200] batch [5/6] time 0.303 (0.283) data 0.261 (0.241) loss_x loss_x 0.6060 (0.5156) acc_x 75.0000 (84.3750) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/12] time 0.260 (0.274) data 0.217 (0.231) loss_u loss_u 0.8320 (0.8348) acc_u 18.7500 (20.0000) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/12] time 0.260 (0.269) data 0.218 (0.226) loss_u loss_u 0.9302 (0.8582) acc_u 9.3750 (17.1875) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 311
confident_label rate tensor(0.3294, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 195
clean true:97
clean false:98
clean_rate:0.49743589743589745
noisy true:184
noisy false:213
after delete: len(clean_dataset) 195
after delete: len(noisy_dataset) 397
epoch [68/200] batch [5/6] time 0.274 (0.279) data 0.232 (0.237) loss_x loss_x 0.7256 (0.7285) acc_x 87.5000 (85.0000) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/12] time 0.261 (0.274) data 0.219 (0.232) loss_u loss_u 0.9077 (0.8587) acc_u 9.3750 (13.7500) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/12] time 0.263 (0.270) data 0.221 (0.228) loss_u loss_u 0.8130 (0.8531) acc_u 21.8750 (16.2500) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 306
confident_label rate tensor(0.3547, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 210
clean true:104
clean false:106
clean_rate:0.49523809523809526
noisy true:182
noisy false:200
after delete: len(clean_dataset) 210
after delete: len(noisy_dataset) 382
epoch [69/200] batch [5/6] time 0.262 (0.273) data 0.220 (0.231) loss_x loss_x 0.6362 (0.6882) acc_x 81.2500 (83.1250) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/11] time 0.298 (0.271) data 0.255 (0.228) loss_u loss_u 0.8677 (0.8903) acc_u 12.5000 (10.6250) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/11] time 0.266 (0.267) data 0.223 (0.224) loss_u loss_u 0.8335 (0.8760) acc_u 21.8750 (13.4375) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 310
confident_label rate tensor(0.3446, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 204
clean true:103
clean false:101
clean_rate:0.5049019607843137
noisy true:179
noisy false:209
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 388
epoch [70/200] batch [5/6] time 0.279 (0.282) data 0.237 (0.240) loss_x loss_x 0.4043 (0.5902) acc_x 90.6250 (85.6250) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/12] time 0.229 (0.267) data 0.186 (0.225) loss_u loss_u 0.8359 (0.8757) acc_u 18.7500 (13.7500) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/12] time 0.265 (0.262) data 0.222 (0.220) loss_u loss_u 0.8794 (0.8665) acc_u 12.5000 (15.3125) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 312
confident_label rate tensor(0.3480, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 206
clean true:106
clean false:100
clean_rate:0.5145631067961165
noisy true:174
noisy false:212
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 386
epoch [71/200] batch [5/6] time 0.260 (0.269) data 0.218 (0.227) loss_x loss_x 0.3433 (0.5147) acc_x 87.5000 (85.6250) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/12] time 0.284 (0.267) data 0.225 (0.223) loss_u loss_u 0.8345 (0.8762) acc_u 15.6250 (14.3750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [10/12] time 0.283 (0.266) data 0.241 (0.223) loss_u loss_u 0.8643 (0.8649) acc_u 9.3750 (14.6875) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 316
confident_label rate tensor(0.3412, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 202
clean true:100
clean false:102
clean_rate:0.49504950495049505
noisy true:176
noisy false:214
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 390
epoch [72/200] batch [5/6] time 0.281 (0.282) data 0.239 (0.240) loss_x loss_x 0.5771 (0.5491) acc_x 90.6250 (80.6250) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/12] time 0.280 (0.273) data 0.238 (0.231) loss_u loss_u 0.7744 (0.8745) acc_u 25.0000 (12.5000) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/12] time 0.255 (0.270) data 0.210 (0.228) loss_u loss_u 0.9121 (0.8649) acc_u 6.2500 (14.0625) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 289
confident_label rate tensor(0.3412, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 202
clean true:106
clean false:96
clean_rate:0.5247524752475248
noisy true:197
noisy false:193
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 390
epoch [73/200] batch [5/6] time 0.251 (0.281) data 0.209 (0.239) loss_x loss_x 0.9326 (0.7199) acc_x 71.8750 (79.3750) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/12] time 0.267 (0.271) data 0.225 (0.229) loss_u loss_u 0.9268 (0.8762) acc_u 9.3750 (15.0000) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/12] time 0.249 (0.267) data 0.207 (0.225) loss_u loss_u 0.8892 (0.8562) acc_u 9.3750 (15.9375) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 306
confident_label rate tensor(0.3429, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 203
clean true:98
clean false:105
clean_rate:0.4827586206896552
noisy true:188
noisy false:201
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 389
epoch [74/200] batch [5/6] time 0.259 (0.254) data 0.217 (0.212) loss_x loss_x 0.7495 (0.5534) acc_x 75.0000 (83.7500) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/12] time 0.273 (0.261) data 0.231 (0.218) loss_u loss_u 0.8052 (0.8220) acc_u 25.0000 (20.6250) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/12] time 0.283 (0.263) data 0.241 (0.220) loss_u loss_u 0.8970 (0.8333) acc_u 12.5000 (19.0625) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 305
confident_label rate tensor(0.3649, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 216
clean true:99
clean false:117
clean_rate:0.4583333333333333
noisy true:188
noisy false:188
after delete: len(clean_dataset) 216
after delete: len(noisy_dataset) 376
epoch [75/200] batch [5/6] time 0.259 (0.276) data 0.217 (0.234) loss_x loss_x 0.6323 (0.5838) acc_x 81.2500 (82.5000) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/11] time 0.258 (0.272) data 0.216 (0.229) loss_u loss_u 0.8691 (0.8642) acc_u 15.6250 (15.6250) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/11] time 0.261 (0.272) data 0.219 (0.229) loss_u loss_u 0.8613 (0.8724) acc_u 15.6250 (15.3125) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 313
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 211
clean true:98
clean false:113
clean_rate:0.46445497630331756
noisy true:181
noisy false:200
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 381
epoch [76/200] batch [5/6] time 0.268 (0.280) data 0.225 (0.237) loss_x loss_x 0.3401 (0.4129) acc_x 90.6250 (88.7500) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/11] time 0.269 (0.269) data 0.227 (0.227) loss_u loss_u 0.8530 (0.8923) acc_u 15.6250 (11.2500) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [10/11] time 0.262 (0.266) data 0.220 (0.224) loss_u loss_u 0.8052 (0.8627) acc_u 21.8750 (15.9375) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 308
confident_label rate tensor(0.3767, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 223
clean true:103
clean false:120
clean_rate:0.4618834080717489
noisy true:181
noisy false:188
after delete: len(clean_dataset) 223
after delete: len(noisy_dataset) 369
epoch [77/200] batch [5/6] time 0.268 (0.253) data 0.225 (0.212) loss_x loss_x 0.2722 (0.6341) acc_x 96.8750 (86.2500) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/11] time 0.265 (0.263) data 0.223 (0.221) loss_u loss_u 0.8657 (0.8691) acc_u 15.6250 (15.6250) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/11] time 0.260 (0.260) data 0.218 (0.218) loss_u loss_u 0.9238 (0.8705) acc_u 6.2500 (14.3750) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 302
confident_label rate tensor(0.3666, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 217
clean true:109
clean false:108
clean_rate:0.5023041474654378
noisy true:181
noisy false:194
after delete: len(clean_dataset) 217
after delete: len(noisy_dataset) 375
epoch [78/200] batch [5/6] time 0.304 (0.279) data 0.262 (0.237) loss_x loss_x 0.3445 (0.6927) acc_x 87.5000 (80.0000) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/11] time 0.231 (0.265) data 0.189 (0.222) loss_u loss_u 0.8560 (0.8210) acc_u 15.6250 (20.6250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/11] time 0.279 (0.267) data 0.237 (0.225) loss_u loss_u 0.8350 (0.8477) acc_u 21.8750 (18.1250) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 307
confident_label rate tensor(0.3699, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 219
clean true:104
clean false:115
clean_rate:0.4748858447488584
noisy true:181
noisy false:192
after delete: len(clean_dataset) 219
after delete: len(noisy_dataset) 373
epoch [79/200] batch [5/6] time 0.270 (0.284) data 0.228 (0.242) loss_x loss_x 0.7266 (0.5311) acc_x 78.1250 (86.2500) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/11] time 0.245 (0.270) data 0.203 (0.228) loss_u loss_u 0.8989 (0.8811) acc_u 12.5000 (13.1250) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/11] time 0.253 (0.264) data 0.211 (0.222) loss_u loss_u 0.8882 (0.8721) acc_u 9.3750 (13.7500) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 302
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 226
clean true:104
clean false:122
clean_rate:0.46017699115044247
noisy true:186
noisy false:180
after delete: len(clean_dataset) 226
after delete: len(noisy_dataset) 366
epoch [80/200] batch [5/7] time 0.266 (0.271) data 0.219 (0.228) loss_x loss_x 0.5049 (0.5940) acc_x 87.5000 (82.5000) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/11] time 0.256 (0.270) data 0.214 (0.228) loss_u loss_u 0.9780 (0.8961) acc_u 3.1250 (11.8750) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [10/11] time 0.262 (0.265) data 0.220 (0.222) loss_u loss_u 0.8794 (0.9037) acc_u 9.3750 (10.9375) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 311
confident_label rate tensor(0.3851, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 228
clean true:105
clean false:123
clean_rate:0.4605263157894737
noisy true:176
noisy false:188
after delete: len(clean_dataset) 228
after delete: len(noisy_dataset) 364
epoch [81/200] batch [5/7] time 0.269 (0.275) data 0.228 (0.233) loss_x loss_x 0.7671 (0.4653) acc_x 78.1250 (87.5000) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/11] time 0.270 (0.270) data 0.228 (0.228) loss_u loss_u 0.9580 (0.9252) acc_u 3.1250 (8.7500) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/11] time 0.249 (0.268) data 0.207 (0.225) loss_u loss_u 0.8833 (0.8808) acc_u 18.7500 (14.6875) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 324
confident_label rate tensor(0.3733, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 221
clean true:95
clean false:126
clean_rate:0.4298642533936652
noisy true:173
noisy false:198
after delete: len(clean_dataset) 221
after delete: len(noisy_dataset) 371
epoch [82/200] batch [5/6] time 0.234 (0.267) data 0.192 (0.225) loss_x loss_x 0.8306 (0.5769) acc_x 78.1250 (83.1250) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/11] time 0.259 (0.264) data 0.216 (0.222) loss_u loss_u 0.8403 (0.8740) acc_u 15.6250 (14.3750) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [10/11] time 0.294 (0.266) data 0.251 (0.223) loss_u loss_u 0.8721 (0.8679) acc_u 12.5000 (15.0000) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 322
confident_label rate tensor(0.3767, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 223
clean true:97
clean false:126
clean_rate:0.4349775784753363
noisy true:173
noisy false:196
after delete: len(clean_dataset) 223
after delete: len(noisy_dataset) 369
epoch [83/200] batch [5/6] time 0.262 (0.282) data 0.221 (0.239) loss_x loss_x 0.3940 (0.4362) acc_x 90.6250 (86.2500) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/11] time 0.247 (0.260) data 0.204 (0.218) loss_u loss_u 0.9263 (0.8902) acc_u 6.2500 (12.5000) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/11] time 0.269 (0.261) data 0.226 (0.218) loss_u loss_u 0.9155 (0.8899) acc_u 6.2500 (12.1875) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 298
confident_label rate tensor(0.3446, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 204
clean true:101
clean false:103
clean_rate:0.4950980392156863
noisy true:193
noisy false:195
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 388
epoch [84/200] batch [5/6] time 0.273 (0.277) data 0.231 (0.236) loss_x loss_x 0.4856 (0.5825) acc_x 87.5000 (81.8750) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/12] time 0.267 (0.268) data 0.224 (0.226) loss_u loss_u 0.8184 (0.8367) acc_u 18.7500 (18.7500) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/12] time 0.257 (0.267) data 0.215 (0.225) loss_u loss_u 0.8521 (0.8586) acc_u 15.6250 (16.5625) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 308
confident_label rate tensor(0.3615, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 214
clean true:102
clean false:112
clean_rate:0.4766355140186916
noisy true:182
noisy false:196
after delete: len(clean_dataset) 214
after delete: len(noisy_dataset) 378
epoch [85/200] batch [5/6] time 0.261 (0.279) data 0.219 (0.237) loss_x loss_x 0.6284 (0.6251) acc_x 81.2500 (80.6250) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/11] time 0.269 (0.274) data 0.227 (0.232) loss_u loss_u 0.7900 (0.8299) acc_u 21.8750 (19.3750) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/11] time 0.267 (0.270) data 0.225 (0.227) loss_u loss_u 0.8833 (0.8446) acc_u 12.5000 (17.5000) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 321
confident_label rate tensor(0.3649, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 216
clean true:94
clean false:122
clean_rate:0.4351851851851852
noisy true:177
noisy false:199
after delete: len(clean_dataset) 216
after delete: len(noisy_dataset) 376
epoch [86/200] batch [5/6] time 0.298 (0.282) data 0.255 (0.240) loss_x loss_x 0.6050 (0.6064) acc_x 81.2500 (82.5000) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/11] time 0.257 (0.270) data 0.215 (0.228) loss_u loss_u 0.8730 (0.8199) acc_u 15.6250 (20.6250) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [10/11] time 0.258 (0.265) data 0.212 (0.223) loss_u loss_u 0.8643 (0.8322) acc_u 12.5000 (18.4375) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 330
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 207
clean true:91
clean false:116
clean_rate:0.4396135265700483
noisy true:171
noisy false:214
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 385
epoch [87/200] batch [5/6] time 0.248 (0.275) data 0.206 (0.233) loss_x loss_x 0.9160 (0.5697) acc_x 65.6250 (81.2500) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/12] time 0.255 (0.264) data 0.213 (0.222) loss_u loss_u 0.8564 (0.8400) acc_u 15.6250 (18.1250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/12] time 0.238 (0.261) data 0.195 (0.219) loss_u loss_u 0.8306 (0.8564) acc_u 21.8750 (16.8750) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 320
confident_label rate tensor(0.3716, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 220
clean true:99
clean false:121
clean_rate:0.45
noisy true:173
noisy false:199
after delete: len(clean_dataset) 220
after delete: len(noisy_dataset) 372
epoch [88/200] batch [5/6] time 0.261 (0.264) data 0.219 (0.222) loss_x loss_x 0.5493 (0.6246) acc_x 81.2500 (80.6250) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/11] time 0.277 (0.269) data 0.234 (0.226) loss_u loss_u 0.9058 (0.8746) acc_u 9.3750 (14.3750) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/11] time 0.223 (0.264) data 0.180 (0.222) loss_u loss_u 0.8442 (0.8655) acc_u 15.6250 (14.6875) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 319
confident_label rate tensor(0.3682, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 218
clean true:98
clean false:120
clean_rate:0.44954128440366975
noisy true:175
noisy false:199
after delete: len(clean_dataset) 218
after delete: len(noisy_dataset) 374
epoch [89/200] batch [5/6] time 0.267 (0.271) data 0.225 (0.230) loss_x loss_x 0.6089 (0.5314) acc_x 81.2500 (86.2500) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/11] time 0.266 (0.272) data 0.222 (0.229) loss_u loss_u 0.9019 (0.8661) acc_u 9.3750 (16.2500) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [10/11] time 0.243 (0.268) data 0.197 (0.225) loss_u loss_u 0.8633 (0.8498) acc_u 15.6250 (17.8125) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 326
confident_label rate tensor(0.3733, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 221
clean true:97
clean false:124
clean_rate:0.43891402714932126
noisy true:169
noisy false:202
after delete: len(clean_dataset) 221
after delete: len(noisy_dataset) 371
epoch [90/200] batch [5/6] time 0.270 (0.277) data 0.228 (0.234) loss_x loss_x 0.4324 (0.5267) acc_x 84.3750 (83.7500) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/11] time 0.262 (0.279) data 0.219 (0.237) loss_u loss_u 0.9287 (0.8465) acc_u 6.2500 (15.6250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [10/11] time 0.281 (0.275) data 0.238 (0.233) loss_u loss_u 0.8228 (0.8548) acc_u 25.0000 (15.3125) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 319
confident_label rate tensor(0.3868, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 229
clean true:105
clean false:124
clean_rate:0.4585152838427948
noisy true:168
noisy false:195
after delete: len(clean_dataset) 229
after delete: len(noisy_dataset) 363
epoch [91/200] batch [5/7] time 0.260 (0.276) data 0.218 (0.234) loss_x loss_x 0.3088 (0.4867) acc_x 96.8750 (91.2500) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/11] time 0.266 (0.267) data 0.223 (0.225) loss_u loss_u 0.8506 (0.8457) acc_u 18.7500 (18.7500) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [10/11] time 0.269 (0.267) data 0.224 (0.225) loss_u loss_u 0.8931 (0.8646) acc_u 15.6250 (16.5625) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 328
confident_label rate tensor(0.3716, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 220
clean true:95
clean false:125
clean_rate:0.4318181818181818
noisy true:169
noisy false:203
after delete: len(clean_dataset) 220
after delete: len(noisy_dataset) 372
epoch [92/200] batch [5/6] time 0.278 (0.281) data 0.236 (0.240) loss_x loss_x 1.0156 (0.6451) acc_x 78.1250 (83.1250) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/11] time 0.271 (0.274) data 0.229 (0.232) loss_u loss_u 0.8486 (0.8584) acc_u 18.7500 (15.6250) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/11] time 0.297 (0.274) data 0.254 (0.232) loss_u loss_u 0.8145 (0.8503) acc_u 18.7500 (16.5625) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 319
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 226
clean true:98
clean false:128
clean_rate:0.4336283185840708
noisy true:175
noisy false:191
after delete: len(clean_dataset) 226
after delete: len(noisy_dataset) 366
epoch [93/200] batch [5/7] time 0.273 (0.279) data 0.232 (0.237) loss_x loss_x 0.3103 (0.5738) acc_x 90.6250 (81.8750) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/11] time 0.254 (0.273) data 0.211 (0.230) loss_u loss_u 0.8662 (0.8701) acc_u 15.6250 (15.6250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [10/11] time 0.274 (0.271) data 0.232 (0.228) loss_u loss_u 0.9287 (0.8702) acc_u 12.5000 (15.0000) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 336
confident_label rate tensor(0.3953, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 234
clean true:98
clean false:136
clean_rate:0.4188034188034188
noisy true:158
noisy false:200
after delete: len(clean_dataset) 234
after delete: len(noisy_dataset) 358
epoch [94/200] batch [5/7] time 0.311 (0.279) data 0.270 (0.237) loss_x loss_x 0.5806 (0.5234) acc_x 90.6250 (88.7500) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/11] time 0.244 (0.270) data 0.202 (0.227) loss_u loss_u 0.8403 (0.8549) acc_u 21.8750 (16.8750) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [10/11] time 0.236 (0.268) data 0.193 (0.226) loss_u loss_u 0.8506 (0.8572) acc_u 18.7500 (16.5625) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 327
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 226
clean true:100
clean false:126
clean_rate:0.4424778761061947
noisy true:165
noisy false:201
after delete: len(clean_dataset) 226
after delete: len(noisy_dataset) 366
epoch [95/200] batch [5/7] time 0.250 (0.298) data 0.207 (0.256) loss_x loss_x 0.6016 (0.5826) acc_x 81.2500 (83.7500) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/11] time 0.265 (0.282) data 0.223 (0.240) loss_u loss_u 0.8452 (0.8416) acc_u 15.6250 (16.2500) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/11] time 0.280 (0.279) data 0.236 (0.237) loss_u loss_u 0.7905 (0.8393) acc_u 21.8750 (17.5000) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 325
confident_label rate tensor(0.3767, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 223
clean true:95
clean false:128
clean_rate:0.4260089686098655
noisy true:172
noisy false:197
after delete: len(clean_dataset) 223
after delete: len(noisy_dataset) 369
epoch [96/200] batch [5/6] time 0.283 (0.272) data 0.241 (0.230) loss_x loss_x 0.3330 (0.4692) acc_x 87.5000 (85.6250) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/11] time 0.269 (0.266) data 0.226 (0.223) loss_u loss_u 0.8027 (0.8430) acc_u 21.8750 (17.5000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [10/11] time 0.289 (0.267) data 0.246 (0.225) loss_u loss_u 0.8931 (0.8517) acc_u 9.3750 (16.8750) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 323
confident_label rate tensor(0.4037, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 239
clean true:104
clean false:135
clean_rate:0.4351464435146444
noisy true:165
noisy false:188
after delete: len(clean_dataset) 239
after delete: len(noisy_dataset) 353
epoch [97/200] batch [5/7] time 0.255 (0.264) data 0.213 (0.223) loss_x loss_x 0.6353 (0.5667) acc_x 75.0000 (82.5000) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/11] time 0.266 (0.271) data 0.223 (0.228) loss_u loss_u 0.8936 (0.8574) acc_u 9.3750 (16.8750) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [10/11] time 0.270 (0.270) data 0.226 (0.228) loss_u loss_u 0.8257 (0.8578) acc_u 18.7500 (16.2500) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 339
confident_label rate tensor(0.3834, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 227
clean true:93
clean false:134
clean_rate:0.40969162995594716
noisy true:160
noisy false:205
after delete: len(clean_dataset) 227
after delete: len(noisy_dataset) 365
epoch [98/200] batch [5/7] time 0.279 (0.285) data 0.235 (0.243) loss_x loss_x 1.0059 (0.6734) acc_x 78.1250 (80.6250) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/11] time 0.269 (0.275) data 0.225 (0.232) loss_u loss_u 0.8325 (0.8567) acc_u 18.7500 (16.2500) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [10/11] time 0.281 (0.271) data 0.238 (0.228) loss_u loss_u 0.7739 (0.8415) acc_u 25.0000 (17.5000) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 336
confident_label rate tensor(0.4054, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 240
clean true:100
clean false:140
clean_rate:0.4166666666666667
noisy true:156
noisy false:196
after delete: len(clean_dataset) 240
after delete: len(noisy_dataset) 352
epoch [99/200] batch [5/7] time 0.274 (0.275) data 0.232 (0.233) loss_x loss_x 0.7134 (0.4753) acc_x 81.2500 (85.0000) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/11] time 0.275 (0.264) data 0.233 (0.222) loss_u loss_u 0.8169 (0.8266) acc_u 21.8750 (20.6250) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [10/11] time 0.249 (0.264) data 0.206 (0.221) loss_u loss_u 0.8491 (0.8504) acc_u 18.7500 (17.5000) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 323
confident_label rate tensor(0.4003, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 237
clean true:103
clean false:134
clean_rate:0.4345991561181435
noisy true:166
noisy false:189
all clean rate:  [0.8488372093023255, 0.8387096774193549, 0.9099099099099099, 0.9327731092436975, 0.9098360655737705, 0.9384615384615385, 0.8803418803418803, 0.9044117647058824, 0.921875, 0.912, 0.8666666666666667, 0.8296296296296296, 0.8461538461538461, 0.8444444444444444, 0.8778625954198473, 0.8601398601398601, 0.821917808219178, 0.8085106382978723, 0.7397260273972602, 0.7631578947368421, 0.7397260273972602, 0.7959183673469388, 0.7730496453900709, 0.7638888888888888, 0.7619047619047619, 0.7350993377483444, 0.7449664429530202, 0.717948717948718, 0.7516339869281046, 0.7549668874172185, 0.7083333333333334, 0.7432432432432432, 0.7793103448275862, 0.7419354838709677, 0.6848484848484848, 0.6666666666666666, 0.6753246753246753, 0.7169811320754716, 0.6646706586826348, 0.6746987951807228, 0.6646341463414634, 0.6204819277108434, 0.6909090909090909, 0.6363636363636364, 0.6227544910179641, 0.6534090909090909, 0.6610169491525424, 0.6569767441860465, 0.6647398843930635, 0.6646706586826348, 0.6363636363636364, 0.6256684491978609, 0.5691489361702128, 0.5549132947976878, 0.5806451612903226, 0.5678391959798995, 0.5416666666666666, 0.5751295336787565, 0.5274725274725275, 0.5408163265306123, 0.5233160621761658, 0.5153061224489796, 0.527363184079602, 0.5194174757281553, 0.4876847290640394, 0.5123152709359606, 0.5077720207253886, 0.49743589743589745, 0.49523809523809526, 0.5049019607843137, 0.5145631067961165, 0.49504950495049505, 0.5247524752475248, 0.4827586206896552, 0.4583333333333333, 0.46445497630331756, 0.4618834080717489, 0.5023041474654378, 0.4748858447488584, 0.46017699115044247, 0.4605263157894737, 0.4298642533936652, 0.4349775784753363, 0.4950980392156863, 0.4766355140186916, 0.4351851851851852, 0.4396135265700483, 0.45, 0.44954128440366975, 0.43891402714932126, 0.4585152838427948, 0.4318181818181818, 0.4336283185840708, 0.4188034188034188, 0.4424778761061947, 0.4260089686098655, 0.4351464435146444, 0.40969162995594716, 0.4166666666666667, 0.4345991561181435]
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 355
epoch [100/200] batch [5/7] time 0.275 (0.273) data 0.232 (0.231) loss_x loss_x 0.4487 (0.4933) acc_x 84.3750 (87.5000) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/11] time 0.281 (0.267) data 0.238 (0.224) loss_u loss_u 0.8530 (0.8877) acc_u 18.7500 (13.7500) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [10/11] time 0.261 (0.268) data 0.219 (0.225) loss_u loss_u 0.8140 (0.8541) acc_u 21.8750 (17.1875) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 323
confident_label rate tensor(0.3885, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 230
clean true:101
clean false:129
clean_rate:0.4391304347826087
noisy true:168
noisy false:194
after delete: len(clean_dataset) 230
after delete: len(noisy_dataset) 362
epoch [101/200] batch [5/7] time 0.291 (0.279) data 0.248 (0.236) loss_x loss_x 0.8994 (0.6477) acc_x 68.7500 (81.2500) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/11] time 0.253 (0.271) data 0.211 (0.228) loss_u loss_u 0.8550 (0.8245) acc_u 18.7500 (18.7500) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/11] time 0.403 (0.311) data 0.361 (0.269) loss_u loss_u 0.8428 (0.8467) acc_u 15.6250 (16.2500) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 317
confident_label rate tensor(0.3919, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 232
clean true:100
clean false:132
clean_rate:0.43103448275862066
noisy true:175
noisy false:185
after delete: len(clean_dataset) 232
after delete: len(noisy_dataset) 360
epoch [102/200] batch [5/7] time 0.281 (0.275) data 0.240 (0.233) loss_x loss_x 0.9097 (0.6244) acc_x 75.0000 (78.7500) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/11] time 0.254 (0.268) data 0.212 (0.225) loss_u loss_u 0.8872 (0.8468) acc_u 12.5000 (18.1250) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/11] time 0.285 (0.267) data 0.242 (0.225) loss_u loss_u 0.9126 (0.8456) acc_u 9.3750 (17.1875) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 309
confident_label rate tensor(0.4003, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 237
clean true:107
clean false:130
clean_rate:0.45147679324894513
noisy true:176
noisy false:179
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 355
epoch [103/200] batch [5/7] time 0.299 (0.272) data 0.257 (0.230) loss_x loss_x 0.3843 (0.5321) acc_x 96.8750 (86.2500) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/11] time 0.250 (0.271) data 0.205 (0.228) loss_u loss_u 0.8384 (0.8370) acc_u 21.8750 (18.1250) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [10/11] time 0.270 (0.267) data 0.228 (0.224) loss_u loss_u 0.9390 (0.8535) acc_u 6.2500 (17.5000) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 341
confident_label rate tensor(0.3936, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 233
clean true:97
clean false:136
clean_rate:0.41630901287553645
noisy true:154
noisy false:205
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 359
epoch [104/200] batch [5/7] time 0.269 (0.269) data 0.227 (0.227) loss_x loss_x 0.9414 (0.6696) acc_x 71.8750 (82.5000) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/11] time 0.249 (0.268) data 0.207 (0.225) loss_u loss_u 0.7378 (0.8366) acc_u 28.1250 (16.8750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/11] time 0.272 (0.269) data 0.229 (0.226) loss_u loss_u 0.8364 (0.8404) acc_u 21.8750 (17.1875) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 346
confident_label rate tensor(0.4071, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 241
clean true:97
clean false:144
clean_rate:0.4024896265560166
noisy true:149
noisy false:202
after delete: len(clean_dataset) 241
after delete: len(noisy_dataset) 351
epoch [105/200] batch [5/7] time 0.297 (0.282) data 0.255 (0.240) loss_x loss_x 0.3035 (0.4911) acc_x 96.8750 (89.3750) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/10] time 0.264 (0.273) data 0.222 (0.231) loss_u loss_u 0.8784 (0.8800) acc_u 12.5000 (13.1250) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/10] time 0.278 (0.267) data 0.235 (0.225) loss_u loss_u 0.7368 (0.8387) acc_u 28.1250 (17.5000) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 336
confident_label rate tensor(0.4189, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 248
clean true:102
clean false:146
clean_rate:0.4112903225806452
noisy true:154
noisy false:190
after delete: len(clean_dataset) 248
after delete: len(noisy_dataset) 344
epoch [106/200] batch [5/7] time 0.261 (0.259) data 0.220 (0.217) loss_x loss_x 0.4561 (0.5017) acc_x 81.2500 (83.7500) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/10] time 0.253 (0.266) data 0.211 (0.224) loss_u loss_u 0.7402 (0.8516) acc_u 28.1250 (16.8750) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [10/10] time 0.261 (0.261) data 0.218 (0.219) loss_u loss_u 0.8862 (0.8624) acc_u 9.3750 (15.6250) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 328
confident_label rate tensor(0.4155, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 246
clean true:103
clean false:143
clean_rate:0.4186991869918699
noisy true:161
noisy false:185
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 346
epoch [107/200] batch [5/7] time 0.282 (0.266) data 0.240 (0.224) loss_x loss_x 0.5337 (0.5187) acc_x 90.6250 (85.6250) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/10] time 0.260 (0.273) data 0.218 (0.230) loss_u loss_u 0.8237 (0.8641) acc_u 18.7500 (15.0000) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [10/10] time 0.248 (0.265) data 0.205 (0.222) loss_u loss_u 0.9541 (0.8659) acc_u 3.1250 (14.6875) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 326
confident_label rate tensor(0.4054, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 240
clean true:103
clean false:137
clean_rate:0.42916666666666664
noisy true:163
noisy false:189
after delete: len(clean_dataset) 240
after delete: len(noisy_dataset) 352
epoch [108/200] batch [5/7] time 0.275 (0.270) data 0.233 (0.227) loss_x loss_x 0.3704 (0.4430) acc_x 90.6250 (88.1250) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/11] time 0.273 (0.267) data 0.231 (0.225) loss_u loss_u 0.8022 (0.8380) acc_u 21.8750 (18.7500) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/11] time 0.269 (0.263) data 0.226 (0.220) loss_u loss_u 0.9370 (0.8565) acc_u 6.2500 (16.2500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 341
confident_label rate tensor(0.4071, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 241
clean true:101
clean false:140
clean_rate:0.4190871369294606
noisy true:150
noisy false:201
after delete: len(clean_dataset) 241
after delete: len(noisy_dataset) 351
epoch [109/200] batch [5/7] time 0.287 (0.272) data 0.244 (0.230) loss_x loss_x 0.4355 (0.6077) acc_x 84.3750 (83.7500) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/10] time 0.282 (0.273) data 0.240 (0.231) loss_u loss_u 0.8750 (0.8345) acc_u 12.5000 (18.1250) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/10] time 0.254 (0.270) data 0.212 (0.228) loss_u loss_u 0.8950 (0.8471) acc_u 12.5000 (17.1875) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 333
confident_label rate tensor(0.4122, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 244
clean true:100
clean false:144
clean_rate:0.4098360655737705
noisy true:159
noisy false:189
after delete: len(clean_dataset) 244
after delete: len(noisy_dataset) 348
epoch [110/200] batch [5/7] time 0.284 (0.279) data 0.242 (0.237) loss_x loss_x 0.4912 (0.7689) acc_x 84.3750 (82.5000) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/10] time 0.251 (0.266) data 0.203 (0.223) loss_u loss_u 0.8701 (0.8596) acc_u 12.5000 (15.6250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/10] time 0.271 (0.267) data 0.229 (0.224) loss_u loss_u 0.7876 (0.8369) acc_u 25.0000 (18.7500) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 342
confident_label rate tensor(0.4122, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 244
clean true:100
clean false:144
clean_rate:0.4098360655737705
noisy true:150
noisy false:198
after delete: len(clean_dataset) 244
after delete: len(noisy_dataset) 348
epoch [111/200] batch [5/7] time 0.272 (0.279) data 0.230 (0.237) loss_x loss_x 0.5996 (0.7213) acc_x 84.3750 (82.5000) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/10] time 0.244 (0.268) data 0.201 (0.226) loss_u loss_u 0.9355 (0.9115) acc_u 3.1250 (7.5000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/10] time 0.281 (0.268) data 0.238 (0.225) loss_u loss_u 0.8159 (0.8565) acc_u 25.0000 (15.0000) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 326
confident_label rate tensor(0.4088, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 242
clean true:100
clean false:142
clean_rate:0.4132231404958678
noisy true:166
noisy false:184
after delete: len(clean_dataset) 242
after delete: len(noisy_dataset) 350
epoch [112/200] batch [5/7] time 0.273 (0.282) data 0.231 (0.240) loss_x loss_x 0.5132 (0.6302) acc_x 78.1250 (83.1250) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/10] time 0.287 (0.273) data 0.245 (0.231) loss_u loss_u 0.8076 (0.8104) acc_u 21.8750 (20.6250) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/10] time 0.251 (0.270) data 0.209 (0.227) loss_u loss_u 0.8872 (0.8333) acc_u 12.5000 (18.4375) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 331
confident_label rate tensor(0.4054, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 240
clean true:102
clean false:138
clean_rate:0.425
noisy true:159
noisy false:193
after delete: len(clean_dataset) 240
after delete: len(noisy_dataset) 352
epoch [113/200] batch [5/7] time 0.279 (0.268) data 0.237 (0.226) loss_x loss_x 0.5498 (0.5090) acc_x 81.2500 (88.1250) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/11] time 0.271 (0.269) data 0.229 (0.227) loss_u loss_u 0.7646 (0.8666) acc_u 28.1250 (14.3750) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/11] time 0.267 (0.269) data 0.225 (0.227) loss_u loss_u 0.7803 (0.8448) acc_u 25.0000 (16.5625) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 326
confident_label rate tensor(0.4139, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 245
clean true:101
clean false:144
clean_rate:0.4122448979591837
noisy true:165
noisy false:182
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 347
epoch [114/200] batch [5/7] time 0.303 (0.275) data 0.261 (0.233) loss_x loss_x 0.4048 (0.6062) acc_x 93.7500 (84.3750) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/10] time 0.256 (0.269) data 0.212 (0.227) loss_u loss_u 0.9248 (0.8703) acc_u 6.2500 (15.0000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [10/10] time 0.272 (0.268) data 0.230 (0.226) loss_u loss_u 0.9194 (0.8505) acc_u 9.3750 (17.5000) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 337
confident_label rate tensor(0.4139, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 245
clean true:108
clean false:137
clean_rate:0.44081632653061226
noisy true:147
noisy false:200
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 347
epoch [115/200] batch [5/7] time 0.267 (0.275) data 0.223 (0.231) loss_x loss_x 0.6079 (0.5392) acc_x 81.2500 (85.0000) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/10] time 0.264 (0.281) data 0.220 (0.238) loss_u loss_u 0.8774 (0.8383) acc_u 15.6250 (18.1250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/10] time 0.251 (0.277) data 0.209 (0.234) loss_u loss_u 0.8589 (0.8628) acc_u 9.3750 (15.3125) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 329
confident_label rate tensor(0.4324, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 256
clean true:108
clean false:148
clean_rate:0.421875
noisy true:155
noisy false:181
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 336
epoch [116/200] batch [5/8] time 0.264 (0.269) data 0.222 (0.226) loss_x loss_x 0.5835 (0.5921) acc_x 84.3750 (85.6250) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/10] time 0.259 (0.267) data 0.217 (0.225) loss_u loss_u 0.8809 (0.8486) acc_u 12.5000 (16.8750) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/10] time 0.265 (0.270) data 0.222 (0.228) loss_u loss_u 0.9233 (0.8609) acc_u 6.2500 (14.3750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 329
confident_label rate tensor(0.4105, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 243
clean true:104
clean false:139
clean_rate:0.4279835390946502
noisy true:159
noisy false:190
after delete: len(clean_dataset) 243
after delete: len(noisy_dataset) 349
epoch [117/200] batch [5/7] time 0.295 (0.286) data 0.253 (0.243) loss_x loss_x 0.3276 (0.5336) acc_x 87.5000 (83.7500) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/10] time 0.247 (0.275) data 0.205 (0.233) loss_u loss_u 0.8315 (0.8521) acc_u 21.8750 (18.1250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/10] time 0.272 (0.272) data 0.230 (0.230) loss_u loss_u 0.8008 (0.8567) acc_u 25.0000 (17.1875) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 347
confident_label rate tensor(0.4003, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 237
clean true:91
clean false:146
clean_rate:0.38396624472573837
noisy true:154
noisy false:201
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 355
epoch [118/200] batch [5/7] time 0.267 (0.272) data 0.224 (0.230) loss_x loss_x 0.4502 (0.5410) acc_x 87.5000 (87.5000) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/11] time 0.329 (0.272) data 0.286 (0.230) loss_u loss_u 0.8613 (0.8379) acc_u 15.6250 (18.1250) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [10/11] time 0.241 (0.269) data 0.198 (0.227) loss_u loss_u 0.8838 (0.8480) acc_u 12.5000 (16.5625) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 339
confident_label rate tensor(0.4139, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 245
clean true:101
clean false:144
clean_rate:0.4122448979591837
noisy true:152
noisy false:195
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 347
epoch [119/200] batch [5/7] time 0.290 (0.279) data 0.246 (0.237) loss_x loss_x 0.5996 (0.4790) acc_x 90.6250 (87.5000) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/10] time 0.258 (0.271) data 0.216 (0.229) loss_u loss_u 0.8433 (0.8498) acc_u 15.6250 (16.8750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/10] time 0.258 (0.269) data 0.215 (0.226) loss_u loss_u 0.8652 (0.8577) acc_u 15.6250 (16.2500) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 342
confident_label rate tensor(0.4257, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 252
clean true:94
clean false:158
clean_rate:0.373015873015873
noisy true:156
noisy false:184
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 340
epoch [120/200] batch [5/7] time 0.260 (0.278) data 0.217 (0.235) loss_x loss_x 0.8066 (0.7287) acc_x 75.0000 (83.1250) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/10] time 0.275 (0.269) data 0.232 (0.225) loss_u loss_u 0.8506 (0.8129) acc_u 15.6250 (21.2500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/10] time 0.253 (0.267) data 0.211 (0.224) loss_u loss_u 0.9497 (0.8554) acc_u 6.2500 (16.2500) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 342
confident_label rate tensor(0.4257, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 252
clean true:98
clean false:154
clean_rate:0.3888888888888889
noisy true:152
noisy false:188
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 340
epoch [121/200] batch [5/7] time 0.269 (0.269) data 0.227 (0.226) loss_x loss_x 0.4255 (0.5603) acc_x 87.5000 (80.6250) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/10] time 0.268 (0.268) data 0.225 (0.226) loss_u loss_u 0.8154 (0.8358) acc_u 18.7500 (19.3750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/10] time 0.255 (0.267) data 0.212 (0.224) loss_u loss_u 0.8838 (0.8630) acc_u 12.5000 (15.9375) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 343
confident_label rate tensor(0.4122, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 244
clean true:102
clean false:142
clean_rate:0.4180327868852459
noisy true:147
noisy false:201
after delete: len(clean_dataset) 244
after delete: len(noisy_dataset) 348
epoch [122/200] batch [5/7] time 0.266 (0.281) data 0.222 (0.238) loss_x loss_x 0.4619 (0.5825) acc_x 90.6250 (85.6250) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/10] time 0.274 (0.269) data 0.232 (0.226) loss_u loss_u 0.8452 (0.8665) acc_u 18.7500 (14.3750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/10] time 0.260 (0.269) data 0.217 (0.226) loss_u loss_u 0.7563 (0.8097) acc_u 28.1250 (20.9375) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 352
confident_label rate tensor(0.4392, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 260
clean true:104
clean false:156
clean_rate:0.4
noisy true:136
noisy false:196
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 332
epoch [123/200] batch [5/8] time 0.277 (0.283) data 0.233 (0.241) loss_x loss_x 0.7920 (0.5060) acc_x 71.8750 (86.2500) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/10] time 0.242 (0.271) data 0.200 (0.228) loss_u loss_u 0.7412 (0.8368) acc_u 28.1250 (17.5000) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/10] time 0.273 (0.269) data 0.228 (0.226) loss_u loss_u 0.9243 (0.8620) acc_u 6.2500 (14.0625) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 343
confident_label rate tensor(0.4223, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 250
clean true:97
clean false:153
clean_rate:0.388
noisy true:152
noisy false:190
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 342
epoch [124/200] batch [5/7] time 0.251 (0.273) data 0.210 (0.231) loss_x loss_x 0.4092 (0.4539) acc_x 90.6250 (88.1250) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/10] time 0.249 (0.265) data 0.206 (0.222) loss_u loss_u 0.8701 (0.8664) acc_u 18.7500 (15.6250) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/10] time 0.265 (0.267) data 0.223 (0.224) loss_u loss_u 0.9438 (0.8615) acc_u 6.2500 (15.3125) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 350
confident_label rate tensor(0.4155, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 246
clean true:102
clean false:144
clean_rate:0.4146341463414634
noisy true:140
noisy false:206
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 346
epoch [125/200] batch [5/7] time 0.283 (0.276) data 0.242 (0.234) loss_x loss_x 0.5151 (0.6451) acc_x 90.6250 (81.8750) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/10] time 0.256 (0.265) data 0.214 (0.223) loss_u loss_u 0.7539 (0.8182) acc_u 25.0000 (22.5000) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/10] time 0.251 (0.265) data 0.208 (0.222) loss_u loss_u 0.8745 (0.8357) acc_u 15.6250 (19.0625) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 351
confident_label rate tensor(0.4307, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 255
clean true:103
clean false:152
clean_rate:0.403921568627451
noisy true:138
noisy false:199
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 337
epoch [126/200] batch [5/7] time 0.259 (0.278) data 0.217 (0.236) loss_x loss_x 0.3193 (0.4210) acc_x 87.5000 (88.1250) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/10] time 0.277 (0.267) data 0.235 (0.224) loss_u loss_u 0.7881 (0.8599) acc_u 21.8750 (15.6250) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/10] time 0.307 (0.269) data 0.265 (0.227) loss_u loss_u 0.8174 (0.8416) acc_u 21.8750 (17.5000) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 349
confident_label rate tensor(0.4392, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 260
clean true:105
clean false:155
clean_rate:0.40384615384615385
noisy true:138
noisy false:194
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 332
epoch [127/200] batch [5/8] time 0.226 (0.281) data 0.182 (0.238) loss_x loss_x 0.2201 (0.4682) acc_x 93.7500 (86.8750) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/10] time 0.247 (0.266) data 0.204 (0.223) loss_u loss_u 0.8521 (0.8597) acc_u 18.7500 (16.2500) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/10] time 0.267 (0.262) data 0.224 (0.219) loss_u loss_u 0.8291 (0.8590) acc_u 18.7500 (15.6250) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 344
confident_label rate tensor(0.4189, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 248
clean true:95
clean false:153
clean_rate:0.38306451612903225
noisy true:153
noisy false:191
after delete: len(clean_dataset) 248
after delete: len(noisy_dataset) 344
epoch [128/200] batch [5/7] time 0.277 (0.278) data 0.232 (0.234) loss_x loss_x 0.6396 (0.4861) acc_x 78.1250 (86.8750) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/10] time 0.253 (0.276) data 0.211 (0.234) loss_u loss_u 0.7681 (0.8449) acc_u 28.1250 (17.5000) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/10] time 0.293 (0.274) data 0.250 (0.232) loss_u loss_u 0.7764 (0.8352) acc_u 25.0000 (18.4375) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 352
confident_label rate tensor(0.4341, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 257
clean true:98
clean false:159
clean_rate:0.38132295719844356
noisy true:142
noisy false:193
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 335
epoch [129/200] batch [5/8] time 0.277 (0.274) data 0.234 (0.231) loss_x loss_x 0.3960 (0.5531) acc_x 87.5000 (83.7500) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/10] time 0.270 (0.267) data 0.228 (0.225) loss_u loss_u 0.8159 (0.8206) acc_u 18.7500 (18.7500) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/10] time 0.263 (0.266) data 0.221 (0.224) loss_u loss_u 0.8213 (0.8275) acc_u 18.7500 (18.1250) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 339
confident_label rate tensor(0.4257, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 252
clean true:97
clean false:155
clean_rate:0.38492063492063494
noisy true:156
noisy false:184
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 340
epoch [130/200] batch [5/7] time 0.284 (0.268) data 0.243 (0.226) loss_x loss_x 0.3462 (0.6093) acc_x 90.6250 (85.6250) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/10] time 0.269 (0.261) data 0.226 (0.219) loss_u loss_u 0.8804 (0.8385) acc_u 12.5000 (18.1250) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/10] time 0.268 (0.261) data 0.225 (0.219) loss_u loss_u 0.8311 (0.8368) acc_u 15.6250 (18.1250) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 344
confident_label rate tensor(0.4206, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 249
clean true:100
clean false:149
clean_rate:0.40160642570281124
noisy true:148
noisy false:195
after delete: len(clean_dataset) 249
after delete: len(noisy_dataset) 343
epoch [131/200] batch [5/7] time 0.248 (0.266) data 0.206 (0.223) loss_x loss_x 0.3403 (0.5045) acc_x 93.7500 (86.2500) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/10] time 0.254 (0.265) data 0.210 (0.222) loss_u loss_u 0.8472 (0.8437) acc_u 18.7500 (18.7500) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [10/10] time 0.326 (0.270) data 0.283 (0.227) loss_u loss_u 0.7715 (0.8336) acc_u 28.1250 (20.9375) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 332
confident_label rate tensor(0.4341, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 257
clean true:106
clean false:151
clean_rate:0.41245136186770426
noisy true:154
noisy false:181
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 335
epoch [132/200] batch [5/8] time 0.262 (0.257) data 0.218 (0.214) loss_x loss_x 0.4658 (0.6221) acc_x 81.2500 (83.1250) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/10] time 0.240 (0.263) data 0.198 (0.220) loss_u loss_u 0.7900 (0.8356) acc_u 21.8750 (18.1250) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [10/10] time 0.266 (0.265) data 0.221 (0.223) loss_u loss_u 0.7808 (0.8469) acc_u 21.8750 (17.8125) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 356
confident_label rate tensor(0.4409, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 261
clean true:98
clean false:163
clean_rate:0.37547892720306514
noisy true:138
noisy false:193
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 331
epoch [133/200] batch [5/8] time 0.279 (0.273) data 0.237 (0.230) loss_x loss_x 0.8188 (0.5869) acc_x 84.3750 (85.6250) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/10] time 0.285 (0.268) data 0.242 (0.225) loss_u loss_u 0.8643 (0.8473) acc_u 18.7500 (17.5000) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/10] time 0.279 (0.266) data 0.237 (0.223) loss_u loss_u 0.7192 (0.8276) acc_u 31.2500 (19.6875) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 344
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 266
clean true:101
clean false:165
clean_rate:0.37969924812030076
noisy true:147
noisy false:179
after delete: len(clean_dataset) 266
after delete: len(noisy_dataset) 326
epoch [134/200] batch [5/8] time 0.286 (0.277) data 0.244 (0.235) loss_x loss_x 0.7759 (0.6189) acc_x 75.0000 (80.6250) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/10] time 0.283 (0.268) data 0.240 (0.226) loss_u loss_u 0.8750 (0.8625) acc_u 15.6250 (16.2500) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/10] time 0.254 (0.268) data 0.212 (0.226) loss_u loss_u 0.8140 (0.8452) acc_u 21.8750 (18.1250) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 360
confident_label rate tensor(0.4324, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 256
clean true:93
clean false:163
clean_rate:0.36328125
noisy true:139
noisy false:197
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 336
epoch [135/200] batch [5/8] time 0.259 (0.260) data 0.217 (0.218) loss_x loss_x 0.4739 (0.5107) acc_x 81.2500 (82.5000) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/10] time 0.285 (0.270) data 0.242 (0.228) loss_u loss_u 0.6582 (0.7947) acc_u 40.6250 (23.7500) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/10] time 0.245 (0.270) data 0.201 (0.228) loss_u loss_u 0.8394 (0.8353) acc_u 21.8750 (20.0000) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 365
confident_label rate tensor(0.4409, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 261
clean true:89
clean false:172
clean_rate:0.34099616858237547
noisy true:138
noisy false:193
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 331
epoch [136/200] batch [5/8] time 0.280 (0.279) data 0.238 (0.237) loss_x loss_x 0.9268 (0.5954) acc_x 71.8750 (81.8750) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/10] time 0.258 (0.270) data 0.215 (0.227) loss_u loss_u 0.9033 (0.8417) acc_u 9.3750 (18.7500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/10] time 0.243 (0.268) data 0.200 (0.226) loss_u loss_u 0.7754 (0.8384) acc_u 28.1250 (19.0625) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 349
confident_label rate tensor(0.4324, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 256
clean true:98
clean false:158
clean_rate:0.3828125
noisy true:145
noisy false:191
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 336
epoch [137/200] batch [5/8] time 0.306 (0.282) data 0.264 (0.240) loss_x loss_x 0.3159 (0.5173) acc_x 93.7500 (89.3750) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/10] time 0.280 (0.273) data 0.236 (0.230) loss_u loss_u 0.8423 (0.8471) acc_u 15.6250 (16.8750) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/10] time 0.251 (0.273) data 0.209 (0.230) loss_u loss_u 0.8081 (0.8240) acc_u 21.8750 (20.0000) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 347
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 266
clean true:99
clean false:167
clean_rate:0.37218045112781956
noisy true:146
noisy false:180
after delete: len(clean_dataset) 266
after delete: len(noisy_dataset) 326
epoch [138/200] batch [5/8] time 0.282 (0.269) data 0.240 (0.227) loss_x loss_x 0.2537 (0.4498) acc_x 90.6250 (88.1250) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/10] time 0.255 (0.267) data 0.213 (0.225) loss_u loss_u 0.8989 (0.8714) acc_u 9.3750 (14.3750) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/10] time 0.260 (0.262) data 0.218 (0.220) loss_u loss_u 0.9111 (0.8668) acc_u 9.3750 (15.6250) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 351
confident_label rate tensor(0.4409, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 261
clean true:99
clean false:162
clean_rate:0.3793103448275862
noisy true:142
noisy false:189
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 331
epoch [139/200] batch [5/8] time 0.254 (0.271) data 0.212 (0.229) loss_x loss_x 0.6582 (0.7414) acc_x 81.2500 (80.0000) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/10] time 0.290 (0.265) data 0.247 (0.223) loss_u loss_u 0.9819 (0.8753) acc_u 0.0000 (12.5000) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/10] time 0.267 (0.263) data 0.224 (0.220) loss_u loss_u 0.8936 (0.8615) acc_u 15.6250 (15.0000) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 348
confident_label rate tensor(0.4527, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 268
clean true:100
clean false:168
clean_rate:0.373134328358209
noisy true:144
noisy false:180
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 324
epoch [140/200] batch [5/8] time 0.271 (0.262) data 0.229 (0.220) loss_x loss_x 0.7544 (0.5617) acc_x 84.3750 (89.3750) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/10] time 0.278 (0.268) data 0.235 (0.226) loss_u loss_u 0.8208 (0.8341) acc_u 21.8750 (18.1250) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [10/10] time 0.257 (0.268) data 0.214 (0.226) loss_u loss_u 0.8857 (0.8499) acc_u 12.5000 (16.5625) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 351
confident_label rate tensor(0.4409, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 261
clean true:102
clean false:159
clean_rate:0.39080459770114945
noisy true:139
noisy false:192
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 331
epoch [141/200] batch [5/8] time 0.255 (0.270) data 0.213 (0.229) loss_x loss_x 0.7344 (0.5984) acc_x 87.5000 (85.6250) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/10] time 0.258 (0.268) data 0.216 (0.226) loss_u loss_u 0.8535 (0.8215) acc_u 15.6250 (20.6250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/10] time 0.277 (0.267) data 0.235 (0.225) loss_u loss_u 0.8774 (0.8249) acc_u 12.5000 (19.3750) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 354
confident_label rate tensor(0.4696, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 278
clean true:103
clean false:175
clean_rate:0.37050359712230213
noisy true:135
noisy false:179
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 314
epoch [142/200] batch [5/8] time 0.270 (0.272) data 0.228 (0.230) loss_x loss_x 0.9502 (0.6678) acc_x 84.3750 (85.6250) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/9] time 0.248 (0.264) data 0.206 (0.222) loss_u loss_u 0.9028 (0.8663) acc_u 9.3750 (15.6250) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 342
confident_label rate tensor(0.4426, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 262
clean true:103
clean false:159
clean_rate:0.3931297709923664
noisy true:147
noisy false:183
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 330
epoch [143/200] batch [5/8] time 0.271 (0.269) data 0.229 (0.227) loss_x loss_x 0.6680 (0.6730) acc_x 78.1250 (79.3750) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/10] time 0.255 (0.265) data 0.213 (0.223) loss_u loss_u 0.9277 (0.8470) acc_u 6.2500 (17.5000) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/10] time 0.260 (0.260) data 0.217 (0.217) loss_u loss_u 0.8335 (0.8479) acc_u 15.6250 (16.5625) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 346
confident_label rate tensor(0.4223, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 250
clean true:98
clean false:152
clean_rate:0.392
noisy true:148
noisy false:194
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 342
epoch [144/200] batch [5/7] time 0.255 (0.267) data 0.214 (0.225) loss_x loss_x 0.8657 (0.5699) acc_x 78.1250 (88.1250) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/10] time 0.239 (0.264) data 0.197 (0.222) loss_u loss_u 0.8491 (0.8253) acc_u 15.6250 (17.5000) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/10] time 0.241 (0.263) data 0.198 (0.220) loss_u loss_u 0.7954 (0.8322) acc_u 25.0000 (17.8125) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 358
confident_label rate tensor(0.4409, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 261
clean true:94
clean false:167
clean_rate:0.36015325670498083
noisy true:140
noisy false:191
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 331
epoch [145/200] batch [5/8] time 0.332 (0.280) data 0.289 (0.238) loss_x loss_x 0.7759 (0.6534) acc_x 71.8750 (81.8750) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/10] time 0.239 (0.267) data 0.197 (0.225) loss_u loss_u 0.7808 (0.8105) acc_u 21.8750 (19.3750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/10] time 0.238 (0.266) data 0.192 (0.224) loss_u loss_u 0.8755 (0.8315) acc_u 15.6250 (18.4375) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 361
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 266
clean true:96
clean false:170
clean_rate:0.3609022556390977
noisy true:135
noisy false:191
after delete: len(clean_dataset) 266
after delete: len(noisy_dataset) 326
epoch [146/200] batch [5/8] time 0.283 (0.274) data 0.240 (0.231) loss_x loss_x 0.9404 (0.4665) acc_x 84.3750 (90.0000) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/10] time 0.248 (0.266) data 0.206 (0.224) loss_u loss_u 0.8447 (0.8237) acc_u 21.8750 (20.0000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/10] time 0.258 (0.266) data 0.215 (0.224) loss_u loss_u 0.8604 (0.8328) acc_u 15.6250 (18.4375) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 355
confident_label rate tensor(0.4409, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 261
clean true:88
clean false:173
clean_rate:0.3371647509578544
noisy true:149
noisy false:182
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 331
epoch [147/200] batch [5/8] time 0.302 (0.270) data 0.259 (0.228) loss_x loss_x 0.3774 (0.5357) acc_x 90.6250 (86.2500) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/10] time 0.284 (0.266) data 0.241 (0.223) loss_u loss_u 0.8691 (0.8742) acc_u 12.5000 (13.1250) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/10] time 0.258 (0.265) data 0.213 (0.222) loss_u loss_u 0.8804 (0.8494) acc_u 18.7500 (16.2500) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 352
confident_label rate tensor(0.4392, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 260
clean true:100
clean false:160
clean_rate:0.38461538461538464
noisy true:140
noisy false:192
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 332
epoch [148/200] batch [5/8] time 0.314 (0.279) data 0.272 (0.236) loss_x loss_x 0.2234 (0.4941) acc_x 93.7500 (88.7500) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/10] time 0.279 (0.269) data 0.237 (0.227) loss_u loss_u 0.9331 (0.8587) acc_u 9.3750 (16.8750) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/10] time 0.285 (0.269) data 0.243 (0.226) loss_u loss_u 0.8706 (0.8411) acc_u 15.6250 (19.0625) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 356
confident_label rate tensor(0.4291, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 254
clean true:96
clean false:158
clean_rate:0.3779527559055118
noisy true:140
noisy false:198
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 338
epoch [149/200] batch [5/7] time 0.252 (0.267) data 0.210 (0.225) loss_x loss_x 0.7026 (0.5567) acc_x 71.8750 (85.0000) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/10] time 0.260 (0.265) data 0.218 (0.223) loss_u loss_u 0.7705 (0.8241) acc_u 25.0000 (20.0000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/10] time 0.265 (0.266) data 0.224 (0.224) loss_u loss_u 0.7905 (0.8229) acc_u 25.0000 (20.0000) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 339
confident_label rate tensor(0.4307, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 255
clean true:95
clean false:160
clean_rate:0.37254901960784315
noisy true:158
noisy false:179
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 337
epoch [150/200] batch [5/7] time 0.262 (0.271) data 0.220 (0.229) loss_x loss_x 0.4031 (0.6238) acc_x 84.3750 (81.8750) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/10] time 0.274 (0.271) data 0.232 (0.229) loss_u loss_u 0.7285 (0.8412) acc_u 31.2500 (16.8750) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/10] time 0.264 (0.269) data 0.222 (0.227) loss_u loss_u 0.8760 (0.8316) acc_u 12.5000 (19.3750) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 368
confident_label rate tensor(0.4392, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 260
clean true:93
clean false:167
clean_rate:0.3576923076923077
noisy true:131
noisy false:201
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 332
epoch [151/200] batch [5/8] time 0.241 (0.263) data 0.199 (0.221) loss_x loss_x 0.8770 (0.6025) acc_x 71.8750 (83.1250) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/10] time 0.272 (0.268) data 0.230 (0.226) loss_u loss_u 0.9536 (0.8659) acc_u 3.1250 (16.2500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/10] time 0.267 (0.268) data 0.225 (0.226) loss_u loss_u 0.7651 (0.8460) acc_u 25.0000 (17.8125) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 351
confident_label rate tensor(0.4527, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 268
clean true:107
clean false:161
clean_rate:0.39925373134328357
noisy true:134
noisy false:190
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 324
epoch [152/200] batch [5/8] time 0.295 (0.281) data 0.253 (0.239) loss_x loss_x 0.6602 (0.4479) acc_x 84.3750 (87.5000) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/10] time 0.258 (0.275) data 0.216 (0.233) loss_u loss_u 0.8584 (0.8615) acc_u 15.6250 (18.1250) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/10] time 0.266 (0.273) data 0.220 (0.230) loss_u loss_u 0.8311 (0.8498) acc_u 18.7500 (18.1250) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 356
confident_label rate tensor(0.4358, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 258
clean true:93
clean false:165
clean_rate:0.36046511627906974
noisy true:143
noisy false:191
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 334
epoch [153/200] batch [5/8] time 0.264 (0.268) data 0.222 (0.224) loss_x loss_x 0.4958 (0.5335) acc_x 87.5000 (86.8750) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/10] time 0.270 (0.278) data 0.228 (0.235) loss_u loss_u 0.8599 (0.8495) acc_u 18.7500 (18.1250) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/10] time 0.269 (0.275) data 0.227 (0.232) loss_u loss_u 0.7974 (0.8345) acc_u 21.8750 (19.0625) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 346
confident_label rate tensor(0.4459, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 264
clean true:103
clean false:161
clean_rate:0.39015151515151514
noisy true:143
noisy false:185
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 328
epoch [154/200] batch [5/8] time 0.253 (0.267) data 0.211 (0.225) loss_x loss_x 0.4419 (0.4540) acc_x 84.3750 (88.7500) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/10] time 0.254 (0.276) data 0.212 (0.234) loss_u loss_u 0.8828 (0.8176) acc_u 15.6250 (20.6250) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/10] time 0.342 (0.282) data 0.298 (0.240) loss_u loss_u 0.8423 (0.8397) acc_u 15.6250 (18.4375) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 360
confident_label rate tensor(0.4358, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 258
clean true:94
clean false:164
clean_rate:0.3643410852713178
noisy true:138
noisy false:196
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 334
epoch [155/200] batch [5/8] time 0.269 (0.271) data 0.227 (0.227) loss_x loss_x 0.4041 (0.4282) acc_x 90.6250 (89.3750) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/10] time 0.253 (0.269) data 0.211 (0.226) loss_u loss_u 0.7168 (0.8266) acc_u 31.2500 (20.0000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/10] time 0.263 (0.268) data 0.220 (0.226) loss_u loss_u 0.7305 (0.8270) acc_u 28.1250 (19.6875) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 357
confident_label rate tensor(0.4392, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 260
clean true:94
clean false:166
clean_rate:0.36153846153846153
noisy true:141
noisy false:191
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 332
epoch [156/200] batch [5/8] time 0.268 (0.261) data 0.226 (0.218) loss_x loss_x 0.1744 (0.4218) acc_x 90.6250 (86.2500) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/10] time 0.283 (0.267) data 0.240 (0.225) loss_u loss_u 0.8110 (0.8544) acc_u 18.7500 (15.6250) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/10] time 0.253 (0.268) data 0.211 (0.225) loss_u loss_u 0.7520 (0.8397) acc_u 28.1250 (17.8125) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 353
confident_label rate tensor(0.4392, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 260
clean true:97
clean false:163
clean_rate:0.3730769230769231
noisy true:142
noisy false:190
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 332
epoch [157/200] batch [5/8] time 0.276 (0.264) data 0.234 (0.222) loss_x loss_x 0.5508 (0.4959) acc_x 90.6250 (85.6250) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/10] time 0.232 (0.260) data 0.190 (0.218) loss_u loss_u 0.8691 (0.8380) acc_u 15.6250 (17.5000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/10] time 0.268 (0.260) data 0.226 (0.218) loss_u loss_u 0.8296 (0.8316) acc_u 18.7500 (19.0625) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 355
confident_label rate tensor(0.4392, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 260
clean true:98
clean false:162
clean_rate:0.3769230769230769
noisy true:139
noisy false:193
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 332
epoch [158/200] batch [5/8] time 0.260 (0.265) data 0.218 (0.223) loss_x loss_x 0.5586 (0.4873) acc_x 90.6250 (90.0000) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/10] time 0.266 (0.269) data 0.224 (0.227) loss_u loss_u 0.7119 (0.8317) acc_u 34.3750 (16.8750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/10] time 0.256 (0.266) data 0.214 (0.224) loss_u loss_u 0.8701 (0.8440) acc_u 15.6250 (16.5625) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 353
confident_label rate tensor(0.4274, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 253
clean true:98
clean false:155
clean_rate:0.38735177865612647
noisy true:141
noisy false:198
after delete: len(clean_dataset) 253
after delete: len(noisy_dataset) 339
epoch [159/200] batch [5/7] time 0.328 (0.266) data 0.285 (0.224) loss_x loss_x 0.3457 (0.4795) acc_x 93.7500 (91.2500) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/10] time 0.266 (0.264) data 0.224 (0.222) loss_u loss_u 0.7241 (0.7932) acc_u 31.2500 (23.7500) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/10] time 0.273 (0.264) data 0.229 (0.221) loss_u loss_u 0.7817 (0.8246) acc_u 25.0000 (19.6875) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 356
confident_label rate tensor(0.4510, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 267
clean true:99
clean false:168
clean_rate:0.3707865168539326
noisy true:137
noisy false:188
after delete: len(clean_dataset) 267
after delete: len(noisy_dataset) 325
epoch [160/200] batch [5/8] time 0.250 (0.270) data 0.207 (0.227) loss_x loss_x 0.5137 (0.5256) acc_x 84.3750 (85.0000) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/10] time 0.276 (0.268) data 0.234 (0.226) loss_u loss_u 0.8916 (0.8347) acc_u 9.3750 (18.7500) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/10] time 0.270 (0.268) data 0.228 (0.225) loss_u loss_u 0.8711 (0.8331) acc_u 15.6250 (19.6875) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 348
confident_label rate tensor(0.4628, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 274
clean true:104
clean false:170
clean_rate:0.3795620437956204
noisy true:140
noisy false:178
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 318
epoch [161/200] batch [5/8] time 0.282 (0.272) data 0.239 (0.229) loss_x loss_x 0.2397 (0.4333) acc_x 96.8750 (88.1250) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/9] time 0.285 (0.272) data 0.241 (0.229) loss_u loss_u 0.9287 (0.8638) acc_u 9.3750 (15.6250) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 366
confident_label rate tensor(0.4409, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 261
clean true:98
clean false:163
clean_rate:0.37547892720306514
noisy true:128
noisy false:203
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 331
epoch [162/200] batch [5/8] time 0.262 (0.270) data 0.220 (0.227) loss_x loss_x 0.3176 (0.4644) acc_x 93.7500 (89.3750) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/10] time 0.250 (0.261) data 0.208 (0.219) loss_u loss_u 0.7192 (0.8151) acc_u 31.2500 (20.6250) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [10/10] time 0.266 (0.262) data 0.224 (0.220) loss_u loss_u 0.8984 (0.8354) acc_u 9.3750 (18.1250) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 361
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 263
clean true:95
clean false:168
clean_rate:0.3612167300380228
noisy true:136
noisy false:193
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 329
epoch [163/200] batch [5/8] time 0.258 (0.261) data 0.217 (0.219) loss_x loss_x 0.3398 (0.4915) acc_x 90.6250 (88.1250) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/10] time 0.258 (0.269) data 0.216 (0.227) loss_u loss_u 0.8506 (0.7979) acc_u 18.7500 (24.3750) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [10/10] time 0.263 (0.265) data 0.220 (0.222) loss_u loss_u 0.8647 (0.8354) acc_u 18.7500 (19.3750) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 341
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 275
clean true:104
clean false:171
clean_rate:0.3781818181818182
noisy true:147
noisy false:170
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 317
epoch [164/200] batch [5/8] time 0.270 (0.265) data 0.228 (0.222) loss_x loss_x 0.4661 (0.6478) acc_x 84.3750 (86.2500) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/9] time 0.269 (0.263) data 0.226 (0.221) loss_u loss_u 0.8320 (0.8624) acc_u 18.7500 (15.0000) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 352
confident_label rate tensor(0.4476, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 265
clean true:97
clean false:168
clean_rate:0.3660377358490566
noisy true:143
noisy false:184
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 327
epoch [165/200] batch [5/8] time 0.310 (0.275) data 0.268 (0.233) loss_x loss_x 1.0352 (0.5484) acc_x 81.2500 (87.5000) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/10] time 0.247 (0.272) data 0.204 (0.230) loss_u loss_u 0.9023 (0.8356) acc_u 12.5000 (20.0000) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/10] time 0.264 (0.272) data 0.221 (0.230) loss_u loss_u 0.8232 (0.8360) acc_u 18.7500 (19.3750) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 359
confident_label rate tensor(0.4578, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 271
clean true:98
clean false:173
clean_rate:0.36162361623616235
noisy true:135
noisy false:186
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 321
epoch [166/200] batch [5/8] time 0.276 (0.267) data 0.234 (0.225) loss_x loss_x 0.5015 (0.4958) acc_x 90.6250 (85.6250) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/10] time 0.261 (0.266) data 0.219 (0.224) loss_u loss_u 0.7915 (0.8510) acc_u 21.8750 (16.8750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/10] time 0.247 (0.265) data 0.205 (0.223) loss_u loss_u 0.9072 (0.8402) acc_u 9.3750 (17.5000) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 356
confident_label rate tensor(0.4476, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 265
clean true:97
clean false:168
clean_rate:0.3660377358490566
noisy true:139
noisy false:188
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 327
epoch [167/200] batch [5/8] time 0.261 (0.271) data 0.218 (0.228) loss_x loss_x 0.3972 (0.5788) acc_x 84.3750 (85.0000) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/10] time 0.262 (0.267) data 0.219 (0.225) loss_u loss_u 0.7480 (0.7930) acc_u 31.2500 (25.6250) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/10] time 0.238 (0.266) data 0.191 (0.223) loss_u loss_u 0.8433 (0.8321) acc_u 18.7500 (20.0000) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 351
confident_label rate tensor(0.4426, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 262
clean true:97
clean false:165
clean_rate:0.3702290076335878
noisy true:144
noisy false:186
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 330
epoch [168/200] batch [5/8] time 0.266 (0.278) data 0.224 (0.236) loss_x loss_x 0.2920 (0.3414) acc_x 93.7500 (91.2500) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/10] time 0.283 (0.279) data 0.241 (0.237) loss_u loss_u 0.8325 (0.8718) acc_u 18.7500 (13.1250) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [10/10] time 0.293 (0.278) data 0.247 (0.235) loss_u loss_u 0.8550 (0.8458) acc_u 18.7500 (17.5000) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 351
confident_label rate tensor(0.4510, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 267
clean true:102
clean false:165
clean_rate:0.38202247191011235
noisy true:139
noisy false:186
after delete: len(clean_dataset) 267
after delete: len(noisy_dataset) 325
epoch [169/200] batch [5/8] time 0.280 (0.259) data 0.237 (0.217) loss_x loss_x 0.3054 (0.3832) acc_x 90.6250 (90.6250) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/10] time 0.244 (0.268) data 0.198 (0.225) loss_u loss_u 0.8257 (0.8277) acc_u 18.7500 (20.0000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/10] time 0.259 (0.265) data 0.215 (0.222) loss_u loss_u 0.8325 (0.8356) acc_u 18.7500 (19.3750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 363
confident_label rate tensor(0.4527, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 268
clean true:97
clean false:171
clean_rate:0.3619402985074627
noisy true:132
noisy false:192
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 324
epoch [170/200] batch [5/8] time 0.274 (0.279) data 0.231 (0.237) loss_x loss_x 0.5239 (0.5235) acc_x 87.5000 (86.2500) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/10] time 0.219 (0.268) data 0.175 (0.226) loss_u loss_u 0.9175 (0.8277) acc_u 9.3750 (18.7500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/10] time 0.292 (0.268) data 0.250 (0.225) loss_u loss_u 0.8174 (0.8410) acc_u 21.8750 (18.4375) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 358
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 275
clean true:102
clean false:173
clean_rate:0.3709090909090909
noisy true:132
noisy false:185
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 317
epoch [171/200] batch [5/8] time 0.259 (0.264) data 0.214 (0.220) loss_x loss_x 0.4885 (0.6327) acc_x 84.3750 (83.7500) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/9] time 0.228 (0.269) data 0.185 (0.226) loss_u loss_u 0.7974 (0.8060) acc_u 21.8750 (21.8750) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 340
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 263
clean true:100
clean false:163
clean_rate:0.38022813688212925
noisy true:152
noisy false:177
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 329
epoch [172/200] batch [5/8] time 0.286 (0.279) data 0.244 (0.237) loss_x loss_x 0.2737 (0.4341) acc_x 96.8750 (87.5000) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/10] time 0.217 (0.267) data 0.173 (0.224) loss_u loss_u 0.8135 (0.8473) acc_u 18.7500 (16.2500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [10/10] time 0.274 (0.267) data 0.232 (0.225) loss_u loss_u 0.8809 (0.8470) acc_u 12.5000 (16.8750) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 351
confident_label rate tensor(0.4713, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 279
clean true:102
clean false:177
clean_rate:0.3655913978494624
noisy true:139
noisy false:174
after delete: len(clean_dataset) 279
after delete: len(noisy_dataset) 313
epoch [173/200] batch [5/8] time 0.290 (0.269) data 0.245 (0.226) loss_x loss_x 0.6045 (0.5685) acc_x 96.8750 (89.3750) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/9] time 0.234 (0.263) data 0.191 (0.220) loss_u loss_u 0.8804 (0.8603) acc_u 15.6250 (16.2500) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 354
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 263
clean true:96
clean false:167
clean_rate:0.3650190114068441
noisy true:142
noisy false:187
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 329
epoch [174/200] batch [5/8] time 0.248 (0.267) data 0.206 (0.225) loss_x loss_x 0.3403 (0.5361) acc_x 96.8750 (92.5000) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/10] time 0.256 (0.273) data 0.214 (0.231) loss_u loss_u 0.8076 (0.8330) acc_u 21.8750 (17.5000) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/10] time 0.246 (0.268) data 0.203 (0.225) loss_u loss_u 0.8789 (0.8281) acc_u 15.6250 (18.7500) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 358
confident_label rate tensor(0.4679, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 277
clean true:99
clean false:178
clean_rate:0.3574007220216607
noisy true:135
noisy false:180
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 315
epoch [175/200] batch [5/8] time 0.275 (0.269) data 0.231 (0.226) loss_x loss_x 0.4807 (0.4518) acc_x 90.6250 (86.8750) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/9] time 0.298 (0.271) data 0.253 (0.228) loss_u loss_u 0.8911 (0.8760) acc_u 12.5000 (12.5000) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 351
confident_label rate tensor(0.4611, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 273
clean true:98
clean false:175
clean_rate:0.358974358974359
noisy true:143
noisy false:176
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 319
epoch [176/200] batch [5/8] time 0.289 (0.272) data 0.242 (0.229) loss_x loss_x 0.7715 (0.4789) acc_x 81.2500 (87.5000) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/9] time 0.263 (0.272) data 0.221 (0.229) loss_u loss_u 0.9160 (0.8728) acc_u 9.3750 (13.7500) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 362
confident_label rate tensor(0.4578, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 271
clean true:99
clean false:172
clean_rate:0.36531365313653136
noisy true:131
noisy false:190
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 321
epoch [177/200] batch [5/8] time 0.281 (0.269) data 0.236 (0.227) loss_x loss_x 0.4819 (0.4658) acc_x 87.5000 (86.8750) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/10] time 0.261 (0.273) data 0.220 (0.231) loss_u loss_u 0.8843 (0.8230) acc_u 12.5000 (20.0000) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/10] time 0.280 (0.271) data 0.237 (0.228) loss_u loss_u 0.8403 (0.8375) acc_u 15.6250 (17.8125) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 368
confident_label rate tensor(0.4679, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 277
clean true:99
clean false:178
clean_rate:0.3574007220216607
noisy true:125
noisy false:190
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 315
epoch [178/200] batch [5/8] time 0.282 (0.280) data 0.240 (0.238) loss_x loss_x 0.4758 (0.4207) acc_x 87.5000 (88.7500) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/9] time 0.259 (0.268) data 0.212 (0.225) loss_u loss_u 0.9302 (0.8634) acc_u 3.1250 (13.7500) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 353
confident_label rate tensor(0.4696, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 278
clean true:105
clean false:173
clean_rate:0.3776978417266187
noisy true:134
noisy false:180
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 314
epoch [179/200] batch [5/8] time 0.288 (0.276) data 0.246 (0.234) loss_x loss_x 0.3748 (0.3747) acc_x 90.6250 (88.7500) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/9] time 0.242 (0.268) data 0.200 (0.226) loss_u loss_u 0.6558 (0.8465) acc_u 37.5000 (16.8750) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 347
confident_label rate tensor(0.4544, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 269
clean true:106
clean false:163
clean_rate:0.3940520446096654
noisy true:139
noisy false:184
after delete: len(clean_dataset) 269
after delete: len(noisy_dataset) 323
epoch [180/200] batch [5/8] time 0.253 (0.273) data 0.210 (0.231) loss_x loss_x 0.4397 (0.3307) acc_x 84.3750 (89.3750) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/10] time 0.269 (0.270) data 0.227 (0.228) loss_u loss_u 0.8027 (0.8349) acc_u 21.8750 (18.7500) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/10] time 0.252 (0.265) data 0.210 (0.223) loss_u loss_u 0.9014 (0.8482) acc_u 12.5000 (17.5000) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 357
confident_label rate tensor(0.4595, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 272
clean true:101
clean false:171
clean_rate:0.3713235294117647
noisy true:134
noisy false:186
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 320
epoch [181/200] batch [5/8] time 0.270 (0.270) data 0.229 (0.228) loss_x loss_x 0.1724 (0.5760) acc_x 100.0000 (86.2500) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/10] time 0.271 (0.274) data 0.224 (0.231) loss_u loss_u 0.6855 (0.8267) acc_u 31.2500 (18.7500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [10/10] time 0.256 (0.267) data 0.214 (0.225) loss_u loss_u 0.8896 (0.8344) acc_u 9.3750 (17.1875) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 345
confident_label rate tensor(0.4476, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 265
clean true:105
clean false:160
clean_rate:0.39622641509433965
noisy true:142
noisy false:185
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 327
epoch [182/200] batch [5/8] time 0.257 (0.275) data 0.216 (0.233) loss_x loss_x 0.5483 (0.4156) acc_x 84.3750 (88.7500) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/10] time 0.243 (0.268) data 0.200 (0.226) loss_u loss_u 0.9224 (0.8633) acc_u 9.3750 (15.0000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/10] time 0.266 (0.267) data 0.225 (0.225) loss_u loss_u 0.8511 (0.8440) acc_u 18.7500 (17.1875) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 361
confident_label rate tensor(0.4595, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 272
clean true:96
clean false:176
clean_rate:0.35294117647058826
noisy true:135
noisy false:185
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 320
epoch [183/200] batch [5/8] time 0.292 (0.278) data 0.248 (0.236) loss_x loss_x 0.1992 (0.4930) acc_x 93.7500 (88.7500) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/10] time 0.243 (0.266) data 0.200 (0.223) loss_u loss_u 0.7456 (0.8320) acc_u 28.1250 (18.7500) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/10] time 0.271 (0.267) data 0.228 (0.224) loss_u loss_u 0.9097 (0.8509) acc_u 6.2500 (16.2500) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 360
confident_label rate tensor(0.4578, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 271
clean true:101
clean false:170
clean_rate:0.3726937269372694
noisy true:131
noisy false:190
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 321
epoch [184/200] batch [5/8] time 0.274 (0.263) data 0.232 (0.221) loss_x loss_x 0.5322 (0.4292) acc_x 84.3750 (88.7500) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/10] time 0.258 (0.263) data 0.216 (0.221) loss_u loss_u 0.8027 (0.8428) acc_u 28.1250 (19.3750) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [10/10] time 0.264 (0.263) data 0.219 (0.221) loss_u loss_u 0.8799 (0.8440) acc_u 15.6250 (19.0625) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 349
confident_label rate tensor(0.4679, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 277
clean true:99
clean false:178
clean_rate:0.3574007220216607
noisy true:144
noisy false:171
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 315
epoch [185/200] batch [5/8] time 0.238 (0.260) data 0.196 (0.218) loss_x loss_x 0.4822 (0.5831) acc_x 87.5000 (84.3750) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/9] time 0.309 (0.263) data 0.263 (0.220) loss_u loss_u 0.8721 (0.8824) acc_u 15.6250 (13.7500) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 343
confident_label rate tensor(0.4544, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 269
clean true:105
clean false:164
clean_rate:0.3903345724907063
noisy true:144
noisy false:179
after delete: len(clean_dataset) 269
after delete: len(noisy_dataset) 323
epoch [186/200] batch [5/8] time 0.254 (0.269) data 0.212 (0.226) loss_x loss_x 0.2610 (0.3538) acc_x 96.8750 (90.6250) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/10] time 0.259 (0.263) data 0.217 (0.221) loss_u loss_u 0.7764 (0.8085) acc_u 25.0000 (21.8750) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [10/10] time 0.263 (0.263) data 0.221 (0.221) loss_u loss_u 0.8892 (0.8367) acc_u 12.5000 (18.7500) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 357
confident_label rate tensor(0.4561, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 270
clean true:100
clean false:170
clean_rate:0.37037037037037035
noisy true:135
noisy false:187
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 322
epoch [187/200] batch [5/8] time 0.280 (0.274) data 0.238 (0.232) loss_x loss_x 0.2788 (0.3710) acc_x 93.7500 (89.3750) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/10] time 0.246 (0.265) data 0.204 (0.223) loss_u loss_u 0.8994 (0.8629) acc_u 9.3750 (15.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [10/10] time 0.252 (0.263) data 0.210 (0.220) loss_u loss_u 0.8530 (0.8447) acc_u 15.6250 (17.8125) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 345
confident_label rate tensor(0.4578, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 271
clean true:108
clean false:163
clean_rate:0.3985239852398524
noisy true:139
noisy false:182
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 321
epoch [188/200] batch [5/8] time 0.244 (0.269) data 0.202 (0.227) loss_x loss_x 0.5244 (0.5212) acc_x 87.5000 (85.6250) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/10] time 0.278 (0.265) data 0.235 (0.223) loss_u loss_u 0.7861 (0.8678) acc_u 18.7500 (13.7500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/10] time 0.265 (0.263) data 0.222 (0.221) loss_u loss_u 0.8496 (0.8396) acc_u 15.6250 (18.1250) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 353
confident_label rate tensor(0.4459, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 264
clean true:97
clean false:167
clean_rate:0.36742424242424243
noisy true:142
noisy false:186
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 328
epoch [189/200] batch [5/8] time 0.270 (0.268) data 0.228 (0.226) loss_x loss_x 0.3772 (0.4245) acc_x 84.3750 (86.8750) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/10] time 0.243 (0.263) data 0.200 (0.220) loss_u loss_u 0.7617 (0.8246) acc_u 25.0000 (18.1250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/10] time 0.251 (0.261) data 0.209 (0.219) loss_u loss_u 0.7344 (0.8419) acc_u 34.3750 (17.1875) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 352
confident_label rate tensor(0.4628, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 274
clean true:101
clean false:173
clean_rate:0.3686131386861314
noisy true:139
noisy false:179
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 318
epoch [190/200] batch [5/8] time 0.264 (0.269) data 0.222 (0.228) loss_x loss_x 0.2729 (0.3378) acc_x 90.6250 (92.5000) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/9] time 0.256 (0.266) data 0.214 (0.224) loss_u loss_u 0.8306 (0.8319) acc_u 15.6250 (17.5000) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 360
confident_label rate tensor(0.4848, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 287
clean true:100
clean false:187
clean_rate:0.34843205574912894
noisy true:132
noisy false:173
after delete: len(clean_dataset) 287
after delete: len(noisy_dataset) 305
epoch [191/200] batch [5/8] time 0.270 (0.269) data 0.227 (0.225) loss_x loss_x 0.5312 (0.4306) acc_x 93.7500 (91.8750) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/9] time 0.255 (0.266) data 0.212 (0.223) loss_u loss_u 0.8540 (0.8575) acc_u 15.6250 (15.0000) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 344
confident_label rate tensor(0.4578, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 271
clean true:101
clean false:170
clean_rate:0.3726937269372694
noisy true:147
noisy false:174
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 321
epoch [192/200] batch [5/8] time 0.274 (0.285) data 0.231 (0.243) loss_x loss_x 0.4050 (0.4688) acc_x 93.7500 (91.2500) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/10] time 0.256 (0.272) data 0.213 (0.229) loss_u loss_u 0.8867 (0.8863) acc_u 15.6250 (13.1250) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [10/10] time 0.277 (0.271) data 0.234 (0.228) loss_u loss_u 0.7578 (0.8489) acc_u 25.0000 (17.1875) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 356
confident_label rate tensor(0.4544, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 269
clean true:101
clean false:168
clean_rate:0.3754646840148699
noisy true:135
noisy false:188
after delete: len(clean_dataset) 269
after delete: len(noisy_dataset) 323
epoch [193/200] batch [5/8] time 0.256 (0.266) data 0.214 (0.224) loss_x loss_x 0.4756 (0.3913) acc_x 90.6250 (90.0000) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/10] time 0.275 (0.264) data 0.232 (0.221) loss_u loss_u 0.8413 (0.8636) acc_u 15.6250 (13.7500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/10] time 0.257 (0.264) data 0.215 (0.221) loss_u loss_u 0.7505 (0.8409) acc_u 28.1250 (17.8125) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 361
confident_label rate tensor(0.4611, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 273
clean true:100
clean false:173
clean_rate:0.3663003663003663
noisy true:131
noisy false:188
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 319
epoch [194/200] batch [5/8] time 0.256 (0.277) data 0.212 (0.234) loss_x loss_x 0.2930 (0.4146) acc_x 87.5000 (87.5000) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/9] time 0.265 (0.264) data 0.221 (0.221) loss_u loss_u 0.8936 (0.8571) acc_u 12.5000 (16.2500) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 353
confident_label rate tensor(0.4476, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 265
clean true:98
clean false:167
clean_rate:0.36981132075471695
noisy true:141
noisy false:186
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 327
epoch [195/200] batch [5/8] time 0.267 (0.265) data 0.225 (0.223) loss_x loss_x 0.5894 (0.4224) acc_x 81.2500 (88.7500) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/10] time 0.285 (0.260) data 0.238 (0.217) loss_u loss_u 0.8989 (0.8496) acc_u 9.3750 (16.2500) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/10] time 0.319 (0.266) data 0.277 (0.224) loss_u loss_u 0.8408 (0.8408) acc_u 15.6250 (17.5000) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 361
confident_label rate tensor(0.4527, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 268
clean true:99
clean false:169
clean_rate:0.3694029850746269
noisy true:132
noisy false:192
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 324
epoch [196/200] batch [5/8] time 0.255 (0.262) data 0.213 (0.220) loss_x loss_x 0.2483 (0.3506) acc_x 100.0000 (88.1250) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/10] time 0.287 (0.263) data 0.245 (0.221) loss_u loss_u 0.8828 (0.8522) acc_u 12.5000 (16.2500) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/10] time 0.248 (0.263) data 0.206 (0.221) loss_u loss_u 0.7085 (0.8267) acc_u 31.2500 (18.4375) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 353
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 275
clean true:99
clean false:176
clean_rate:0.36
noisy true:140
noisy false:177
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 317
epoch [197/200] batch [5/8] time 0.244 (0.270) data 0.202 (0.228) loss_x loss_x 0.6997 (0.5548) acc_x 84.3750 (85.0000) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/9] time 0.278 (0.261) data 0.236 (0.219) loss_u loss_u 0.7559 (0.8565) acc_u 28.1250 (15.0000) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 366
confident_label rate tensor(0.4341, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 257
clean true:93
clean false:164
clean_rate:0.36186770428015563
noisy true:133
noisy false:202
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 335
epoch [198/200] batch [5/8] time 0.250 (0.265) data 0.208 (0.223) loss_x loss_x 0.5215 (0.3965) acc_x 87.5000 (90.6250) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/10] time 0.261 (0.262) data 0.218 (0.220) loss_u loss_u 0.8613 (0.8292) acc_u 15.6250 (18.7500) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/10] time 0.272 (0.262) data 0.230 (0.220) loss_u loss_u 0.7866 (0.8254) acc_u 21.8750 (19.0625) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 342
confident_label rate tensor(0.4561, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 270
clean true:99
clean false:171
clean_rate:0.36666666666666664
noisy true:151
noisy false:171
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 322
epoch [199/200] batch [5/8] time 0.282 (0.263) data 0.240 (0.221) loss_x loss_x 0.7534 (0.5430) acc_x 75.0000 (84.3750) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/10] time 0.283 (0.267) data 0.240 (0.225) loss_u loss_u 0.7871 (0.8416) acc_u 25.0000 (17.5000) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/10] time 0.268 (0.269) data 0.226 (0.226) loss_u loss_u 0.7930 (0.8392) acc_u 21.8750 (17.5000) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
[OT_PL] Loading all features and outputs... Total samples: 576
[OT_PL] Features shape: torch.Size([576, 1024]), Outputs shape: torch.Size([576, 37])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([576, 37]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([576]), b.shape=torch.Size([37]), P.shape=torch.Size([576, 37]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([576, 37])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 592
before epoch:different number: 356
confident_label rate tensor(0.4426, device='cuda:0')
before: len(self.train) 592
before: len of confident samples 262
clean true:99
clean false:163
clean_rate:0.37786259541984735
noisy true:137
noisy false:193
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 330
epoch [200/200] batch [5/8] time 0.263 (0.276) data 0.221 (0.234) loss_x loss_x 0.3669 (0.5368) acc_x 93.7500 (88.1250) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/10] time 0.254 (0.262) data 0.211 (0.220) loss_u loss_u 0.8418 (0.7970) acc_u 15.6250 (23.1250) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/10] time 0.266 (0.258) data 0.223 (0.215) loss_u loss_u 0.8789 (0.8252) acc_u 12.5000 (19.6875) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/oxford_pets/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 592
after epoch: len(noisy dataset) 592
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,669
* correct: 1,615
* accuracy: 44.0%
* error: 56.0%
* macro_f1: 42.3%
Elapsed: 0:34:10
