***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '47']
output_dir: output/dtd/NLPrompt/rn50_16shots/noise_sym_0.625/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: DescribableTextures
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 47
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/dtd/NLPrompt/rn50_16shots/noise_sym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: DescribableTextures
Reading split from /home/convex/datasets/nlprompt/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/dtd/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 23
Data loader size: 2
Data loader size: 17
---------  -------------------
Dataset    DescribableTextures
# classes  47
# train_x  752
# val      188
# test     1,692
---------  -------------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/dtd/NLPrompt/rn50_16shots/noise_sym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 569
confident_label rate tensor(0.0931, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 70
clean true:58
clean false:12
clean_rate:0.8285714285714286
noisy true:125
noisy false:557
after delete: len(clean_dataset) 70
after delete: len(noisy_dataset) 682
epoch [1/200] batch [1/2] time 0.385 (0.385) data 0.245 (0.245) loss_x loss_x 2.5371 (2.5371) acc_x 46.8750 (46.8750) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [2/2] time 0.329 (0.357) data 0.278 (0.261) loss_x loss_x 2.7070 (2.6221) acc_x 50.0000 (48.4375) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/21] time 0.293 (0.323) data 0.245 (0.259) loss_u loss_u 0.9780 (0.9758) acc_u 0.0000 (3.1250) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [10/21] time 0.280 (0.302) data 0.231 (0.244) loss_u loss_u 0.9766 (0.9744) acc_u 3.1250 (3.1250) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [15/21] time 0.270 (0.293) data 0.222 (0.238) loss_u loss_u 0.9746 (0.9743) acc_u 3.1250 (3.3333) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [20/21] time 0.256 (0.290) data 0.207 (0.237) loss_u loss_u 0.9854 (0.9748) acc_u 0.0000 (2.9688) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 567
confident_label rate tensor(0.0984, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 74
clean true:62
clean false:12
clean_rate:0.8378378378378378
noisy true:123
noisy false:555
after delete: len(clean_dataset) 74
after delete: len(noisy_dataset) 678
epoch [2/200] batch [1/2] time 0.289 (0.289) data 0.242 (0.242) loss_x loss_x 2.7324 (2.7324) acc_x 31.2500 (31.2500) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [2/2] time 0.310 (0.300) data 0.262 (0.252) loss_x loss_x 2.2812 (2.5068) acc_x 40.6250 (35.9375) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/21] time 0.260 (0.293) data 0.210 (0.245) loss_u loss_u 0.9688 (0.9436) acc_u 3.1250 (7.5000) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [10/21] time 0.313 (0.298) data 0.262 (0.249) loss_u loss_u 0.8774 (0.9364) acc_u 25.0000 (9.6875) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [15/21] time 0.304 (0.300) data 0.256 (0.252) loss_u loss_u 0.9561 (0.9403) acc_u 3.1250 (8.3333) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [20/21] time 0.314 (0.301) data 0.267 (0.253) loss_u loss_u 0.8896 (0.9354) acc_u 15.6250 (8.9062) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 471
confident_label rate tensor(0.1263, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 95
clean true:95
clean false:0
clean_rate:1.0
noisy true:186
noisy false:471
after delete: len(clean_dataset) 95
after delete: len(noisy_dataset) 657
epoch [3/200] batch [1/2] time 0.326 (0.326) data 0.278 (0.278) loss_x loss_x 0.8125 (0.8125) acc_x 84.3750 (84.3750) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [2/2] time 0.274 (0.300) data 0.226 (0.252) loss_x loss_x 1.3232 (1.0679) acc_x 62.5000 (73.4375) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/20] time 0.303 (0.293) data 0.254 (0.244) loss_u loss_u 0.9443 (0.9561) acc_u 6.2500 (5.0000) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/20] time 0.311 (0.294) data 0.262 (0.246) loss_u loss_u 0.9595 (0.9576) acc_u 3.1250 (4.3750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [15/20] time 0.341 (0.296) data 0.292 (0.247) loss_u loss_u 0.9297 (0.9546) acc_u 9.3750 (4.7917) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [20/20] time 0.326 (0.299) data 0.278 (0.250) loss_u loss_u 0.9214 (0.9516) acc_u 9.3750 (5.6250) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 458
confident_label rate tensor(0.1449, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 109
clean true:105
clean false:4
clean_rate:0.963302752293578
noisy true:189
noisy false:454
after delete: len(clean_dataset) 109
after delete: len(noisy_dataset) 643
epoch [4/200] batch [1/3] time 0.272 (0.272) data 0.224 (0.224) loss_x loss_x 1.1348 (1.1348) acc_x 65.6250 (65.6250) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [2/3] time 0.279 (0.275) data 0.230 (0.227) loss_x loss_x 0.6851 (0.9099) acc_x 84.3750 (75.0000) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [3/3] time 0.277 (0.276) data 0.230 (0.228) loss_x loss_x 0.9980 (0.9393) acc_x 65.6250 (71.8750) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/20] time 0.299 (0.295) data 0.250 (0.247) loss_u loss_u 0.9453 (0.9648) acc_u 9.3750 (4.3750) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/20] time 0.317 (0.296) data 0.268 (0.248) loss_u loss_u 0.9692 (0.9618) acc_u 6.2500 (5.0000) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/20] time 0.320 (0.297) data 0.272 (0.248) loss_u loss_u 0.9819 (0.9595) acc_u 0.0000 (5.0000) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [20/20] time 0.307 (0.297) data 0.258 (0.249) loss_u loss_u 0.9307 (0.9590) acc_u 9.3750 (5.1562) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 445
confident_label rate tensor(0.1383, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 104
clean true:101
clean false:3
clean_rate:0.9711538461538461
noisy true:206
noisy false:442
after delete: len(clean_dataset) 104
after delete: len(noisy_dataset) 648
epoch [5/200] batch [1/3] time 0.307 (0.307) data 0.259 (0.259) loss_x loss_x 0.9048 (0.9048) acc_x 75.0000 (75.0000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [2/3] time 0.297 (0.302) data 0.250 (0.254) loss_x loss_x 0.8350 (0.8699) acc_x 75.0000 (75.0000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [3/3] time 0.283 (0.296) data 0.235 (0.248) loss_x loss_x 0.7593 (0.8330) acc_x 84.3750 (78.1250) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/20] time 0.308 (0.293) data 0.260 (0.245) loss_u loss_u 0.9814 (0.9537) acc_u 0.0000 (5.0000) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/20] time 0.290 (0.298) data 0.241 (0.249) loss_u loss_u 0.9888 (0.9590) acc_u 0.0000 (4.6875) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [15/20] time 0.323 (0.300) data 0.275 (0.252) loss_u loss_u 0.9248 (0.9527) acc_u 9.3750 (5.4167) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/20] time 0.312 (0.300) data 0.263 (0.252) loss_u loss_u 0.9810 (0.9515) acc_u 0.0000 (6.4062) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 453
confident_label rate tensor(0.1543, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 116
clean true:111
clean false:5
clean_rate:0.9568965517241379
noisy true:188
noisy false:448
after delete: len(clean_dataset) 116
after delete: len(noisy_dataset) 636
epoch [6/200] batch [1/3] time 0.274 (0.274) data 0.227 (0.227) loss_x loss_x 0.9453 (0.9453) acc_x 71.8750 (71.8750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [2/3] time 0.309 (0.292) data 0.261 (0.244) loss_x loss_x 0.8564 (0.9009) acc_x 71.8750 (71.8750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [3/3] time 0.250 (0.278) data 0.202 (0.230) loss_x loss_x 1.0410 (0.9476) acc_x 71.8750 (71.8750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/19] time 0.273 (0.301) data 0.224 (0.253) loss_u loss_u 0.9717 (0.9612) acc_u 3.1250 (3.1250) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/19] time 0.316 (0.297) data 0.267 (0.248) loss_u loss_u 0.9385 (0.9559) acc_u 6.2500 (4.6875) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/19] time 0.299 (0.294) data 0.250 (0.246) loss_u loss_u 0.9478 (0.9523) acc_u 6.2500 (5.6250) lr 1.9980e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 434
confident_label rate tensor(0.1503, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 113
clean true:106
clean false:7
clean_rate:0.9380530973451328
noisy true:212
noisy false:427
after delete: len(clean_dataset) 113
after delete: len(noisy_dataset) 639
epoch [7/200] batch [1/3] time 0.340 (0.340) data 0.292 (0.292) loss_x loss_x 0.5420 (0.5420) acc_x 87.5000 (87.5000) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [2/3] time 0.269 (0.304) data 0.221 (0.257) loss_x loss_x 1.0527 (0.7974) acc_x 78.1250 (82.8125) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [3/3] time 0.266 (0.291) data 0.218 (0.244) loss_x loss_x 0.8896 (0.8281) acc_x 71.8750 (79.1667) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/19] time 0.322 (0.304) data 0.272 (0.256) loss_u loss_u 0.9619 (0.9593) acc_u 6.2500 (4.3750) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/19] time 0.323 (0.307) data 0.274 (0.258) loss_u loss_u 0.9756 (0.9462) acc_u 0.0000 (5.9375) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/19] time 0.276 (0.302) data 0.227 (0.254) loss_u loss_u 0.9326 (0.9460) acc_u 6.2500 (6.2500) lr 1.9969e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 445
confident_label rate tensor(0.1569, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 118
clean true:112
clean false:6
clean_rate:0.9491525423728814
noisy true:195
noisy false:439
after delete: len(clean_dataset) 118
after delete: len(noisy_dataset) 634
epoch [8/200] batch [1/3] time 0.302 (0.302) data 0.254 (0.254) loss_x loss_x 0.7520 (0.7520) acc_x 75.0000 (75.0000) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [2/3] time 0.289 (0.296) data 0.242 (0.248) loss_x loss_x 1.0762 (0.9141) acc_x 78.1250 (76.5625) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [3/3] time 0.306 (0.299) data 0.258 (0.251) loss_x loss_x 0.5459 (0.7913) acc_x 81.2500 (78.1250) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/19] time 0.298 (0.299) data 0.249 (0.251) loss_u loss_u 0.9541 (0.9413) acc_u 3.1250 (6.8750) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/19] time 0.287 (0.295) data 0.238 (0.247) loss_u loss_u 0.8936 (0.9448) acc_u 15.6250 (6.5625) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/19] time 0.308 (0.297) data 0.260 (0.248) loss_u loss_u 0.9639 (0.9354) acc_u 0.0000 (7.5000) lr 1.9956e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 429
confident_label rate tensor(0.1729, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 130
clean true:121
clean false:9
clean_rate:0.9307692307692308
noisy true:202
noisy false:420
after delete: len(clean_dataset) 130
after delete: len(noisy_dataset) 622
epoch [9/200] batch [1/4] time 0.318 (0.318) data 0.270 (0.270) loss_x loss_x 0.6235 (0.6235) acc_x 78.1250 (78.1250) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [2/4] time 0.268 (0.293) data 0.220 (0.245) loss_x loss_x 0.5703 (0.5969) acc_x 84.3750 (81.2500) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [3/4] time 0.316 (0.300) data 0.268 (0.253) loss_x loss_x 0.7358 (0.6432) acc_x 87.5000 (83.3333) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [4/4] time 0.335 (0.309) data 0.288 (0.261) loss_x loss_x 0.9854 (0.7288) acc_x 75.0000 (81.2500) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/19] time 0.332 (0.304) data 0.284 (0.256) loss_u loss_u 0.9629 (0.9434) acc_u 6.2500 (8.1250) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/19] time 0.296 (0.297) data 0.248 (0.249) loss_u loss_u 0.9185 (0.9440) acc_u 9.3750 (7.5000) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/19] time 0.292 (0.293) data 0.244 (0.245) loss_u loss_u 0.9185 (0.9459) acc_u 12.5000 (7.0833) lr 1.9940e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 428
confident_label rate tensor(0.1755, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 132
clean true:124
clean false:8
clean_rate:0.9393939393939394
noisy true:200
noisy false:420
after delete: len(clean_dataset) 132
after delete: len(noisy_dataset) 620
epoch [10/200] batch [1/4] time 0.301 (0.301) data 0.253 (0.253) loss_x loss_x 0.7339 (0.7339) acc_x 84.3750 (84.3750) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [2/4] time 0.286 (0.294) data 0.239 (0.246) loss_x loss_x 0.5898 (0.6619) acc_x 81.2500 (82.8125) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [3/4] time 0.271 (0.286) data 0.223 (0.238) loss_x loss_x 0.7031 (0.6756) acc_x 90.6250 (85.4167) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [4/4] time 0.318 (0.294) data 0.270 (0.246) loss_x loss_x 1.0439 (0.7677) acc_x 78.1250 (83.5938) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/19] time 0.264 (0.294) data 0.215 (0.246) loss_u loss_u 0.9326 (0.9442) acc_u 6.2500 (5.6250) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/19] time 0.289 (0.282) data 0.241 (0.233) loss_u loss_u 0.9404 (0.9483) acc_u 6.2500 (5.6250) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/19] time 0.310 (0.286) data 0.260 (0.238) loss_u loss_u 0.9492 (0.9463) acc_u 3.1250 (5.6250) lr 1.9921e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 434
confident_label rate tensor(0.1715, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 129
clean true:123
clean false:6
clean_rate:0.9534883720930233
noisy true:195
noisy false:428
after delete: len(clean_dataset) 129
after delete: len(noisy_dataset) 623
epoch [11/200] batch [1/4] time 0.370 (0.370) data 0.322 (0.322) loss_x loss_x 0.8594 (0.8594) acc_x 75.0000 (75.0000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [2/4] time 0.284 (0.327) data 0.236 (0.279) loss_x loss_x 0.5571 (0.7083) acc_x 78.1250 (76.5625) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [3/4] time 0.261 (0.305) data 0.213 (0.257) loss_x loss_x 0.4924 (0.6363) acc_x 87.5000 (80.2083) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [4/4] time 0.269 (0.296) data 0.221 (0.248) loss_x loss_x 0.8008 (0.6774) acc_x 75.0000 (78.9062) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/19] time 0.288 (0.293) data 0.240 (0.245) loss_u loss_u 0.9570 (0.9678) acc_u 3.1250 (3.7500) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/19] time 0.319 (0.289) data 0.271 (0.240) loss_u loss_u 0.8755 (0.9521) acc_u 12.5000 (5.3125) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/19] time 0.280 (0.290) data 0.231 (0.242) loss_u loss_u 0.9390 (0.9464) acc_u 6.2500 (5.6250) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 412
confident_label rate tensor(0.1769, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 133
clean true:123
clean false:10
clean_rate:0.924812030075188
noisy true:217
noisy false:402
after delete: len(clean_dataset) 133
after delete: len(noisy_dataset) 619
epoch [12/200] batch [1/4] time 0.314 (0.314) data 0.266 (0.266) loss_x loss_x 0.5396 (0.5396) acc_x 84.3750 (84.3750) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [2/4] time 0.284 (0.299) data 0.236 (0.251) loss_x loss_x 0.6177 (0.5786) acc_x 84.3750 (84.3750) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [3/4] time 0.277 (0.292) data 0.229 (0.244) loss_x loss_x 0.7974 (0.6515) acc_x 75.0000 (81.2500) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [4/4] time 0.286 (0.290) data 0.238 (0.242) loss_x loss_x 0.4299 (0.5961) acc_x 87.5000 (82.8125) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/19] time 0.286 (0.294) data 0.237 (0.246) loss_u loss_u 0.9751 (0.9522) acc_u 3.1250 (5.6250) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/19] time 0.282 (0.287) data 0.233 (0.238) loss_u loss_u 0.9609 (0.9493) acc_u 3.1250 (5.9375) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/19] time 0.354 (0.291) data 0.305 (0.242) loss_u loss_u 0.8486 (0.9453) acc_u 18.7500 (6.2500) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 399
confident_label rate tensor(0.1902, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 143
clean true:136
clean false:7
clean_rate:0.951048951048951
noisy true:217
noisy false:392
after delete: len(clean_dataset) 143
after delete: len(noisy_dataset) 609
epoch [13/200] batch [1/4] time 0.294 (0.294) data 0.246 (0.246) loss_x loss_x 0.4673 (0.4673) acc_x 93.7500 (93.7500) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [2/4] time 0.270 (0.282) data 0.221 (0.234) loss_x loss_x 0.7266 (0.5969) acc_x 71.8750 (82.8125) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [3/4] time 0.313 (0.292) data 0.265 (0.244) loss_x loss_x 0.4956 (0.5632) acc_x 87.5000 (84.3750) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [4/4] time 0.276 (0.288) data 0.228 (0.240) loss_x loss_x 0.6211 (0.5776) acc_x 84.3750 (84.3750) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/19] time 0.294 (0.298) data 0.245 (0.249) loss_u loss_u 0.9468 (0.9560) acc_u 6.2500 (5.0000) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/19] time 0.295 (0.299) data 0.246 (0.250) loss_u loss_u 0.9678 (0.9401) acc_u 3.1250 (6.5625) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/19] time 0.299 (0.298) data 0.250 (0.249) loss_u loss_u 0.9458 (0.9416) acc_u 6.2500 (6.4583) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 395
confident_label rate tensor(0.2008, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 151
clean true:146
clean false:5
clean_rate:0.9668874172185431
noisy true:211
noisy false:390
after delete: len(clean_dataset) 151
after delete: len(noisy_dataset) 601
epoch [14/200] batch [1/4] time 0.321 (0.321) data 0.273 (0.273) loss_x loss_x 0.4202 (0.4202) acc_x 84.3750 (84.3750) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [2/4] time 0.303 (0.312) data 0.256 (0.264) loss_x loss_x 0.4307 (0.4254) acc_x 84.3750 (84.3750) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [3/4] time 0.270 (0.298) data 0.222 (0.250) loss_x loss_x 0.7217 (0.5242) acc_x 81.2500 (83.3333) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [4/4] time 0.247 (0.286) data 0.200 (0.238) loss_x loss_x 0.4917 (0.5161) acc_x 84.3750 (83.5938) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/18] time 0.302 (0.290) data 0.254 (0.242) loss_u loss_u 0.9365 (0.9719) acc_u 6.2500 (3.1250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/18] time 0.347 (0.298) data 0.298 (0.250) loss_u loss_u 0.9507 (0.9604) acc_u 6.2500 (4.6875) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/18] time 0.275 (0.294) data 0.227 (0.245) loss_u loss_u 0.9424 (0.9523) acc_u 9.3750 (5.8333) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 415
confident_label rate tensor(0.2008, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 151
clean true:142
clean false:9
clean_rate:0.9403973509933775
noisy true:195
noisy false:406
after delete: len(clean_dataset) 151
after delete: len(noisy_dataset) 601
epoch [15/200] batch [1/4] time 0.288 (0.288) data 0.240 (0.240) loss_x loss_x 0.5190 (0.5190) acc_x 84.3750 (84.3750) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [2/4] time 0.294 (0.291) data 0.246 (0.243) loss_x loss_x 0.6079 (0.5635) acc_x 90.6250 (87.5000) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [3/4] time 0.311 (0.297) data 0.263 (0.249) loss_x loss_x 0.4617 (0.5295) acc_x 90.6250 (88.5417) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [4/4] time 0.303 (0.299) data 0.255 (0.251) loss_x loss_x 0.5840 (0.5432) acc_x 87.5000 (88.2812) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/18] time 0.279 (0.292) data 0.230 (0.244) loss_u loss_u 0.9224 (0.9355) acc_u 6.2500 (6.8750) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/18] time 0.303 (0.289) data 0.254 (0.240) loss_u loss_u 0.9619 (0.9477) acc_u 3.1250 (5.0000) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/18] time 0.341 (0.291) data 0.292 (0.243) loss_u loss_u 0.9717 (0.9448) acc_u 0.0000 (5.6250) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 388
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 164
clean true:151
clean false:13
clean_rate:0.9207317073170732
noisy true:213
noisy false:375
after delete: len(clean_dataset) 164
after delete: len(noisy_dataset) 588
epoch [16/200] batch [5/5] time 0.265 (0.300) data 0.217 (0.252) loss_x loss_x 0.9932 (0.5957) acc_x 68.7500 (80.6250) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/18] time 0.288 (0.302) data 0.240 (0.253) loss_u loss_u 0.9790 (0.9594) acc_u 3.1250 (3.7500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/18] time 0.299 (0.296) data 0.251 (0.248) loss_u loss_u 0.9746 (0.9552) acc_u 0.0000 (3.7500) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/18] time 0.299 (0.298) data 0.251 (0.249) loss_u loss_u 0.9800 (0.9608) acc_u 3.1250 (3.3333) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 383
confident_label rate tensor(0.2154, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 162
clean true:150
clean false:12
clean_rate:0.9259259259259259
noisy true:219
noisy false:371
after delete: len(clean_dataset) 162
after delete: len(noisy_dataset) 590
epoch [17/200] batch [5/5] time 0.300 (0.289) data 0.252 (0.241) loss_x loss_x 0.8882 (0.7261) acc_x 81.2500 (84.3750) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/18] time 0.266 (0.284) data 0.216 (0.236) loss_u loss_u 0.9551 (0.9457) acc_u 3.1250 (6.2500) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/18] time 0.294 (0.291) data 0.245 (0.243) loss_u loss_u 0.9653 (0.9351) acc_u 3.1250 (7.8125) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/18] time 0.280 (0.291) data 0.232 (0.243) loss_u loss_u 0.9805 (0.9391) acc_u 3.1250 (7.5000) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.2234, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 168
clean true:159
clean false:9
clean_rate:0.9464285714285714
noisy true:219
noisy false:365
after delete: len(clean_dataset) 168
after delete: len(noisy_dataset) 584
epoch [18/200] batch [5/5] time 0.282 (0.298) data 0.235 (0.251) loss_x loss_x 0.7217 (0.6799) acc_x 87.5000 (86.2500) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/18] time 0.278 (0.293) data 0.230 (0.245) loss_u loss_u 0.9551 (0.9577) acc_u 9.3750 (5.6250) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/18] time 0.299 (0.298) data 0.250 (0.250) loss_u loss_u 0.9414 (0.9477) acc_u 6.2500 (5.9375) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/18] time 0.294 (0.295) data 0.246 (0.247) loss_u loss_u 0.9048 (0.9440) acc_u 12.5000 (6.6667) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 400
confident_label rate tensor(0.2114, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 159
clean true:146
clean false:13
clean_rate:0.9182389937106918
noisy true:206
noisy false:387
after delete: len(clean_dataset) 159
after delete: len(noisy_dataset) 593
epoch [19/200] batch [1/4] time 0.313 (0.313) data 0.265 (0.265) loss_x loss_x 0.8774 (0.8774) acc_x 81.2500 (81.2500) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [2/4] time 0.227 (0.270) data 0.179 (0.222) loss_x loss_x 0.3843 (0.6309) acc_x 96.8750 (89.0625) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [3/4] time 0.250 (0.263) data 0.202 (0.215) loss_x loss_x 0.6245 (0.6287) acc_x 84.3750 (87.5000) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [4/4] time 0.284 (0.269) data 0.237 (0.221) loss_x loss_x 0.4753 (0.5904) acc_x 93.7500 (89.0625) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/18] time 0.287 (0.279) data 0.239 (0.230) loss_u loss_u 0.9604 (0.9502) acc_u 6.2500 (6.2500) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/18] time 0.281 (0.286) data 0.233 (0.238) loss_u loss_u 0.9502 (0.9455) acc_u 3.1250 (5.9375) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/18] time 0.295 (0.285) data 0.247 (0.236) loss_u loss_u 0.9600 (0.9513) acc_u 3.1250 (5.2083) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2247, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 169
clean true:157
clean false:12
clean_rate:0.9289940828402367
noisy true:230
noisy false:353
after delete: len(clean_dataset) 169
after delete: len(noisy_dataset) 583
epoch [20/200] batch [5/5] time 0.297 (0.283) data 0.249 (0.235) loss_x loss_x 0.6357 (0.5107) acc_x 81.2500 (86.8750) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/18] time 0.294 (0.291) data 0.246 (0.243) loss_u loss_u 0.9331 (0.9538) acc_u 6.2500 (5.0000) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/18] time 0.301 (0.292) data 0.253 (0.244) loss_u loss_u 0.9570 (0.9576) acc_u 3.1250 (5.0000) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/18] time 0.295 (0.288) data 0.246 (0.240) loss_u loss_u 0.9502 (0.9593) acc_u 6.2500 (4.5833) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 352
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 174
clean true:160
clean false:14
clean_rate:0.9195402298850575
noisy true:240
noisy false:338
after delete: len(clean_dataset) 174
after delete: len(noisy_dataset) 578
epoch [21/200] batch [5/5] time 0.275 (0.289) data 0.228 (0.242) loss_x loss_x 0.5586 (0.5178) acc_x 81.2500 (85.0000) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/18] time 0.269 (0.293) data 0.221 (0.245) loss_u loss_u 0.9375 (0.9302) acc_u 6.2500 (8.1250) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/18] time 0.289 (0.296) data 0.241 (0.248) loss_u loss_u 0.9609 (0.9416) acc_u 3.1250 (6.8750) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/18] time 0.327 (0.295) data 0.278 (0.246) loss_u loss_u 0.9741 (0.9537) acc_u 3.1250 (5.4167) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 383
confident_label rate tensor(0.2154, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 162
clean true:151
clean false:11
clean_rate:0.9320987654320988
noisy true:218
noisy false:372
after delete: len(clean_dataset) 162
after delete: len(noisy_dataset) 590
epoch [22/200] batch [5/5] time 0.310 (0.290) data 0.262 (0.242) loss_x loss_x 0.5435 (0.4568) acc_x 90.6250 (90.6250) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/18] time 0.288 (0.288) data 0.239 (0.240) loss_u loss_u 0.9351 (0.9616) acc_u 6.2500 (3.7500) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/18] time 0.268 (0.293) data 0.220 (0.245) loss_u loss_u 0.9629 (0.9417) acc_u 3.1250 (6.2500) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/18] time 0.305 (0.297) data 0.257 (0.248) loss_u loss_u 0.9277 (0.9442) acc_u 6.2500 (5.6250) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2367, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 178
clean true:165
clean false:13
clean_rate:0.9269662921348315
noisy true:221
noisy false:353
after delete: len(clean_dataset) 178
after delete: len(noisy_dataset) 574
epoch [23/200] batch [5/5] time 0.296 (0.289) data 0.248 (0.241) loss_x loss_x 0.4172 (0.4533) acc_x 87.5000 (89.3750) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/17] time 0.307 (0.287) data 0.259 (0.239) loss_u loss_u 0.9233 (0.9400) acc_u 9.3750 (6.8750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/17] time 0.290 (0.287) data 0.242 (0.239) loss_u loss_u 0.9790 (0.9460) acc_u 0.0000 (5.9375) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/17] time 0.296 (0.290) data 0.248 (0.242) loss_u loss_u 0.9521 (0.9427) acc_u 6.2500 (6.0417) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2301, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 173
clean true:164
clean false:9
clean_rate:0.9479768786127167
noisy true:221
noisy false:358
after delete: len(clean_dataset) 173
after delete: len(noisy_dataset) 579
epoch [24/200] batch [5/5] time 0.261 (0.293) data 0.213 (0.245) loss_x loss_x 0.5488 (0.4510) acc_x 93.7500 (90.0000) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/18] time 0.269 (0.293) data 0.221 (0.245) loss_u loss_u 0.8989 (0.9361) acc_u 15.6250 (10.0000) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/18] time 0.279 (0.295) data 0.230 (0.246) loss_u loss_u 0.9473 (0.9424) acc_u 6.2500 (7.8125) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/18] time 0.304 (0.293) data 0.255 (0.244) loss_u loss_u 0.9531 (0.9416) acc_u 6.2500 (7.0833) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 337
confident_label rate tensor(0.2646, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 199
clean true:187
clean false:12
clean_rate:0.9396984924623115
noisy true:228
noisy false:325
after delete: len(clean_dataset) 199
after delete: len(noisy_dataset) 553
epoch [25/200] batch [5/6] time 0.345 (0.293) data 0.297 (0.244) loss_x loss_x 0.8076 (0.6216) acc_x 87.5000 (83.7500) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/17] time 0.269 (0.292) data 0.221 (0.243) loss_u loss_u 0.9897 (0.9790) acc_u 0.0000 (1.8750) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/17] time 0.300 (0.293) data 0.251 (0.245) loss_u loss_u 0.8804 (0.9684) acc_u 15.6250 (3.4375) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/17] time 0.353 (0.295) data 0.304 (0.247) loss_u loss_u 0.9678 (0.9636) acc_u 6.2500 (4.1667) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 347
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:170
clean false:13
clean_rate:0.9289617486338798
noisy true:235
noisy false:334
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [26/200] batch [5/5] time 0.246 (0.253) data 0.198 (0.205) loss_x loss_x 0.2822 (0.5384) acc_x 96.8750 (90.6250) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/17] time 0.328 (0.278) data 0.280 (0.230) loss_u loss_u 0.9810 (0.9193) acc_u 3.1250 (9.3750) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [10/17] time 0.281 (0.285) data 0.232 (0.237) loss_u loss_u 0.9619 (0.9310) acc_u 6.2500 (8.7500) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/17] time 0.290 (0.288) data 0.241 (0.239) loss_u loss_u 0.9253 (0.9469) acc_u 9.3750 (6.4583) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 359
confident_label rate tensor(0.2527, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 190
clean true:177
clean false:13
clean_rate:0.9315789473684211
noisy true:216
noisy false:346
after delete: len(clean_dataset) 190
after delete: len(noisy_dataset) 562
epoch [27/200] batch [5/5] time 0.303 (0.296) data 0.255 (0.248) loss_x loss_x 0.5811 (0.6336) acc_x 84.3750 (85.0000) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/17] time 0.285 (0.284) data 0.237 (0.236) loss_u loss_u 0.9727 (0.9600) acc_u 3.1250 (4.3750) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/17] time 0.281 (0.285) data 0.233 (0.236) loss_u loss_u 0.9492 (0.9548) acc_u 3.1250 (4.6875) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/17] time 0.290 (0.290) data 0.242 (0.242) loss_u loss_u 0.9658 (0.9524) acc_u 3.1250 (5.0000) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 349
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:172
clean false:12
clean_rate:0.9347826086956522
noisy true:231
noisy false:337
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [28/200] batch [5/5] time 0.287 (0.294) data 0.238 (0.246) loss_x loss_x 0.6821 (0.4494) acc_x 78.1250 (89.3750) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/17] time 0.320 (0.298) data 0.271 (0.250) loss_u loss_u 0.9917 (0.9423) acc_u 0.0000 (6.2500) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [10/17] time 0.306 (0.303) data 0.258 (0.255) loss_u loss_u 0.9663 (0.9455) acc_u 3.1250 (5.3125) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/17] time 0.289 (0.298) data 0.241 (0.250) loss_u loss_u 0.9834 (0.9484) acc_u 3.1250 (5.2083) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 336
confident_label rate tensor(0.2553, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 192
clean true:179
clean false:13
clean_rate:0.9322916666666666
noisy true:237
noisy false:323
after delete: len(clean_dataset) 192
after delete: len(noisy_dataset) 560
epoch [29/200] batch [5/6] time 0.320 (0.302) data 0.272 (0.254) loss_x loss_x 0.2355 (0.4919) acc_x 93.7500 (89.3750) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/17] time 0.303 (0.294) data 0.255 (0.246) loss_u loss_u 0.9321 (0.9618) acc_u 9.3750 (4.3750) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/17] time 0.296 (0.298) data 0.248 (0.250) loss_u loss_u 0.9585 (0.9593) acc_u 3.1250 (4.6875) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/17] time 0.275 (0.297) data 0.225 (0.248) loss_u loss_u 0.9521 (0.9542) acc_u 6.2500 (5.6250) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 345
confident_label rate tensor(0.2593, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 195
clean true:180
clean false:15
clean_rate:0.9230769230769231
noisy true:227
noisy false:330
after delete: len(clean_dataset) 195
after delete: len(noisy_dataset) 557
epoch [30/200] batch [5/6] time 0.276 (0.295) data 0.227 (0.247) loss_x loss_x 0.5620 (0.4330) acc_x 90.6250 (91.2500) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/17] time 0.302 (0.289) data 0.254 (0.241) loss_u loss_u 0.9590 (0.9645) acc_u 3.1250 (3.1250) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/17] time 0.316 (0.296) data 0.266 (0.247) loss_u loss_u 0.8862 (0.9517) acc_u 12.5000 (5.3125) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/17] time 0.269 (0.295) data 0.221 (0.246) loss_u loss_u 0.9121 (0.9517) acc_u 9.3750 (5.4167) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 352
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 194
clean true:181
clean false:13
clean_rate:0.9329896907216495
noisy true:219
noisy false:339
after delete: len(clean_dataset) 194
after delete: len(noisy_dataset) 558
epoch [31/200] batch [5/6] time 0.328 (0.300) data 0.279 (0.252) loss_x loss_x 0.3169 (0.4395) acc_x 93.7500 (89.3750) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/17] time 0.307 (0.293) data 0.259 (0.245) loss_u loss_u 0.9883 (0.9580) acc_u 0.0000 (4.3750) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/17] time 0.288 (0.296) data 0.240 (0.248) loss_u loss_u 0.9546 (0.9476) acc_u 6.2500 (6.2500) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/17] time 0.308 (0.298) data 0.259 (0.250) loss_u loss_u 0.9062 (0.9414) acc_u 9.3750 (6.6667) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 331
confident_label rate tensor(0.2726, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 205
clean true:189
clean false:16
clean_rate:0.9219512195121952
noisy true:232
noisy false:315
after delete: len(clean_dataset) 205
after delete: len(noisy_dataset) 547
epoch [32/200] batch [5/6] time 0.266 (0.299) data 0.214 (0.250) loss_x loss_x 0.4460 (0.3758) acc_x 93.7500 (91.2500) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/17] time 0.315 (0.290) data 0.267 (0.242) loss_u loss_u 0.9419 (0.9571) acc_u 3.1250 (3.1250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/17] time 0.299 (0.292) data 0.251 (0.244) loss_u loss_u 0.9902 (0.9674) acc_u 0.0000 (2.5000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/17] time 0.304 (0.295) data 0.256 (0.247) loss_u loss_u 0.9463 (0.9651) acc_u 6.2500 (3.1250) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 324
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 215
clean true:202
clean false:13
clean_rate:0.9395348837209302
noisy true:226
noisy false:311
after delete: len(clean_dataset) 215
after delete: len(noisy_dataset) 537
epoch [33/200] batch [5/6] time 0.309 (0.301) data 0.261 (0.253) loss_x loss_x 0.7441 (0.5018) acc_x 81.2500 (89.3750) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/16] time 0.297 (0.300) data 0.249 (0.250) loss_u loss_u 0.9785 (0.9623) acc_u 0.0000 (4.3750) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/16] time 0.286 (0.300) data 0.238 (0.251) loss_u loss_u 0.9712 (0.9640) acc_u 3.1250 (3.7500) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/16] time 0.338 (0.301) data 0.289 (0.253) loss_u loss_u 0.9551 (0.9628) acc_u 3.1250 (3.7500) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 326
confident_label rate tensor(0.2660, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 200
clean true:183
clean false:17
clean_rate:0.915
noisy true:243
noisy false:309
after delete: len(clean_dataset) 200
after delete: len(noisy_dataset) 552
epoch [34/200] batch [5/6] time 0.305 (0.305) data 0.257 (0.257) loss_x loss_x 0.3845 (0.4683) acc_x 90.6250 (87.5000) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/17] time 0.288 (0.295) data 0.240 (0.247) loss_u loss_u 0.9648 (0.9500) acc_u 3.1250 (5.0000) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/17] time 0.294 (0.292) data 0.246 (0.244) loss_u loss_u 0.9902 (0.9546) acc_u 0.0000 (5.0000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/17] time 0.289 (0.293) data 0.241 (0.245) loss_u loss_u 0.9297 (0.9486) acc_u 9.3750 (5.8333) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 328
confident_label rate tensor(0.2646, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 199
clean true:188
clean false:11
clean_rate:0.9447236180904522
noisy true:236
noisy false:317
after delete: len(clean_dataset) 199
after delete: len(noisy_dataset) 553
epoch [35/200] batch [5/6] time 0.307 (0.298) data 0.259 (0.250) loss_x loss_x 0.5864 (0.4224) acc_x 84.3750 (89.3750) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/17] time 0.298 (0.291) data 0.250 (0.242) loss_u loss_u 0.9502 (0.9561) acc_u 3.1250 (4.3750) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/17] time 0.313 (0.292) data 0.265 (0.243) loss_u loss_u 0.9697 (0.9464) acc_u 0.0000 (6.2500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/17] time 0.291 (0.293) data 0.243 (0.245) loss_u loss_u 0.9268 (0.9459) acc_u 12.5000 (6.4583) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.2660, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 200
clean true:188
clean false:12
clean_rate:0.94
noisy true:234
noisy false:318
after delete: len(clean_dataset) 200
after delete: len(noisy_dataset) 552
epoch [36/200] batch [5/6] time 0.322 (0.304) data 0.273 (0.256) loss_x loss_x 0.5229 (0.4037) acc_x 87.5000 (91.2500) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/17] time 0.304 (0.294) data 0.255 (0.246) loss_u loss_u 0.9463 (0.9422) acc_u 9.3750 (7.5000) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/17] time 0.284 (0.292) data 0.235 (0.244) loss_u loss_u 0.9326 (0.9398) acc_u 9.3750 (7.5000) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/17] time 0.287 (0.290) data 0.239 (0.241) loss_u loss_u 0.9399 (0.9410) acc_u 6.2500 (6.8750) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 314
confident_label rate tensor(0.2779, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 209
clean true:194
clean false:15
clean_rate:0.9282296650717703
noisy true:244
noisy false:299
after delete: len(clean_dataset) 209
after delete: len(noisy_dataset) 543
epoch [37/200] batch [5/6] time 0.275 (0.303) data 0.226 (0.255) loss_x loss_x 0.4927 (0.4841) acc_x 87.5000 (87.5000) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/16] time 0.310 (0.283) data 0.262 (0.234) loss_u loss_u 0.9399 (0.9585) acc_u 6.2500 (4.3750) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/16] time 0.318 (0.287) data 0.269 (0.239) loss_u loss_u 0.9009 (0.9414) acc_u 9.3750 (6.2500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/16] time 0.311 (0.293) data 0.262 (0.244) loss_u loss_u 0.9922 (0.9485) acc_u 3.1250 (6.0417) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 322
confident_label rate tensor(0.2793, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 210
clean true:198
clean false:12
clean_rate:0.9428571428571428
noisy true:232
noisy false:310
after delete: len(clean_dataset) 210
after delete: len(noisy_dataset) 542
epoch [38/200] batch [5/6] time 0.281 (0.296) data 0.234 (0.248) loss_x loss_x 0.3955 (0.4254) acc_x 87.5000 (88.1250) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/16] time 0.321 (0.293) data 0.273 (0.244) loss_u loss_u 0.9395 (0.9342) acc_u 9.3750 (8.1250) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/16] time 0.280 (0.293) data 0.231 (0.244) loss_u loss_u 0.9766 (0.9481) acc_u 6.2500 (6.5625) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/16] time 0.315 (0.295) data 0.267 (0.247) loss_u loss_u 0.9580 (0.9476) acc_u 6.2500 (6.4583) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 333
confident_label rate tensor(0.2566, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 193
clean true:177
clean false:16
clean_rate:0.917098445595855
noisy true:242
noisy false:317
after delete: len(clean_dataset) 193
after delete: len(noisy_dataset) 559
epoch [39/200] batch [5/6] time 0.280 (0.297) data 0.232 (0.249) loss_x loss_x 0.3689 (0.4000) acc_x 93.7500 (91.2500) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/17] time 0.270 (0.287) data 0.222 (0.238) loss_u loss_u 0.9375 (0.9449) acc_u 6.2500 (6.2500) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/17] time 0.345 (0.296) data 0.296 (0.247) loss_u loss_u 0.9033 (0.9343) acc_u 12.5000 (7.8125) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/17] time 0.275 (0.298) data 0.227 (0.249) loss_u loss_u 0.9639 (0.9386) acc_u 3.1250 (6.6667) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 347
confident_label rate tensor(0.2793, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 210
clean true:188
clean false:22
clean_rate:0.8952380952380953
noisy true:217
noisy false:325
after delete: len(clean_dataset) 210
after delete: len(noisy_dataset) 542
epoch [40/200] batch [5/6] time 0.288 (0.282) data 0.237 (0.233) loss_x loss_x 0.3752 (0.6051) acc_x 87.5000 (85.0000) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/16] time 0.269 (0.288) data 0.221 (0.239) loss_u loss_u 0.9575 (0.9392) acc_u 3.1250 (6.2500) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/16] time 0.312 (0.293) data 0.263 (0.244) loss_u loss_u 0.9053 (0.9431) acc_u 9.3750 (6.2500) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/16] time 0.292 (0.293) data 0.244 (0.244) loss_u loss_u 0.9648 (0.9459) acc_u 3.1250 (6.0417) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 341
confident_label rate tensor(0.2633, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 198
clean true:184
clean false:14
clean_rate:0.9292929292929293
noisy true:227
noisy false:327
after delete: len(clean_dataset) 198
after delete: len(noisy_dataset) 554
epoch [41/200] batch [5/6] time 0.310 (0.294) data 0.263 (0.247) loss_x loss_x 0.4641 (0.4146) acc_x 84.3750 (90.6250) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/17] time 0.280 (0.293) data 0.232 (0.245) loss_u loss_u 0.9473 (0.9384) acc_u 6.2500 (7.5000) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/17] time 0.336 (0.292) data 0.288 (0.244) loss_u loss_u 0.9121 (0.9408) acc_u 9.3750 (6.5625) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/17] time 0.318 (0.293) data 0.270 (0.245) loss_u loss_u 0.8735 (0.9357) acc_u 12.5000 (7.0833) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 316
confident_label rate tensor(0.2992, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 225
clean true:203
clean false:22
clean_rate:0.9022222222222223
noisy true:233
noisy false:294
after delete: len(clean_dataset) 225
after delete: len(noisy_dataset) 527
epoch [42/200] batch [5/7] time 0.273 (0.312) data 0.225 (0.264) loss_x loss_x 0.5562 (0.4379) acc_x 84.3750 (88.7500) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/16] time 0.297 (0.294) data 0.249 (0.246) loss_u loss_u 0.9326 (0.9547) acc_u 6.2500 (4.3750) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/16] time 0.307 (0.299) data 0.258 (0.251) loss_u loss_u 0.9912 (0.9542) acc_u 0.0000 (5.0000) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/16] time 0.281 (0.300) data 0.233 (0.252) loss_u loss_u 0.9971 (0.9608) acc_u 0.0000 (4.3750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 331
confident_label rate tensor(0.2912, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 219
clean true:202
clean false:17
clean_rate:0.9223744292237442
noisy true:219
noisy false:314
after delete: len(clean_dataset) 219
after delete: len(noisy_dataset) 533
epoch [43/200] batch [5/6] time 0.297 (0.304) data 0.248 (0.256) loss_x loss_x 0.4253 (0.5034) acc_x 84.3750 (87.5000) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/16] time 0.321 (0.289) data 0.273 (0.241) loss_u loss_u 0.9590 (0.9625) acc_u 3.1250 (3.7500) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/16] time 0.280 (0.290) data 0.232 (0.241) loss_u loss_u 0.9248 (0.9540) acc_u 9.3750 (4.3750) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/16] time 0.311 (0.294) data 0.262 (0.245) loss_u loss_u 0.9863 (0.9568) acc_u 0.0000 (4.1667) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 304
confident_label rate tensor(0.2952, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 222
clean true:207
clean false:15
clean_rate:0.9324324324324325
noisy true:241
noisy false:289
after delete: len(clean_dataset) 222
after delete: len(noisy_dataset) 530
epoch [44/200] batch [5/6] time 0.332 (0.302) data 0.283 (0.254) loss_x loss_x 0.5850 (0.3387) acc_x 75.0000 (88.7500) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/16] time 0.272 (0.297) data 0.223 (0.248) loss_u loss_u 0.9814 (0.9435) acc_u 0.0000 (5.6250) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/16] time 0.299 (0.297) data 0.249 (0.249) loss_u loss_u 0.9531 (0.9577) acc_u 3.1250 (4.0625) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/16] time 0.294 (0.297) data 0.245 (0.249) loss_u loss_u 0.8911 (0.9561) acc_u 12.5000 (4.5833) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 306
confident_label rate tensor(0.2926, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 220
clean true:200
clean false:20
clean_rate:0.9090909090909091
noisy true:246
noisy false:286
after delete: len(clean_dataset) 220
after delete: len(noisy_dataset) 532
epoch [45/200] batch [5/6] time 0.336 (0.294) data 0.288 (0.246) loss_x loss_x 0.4333 (0.3579) acc_x 93.7500 (92.5000) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/16] time 0.290 (0.296) data 0.242 (0.248) loss_u loss_u 0.9961 (0.9725) acc_u 0.0000 (2.5000) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/16] time 0.264 (0.299) data 0.216 (0.251) loss_u loss_u 0.9951 (0.9470) acc_u 0.0000 (5.9375) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/16] time 0.287 (0.297) data 0.239 (0.249) loss_u loss_u 0.9663 (0.9433) acc_u 3.1250 (6.4583) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 298
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 229
clean true:212
clean false:17
clean_rate:0.925764192139738
noisy true:242
noisy false:281
after delete: len(clean_dataset) 229
after delete: len(noisy_dataset) 523
epoch [46/200] batch [5/7] time 0.348 (0.301) data 0.300 (0.253) loss_x loss_x 0.4194 (0.4651) acc_x 87.5000 (91.2500) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/16] time 0.324 (0.300) data 0.276 (0.252) loss_u loss_u 0.9639 (0.9653) acc_u 3.1250 (3.1250) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/16] time 0.291 (0.300) data 0.243 (0.252) loss_u loss_u 0.9272 (0.9636) acc_u 6.2500 (3.4375) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/16] time 0.285 (0.298) data 0.237 (0.250) loss_u loss_u 0.9858 (0.9638) acc_u 0.0000 (3.5417) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 308
confident_label rate tensor(0.2899, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 218
clean true:202
clean false:16
clean_rate:0.926605504587156
noisy true:242
noisy false:292
after delete: len(clean_dataset) 218
after delete: len(noisy_dataset) 534
epoch [47/200] batch [5/6] time 0.291 (0.293) data 0.243 (0.245) loss_x loss_x 0.6636 (0.4606) acc_x 75.0000 (87.5000) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/16] time 0.330 (0.293) data 0.282 (0.245) loss_u loss_u 0.9048 (0.9464) acc_u 9.3750 (6.2500) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/16] time 0.304 (0.292) data 0.255 (0.244) loss_u loss_u 0.9761 (0.9542) acc_u 3.1250 (5.3125) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/16] time 0.273 (0.293) data 0.225 (0.245) loss_u loss_u 0.9224 (0.9510) acc_u 9.3750 (5.4167) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 304
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 229
clean true:206
clean false:23
clean_rate:0.8995633187772926
noisy true:242
noisy false:281
after delete: len(clean_dataset) 229
after delete: len(noisy_dataset) 523
epoch [48/200] batch [5/7] time 0.300 (0.296) data 0.249 (0.247) loss_x loss_x 0.3833 (0.4011) acc_x 87.5000 (90.6250) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/16] time 0.317 (0.295) data 0.269 (0.246) loss_u loss_u 0.9360 (0.9499) acc_u 9.3750 (6.2500) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/16] time 0.310 (0.291) data 0.262 (0.243) loss_u loss_u 0.9932 (0.9579) acc_u 0.0000 (5.3125) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/16] time 0.288 (0.294) data 0.239 (0.246) loss_u loss_u 0.9561 (0.9555) acc_u 6.2500 (5.4167) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 317
confident_label rate tensor(0.2965, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 223
clean true:200
clean false:23
clean_rate:0.8968609865470852
noisy true:235
noisy false:294
after delete: len(clean_dataset) 223
after delete: len(noisy_dataset) 529
epoch [49/200] batch [5/6] time 0.326 (0.304) data 0.277 (0.256) loss_x loss_x 0.2218 (0.4312) acc_x 96.8750 (89.3750) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/16] time 0.305 (0.300) data 0.256 (0.252) loss_u loss_u 0.9404 (0.9290) acc_u 6.2500 (8.1250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/16] time 0.314 (0.298) data 0.266 (0.249) loss_u loss_u 0.9189 (0.9306) acc_u 9.3750 (7.1875) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/16] time 0.291 (0.296) data 0.243 (0.247) loss_u loss_u 0.9717 (0.9453) acc_u 3.1250 (5.4167) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 306
confident_label rate tensor(0.3019, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 227
clean true:205
clean false:22
clean_rate:0.9030837004405287
noisy true:241
noisy false:284
after delete: len(clean_dataset) 227
after delete: len(noisy_dataset) 525
epoch [50/200] batch [5/7] time 0.293 (0.288) data 0.243 (0.240) loss_x loss_x 0.2959 (0.3054) acc_x 90.6250 (91.8750) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/16] time 0.271 (0.289) data 0.222 (0.241) loss_u loss_u 0.9658 (0.9649) acc_u 3.1250 (3.7500) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/16] time 0.296 (0.293) data 0.248 (0.245) loss_u loss_u 0.9990 (0.9716) acc_u 0.0000 (2.8125) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/16] time 0.285 (0.291) data 0.237 (0.243) loss_u loss_u 0.8291 (0.9587) acc_u 18.7500 (4.3750) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 312
confident_label rate tensor(0.3152, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 237
clean true:212
clean false:25
clean_rate:0.8945147679324894
noisy true:228
noisy false:287
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 515
epoch [51/200] batch [5/7] time 0.292 (0.285) data 0.244 (0.237) loss_x loss_x 0.3381 (0.3521) acc_x 96.8750 (91.2500) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/16] time 0.286 (0.285) data 0.236 (0.236) loss_u loss_u 0.9766 (0.9844) acc_u 3.1250 (2.5000) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/16] time 0.321 (0.289) data 0.272 (0.241) loss_u loss_u 0.9941 (0.9760) acc_u 0.0000 (3.1250) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/16] time 0.292 (0.291) data 0.244 (0.242) loss_u loss_u 0.9297 (0.9662) acc_u 6.2500 (3.7500) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 315
confident_label rate tensor(0.3085, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 232
clean true:205
clean false:27
clean_rate:0.8836206896551724
noisy true:232
noisy false:288
after delete: len(clean_dataset) 232
after delete: len(noisy_dataset) 520
epoch [52/200] batch [5/7] time 0.282 (0.307) data 0.235 (0.260) loss_x loss_x 0.3696 (0.3579) acc_x 96.8750 (91.2500) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/16] time 0.291 (0.295) data 0.242 (0.247) loss_u loss_u 0.9106 (0.9486) acc_u 12.5000 (5.6250) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/16] time 0.283 (0.293) data 0.234 (0.244) loss_u loss_u 0.9302 (0.9442) acc_u 9.3750 (6.2500) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/16] time 0.282 (0.292) data 0.233 (0.244) loss_u loss_u 0.9932 (0.9541) acc_u 0.0000 (5.2083) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 322
confident_label rate tensor(0.2965, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 223
clean true:197
clean false:26
clean_rate:0.8834080717488789
noisy true:233
noisy false:296
after delete: len(clean_dataset) 223
after delete: len(noisy_dataset) 529
epoch [53/200] batch [5/6] time 0.298 (0.299) data 0.251 (0.251) loss_x loss_x 0.2559 (0.3423) acc_x 96.8750 (93.1250) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/16] time 0.275 (0.291) data 0.227 (0.242) loss_u loss_u 0.9453 (0.9402) acc_u 6.2500 (7.5000) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/16] time 0.272 (0.286) data 0.224 (0.237) loss_u loss_u 0.9844 (0.9417) acc_u 0.0000 (6.8750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/16] time 0.277 (0.289) data 0.229 (0.240) loss_u loss_u 0.9272 (0.9403) acc_u 9.3750 (7.0833) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 320
confident_label rate tensor(0.2912, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 219
clean true:194
clean false:25
clean_rate:0.8858447488584474
noisy true:238
noisy false:295
after delete: len(clean_dataset) 219
after delete: len(noisy_dataset) 533
epoch [54/200] batch [5/6] time 0.319 (0.314) data 0.271 (0.266) loss_x loss_x 0.2522 (0.2567) acc_x 90.6250 (93.1250) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/16] time 0.286 (0.295) data 0.238 (0.247) loss_u loss_u 0.9741 (0.9362) acc_u 3.1250 (6.8750) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/16] time 0.257 (0.291) data 0.208 (0.242) loss_u loss_u 0.9727 (0.9306) acc_u 3.1250 (7.8125) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/16] time 0.283 (0.292) data 0.235 (0.243) loss_u loss_u 0.9014 (0.9317) acc_u 9.3750 (7.7083) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 305
confident_label rate tensor(0.3112, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 234
clean true:211
clean false:23
clean_rate:0.9017094017094017
noisy true:236
noisy false:282
after delete: len(clean_dataset) 234
after delete: len(noisy_dataset) 518
epoch [55/200] batch [5/7] time 0.295 (0.301) data 0.246 (0.252) loss_x loss_x 0.3337 (0.2985) acc_x 90.6250 (90.6250) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/16] time 0.278 (0.307) data 0.230 (0.258) loss_u loss_u 0.9175 (0.9479) acc_u 9.3750 (5.6250) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/16] time 0.290 (0.301) data 0.241 (0.252) loss_u loss_u 0.9580 (0.9551) acc_u 6.2500 (4.6875) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/16] time 0.274 (0.296) data 0.225 (0.247) loss_u loss_u 0.9209 (0.9576) acc_u 9.3750 (4.5833) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 306
confident_label rate tensor(0.3072, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 231
clean true:207
clean false:24
clean_rate:0.8961038961038961
noisy true:239
noisy false:282
after delete: len(clean_dataset) 231
after delete: len(noisy_dataset) 521
epoch [56/200] batch [5/7] time 0.307 (0.300) data 0.259 (0.251) loss_x loss_x 0.2708 (0.2808) acc_x 90.6250 (93.1250) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/16] time 0.293 (0.301) data 0.243 (0.252) loss_u loss_u 0.9565 (0.9546) acc_u 6.2500 (5.6250) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/16] time 0.261 (0.294) data 0.213 (0.246) loss_u loss_u 0.9434 (0.9531) acc_u 6.2500 (5.0000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/16] time 0.330 (0.299) data 0.281 (0.250) loss_u loss_u 0.9609 (0.9514) acc_u 3.1250 (5.4167) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 320
confident_label rate tensor(0.3152, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 237
clean true:210
clean false:27
clean_rate:0.8860759493670886
noisy true:222
noisy false:293
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 515
epoch [57/200] batch [5/7] time 0.333 (0.311) data 0.285 (0.262) loss_x loss_x 0.1565 (0.2766) acc_x 96.8750 (93.1250) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/16] time 0.297 (0.308) data 0.249 (0.259) loss_u loss_u 0.9487 (0.9656) acc_u 6.2500 (3.1250) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/16] time 0.244 (0.301) data 0.196 (0.253) loss_u loss_u 0.9673 (0.9663) acc_u 6.2500 (3.4375) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/16] time 0.299 (0.300) data 0.251 (0.252) loss_u loss_u 0.9336 (0.9601) acc_u 6.2500 (4.3750) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 293
confident_label rate tensor(0.3152, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 237
clean true:214
clean false:23
clean_rate:0.9029535864978903
noisy true:245
noisy false:270
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 515
epoch [58/200] batch [5/7] time 0.321 (0.297) data 0.274 (0.249) loss_x loss_x 0.4731 (0.4502) acc_x 90.6250 (90.0000) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/16] time 0.301 (0.306) data 0.252 (0.257) loss_u loss_u 0.8735 (0.9430) acc_u 15.6250 (6.2500) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/16] time 0.283 (0.299) data 0.235 (0.251) loss_u loss_u 0.8906 (0.9467) acc_u 15.6250 (6.5625) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/16] time 0.305 (0.294) data 0.257 (0.245) loss_u loss_u 0.9976 (0.9528) acc_u 0.0000 (5.6250) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 306
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 241
clean true:214
clean false:27
clean_rate:0.8879668049792531
noisy true:232
noisy false:279
after delete: len(clean_dataset) 241
after delete: len(noisy_dataset) 511
epoch [59/200] batch [5/7] time 0.347 (0.292) data 0.299 (0.244) loss_x loss_x 0.2223 (0.3880) acc_x 96.8750 (91.8750) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/15] time 0.269 (0.292) data 0.220 (0.244) loss_u loss_u 0.9404 (0.9537) acc_u 6.2500 (5.0000) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/15] time 0.289 (0.291) data 0.238 (0.243) loss_u loss_u 0.9312 (0.9514) acc_u 6.2500 (5.0000) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/15] time 0.290 (0.289) data 0.242 (0.240) loss_u loss_u 0.9170 (0.9535) acc_u 6.2500 (4.5833) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 310
confident_label rate tensor(0.3085, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 232
clean true:209
clean false:23
clean_rate:0.9008620689655172
noisy true:233
noisy false:287
after delete: len(clean_dataset) 232
after delete: len(noisy_dataset) 520
epoch [60/200] batch [5/7] time 0.323 (0.296) data 0.275 (0.249) loss_x loss_x 0.2346 (0.2492) acc_x 90.6250 (95.6250) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/16] time 0.287 (0.296) data 0.238 (0.248) loss_u loss_u 0.9360 (0.9585) acc_u 6.2500 (4.3750) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/16] time 0.294 (0.296) data 0.246 (0.248) loss_u loss_u 0.9712 (0.9472) acc_u 3.1250 (5.9375) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [15/16] time 0.266 (0.292) data 0.217 (0.243) loss_u loss_u 0.8999 (0.9460) acc_u 12.5000 (6.2500) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3231, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 243
clean true:215
clean false:28
clean_rate:0.8847736625514403
noisy true:254
noisy false:255
after delete: len(clean_dataset) 243
after delete: len(noisy_dataset) 509
epoch [61/200] batch [5/7] time 0.280 (0.306) data 0.232 (0.258) loss_x loss_x 0.9575 (0.3846) acc_x 93.7500 (95.6250) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/15] time 0.276 (0.301) data 0.226 (0.253) loss_u loss_u 0.9395 (0.9591) acc_u 6.2500 (4.3750) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/15] time 0.263 (0.299) data 0.215 (0.251) loss_u loss_u 0.9536 (0.9586) acc_u 6.2500 (4.6875) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/15] time 0.284 (0.298) data 0.235 (0.249) loss_u loss_u 0.9834 (0.9622) acc_u 0.0000 (3.9583) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 298
confident_label rate tensor(0.3098, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 233
clean true:209
clean false:24
clean_rate:0.8969957081545065
noisy true:245
noisy false:274
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 519
epoch [62/200] batch [5/7] time 0.356 (0.288) data 0.309 (0.240) loss_x loss_x 0.2185 (0.2863) acc_x 93.7500 (91.8750) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/16] time 0.312 (0.291) data 0.264 (0.243) loss_u loss_u 0.9961 (0.9673) acc_u 0.0000 (2.5000) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/16] time 0.281 (0.291) data 0.232 (0.242) loss_u loss_u 0.8828 (0.9421) acc_u 12.5000 (5.9375) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/16] time 0.295 (0.295) data 0.247 (0.247) loss_u loss_u 0.9658 (0.9504) acc_u 3.1250 (5.0000) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 295
confident_label rate tensor(0.3178, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 239
clean true:214
clean false:25
clean_rate:0.895397489539749
noisy true:243
noisy false:270
after delete: len(clean_dataset) 239
after delete: len(noisy_dataset) 513
epoch [63/200] batch [5/7] time 0.298 (0.298) data 0.250 (0.250) loss_x loss_x 0.2358 (0.4576) acc_x 96.8750 (89.3750) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/16] time 0.325 (0.294) data 0.277 (0.246) loss_u loss_u 0.9570 (0.9598) acc_u 3.1250 (3.7500) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/16] time 0.300 (0.297) data 0.251 (0.249) loss_u loss_u 0.9668 (0.9614) acc_u 3.1250 (3.4375) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/16] time 0.309 (0.299) data 0.261 (0.251) loss_u loss_u 0.9312 (0.9595) acc_u 9.3750 (4.1667) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 309
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 235
clean true:209
clean false:26
clean_rate:0.8893617021276595
noisy true:234
noisy false:283
after delete: len(clean_dataset) 235
after delete: len(noisy_dataset) 517
epoch [64/200] batch [5/7] time 0.303 (0.315) data 0.256 (0.267) loss_x loss_x 0.4067 (0.3780) acc_x 87.5000 (91.2500) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/16] time 0.282 (0.296) data 0.234 (0.248) loss_u loss_u 0.9980 (0.9505) acc_u 0.0000 (5.0000) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/16] time 0.324 (0.298) data 0.276 (0.250) loss_u loss_u 0.9043 (0.9398) acc_u 9.3750 (5.9375) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/16] time 0.250 (0.294) data 0.200 (0.246) loss_u loss_u 0.8862 (0.9453) acc_u 12.5000 (5.6250) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 253
clean true:224
clean false:29
clean_rate:0.8853754940711462
noisy true:240
noisy false:259
after delete: len(clean_dataset) 253
after delete: len(noisy_dataset) 499
epoch [65/200] batch [5/7] time 0.302 (0.300) data 0.254 (0.253) loss_x loss_x 0.4871 (0.3283) acc_x 87.5000 (91.2500) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/15] time 0.295 (0.294) data 0.247 (0.246) loss_u loss_u 0.9961 (0.9790) acc_u 0.0000 (2.5000) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/15] time 0.292 (0.299) data 0.244 (0.251) loss_u loss_u 0.9829 (0.9747) acc_u 3.1250 (2.8125) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/15] time 0.271 (0.297) data 0.220 (0.249) loss_u loss_u 0.9365 (0.9670) acc_u 6.2500 (3.5417) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 305
confident_label rate tensor(0.3098, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 233
clean true:204
clean false:29
clean_rate:0.8755364806866953
noisy true:243
noisy false:276
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 519
epoch [66/200] batch [5/7] time 0.296 (0.285) data 0.248 (0.237) loss_x loss_x 0.3079 (0.2357) acc_x 90.6250 (94.3750) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/16] time 0.283 (0.287) data 0.235 (0.239) loss_u loss_u 0.9800 (0.9538) acc_u 0.0000 (4.3750) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/16] time 0.255 (0.291) data 0.207 (0.243) loss_u loss_u 0.9346 (0.9559) acc_u 9.3750 (4.3750) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/16] time 0.300 (0.292) data 0.251 (0.244) loss_u loss_u 0.9106 (0.9469) acc_u 6.2500 (5.2083) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3271, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 246
clean true:217
clean false:29
clean_rate:0.8821138211382114
noisy true:243
noisy false:263
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 506
epoch [67/200] batch [5/7] time 0.273 (0.295) data 0.224 (0.247) loss_x loss_x 0.3276 (0.3672) acc_x 90.6250 (90.0000) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/15] time 0.270 (0.291) data 0.221 (0.243) loss_u loss_u 0.9248 (0.9453) acc_u 12.5000 (6.2500) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/15] time 0.305 (0.295) data 0.256 (0.247) loss_u loss_u 0.9272 (0.9544) acc_u 9.3750 (5.0000) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/15] time 0.270 (0.294) data 0.222 (0.245) loss_u loss_u 0.9976 (0.9551) acc_u 0.0000 (4.7917) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 293
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 248
clean true:218
clean false:30
clean_rate:0.8790322580645161
noisy true:241
noisy false:263
after delete: len(clean_dataset) 248
after delete: len(noisy_dataset) 504
epoch [68/200] batch [5/7] time 0.288 (0.299) data 0.240 (0.251) loss_x loss_x 0.2686 (0.3800) acc_x 93.7500 (91.2500) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/15] time 0.342 (0.301) data 0.294 (0.253) loss_u loss_u 0.9609 (0.9723) acc_u 3.1250 (2.5000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/15] time 0.316 (0.300) data 0.267 (0.252) loss_u loss_u 0.9331 (0.9679) acc_u 6.2500 (3.1250) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [15/15] time 0.311 (0.298) data 0.263 (0.250) loss_u loss_u 0.9775 (0.9607) acc_u 3.1250 (4.1667) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 279
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 252
clean true:224
clean false:28
clean_rate:0.8888888888888888
noisy true:249
noisy false:251
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 500
epoch [69/200] batch [5/7] time 0.265 (0.297) data 0.217 (0.249) loss_x loss_x 0.3909 (0.3375) acc_x 87.5000 (91.2500) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/15] time 0.315 (0.303) data 0.266 (0.255) loss_u loss_u 0.9600 (0.9631) acc_u 6.2500 (4.3750) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/15] time 0.324 (0.303) data 0.276 (0.255) loss_u loss_u 0.9458 (0.9616) acc_u 6.2500 (4.3750) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/15] time 0.323 (0.302) data 0.275 (0.254) loss_u loss_u 0.9829 (0.9614) acc_u 3.1250 (4.5833) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 319
confident_label rate tensor(0.3072, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 231
clean true:206
clean false:25
clean_rate:0.8917748917748918
noisy true:227
noisy false:294
after delete: len(clean_dataset) 231
after delete: len(noisy_dataset) 521
epoch [70/200] batch [5/7] time 0.328 (0.286) data 0.280 (0.238) loss_x loss_x 0.3479 (0.3009) acc_x 90.6250 (93.7500) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/16] time 0.283 (0.293) data 0.235 (0.245) loss_u loss_u 0.9194 (0.9419) acc_u 9.3750 (6.8750) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/16] time 0.285 (0.293) data 0.237 (0.244) loss_u loss_u 0.9639 (0.9391) acc_u 6.2500 (7.1875) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/16] time 0.295 (0.293) data 0.246 (0.245) loss_u loss_u 0.9590 (0.9379) acc_u 6.2500 (7.9167) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 297
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 241
clean true:215
clean false:26
clean_rate:0.8921161825726142
noisy true:240
noisy false:271
after delete: len(clean_dataset) 241
after delete: len(noisy_dataset) 511
epoch [71/200] batch [5/7] time 0.278 (0.291) data 0.231 (0.243) loss_x loss_x 0.2976 (0.2888) acc_x 93.7500 (93.1250) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/15] time 0.324 (0.296) data 0.273 (0.248) loss_u loss_u 0.9487 (0.9414) acc_u 6.2500 (7.5000) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/15] time 0.293 (0.301) data 0.245 (0.252) loss_u loss_u 0.9551 (0.9553) acc_u 3.1250 (5.3125) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/15] time 0.345 (0.305) data 0.296 (0.257) loss_u loss_u 0.9941 (0.9512) acc_u 0.0000 (5.6250) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 298
confident_label rate tensor(0.3271, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 246
clean true:219
clean false:27
clean_rate:0.8902439024390244
noisy true:235
noisy false:271
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 506
epoch [72/200] batch [5/7] time 0.297 (0.306) data 0.250 (0.258) loss_x loss_x 0.1144 (0.2951) acc_x 96.8750 (93.1250) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/15] time 0.285 (0.306) data 0.232 (0.258) loss_u loss_u 0.9814 (0.9652) acc_u 3.1250 (3.7500) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/15] time 0.268 (0.301) data 0.220 (0.252) loss_u loss_u 0.9248 (0.9610) acc_u 9.3750 (4.3750) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/15] time 0.302 (0.300) data 0.254 (0.251) loss_u loss_u 0.9629 (0.9591) acc_u 3.1250 (4.5833) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 317
confident_label rate tensor(0.3152, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 237
clean true:206
clean false:31
clean_rate:0.869198312236287
noisy true:229
noisy false:286
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 515
epoch [73/200] batch [5/7] time 0.334 (0.305) data 0.287 (0.257) loss_x loss_x 0.2583 (0.2841) acc_x 87.5000 (92.5000) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/16] time 0.284 (0.296) data 0.232 (0.248) loss_u loss_u 0.9580 (0.9673) acc_u 3.1250 (3.1250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/16] time 0.361 (0.298) data 0.312 (0.250) loss_u loss_u 0.9619 (0.9446) acc_u 3.1250 (5.9375) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/16] time 0.290 (0.298) data 0.242 (0.249) loss_u loss_u 0.9502 (0.9389) acc_u 9.3750 (7.2917) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 284
confident_label rate tensor(0.3324, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 250
clean true:224
clean false:26
clean_rate:0.896
noisy true:244
noisy false:258
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 502
epoch [74/200] batch [5/7] time 0.306 (0.317) data 0.259 (0.268) loss_x loss_x 0.4153 (0.2527) acc_x 90.6250 (93.7500) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/15] time 0.306 (0.306) data 0.258 (0.258) loss_u loss_u 0.9805 (0.9705) acc_u 3.1250 (3.7500) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/15] time 0.280 (0.302) data 0.232 (0.253) loss_u loss_u 0.9805 (0.9646) acc_u 3.1250 (4.6875) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/15] time 0.330 (0.300) data 0.282 (0.252) loss_u loss_u 0.9653 (0.9620) acc_u 3.1250 (4.7917) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 311
confident_label rate tensor(0.3271, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 246
clean true:217
clean false:29
clean_rate:0.8821138211382114
noisy true:224
noisy false:282
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 506
epoch [75/200] batch [5/7] time 0.315 (0.291) data 0.267 (0.243) loss_x loss_x 0.3787 (0.3431) acc_x 93.7500 (91.2500) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/15] time 0.314 (0.298) data 0.266 (0.250) loss_u loss_u 0.9634 (0.9282) acc_u 6.2500 (10.0000) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/15] time 0.304 (0.295) data 0.255 (0.247) loss_u loss_u 0.9990 (0.9502) acc_u 0.0000 (6.5625) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/15] time 0.300 (0.297) data 0.249 (0.249) loss_u loss_u 0.9062 (0.9526) acc_u 9.3750 (5.8333) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 252
clean true:221
clean false:31
clean_rate:0.876984126984127
noisy true:244
noisy false:256
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 500
epoch [76/200] batch [5/7] time 0.298 (0.307) data 0.251 (0.259) loss_x loss_x 0.2213 (0.2445) acc_x 90.6250 (93.7500) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/15] time 0.269 (0.301) data 0.220 (0.253) loss_u loss_u 0.9658 (0.9705) acc_u 3.1250 (2.5000) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/15] time 0.301 (0.301) data 0.252 (0.253) loss_u loss_u 0.9111 (0.9638) acc_u 12.5000 (3.7500) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [15/15] time 0.318 (0.302) data 0.270 (0.254) loss_u loss_u 0.9253 (0.9610) acc_u 9.3750 (4.3750) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 298
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:224
clean false:33
clean_rate:0.8715953307392996
noisy true:230
noisy false:265
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [77/200] batch [5/8] time 0.318 (0.303) data 0.269 (0.255) loss_x loss_x 0.1552 (0.2838) acc_x 93.7500 (92.5000) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/15] time 0.295 (0.303) data 0.247 (0.255) loss_u loss_u 0.9980 (0.9804) acc_u 0.0000 (2.5000) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/15] time 0.296 (0.306) data 0.248 (0.258) loss_u loss_u 0.9712 (0.9674) acc_u 3.1250 (3.4375) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/15] time 0.287 (0.304) data 0.239 (0.256) loss_u loss_u 0.9199 (0.9602) acc_u 9.3750 (4.1667) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 307
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 255
clean true:223
clean false:32
clean_rate:0.8745098039215686
noisy true:222
noisy false:275
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 497
epoch [78/200] batch [5/7] time 0.276 (0.302) data 0.228 (0.254) loss_x loss_x 0.3154 (0.2843) acc_x 87.5000 (90.0000) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/15] time 0.316 (0.304) data 0.268 (0.256) loss_u loss_u 0.9985 (0.9645) acc_u 0.0000 (3.7500) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/15] time 0.310 (0.303) data 0.261 (0.255) loss_u loss_u 0.9805 (0.9605) acc_u 3.1250 (4.0625) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/15] time 0.364 (0.308) data 0.315 (0.259) loss_u loss_u 0.9263 (0.9584) acc_u 6.2500 (4.3750) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 297
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 264
clean true:231
clean false:33
clean_rate:0.875
noisy true:224
noisy false:264
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 488
epoch [79/200] batch [5/8] time 0.293 (0.283) data 0.245 (0.235) loss_x loss_x 0.2920 (0.2275) acc_x 93.7500 (95.0000) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/15] time 0.311 (0.299) data 0.260 (0.251) loss_u loss_u 0.9990 (0.9653) acc_u 0.0000 (4.3750) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/15] time 0.349 (0.301) data 0.301 (0.252) loss_u loss_u 0.9990 (0.9633) acc_u 0.0000 (4.3750) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/15] time 0.305 (0.300) data 0.257 (0.252) loss_u loss_u 0.9858 (0.9643) acc_u 0.0000 (4.1667) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 297
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 259
clean true:225
clean false:34
clean_rate:0.8687258687258688
noisy true:230
noisy false:263
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 493
epoch [80/200] batch [5/8] time 0.275 (0.303) data 0.227 (0.255) loss_x loss_x 0.1436 (0.3637) acc_x 100.0000 (90.6250) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/15] time 0.291 (0.304) data 0.243 (0.256) loss_u loss_u 0.9624 (0.9608) acc_u 3.1250 (4.3750) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/15] time 0.310 (0.300) data 0.262 (0.252) loss_u loss_u 0.9595 (0.9667) acc_u 6.2500 (4.0625) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/15] time 0.329 (0.306) data 0.281 (0.258) loss_u loss_u 0.9414 (0.9632) acc_u 6.2500 (3.9583) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 302
confident_label rate tensor(0.3551, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 267
clean true:234
clean false:33
clean_rate:0.8764044943820225
noisy true:216
noisy false:269
after delete: len(clean_dataset) 267
after delete: len(noisy_dataset) 485
epoch [81/200] batch [5/8] time 0.320 (0.310) data 0.273 (0.263) loss_x loss_x 0.1958 (0.3901) acc_x 96.8750 (89.3750) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/15] time 0.288 (0.296) data 0.239 (0.248) loss_u loss_u 0.9634 (0.9733) acc_u 6.2500 (3.7500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/15] time 0.284 (0.297) data 0.236 (0.249) loss_u loss_u 0.9399 (0.9639) acc_u 6.2500 (4.0625) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/15] time 0.291 (0.299) data 0.243 (0.251) loss_u loss_u 0.9756 (0.9660) acc_u 3.1250 (3.9583) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:224
clean false:34
clean_rate:0.8682170542635659
noisy true:243
noisy false:251
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [82/200] batch [5/8] time 0.245 (0.294) data 0.197 (0.245) loss_x loss_x 0.2468 (0.2773) acc_x 90.6250 (91.8750) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/15] time 0.313 (0.298) data 0.265 (0.250) loss_u loss_u 0.9507 (0.9467) acc_u 6.2500 (5.6250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/15] time 0.311 (0.298) data 0.263 (0.250) loss_u loss_u 0.9482 (0.9566) acc_u 6.2500 (4.3750) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/15] time 0.301 (0.300) data 0.253 (0.252) loss_u loss_u 0.9688 (0.9604) acc_u 3.1250 (4.1667) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 293
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:227
clean false:31
clean_rate:0.8798449612403101
noisy true:232
noisy false:262
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [83/200] batch [5/8] time 0.286 (0.286) data 0.238 (0.237) loss_x loss_x 0.2590 (0.2388) acc_x 93.7500 (95.6250) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/15] time 0.284 (0.294) data 0.236 (0.245) loss_u loss_u 0.9692 (0.9676) acc_u 3.1250 (3.7500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/15] time 0.291 (0.296) data 0.243 (0.247) loss_u loss_u 0.9980 (0.9596) acc_u 0.0000 (4.3750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/15] time 0.317 (0.298) data 0.269 (0.249) loss_u loss_u 0.9980 (0.9599) acc_u 0.0000 (3.9583) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 279
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:233
clean false:30
clean_rate:0.8859315589353612
noisy true:240
noisy false:249
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [84/200] batch [5/8] time 0.295 (0.341) data 0.247 (0.293) loss_x loss_x 0.1635 (0.2408) acc_x 100.0000 (95.0000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [5/15] time 0.282 (0.318) data 0.234 (0.270) loss_u loss_u 0.9702 (0.9769) acc_u 3.1250 (2.5000) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/15] time 0.341 (0.313) data 0.293 (0.264) loss_u loss_u 0.9292 (0.9801) acc_u 6.2500 (1.8750) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/15] time 0.296 (0.313) data 0.248 (0.264) loss_u loss_u 0.9556 (0.9713) acc_u 3.1250 (3.1250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 284
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 259
clean true:229
clean false:30
clean_rate:0.8841698841698842
noisy true:239
noisy false:254
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 493
epoch [85/200] batch [5/8] time 0.311 (0.302) data 0.263 (0.253) loss_x loss_x 0.2001 (0.2838) acc_x 96.8750 (95.0000) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/15] time 0.325 (0.301) data 0.274 (0.252) loss_u loss_u 0.9141 (0.9673) acc_u 9.3750 (3.7500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/15] time 0.350 (0.304) data 0.302 (0.255) loss_u loss_u 0.9619 (0.9546) acc_u 3.1250 (5.3125) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/15] time 0.293 (0.305) data 0.245 (0.256) loss_u loss_u 0.9893 (0.9601) acc_u 0.0000 (4.5833) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:232
clean false:31
clean_rate:0.8821292775665399
noisy true:230
noisy false:259
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [86/200] batch [5/8] time 0.263 (0.285) data 0.215 (0.237) loss_x loss_x 0.2864 (0.2036) acc_x 90.6250 (95.0000) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/15] time 0.295 (0.294) data 0.247 (0.246) loss_u loss_u 0.9956 (0.9660) acc_u 0.0000 (4.3750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/15] time 0.307 (0.297) data 0.259 (0.249) loss_u loss_u 0.9561 (0.9673) acc_u 3.1250 (3.7500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/15] time 0.306 (0.298) data 0.257 (0.249) loss_u loss_u 0.9941 (0.9626) acc_u 0.0000 (4.3750) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 297
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:224
clean false:30
clean_rate:0.8818897637795275
noisy true:231
noisy false:267
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [87/200] batch [5/7] time 0.332 (0.310) data 0.285 (0.262) loss_x loss_x 0.1698 (0.2109) acc_x 93.7500 (96.2500) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/15] time 0.274 (0.299) data 0.226 (0.251) loss_u loss_u 0.9795 (0.9584) acc_u 3.1250 (5.0000) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/15] time 0.270 (0.299) data 0.222 (0.251) loss_u loss_u 0.9990 (0.9567) acc_u 0.0000 (5.0000) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/15] time 0.297 (0.299) data 0.249 (0.250) loss_u loss_u 0.9985 (0.9549) acc_u 0.0000 (4.7917) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:225
clean false:32
clean_rate:0.8754863813229572
noisy true:238
noisy false:257
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [88/200] batch [5/8] time 0.353 (0.313) data 0.300 (0.263) loss_x loss_x 0.1257 (0.1784) acc_x 96.8750 (97.5000) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/15] time 0.343 (0.299) data 0.295 (0.250) loss_u loss_u 0.9326 (0.9609) acc_u 6.2500 (4.3750) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/15] time 0.288 (0.302) data 0.240 (0.253) loss_u loss_u 0.9419 (0.9515) acc_u 12.5000 (5.9375) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [15/15] time 0.294 (0.304) data 0.245 (0.255) loss_u loss_u 0.9536 (0.9602) acc_u 6.2500 (4.7917) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 302
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 259
clean true:225
clean false:34
clean_rate:0.8687258687258688
noisy true:225
noisy false:268
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 493
epoch [89/200] batch [5/8] time 0.320 (0.306) data 0.273 (0.258) loss_x loss_x 0.1307 (0.1928) acc_x 100.0000 (95.6250) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/15] time 0.320 (0.297) data 0.271 (0.249) loss_u loss_u 0.9365 (0.9621) acc_u 6.2500 (3.1250) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/15] time 0.306 (0.300) data 0.257 (0.252) loss_u loss_u 0.8770 (0.9482) acc_u 15.6250 (5.6250) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/15] time 0.330 (0.303) data 0.282 (0.255) loss_u loss_u 0.9932 (0.9566) acc_u 0.0000 (4.5833) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 278
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:234
clean false:29
clean_rate:0.8897338403041825
noisy true:240
noisy false:249
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [90/200] batch [5/8] time 0.299 (0.310) data 0.252 (0.263) loss_x loss_x 0.2269 (0.2194) acc_x 96.8750 (95.0000) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/15] time 0.308 (0.297) data 0.260 (0.249) loss_u loss_u 0.9321 (0.9520) acc_u 6.2500 (4.3750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/15] time 0.286 (0.295) data 0.238 (0.247) loss_u loss_u 0.9897 (0.9670) acc_u 0.0000 (2.8125) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/15] time 0.293 (0.294) data 0.245 (0.246) loss_u loss_u 0.9619 (0.9683) acc_u 3.1250 (2.9167) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:232
clean false:31
clean_rate:0.8821292775665399
noisy true:228
noisy false:261
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [91/200] batch [5/8] time 0.271 (0.297) data 0.224 (0.249) loss_x loss_x 0.2184 (0.2144) acc_x 96.8750 (95.6250) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/15] time 0.309 (0.300) data 0.260 (0.252) loss_u loss_u 0.9556 (0.9674) acc_u 3.1250 (3.1250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/15] time 0.290 (0.301) data 0.242 (0.253) loss_u loss_u 0.9043 (0.9634) acc_u 12.5000 (4.0625) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/15] time 0.337 (0.304) data 0.289 (0.255) loss_u loss_u 0.9678 (0.9593) acc_u 3.1250 (4.3750) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 274
confident_label rate tensor(0.3551, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 267
clean true:233
clean false:34
clean_rate:0.8726591760299626
noisy true:245
noisy false:240
after delete: len(clean_dataset) 267
after delete: len(noisy_dataset) 485
epoch [92/200] batch [5/8] time 0.256 (0.286) data 0.207 (0.239) loss_x loss_x 0.1929 (0.2915) acc_x 96.8750 (92.5000) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/15] time 0.292 (0.301) data 0.244 (0.253) loss_u loss_u 0.9585 (0.9723) acc_u 3.1250 (3.1250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/15] time 0.305 (0.300) data 0.257 (0.252) loss_u loss_u 0.9717 (0.9675) acc_u 3.1250 (3.4375) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [15/15] time 0.312 (0.300) data 0.264 (0.251) loss_u loss_u 0.9463 (0.9678) acc_u 6.2500 (3.3333) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 284
confident_label rate tensor(0.3524, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 265
clean true:230
clean false:35
clean_rate:0.8679245283018868
noisy true:238
noisy false:249
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 487
epoch [93/200] batch [5/8] time 0.288 (0.279) data 0.240 (0.231) loss_x loss_x 0.3208 (0.3043) acc_x 93.7500 (93.1250) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/15] time 0.317 (0.296) data 0.269 (0.248) loss_u loss_u 0.9951 (0.9648) acc_u 0.0000 (4.3750) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/15] time 0.311 (0.303) data 0.262 (0.255) loss_u loss_u 0.9678 (0.9680) acc_u 3.1250 (3.7500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/15] time 0.299 (0.304) data 0.251 (0.256) loss_u loss_u 0.9521 (0.9664) acc_u 6.2500 (3.9583) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 296
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:225
clean false:33
clean_rate:0.872093023255814
noisy true:231
noisy false:263
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [94/200] batch [5/8] time 0.290 (0.284) data 0.242 (0.237) loss_x loss_x 0.5444 (0.2733) acc_x 81.2500 (91.8750) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/15] time 0.259 (0.292) data 0.211 (0.244) loss_u loss_u 0.9922 (0.9706) acc_u 0.0000 (2.5000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/15] time 0.286 (0.291) data 0.238 (0.243) loss_u loss_u 0.9937 (0.9516) acc_u 0.0000 (5.0000) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [15/15] time 0.312 (0.298) data 0.264 (0.250) loss_u loss_u 0.9414 (0.9554) acc_u 6.2500 (4.5833) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 284
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:230
clean false:33
clean_rate:0.8745247148288974
noisy true:238
noisy false:251
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [95/200] batch [5/8] time 0.293 (0.284) data 0.245 (0.235) loss_x loss_x 0.2781 (0.2336) acc_x 96.8750 (95.0000) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/15] time 0.294 (0.287) data 0.245 (0.238) loss_u loss_u 0.9326 (0.9696) acc_u 6.2500 (3.1250) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/15] time 0.312 (0.295) data 0.264 (0.246) loss_u loss_u 0.9438 (0.9653) acc_u 6.2500 (3.7500) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [15/15] time 0.289 (0.295) data 0.241 (0.246) loss_u loss_u 0.9678 (0.9643) acc_u 3.1250 (4.1667) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 270
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:230
clean false:28
clean_rate:0.8914728682170543
noisy true:252
noisy false:242
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [96/200] batch [5/8] time 0.305 (0.283) data 0.257 (0.235) loss_x loss_x 0.2240 (0.2187) acc_x 90.6250 (93.1250) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/15] time 0.279 (0.301) data 0.230 (0.253) loss_u loss_u 0.9810 (0.9602) acc_u 3.1250 (3.7500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/15] time 0.321 (0.299) data 0.273 (0.251) loss_u loss_u 0.9658 (0.9560) acc_u 3.1250 (4.6875) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/15] time 0.304 (0.300) data 0.256 (0.252) loss_u loss_u 0.9761 (0.9575) acc_u 3.1250 (4.5833) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3577, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 269
clean true:235
clean false:34
clean_rate:0.8736059479553904
noisy true:229
noisy false:254
after delete: len(clean_dataset) 269
after delete: len(noisy_dataset) 483
epoch [97/200] batch [5/8] time 0.306 (0.298) data 0.258 (0.250) loss_x loss_x 0.3125 (0.2688) acc_x 93.7500 (94.3750) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/15] time 0.314 (0.298) data 0.266 (0.250) loss_u loss_u 0.9971 (0.9777) acc_u 0.0000 (1.8750) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/15] time 0.289 (0.295) data 0.228 (0.246) loss_u loss_u 0.9985 (0.9613) acc_u 0.0000 (3.7500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/15] time 0.293 (0.299) data 0.245 (0.250) loss_u loss_u 0.9336 (0.9687) acc_u 6.2500 (2.9167) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3537, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 266
clean true:233
clean false:33
clean_rate:0.8759398496240601
noisy true:234
noisy false:252
after delete: len(clean_dataset) 266
after delete: len(noisy_dataset) 486
epoch [98/200] batch [5/8] time 0.290 (0.290) data 0.242 (0.242) loss_x loss_x 0.2432 (0.1995) acc_x 93.7500 (95.6250) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/15] time 0.273 (0.294) data 0.225 (0.246) loss_u loss_u 0.9351 (0.9559) acc_u 6.2500 (5.0000) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/15] time 0.283 (0.294) data 0.234 (0.246) loss_u loss_u 0.9629 (0.9583) acc_u 3.1250 (4.3750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/15] time 0.286 (0.293) data 0.238 (0.245) loss_u loss_u 0.9604 (0.9584) acc_u 3.1250 (4.3750) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 284
confident_label rate tensor(0.3617, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 272
clean true:235
clean false:37
clean_rate:0.8639705882352942
noisy true:233
noisy false:247
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 480
epoch [99/200] batch [5/8] time 0.319 (0.302) data 0.271 (0.253) loss_x loss_x 0.4688 (0.2485) acc_x 90.6250 (95.6250) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/15] time 0.286 (0.303) data 0.238 (0.254) loss_u loss_u 0.9761 (0.9616) acc_u 3.1250 (4.3750) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/15] time 0.299 (0.299) data 0.251 (0.250) loss_u loss_u 0.9424 (0.9603) acc_u 6.2500 (4.3750) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [15/15] time 0.283 (0.297) data 0.235 (0.249) loss_u loss_u 0.9961 (0.9693) acc_u 0.0000 (3.1250) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 278
confident_label rate tensor(0.3524, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 265
clean true:229
clean false:36
clean_rate:0.8641509433962264
noisy true:245
noisy false:242
all clean rate:  [0.8285714285714286, 0.8378378378378378, 1.0, 0.963302752293578, 0.9711538461538461, 0.9568965517241379, 0.9380530973451328, 0.9491525423728814, 0.9307692307692308, 0.9393939393939394, 0.9534883720930233, 0.924812030075188, 0.951048951048951, 0.9668874172185431, 0.9403973509933775, 0.9207317073170732, 0.9259259259259259, 0.9464285714285714, 0.9182389937106918, 0.9289940828402367, 0.9195402298850575, 0.9320987654320988, 0.9269662921348315, 0.9479768786127167, 0.9396984924623115, 0.9289617486338798, 0.9315789473684211, 0.9347826086956522, 0.9322916666666666, 0.9230769230769231, 0.9329896907216495, 0.9219512195121952, 0.9395348837209302, 0.915, 0.9447236180904522, 0.94, 0.9282296650717703, 0.9428571428571428, 0.917098445595855, 0.8952380952380953, 0.9292929292929293, 0.9022222222222223, 0.9223744292237442, 0.9324324324324325, 0.9090909090909091, 0.925764192139738, 0.926605504587156, 0.8995633187772926, 0.8968609865470852, 0.9030837004405287, 0.8945147679324894, 0.8836206896551724, 0.8834080717488789, 0.8858447488584474, 0.9017094017094017, 0.8961038961038961, 0.8860759493670886, 0.9029535864978903, 0.8879668049792531, 0.9008620689655172, 0.8847736625514403, 0.8969957081545065, 0.895397489539749, 0.8893617021276595, 0.8853754940711462, 0.8755364806866953, 0.8821138211382114, 0.8790322580645161, 0.8888888888888888, 0.8917748917748918, 0.8921161825726142, 0.8902439024390244, 0.869198312236287, 0.896, 0.8821138211382114, 0.876984126984127, 0.8715953307392996, 0.8745098039215686, 0.875, 0.8687258687258688, 0.8764044943820225, 0.8682170542635659, 0.8798449612403101, 0.8859315589353612, 0.8841698841698842, 0.8821292775665399, 0.8818897637795275, 0.8754863813229572, 0.8687258687258688, 0.8897338403041825, 0.8821292775665399, 0.8726591760299626, 0.8679245283018868, 0.872093023255814, 0.8745247148288974, 0.8914728682170543, 0.8736059479553904, 0.8759398496240601, 0.8639705882352942, 0.8641509433962264]
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 487
epoch [100/200] batch [5/8] time 0.293 (0.299) data 0.245 (0.251) loss_x loss_x 0.2925 (0.2294) acc_x 96.8750 (97.5000) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/15] time 0.309 (0.297) data 0.261 (0.249) loss_u loss_u 0.9829 (0.9470) acc_u 3.1250 (6.2500) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/15] time 0.282 (0.298) data 0.231 (0.250) loss_u loss_u 0.9492 (0.9553) acc_u 6.2500 (5.3125) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [15/15] time 0.313 (0.300) data 0.262 (0.251) loss_u loss_u 0.9683 (0.9585) acc_u 3.1250 (4.7917) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3604, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 271
clean true:237
clean false:34
clean_rate:0.8745387453874539
noisy true:225
noisy false:256
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 481
epoch [101/200] batch [5/8] time 0.307 (0.307) data 0.259 (0.259) loss_x loss_x 0.2089 (0.2913) acc_x 93.7500 (93.7500) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/15] time 0.307 (0.319) data 0.258 (0.270) loss_u loss_u 0.9902 (0.9652) acc_u 0.0000 (3.7500) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/15] time 0.292 (0.312) data 0.243 (0.264) loss_u loss_u 0.9834 (0.9672) acc_u 0.0000 (3.4375) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [15/15] time 0.270 (0.308) data 0.222 (0.259) loss_u loss_u 0.9316 (0.9662) acc_u 9.3750 (3.5417) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 281
confident_label rate tensor(0.3551, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 267
clean true:232
clean false:35
clean_rate:0.8689138576779026
noisy true:239
noisy false:246
after delete: len(clean_dataset) 267
after delete: len(noisy_dataset) 485
epoch [102/200] batch [5/8] time 0.301 (0.290) data 0.253 (0.242) loss_x loss_x 0.1190 (0.2161) acc_x 100.0000 (97.5000) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/15] time 0.325 (0.302) data 0.276 (0.254) loss_u loss_u 0.9717 (0.9469) acc_u 3.1250 (5.6250) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/15] time 0.319 (0.302) data 0.271 (0.254) loss_u loss_u 0.9697 (0.9513) acc_u 3.1250 (5.3125) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/15] time 0.302 (0.298) data 0.250 (0.250) loss_u loss_u 0.9614 (0.9599) acc_u 3.1250 (4.3750) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3551, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 267
clean true:232
clean false:35
clean_rate:0.8689138576779026
noisy true:234
noisy false:251
after delete: len(clean_dataset) 267
after delete: len(noisy_dataset) 485
epoch [103/200] batch [5/8] time 0.316 (0.308) data 0.268 (0.260) loss_x loss_x 0.2230 (0.1691) acc_x 93.7500 (96.8750) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/15] time 0.309 (0.303) data 0.260 (0.255) loss_u loss_u 0.9839 (0.9862) acc_u 3.1250 (1.2500) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/15] time 0.296 (0.303) data 0.248 (0.254) loss_u loss_u 0.9727 (0.9746) acc_u 3.1250 (2.8125) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [15/15] time 0.284 (0.296) data 0.236 (0.248) loss_u loss_u 0.9536 (0.9595) acc_u 3.1250 (4.3750) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3617, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 272
clean true:236
clean false:36
clean_rate:0.8676470588235294
noisy true:231
noisy false:249
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 480
epoch [104/200] batch [5/8] time 0.278 (0.292) data 0.230 (0.244) loss_x loss_x 0.2783 (0.2740) acc_x 93.7500 (93.7500) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/15] time 0.308 (0.296) data 0.260 (0.248) loss_u loss_u 0.9961 (0.9623) acc_u 0.0000 (3.7500) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/15] time 0.278 (0.297) data 0.230 (0.249) loss_u loss_u 0.9761 (0.9654) acc_u 3.1250 (3.4375) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [15/15] time 0.314 (0.300) data 0.266 (0.251) loss_u loss_u 0.9683 (0.9659) acc_u 3.1250 (3.5417) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 298
confident_label rate tensor(0.3644, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 274
clean true:233
clean false:41
clean_rate:0.8503649635036497
noisy true:221
noisy false:257
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 478
epoch [105/200] batch [5/8] time 0.290 (0.292) data 0.242 (0.244) loss_x loss_x 0.1460 (0.3760) acc_x 96.8750 (93.7500) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/14] time 0.280 (0.299) data 0.231 (0.251) loss_u loss_u 0.9546 (0.9594) acc_u 3.1250 (3.7500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/14] time 0.271 (0.295) data 0.223 (0.247) loss_u loss_u 0.9424 (0.9631) acc_u 9.3750 (4.0625) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3590, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 270
clean true:235
clean false:35
clean_rate:0.8703703703703703
noisy true:225
noisy false:257
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 482
epoch [106/200] batch [5/8] time 0.270 (0.293) data 0.222 (0.245) loss_x loss_x 0.5244 (0.2581) acc_x 84.3750 (95.0000) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/15] time 0.299 (0.301) data 0.251 (0.252) loss_u loss_u 0.8911 (0.9555) acc_u 12.5000 (5.0000) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/15] time 0.266 (0.298) data 0.217 (0.249) loss_u loss_u 0.9873 (0.9626) acc_u 0.0000 (3.7500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/15] time 0.312 (0.298) data 0.264 (0.250) loss_u loss_u 0.9668 (0.9597) acc_u 3.1250 (3.9583) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 302
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:237
clean false:39
clean_rate:0.8586956521739131
noisy true:213
noisy false:263
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [107/200] batch [5/8] time 0.311 (0.297) data 0.263 (0.250) loss_x loss_x 0.2297 (0.2632) acc_x 96.8750 (95.6250) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/14] time 0.312 (0.303) data 0.264 (0.255) loss_u loss_u 0.9980 (0.9812) acc_u 0.0000 (1.8750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/14] time 0.285 (0.301) data 0.237 (0.253) loss_u loss_u 0.9805 (0.9830) acc_u 3.1250 (1.8750) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 268
clean true:229
clean false:39
clean_rate:0.8544776119402985
noisy true:241
noisy false:243
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 484
epoch [108/200] batch [5/8] time 0.258 (0.296) data 0.210 (0.248) loss_x loss_x 0.1608 (0.1592) acc_x 93.7500 (96.2500) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/15] time 0.299 (0.300) data 0.250 (0.252) loss_u loss_u 0.9849 (0.9666) acc_u 0.0000 (3.7500) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/15] time 0.282 (0.299) data 0.230 (0.250) loss_u loss_u 0.9390 (0.9522) acc_u 6.2500 (5.6250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/15] time 0.345 (0.299) data 0.294 (0.250) loss_u loss_u 0.9990 (0.9560) acc_u 0.0000 (5.0000) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:237
clean false:38
clean_rate:0.8618181818181818
noisy true:223
noisy false:254
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [109/200] batch [5/8] time 0.282 (0.283) data 0.234 (0.235) loss_x loss_x 0.2074 (0.1873) acc_x 96.8750 (96.2500) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/14] time 0.322 (0.293) data 0.273 (0.245) loss_u loss_u 0.9800 (0.9723) acc_u 3.1250 (3.1250) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [10/14] time 0.241 (0.290) data 0.192 (0.242) loss_u loss_u 0.9673 (0.9703) acc_u 3.1250 (2.8125) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 297
confident_label rate tensor(0.3590, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 270
clean true:231
clean false:39
clean_rate:0.8555555555555555
noisy true:224
noisy false:258
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 482
epoch [110/200] batch [5/8] time 0.275 (0.292) data 0.228 (0.244) loss_x loss_x 0.3486 (0.2339) acc_x 90.6250 (94.3750) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/15] time 0.296 (0.313) data 0.247 (0.265) loss_u loss_u 0.9727 (0.9571) acc_u 3.1250 (4.3750) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/15] time 0.309 (0.309) data 0.261 (0.261) loss_u loss_u 0.9888 (0.9622) acc_u 0.0000 (4.0625) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/15] time 0.290 (0.307) data 0.242 (0.258) loss_u loss_u 0.9102 (0.9579) acc_u 12.5000 (4.7917) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3577, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 269
clean true:228
clean false:41
clean_rate:0.8475836431226765
noisy true:236
noisy false:247
after delete: len(clean_dataset) 269
after delete: len(noisy_dataset) 483
epoch [111/200] batch [5/8] time 0.281 (0.286) data 0.231 (0.237) loss_x loss_x 0.5142 (0.2728) acc_x 96.8750 (96.2500) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/15] time 0.304 (0.300) data 0.256 (0.251) loss_u loss_u 0.9644 (0.9676) acc_u 6.2500 (3.7500) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [10/15] time 0.264 (0.295) data 0.215 (0.247) loss_u loss_u 0.9937 (0.9703) acc_u 0.0000 (3.1250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/15] time 0.300 (0.298) data 0.251 (0.250) loss_u loss_u 0.9536 (0.9591) acc_u 6.2500 (4.5833) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 298
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 260
clean true:225
clean false:35
clean_rate:0.8653846153846154
noisy true:229
noisy false:263
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 492
epoch [112/200] batch [5/8] time 0.323 (0.309) data 0.275 (0.261) loss_x loss_x 0.1971 (0.1795) acc_x 96.8750 (96.8750) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/15] time 0.348 (0.303) data 0.299 (0.255) loss_u loss_u 0.9053 (0.9568) acc_u 12.5000 (5.6250) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/15] time 0.291 (0.295) data 0.243 (0.247) loss_u loss_u 0.8604 (0.9412) acc_u 15.6250 (7.1875) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [15/15] time 0.299 (0.298) data 0.251 (0.250) loss_u loss_u 0.9106 (0.9427) acc_u 9.3750 (6.8750) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:237
clean false:38
clean_rate:0.8618181818181818
noisy true:230
noisy false:247
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [113/200] batch [5/8] time 0.292 (0.288) data 0.244 (0.240) loss_x loss_x 0.1013 (0.1362) acc_x 96.8750 (97.5000) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/14] time 0.309 (0.298) data 0.261 (0.250) loss_u loss_u 0.9966 (0.9790) acc_u 0.0000 (2.5000) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/14] time 0.298 (0.298) data 0.250 (0.250) loss_u loss_u 0.9888 (0.9784) acc_u 0.0000 (2.1875) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3723, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 280
clean true:242
clean false:38
clean_rate:0.8642857142857143
noisy true:224
noisy false:248
after delete: len(clean_dataset) 280
after delete: len(noisy_dataset) 472
epoch [114/200] batch [5/8] time 0.320 (0.293) data 0.273 (0.245) loss_x loss_x 0.1262 (0.3575) acc_x 100.0000 (96.8750) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/14] time 0.303 (0.297) data 0.255 (0.249) loss_u loss_u 0.9966 (0.9844) acc_u 0.0000 (1.8750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/14] time 0.267 (0.293) data 0.215 (0.245) loss_u loss_u 0.9932 (0.9766) acc_u 0.0000 (2.8125) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:233
clean false:40
clean_rate:0.8534798534798534
noisy true:230
noisy false:249
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [115/200] batch [5/8] time 0.283 (0.287) data 0.236 (0.240) loss_x loss_x 0.1362 (0.1934) acc_x 100.0000 (96.2500) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/14] time 0.341 (0.295) data 0.293 (0.247) loss_u loss_u 0.9414 (0.9636) acc_u 6.2500 (3.7500) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [10/14] time 0.280 (0.297) data 0.232 (0.249) loss_u loss_u 0.9854 (0.9689) acc_u 3.1250 (3.1250) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 295
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:234
clean false:39
clean_rate:0.8571428571428571
noisy true:223
noisy false:256
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [116/200] batch [5/8] time 0.292 (0.285) data 0.244 (0.237) loss_x loss_x 0.1455 (0.1441) acc_x 100.0000 (99.3750) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/14] time 0.287 (0.294) data 0.239 (0.246) loss_u loss_u 0.9985 (0.9568) acc_u 0.0000 (4.3750) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/14] time 0.302 (0.296) data 0.254 (0.248) loss_u loss_u 0.9702 (0.9616) acc_u 3.1250 (4.3750) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:238
clean false:38
clean_rate:0.8623188405797102
noisy true:231
noisy false:245
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [117/200] batch [5/8] time 0.312 (0.302) data 0.264 (0.255) loss_x loss_x 0.1758 (0.1829) acc_x 96.8750 (96.8750) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/14] time 0.256 (0.295) data 0.208 (0.247) loss_u loss_u 0.9668 (0.9624) acc_u 3.1250 (3.7500) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/14] time 0.303 (0.298) data 0.255 (0.250) loss_u loss_u 0.9980 (0.9694) acc_u 0.0000 (3.1250) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3551, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 267
clean true:229
clean false:38
clean_rate:0.8576779026217228
noisy true:231
noisy false:254
after delete: len(clean_dataset) 267
after delete: len(noisy_dataset) 485
epoch [118/200] batch [5/8] time 0.288 (0.295) data 0.240 (0.247) loss_x loss_x 0.2087 (0.1628) acc_x 93.7500 (96.8750) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/15] time 0.292 (0.292) data 0.242 (0.244) loss_u loss_u 0.9648 (0.9638) acc_u 3.1250 (3.1250) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/15] time 0.297 (0.291) data 0.248 (0.242) loss_u loss_u 0.8926 (0.9441) acc_u 9.3750 (5.6250) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [15/15] time 0.318 (0.296) data 0.270 (0.247) loss_u loss_u 0.9590 (0.9507) acc_u 3.1250 (5.0000) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 301
confident_label rate tensor(0.3710, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 279
clean true:235
clean false:44
clean_rate:0.8422939068100358
noisy true:216
noisy false:257
after delete: len(clean_dataset) 279
after delete: len(noisy_dataset) 473
epoch [119/200] batch [5/8] time 0.316 (0.290) data 0.267 (0.242) loss_x loss_x 0.3298 (0.3285) acc_x 96.8750 (94.3750) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/14] time 0.283 (0.298) data 0.235 (0.250) loss_u loss_u 0.9683 (0.9746) acc_u 3.1250 (1.8750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/14] time 0.322 (0.297) data 0.273 (0.248) loss_u loss_u 0.9390 (0.9625) acc_u 6.2500 (3.4375) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 284
confident_label rate tensor(0.3710, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 279
clean true:237
clean false:42
clean_rate:0.8494623655913979
noisy true:231
noisy false:242
after delete: len(clean_dataset) 279
after delete: len(noisy_dataset) 473
epoch [120/200] batch [5/8] time 0.313 (0.296) data 0.265 (0.248) loss_x loss_x 0.2426 (0.3091) acc_x 93.7500 (95.6250) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/14] time 0.298 (0.295) data 0.249 (0.247) loss_u loss_u 0.9653 (0.9769) acc_u 3.1250 (2.5000) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/14] time 0.335 (0.299) data 0.286 (0.251) loss_u loss_u 0.9648 (0.9680) acc_u 3.1250 (3.4375) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 301
confident_label rate tensor(0.3617, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 272
clean true:233
clean false:39
clean_rate:0.8566176470588235
noisy true:218
noisy false:262
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 480
epoch [121/200] batch [5/8] time 0.308 (0.310) data 0.259 (0.261) loss_x loss_x 0.2021 (0.1489) acc_x 96.8750 (98.7500) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/15] time 0.301 (0.313) data 0.253 (0.264) loss_u loss_u 0.9966 (0.9540) acc_u 0.0000 (5.0000) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/15] time 0.284 (0.308) data 0.235 (0.259) loss_u loss_u 0.9448 (0.9560) acc_u 6.2500 (4.6875) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [15/15] time 0.290 (0.304) data 0.241 (0.256) loss_u loss_u 0.9976 (0.9591) acc_u 0.0000 (4.3750) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:231
clean false:42
clean_rate:0.8461538461538461
noisy true:234
noisy false:245
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [122/200] batch [5/8] time 0.305 (0.299) data 0.254 (0.250) loss_x loss_x 0.1918 (0.2732) acc_x 96.8750 (91.8750) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/14] time 0.313 (0.305) data 0.265 (0.257) loss_u loss_u 0.8770 (0.9606) acc_u 12.5000 (4.3750) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [10/14] time 0.301 (0.303) data 0.253 (0.254) loss_u loss_u 0.8359 (0.9339) acc_u 18.7500 (7.1875) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 279
confident_label rate tensor(0.3710, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 279
clean true:241
clean false:38
clean_rate:0.8637992831541219
noisy true:232
noisy false:241
after delete: len(clean_dataset) 279
after delete: len(noisy_dataset) 473
epoch [123/200] batch [5/8] time 0.318 (0.308) data 0.267 (0.260) loss_x loss_x 0.1312 (0.1655) acc_x 96.8750 (97.5000) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/14] time 0.295 (0.297) data 0.247 (0.249) loss_u loss_u 0.9976 (0.9866) acc_u 0.0000 (1.2500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/14] time 0.248 (0.291) data 0.200 (0.242) loss_u loss_u 0.9946 (0.9776) acc_u 0.0000 (1.8750) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 296
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:229
clean false:44
clean_rate:0.8388278388278388
noisy true:227
noisy false:252
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [124/200] batch [5/8] time 0.252 (0.295) data 0.204 (0.247) loss_x loss_x 0.0921 (0.1368) acc_x 100.0000 (97.5000) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/14] time 0.288 (0.302) data 0.240 (0.254) loss_u loss_u 0.9497 (0.9491) acc_u 6.2500 (5.0000) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [10/14] time 0.318 (0.308) data 0.270 (0.260) loss_u loss_u 0.9624 (0.9576) acc_u 3.1250 (4.0625) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 284
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:241
clean false:44
clean_rate:0.8456140350877193
noisy true:227
noisy false:240
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [125/200] batch [5/8] time 0.310 (0.312) data 0.262 (0.264) loss_x loss_x 0.1962 (0.2317) acc_x 93.7500 (96.2500) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/14] time 0.283 (0.304) data 0.234 (0.255) loss_u loss_u 0.9629 (0.9912) acc_u 3.1250 (0.6250) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [10/14] time 0.368 (0.313) data 0.320 (0.265) loss_u loss_u 0.9653 (0.9642) acc_u 3.1250 (3.4375) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3803, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 286
clean true:243
clean false:43
clean_rate:0.8496503496503497
noisy true:222
noisy false:244
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 466
epoch [126/200] batch [5/8] time 0.320 (0.293) data 0.272 (0.245) loss_x loss_x 0.1456 (0.1705) acc_x 100.0000 (96.8750) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/14] time 0.286 (0.297) data 0.237 (0.249) loss_u loss_u 0.9976 (0.9816) acc_u 0.0000 (1.8750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [10/14] time 0.299 (0.304) data 0.251 (0.256) loss_u loss_u 0.9946 (0.9741) acc_u 0.0000 (2.5000) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 295
confident_label rate tensor(0.3737, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 281
clean true:238
clean false:43
clean_rate:0.8469750889679716
noisy true:219
noisy false:252
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 471
epoch [127/200] batch [5/8] time 0.316 (0.286) data 0.268 (0.239) loss_x loss_x 0.1522 (0.1978) acc_x 96.8750 (93.7500) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/14] time 0.294 (0.295) data 0.245 (0.247) loss_u loss_u 0.9697 (0.9621) acc_u 3.1250 (3.7500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [10/14] time 0.306 (0.295) data 0.258 (0.247) loss_u loss_u 0.9424 (0.9620) acc_u 6.2500 (3.7500) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:232
clean false:41
clean_rate:0.8498168498168498
noisy true:226
noisy false:253
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [128/200] batch [5/8] time 0.306 (0.298) data 0.258 (0.250) loss_x loss_x 0.2307 (0.1572) acc_x 96.8750 (97.5000) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/14] time 0.283 (0.293) data 0.235 (0.245) loss_u loss_u 0.9321 (0.9450) acc_u 6.2500 (5.0000) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [10/14] time 0.288 (0.299) data 0.240 (0.251) loss_u loss_u 0.9639 (0.9538) acc_u 3.1250 (4.3750) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:241
clean false:44
clean_rate:0.8456140350877193
noisy true:225
noisy false:242
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [129/200] batch [5/8] time 0.299 (0.300) data 0.251 (0.252) loss_x loss_x 0.0986 (0.3086) acc_x 100.0000 (95.0000) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/14] time 0.317 (0.304) data 0.269 (0.256) loss_u loss_u 0.9819 (0.9733) acc_u 3.1250 (3.1250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/14] time 0.303 (0.302) data 0.255 (0.253) loss_u loss_u 0.9253 (0.9699) acc_u 9.3750 (3.4375) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:234
clean false:43
clean_rate:0.8447653429602888
noisy true:229
noisy false:246
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [130/200] batch [5/8] time 0.316 (0.284) data 0.268 (0.236) loss_x loss_x 0.1516 (0.1852) acc_x 100.0000 (98.1250) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/14] time 0.316 (0.294) data 0.268 (0.246) loss_u loss_u 0.9517 (0.9518) acc_u 6.2500 (5.6250) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [10/14] time 0.292 (0.295) data 0.244 (0.247) loss_u loss_u 0.9785 (0.9662) acc_u 3.1250 (3.7500) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:235
clean false:41
clean_rate:0.8514492753623188
noisy true:225
noisy false:251
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [131/200] batch [5/8] time 0.324 (0.289) data 0.276 (0.241) loss_x loss_x 0.1267 (0.2039) acc_x 100.0000 (95.6250) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/14] time 0.317 (0.301) data 0.269 (0.253) loss_u loss_u 0.9443 (0.9659) acc_u 6.2500 (3.1250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/14] time 0.320 (0.309) data 0.272 (0.260) loss_u loss_u 0.9507 (0.9629) acc_u 6.2500 (3.7500) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3723, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 280
clean true:238
clean false:42
clean_rate:0.85
noisy true:229
noisy false:243
after delete: len(clean_dataset) 280
after delete: len(noisy_dataset) 472
epoch [132/200] batch [5/8] time 0.278 (0.283) data 0.229 (0.235) loss_x loss_x 0.1981 (0.1796) acc_x 96.8750 (97.5000) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/14] time 0.287 (0.303) data 0.238 (0.255) loss_u loss_u 0.9395 (0.9563) acc_u 6.2500 (4.3750) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/14] time 0.306 (0.303) data 0.258 (0.255) loss_u loss_u 0.9937 (0.9656) acc_u 0.0000 (3.4375) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3604, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 271
clean true:228
clean false:43
clean_rate:0.8413284132841329
noisy true:235
noisy false:246
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 481
epoch [133/200] batch [5/8] time 0.266 (0.291) data 0.218 (0.243) loss_x loss_x 0.2098 (0.1992) acc_x 96.8750 (95.6250) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/15] time 0.274 (0.299) data 0.226 (0.250) loss_u loss_u 0.9438 (0.9469) acc_u 6.2500 (5.6250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/15] time 0.273 (0.297) data 0.225 (0.249) loss_u loss_u 0.9512 (0.9470) acc_u 3.1250 (5.3125) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [15/15] time 0.307 (0.299) data 0.259 (0.251) loss_u loss_u 0.9429 (0.9476) acc_u 6.2500 (5.2083) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 291
confident_label rate tensor(0.3737, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 281
clean true:240
clean false:41
clean_rate:0.8540925266903915
noisy true:221
noisy false:250
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 471
epoch [134/200] batch [5/8] time 0.265 (0.296) data 0.217 (0.248) loss_x loss_x 0.1854 (0.1583) acc_x 100.0000 (97.5000) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/14] time 0.313 (0.304) data 0.265 (0.256) loss_u loss_u 0.9487 (0.9671) acc_u 6.2500 (4.3750) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/14] time 0.296 (0.298) data 0.248 (0.250) loss_u loss_u 0.9932 (0.9758) acc_u 0.0000 (2.8125) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 296
confident_label rate tensor(0.3723, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 280
clean true:234
clean false:46
clean_rate:0.8357142857142857
noisy true:222
noisy false:250
after delete: len(clean_dataset) 280
after delete: len(noisy_dataset) 472
epoch [135/200] batch [5/8] time 0.322 (0.313) data 0.275 (0.265) loss_x loss_x 0.2791 (0.1604) acc_x 96.8750 (97.5000) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/14] time 0.302 (0.296) data 0.254 (0.248) loss_u loss_u 0.9980 (0.9382) acc_u 0.0000 (6.8750) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [10/14] time 0.296 (0.300) data 0.248 (0.251) loss_u loss_u 0.9907 (0.9500) acc_u 3.1250 (5.9375) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3723, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 280
clean true:238
clean false:42
clean_rate:0.85
noisy true:232
noisy false:240
after delete: len(clean_dataset) 280
after delete: len(noisy_dataset) 472
epoch [136/200] batch [5/8] time 0.294 (0.297) data 0.246 (0.249) loss_x loss_x 0.0851 (0.1414) acc_x 100.0000 (98.1250) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/14] time 0.298 (0.296) data 0.250 (0.247) loss_u loss_u 0.9160 (0.9500) acc_u 9.3750 (6.2500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [10/14] time 0.291 (0.296) data 0.243 (0.248) loss_u loss_u 0.9702 (0.9567) acc_u 3.1250 (5.3125) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 279
confident_label rate tensor(0.3763, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 283
clean true:243
clean false:40
clean_rate:0.8586572438162544
noisy true:230
noisy false:239
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 469
epoch [137/200] batch [5/8] time 0.310 (0.301) data 0.262 (0.253) loss_x loss_x 0.1694 (0.2118) acc_x 100.0000 (98.7500) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/14] time 0.317 (0.300) data 0.269 (0.252) loss_u loss_u 0.9692 (0.9523) acc_u 3.1250 (5.6250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/14] time 0.309 (0.299) data 0.261 (0.251) loss_u loss_u 0.9736 (0.9634) acc_u 3.1250 (4.0625) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3763, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 283
clean true:239
clean false:44
clean_rate:0.8445229681978799
noisy true:230
noisy false:239
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 469
epoch [138/200] batch [5/8] time 0.302 (0.300) data 0.254 (0.252) loss_x loss_x 0.1615 (0.1309) acc_x 96.8750 (99.3750) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/14] time 0.317 (0.296) data 0.269 (0.248) loss_u loss_u 0.9736 (0.9728) acc_u 3.1250 (3.1250) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/14] time 0.319 (0.300) data 0.270 (0.252) loss_u loss_u 0.9990 (0.9701) acc_u 0.0000 (3.1250) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 277
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:241
clean false:36
clean_rate:0.8700361010830325
noisy true:234
noisy false:241
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [139/200] batch [5/8] time 0.309 (0.304) data 0.261 (0.255) loss_x loss_x 0.1438 (0.2267) acc_x 100.0000 (95.6250) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/14] time 0.298 (0.305) data 0.250 (0.257) loss_u loss_u 0.9453 (0.9523) acc_u 6.2500 (6.2500) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [10/14] time 0.287 (0.300) data 0.238 (0.252) loss_u loss_u 0.9185 (0.9551) acc_u 9.3750 (5.3125) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:234
clean false:43
clean_rate:0.8447653429602888
noisy true:228
noisy false:247
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [140/200] batch [5/8] time 0.303 (0.295) data 0.256 (0.247) loss_x loss_x 0.1537 (0.1692) acc_x 100.0000 (97.5000) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/14] time 0.287 (0.300) data 0.238 (0.252) loss_u loss_u 0.9976 (0.9549) acc_u 0.0000 (5.0000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/14] time 0.301 (0.300) data 0.253 (0.252) loss_u loss_u 0.9341 (0.9628) acc_u 6.2500 (3.7500) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3816, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 287
clean true:244
clean false:43
clean_rate:0.8501742160278746
noisy true:223
noisy false:242
after delete: len(clean_dataset) 287
after delete: len(noisy_dataset) 465
epoch [141/200] batch [5/8] time 0.292 (0.274) data 0.244 (0.226) loss_x loss_x 0.3499 (0.2399) acc_x 87.5000 (94.3750) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/14] time 0.317 (0.293) data 0.269 (0.245) loss_u loss_u 0.9536 (0.9580) acc_u 9.3750 (5.6250) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [10/14] time 0.302 (0.295) data 0.254 (0.247) loss_u loss_u 0.9966 (0.9668) acc_u 0.0000 (4.0625) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 284
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 288
clean true:244
clean false:44
clean_rate:0.8472222222222222
noisy true:224
noisy false:240
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 464
epoch [142/200] batch [5/9] time 0.291 (0.278) data 0.243 (0.230) loss_x loss_x 0.0706 (0.2725) acc_x 100.0000 (94.3750) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [5/14] time 0.298 (0.295) data 0.249 (0.247) loss_u loss_u 0.9033 (0.9663) acc_u 12.5000 (3.7500) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [10/14] time 0.289 (0.296) data 0.241 (0.248) loss_u loss_u 0.9692 (0.9649) acc_u 3.1250 (3.7500) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3723, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 280
clean true:238
clean false:42
clean_rate:0.85
noisy true:225
noisy false:247
after delete: len(clean_dataset) 280
after delete: len(noisy_dataset) 472
epoch [143/200] batch [5/8] time 0.294 (0.291) data 0.246 (0.243) loss_x loss_x 0.2642 (0.1939) acc_x 93.7500 (95.0000) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/14] time 0.326 (0.293) data 0.278 (0.244) loss_u loss_u 0.9561 (0.9597) acc_u 6.2500 (4.3750) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/14] time 0.262 (0.298) data 0.214 (0.250) loss_u loss_u 0.9951 (0.9581) acc_u 0.0000 (4.6875) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 282
clean true:240
clean false:42
clean_rate:0.851063829787234
noisy true:222
noisy false:248
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 470
epoch [144/200] batch [5/8] time 0.270 (0.287) data 0.222 (0.239) loss_x loss_x 0.3813 (0.1976) acc_x 87.5000 (95.6250) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/14] time 0.265 (0.290) data 0.217 (0.242) loss_u loss_u 0.9746 (0.9596) acc_u 3.1250 (4.3750) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/14] time 0.330 (0.290) data 0.282 (0.242) loss_u loss_u 0.9883 (0.9640) acc_u 0.0000 (3.7500) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:240
clean false:45
clean_rate:0.8421052631578947
noisy true:225
noisy false:242
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [145/200] batch [5/8] time 0.265 (0.300) data 0.216 (0.251) loss_x loss_x 0.1587 (0.1586) acc_x 96.8750 (96.2500) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/14] time 0.290 (0.300) data 0.242 (0.251) loss_u loss_u 0.9966 (0.9571) acc_u 0.0000 (5.6250) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/14] time 0.265 (0.297) data 0.216 (0.248) loss_u loss_u 0.9800 (0.9650) acc_u 3.1250 (4.3750) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:237
clean false:40
clean_rate:0.855595667870036
noisy true:228
noisy false:247
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [146/200] batch [5/8] time 0.318 (0.310) data 0.270 (0.262) loss_x loss_x 0.0754 (0.1524) acc_x 100.0000 (95.6250) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/14] time 0.281 (0.298) data 0.232 (0.250) loss_u loss_u 0.9497 (0.9683) acc_u 6.2500 (3.1250) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/14] time 0.301 (0.297) data 0.253 (0.249) loss_u loss_u 0.9834 (0.9642) acc_u 0.0000 (3.4375) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 291
confident_label rate tensor(0.3816, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 287
clean true:240
clean false:47
clean_rate:0.8362369337979094
noisy true:221
noisy false:244
after delete: len(clean_dataset) 287
after delete: len(noisy_dataset) 465
epoch [147/200] batch [5/8] time 0.318 (0.299) data 0.271 (0.251) loss_x loss_x 0.0959 (0.1923) acc_x 96.8750 (95.6250) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/14] time 0.286 (0.293) data 0.237 (0.245) loss_u loss_u 0.9443 (0.9505) acc_u 6.2500 (5.6250) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/14] time 0.330 (0.295) data 0.282 (0.247) loss_u loss_u 0.9683 (0.9624) acc_u 3.1250 (4.3750) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 280
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:240
clean false:45
clean_rate:0.8421052631578947
noisy true:232
noisy false:235
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [148/200] batch [5/8] time 0.299 (0.303) data 0.251 (0.254) loss_x loss_x 0.4358 (0.2174) acc_x 87.5000 (95.6250) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/14] time 0.302 (0.302) data 0.254 (0.253) loss_u loss_u 0.9644 (0.9632) acc_u 3.1250 (3.1250) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [10/14] time 0.306 (0.304) data 0.258 (0.255) loss_u loss_u 0.9341 (0.9707) acc_u 6.2500 (2.8125) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 280
confident_label rate tensor(0.3763, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 283
clean true:241
clean false:42
clean_rate:0.8515901060070671
noisy true:231
noisy false:238
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 469
epoch [149/200] batch [5/8] time 0.266 (0.284) data 0.218 (0.236) loss_x loss_x 0.1311 (0.1255) acc_x 96.8750 (98.7500) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/14] time 0.285 (0.295) data 0.238 (0.247) loss_u loss_u 0.9614 (0.9621) acc_u 3.1250 (3.7500) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [10/14] time 0.272 (0.300) data 0.223 (0.252) loss_u loss_u 0.9658 (0.9608) acc_u 3.1250 (4.0625) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3777, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 284
clean true:242
clean false:42
clean_rate:0.852112676056338
noisy true:223
noisy false:245
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 468
epoch [150/200] batch [5/8] time 0.296 (0.300) data 0.249 (0.252) loss_x loss_x 0.3254 (0.1797) acc_x 93.7500 (98.1250) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/14] time 0.278 (0.295) data 0.230 (0.247) loss_u loss_u 0.9712 (0.9677) acc_u 3.1250 (3.7500) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/14] time 0.293 (0.296) data 0.245 (0.248) loss_u loss_u 0.9951 (0.9636) acc_u 0.0000 (4.0625) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 278
confident_label rate tensor(0.3856, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 290
clean true:243
clean false:47
clean_rate:0.8379310344827586
noisy true:231
noisy false:231
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 462
epoch [151/200] batch [5/9] time 0.264 (0.303) data 0.215 (0.255) loss_x loss_x 0.2988 (0.1920) acc_x 90.6250 (95.6250) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [5/14] time 0.265 (0.298) data 0.216 (0.250) loss_u loss_u 0.9668 (0.9608) acc_u 3.1250 (3.7500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [10/14] time 0.297 (0.301) data 0.249 (0.253) loss_u loss_u 0.9971 (0.9669) acc_u 0.0000 (3.1250) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 279
confident_label rate tensor(0.3697, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 278
clean true:231
clean false:47
clean_rate:0.8309352517985612
noisy true:242
noisy false:232
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 474
epoch [152/200] batch [5/8] time 0.310 (0.297) data 0.262 (0.250) loss_x loss_x 0.1523 (0.1374) acc_x 100.0000 (98.7500) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/14] time 0.265 (0.290) data 0.217 (0.242) loss_u loss_u 0.9395 (0.9481) acc_u 6.2500 (6.2500) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [10/14] time 0.306 (0.293) data 0.258 (0.245) loss_u loss_u 0.9126 (0.9515) acc_u 9.3750 (5.3125) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 280
confident_label rate tensor(0.3763, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 283
clean true:241
clean false:42
clean_rate:0.8515901060070671
noisy true:231
noisy false:238
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 469
epoch [153/200] batch [5/8] time 0.274 (0.289) data 0.226 (0.241) loss_x loss_x 0.2111 (0.2473) acc_x 93.7500 (93.1250) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/14] time 0.300 (0.299) data 0.251 (0.250) loss_u loss_u 0.9189 (0.9436) acc_u 9.3750 (6.8750) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/14] time 0.321 (0.297) data 0.273 (0.248) loss_u loss_u 0.9531 (0.9512) acc_u 3.1250 (5.9375) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 270
confident_label rate tensor(0.3816, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 287
clean true:243
clean false:44
clean_rate:0.8466898954703833
noisy true:239
noisy false:226
after delete: len(clean_dataset) 287
after delete: len(noisy_dataset) 465
epoch [154/200] batch [5/8] time 0.277 (0.283) data 0.230 (0.235) loss_x loss_x 0.2272 (0.2765) acc_x 90.6250 (91.8750) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/14] time 0.321 (0.297) data 0.273 (0.249) loss_u loss_u 0.9624 (0.9596) acc_u 3.1250 (3.7500) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [10/14] time 0.324 (0.299) data 0.276 (0.251) loss_u loss_u 0.9404 (0.9653) acc_u 6.2500 (3.4375) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 275
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 288
clean true:241
clean false:47
clean_rate:0.8368055555555556
noisy true:236
noisy false:228
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 464
epoch [155/200] batch [5/9] time 0.290 (0.281) data 0.243 (0.233) loss_x loss_x 0.2664 (0.1583) acc_x 93.7500 (97.5000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [5/14] time 0.304 (0.298) data 0.255 (0.250) loss_u loss_u 0.9976 (0.9701) acc_u 0.0000 (3.1250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/14] time 0.303 (0.296) data 0.255 (0.248) loss_u loss_u 0.9419 (0.9653) acc_u 6.2500 (4.0625) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 288
clean true:241
clean false:47
clean_rate:0.8368055555555556
noisy true:222
noisy false:242
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 464
epoch [156/200] batch [5/9] time 0.302 (0.280) data 0.254 (0.230) loss_x loss_x 0.0797 (0.1822) acc_x 100.0000 (96.8750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [5/14] time 0.332 (0.297) data 0.282 (0.248) loss_u loss_u 0.9307 (0.9771) acc_u 9.3750 (3.1250) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [10/14] time 0.298 (0.299) data 0.250 (0.250) loss_u loss_u 0.9995 (0.9708) acc_u 0.0000 (3.4375) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 281
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 282
clean true:241
clean false:41
clean_rate:0.8546099290780141
noisy true:230
noisy false:240
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 470
epoch [157/200] batch [5/8] time 0.243 (0.286) data 0.196 (0.238) loss_x loss_x 0.1036 (0.1849) acc_x 100.0000 (98.1250) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/14] time 0.297 (0.289) data 0.249 (0.241) loss_u loss_u 0.9111 (0.9528) acc_u 9.3750 (4.3750) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/14] time 0.317 (0.293) data 0.269 (0.245) loss_u loss_u 0.9277 (0.9547) acc_u 9.3750 (4.6875) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3843, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 289
clean true:246
clean false:43
clean_rate:0.8512110726643599
noisy true:219
noisy false:244
after delete: len(clean_dataset) 289
after delete: len(noisy_dataset) 463
epoch [158/200] batch [5/9] time 0.263 (0.304) data 0.215 (0.256) loss_x loss_x 0.1747 (0.1296) acc_x 93.7500 (97.5000) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [5/14] time 0.307 (0.297) data 0.259 (0.248) loss_u loss_u 0.9932 (0.9769) acc_u 0.0000 (1.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/14] time 0.312 (0.300) data 0.263 (0.251) loss_u loss_u 0.9971 (0.9783) acc_u 0.0000 (2.1875) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 280
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 288
clean true:244
clean false:44
clean_rate:0.8472222222222222
noisy true:228
noisy false:236
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 464
epoch [159/200] batch [5/9] time 0.323 (0.297) data 0.275 (0.249) loss_x loss_x 0.0831 (0.1400) acc_x 100.0000 (98.7500) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [5/14] time 0.309 (0.300) data 0.260 (0.252) loss_u loss_u 0.9419 (0.9650) acc_u 6.2500 (4.3750) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/14] time 0.282 (0.297) data 0.233 (0.248) loss_u loss_u 0.9365 (0.9651) acc_u 6.2500 (3.7500) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3816, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 287
clean true:244
clean false:43
clean_rate:0.8501742160278746
noisy true:225
noisy false:240
after delete: len(clean_dataset) 287
after delete: len(noisy_dataset) 465
epoch [160/200] batch [5/8] time 0.325 (0.320) data 0.277 (0.272) loss_x loss_x 0.1147 (0.1364) acc_x 100.0000 (98.1250) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/14] time 0.272 (0.302) data 0.224 (0.254) loss_u loss_u 0.9014 (0.9475) acc_u 9.3750 (5.6250) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [10/14] time 0.288 (0.300) data 0.239 (0.252) loss_u loss_u 0.9971 (0.9627) acc_u 0.0000 (4.0625) lr 2.0984e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 293
confident_label rate tensor(0.3803, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 286
clean true:241
clean false:45
clean_rate:0.8426573426573427
noisy true:218
noisy false:248
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 466
epoch [161/200] batch [5/8] time 0.283 (0.308) data 0.234 (0.260) loss_x loss_x 0.1632 (0.2350) acc_x 100.0000 (96.8750) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/14] time 0.329 (0.292) data 0.280 (0.244) loss_u loss_u 0.9058 (0.9609) acc_u 9.3750 (3.7500) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/14] time 0.306 (0.296) data 0.258 (0.248) loss_u loss_u 0.9453 (0.9661) acc_u 6.2500 (3.4375) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 281
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:241
clean false:44
clean_rate:0.8456140350877193
noisy true:230
noisy false:237
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [162/200] batch [5/8] time 0.295 (0.319) data 0.247 (0.271) loss_x loss_x 0.1050 (0.1607) acc_x 100.0000 (96.2500) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/14] time 0.303 (0.301) data 0.255 (0.253) loss_u loss_u 0.9961 (0.9640) acc_u 0.0000 (4.3750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/14] time 0.285 (0.300) data 0.236 (0.252) loss_u loss_u 0.9951 (0.9634) acc_u 0.0000 (4.3750) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 279
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 288
clean true:244
clean false:44
clean_rate:0.8472222222222222
noisy true:229
noisy false:235
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 464
epoch [163/200] batch [5/9] time 0.302 (0.309) data 0.255 (0.261) loss_x loss_x 0.1470 (0.2125) acc_x 93.7500 (95.0000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [5/14] time 0.292 (0.296) data 0.243 (0.248) loss_u loss_u 0.9023 (0.9521) acc_u 9.3750 (5.0000) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/14] time 0.256 (0.299) data 0.208 (0.250) loss_u loss_u 0.8862 (0.9550) acc_u 12.5000 (5.0000) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 281
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:244
clean false:41
clean_rate:0.856140350877193
noisy true:227
noisy false:240
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [164/200] batch [5/8] time 0.311 (0.284) data 0.263 (0.236) loss_x loss_x 0.0913 (0.1942) acc_x 96.8750 (94.3750) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/14] time 0.314 (0.295) data 0.266 (0.247) loss_u loss_u 0.9746 (0.9574) acc_u 3.1250 (4.3750) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [10/14] time 0.300 (0.295) data 0.251 (0.247) loss_u loss_u 0.9854 (0.9657) acc_u 3.1250 (3.4375) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 297
confident_label rate tensor(0.3803, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 286
clean true:239
clean false:47
clean_rate:0.8356643356643356
noisy true:216
noisy false:250
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 466
epoch [165/200] batch [5/8] time 0.302 (0.309) data 0.254 (0.261) loss_x loss_x 0.0952 (0.1822) acc_x 100.0000 (95.0000) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/14] time 0.261 (0.289) data 0.213 (0.240) loss_u loss_u 0.9980 (0.9728) acc_u 0.0000 (2.5000) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/14] time 0.296 (0.294) data 0.248 (0.246) loss_u loss_u 0.9321 (0.9646) acc_u 6.2500 (3.4375) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 293
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:241
clean false:44
clean_rate:0.8456140350877193
noisy true:218
noisy false:249
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [166/200] batch [5/8] time 0.309 (0.295) data 0.262 (0.247) loss_x loss_x 0.0944 (0.1077) acc_x 100.0000 (99.3750) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/14] time 0.300 (0.304) data 0.251 (0.256) loss_u loss_u 0.9961 (0.9523) acc_u 0.0000 (5.0000) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [10/14] time 0.303 (0.304) data 0.255 (0.255) loss_u loss_u 0.9663 (0.9543) acc_u 3.1250 (4.6875) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 304
confident_label rate tensor(0.3910, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 294
clean true:242
clean false:52
clean_rate:0.8231292517006803
noisy true:206
noisy false:252
after delete: len(clean_dataset) 294
after delete: len(noisy_dataset) 458
epoch [167/200] batch [5/9] time 0.281 (0.292) data 0.233 (0.243) loss_x loss_x 0.2180 (0.3023) acc_x 93.7500 (95.0000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [5/14] time 0.329 (0.302) data 0.280 (0.254) loss_u loss_u 0.9312 (0.9716) acc_u 6.2500 (2.5000) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [10/14] time 0.270 (0.296) data 0.222 (0.248) loss_u loss_u 0.9868 (0.9784) acc_u 0.0000 (1.8750) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:237
clean false:39
clean_rate:0.8586956521739131
noisy true:229
noisy false:247
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [168/200] batch [5/8] time 0.246 (0.296) data 0.199 (0.248) loss_x loss_x 0.2125 (0.1507) acc_x 96.8750 (98.7500) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/14] time 0.322 (0.294) data 0.273 (0.246) loss_u loss_u 0.9985 (0.9503) acc_u 0.0000 (5.0000) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/14] time 0.317 (0.296) data 0.268 (0.248) loss_u loss_u 0.9419 (0.9554) acc_u 6.2500 (4.6875) lr 1.3926e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 299
confident_label rate tensor(0.3763, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 283
clean true:235
clean false:48
clean_rate:0.8303886925795053
noisy true:218
noisy false:251
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 469
epoch [169/200] batch [5/8] time 0.276 (0.307) data 0.228 (0.259) loss_x loss_x 0.3430 (0.2383) acc_x 96.8750 (94.3750) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/14] time 0.312 (0.298) data 0.264 (0.250) loss_u loss_u 0.9185 (0.9577) acc_u 9.3750 (4.3750) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/14] time 0.299 (0.297) data 0.251 (0.249) loss_u loss_u 0.8726 (0.9426) acc_u 15.6250 (6.5625) lr 1.3137e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3777, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 284
clean true:240
clean false:44
clean_rate:0.8450704225352113
noisy true:230
noisy false:238
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 468
epoch [170/200] batch [5/8] time 0.279 (0.289) data 0.231 (0.241) loss_x loss_x 0.4104 (0.2797) acc_x 87.5000 (93.1250) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/14] time 0.315 (0.292) data 0.267 (0.244) loss_u loss_u 0.9985 (0.9589) acc_u 0.0000 (4.3750) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/14] time 0.313 (0.296) data 0.264 (0.248) loss_u loss_u 0.9370 (0.9542) acc_u 6.2500 (5.0000) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 277
confident_label rate tensor(0.3816, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 287
clean true:244
clean false:43
clean_rate:0.8501742160278746
noisy true:231
noisy false:234
after delete: len(clean_dataset) 287
after delete: len(noisy_dataset) 465
epoch [171/200] batch [5/8] time 0.285 (0.294) data 0.237 (0.246) loss_x loss_x 0.2876 (0.2072) acc_x 90.6250 (95.6250) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/14] time 0.342 (0.303) data 0.290 (0.255) loss_u loss_u 0.9609 (0.9771) acc_u 3.1250 (1.8750) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/14] time 0.309 (0.303) data 0.260 (0.255) loss_u loss_u 0.9976 (0.9724) acc_u 0.0000 (3.1250) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3856, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 290
clean true:243
clean false:47
clean_rate:0.8379310344827586
noisy true:226
noisy false:236
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 462
epoch [172/200] batch [5/9] time 0.326 (0.315) data 0.278 (0.267) loss_x loss_x 0.1763 (0.1452) acc_x 96.8750 (98.1250) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [5/14] time 0.385 (0.313) data 0.337 (0.265) loss_u loss_u 0.9683 (0.9722) acc_u 3.1250 (3.1250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/14] time 0.268 (0.309) data 0.220 (0.260) loss_u loss_u 0.9995 (0.9743) acc_u 0.0000 (2.8125) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3763, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 283
clean true:235
clean false:48
clean_rate:0.8303886925795053
noisy true:223
noisy false:246
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 469
epoch [173/200] batch [5/8] time 0.330 (0.284) data 0.282 (0.236) loss_x loss_x 0.1985 (0.2300) acc_x 96.8750 (94.3750) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/14] time 0.301 (0.293) data 0.253 (0.245) loss_u loss_u 0.9463 (0.9613) acc_u 6.2500 (3.7500) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/14] time 0.301 (0.296) data 0.253 (0.248) loss_u loss_u 0.9644 (0.9580) acc_u 3.1250 (4.3750) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3856, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 290
clean true:242
clean false:48
clean_rate:0.8344827586206897
noisy true:224
noisy false:238
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 462
epoch [174/200] batch [5/9] time 0.322 (0.300) data 0.274 (0.252) loss_x loss_x 0.1405 (0.1680) acc_x 96.8750 (95.0000) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [5/14] time 0.317 (0.296) data 0.268 (0.247) loss_u loss_u 0.9990 (0.9739) acc_u 0.0000 (3.1250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/14] time 0.306 (0.298) data 0.256 (0.249) loss_u loss_u 0.9683 (0.9731) acc_u 3.1250 (3.1250) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3870, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 291
clean true:244
clean false:47
clean_rate:0.8384879725085911
noisy true:223
noisy false:238
after delete: len(clean_dataset) 291
after delete: len(noisy_dataset) 461
epoch [175/200] batch [5/9] time 0.316 (0.316) data 0.268 (0.268) loss_x loss_x 0.1268 (0.1911) acc_x 96.8750 (95.6250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [5/14] time 0.292 (0.298) data 0.243 (0.249) loss_u loss_u 0.9404 (0.9675) acc_u 6.2500 (4.3750) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/14] time 0.282 (0.300) data 0.233 (0.252) loss_u loss_u 0.9668 (0.9711) acc_u 3.1250 (3.4375) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 278
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 288
clean true:243
clean false:45
clean_rate:0.84375
noisy true:231
noisy false:233
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 464
epoch [176/200] batch [5/9] time 0.298 (0.312) data 0.249 (0.263) loss_x loss_x 0.2090 (0.1552) acc_x 93.7500 (96.2500) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [5/14] time 0.295 (0.296) data 0.247 (0.247) loss_u loss_u 0.9272 (0.9727) acc_u 9.3750 (3.1250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/14] time 0.304 (0.299) data 0.256 (0.250) loss_u loss_u 0.9736 (0.9702) acc_u 3.1250 (3.4375) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 272
confident_label rate tensor(0.3803, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 286
clean true:244
clean false:42
clean_rate:0.8531468531468531
noisy true:236
noisy false:230
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 466
epoch [177/200] batch [5/8] time 0.336 (0.320) data 0.288 (0.272) loss_x loss_x 0.1527 (0.1574) acc_x 96.8750 (97.5000) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/14] time 0.267 (0.296) data 0.219 (0.248) loss_u loss_u 0.9600 (0.9626) acc_u 6.2500 (5.0000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/14] time 0.330 (0.299) data 0.282 (0.251) loss_u loss_u 0.9121 (0.9570) acc_u 12.5000 (5.3125) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 302
confident_label rate tensor(0.3777, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 284
clean true:237
clean false:47
clean_rate:0.8345070422535211
noisy true:213
noisy false:255
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 468
epoch [178/200] batch [5/8] time 0.286 (0.298) data 0.237 (0.250) loss_x loss_x 0.1884 (0.2394) acc_x 100.0000 (96.8750) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/14] time 0.306 (0.297) data 0.258 (0.248) loss_u loss_u 0.9658 (0.9704) acc_u 3.1250 (3.1250) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/14] time 0.281 (0.301) data 0.233 (0.253) loss_u loss_u 0.9673 (0.9553) acc_u 3.1250 (4.6875) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3870, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 291
clean true:246
clean false:45
clean_rate:0.845360824742268
noisy true:218
noisy false:243
after delete: len(clean_dataset) 291
after delete: len(noisy_dataset) 461
epoch [179/200] batch [5/9] time 0.298 (0.298) data 0.251 (0.251) loss_x loss_x 0.1704 (0.1355) acc_x 93.7500 (96.8750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [5/14] time 0.318 (0.296) data 0.270 (0.248) loss_u loss_u 0.9302 (0.9605) acc_u 6.2500 (4.3750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/14] time 0.312 (0.298) data 0.263 (0.250) loss_u loss_u 0.9976 (0.9677) acc_u 0.0000 (3.4375) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3777, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 284
clean true:240
clean false:44
clean_rate:0.8450704225352113
noisy true:218
noisy false:250
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 468
epoch [180/200] batch [5/8] time 0.295 (0.300) data 0.247 (0.252) loss_x loss_x 0.0627 (0.1539) acc_x 100.0000 (95.0000) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/14] time 0.330 (0.297) data 0.282 (0.248) loss_u loss_u 0.9653 (0.9390) acc_u 3.1250 (5.6250) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/14] time 0.301 (0.299) data 0.252 (0.251) loss_u loss_u 0.9360 (0.9506) acc_u 6.2500 (5.0000) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:239
clean false:46
clean_rate:0.8385964912280702
noisy true:231
noisy false:236
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [181/200] batch [5/8] time 0.281 (0.289) data 0.233 (0.241) loss_x loss_x 0.1746 (0.1600) acc_x 96.8750 (98.1250) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/14] time 0.301 (0.300) data 0.252 (0.251) loss_u loss_u 0.9336 (0.9608) acc_u 6.2500 (3.7500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/14] time 0.323 (0.301) data 0.275 (0.252) loss_u loss_u 0.9355 (0.9598) acc_u 6.2500 (4.0625) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3883, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 292
clean true:245
clean false:47
clean_rate:0.839041095890411
noisy true:215
noisy false:245
after delete: len(clean_dataset) 292
after delete: len(noisy_dataset) 460
epoch [182/200] batch [5/9] time 0.292 (0.295) data 0.244 (0.246) loss_x loss_x 0.4934 (0.2508) acc_x 90.6250 (96.2500) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [5/14] time 0.314 (0.298) data 0.266 (0.250) loss_u loss_u 0.9634 (0.9688) acc_u 3.1250 (3.1250) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/14] time 0.305 (0.298) data 0.257 (0.249) loss_u loss_u 0.9639 (0.9676) acc_u 3.1250 (3.1250) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3777, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 284
clean true:235
clean false:49
clean_rate:0.8274647887323944
noisy true:227
noisy false:241
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 468
epoch [183/200] batch [5/8] time 0.294 (0.309) data 0.246 (0.260) loss_x loss_x 0.1261 (0.1138) acc_x 96.8750 (98.7500) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/14] time 0.287 (0.299) data 0.238 (0.250) loss_u loss_u 0.9990 (0.9646) acc_u 0.0000 (3.7500) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/14] time 0.283 (0.302) data 0.235 (0.253) loss_u loss_u 0.9404 (0.9607) acc_u 6.2500 (4.3750) lr 4.4207e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 291
confident_label rate tensor(0.3816, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 287
clean true:241
clean false:46
clean_rate:0.8397212543554007
noisy true:220
noisy false:245
after delete: len(clean_dataset) 287
after delete: len(noisy_dataset) 465
epoch [184/200] batch [5/8] time 0.306 (0.307) data 0.256 (0.259) loss_x loss_x 0.1215 (0.1480) acc_x 96.8750 (96.8750) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/14] time 0.285 (0.296) data 0.237 (0.247) loss_u loss_u 0.9663 (0.9689) acc_u 3.1250 (3.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/14] time 0.302 (0.298) data 0.254 (0.250) loss_u loss_u 0.9648 (0.9583) acc_u 3.1250 (4.0625) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 293
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 288
clean true:242
clean false:46
clean_rate:0.8402777777777778
noisy true:217
noisy false:247
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 464
epoch [185/200] batch [5/9] time 0.276 (0.299) data 0.228 (0.251) loss_x loss_x 0.2217 (0.1908) acc_x 96.8750 (95.6250) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [5/14] time 0.303 (0.300) data 0.254 (0.252) loss_u loss_u 0.9663 (0.9556) acc_u 3.1250 (4.3750) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [10/14] time 0.289 (0.299) data 0.240 (0.251) loss_u loss_u 0.9990 (0.9588) acc_u 0.0000 (3.7500) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 301
confident_label rate tensor(0.3710, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 279
clean true:234
clean false:45
clean_rate:0.8387096774193549
noisy true:217
noisy false:256
after delete: len(clean_dataset) 279
after delete: len(noisy_dataset) 473
epoch [186/200] batch [5/8] time 0.294 (0.300) data 0.247 (0.252) loss_x loss_x 0.2078 (0.2485) acc_x 96.8750 (94.3750) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/14] time 0.361 (0.300) data 0.311 (0.252) loss_u loss_u 0.9399 (0.9497) acc_u 6.2500 (5.6250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/14] time 0.288 (0.300) data 0.239 (0.252) loss_u loss_u 0.9360 (0.9444) acc_u 6.2500 (5.9375) lr 3.1417e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 275
confident_label rate tensor(0.3856, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 290
clean true:243
clean false:47
clean_rate:0.8379310344827586
noisy true:234
noisy false:228
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 462
epoch [187/200] batch [5/9] time 0.274 (0.324) data 0.225 (0.275) loss_x loss_x 0.1333 (0.1667) acc_x 96.8750 (96.2500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [5/14] time 0.279 (0.307) data 0.229 (0.259) loss_u loss_u 0.9995 (0.9660) acc_u 0.0000 (3.7500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/14] time 0.317 (0.307) data 0.269 (0.258) loss_u loss_u 0.9507 (0.9703) acc_u 6.2500 (3.1250) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 288
clean true:239
clean false:49
clean_rate:0.8298611111111112
noisy true:223
noisy false:241
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 464
epoch [188/200] batch [5/9] time 0.327 (0.312) data 0.279 (0.265) loss_x loss_x 0.1494 (0.2599) acc_x 96.8750 (92.5000) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [5/14] time 0.313 (0.300) data 0.264 (0.252) loss_u loss_u 0.9648 (0.9420) acc_u 3.1250 (5.6250) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/14] time 0.301 (0.298) data 0.252 (0.249) loss_u loss_u 0.9902 (0.9656) acc_u 3.1250 (3.7500) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3883, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 292
clean true:244
clean false:48
clean_rate:0.8356164383561644
noisy true:218
noisy false:242
after delete: len(clean_dataset) 292
after delete: len(noisy_dataset) 460
epoch [189/200] batch [5/9] time 0.316 (0.319) data 0.268 (0.270) loss_x loss_x 0.1716 (0.1662) acc_x 96.8750 (97.5000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [5/14] time 0.289 (0.313) data 0.241 (0.264) loss_u loss_u 0.9941 (0.9796) acc_u 0.0000 (1.8750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/14] time 0.327 (0.318) data 0.279 (0.269) loss_u loss_u 0.9985 (0.9706) acc_u 0.0000 (3.1250) lr 2.0777e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 276
confident_label rate tensor(0.3936, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 296
clean true:247
clean false:49
clean_rate:0.8344594594594594
noisy true:229
noisy false:227
after delete: len(clean_dataset) 296
after delete: len(noisy_dataset) 456
epoch [190/200] batch [5/9] time 0.357 (0.335) data 0.308 (0.287) loss_x loss_x 0.1796 (0.1537) acc_x 96.8750 (96.2500) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [5/14] time 0.319 (0.322) data 0.268 (0.274) loss_u loss_u 1.0000 (0.9836) acc_u 0.0000 (1.2500) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/14] time 0.311 (0.319) data 0.262 (0.271) loss_u loss_u 0.9360 (0.9771) acc_u 6.2500 (2.1875) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3763, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 283
clean true:238
clean false:45
clean_rate:0.8409893992932862
noisy true:229
noisy false:240
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 469
epoch [191/200] batch [5/8] time 0.373 (0.345) data 0.325 (0.297) loss_x loss_x 0.1348 (0.1474) acc_x 96.8750 (95.6250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [5/14] time 0.284 (0.331) data 0.235 (0.283) loss_u loss_u 0.9712 (0.9541) acc_u 3.1250 (5.6250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/14] time 0.373 (0.333) data 0.325 (0.285) loss_u loss_u 0.9634 (0.9591) acc_u 3.1250 (4.6875) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 272
confident_label rate tensor(0.3883, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 292
clean true:248
clean false:44
clean_rate:0.8493150684931506
noisy true:232
noisy false:228
after delete: len(clean_dataset) 292
after delete: len(noisy_dataset) 460
epoch [192/200] batch [5/9] time 0.297 (0.312) data 0.249 (0.264) loss_x loss_x 0.0874 (0.1352) acc_x 100.0000 (98.1250) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [5/14] time 0.340 (0.315) data 0.291 (0.267) loss_u loss_u 0.9976 (0.9750) acc_u 0.0000 (2.5000) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/14] time 0.315 (0.315) data 0.266 (0.267) loss_u loss_u 0.9902 (0.9725) acc_u 3.1250 (3.1250) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3856, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 290
clean true:245
clean false:45
clean_rate:0.8448275862068966
noisy true:224
noisy false:238
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 462
epoch [193/200] batch [5/9] time 0.334 (0.326) data 0.285 (0.278) loss_x loss_x 0.1283 (0.2066) acc_x 96.8750 (95.0000) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [5/14] time 0.302 (0.308) data 0.254 (0.260) loss_u loss_u 0.9961 (0.9840) acc_u 0.0000 (1.2500) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/14] time 0.377 (0.317) data 0.326 (0.269) loss_u loss_u 0.9688 (0.9758) acc_u 3.1250 (2.8125) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 277
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 288
clean true:239
clean false:49
clean_rate:0.8298611111111112
noisy true:236
noisy false:228
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 464
epoch [194/200] batch [5/9] time 0.348 (0.318) data 0.300 (0.271) loss_x loss_x 0.3230 (0.1806) acc_x 87.5000 (95.6250) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [5/14] time 0.302 (0.316) data 0.254 (0.268) loss_u loss_u 0.9497 (0.9664) acc_u 6.2500 (3.7500) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/14] time 0.298 (0.311) data 0.250 (0.263) loss_u loss_u 0.9463 (0.9629) acc_u 6.2500 (4.0625) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3816, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 287
clean true:239
clean false:48
clean_rate:0.8327526132404182
noisy true:225
noisy false:240
after delete: len(clean_dataset) 287
after delete: len(noisy_dataset) 465
epoch [195/200] batch [5/8] time 0.282 (0.307) data 0.234 (0.259) loss_x loss_x 0.1493 (0.1762) acc_x 93.7500 (93.7500) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/14] time 0.299 (0.299) data 0.251 (0.250) loss_u loss_u 0.9785 (0.9689) acc_u 3.1250 (3.1250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/14] time 0.325 (0.298) data 0.276 (0.250) loss_u loss_u 0.9282 (0.9689) acc_u 9.3750 (3.1250) lr 6.0390e-06 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3763, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 283
clean true:237
clean false:46
clean_rate:0.8374558303886925
noisy true:233
noisy false:236
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 469
epoch [196/200] batch [5/8] time 0.328 (0.300) data 0.280 (0.252) loss_x loss_x 0.0793 (0.1473) acc_x 100.0000 (98.7500) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/14] time 0.235 (0.295) data 0.186 (0.247) loss_u loss_u 0.9097 (0.9609) acc_u 9.3750 (3.7500) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/14] time 0.341 (0.295) data 0.290 (0.247) loss_u loss_u 0.9976 (0.9615) acc_u 0.0000 (3.7500) lr 4.4380e-06 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 296
confident_label rate tensor(0.3777, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 284
clean true:236
clean false:48
clean_rate:0.8309859154929577
noisy true:220
noisy false:248
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 468
epoch [197/200] batch [5/8] time 0.322 (0.302) data 0.274 (0.254) loss_x loss_x 0.0860 (0.1574) acc_x 100.0000 (95.6250) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/14] time 0.278 (0.305) data 0.230 (0.257) loss_u loss_u 0.9253 (0.9595) acc_u 9.3750 (4.3750) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/14] time 0.313 (0.303) data 0.265 (0.254) loss_u loss_u 0.9287 (0.9602) acc_u 6.2500 (4.0625) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3843, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 289
clean true:245
clean false:44
clean_rate:0.8477508650519031
noisy true:218
noisy false:245
after delete: len(clean_dataset) 289
after delete: len(noisy_dataset) 463
epoch [198/200] batch [5/9] time 0.300 (0.309) data 0.253 (0.262) loss_x loss_x 0.1898 (0.2038) acc_x 100.0000 (96.2500) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [5/14] time 0.258 (0.309) data 0.210 (0.260) loss_u loss_u 0.9980 (0.9762) acc_u 0.0000 (2.5000) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/14] time 0.323 (0.303) data 0.275 (0.255) loss_u loss_u 0.9312 (0.9609) acc_u 6.2500 (4.0625) lr 1.9733e-06 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3777, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 284
clean true:240
clean false:44
clean_rate:0.8450704225352113
noisy true:222
noisy false:246
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 468
epoch [199/200] batch [5/8] time 0.331 (0.302) data 0.283 (0.255) loss_x loss_x 0.1115 (0.1386) acc_x 100.0000 (96.8750) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/14] time 0.348 (0.305) data 0.300 (0.257) loss_u loss_u 0.9673 (0.9652) acc_u 3.1250 (3.1250) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/14] time 0.278 (0.301) data 0.228 (0.253) loss_u loss_u 0.9624 (0.9716) acc_u 3.1250 (2.5000) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 281
confident_label rate tensor(0.3843, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 289
clean true:245
clean false:44
clean_rate:0.8477508650519031
noisy true:226
noisy false:237
after delete: len(clean_dataset) 289
after delete: len(noisy_dataset) 463
epoch [200/200] batch [5/9] time 0.384 (0.327) data 0.335 (0.278) loss_x loss_x 0.3186 (0.2154) acc_x 96.8750 (96.2500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [5/14] time 0.302 (0.316) data 0.253 (0.268) loss_u loss_u 0.9980 (0.9807) acc_u 0.0000 (1.8750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/14] time 0.293 (0.312) data 0.243 (0.264) loss_u loss_u 0.9375 (0.9653) acc_u 6.2500 (3.7500) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output/dtd/NLPrompt/rn50_16shots/noise_sym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 1,692
* correct: 857
* accuracy: 50.7%
* error: 49.3%
* macro_f1: 50.0%
Elapsed: 0:48:12
