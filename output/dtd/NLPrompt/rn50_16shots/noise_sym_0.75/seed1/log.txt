***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '47']
output_dir: output/dtd/NLPrompt/rn50_16shots/noise_sym_0.75/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: DescribableTextures
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 47
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/dtd/NLPrompt/rn50_16shots/noise_sym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: DescribableTextures
Reading split from /home/convex/datasets/nlprompt/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/dtd/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 23
Data loader size: 2
Data loader size: 17
---------  -------------------
Dataset    DescribableTextures
# classes  47
# train_x  752
# val      188
# test     1,692
---------  -------------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/dtd/NLPrompt/rn50_16shots/noise_sym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 569
confident_label rate tensor(0.0598, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 45
clean true:41
clean false:4
clean_rate:0.9111111111111111
noisy true:142
noisy false:565
after delete: len(clean_dataset) 45
after delete: len(noisy_dataset) 707
epoch [1/200] batch [1/1] time 0.380 (0.380) data 0.241 (0.241) loss_x loss_x 2.4062 (2.4062) acc_x 53.1250 (53.1250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/22] time 0.276 (0.296) data 0.226 (0.229) loss_u loss_u 0.9741 (0.9786) acc_u 0.0000 (1.2500) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [10/22] time 0.297 (0.298) data 0.248 (0.239) loss_u loss_u 0.9819 (0.9792) acc_u 0.0000 (1.5625) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [15/22] time 0.265 (0.302) data 0.218 (0.247) loss_u loss_u 0.9785 (0.9769) acc_u 3.1250 (2.2917) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [20/22] time 0.270 (0.300) data 0.222 (0.247) loss_u loss_u 0.9761 (0.9775) acc_u 3.1250 (2.5000) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 578
confident_label rate tensor(0.0519, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 39
clean true:34
clean false:5
clean_rate:0.8717948717948718
noisy true:140
noisy false:573
after delete: len(clean_dataset) 39
after delete: len(noisy_dataset) 713
epoch [2/200] batch [1/1] time 0.289 (0.289) data 0.242 (0.242) loss_x loss_x 2.3184 (2.3184) acc_x 53.1250 (53.1250) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/22] time 0.297 (0.289) data 0.249 (0.241) loss_u loss_u 0.9722 (0.9666) acc_u 6.2500 (7.5000) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [10/22] time 0.292 (0.290) data 0.244 (0.242) loss_u loss_u 0.9766 (0.9718) acc_u 0.0000 (5.3125) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [15/22] time 0.325 (0.294) data 0.277 (0.246) loss_u loss_u 0.9487 (0.9707) acc_u 6.2500 (4.3750) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [20/22] time 0.323 (0.294) data 0.276 (0.246) loss_u loss_u 0.9790 (0.9706) acc_u 3.1250 (4.2188) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 470
confident_label rate tensor(0.1064, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 80
clean true:69
clean false:11
clean_rate:0.8625
noisy true:213
noisy false:459
after delete: len(clean_dataset) 80
after delete: len(noisy_dataset) 672
epoch [3/200] batch [1/2] time 0.292 (0.292) data 0.245 (0.245) loss_x loss_x 1.9131 (1.9131) acc_x 62.5000 (62.5000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [2/2] time 0.291 (0.292) data 0.244 (0.245) loss_x loss_x 1.8711 (1.8921) acc_x 43.7500 (53.1250) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/21] time 0.283 (0.279) data 0.236 (0.231) loss_u loss_u 0.9829 (0.9748) acc_u 3.1250 (3.1250) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/21] time 0.291 (0.289) data 0.242 (0.242) loss_u loss_u 0.9766 (0.9767) acc_u 3.1250 (2.8125) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/21] time 0.334 (0.295) data 0.287 (0.248) loss_u loss_u 0.9849 (0.9758) acc_u 0.0000 (3.1250) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [20/21] time 0.266 (0.295) data 0.219 (0.248) loss_u loss_u 0.9746 (0.9771) acc_u 3.1250 (2.8125) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 498
confident_label rate tensor(0.0904, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 68
clean true:60
clean false:8
clean_rate:0.8823529411764706
noisy true:194
noisy false:490
after delete: len(clean_dataset) 68
after delete: len(noisy_dataset) 684
epoch [4/200] batch [1/2] time 0.286 (0.286) data 0.239 (0.239) loss_x loss_x 1.9443 (1.9443) acc_x 56.2500 (56.2500) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [2/2] time 0.304 (0.295) data 0.257 (0.248) loss_x loss_x 1.9004 (1.9224) acc_x 46.8750 (51.5625) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/21] time 0.302 (0.283) data 0.254 (0.235) loss_u loss_u 0.9932 (0.9718) acc_u 0.0000 (1.8750) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/21] time 0.294 (0.288) data 0.247 (0.240) loss_u loss_u 0.9873 (0.9729) acc_u 0.0000 (2.5000) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/21] time 0.297 (0.286) data 0.250 (0.238) loss_u loss_u 0.9761 (0.9688) acc_u 0.0000 (2.9167) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [20/21] time 0.309 (0.287) data 0.262 (0.240) loss_u loss_u 0.9810 (0.9675) acc_u 0.0000 (3.1250) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 473
confident_label rate tensor(0.1051, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 79
clean true:69
clean false:10
clean_rate:0.8734177215189873
noisy true:210
noisy false:463
after delete: len(clean_dataset) 79
after delete: len(noisy_dataset) 673
epoch [5/200] batch [1/2] time 0.288 (0.288) data 0.241 (0.241) loss_x loss_x 1.3418 (1.3418) acc_x 68.7500 (68.7500) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [2/2] time 0.300 (0.294) data 0.253 (0.247) loss_x loss_x 1.3936 (1.3677) acc_x 68.7500 (68.7500) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/21] time 0.280 (0.289) data 0.233 (0.241) loss_u loss_u 0.9531 (0.9745) acc_u 6.2500 (1.8750) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/21] time 0.272 (0.290) data 0.224 (0.243) loss_u loss_u 0.9863 (0.9733) acc_u 0.0000 (3.1250) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/21] time 0.284 (0.290) data 0.237 (0.243) loss_u loss_u 0.9897 (0.9739) acc_u 0.0000 (3.3333) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/21] time 0.369 (0.293) data 0.321 (0.245) loss_u loss_u 0.9868 (0.9712) acc_u 0.0000 (3.7500) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 486
confident_label rate tensor(0.0891, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 67
clean true:59
clean false:8
clean_rate:0.8805970149253731
noisy true:207
noisy false:478
after delete: len(clean_dataset) 67
after delete: len(noisy_dataset) 685
epoch [6/200] batch [1/2] time 0.296 (0.296) data 0.248 (0.248) loss_x loss_x 1.2988 (1.2988) acc_x 65.6250 (65.6250) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [2/2] time 0.289 (0.293) data 0.242 (0.245) loss_x loss_x 1.2783 (1.2886) acc_x 62.5000 (64.0625) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/21] time 0.315 (0.295) data 0.267 (0.247) loss_u loss_u 0.9546 (0.9547) acc_u 3.1250 (5.6250) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/21] time 0.317 (0.292) data 0.269 (0.245) loss_u loss_u 0.9629 (0.9600) acc_u 6.2500 (4.3750) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/21] time 0.322 (0.293) data 0.274 (0.246) loss_u loss_u 0.9800 (0.9624) acc_u 0.0000 (3.7500) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [20/21] time 0.344 (0.294) data 0.293 (0.246) loss_u loss_u 0.9844 (0.9630) acc_u 0.0000 (3.9062) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 451
confident_label rate tensor(0.0984, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 74
clean true:68
clean false:6
clean_rate:0.918918918918919
noisy true:233
noisy false:445
after delete: len(clean_dataset) 74
after delete: len(noisy_dataset) 678
epoch [7/200] batch [1/2] time 0.278 (0.278) data 0.231 (0.231) loss_x loss_x 0.9995 (0.9995) acc_x 81.2500 (81.2500) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [2/2] time 0.285 (0.282) data 0.238 (0.234) loss_x loss_x 1.0791 (1.0393) acc_x 75.0000 (78.1250) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/21] time 0.256 (0.278) data 0.209 (0.231) loss_u loss_u 0.9805 (0.9777) acc_u 3.1250 (1.8750) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/21] time 0.324 (0.299) data 0.277 (0.252) loss_u loss_u 0.9810 (0.9748) acc_u 3.1250 (2.1875) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [15/21] time 0.267 (0.299) data 0.220 (0.251) loss_u loss_u 0.9404 (0.9661) acc_u 9.3750 (3.3333) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/21] time 0.300 (0.297) data 0.252 (0.249) loss_u loss_u 0.9634 (0.9643) acc_u 3.1250 (3.7500) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 451
confident_label rate tensor(0.1237, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 93
clean true:82
clean false:11
clean_rate:0.8817204301075269
noisy true:219
noisy false:440
after delete: len(clean_dataset) 93
after delete: len(noisy_dataset) 659
epoch [8/200] batch [1/2] time 0.323 (0.323) data 0.276 (0.276) loss_x loss_x 0.9185 (0.9185) acc_x 71.8750 (71.8750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [2/2] time 0.291 (0.307) data 0.244 (0.260) loss_x loss_x 1.1621 (1.0403) acc_x 78.1250 (75.0000) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/20] time 0.268 (0.293) data 0.220 (0.245) loss_u loss_u 0.9912 (0.9645) acc_u 0.0000 (3.7500) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/20] time 0.311 (0.298) data 0.263 (0.250) loss_u loss_u 0.9639 (0.9708) acc_u 6.2500 (3.1250) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/20] time 0.292 (0.298) data 0.245 (0.250) loss_u loss_u 0.9565 (0.9723) acc_u 6.2500 (2.7083) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [20/20] time 0.291 (0.295) data 0.243 (0.247) loss_u loss_u 0.9780 (0.9721) acc_u 3.1250 (2.5000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 432
confident_label rate tensor(0.1223, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 92
clean true:81
clean false:11
clean_rate:0.8804347826086957
noisy true:239
noisy false:421
after delete: len(clean_dataset) 92
after delete: len(noisy_dataset) 660
epoch [9/200] batch [1/2] time 0.282 (0.282) data 0.235 (0.235) loss_x loss_x 0.8994 (0.8994) acc_x 81.2500 (81.2500) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [2/2] time 0.330 (0.306) data 0.283 (0.259) loss_x loss_x 1.0664 (0.9829) acc_x 71.8750 (76.5625) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/20] time 0.252 (0.288) data 0.204 (0.240) loss_u loss_u 0.9648 (0.9677) acc_u 3.1250 (5.0000) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/20] time 0.297 (0.287) data 0.250 (0.240) loss_u loss_u 0.9648 (0.9669) acc_u 3.1250 (3.7500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/20] time 0.297 (0.295) data 0.249 (0.247) loss_u loss_u 0.9673 (0.9676) acc_u 3.1250 (3.5417) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/20] time 0.270 (0.293) data 0.222 (0.246) loss_u loss_u 0.9868 (0.9664) acc_u 0.0000 (3.5938) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 442
confident_label rate tensor(0.1197, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 90
clean true:79
clean false:11
clean_rate:0.8777777777777778
noisy true:231
noisy false:431
after delete: len(clean_dataset) 90
after delete: len(noisy_dataset) 662
epoch [10/200] batch [1/2] time 0.269 (0.269) data 0.222 (0.222) loss_x loss_x 1.1934 (1.1934) acc_x 68.7500 (68.7500) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [2/2] time 0.288 (0.279) data 0.241 (0.232) loss_x loss_x 0.9116 (1.0525) acc_x 78.1250 (73.4375) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/20] time 0.323 (0.299) data 0.276 (0.251) loss_u loss_u 0.9565 (0.9690) acc_u 6.2500 (2.5000) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/20] time 0.272 (0.295) data 0.225 (0.247) loss_u loss_u 0.9170 (0.9620) acc_u 12.5000 (4.3750) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/20] time 0.295 (0.291) data 0.248 (0.243) loss_u loss_u 0.9551 (0.9621) acc_u 6.2500 (4.3750) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/20] time 0.288 (0.290) data 0.240 (0.242) loss_u loss_u 0.9824 (0.9637) acc_u 0.0000 (3.9062) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 417
confident_label rate tensor(0.1343, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 101
clean true:90
clean false:11
clean_rate:0.8910891089108911
noisy true:245
noisy false:406
after delete: len(clean_dataset) 101
after delete: len(noisy_dataset) 651
epoch [11/200] batch [1/3] time 0.278 (0.278) data 0.231 (0.231) loss_x loss_x 0.9468 (0.9468) acc_x 75.0000 (75.0000) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [2/3] time 0.280 (0.279) data 0.233 (0.232) loss_x loss_x 0.6162 (0.7815) acc_x 81.2500 (78.1250) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [3/3] time 0.268 (0.275) data 0.221 (0.228) loss_x loss_x 0.9741 (0.8457) acc_x 75.0000 (77.0833) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/20] time 0.276 (0.281) data 0.228 (0.234) loss_u loss_u 0.9561 (0.9700) acc_u 6.2500 (2.5000) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/20] time 0.249 (0.281) data 0.201 (0.234) loss_u loss_u 0.9365 (0.9678) acc_u 6.2500 (2.8125) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/20] time 0.250 (0.281) data 0.203 (0.234) loss_u loss_u 0.9932 (0.9707) acc_u 0.0000 (2.5000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/20] time 0.280 (0.284) data 0.233 (0.237) loss_u loss_u 0.9780 (0.9746) acc_u 3.1250 (2.1875) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 441
confident_label rate tensor(0.1237, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 93
clean true:80
clean false:13
clean_rate:0.8602150537634409
noisy true:231
noisy false:428
after delete: len(clean_dataset) 93
after delete: len(noisy_dataset) 659
epoch [12/200] batch [1/2] time 0.285 (0.285) data 0.237 (0.237) loss_x loss_x 0.6831 (0.6831) acc_x 81.2500 (81.2500) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [2/2] time 0.339 (0.312) data 0.292 (0.264) loss_x loss_x 0.9229 (0.8030) acc_x 71.8750 (76.5625) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/20] time 0.271 (0.304) data 0.223 (0.257) loss_u loss_u 0.9907 (0.9719) acc_u 0.0000 (3.1250) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/20] time 0.330 (0.301) data 0.282 (0.253) loss_u loss_u 0.9556 (0.9670) acc_u 3.1250 (3.1250) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/20] time 0.310 (0.291) data 0.262 (0.244) loss_u loss_u 0.9902 (0.9620) acc_u 0.0000 (3.5417) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/20] time 0.321 (0.290) data 0.273 (0.242) loss_u loss_u 0.9126 (0.9611) acc_u 15.6250 (4.0625) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 418
confident_label rate tensor(0.1303, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 98
clean true:85
clean false:13
clean_rate:0.8673469387755102
noisy true:249
noisy false:405
after delete: len(clean_dataset) 98
after delete: len(noisy_dataset) 654
epoch [13/200] batch [1/3] time 0.266 (0.266) data 0.219 (0.219) loss_x loss_x 0.6538 (0.6538) acc_x 81.2500 (81.2500) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [2/3] time 0.312 (0.289) data 0.263 (0.241) loss_x loss_x 0.3877 (0.5208) acc_x 96.8750 (89.0625) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [3/3] time 0.285 (0.288) data 0.236 (0.239) loss_x loss_x 0.6772 (0.5729) acc_x 78.1250 (85.4167) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/20] time 0.276 (0.288) data 0.228 (0.240) loss_u loss_u 0.9375 (0.9525) acc_u 6.2500 (4.3750) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/20] time 0.304 (0.290) data 0.256 (0.242) loss_u loss_u 0.9775 (0.9632) acc_u 3.1250 (3.4375) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/20] time 0.243 (0.290) data 0.195 (0.242) loss_u loss_u 0.9849 (0.9631) acc_u 3.1250 (4.3750) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/20] time 0.321 (0.292) data 0.273 (0.244) loss_u loss_u 0.9868 (0.9642) acc_u 0.0000 (4.2188) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 413
confident_label rate tensor(0.1410, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 106
clean true:93
clean false:13
clean_rate:0.8773584905660378
noisy true:246
noisy false:400
after delete: len(clean_dataset) 106
after delete: len(noisy_dataset) 646
epoch [14/200] batch [1/3] time 0.322 (0.322) data 0.275 (0.275) loss_x loss_x 0.5488 (0.5488) acc_x 87.5000 (87.5000) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [2/3] time 0.273 (0.298) data 0.226 (0.251) loss_x loss_x 0.4907 (0.5198) acc_x 87.5000 (87.5000) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [3/3] time 0.272 (0.289) data 0.225 (0.242) loss_x loss_x 0.6030 (0.5475) acc_x 84.3750 (86.4583) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/20] time 0.307 (0.280) data 0.259 (0.232) loss_u loss_u 0.9253 (0.9591) acc_u 9.3750 (5.6250) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/20] time 0.293 (0.291) data 0.245 (0.243) loss_u loss_u 0.9609 (0.9582) acc_u 6.2500 (5.6250) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/20] time 0.260 (0.291) data 0.210 (0.242) loss_u loss_u 0.9937 (0.9614) acc_u 0.0000 (4.7917) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/20] time 0.288 (0.294) data 0.240 (0.246) loss_u loss_u 0.9609 (0.9645) acc_u 6.2500 (4.2188) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 430
confident_label rate tensor(0.1316, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 99
clean true:85
clean false:14
clean_rate:0.8585858585858586
noisy true:237
noisy false:416
after delete: len(clean_dataset) 99
after delete: len(noisy_dataset) 653
epoch [15/200] batch [1/3] time 0.265 (0.265) data 0.218 (0.218) loss_x loss_x 0.9648 (0.9648) acc_x 78.1250 (78.1250) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [2/3] time 0.318 (0.291) data 0.271 (0.244) loss_x loss_x 0.4102 (0.6875) acc_x 90.6250 (84.3750) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [3/3] time 0.295 (0.293) data 0.248 (0.246) loss_x loss_x 0.7451 (0.7067) acc_x 78.1250 (82.2917) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/20] time 0.275 (0.298) data 0.227 (0.251) loss_u loss_u 0.9785 (0.9765) acc_u 3.1250 (2.5000) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [10/20] time 0.293 (0.295) data 0.245 (0.247) loss_u loss_u 0.9790 (0.9729) acc_u 3.1250 (3.1250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/20] time 0.278 (0.296) data 0.230 (0.248) loss_u loss_u 0.9375 (0.9618) acc_u 6.2500 (4.5833) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/20] time 0.297 (0.295) data 0.249 (0.247) loss_u loss_u 0.9443 (0.9640) acc_u 6.2500 (4.3750) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 400
confident_label rate tensor(0.1410, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 106
clean true:94
clean false:12
clean_rate:0.8867924528301887
noisy true:258
noisy false:388
after delete: len(clean_dataset) 106
after delete: len(noisy_dataset) 646
epoch [16/200] batch [1/3] time 0.338 (0.338) data 0.291 (0.291) loss_x loss_x 0.5703 (0.5703) acc_x 81.2500 (81.2500) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [2/3] time 0.241 (0.289) data 0.194 (0.242) loss_x loss_x 0.6128 (0.5916) acc_x 84.3750 (82.8125) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [3/3] time 0.300 (0.293) data 0.253 (0.246) loss_x loss_x 0.8018 (0.6616) acc_x 81.2500 (82.2917) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/20] time 0.313 (0.298) data 0.265 (0.251) loss_u loss_u 0.9673 (0.9608) acc_u 3.1250 (3.7500) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [10/20] time 0.268 (0.298) data 0.221 (0.250) loss_u loss_u 0.9634 (0.9625) acc_u 3.1250 (3.4375) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/20] time 0.259 (0.292) data 0.212 (0.244) loss_u loss_u 0.8955 (0.9611) acc_u 12.5000 (3.7500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/20] time 0.310 (0.292) data 0.262 (0.245) loss_u loss_u 0.9541 (0.9603) acc_u 6.2500 (3.9062) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 414
confident_label rate tensor(0.1316, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 99
clean true:89
clean false:10
clean_rate:0.898989898989899
noisy true:249
noisy false:404
after delete: len(clean_dataset) 99
after delete: len(noisy_dataset) 653
epoch [17/200] batch [1/3] time 0.304 (0.304) data 0.255 (0.255) loss_x loss_x 0.6616 (0.6616) acc_x 87.5000 (87.5000) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [2/3] time 0.283 (0.293) data 0.236 (0.246) loss_x loss_x 0.7446 (0.7031) acc_x 81.2500 (84.3750) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [3/3] time 0.292 (0.293) data 0.245 (0.245) loss_x loss_x 0.5791 (0.6618) acc_x 81.2500 (83.3333) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/20] time 0.301 (0.301) data 0.254 (0.253) loss_u loss_u 0.9795 (0.9645) acc_u 0.0000 (2.5000) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [10/20] time 0.309 (0.298) data 0.261 (0.251) loss_u loss_u 0.9624 (0.9563) acc_u 6.2500 (4.6875) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/20] time 0.319 (0.296) data 0.271 (0.248) loss_u loss_u 0.9756 (0.9543) acc_u 3.1250 (5.2083) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/20] time 0.269 (0.295) data 0.221 (0.248) loss_u loss_u 0.9214 (0.9544) acc_u 6.2500 (5.1562) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 423
confident_label rate tensor(0.1396, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 105
clean true:90
clean false:15
clean_rate:0.8571428571428571
noisy true:239
noisy false:408
after delete: len(clean_dataset) 105
after delete: len(noisy_dataset) 647
epoch [18/200] batch [1/3] time 0.298 (0.298) data 0.251 (0.251) loss_x loss_x 0.5884 (0.5884) acc_x 81.2500 (81.2500) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [2/3] time 0.263 (0.280) data 0.215 (0.233) loss_x loss_x 0.6211 (0.6047) acc_x 87.5000 (84.3750) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [3/3] time 0.270 (0.277) data 0.223 (0.230) loss_x loss_x 0.7607 (0.6567) acc_x 84.3750 (84.3750) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/20] time 0.239 (0.269) data 0.191 (0.222) loss_u loss_u 0.9497 (0.9650) acc_u 6.2500 (5.0000) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [10/20] time 0.295 (0.281) data 0.248 (0.233) loss_u loss_u 0.9600 (0.9579) acc_u 3.1250 (5.0000) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/20] time 0.284 (0.286) data 0.236 (0.238) loss_u loss_u 0.9004 (0.9529) acc_u 12.5000 (5.8333) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/20] time 0.281 (0.290) data 0.233 (0.242) loss_u loss_u 0.9927 (0.9590) acc_u 0.0000 (5.0000) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 412
confident_label rate tensor(0.1449, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 109
clean true:94
clean false:15
clean_rate:0.8623853211009175
noisy true:246
noisy false:397
after delete: len(clean_dataset) 109
after delete: len(noisy_dataset) 643
epoch [19/200] batch [1/3] time 0.294 (0.294) data 0.246 (0.246) loss_x loss_x 0.7705 (0.7705) acc_x 78.1250 (78.1250) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [2/3] time 0.307 (0.300) data 0.259 (0.252) loss_x loss_x 0.8413 (0.8059) acc_x 78.1250 (78.1250) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [3/3] time 0.296 (0.299) data 0.249 (0.251) loss_x loss_x 0.4043 (0.6720) acc_x 87.5000 (81.2500) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/20] time 0.270 (0.281) data 0.222 (0.233) loss_u loss_u 0.9590 (0.9552) acc_u 6.2500 (5.6250) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [10/20] time 0.303 (0.282) data 0.256 (0.235) loss_u loss_u 0.9824 (0.9613) acc_u 3.1250 (4.6875) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/20] time 0.311 (0.291) data 0.263 (0.243) loss_u loss_u 0.9561 (0.9618) acc_u 6.2500 (4.3750) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/20] time 0.295 (0.293) data 0.247 (0.245) loss_u loss_u 0.9629 (0.9622) acc_u 3.1250 (4.6875) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 402
confident_label rate tensor(0.1503, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 113
clean true:100
clean false:13
clean_rate:0.8849557522123894
noisy true:250
noisy false:389
after delete: len(clean_dataset) 113
after delete: len(noisy_dataset) 639
epoch [20/200] batch [1/3] time 0.327 (0.327) data 0.279 (0.279) loss_x loss_x 0.3533 (0.3533) acc_x 93.7500 (93.7500) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [2/3] time 0.268 (0.298) data 0.221 (0.250) loss_x loss_x 0.6455 (0.4994) acc_x 84.3750 (89.0625) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [3/3] time 0.323 (0.306) data 0.276 (0.259) loss_x loss_x 0.4944 (0.4977) acc_x 87.5000 (88.5417) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/19] time 0.257 (0.296) data 0.210 (0.249) loss_u loss_u 0.9204 (0.9541) acc_u 9.3750 (6.2500) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/19] time 0.291 (0.294) data 0.243 (0.246) loss_u loss_u 0.9492 (0.9609) acc_u 6.2500 (5.3125) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/19] time 0.286 (0.294) data 0.238 (0.246) loss_u loss_u 0.9907 (0.9611) acc_u 0.0000 (5.0000) lr 1.9603e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 418
confident_label rate tensor(0.1503, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 113
clean true:98
clean false:15
clean_rate:0.8672566371681416
noisy true:236
noisy false:403
after delete: len(clean_dataset) 113
after delete: len(noisy_dataset) 639
epoch [21/200] batch [1/3] time 0.322 (0.322) data 0.275 (0.275) loss_x loss_x 0.3389 (0.3389) acc_x 100.0000 (100.0000) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [2/3] time 0.314 (0.318) data 0.267 (0.271) loss_x loss_x 0.4546 (0.3967) acc_x 81.2500 (90.6250) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [3/3] time 0.278 (0.305) data 0.230 (0.257) loss_x loss_x 0.8364 (0.5433) acc_x 78.1250 (86.4583) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/19] time 0.295 (0.303) data 0.247 (0.255) loss_u loss_u 0.9619 (0.9711) acc_u 3.1250 (3.1250) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [10/19] time 0.288 (0.308) data 0.240 (0.260) loss_u loss_u 0.9512 (0.9599) acc_u 6.2500 (4.3750) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/19] time 0.282 (0.302) data 0.234 (0.254) loss_u loss_u 0.9756 (0.9631) acc_u 3.1250 (3.9583) lr 1.9558e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 403
confident_label rate tensor(0.1503, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 113
clean true:97
clean false:16
clean_rate:0.8584070796460177
noisy true:252
noisy false:387
after delete: len(clean_dataset) 113
after delete: len(noisy_dataset) 639
epoch [22/200] batch [1/3] time 0.263 (0.263) data 0.216 (0.216) loss_x loss_x 0.4539 (0.4539) acc_x 87.5000 (87.5000) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [2/3] time 0.278 (0.271) data 0.232 (0.224) loss_x loss_x 0.4407 (0.4473) acc_x 90.6250 (89.0625) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [3/3] time 0.314 (0.285) data 0.267 (0.238) loss_x loss_x 0.5952 (0.4966) acc_x 84.3750 (87.5000) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/19] time 0.266 (0.286) data 0.219 (0.238) loss_u loss_u 0.9556 (0.9707) acc_u 6.2500 (3.1250) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/19] time 0.301 (0.289) data 0.254 (0.242) loss_u loss_u 0.9683 (0.9714) acc_u 3.1250 (2.8125) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/19] time 0.305 (0.290) data 0.258 (0.243) loss_u loss_u 0.9390 (0.9612) acc_u 9.3750 (4.3750) lr 1.9511e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 412
confident_label rate tensor(0.1609, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 121
clean true:104
clean false:17
clean_rate:0.859504132231405
noisy true:236
noisy false:395
after delete: len(clean_dataset) 121
after delete: len(noisy_dataset) 631
epoch [23/200] batch [1/3] time 0.276 (0.276) data 0.229 (0.229) loss_x loss_x 0.5620 (0.5620) acc_x 81.2500 (81.2500) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [2/3] time 0.296 (0.286) data 0.247 (0.238) loss_x loss_x 0.5435 (0.5527) acc_x 84.3750 (82.8125) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [3/3] time 0.295 (0.289) data 0.248 (0.241) loss_x loss_x 0.6782 (0.5946) acc_x 81.2500 (82.2917) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/19] time 0.258 (0.285) data 0.209 (0.237) loss_u loss_u 0.9067 (0.9475) acc_u 15.6250 (6.8750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/19] time 0.294 (0.283) data 0.247 (0.235) loss_u loss_u 0.9331 (0.9575) acc_u 9.3750 (5.9375) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/19] time 0.280 (0.287) data 0.232 (0.240) loss_u loss_u 0.9707 (0.9585) acc_u 3.1250 (5.4167) lr 1.9461e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 398
confident_label rate tensor(0.1596, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 120
clean true:103
clean false:17
clean_rate:0.8583333333333333
noisy true:251
noisy false:381
after delete: len(clean_dataset) 120
after delete: len(noisy_dataset) 632
epoch [24/200] batch [1/3] time 0.276 (0.276) data 0.229 (0.229) loss_x loss_x 0.5146 (0.5146) acc_x 90.6250 (90.6250) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [2/3] time 0.313 (0.294) data 0.266 (0.247) loss_x loss_x 0.5020 (0.5083) acc_x 87.5000 (89.0625) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [3/3] time 0.277 (0.289) data 0.230 (0.241) loss_x loss_x 0.5913 (0.5360) acc_x 78.1250 (85.4167) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/19] time 0.287 (0.290) data 0.239 (0.243) loss_u loss_u 0.9810 (0.9554) acc_u 3.1250 (5.6250) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [10/19] time 0.263 (0.293) data 0.215 (0.245) loss_u loss_u 0.9888 (0.9567) acc_u 0.0000 (5.0000) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/19] time 0.313 (0.296) data 0.266 (0.249) loss_u loss_u 0.9624 (0.9606) acc_u 3.1250 (4.3750) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 411
confident_label rate tensor(0.1609, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 121
clean true:105
clean false:16
clean_rate:0.8677685950413223
noisy true:236
noisy false:395
after delete: len(clean_dataset) 121
after delete: len(noisy_dataset) 631
epoch [25/200] batch [1/3] time 0.324 (0.324) data 0.276 (0.276) loss_x loss_x 0.7251 (0.7251) acc_x 78.1250 (78.1250) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [2/3] time 0.304 (0.314) data 0.256 (0.266) loss_x loss_x 0.6333 (0.6792) acc_x 81.2500 (79.6875) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [3/3] time 0.272 (0.300) data 0.225 (0.252) loss_x loss_x 0.4041 (0.5875) acc_x 93.7500 (84.3750) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/19] time 0.291 (0.303) data 0.243 (0.255) loss_u loss_u 0.9683 (0.9674) acc_u 3.1250 (5.0000) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [10/19] time 0.302 (0.290) data 0.254 (0.242) loss_u loss_u 0.9888 (0.9679) acc_u 3.1250 (4.3750) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/19] time 0.297 (0.290) data 0.249 (0.242) loss_u loss_u 0.9199 (0.9661) acc_u 12.5000 (4.1667) lr 1.9354e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 391
confident_label rate tensor(0.1689, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 127
clean true:111
clean false:16
clean_rate:0.8740157480314961
noisy true:250
noisy false:375
after delete: len(clean_dataset) 127
after delete: len(noisy_dataset) 625
epoch [26/200] batch [1/3] time 0.279 (0.279) data 0.232 (0.232) loss_x loss_x 0.7798 (0.7798) acc_x 84.3750 (84.3750) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [2/3] time 0.295 (0.287) data 0.248 (0.240) loss_x loss_x 0.8042 (0.7920) acc_x 75.0000 (79.6875) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [3/3] time 0.319 (0.298) data 0.271 (0.250) loss_x loss_x 0.4387 (0.6742) acc_x 93.7500 (84.3750) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/19] time 0.273 (0.299) data 0.225 (0.251) loss_u loss_u 0.9814 (0.9778) acc_u 3.1250 (1.2500) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/19] time 0.242 (0.293) data 0.192 (0.245) loss_u loss_u 0.9722 (0.9713) acc_u 3.1250 (2.8125) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/19] time 0.314 (0.292) data 0.267 (0.243) loss_u loss_u 0.9653 (0.9727) acc_u 3.1250 (2.7083) lr 1.9298e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 391
confident_label rate tensor(0.1543, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 116
clean true:104
clean false:12
clean_rate:0.896551724137931
noisy true:257
noisy false:379
after delete: len(clean_dataset) 116
after delete: len(noisy_dataset) 636
epoch [27/200] batch [1/3] time 0.312 (0.312) data 0.265 (0.265) loss_x loss_x 0.5381 (0.5381) acc_x 87.5000 (87.5000) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [2/3] time 0.272 (0.292) data 0.224 (0.245) loss_x loss_x 0.4546 (0.4963) acc_x 90.6250 (89.0625) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [3/3] time 0.294 (0.293) data 0.247 (0.245) loss_x loss_x 0.7598 (0.5841) acc_x 78.1250 (85.4167) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/19] time 0.275 (0.292) data 0.227 (0.244) loss_u loss_u 0.9487 (0.9596) acc_u 6.2500 (5.0000) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/19] time 0.338 (0.299) data 0.290 (0.252) loss_u loss_u 0.9438 (0.9523) acc_u 6.2500 (5.9375) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/19] time 0.286 (0.293) data 0.238 (0.245) loss_u loss_u 0.9575 (0.9574) acc_u 6.2500 (5.0000) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 401
confident_label rate tensor(0.1676, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 126
clean true:109
clean false:17
clean_rate:0.8650793650793651
noisy true:242
noisy false:384
after delete: len(clean_dataset) 126
after delete: len(noisy_dataset) 626
epoch [28/200] batch [1/3] time 0.270 (0.270) data 0.221 (0.221) loss_x loss_x 0.6782 (0.6782) acc_x 81.2500 (81.2500) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [2/3] time 0.273 (0.271) data 0.225 (0.223) loss_x loss_x 0.4639 (0.5710) acc_x 87.5000 (84.3750) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [3/3] time 0.272 (0.271) data 0.224 (0.223) loss_x loss_x 0.6304 (0.5908) acc_x 78.1250 (82.2917) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/19] time 0.286 (0.290) data 0.238 (0.243) loss_u loss_u 0.9600 (0.9634) acc_u 6.2500 (3.7500) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/19] time 0.345 (0.293) data 0.298 (0.245) loss_u loss_u 0.9180 (0.9563) acc_u 9.3750 (4.3750) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/19] time 0.287 (0.291) data 0.239 (0.243) loss_u loss_u 0.9565 (0.9572) acc_u 6.2500 (4.5833) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 395
confident_label rate tensor(0.1702, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 128
clean true:111
clean false:17
clean_rate:0.8671875
noisy true:246
noisy false:378
after delete: len(clean_dataset) 128
after delete: len(noisy_dataset) 624
epoch [29/200] batch [1/4] time 0.305 (0.305) data 0.258 (0.258) loss_x loss_x 0.3562 (0.3562) acc_x 93.7500 (93.7500) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [2/4] time 0.262 (0.283) data 0.215 (0.236) loss_x loss_x 0.4270 (0.3916) acc_x 90.6250 (92.1875) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [3/4] time 0.273 (0.280) data 0.226 (0.233) loss_x loss_x 0.5508 (0.4447) acc_x 87.5000 (90.6250) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [4/4] time 0.310 (0.287) data 0.262 (0.240) loss_x loss_x 0.2776 (0.4029) acc_x 93.7500 (91.4062) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/19] time 0.301 (0.290) data 0.253 (0.242) loss_u loss_u 0.9443 (0.9564) acc_u 9.3750 (5.6250) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/19] time 0.247 (0.290) data 0.199 (0.242) loss_u loss_u 0.9536 (0.9566) acc_u 3.1250 (5.0000) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/19] time 0.308 (0.291) data 0.260 (0.244) loss_u loss_u 0.9673 (0.9559) acc_u 3.1250 (5.0000) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 389
confident_label rate tensor(0.1742, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 131
clean true:112
clean false:19
clean_rate:0.8549618320610687
noisy true:251
noisy false:370
after delete: len(clean_dataset) 131
after delete: len(noisy_dataset) 621
epoch [30/200] batch [1/4] time 0.294 (0.294) data 0.247 (0.247) loss_x loss_x 0.7754 (0.7754) acc_x 78.1250 (78.1250) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [2/4] time 0.289 (0.291) data 0.242 (0.244) loss_x loss_x 0.5376 (0.6565) acc_x 87.5000 (82.8125) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [3/4] time 0.326 (0.303) data 0.279 (0.256) loss_x loss_x 0.3940 (0.5690) acc_x 90.6250 (85.4167) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [4/4] time 0.276 (0.296) data 0.229 (0.249) loss_x loss_x 0.6606 (0.5919) acc_x 90.6250 (86.7188) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/19] time 0.348 (0.304) data 0.300 (0.256) loss_u loss_u 0.9355 (0.9517) acc_u 6.2500 (5.0000) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [10/19] time 0.288 (0.301) data 0.241 (0.252) loss_u loss_u 0.9644 (0.9531) acc_u 6.2500 (5.3125) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/19] time 0.287 (0.298) data 0.240 (0.250) loss_u loss_u 0.9834 (0.9595) acc_u 0.0000 (4.5833) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 406
confident_label rate tensor(0.1689, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 127
clean true:107
clean false:20
clean_rate:0.84251968503937
noisy true:239
noisy false:386
after delete: len(clean_dataset) 127
after delete: len(noisy_dataset) 625
epoch [31/200] batch [1/3] time 0.261 (0.261) data 0.214 (0.214) loss_x loss_x 0.5664 (0.5664) acc_x 81.2500 (81.2500) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [2/3] time 0.266 (0.264) data 0.219 (0.216) loss_x loss_x 0.5918 (0.5791) acc_x 87.5000 (84.3750) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [3/3] time 0.362 (0.296) data 0.315 (0.249) loss_x loss_x 0.3037 (0.4873) acc_x 90.6250 (86.4583) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/19] time 0.319 (0.293) data 0.271 (0.246) loss_u loss_u 0.9888 (0.9680) acc_u 0.0000 (4.3750) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/19] time 0.299 (0.300) data 0.251 (0.252) loss_u loss_u 0.9712 (0.9659) acc_u 3.1250 (5.0000) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/19] time 0.292 (0.304) data 0.245 (0.256) loss_u loss_u 0.9697 (0.9655) acc_u 3.1250 (4.7917) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 385
confident_label rate tensor(0.1649, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 124
clean true:111
clean false:13
clean_rate:0.8951612903225806
noisy true:256
noisy false:372
after delete: len(clean_dataset) 124
after delete: len(noisy_dataset) 628
epoch [32/200] batch [1/3] time 0.280 (0.280) data 0.232 (0.232) loss_x loss_x 0.5122 (0.5122) acc_x 87.5000 (87.5000) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [2/3] time 0.266 (0.273) data 0.219 (0.226) loss_x loss_x 0.7539 (0.6331) acc_x 81.2500 (84.3750) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [3/3] time 0.283 (0.277) data 0.236 (0.229) loss_x loss_x 0.6592 (0.6418) acc_x 81.2500 (83.3333) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/19] time 0.293 (0.289) data 0.245 (0.241) loss_u loss_u 0.9517 (0.9493) acc_u 6.2500 (6.2500) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/19] time 0.283 (0.288) data 0.235 (0.240) loss_u loss_u 0.9805 (0.9675) acc_u 0.0000 (3.7500) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/19] time 0.243 (0.287) data 0.196 (0.240) loss_u loss_u 0.8916 (0.9612) acc_u 12.5000 (4.5833) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 398
confident_label rate tensor(0.1715, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 129
clean true:107
clean false:22
clean_rate:0.8294573643410853
noisy true:247
noisy false:376
after delete: len(clean_dataset) 129
after delete: len(noisy_dataset) 623
epoch [33/200] batch [1/4] time 0.329 (0.329) data 0.282 (0.282) loss_x loss_x 0.7012 (0.7012) acc_x 75.0000 (75.0000) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [2/4] time 0.276 (0.303) data 0.229 (0.256) loss_x loss_x 0.5522 (0.6267) acc_x 78.1250 (76.5625) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [3/4] time 0.292 (0.299) data 0.245 (0.252) loss_x loss_x 0.9546 (0.7360) acc_x 75.0000 (76.0417) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [4/4] time 0.282 (0.295) data 0.234 (0.248) loss_x loss_x 0.5244 (0.6831) acc_x 87.5000 (78.9062) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/19] time 0.293 (0.297) data 0.245 (0.249) loss_u loss_u 0.9355 (0.9438) acc_u 6.2500 (6.8750) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/19] time 0.363 (0.301) data 0.316 (0.253) loss_u loss_u 0.9771 (0.9554) acc_u 0.0000 (5.0000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/19] time 0.253 (0.296) data 0.205 (0.248) loss_u loss_u 0.9912 (0.9601) acc_u 0.0000 (4.3750) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 394
confident_label rate tensor(0.1729, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 130
clean true:110
clean false:20
clean_rate:0.8461538461538461
noisy true:248
noisy false:374
after delete: len(clean_dataset) 130
after delete: len(noisy_dataset) 622
epoch [34/200] batch [1/4] time 0.294 (0.294) data 0.247 (0.247) loss_x loss_x 0.7524 (0.7524) acc_x 71.8750 (71.8750) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [2/4] time 0.289 (0.292) data 0.242 (0.244) loss_x loss_x 0.4734 (0.6129) acc_x 93.7500 (82.8125) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [3/4] time 0.278 (0.287) data 0.231 (0.240) loss_x loss_x 0.4053 (0.5437) acc_x 93.7500 (86.4583) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [4/4] time 0.276 (0.284) data 0.228 (0.237) loss_x loss_x 0.5967 (0.5569) acc_x 81.2500 (85.1562) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/19] time 0.323 (0.300) data 0.276 (0.252) loss_u loss_u 0.9937 (0.9735) acc_u 0.0000 (3.7500) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/19] time 0.331 (0.301) data 0.284 (0.253) loss_u loss_u 0.9258 (0.9603) acc_u 6.2500 (5.0000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/19] time 0.249 (0.295) data 0.202 (0.248) loss_u loss_u 0.9097 (0.9530) acc_u 12.5000 (5.8333) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 388
confident_label rate tensor(0.1702, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 128
clean true:110
clean false:18
clean_rate:0.859375
noisy true:254
noisy false:370
after delete: len(clean_dataset) 128
after delete: len(noisy_dataset) 624
epoch [35/200] batch [1/4] time 0.286 (0.286) data 0.239 (0.239) loss_x loss_x 0.4568 (0.4568) acc_x 84.3750 (84.3750) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [2/4] time 0.286 (0.286) data 0.239 (0.239) loss_x loss_x 0.2583 (0.3575) acc_x 96.8750 (90.6250) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [3/4] time 0.315 (0.296) data 0.268 (0.249) loss_x loss_x 0.7456 (0.4869) acc_x 84.3750 (88.5417) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [4/4] time 0.296 (0.296) data 0.248 (0.249) loss_x loss_x 0.2922 (0.4382) acc_x 96.8750 (90.6250) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/19] time 0.334 (0.298) data 0.287 (0.251) loss_u loss_u 0.9907 (0.9651) acc_u 0.0000 (4.3750) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/19] time 0.261 (0.294) data 0.212 (0.246) loss_u loss_u 0.9873 (0.9700) acc_u 3.1250 (3.7500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/19] time 0.289 (0.295) data 0.241 (0.247) loss_u loss_u 0.9580 (0.9626) acc_u 6.2500 (4.5833) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 387
confident_label rate tensor(0.1795, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 135
clean true:113
clean false:22
clean_rate:0.837037037037037
noisy true:252
noisy false:365
after delete: len(clean_dataset) 135
after delete: len(noisy_dataset) 617
epoch [36/200] batch [1/4] time 0.291 (0.291) data 0.244 (0.244) loss_x loss_x 0.2761 (0.2761) acc_x 93.7500 (93.7500) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [2/4] time 0.269 (0.280) data 0.222 (0.233) loss_x loss_x 0.2886 (0.2823) acc_x 90.6250 (92.1875) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [3/4] time 0.309 (0.290) data 0.261 (0.242) loss_x loss_x 0.3218 (0.2955) acc_x 96.8750 (93.7500) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [4/4] time 0.281 (0.288) data 0.234 (0.240) loss_x loss_x 0.6064 (0.3732) acc_x 87.5000 (92.1875) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/19] time 0.305 (0.297) data 0.258 (0.249) loss_u loss_u 0.9932 (0.9555) acc_u 0.0000 (4.3750) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [10/19] time 0.277 (0.295) data 0.230 (0.247) loss_u loss_u 0.9609 (0.9616) acc_u 3.1250 (4.0625) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/19] time 0.263 (0.295) data 0.215 (0.248) loss_u loss_u 0.9453 (0.9642) acc_u 6.2500 (3.7500) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.1902, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 143
clean true:119
clean false:24
clean_rate:0.8321678321678322
noisy true:262
noisy false:347
after delete: len(clean_dataset) 143
after delete: len(noisy_dataset) 609
epoch [37/200] batch [1/4] time 0.297 (0.297) data 0.250 (0.250) loss_x loss_x 0.5615 (0.5615) acc_x 84.3750 (84.3750) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [2/4] time 0.288 (0.292) data 0.241 (0.245) loss_x loss_x 0.4634 (0.5125) acc_x 84.3750 (84.3750) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [3/4] time 0.307 (0.297) data 0.261 (0.250) loss_x loss_x 0.3181 (0.4477) acc_x 90.6250 (86.4583) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [4/4] time 0.295 (0.297) data 0.248 (0.250) loss_x loss_x 0.6191 (0.4905) acc_x 90.6250 (87.5000) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/19] time 0.301 (0.297) data 0.253 (0.250) loss_u loss_u 0.9570 (0.9571) acc_u 6.2500 (6.2500) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/19] time 0.295 (0.297) data 0.247 (0.250) loss_u loss_u 0.9946 (0.9649) acc_u 0.0000 (4.6875) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/19] time 0.300 (0.298) data 0.251 (0.250) loss_u loss_u 0.9341 (0.9661) acc_u 6.2500 (3.9583) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 380
confident_label rate tensor(0.1928, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 145
clean true:119
clean false:26
clean_rate:0.8206896551724138
noisy true:253
noisy false:354
after delete: len(clean_dataset) 145
after delete: len(noisy_dataset) 607
epoch [38/200] batch [1/4] time 0.278 (0.278) data 0.231 (0.231) loss_x loss_x 0.3376 (0.3376) acc_x 90.6250 (90.6250) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [2/4] time 0.318 (0.298) data 0.271 (0.251) loss_x loss_x 0.8750 (0.6063) acc_x 81.2500 (85.9375) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [3/4] time 0.299 (0.298) data 0.252 (0.251) loss_x loss_x 0.1975 (0.4701) acc_x 96.8750 (89.5833) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [4/4] time 0.305 (0.300) data 0.258 (0.253) loss_x loss_x 0.1993 (0.4024) acc_x 100.0000 (92.1875) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/18] time 0.348 (0.298) data 0.301 (0.251) loss_u loss_u 0.9692 (0.9777) acc_u 3.1250 (2.5000) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/18] time 0.294 (0.298) data 0.245 (0.251) loss_u loss_u 0.9512 (0.9702) acc_u 6.2500 (3.4375) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/18] time 0.276 (0.296) data 0.229 (0.248) loss_u loss_u 0.9473 (0.9694) acc_u 6.2500 (3.5417) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2021, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 152
clean true:122
clean false:30
clean_rate:0.8026315789473685
noisy true:252
noisy false:348
after delete: len(clean_dataset) 152
after delete: len(noisy_dataset) 600
epoch [39/200] batch [1/4] time 0.267 (0.267) data 0.220 (0.220) loss_x loss_x 0.3340 (0.3340) acc_x 93.7500 (93.7500) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [2/4] time 0.290 (0.278) data 0.242 (0.231) loss_x loss_x 0.4331 (0.3835) acc_x 90.6250 (92.1875) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [3/4] time 0.310 (0.289) data 0.262 (0.242) loss_x loss_x 0.5034 (0.4235) acc_x 87.5000 (90.6250) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [4/4] time 0.296 (0.291) data 0.249 (0.243) loss_x loss_x 0.6167 (0.4718) acc_x 84.3750 (89.0625) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/18] time 0.313 (0.295) data 0.266 (0.248) loss_u loss_u 0.9707 (0.9705) acc_u 3.1250 (3.1250) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/18] time 0.329 (0.300) data 0.282 (0.253) loss_u loss_u 0.9473 (0.9626) acc_u 6.2500 (4.0625) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/18] time 0.308 (0.301) data 0.260 (0.253) loss_u loss_u 0.9873 (0.9641) acc_u 0.0000 (3.7500) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 381
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 147
clean true:122
clean false:25
clean_rate:0.8299319727891157
noisy true:249
noisy false:356
after delete: len(clean_dataset) 147
after delete: len(noisy_dataset) 605
epoch [40/200] batch [1/4] time 0.287 (0.287) data 0.239 (0.239) loss_x loss_x 0.5024 (0.5024) acc_x 81.2500 (81.2500) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [2/4] time 0.278 (0.282) data 0.230 (0.234) loss_x loss_x 0.4729 (0.4877) acc_x 87.5000 (84.3750) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [3/4] time 0.306 (0.290) data 0.258 (0.242) loss_x loss_x 0.3149 (0.4301) acc_x 90.6250 (86.4583) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [4/4] time 0.303 (0.293) data 0.256 (0.246) loss_x loss_x 0.3076 (0.3995) acc_x 93.7500 (88.2812) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/18] time 0.326 (0.313) data 0.278 (0.265) loss_u loss_u 0.9194 (0.9623) acc_u 9.3750 (4.3750) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/18] time 0.282 (0.301) data 0.234 (0.254) loss_u loss_u 0.9668 (0.9642) acc_u 3.1250 (4.0625) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/18] time 0.277 (0.296) data 0.230 (0.248) loss_u loss_u 0.9561 (0.9673) acc_u 3.1250 (3.7500) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.1928, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 145
clean true:117
clean false:28
clean_rate:0.8068965517241379
noisy true:258
noisy false:349
after delete: len(clean_dataset) 145
after delete: len(noisy_dataset) 607
epoch [41/200] batch [1/4] time 0.275 (0.275) data 0.227 (0.227) loss_x loss_x 0.7490 (0.7490) acc_x 84.3750 (84.3750) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [2/4] time 0.284 (0.279) data 0.232 (0.230) loss_x loss_x 0.4819 (0.6155) acc_x 87.5000 (85.9375) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [3/4] time 0.297 (0.285) data 0.250 (0.236) loss_x loss_x 0.5605 (0.5972) acc_x 81.2500 (84.3750) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [4/4] time 0.289 (0.286) data 0.242 (0.238) loss_x loss_x 0.2668 (0.5146) acc_x 93.7500 (86.7188) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/18] time 0.290 (0.295) data 0.242 (0.247) loss_u loss_u 0.9565 (0.9608) acc_u 9.3750 (5.6250) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/18] time 0.299 (0.294) data 0.252 (0.247) loss_u loss_u 0.9692 (0.9644) acc_u 6.2500 (5.3125) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/18] time 0.322 (0.296) data 0.274 (0.249) loss_u loss_u 0.9658 (0.9604) acc_u 3.1250 (5.4167) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 380
confident_label rate tensor(0.1981, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 149
clean true:121
clean false:28
clean_rate:0.8120805369127517
noisy true:251
noisy false:352
after delete: len(clean_dataset) 149
after delete: len(noisy_dataset) 603
epoch [42/200] batch [1/4] time 0.312 (0.312) data 0.265 (0.265) loss_x loss_x 0.6797 (0.6797) acc_x 75.0000 (75.0000) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [2/4] time 0.304 (0.308) data 0.257 (0.261) loss_x loss_x 0.1600 (0.4199) acc_x 96.8750 (85.9375) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [3/4] time 0.268 (0.295) data 0.221 (0.248) loss_x loss_x 0.4055 (0.4151) acc_x 93.7500 (88.5417) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [4/4] time 0.291 (0.294) data 0.244 (0.247) loss_x loss_x 0.5942 (0.4599) acc_x 81.2500 (86.7188) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/18] time 0.320 (0.297) data 0.273 (0.250) loss_u loss_u 0.9512 (0.9592) acc_u 9.3750 (5.6250) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/18] time 0.306 (0.296) data 0.258 (0.249) loss_u loss_u 0.9839 (0.9534) acc_u 3.1250 (6.5625) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/18] time 0.311 (0.297) data 0.263 (0.249) loss_u loss_u 0.9707 (0.9582) acc_u 3.1250 (5.6250) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 390
confident_label rate tensor(0.1848, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 139
clean true:118
clean false:21
clean_rate:0.8489208633093526
noisy true:244
noisy false:369
after delete: len(clean_dataset) 139
after delete: len(noisy_dataset) 613
epoch [43/200] batch [1/4] time 0.312 (0.312) data 0.264 (0.264) loss_x loss_x 0.4197 (0.4197) acc_x 87.5000 (87.5000) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [2/4] time 0.240 (0.276) data 0.193 (0.229) loss_x loss_x 0.5942 (0.5070) acc_x 78.1250 (82.8125) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [3/4] time 0.247 (0.266) data 0.197 (0.218) loss_x loss_x 0.3418 (0.4519) acc_x 93.7500 (86.4583) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [4/4] time 0.254 (0.263) data 0.204 (0.215) loss_x loss_x 0.2053 (0.3903) acc_x 96.8750 (89.0625) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/19] time 0.303 (0.289) data 0.256 (0.241) loss_u loss_u 0.9731 (0.9746) acc_u 3.1250 (3.1250) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/19] time 0.309 (0.291) data 0.261 (0.243) loss_u loss_u 0.9751 (0.9680) acc_u 3.1250 (3.7500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/19] time 0.302 (0.295) data 0.255 (0.247) loss_u loss_u 0.9590 (0.9627) acc_u 3.1250 (4.1667) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 375
confident_label rate tensor(0.2048, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 154
clean true:122
clean false:32
clean_rate:0.7922077922077922
noisy true:255
noisy false:343
after delete: len(clean_dataset) 154
after delete: len(noisy_dataset) 598
epoch [44/200] batch [1/4] time 0.288 (0.288) data 0.240 (0.240) loss_x loss_x 0.4456 (0.4456) acc_x 90.6250 (90.6250) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [2/4] time 0.279 (0.283) data 0.232 (0.236) loss_x loss_x 0.2957 (0.3706) acc_x 93.7500 (92.1875) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [3/4] time 0.300 (0.289) data 0.253 (0.242) loss_x loss_x 0.8340 (0.5251) acc_x 81.2500 (88.5417) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [4/4] time 0.252 (0.280) data 0.205 (0.232) loss_x loss_x 0.2646 (0.4600) acc_x 96.8750 (90.6250) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/18] time 0.302 (0.288) data 0.252 (0.240) loss_u loss_u 0.9824 (0.9761) acc_u 3.1250 (2.5000) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/18] time 0.283 (0.291) data 0.236 (0.243) loss_u loss_u 0.9961 (0.9714) acc_u 0.0000 (2.8125) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/18] time 0.290 (0.295) data 0.242 (0.247) loss_u loss_u 0.9478 (0.9686) acc_u 9.3750 (3.3333) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 390
confident_label rate tensor(0.1981, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 149
clean true:120
clean false:29
clean_rate:0.8053691275167785
noisy true:242
noisy false:361
after delete: len(clean_dataset) 149
after delete: len(noisy_dataset) 603
epoch [45/200] batch [1/4] time 0.298 (0.298) data 0.250 (0.250) loss_x loss_x 0.4792 (0.4792) acc_x 84.3750 (84.3750) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [2/4] time 0.317 (0.307) data 0.268 (0.259) loss_x loss_x 0.2725 (0.3759) acc_x 96.8750 (90.6250) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [3/4] time 0.298 (0.304) data 0.251 (0.256) loss_x loss_x 0.2351 (0.3289) acc_x 93.7500 (91.6667) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [4/4] time 0.309 (0.305) data 0.262 (0.257) loss_x loss_x 0.1937 (0.2951) acc_x 96.8750 (92.9688) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/18] time 0.309 (0.313) data 0.261 (0.265) loss_u loss_u 0.9795 (0.9619) acc_u 3.1250 (3.7500) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/18] time 0.271 (0.302) data 0.224 (0.254) loss_u loss_u 0.9761 (0.9646) acc_u 6.2500 (3.7500) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/18] time 0.284 (0.302) data 0.236 (0.255) loss_u loss_u 0.9678 (0.9626) acc_u 3.1250 (4.1667) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 383
confident_label rate tensor(0.2021, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 152
clean true:124
clean false:28
clean_rate:0.8157894736842105
noisy true:245
noisy false:355
after delete: len(clean_dataset) 152
after delete: len(noisy_dataset) 600
epoch [46/200] batch [1/4] time 0.307 (0.307) data 0.260 (0.260) loss_x loss_x 0.2786 (0.2786) acc_x 93.7500 (93.7500) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [2/4] time 0.284 (0.296) data 0.237 (0.249) loss_x loss_x 0.2954 (0.2870) acc_x 87.5000 (90.6250) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [3/4] time 0.273 (0.288) data 0.226 (0.241) loss_x loss_x 0.2773 (0.2838) acc_x 93.7500 (91.6667) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [4/4] time 0.315 (0.295) data 0.267 (0.248) loss_x loss_x 0.6431 (0.3736) acc_x 84.3750 (89.8438) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/18] time 0.309 (0.296) data 0.261 (0.248) loss_u loss_u 0.9844 (0.9760) acc_u 3.1250 (3.1250) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/18] time 0.337 (0.297) data 0.290 (0.249) loss_u loss_u 0.9360 (0.9696) acc_u 6.2500 (3.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/18] time 0.285 (0.299) data 0.238 (0.252) loss_u loss_u 0.9688 (0.9654) acc_u 3.1250 (4.3750) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 385
confident_label rate tensor(0.1995, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 150
clean true:121
clean false:29
clean_rate:0.8066666666666666
noisy true:246
noisy false:356
after delete: len(clean_dataset) 150
after delete: len(noisy_dataset) 602
epoch [47/200] batch [1/4] time 0.295 (0.295) data 0.248 (0.248) loss_x loss_x 0.3782 (0.3782) acc_x 87.5000 (87.5000) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [2/4] time 0.294 (0.295) data 0.247 (0.247) loss_x loss_x 0.8301 (0.6041) acc_x 78.1250 (82.8125) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [3/4] time 0.244 (0.278) data 0.195 (0.230) loss_x loss_x 0.3267 (0.5116) acc_x 90.6250 (85.4167) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [4/4] time 0.288 (0.280) data 0.241 (0.232) loss_x loss_x 0.2394 (0.4436) acc_x 93.7500 (87.5000) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/18] time 0.295 (0.298) data 0.248 (0.250) loss_u loss_u 0.9985 (0.9674) acc_u 0.0000 (3.1250) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/18] time 0.299 (0.294) data 0.250 (0.246) loss_u loss_u 0.9658 (0.9638) acc_u 3.1250 (4.0625) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/18] time 0.309 (0.293) data 0.261 (0.245) loss_u loss_u 0.9556 (0.9609) acc_u 6.2500 (5.0000) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.1981, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 149
clean true:123
clean false:26
clean_rate:0.825503355704698
noisy true:264
noisy false:339
after delete: len(clean_dataset) 149
after delete: len(noisy_dataset) 603
epoch [48/200] batch [1/4] time 0.279 (0.279) data 0.232 (0.232) loss_x loss_x 0.3376 (0.3376) acc_x 96.8750 (96.8750) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [2/4] time 0.300 (0.289) data 0.253 (0.242) loss_x loss_x 0.7046 (0.5211) acc_x 90.6250 (93.7500) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [3/4] time 0.292 (0.290) data 0.245 (0.243) loss_x loss_x 0.4717 (0.5046) acc_x 81.2500 (89.5833) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [4/4] time 0.269 (0.285) data 0.221 (0.238) loss_x loss_x 0.3506 (0.4661) acc_x 90.6250 (89.8438) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/18] time 0.292 (0.296) data 0.244 (0.249) loss_u loss_u 0.9370 (0.9523) acc_u 9.3750 (6.2500) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/18] time 0.273 (0.292) data 0.225 (0.244) loss_u loss_u 0.9526 (0.9618) acc_u 6.2500 (5.0000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/18] time 0.309 (0.297) data 0.261 (0.250) loss_u loss_u 0.9453 (0.9622) acc_u 6.2500 (4.7917) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 362
confident_label rate tensor(0.2061, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 155
clean true:127
clean false:28
clean_rate:0.8193548387096774
noisy true:263
noisy false:334
after delete: len(clean_dataset) 155
after delete: len(noisy_dataset) 597
epoch [49/200] batch [1/4] time 0.322 (0.322) data 0.275 (0.275) loss_x loss_x 0.2090 (0.2090) acc_x 100.0000 (100.0000) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [2/4] time 0.266 (0.294) data 0.219 (0.247) loss_x loss_x 0.4648 (0.3369) acc_x 90.6250 (95.3125) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [3/4] time 0.293 (0.294) data 0.246 (0.247) loss_x loss_x 0.3074 (0.3271) acc_x 90.6250 (93.7500) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [4/4] time 0.314 (0.299) data 0.267 (0.252) loss_x loss_x 0.1995 (0.2952) acc_x 96.8750 (94.5312) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/18] time 0.286 (0.303) data 0.239 (0.255) loss_u loss_u 0.9985 (0.9547) acc_u 0.0000 (5.6250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/18] time 0.322 (0.301) data 0.275 (0.253) loss_u loss_u 0.9624 (0.9652) acc_u 6.2500 (4.3750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/18] time 0.311 (0.300) data 0.264 (0.251) loss_u loss_u 0.9937 (0.9713) acc_u 0.0000 (3.1250) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2141, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 161
clean true:131
clean false:30
clean_rate:0.8136645962732919
noisy true:254
noisy false:337
after delete: len(clean_dataset) 161
after delete: len(noisy_dataset) 591
epoch [50/200] batch [5/5] time 0.285 (0.287) data 0.238 (0.240) loss_x loss_x 0.4492 (0.3438) acc_x 90.6250 (91.8750) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/18] time 0.266 (0.290) data 0.218 (0.243) loss_u loss_u 0.9902 (0.9578) acc_u 0.0000 (5.6250) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/18] time 0.280 (0.293) data 0.232 (0.246) loss_u loss_u 0.9712 (0.9588) acc_u 6.2500 (5.3125) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/18] time 0.293 (0.296) data 0.246 (0.248) loss_u loss_u 0.9985 (0.9671) acc_u 0.0000 (4.1667) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2128, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 160
clean true:128
clean false:32
clean_rate:0.8
noisy true:260
noisy false:332
after delete: len(clean_dataset) 160
after delete: len(noisy_dataset) 592
epoch [51/200] batch [5/5] time 0.339 (0.299) data 0.291 (0.252) loss_x loss_x 0.3486 (0.3945) acc_x 90.6250 (91.2500) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/18] time 0.314 (0.310) data 0.266 (0.262) loss_u loss_u 0.9629 (0.9751) acc_u 3.1250 (2.5000) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/18] time 0.329 (0.317) data 0.282 (0.270) loss_u loss_u 0.9922 (0.9702) acc_u 0.0000 (2.8125) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/18] time 0.308 (0.314) data 0.260 (0.266) loss_u loss_u 0.9653 (0.9636) acc_u 3.1250 (3.5417) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 383
confident_label rate tensor(0.2088, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 157
clean true:126
clean false:31
clean_rate:0.802547770700637
noisy true:243
noisy false:352
after delete: len(clean_dataset) 157
after delete: len(noisy_dataset) 595
epoch [52/200] batch [1/4] time 0.342 (0.342) data 0.295 (0.295) loss_x loss_x 0.2629 (0.2629) acc_x 96.8750 (96.8750) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [2/4] time 0.310 (0.326) data 0.263 (0.279) loss_x loss_x 0.3257 (0.2943) acc_x 96.8750 (96.8750) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [3/4] time 0.275 (0.309) data 0.228 (0.262) loss_x loss_x 0.4270 (0.3385) acc_x 84.3750 (92.7083) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [4/4] time 0.308 (0.309) data 0.260 (0.261) loss_x loss_x 0.2449 (0.3151) acc_x 93.7500 (92.9688) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/18] time 0.312 (0.300) data 0.264 (0.252) loss_u loss_u 0.9980 (0.9881) acc_u 0.0000 (1.2500) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/18] time 0.317 (0.293) data 0.270 (0.245) loss_u loss_u 0.9722 (0.9677) acc_u 3.1250 (3.7500) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/18] time 0.314 (0.294) data 0.266 (0.246) loss_u loss_u 0.9839 (0.9590) acc_u 0.0000 (4.5833) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 361
confident_label rate tensor(0.2088, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 157
clean true:129
clean false:28
clean_rate:0.821656050955414
noisy true:262
noisy false:333
after delete: len(clean_dataset) 157
after delete: len(noisy_dataset) 595
epoch [53/200] batch [1/4] time 0.308 (0.308) data 0.261 (0.261) loss_x loss_x 0.2585 (0.2585) acc_x 93.7500 (93.7500) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [2/4] time 0.286 (0.297) data 0.236 (0.249) loss_x loss_x 0.2754 (0.2670) acc_x 93.7500 (93.7500) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [3/4] time 0.289 (0.294) data 0.242 (0.246) loss_x loss_x 0.3904 (0.3081) acc_x 90.6250 (92.7083) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [4/4] time 0.332 (0.304) data 0.285 (0.256) loss_x loss_x 0.1792 (0.2759) acc_x 100.0000 (94.5312) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/18] time 0.325 (0.310) data 0.277 (0.262) loss_u loss_u 0.9727 (0.9439) acc_u 3.1250 (6.2500) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/18] time 0.298 (0.307) data 0.251 (0.259) loss_u loss_u 0.9980 (0.9592) acc_u 0.0000 (5.0000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/18] time 0.322 (0.303) data 0.275 (0.256) loss_u loss_u 0.9937 (0.9563) acc_u 0.0000 (5.0000) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 355
confident_label rate tensor(0.2207, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 166
clean true:134
clean false:32
clean_rate:0.8072289156626506
noisy true:263
noisy false:323
after delete: len(clean_dataset) 166
after delete: len(noisy_dataset) 586
epoch [54/200] batch [5/5] time 0.258 (0.274) data 0.211 (0.227) loss_x loss_x 0.3049 (0.5012) acc_x 93.7500 (88.1250) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/18] time 0.271 (0.282) data 0.223 (0.235) loss_u loss_u 0.9839 (0.9618) acc_u 3.1250 (5.0000) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/18] time 0.328 (0.286) data 0.280 (0.238) loss_u loss_u 0.9805 (0.9625) acc_u 3.1250 (4.6875) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/18] time 0.295 (0.288) data 0.248 (0.240) loss_u loss_u 0.9810 (0.9628) acc_u 3.1250 (4.5833) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2274, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 171
clean true:135
clean false:36
clean_rate:0.7894736842105263
noisy true:248
noisy false:333
after delete: len(clean_dataset) 171
after delete: len(noisy_dataset) 581
epoch [55/200] batch [5/5] time 0.282 (0.324) data 0.235 (0.275) loss_x loss_x 0.4749 (0.4495) acc_x 90.6250 (89.3750) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/18] time 0.286 (0.306) data 0.238 (0.258) loss_u loss_u 0.9897 (0.9593) acc_u 0.0000 (5.0000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/18] time 0.291 (0.298) data 0.243 (0.251) loss_u loss_u 0.9971 (0.9659) acc_u 0.0000 (4.0625) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/18] time 0.294 (0.299) data 0.245 (0.251) loss_u loss_u 0.9507 (0.9695) acc_u 6.2500 (3.7500) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2101, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 158
clean true:123
clean false:35
clean_rate:0.7784810126582279
noisy true:258
noisy false:336
after delete: len(clean_dataset) 158
after delete: len(noisy_dataset) 594
epoch [56/200] batch [1/4] time 0.302 (0.302) data 0.252 (0.252) loss_x loss_x 0.5474 (0.5474) acc_x 81.2500 (81.2500) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [2/4] time 0.287 (0.294) data 0.239 (0.246) loss_x loss_x 0.5898 (0.5686) acc_x 84.3750 (82.8125) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [3/4] time 0.251 (0.280) data 0.204 (0.232) loss_x loss_x 0.8760 (0.6711) acc_x 78.1250 (81.2500) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [4/4] time 0.289 (0.282) data 0.242 (0.234) loss_x loss_x 0.3718 (0.5963) acc_x 90.6250 (83.5938) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/18] time 0.248 (0.282) data 0.201 (0.234) loss_u loss_u 0.8823 (0.9375) acc_u 15.6250 (6.8750) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/18] time 0.318 (0.291) data 0.270 (0.243) loss_u loss_u 0.9800 (0.9552) acc_u 3.1250 (4.6875) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/18] time 0.291 (0.292) data 0.243 (0.244) loss_u loss_u 0.9424 (0.9595) acc_u 6.2500 (4.3750) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 382
confident_label rate tensor(0.2048, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 154
clean true:122
clean false:32
clean_rate:0.7922077922077922
noisy true:248
noisy false:350
after delete: len(clean_dataset) 154
after delete: len(noisy_dataset) 598
epoch [57/200] batch [1/4] time 0.245 (0.245) data 0.198 (0.198) loss_x loss_x 0.3113 (0.3113) acc_x 90.6250 (90.6250) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [2/4] time 0.269 (0.257) data 0.222 (0.210) loss_x loss_x 0.5215 (0.4164) acc_x 90.6250 (90.6250) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [3/4] time 0.287 (0.267) data 0.240 (0.220) loss_x loss_x 0.3635 (0.3988) acc_x 90.6250 (90.6250) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [4/4] time 0.292 (0.273) data 0.245 (0.226) loss_x loss_x 0.1761 (0.3431) acc_x 100.0000 (92.9688) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/18] time 0.277 (0.295) data 0.229 (0.248) loss_u loss_u 0.9966 (0.9500) acc_u 0.0000 (5.6250) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/18] time 0.278 (0.296) data 0.231 (0.248) loss_u loss_u 0.9053 (0.9524) acc_u 12.5000 (5.9375) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/18] time 0.286 (0.297) data 0.238 (0.250) loss_u loss_u 0.9419 (0.9546) acc_u 6.2500 (5.4167) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 164
clean true:130
clean false:34
clean_rate:0.7926829268292683
noisy true:254
noisy false:334
after delete: len(clean_dataset) 164
after delete: len(noisy_dataset) 588
epoch [58/200] batch [5/5] time 0.289 (0.281) data 0.241 (0.233) loss_x loss_x 0.2847 (0.2816) acc_x 90.6250 (91.8750) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/18] time 0.298 (0.287) data 0.251 (0.239) loss_u loss_u 0.9780 (0.9805) acc_u 3.1250 (2.5000) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/18] time 0.305 (0.288) data 0.257 (0.240) loss_u loss_u 0.9097 (0.9624) acc_u 9.3750 (4.3750) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/18] time 0.269 (0.289) data 0.221 (0.241) loss_u loss_u 0.9629 (0.9659) acc_u 6.2500 (3.7500) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2141, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 161
clean true:128
clean false:33
clean_rate:0.7950310559006211
noisy true:245
noisy false:346
after delete: len(clean_dataset) 161
after delete: len(noisy_dataset) 591
epoch [59/200] batch [5/5] time 0.278 (0.285) data 0.230 (0.238) loss_x loss_x 0.2983 (0.3723) acc_x 90.6250 (92.5000) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/18] time 0.277 (0.291) data 0.229 (0.244) loss_u loss_u 0.9688 (0.9731) acc_u 3.1250 (3.1250) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/18] time 0.322 (0.289) data 0.275 (0.242) loss_u loss_u 0.9551 (0.9620) acc_u 6.2500 (4.3750) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/18] time 0.256 (0.292) data 0.208 (0.244) loss_u loss_u 0.9526 (0.9633) acc_u 6.2500 (4.1667) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2207, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 166
clean true:135
clean false:31
clean_rate:0.8132530120481928
noisy true:239
noisy false:347
after delete: len(clean_dataset) 166
after delete: len(noisy_dataset) 586
epoch [60/200] batch [5/5] time 0.283 (0.294) data 0.235 (0.246) loss_x loss_x 0.2971 (0.4183) acc_x 93.7500 (90.0000) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/18] time 0.308 (0.295) data 0.256 (0.247) loss_u loss_u 0.9702 (0.9844) acc_u 3.1250 (0.6250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/18] time 0.295 (0.297) data 0.247 (0.249) loss_u loss_u 0.9438 (0.9683) acc_u 6.2500 (3.4375) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/18] time 0.305 (0.296) data 0.257 (0.248) loss_u loss_u 0.9673 (0.9721) acc_u 3.1250 (3.3333) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 392
confident_label rate tensor(0.2221, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 167
clean true:129
clean false:38
clean_rate:0.7724550898203593
noisy true:231
noisy false:354
after delete: len(clean_dataset) 167
after delete: len(noisy_dataset) 585
epoch [61/200] batch [5/5] time 0.322 (0.290) data 0.275 (0.243) loss_x loss_x 0.3293 (0.3644) acc_x 90.6250 (91.8750) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/18] time 0.298 (0.293) data 0.251 (0.246) loss_u loss_u 0.9834 (0.9818) acc_u 0.0000 (1.2500) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/18] time 0.267 (0.293) data 0.219 (0.246) loss_u loss_u 0.9648 (0.9702) acc_u 3.1250 (2.8125) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/18] time 0.302 (0.293) data 0.254 (0.245) loss_u loss_u 0.9683 (0.9721) acc_u 3.1250 (2.7083) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 358
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 165
clean true:135
clean false:30
clean_rate:0.8181818181818182
noisy true:259
noisy false:328
after delete: len(clean_dataset) 165
after delete: len(noisy_dataset) 587
epoch [62/200] batch [5/5] time 0.290 (0.286) data 0.244 (0.239) loss_x loss_x 0.2817 (0.3250) acc_x 90.6250 (90.6250) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/18] time 0.265 (0.285) data 0.218 (0.238) loss_u loss_u 0.9736 (0.9510) acc_u 3.1250 (6.2500) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/18] time 0.274 (0.288) data 0.227 (0.240) loss_u loss_u 0.9868 (0.9645) acc_u 3.1250 (4.6875) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/18] time 0.304 (0.292) data 0.257 (0.245) loss_u loss_u 0.9824 (0.9680) acc_u 0.0000 (3.7500) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2247, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 169
clean true:134
clean false:35
clean_rate:0.7928994082840237
noisy true:250
noisy false:333
after delete: len(clean_dataset) 169
after delete: len(noisy_dataset) 583
epoch [63/200] batch [5/5] time 0.278 (0.293) data 0.231 (0.245) loss_x loss_x 0.3997 (0.4403) acc_x 90.6250 (89.3750) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/18] time 0.263 (0.290) data 0.216 (0.242) loss_u loss_u 0.9678 (0.9765) acc_u 3.1250 (2.5000) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/18] time 0.321 (0.300) data 0.274 (0.253) loss_u loss_u 0.9585 (0.9719) acc_u 6.2500 (3.7500) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/18] time 0.307 (0.300) data 0.260 (0.252) loss_u loss_u 0.9941 (0.9753) acc_u 0.0000 (3.1250) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 362
confident_label rate tensor(0.2261, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 170
clean true:132
clean false:38
clean_rate:0.7764705882352941
noisy true:258
noisy false:324
after delete: len(clean_dataset) 170
after delete: len(noisy_dataset) 582
epoch [64/200] batch [5/5] time 0.280 (0.296) data 0.233 (0.248) loss_x loss_x 0.4062 (0.4185) acc_x 87.5000 (90.0000) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/18] time 0.293 (0.297) data 0.245 (0.249) loss_u loss_u 0.9810 (0.9569) acc_u 3.1250 (4.3750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/18] time 0.282 (0.293) data 0.234 (0.245) loss_u loss_u 0.8911 (0.9467) acc_u 12.5000 (5.6250) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/18] time 0.286 (0.294) data 0.238 (0.246) loss_u loss_u 0.9941 (0.9576) acc_u 0.0000 (4.5833) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 165
clean true:133
clean false:32
clean_rate:0.806060606060606
noisy true:243
noisy false:344
after delete: len(clean_dataset) 165
after delete: len(noisy_dataset) 587
epoch [65/200] batch [5/5] time 0.272 (0.302) data 0.225 (0.255) loss_x loss_x 0.3428 (0.3398) acc_x 90.6250 (92.5000) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/18] time 0.306 (0.304) data 0.258 (0.256) loss_u loss_u 0.9990 (0.9800) acc_u 0.0000 (3.1250) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/18] time 0.312 (0.296) data 0.265 (0.248) loss_u loss_u 0.9346 (0.9673) acc_u 12.5000 (4.3750) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/18] time 0.275 (0.291) data 0.228 (0.244) loss_u loss_u 0.9419 (0.9636) acc_u 6.2500 (4.5833) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 344
confident_label rate tensor(0.2354, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 177
clean true:142
clean false:35
clean_rate:0.8022598870056498
noisy true:266
noisy false:309
after delete: len(clean_dataset) 177
after delete: len(noisy_dataset) 575
epoch [66/200] batch [5/5] time 0.296 (0.294) data 0.248 (0.247) loss_x loss_x 0.5474 (0.4954) acc_x 84.3750 (90.0000) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/17] time 0.298 (0.290) data 0.251 (0.243) loss_u loss_u 0.9917 (0.9685) acc_u 0.0000 (3.7500) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/17] time 0.270 (0.288) data 0.223 (0.241) loss_u loss_u 0.9707 (0.9698) acc_u 3.1250 (3.4375) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/17] time 0.328 (0.295) data 0.281 (0.247) loss_u loss_u 0.9673 (0.9722) acc_u 3.1250 (3.1250) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 360
confident_label rate tensor(0.2207, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 166
clean true:135
clean false:31
clean_rate:0.8132530120481928
noisy true:257
noisy false:329
after delete: len(clean_dataset) 166
after delete: len(noisy_dataset) 586
epoch [67/200] batch [5/5] time 0.307 (0.298) data 0.260 (0.250) loss_x loss_x 0.2979 (0.2874) acc_x 93.7500 (91.8750) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/18] time 0.303 (0.308) data 0.256 (0.260) loss_u loss_u 0.9438 (0.9521) acc_u 6.2500 (5.0000) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/18] time 0.290 (0.301) data 0.242 (0.253) loss_u loss_u 0.9736 (0.9500) acc_u 3.1250 (5.3125) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/18] time 0.292 (0.300) data 0.245 (0.252) loss_u loss_u 0.9448 (0.9571) acc_u 6.2500 (4.5833) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2367, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 178
clean true:137
clean false:41
clean_rate:0.7696629213483146
noisy true:243
noisy false:331
after delete: len(clean_dataset) 178
after delete: len(noisy_dataset) 574
epoch [68/200] batch [5/5] time 0.274 (0.291) data 0.227 (0.244) loss_x loss_x 0.2343 (0.3647) acc_x 93.7500 (92.5000) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/17] time 0.302 (0.294) data 0.255 (0.247) loss_u loss_u 0.9692 (0.9668) acc_u 3.1250 (3.1250) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/17] time 0.321 (0.303) data 0.273 (0.255) loss_u loss_u 0.9785 (0.9715) acc_u 3.1250 (3.4375) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/17] time 0.279 (0.294) data 0.231 (0.247) loss_u loss_u 0.9458 (0.9686) acc_u 6.2500 (3.7500) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2340, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 176
clean true:138
clean false:38
clean_rate:0.7840909090909091
noisy true:248
noisy false:328
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 576
epoch [69/200] batch [5/5] time 0.277 (0.298) data 0.230 (0.251) loss_x loss_x 0.3530 (0.3135) acc_x 90.6250 (91.8750) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/18] time 0.284 (0.295) data 0.237 (0.247) loss_u loss_u 0.9863 (0.9584) acc_u 0.0000 (4.3750) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/18] time 0.300 (0.299) data 0.252 (0.251) loss_u loss_u 0.9644 (0.9622) acc_u 3.1250 (3.7500) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/18] time 0.325 (0.300) data 0.278 (0.252) loss_u loss_u 0.9932 (0.9687) acc_u 0.0000 (2.9167) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 354
confident_label rate tensor(0.2380, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 179
clean true:136
clean false:43
clean_rate:0.7597765363128491
noisy true:262
noisy false:311
after delete: len(clean_dataset) 179
after delete: len(noisy_dataset) 573
epoch [70/200] batch [5/5] time 0.297 (0.301) data 0.247 (0.253) loss_x loss_x 0.2183 (0.3155) acc_x 96.8750 (95.0000) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/17] time 0.278 (0.298) data 0.231 (0.251) loss_u loss_u 0.9663 (0.9624) acc_u 3.1250 (4.3750) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/17] time 0.289 (0.296) data 0.240 (0.248) loss_u loss_u 0.9658 (0.9607) acc_u 3.1250 (4.3750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/17] time 0.291 (0.295) data 0.243 (0.248) loss_u loss_u 0.9551 (0.9682) acc_u 3.1250 (3.3333) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 182
clean true:142
clean false:40
clean_rate:0.7802197802197802
noisy true:246
noisy false:324
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 570
epoch [71/200] batch [5/5] time 0.290 (0.285) data 0.243 (0.237) loss_x loss_x 0.1764 (0.4270) acc_x 96.8750 (94.3750) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/17] time 0.287 (0.291) data 0.240 (0.243) loss_u loss_u 0.9976 (0.9579) acc_u 0.0000 (4.3750) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/17] time 0.319 (0.294) data 0.272 (0.246) loss_u loss_u 0.9932 (0.9729) acc_u 0.0000 (2.8125) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/17] time 0.304 (0.296) data 0.257 (0.248) loss_u loss_u 0.9922 (0.9763) acc_u 0.0000 (2.5000) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.2327, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 175
clean true:129
clean false:46
clean_rate:0.7371428571428571
noisy true:249
noisy false:328
after delete: len(clean_dataset) 175
after delete: len(noisy_dataset) 577
epoch [72/200] batch [5/5] time 0.350 (0.310) data 0.303 (0.262) loss_x loss_x 0.4990 (0.4123) acc_x 96.8750 (90.0000) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/18] time 0.312 (0.321) data 0.263 (0.273) loss_u loss_u 0.9976 (0.9537) acc_u 0.0000 (4.3750) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [10/18] time 0.303 (0.315) data 0.255 (0.267) loss_u loss_u 0.9722 (0.9614) acc_u 3.1250 (3.7500) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/18] time 0.308 (0.310) data 0.261 (0.263) loss_u loss_u 0.9634 (0.9646) acc_u 3.1250 (3.5417) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 348
confident_label rate tensor(0.2261, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 170
clean true:135
clean false:35
clean_rate:0.7941176470588235
noisy true:269
noisy false:313
after delete: len(clean_dataset) 170
after delete: len(noisy_dataset) 582
epoch [73/200] batch [5/5] time 0.305 (0.286) data 0.258 (0.238) loss_x loss_x 0.2554 (0.4787) acc_x 93.7500 (89.3750) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/18] time 0.332 (0.295) data 0.285 (0.247) loss_u loss_u 0.9688 (0.9539) acc_u 3.1250 (5.6250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/18] time 0.327 (0.302) data 0.279 (0.255) loss_u loss_u 0.9614 (0.9659) acc_u 3.1250 (3.7500) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/18] time 0.351 (0.306) data 0.303 (0.258) loss_u loss_u 0.9521 (0.9624) acc_u 3.1250 (3.9583) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2367, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 178
clean true:138
clean false:40
clean_rate:0.7752808988764045
noisy true:242
noisy false:332
after delete: len(clean_dataset) 178
after delete: len(noisy_dataset) 574
epoch [74/200] batch [5/5] time 0.293 (0.293) data 0.246 (0.245) loss_x loss_x 0.5176 (0.4289) acc_x 84.3750 (86.8750) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/17] time 0.287 (0.308) data 0.240 (0.260) loss_u loss_u 0.8760 (0.9552) acc_u 15.6250 (5.6250) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/17] time 0.284 (0.302) data 0.237 (0.254) loss_u loss_u 0.9976 (0.9617) acc_u 0.0000 (4.0625) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/17] time 0.284 (0.300) data 0.236 (0.253) loss_u loss_u 0.9702 (0.9680) acc_u 3.1250 (3.3333) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 381
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 174
clean true:136
clean false:38
clean_rate:0.7816091954022989
noisy true:235
noisy false:343
after delete: len(clean_dataset) 174
after delete: len(noisy_dataset) 578
epoch [75/200] batch [5/5] time 0.302 (0.293) data 0.255 (0.245) loss_x loss_x 0.3435 (0.4039) acc_x 93.7500 (93.1250) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/18] time 0.328 (0.297) data 0.280 (0.249) loss_u loss_u 0.9692 (0.9663) acc_u 3.1250 (3.7500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/18] time 0.258 (0.293) data 0.210 (0.246) loss_u loss_u 0.9712 (0.9614) acc_u 3.1250 (4.6875) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/18] time 0.321 (0.295) data 0.273 (0.247) loss_u loss_u 0.9653 (0.9619) acc_u 3.1250 (4.3750) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.2354, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 177
clean true:134
clean false:43
clean_rate:0.7570621468926554
noisy true:244
noisy false:331
after delete: len(clean_dataset) 177
after delete: len(noisy_dataset) 575
epoch [76/200] batch [5/5] time 0.321 (0.318) data 0.274 (0.270) loss_x loss_x 0.1533 (0.4176) acc_x 96.8750 (92.5000) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/17] time 0.326 (0.314) data 0.278 (0.266) loss_u loss_u 0.9800 (0.9692) acc_u 3.1250 (4.3750) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/17] time 0.289 (0.307) data 0.242 (0.259) loss_u loss_u 0.9990 (0.9692) acc_u 0.0000 (3.7500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/17] time 0.324 (0.308) data 0.277 (0.260) loss_u loss_u 0.9980 (0.9666) acc_u 0.0000 (3.9583) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.2380, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 179
clean true:139
clean false:40
clean_rate:0.776536312849162
noisy true:236
noisy false:337
after delete: len(clean_dataset) 179
after delete: len(noisy_dataset) 573
epoch [77/200] batch [5/5] time 0.272 (0.281) data 0.224 (0.234) loss_x loss_x 0.2036 (0.2484) acc_x 93.7500 (93.1250) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/17] time 0.282 (0.294) data 0.234 (0.247) loss_u loss_u 0.9473 (0.9683) acc_u 6.2500 (3.7500) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/17] time 0.314 (0.299) data 0.267 (0.252) loss_u loss_u 0.9902 (0.9658) acc_u 3.1250 (4.0625) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/17] time 0.268 (0.298) data 0.220 (0.250) loss_u loss_u 0.9194 (0.9701) acc_u 9.3750 (3.5417) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 381
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:139
clean false:44
clean_rate:0.7595628415300546
noisy true:232
noisy false:337
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [78/200] batch [5/5] time 0.313 (0.306) data 0.266 (0.258) loss_x loss_x 0.2433 (0.2539) acc_x 93.7500 (94.3750) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/17] time 0.313 (0.290) data 0.266 (0.242) loss_u loss_u 0.9722 (0.9742) acc_u 3.1250 (2.5000) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/17] time 0.309 (0.298) data 0.261 (0.250) loss_u loss_u 0.9512 (0.9724) acc_u 3.1250 (2.8125) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/17] time 0.288 (0.297) data 0.240 (0.249) loss_u loss_u 0.9985 (0.9715) acc_u 0.0000 (2.9167) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2340, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 176
clean true:136
clean false:40
clean_rate:0.7727272727272727
noisy true:240
noisy false:336
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 576
epoch [79/200] batch [5/5] time 0.293 (0.292) data 0.246 (0.245) loss_x loss_x 0.2482 (0.2998) acc_x 93.7500 (92.5000) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/18] time 0.316 (0.300) data 0.268 (0.252) loss_u loss_u 0.9990 (0.9682) acc_u 0.0000 (3.7500) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/18] time 0.298 (0.305) data 0.251 (0.257) loss_u loss_u 0.9033 (0.9562) acc_u 12.5000 (4.6875) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/18] time 0.286 (0.301) data 0.239 (0.254) loss_u loss_u 0.9810 (0.9652) acc_u 3.1250 (3.7500) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2354, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 177
clean true:135
clean false:42
clean_rate:0.7627118644067796
noisy true:241
noisy false:334
after delete: len(clean_dataset) 177
after delete: len(noisy_dataset) 575
epoch [80/200] batch [5/5] time 0.309 (0.316) data 0.262 (0.268) loss_x loss_x 0.2561 (0.2996) acc_x 96.8750 (92.5000) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/17] time 0.303 (0.309) data 0.255 (0.261) loss_u loss_u 0.9697 (0.9481) acc_u 3.1250 (5.6250) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/17] time 0.290 (0.304) data 0.243 (0.256) loss_u loss_u 0.9902 (0.9506) acc_u 0.0000 (5.0000) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/17] time 0.331 (0.307) data 0.283 (0.259) loss_u loss_u 0.9585 (0.9534) acc_u 6.2500 (4.7917) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:139
clean false:45
clean_rate:0.7554347826086957
noisy true:234
noisy false:334
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [81/200] batch [5/5] time 0.316 (0.301) data 0.267 (0.253) loss_x loss_x 0.3882 (0.4339) acc_x 90.6250 (90.0000) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/17] time 0.299 (0.299) data 0.251 (0.251) loss_u loss_u 0.9976 (0.9815) acc_u 0.0000 (1.8750) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/17] time 0.292 (0.305) data 0.245 (0.258) loss_u loss_u 0.9370 (0.9690) acc_u 9.3750 (3.7500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/17] time 0.304 (0.307) data 0.256 (0.259) loss_u loss_u 0.9780 (0.9750) acc_u 3.1250 (2.9167) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2407, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 181
clean true:138
clean false:43
clean_rate:0.7624309392265194
noisy true:250
noisy false:321
after delete: len(clean_dataset) 181
after delete: len(noisy_dataset) 571
epoch [82/200] batch [5/5] time 0.300 (0.303) data 0.253 (0.255) loss_x loss_x 0.7153 (0.4121) acc_x 87.5000 (91.8750) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/17] time 0.317 (0.293) data 0.269 (0.245) loss_u loss_u 0.9556 (0.9625) acc_u 6.2500 (5.0000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/17] time 0.254 (0.291) data 0.207 (0.243) loss_u loss_u 0.9956 (0.9646) acc_u 0.0000 (4.3750) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/17] time 0.301 (0.293) data 0.254 (0.245) loss_u loss_u 0.9951 (0.9660) acc_u 0.0000 (3.7500) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:135
clean false:50
clean_rate:0.7297297297297297
noisy true:250
noisy false:317
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [83/200] batch [5/5] time 0.281 (0.300) data 0.234 (0.253) loss_x loss_x 0.2537 (0.4516) acc_x 96.8750 (90.0000) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/17] time 0.316 (0.295) data 0.267 (0.247) loss_u loss_u 0.9980 (0.9544) acc_u 0.0000 (3.7500) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/17] time 0.254 (0.295) data 0.206 (0.247) loss_u loss_u 0.9028 (0.9558) acc_u 12.5000 (4.6875) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/17] time 0.318 (0.298) data 0.270 (0.251) loss_u loss_u 0.9985 (0.9624) acc_u 0.0000 (4.1667) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:142
clean false:42
clean_rate:0.7717391304347826
noisy true:238
noisy false:330
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [84/200] batch [5/5] time 0.283 (0.293) data 0.236 (0.246) loss_x loss_x 0.8052 (0.3827) acc_x 81.2500 (90.6250) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/17] time 0.354 (0.310) data 0.305 (0.263) loss_u loss_u 0.9263 (0.9567) acc_u 9.3750 (5.0000) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/17] time 0.308 (0.329) data 0.261 (0.281) loss_u loss_u 0.9927 (0.9682) acc_u 0.0000 (3.4375) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/17] time 0.285 (0.326) data 0.237 (0.278) loss_u loss_u 0.9204 (0.9598) acc_u 9.3750 (4.5833) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 354
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:145
clean false:39
clean_rate:0.7880434782608695
noisy true:253
noisy false:315
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [85/200] batch [5/5] time 0.298 (0.302) data 0.251 (0.255) loss_x loss_x 0.1583 (0.3064) acc_x 100.0000 (93.7500) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/17] time 0.286 (0.303) data 0.238 (0.256) loss_u loss_u 0.9121 (0.9686) acc_u 12.5000 (3.7500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/17] time 0.326 (0.310) data 0.278 (0.262) loss_u loss_u 0.9888 (0.9734) acc_u 0.0000 (3.1250) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/17] time 0.293 (0.310) data 0.244 (0.262) loss_u loss_u 0.9365 (0.9733) acc_u 6.2500 (2.9167) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 355
confident_label rate tensor(0.2407, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 181
clean true:139
clean false:42
clean_rate:0.7679558011049724
noisy true:258
noisy false:313
after delete: len(clean_dataset) 181
after delete: len(noisy_dataset) 571
epoch [86/200] batch [5/5] time 0.308 (0.311) data 0.261 (0.264) loss_x loss_x 0.2493 (0.2539) acc_x 93.7500 (94.3750) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/17] time 0.323 (0.308) data 0.275 (0.260) loss_u loss_u 0.9971 (0.9589) acc_u 0.0000 (5.0000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/17] time 0.344 (0.307) data 0.297 (0.259) loss_u loss_u 0.9761 (0.9664) acc_u 3.1250 (3.7500) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/17] time 0.307 (0.305) data 0.259 (0.258) loss_u loss_u 0.9941 (0.9692) acc_u 0.0000 (3.3333) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 362
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 188
clean true:145
clean false:43
clean_rate:0.7712765957446809
noisy true:245
noisy false:319
after delete: len(clean_dataset) 188
after delete: len(noisy_dataset) 564
epoch [87/200] batch [5/5] time 0.302 (0.302) data 0.255 (0.254) loss_x loss_x 0.1642 (0.2159) acc_x 96.8750 (95.6250) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/17] time 0.271 (0.295) data 0.224 (0.248) loss_u loss_u 0.9404 (0.9529) acc_u 6.2500 (5.0000) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/17] time 0.283 (0.296) data 0.235 (0.249) loss_u loss_u 0.9951 (0.9609) acc_u 0.0000 (4.0625) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/17] time 0.273 (0.300) data 0.225 (0.252) loss_u loss_u 0.9771 (0.9646) acc_u 3.1250 (3.7500) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2394, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 180
clean true:135
clean false:45
clean_rate:0.75
noisy true:253
noisy false:319
after delete: len(clean_dataset) 180
after delete: len(noisy_dataset) 572
epoch [88/200] batch [5/5] time 0.305 (0.300) data 0.258 (0.252) loss_x loss_x 0.5576 (0.3919) acc_x 93.7500 (94.3750) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/17] time 0.273 (0.291) data 0.225 (0.243) loss_u loss_u 0.9219 (0.9493) acc_u 9.3750 (6.2500) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/17] time 0.326 (0.298) data 0.279 (0.251) loss_u loss_u 0.9932 (0.9562) acc_u 0.0000 (4.6875) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/17] time 0.341 (0.291) data 0.293 (0.243) loss_u loss_u 0.9414 (0.9585) acc_u 6.2500 (4.3750) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 188
clean true:138
clean false:50
clean_rate:0.7340425531914894
noisy true:243
noisy false:321
after delete: len(clean_dataset) 188
after delete: len(noisy_dataset) 564
epoch [89/200] batch [5/5] time 0.305 (0.297) data 0.258 (0.250) loss_x loss_x 0.3115 (0.3999) acc_x 90.6250 (91.8750) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/17] time 0.306 (0.309) data 0.255 (0.261) loss_u loss_u 0.9644 (0.9533) acc_u 3.1250 (5.6250) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/17] time 0.280 (0.302) data 0.233 (0.254) loss_u loss_u 0.9297 (0.9629) acc_u 6.2500 (4.0625) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/17] time 0.258 (0.297) data 0.211 (0.250) loss_u loss_u 0.9902 (0.9613) acc_u 0.0000 (4.1667) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 362
confident_label rate tensor(0.2540, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 191
clean true:144
clean false:47
clean_rate:0.7539267015706806
noisy true:246
noisy false:315
after delete: len(clean_dataset) 191
after delete: len(noisy_dataset) 561
epoch [90/200] batch [5/5] time 0.315 (0.304) data 0.268 (0.257) loss_x loss_x 0.3293 (0.3831) acc_x 93.7500 (91.8750) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/17] time 0.326 (0.307) data 0.279 (0.259) loss_u loss_u 0.9590 (0.9727) acc_u 6.2500 (3.7500) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/17] time 0.290 (0.298) data 0.242 (0.250) loss_u loss_u 0.9536 (0.9661) acc_u 6.2500 (4.0625) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/17] time 0.239 (0.299) data 0.192 (0.251) loss_u loss_u 0.9961 (0.9742) acc_u 0.0000 (2.9167) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 360
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 188
clean true:145
clean false:43
clean_rate:0.7712765957446809
noisy true:247
noisy false:317
after delete: len(clean_dataset) 188
after delete: len(noisy_dataset) 564
epoch [91/200] batch [5/5] time 0.270 (0.315) data 0.223 (0.267) loss_x loss_x 0.2415 (0.2284) acc_x 96.8750 (96.2500) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/17] time 0.301 (0.309) data 0.253 (0.261) loss_u loss_u 0.9658 (0.9569) acc_u 3.1250 (3.7500) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/17] time 0.273 (0.305) data 0.225 (0.257) loss_u loss_u 0.9941 (0.9680) acc_u 0.0000 (2.8125) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/17] time 0.220 (0.299) data 0.171 (0.251) loss_u loss_u 0.9917 (0.9678) acc_u 0.0000 (3.3333) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2513, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 189
clean true:142
clean false:47
clean_rate:0.7513227513227513
noisy true:246
noisy false:317
after delete: len(clean_dataset) 189
after delete: len(noisy_dataset) 563
epoch [92/200] batch [5/5] time 0.297 (0.302) data 0.249 (0.254) loss_x loss_x 0.1703 (0.1805) acc_x 100.0000 (98.7500) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/17] time 0.346 (0.315) data 0.298 (0.267) loss_u loss_u 0.9966 (0.9848) acc_u 0.0000 (1.2500) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/17] time 0.277 (0.311) data 0.230 (0.263) loss_u loss_u 0.9980 (0.9821) acc_u 0.0000 (1.5625) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/17] time 0.278 (0.305) data 0.230 (0.257) loss_u loss_u 0.9688 (0.9694) acc_u 3.1250 (2.9167) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2606, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 196
clean true:145
clean false:51
clean_rate:0.7397959183673469
noisy true:231
noisy false:325
after delete: len(clean_dataset) 196
after delete: len(noisy_dataset) 556
epoch [93/200] batch [5/6] time 0.269 (0.296) data 0.221 (0.248) loss_x loss_x 0.3020 (0.2853) acc_x 90.6250 (95.0000) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/17] time 0.343 (0.317) data 0.295 (0.269) loss_u loss_u 0.9663 (0.9803) acc_u 3.1250 (1.2500) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/17] time 0.337 (0.331) data 0.289 (0.283) loss_u loss_u 0.9512 (0.9802) acc_u 6.2500 (1.5625) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/17] time 0.304 (0.318) data 0.256 (0.270) loss_u loss_u 0.9673 (0.9764) acc_u 3.1250 (2.0833) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 194
clean true:140
clean false:54
clean_rate:0.7216494845360825
noisy true:246
noisy false:312
after delete: len(clean_dataset) 194
after delete: len(noisy_dataset) 558
epoch [94/200] batch [5/6] time 0.329 (0.321) data 0.282 (0.274) loss_x loss_x 0.3093 (0.3725) acc_x 87.5000 (91.2500) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/17] time 0.326 (0.313) data 0.279 (0.265) loss_u loss_u 0.9590 (0.9694) acc_u 6.2500 (3.7500) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/17] time 0.306 (0.314) data 0.259 (0.267) loss_u loss_u 0.9854 (0.9616) acc_u 0.0000 (4.0625) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/17] time 0.292 (0.305) data 0.244 (0.258) loss_u loss_u 0.9707 (0.9621) acc_u 3.1250 (4.1667) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 362
confident_label rate tensor(0.2513, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 189
clean true:145
clean false:44
clean_rate:0.7671957671957672
noisy true:245
noisy false:318
after delete: len(clean_dataset) 189
after delete: len(noisy_dataset) 563
epoch [95/200] batch [5/5] time 0.302 (0.300) data 0.255 (0.253) loss_x loss_x 0.2542 (0.3251) acc_x 93.7500 (91.8750) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/17] time 0.284 (0.304) data 0.236 (0.256) loss_u loss_u 0.9839 (0.9753) acc_u 3.1250 (3.7500) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/17] time 0.291 (0.308) data 0.244 (0.261) loss_u loss_u 0.9839 (0.9750) acc_u 3.1250 (3.1250) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/17] time 0.301 (0.309) data 0.253 (0.261) loss_u loss_u 0.9854 (0.9710) acc_u 3.1250 (3.5417) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 351
confident_label rate tensor(0.2593, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 195
clean true:146
clean false:49
clean_rate:0.7487179487179487
noisy true:255
noisy false:302
after delete: len(clean_dataset) 195
after delete: len(noisy_dataset) 557
epoch [96/200] batch [5/6] time 0.286 (0.296) data 0.237 (0.248) loss_x loss_x 0.1897 (0.2816) acc_x 96.8750 (95.6250) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/17] time 0.275 (0.292) data 0.227 (0.245) loss_u loss_u 0.9834 (0.9826) acc_u 3.1250 (1.8750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/17] time 0.315 (0.303) data 0.267 (0.255) loss_u loss_u 0.9058 (0.9650) acc_u 9.3750 (4.0625) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/17] time 0.309 (0.305) data 0.261 (0.257) loss_u loss_u 0.9580 (0.9696) acc_u 6.2500 (3.5417) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 354
confident_label rate tensor(0.2620, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 197
clean true:151
clean false:46
clean_rate:0.766497461928934
noisy true:247
noisy false:308
after delete: len(clean_dataset) 197
after delete: len(noisy_dataset) 555
epoch [97/200] batch [5/6] time 0.315 (0.307) data 0.268 (0.259) loss_x loss_x 0.2463 (0.2614) acc_x 90.6250 (92.5000) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/17] time 0.298 (0.303) data 0.251 (0.255) loss_u loss_u 0.9932 (0.9760) acc_u 0.0000 (2.5000) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/17] time 0.287 (0.301) data 0.239 (0.253) loss_u loss_u 0.9673 (0.9756) acc_u 3.1250 (2.8125) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/17] time 0.334 (0.303) data 0.286 (0.255) loss_u loss_u 0.9668 (0.9782) acc_u 3.1250 (2.5000) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 194
clean true:149
clean false:45
clean_rate:0.7680412371134021
noisy true:236
noisy false:322
after delete: len(clean_dataset) 194
after delete: len(noisy_dataset) 558
epoch [98/200] batch [5/6] time 0.333 (0.319) data 0.286 (0.272) loss_x loss_x 0.5513 (0.3203) acc_x 87.5000 (91.8750) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/17] time 0.309 (0.303) data 0.261 (0.256) loss_u loss_u 0.9673 (0.9579) acc_u 3.1250 (4.3750) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/17] time 0.295 (0.302) data 0.248 (0.254) loss_u loss_u 0.9990 (0.9772) acc_u 0.0000 (2.1875) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/17] time 0.316 (0.305) data 0.268 (0.257) loss_u loss_u 0.9829 (0.9759) acc_u 3.1250 (2.2917) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2566, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 193
clean true:146
clean false:47
clean_rate:0.7564766839378239
noisy true:242
noisy false:317
after delete: len(clean_dataset) 193
after delete: len(noisy_dataset) 559
epoch [99/200] batch [5/6] time 0.308 (0.309) data 0.261 (0.261) loss_x loss_x 0.3684 (0.3284) acc_x 90.6250 (93.1250) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/17] time 0.306 (0.294) data 0.257 (0.246) loss_u loss_u 0.8823 (0.9470) acc_u 12.5000 (5.6250) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/17] time 0.275 (0.295) data 0.228 (0.247) loss_u loss_u 0.9629 (0.9655) acc_u 3.1250 (3.4375) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/17] time 0.304 (0.300) data 0.257 (0.252) loss_u loss_u 0.9399 (0.9680) acc_u 6.2500 (3.1250) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.2527, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 190
clean true:146
clean false:44
clean_rate:0.7684210526315789
noisy true:232
noisy false:330
all clean rate:  [0.9111111111111111, 0.8717948717948718, 0.8625, 0.8823529411764706, 0.8734177215189873, 0.8805970149253731, 0.918918918918919, 0.8817204301075269, 0.8804347826086957, 0.8777777777777778, 0.8910891089108911, 0.8602150537634409, 0.8673469387755102, 0.8773584905660378, 0.8585858585858586, 0.8867924528301887, 0.898989898989899, 0.8571428571428571, 0.8623853211009175, 0.8849557522123894, 0.8672566371681416, 0.8584070796460177, 0.859504132231405, 0.8583333333333333, 0.8677685950413223, 0.8740157480314961, 0.896551724137931, 0.8650793650793651, 0.8671875, 0.8549618320610687, 0.84251968503937, 0.8951612903225806, 0.8294573643410853, 0.8461538461538461, 0.859375, 0.837037037037037, 0.8321678321678322, 0.8206896551724138, 0.8026315789473685, 0.8299319727891157, 0.8068965517241379, 0.8120805369127517, 0.8489208633093526, 0.7922077922077922, 0.8053691275167785, 0.8157894736842105, 0.8066666666666666, 0.825503355704698, 0.8193548387096774, 0.8136645962732919, 0.8, 0.802547770700637, 0.821656050955414, 0.8072289156626506, 0.7894736842105263, 0.7784810126582279, 0.7922077922077922, 0.7926829268292683, 0.7950310559006211, 0.8132530120481928, 0.7724550898203593, 0.8181818181818182, 0.7928994082840237, 0.7764705882352941, 0.806060606060606, 0.8022598870056498, 0.8132530120481928, 0.7696629213483146, 0.7840909090909091, 0.7597765363128491, 0.7802197802197802, 0.7371428571428571, 0.7941176470588235, 0.7752808988764045, 0.7816091954022989, 0.7570621468926554, 0.776536312849162, 0.7595628415300546, 0.7727272727272727, 0.7627118644067796, 0.7554347826086957, 0.7624309392265194, 0.7297297297297297, 0.7717391304347826, 0.7880434782608695, 0.7679558011049724, 0.7712765957446809, 0.75, 0.7340425531914894, 0.7539267015706806, 0.7712765957446809, 0.7513227513227513, 0.7397959183673469, 0.7216494845360825, 0.7671957671957672, 0.7487179487179487, 0.766497461928934, 0.7680412371134021, 0.7564766839378239, 0.7684210526315789]
after delete: len(clean_dataset) 190
after delete: len(noisy_dataset) 562
epoch [100/200] batch [5/5] time 0.295 (0.301) data 0.248 (0.254) loss_x loss_x 0.6689 (0.2998) acc_x 87.5000 (94.3750) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/17] time 0.293 (0.299) data 0.245 (0.251) loss_u loss_u 0.9775 (0.9498) acc_u 3.1250 (5.6250) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/17] time 0.317 (0.303) data 0.270 (0.256) loss_u loss_u 0.9922 (0.9636) acc_u 0.0000 (4.0625) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/17] time 0.311 (0.304) data 0.263 (0.256) loss_u loss_u 0.9995 (0.9630) acc_u 0.0000 (3.9583) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:143
clean false:43
clean_rate:0.7688172043010753
noisy true:243
noisy false:323
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [101/200] batch [5/5] time 0.326 (0.295) data 0.278 (0.247) loss_x loss_x 0.4028 (0.2727) acc_x 90.6250 (95.6250) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/17] time 0.298 (0.297) data 0.250 (0.249) loss_u loss_u 0.9370 (0.9563) acc_u 12.5000 (6.2500) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/17] time 0.331 (0.302) data 0.283 (0.254) loss_u loss_u 0.9814 (0.9600) acc_u 3.1250 (5.3125) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/17] time 0.288 (0.301) data 0.241 (0.253) loss_u loss_u 0.9697 (0.9609) acc_u 3.1250 (5.0000) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 194
clean true:145
clean false:49
clean_rate:0.7474226804123711
noisy true:243
noisy false:315
after delete: len(clean_dataset) 194
after delete: len(noisy_dataset) 558
epoch [102/200] batch [5/6] time 0.332 (0.308) data 0.286 (0.260) loss_x loss_x 0.3142 (0.2958) acc_x 90.6250 (93.7500) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/17] time 0.355 (0.320) data 0.306 (0.272) loss_u loss_u 0.9644 (0.9846) acc_u 3.1250 (1.2500) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/17] time 0.304 (0.313) data 0.254 (0.265) loss_u loss_u 0.9688 (0.9772) acc_u 3.1250 (1.8750) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/17] time 0.272 (0.310) data 0.224 (0.262) loss_u loss_u 0.9976 (0.9717) acc_u 0.0000 (2.7083) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 352
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 206
clean true:153
clean false:53
clean_rate:0.7427184466019418
noisy true:247
noisy false:299
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 546
epoch [103/200] batch [5/6] time 0.289 (0.303) data 0.242 (0.256) loss_x loss_x 0.3857 (0.4752) acc_x 87.5000 (85.0000) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/17] time 0.317 (0.300) data 0.270 (0.253) loss_u loss_u 0.9951 (0.9828) acc_u 0.0000 (1.8750) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/17] time 0.284 (0.304) data 0.237 (0.256) loss_u loss_u 0.9932 (0.9843) acc_u 0.0000 (1.5625) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/17] time 0.288 (0.302) data 0.241 (0.255) loss_u loss_u 0.9951 (0.9831) acc_u 0.0000 (1.6667) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2566, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 193
clean true:142
clean false:51
clean_rate:0.7357512953367875
noisy true:244
noisy false:315
after delete: len(clean_dataset) 193
after delete: len(noisy_dataset) 559
epoch [104/200] batch [5/6] time 0.289 (0.285) data 0.242 (0.237) loss_x loss_x 0.3289 (0.3434) acc_x 93.7500 (93.1250) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/17] time 0.308 (0.294) data 0.261 (0.246) loss_u loss_u 0.9561 (0.9685) acc_u 3.1250 (3.1250) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/17] time 0.310 (0.300) data 0.263 (0.252) loss_u loss_u 0.9604 (0.9692) acc_u 3.1250 (3.4375) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/17] time 0.280 (0.297) data 0.232 (0.249) loss_u loss_u 0.9673 (0.9662) acc_u 3.1250 (3.9583) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 356
confident_label rate tensor(0.2527, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 190
clean true:146
clean false:44
clean_rate:0.7684210526315789
noisy true:250
noisy false:312
after delete: len(clean_dataset) 190
after delete: len(noisy_dataset) 562
epoch [105/200] batch [5/5] time 0.277 (0.304) data 0.230 (0.256) loss_x loss_x 0.1631 (0.2615) acc_x 100.0000 (95.0000) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/17] time 0.296 (0.302) data 0.248 (0.254) loss_u loss_u 0.9990 (0.9745) acc_u 0.0000 (3.7500) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/17] time 0.304 (0.301) data 0.256 (0.253) loss_u loss_u 0.9634 (0.9661) acc_u 3.1250 (4.3750) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/17] time 0.286 (0.298) data 0.239 (0.250) loss_u loss_u 0.9531 (0.9643) acc_u 6.2500 (4.5833) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:137
clean false:46
clean_rate:0.7486338797814208
noisy true:236
noisy false:333
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [106/200] batch [5/5] time 0.324 (0.310) data 0.277 (0.261) loss_x loss_x 0.2839 (0.2057) acc_x 90.6250 (95.6250) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/17] time 0.315 (0.304) data 0.267 (0.256) loss_u loss_u 0.9980 (0.9587) acc_u 0.0000 (5.0000) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/17] time 0.281 (0.303) data 0.234 (0.255) loss_u loss_u 0.9565 (0.9604) acc_u 6.2500 (4.6875) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/17] time 0.300 (0.303) data 0.253 (0.255) loss_u loss_u 0.9038 (0.9527) acc_u 9.3750 (5.2083) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 194
clean true:146
clean false:48
clean_rate:0.7525773195876289
noisy true:234
noisy false:324
after delete: len(clean_dataset) 194
after delete: len(noisy_dataset) 558
epoch [107/200] batch [5/6] time 0.297 (0.304) data 0.250 (0.256) loss_x loss_x 0.2944 (0.3011) acc_x 93.7500 (92.5000) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/17] time 0.309 (0.306) data 0.262 (0.258) loss_u loss_u 0.9585 (0.9697) acc_u 3.1250 (2.5000) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/17] time 0.305 (0.304) data 0.257 (0.256) loss_u loss_u 0.9077 (0.9580) acc_u 12.5000 (4.3750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/17] time 0.281 (0.300) data 0.233 (0.252) loss_u loss_u 0.9990 (0.9617) acc_u 0.0000 (4.1667) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 353
confident_label rate tensor(0.2660, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 200
clean true:148
clean false:52
clean_rate:0.74
noisy true:251
noisy false:301
after delete: len(clean_dataset) 200
after delete: len(noisy_dataset) 552
epoch [108/200] batch [5/6] time 0.305 (0.284) data 0.254 (0.236) loss_x loss_x 0.2581 (0.2962) acc_x 96.8750 (95.6250) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/17] time 0.330 (0.300) data 0.282 (0.252) loss_u loss_u 0.9600 (0.9664) acc_u 3.1250 (3.7500) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/17] time 0.322 (0.299) data 0.275 (0.252) loss_u loss_u 0.9990 (0.9664) acc_u 0.0000 (3.7500) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/17] time 0.318 (0.302) data 0.271 (0.254) loss_u loss_u 0.9248 (0.9651) acc_u 6.2500 (3.7500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 202
clean true:151
clean false:51
clean_rate:0.7475247524752475
noisy true:238
noisy false:312
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 550
epoch [109/200] batch [5/6] time 0.269 (0.293) data 0.218 (0.244) loss_x loss_x 0.3755 (0.3032) acc_x 90.6250 (95.0000) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/17] time 0.328 (0.296) data 0.280 (0.248) loss_u loss_u 0.9897 (0.9811) acc_u 0.0000 (2.5000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/17] time 0.327 (0.293) data 0.278 (0.245) loss_u loss_u 0.9819 (0.9700) acc_u 3.1250 (3.7500) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/17] time 0.283 (0.298) data 0.236 (0.250) loss_u loss_u 0.9517 (0.9706) acc_u 6.2500 (3.5417) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 358
confident_label rate tensor(0.2660, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 200
clean true:149
clean false:51
clean_rate:0.745
noisy true:245
noisy false:307
after delete: len(clean_dataset) 200
after delete: len(noisy_dataset) 552
epoch [110/200] batch [5/6] time 0.275 (0.300) data 0.227 (0.253) loss_x loss_x 0.1573 (0.2083) acc_x 96.8750 (95.0000) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/17] time 0.319 (0.300) data 0.272 (0.253) loss_u loss_u 0.9722 (0.9804) acc_u 3.1250 (2.5000) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/17] time 0.311 (0.298) data 0.264 (0.250) loss_u loss_u 0.9863 (0.9777) acc_u 3.1250 (2.8125) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/17] time 0.310 (0.298) data 0.263 (0.250) loss_u loss_u 0.9043 (0.9725) acc_u 12.5000 (3.3333) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 359
confident_label rate tensor(0.2593, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 195
clean true:143
clean false:52
clean_rate:0.7333333333333333
noisy true:250
noisy false:307
after delete: len(clean_dataset) 195
after delete: len(noisy_dataset) 557
epoch [111/200] batch [5/6] time 0.299 (0.307) data 0.252 (0.260) loss_x loss_x 0.7026 (0.2968) acc_x 90.6250 (95.0000) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/17] time 0.312 (0.303) data 0.264 (0.255) loss_u loss_u 0.9712 (0.9663) acc_u 3.1250 (3.7500) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/17] time 0.324 (0.298) data 0.277 (0.251) loss_u loss_u 0.9243 (0.9539) acc_u 9.3750 (5.0000) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/17] time 0.316 (0.299) data 0.267 (0.251) loss_u loss_u 0.9985 (0.9622) acc_u 0.0000 (3.9583) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 358
confident_label rate tensor(0.2540, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 191
clean true:141
clean false:50
clean_rate:0.7382198952879581
noisy true:253
noisy false:308
after delete: len(clean_dataset) 191
after delete: len(noisy_dataset) 561
epoch [112/200] batch [5/5] time 0.319 (0.304) data 0.272 (0.257) loss_x loss_x 0.3442 (0.2666) acc_x 90.6250 (93.7500) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/17] time 0.299 (0.302) data 0.249 (0.254) loss_u loss_u 0.9521 (0.9546) acc_u 6.2500 (6.2500) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/17] time 0.311 (0.297) data 0.263 (0.249) loss_u loss_u 0.9980 (0.9597) acc_u 0.0000 (5.0000) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/17] time 0.301 (0.296) data 0.254 (0.248) loss_u loss_u 0.9854 (0.9575) acc_u 3.1250 (5.2083) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 352
confident_label rate tensor(0.2606, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 196
clean true:148
clean false:48
clean_rate:0.7551020408163265
noisy true:252
noisy false:304
after delete: len(clean_dataset) 196
after delete: len(noisy_dataset) 556
epoch [113/200] batch [5/6] time 0.291 (0.305) data 0.243 (0.258) loss_x loss_x 0.3181 (0.3775) acc_x 93.7500 (91.8750) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/17] time 0.327 (0.298) data 0.280 (0.250) loss_u loss_u 0.9976 (0.9857) acc_u 0.0000 (1.8750) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/17] time 0.311 (0.299) data 0.263 (0.252) loss_u loss_u 0.9248 (0.9722) acc_u 9.3750 (3.4375) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/17] time 0.292 (0.300) data 0.245 (0.253) loss_u loss_u 0.9932 (0.9647) acc_u 0.0000 (3.9583) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2593, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 195
clean true:148
clean false:47
clean_rate:0.7589743589743589
noisy true:238
noisy false:319
after delete: len(clean_dataset) 195
after delete: len(noisy_dataset) 557
epoch [114/200] batch [5/6] time 0.320 (0.307) data 0.272 (0.260) loss_x loss_x 0.5493 (0.3524) acc_x 90.6250 (93.7500) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/17] time 0.300 (0.310) data 0.252 (0.262) loss_u loss_u 0.9976 (0.9667) acc_u 0.0000 (3.1250) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/17] time 0.351 (0.311) data 0.304 (0.263) loss_u loss_u 0.9844 (0.9595) acc_u 0.0000 (4.0625) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/17] time 0.275 (0.309) data 0.227 (0.262) loss_u loss_u 0.9438 (0.9575) acc_u 6.2500 (4.3750) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 358
confident_label rate tensor(0.2646, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 199
clean true:146
clean false:53
clean_rate:0.7336683417085427
noisy true:248
noisy false:305
after delete: len(clean_dataset) 199
after delete: len(noisy_dataset) 553
epoch [115/200] batch [5/6] time 0.307 (0.310) data 0.259 (0.263) loss_x loss_x 0.2292 (0.2931) acc_x 96.8750 (95.0000) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/17] time 0.328 (0.307) data 0.280 (0.260) loss_u loss_u 0.9482 (0.9563) acc_u 6.2500 (5.0000) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/17] time 0.261 (0.304) data 0.213 (0.256) loss_u loss_u 0.9985 (0.9597) acc_u 0.0000 (5.0000) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/17] time 0.288 (0.303) data 0.240 (0.255) loss_u loss_u 0.9785 (0.9682) acc_u 3.1250 (3.9583) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2673, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 201
clean true:148
clean false:53
clean_rate:0.736318407960199
noisy true:238
noisy false:313
after delete: len(clean_dataset) 201
after delete: len(noisy_dataset) 551
epoch [116/200] batch [5/6] time 0.293 (0.297) data 0.246 (0.250) loss_x loss_x 0.2808 (0.2681) acc_x 90.6250 (93.7500) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/17] time 0.298 (0.304) data 0.250 (0.256) loss_u loss_u 0.9941 (0.9820) acc_u 0.0000 (1.8750) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/17] time 0.281 (0.300) data 0.234 (0.253) loss_u loss_u 0.9521 (0.9753) acc_u 6.2500 (2.8125) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/17] time 0.284 (0.299) data 0.236 (0.251) loss_u loss_u 0.9985 (0.9756) acc_u 0.0000 (2.9167) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2660, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 200
clean true:151
clean false:49
clean_rate:0.755
noisy true:232
noisy false:320
after delete: len(clean_dataset) 200
after delete: len(noisy_dataset) 552
epoch [117/200] batch [5/6] time 0.303 (0.309) data 0.254 (0.261) loss_x loss_x 0.2457 (0.2722) acc_x 90.6250 (93.1250) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/17] time 0.319 (0.301) data 0.272 (0.253) loss_u loss_u 0.9443 (0.9590) acc_u 6.2500 (5.0000) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/17] time 0.296 (0.304) data 0.248 (0.256) loss_u loss_u 0.9561 (0.9683) acc_u 6.2500 (4.0625) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/17] time 0.337 (0.305) data 0.289 (0.257) loss_u loss_u 0.9663 (0.9733) acc_u 3.1250 (3.5417) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 206
clean true:150
clean false:56
clean_rate:0.7281553398058253
noisy true:230
noisy false:316
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 546
epoch [118/200] batch [5/6] time 0.286 (0.298) data 0.239 (0.251) loss_x loss_x 0.1975 (0.2857) acc_x 100.0000 (95.0000) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/17] time 0.293 (0.300) data 0.245 (0.253) loss_u loss_u 0.9487 (0.9855) acc_u 6.2500 (1.8750) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/17] time 0.323 (0.300) data 0.276 (0.252) loss_u loss_u 0.9731 (0.9780) acc_u 3.1250 (2.5000) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/17] time 0.301 (0.298) data 0.252 (0.250) loss_u loss_u 0.9077 (0.9725) acc_u 9.3750 (2.9167) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2606, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 196
clean true:143
clean false:53
clean_rate:0.7295918367346939
noisy true:237
noisy false:319
after delete: len(clean_dataset) 196
after delete: len(noisy_dataset) 556
epoch [119/200] batch [5/6] time 0.270 (0.297) data 0.222 (0.250) loss_x loss_x 0.3125 (0.2166) acc_x 87.5000 (93.7500) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/17] time 0.287 (0.297) data 0.239 (0.249) loss_u loss_u 0.9985 (0.9742) acc_u 0.0000 (3.1250) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/17] time 0.298 (0.301) data 0.250 (0.253) loss_u loss_u 0.9985 (0.9702) acc_u 0.0000 (3.4375) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/17] time 0.308 (0.302) data 0.261 (0.254) loss_u loss_u 0.8730 (0.9606) acc_u 12.5000 (4.5833) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2593, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 195
clean true:145
clean false:50
clean_rate:0.7435897435897436
noisy true:240
noisy false:317
after delete: len(clean_dataset) 195
after delete: len(noisy_dataset) 557
epoch [120/200] batch [5/6] time 0.328 (0.301) data 0.280 (0.254) loss_x loss_x 0.2161 (0.2268) acc_x 93.7500 (95.0000) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/17] time 0.279 (0.292) data 0.231 (0.244) loss_u loss_u 0.9673 (0.9474) acc_u 3.1250 (5.6250) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/17] time 0.311 (0.297) data 0.263 (0.250) loss_u loss_u 0.9863 (0.9623) acc_u 0.0000 (3.4375) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/17] time 0.290 (0.294) data 0.242 (0.247) loss_u loss_u 0.9614 (0.9638) acc_u 3.1250 (3.5417) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2673, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 201
clean true:146
clean false:55
clean_rate:0.7263681592039801
noisy true:237
noisy false:314
after delete: len(clean_dataset) 201
after delete: len(noisy_dataset) 551
epoch [121/200] batch [5/6] time 0.321 (0.293) data 0.274 (0.246) loss_x loss_x 0.2844 (0.2894) acc_x 90.6250 (91.2500) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/17] time 0.318 (0.300) data 0.269 (0.253) loss_u loss_u 0.9956 (0.9714) acc_u 0.0000 (3.1250) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/17] time 0.288 (0.302) data 0.240 (0.254) loss_u loss_u 0.9971 (0.9668) acc_u 0.0000 (3.7500) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/17] time 0.303 (0.303) data 0.255 (0.255) loss_u loss_u 0.9976 (0.9679) acc_u 0.0000 (3.5417) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 202
clean true:144
clean false:58
clean_rate:0.7128712871287128
noisy true:238
noisy false:312
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 550
epoch [122/200] batch [5/6] time 0.287 (0.295) data 0.240 (0.248) loss_x loss_x 0.2976 (0.3632) acc_x 93.7500 (93.1250) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/17] time 0.324 (0.302) data 0.277 (0.255) loss_u loss_u 0.9976 (0.9753) acc_u 0.0000 (2.5000) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/17] time 0.313 (0.303) data 0.265 (0.255) loss_u loss_u 0.9678 (0.9741) acc_u 3.1250 (2.5000) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/17] time 0.314 (0.302) data 0.266 (0.255) loss_u loss_u 0.9946 (0.9685) acc_u 0.0000 (3.1250) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 362
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 202
clean true:146
clean false:56
clean_rate:0.7227722772277227
noisy true:244
noisy false:306
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 550
epoch [123/200] batch [5/6] time 0.280 (0.298) data 0.233 (0.251) loss_x loss_x 0.1500 (0.2103) acc_x 100.0000 (97.5000) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/17] time 0.272 (0.301) data 0.224 (0.254) loss_u loss_u 0.9404 (0.9721) acc_u 6.2500 (3.1250) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/17] time 0.277 (0.300) data 0.228 (0.252) loss_u loss_u 0.9639 (0.9688) acc_u 3.1250 (3.7500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/17] time 0.311 (0.301) data 0.263 (0.254) loss_u loss_u 0.9985 (0.9682) acc_u 0.0000 (3.7500) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.2620, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 197
clean true:145
clean false:52
clean_rate:0.7360406091370558
noisy true:230
noisy false:325
after delete: len(clean_dataset) 197
after delete: len(noisy_dataset) 555
epoch [124/200] batch [5/6] time 0.316 (0.295) data 0.267 (0.248) loss_x loss_x 0.6230 (0.3237) acc_x 90.6250 (93.1250) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/17] time 0.317 (0.293) data 0.269 (0.245) loss_u loss_u 0.9424 (0.9518) acc_u 6.2500 (5.0000) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/17] time 0.304 (0.293) data 0.256 (0.245) loss_u loss_u 0.9976 (0.9599) acc_u 0.0000 (4.0625) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/17] time 0.274 (0.296) data 0.227 (0.248) loss_u loss_u 0.9448 (0.9594) acc_u 6.2500 (4.3750) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:150
clean false:54
clean_rate:0.7352941176470589
noisy true:234
noisy false:314
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [125/200] batch [5/6] time 0.285 (0.294) data 0.238 (0.247) loss_x loss_x 0.1420 (0.2108) acc_x 96.8750 (96.8750) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/17] time 0.330 (0.311) data 0.283 (0.263) loss_u loss_u 0.9541 (0.9746) acc_u 6.2500 (3.7500) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/17] time 0.313 (0.311) data 0.264 (0.263) loss_u loss_u 0.9707 (0.9712) acc_u 3.1250 (3.7500) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/17] time 0.321 (0.315) data 0.273 (0.267) loss_u loss_u 0.9443 (0.9718) acc_u 6.2500 (3.3333) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 202
clean true:148
clean false:54
clean_rate:0.7326732673267327
noisy true:236
noisy false:314
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 550
epoch [126/200] batch [5/6] time 0.297 (0.304) data 0.249 (0.257) loss_x loss_x 0.4302 (0.2842) acc_x 96.8750 (96.2500) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/17] time 0.289 (0.300) data 0.241 (0.252) loss_u loss_u 0.9990 (0.9949) acc_u 0.0000 (0.0000) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/17] time 0.263 (0.298) data 0.215 (0.250) loss_u loss_u 0.9985 (0.9633) acc_u 0.0000 (3.4375) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/17] time 0.301 (0.300) data 0.254 (0.252) loss_u loss_u 0.9937 (0.9695) acc_u 0.0000 (3.1250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 202
clean true:147
clean false:55
clean_rate:0.7277227722772277
noisy true:235
noisy false:315
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 550
epoch [127/200] batch [5/6] time 0.284 (0.301) data 0.237 (0.254) loss_x loss_x 0.3591 (0.3721) acc_x 93.7500 (95.0000) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/17] time 0.310 (0.304) data 0.262 (0.257) loss_u loss_u 0.9668 (0.9624) acc_u 3.1250 (3.7500) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/17] time 0.287 (0.296) data 0.240 (0.249) loss_u loss_u 0.9346 (0.9659) acc_u 9.3750 (3.7500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/17] time 0.303 (0.295) data 0.255 (0.248) loss_u loss_u 0.9053 (0.9659) acc_u 9.3750 (3.7500) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:149
clean false:55
clean_rate:0.7303921568627451
noisy true:231
noisy false:317
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [128/200] batch [5/6] time 0.295 (0.317) data 0.247 (0.269) loss_x loss_x 0.2009 (0.2321) acc_x 93.7500 (94.3750) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/17] time 0.309 (0.311) data 0.261 (0.262) loss_u loss_u 1.0000 (0.9713) acc_u 0.0000 (3.1250) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/17] time 0.297 (0.312) data 0.249 (0.263) loss_u loss_u 0.9648 (0.9729) acc_u 6.2500 (3.1250) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/17] time 0.323 (0.311) data 0.275 (0.262) loss_u loss_u 0.9790 (0.9713) acc_u 3.1250 (3.3333) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 358
confident_label rate tensor(0.2699, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 203
clean true:147
clean false:56
clean_rate:0.7241379310344828
noisy true:247
noisy false:302
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 549
epoch [129/200] batch [5/6] time 0.305 (0.307) data 0.257 (0.259) loss_x loss_x 0.2556 (0.4217) acc_x 96.8750 (92.5000) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/17] time 0.313 (0.313) data 0.265 (0.265) loss_u loss_u 0.9697 (0.9543) acc_u 3.1250 (4.3750) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/17] time 0.350 (0.311) data 0.302 (0.263) loss_u loss_u 0.9722 (0.9614) acc_u 3.1250 (4.0625) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/17] time 0.317 (0.309) data 0.270 (0.261) loss_u loss_u 0.9688 (0.9659) acc_u 3.1250 (3.7500) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2566, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 193
clean true:145
clean false:48
clean_rate:0.7512953367875648
noisy true:244
noisy false:315
after delete: len(clean_dataset) 193
after delete: len(noisy_dataset) 559
epoch [130/200] batch [5/6] time 0.298 (0.294) data 0.251 (0.246) loss_x loss_x 0.4312 (0.2047) acc_x 90.6250 (95.6250) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/17] time 0.272 (0.291) data 0.224 (0.244) loss_u loss_u 0.9932 (0.9478) acc_u 0.0000 (5.6250) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/17] time 0.317 (0.297) data 0.269 (0.250) loss_u loss_u 0.9453 (0.9586) acc_u 3.1250 (4.3750) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/17] time 0.340 (0.301) data 0.292 (0.254) loss_u loss_u 0.9810 (0.9642) acc_u 3.1250 (3.7500) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 355
confident_label rate tensor(0.2633, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 198
clean true:147
clean false:51
clean_rate:0.7424242424242424
noisy true:250
noisy false:304
after delete: len(clean_dataset) 198
after delete: len(noisy_dataset) 554
epoch [131/200] batch [5/6] time 0.361 (0.315) data 0.313 (0.267) loss_x loss_x 0.1949 (0.2705) acc_x 96.8750 (94.3750) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/17] time 0.277 (0.318) data 0.229 (0.270) loss_u loss_u 0.9497 (0.9745) acc_u 6.2500 (2.5000) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/17] time 0.294 (0.307) data 0.246 (0.259) loss_u loss_u 0.9116 (0.9739) acc_u 9.3750 (2.8125) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/17] time 0.282 (0.304) data 0.235 (0.256) loss_u loss_u 0.9224 (0.9701) acc_u 9.3750 (3.5417) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2699, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 203
clean true:150
clean false:53
clean_rate:0.7389162561576355
noisy true:231
noisy false:318
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 549
epoch [132/200] batch [5/6] time 0.270 (0.333) data 0.223 (0.286) loss_x loss_x 0.2020 (0.2301) acc_x 93.7500 (96.2500) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/17] time 0.275 (0.308) data 0.226 (0.260) loss_u loss_u 0.8901 (0.9603) acc_u 12.5000 (4.3750) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/17] time 0.265 (0.302) data 0.218 (0.254) loss_u loss_u 0.9985 (0.9731) acc_u 0.0000 (3.1250) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/17] time 0.277 (0.300) data 0.229 (0.252) loss_u loss_u 0.9360 (0.9716) acc_u 6.2500 (3.1250) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2660, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 200
clean true:144
clean false:56
clean_rate:0.72
noisy true:236
noisy false:316
after delete: len(clean_dataset) 200
after delete: len(noisy_dataset) 552
epoch [133/200] batch [5/6] time 0.260 (0.301) data 0.213 (0.253) loss_x loss_x 0.2200 (0.2784) acc_x 96.8750 (94.3750) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/17] time 0.261 (0.292) data 0.214 (0.244) loss_u loss_u 0.9790 (0.9666) acc_u 3.1250 (3.7500) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/17] time 0.345 (0.296) data 0.297 (0.248) loss_u loss_u 0.9722 (0.9675) acc_u 3.1250 (3.4375) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/17] time 0.306 (0.296) data 0.259 (0.248) loss_u loss_u 0.9399 (0.9686) acc_u 6.2500 (3.3333) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 380
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 208
clean true:149
clean false:59
clean_rate:0.7163461538461539
noisy true:223
noisy false:321
after delete: len(clean_dataset) 208
after delete: len(noisy_dataset) 544
epoch [134/200] batch [5/6] time 0.322 (0.322) data 0.275 (0.275) loss_x loss_x 0.2893 (0.3074) acc_x 93.7500 (92.5000) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/17] time 0.249 (0.308) data 0.201 (0.260) loss_u loss_u 0.9995 (0.9747) acc_u 0.0000 (3.1250) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/17] time 0.373 (0.312) data 0.325 (0.265) loss_u loss_u 0.9961 (0.9771) acc_u 0.0000 (2.5000) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/17] time 0.304 (0.312) data 0.257 (0.264) loss_u loss_u 0.9980 (0.9760) acc_u 0.0000 (2.7083) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2699, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 203
clean true:149
clean false:54
clean_rate:0.7339901477832512
noisy true:237
noisy false:312
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 549
epoch [135/200] batch [5/6] time 0.251 (0.289) data 0.203 (0.242) loss_x loss_x 0.2981 (0.2692) acc_x 93.7500 (94.3750) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/17] time 0.278 (0.298) data 0.229 (0.250) loss_u loss_u 0.9697 (0.9776) acc_u 3.1250 (2.5000) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/17] time 0.328 (0.299) data 0.280 (0.252) loss_u loss_u 0.9268 (0.9671) acc_u 9.3750 (3.7500) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/17] time 0.296 (0.300) data 0.249 (0.252) loss_u loss_u 0.9995 (0.9691) acc_u 0.0000 (3.5417) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 385
confident_label rate tensor(0.2646, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 199
clean true:143
clean false:56
clean_rate:0.7185929648241206
noisy true:224
noisy false:329
after delete: len(clean_dataset) 199
after delete: len(noisy_dataset) 553
epoch [136/200] batch [5/6] time 0.344 (0.316) data 0.297 (0.269) loss_x loss_x 0.3435 (0.2574) acc_x 93.7500 (93.7500) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/17] time 0.272 (0.301) data 0.225 (0.254) loss_u loss_u 0.9316 (0.9625) acc_u 6.2500 (3.1250) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/17] time 0.320 (0.301) data 0.273 (0.253) loss_u loss_u 0.9067 (0.9563) acc_u 12.5000 (4.6875) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/17] time 0.329 (0.300) data 0.282 (0.253) loss_u loss_u 0.9541 (0.9581) acc_u 6.2500 (4.5833) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:145
clean false:59
clean_rate:0.7107843137254902
noisy true:230
noisy false:318
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [137/200] batch [5/6] time 0.308 (0.295) data 0.260 (0.247) loss_x loss_x 0.1400 (0.3597) acc_x 100.0000 (93.1250) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/17] time 0.293 (0.295) data 0.245 (0.247) loss_u loss_u 0.9683 (0.9567) acc_u 3.1250 (4.3750) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/17] time 0.307 (0.296) data 0.258 (0.249) loss_u loss_u 0.9673 (0.9583) acc_u 3.1250 (4.6875) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/17] time 0.291 (0.296) data 0.243 (0.248) loss_u loss_u 0.9443 (0.9623) acc_u 6.2500 (4.1667) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2779, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 209
clean true:149
clean false:60
clean_rate:0.7129186602870813
noisy true:224
noisy false:319
after delete: len(clean_dataset) 209
after delete: len(noisy_dataset) 543
epoch [138/200] batch [5/6] time 0.316 (0.313) data 0.269 (0.266) loss_x loss_x 0.1525 (0.1901) acc_x 96.8750 (96.2500) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/16] time 0.296 (0.308) data 0.247 (0.260) loss_u loss_u 0.9946 (0.9759) acc_u 0.0000 (2.5000) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/16] time 0.344 (0.304) data 0.296 (0.256) loss_u loss_u 0.9712 (0.9769) acc_u 3.1250 (2.5000) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/16] time 0.282 (0.303) data 0.234 (0.255) loss_u loss_u 0.9751 (0.9764) acc_u 3.1250 (2.5000) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2779, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 209
clean true:150
clean false:59
clean_rate:0.7177033492822966
noisy true:233
noisy false:310
after delete: len(clean_dataset) 209
after delete: len(noisy_dataset) 543
epoch [139/200] batch [5/6] time 0.331 (0.301) data 0.284 (0.253) loss_x loss_x 0.1364 (0.2617) acc_x 100.0000 (95.6250) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/16] time 0.277 (0.296) data 0.229 (0.248) loss_u loss_u 0.9429 (0.9673) acc_u 6.2500 (3.7500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/16] time 0.396 (0.310) data 0.347 (0.263) loss_u loss_u 0.9648 (0.9768) acc_u 6.2500 (2.8125) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [15/16] time 0.295 (0.311) data 0.247 (0.263) loss_u loss_u 0.9844 (0.9738) acc_u 3.1250 (3.1250) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.2793, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 210
clean true:150
clean false:60
clean_rate:0.7142857142857143
noisy true:225
noisy false:317
after delete: len(clean_dataset) 210
after delete: len(noisy_dataset) 542
epoch [140/200] batch [5/6] time 0.278 (0.319) data 0.230 (0.271) loss_x loss_x 0.1770 (0.2065) acc_x 100.0000 (94.3750) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/16] time 0.341 (0.309) data 0.291 (0.261) loss_u loss_u 0.9961 (0.9859) acc_u 0.0000 (1.2500) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/16] time 0.329 (0.308) data 0.282 (0.261) loss_u loss_u 0.9985 (0.9778) acc_u 0.0000 (2.5000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/16] time 0.271 (0.306) data 0.223 (0.258) loss_u loss_u 0.9707 (0.9783) acc_u 3.1250 (2.5000) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2753, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 207
clean true:148
clean false:59
clean_rate:0.714975845410628
noisy true:235
noisy false:310
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 545
epoch [141/200] batch [5/6] time 0.303 (0.293) data 0.256 (0.246) loss_x loss_x 0.2661 (0.2038) acc_x 96.8750 (95.0000) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/17] time 0.327 (0.297) data 0.278 (0.249) loss_u loss_u 0.9790 (0.9926) acc_u 3.1250 (0.6250) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/17] time 0.282 (0.294) data 0.234 (0.247) loss_u loss_u 0.9971 (0.9806) acc_u 0.0000 (1.8750) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/17] time 0.286 (0.297) data 0.238 (0.249) loss_u loss_u 0.9678 (0.9701) acc_u 3.1250 (2.9167) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2753, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 207
clean true:152
clean false:55
clean_rate:0.7342995169082126
noisy true:235
noisy false:310
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 545
epoch [142/200] batch [5/6] time 0.319 (0.307) data 0.272 (0.260) loss_x loss_x 0.6221 (0.3996) acc_x 78.1250 (91.8750) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/17] time 0.313 (0.310) data 0.262 (0.262) loss_u loss_u 0.9458 (0.9567) acc_u 6.2500 (5.0000) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/17] time 0.284 (0.303) data 0.236 (0.255) loss_u loss_u 0.9873 (0.9637) acc_u 0.0000 (3.7500) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/17] time 0.289 (0.302) data 0.242 (0.254) loss_u loss_u 0.9434 (0.9691) acc_u 9.3750 (3.3333) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 212
clean true:148
clean false:64
clean_rate:0.6981132075471698
noisy true:232
noisy false:308
after delete: len(clean_dataset) 212
after delete: len(noisy_dataset) 540
epoch [143/200] batch [5/6] time 0.277 (0.295) data 0.230 (0.248) loss_x loss_x 0.3313 (0.3415) acc_x 90.6250 (93.7500) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/16] time 0.309 (0.300) data 0.258 (0.252) loss_u loss_u 0.9878 (0.9811) acc_u 0.0000 (1.8750) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/16] time 0.332 (0.299) data 0.283 (0.251) loss_u loss_u 0.9971 (0.9759) acc_u 0.0000 (2.1875) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [15/16] time 0.328 (0.300) data 0.280 (0.252) loss_u loss_u 0.9731 (0.9720) acc_u 3.1250 (2.7083) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2726, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 205
clean true:150
clean false:55
clean_rate:0.7317073170731707
noisy true:231
noisy false:316
after delete: len(clean_dataset) 205
after delete: len(noisy_dataset) 547
epoch [144/200] batch [5/6] time 0.303 (0.309) data 0.253 (0.261) loss_x loss_x 0.2197 (0.1731) acc_x 96.8750 (97.5000) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/17] time 0.282 (0.310) data 0.235 (0.261) loss_u loss_u 0.9751 (0.9737) acc_u 3.1250 (2.5000) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/17] time 0.285 (0.304) data 0.237 (0.256) loss_u loss_u 0.9976 (0.9669) acc_u 0.0000 (3.7500) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/17] time 0.311 (0.304) data 0.263 (0.256) loss_u loss_u 0.9478 (0.9670) acc_u 6.2500 (3.5417) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 202
clean true:149
clean false:53
clean_rate:0.7376237623762376
noisy true:235
noisy false:315
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 550
epoch [145/200] batch [5/6] time 0.288 (0.303) data 0.239 (0.255) loss_x loss_x 0.1088 (0.1586) acc_x 100.0000 (96.2500) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/17] time 0.284 (0.306) data 0.233 (0.258) loss_u loss_u 0.9814 (0.9521) acc_u 3.1250 (5.6250) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/17] time 0.271 (0.303) data 0.223 (0.255) loss_u loss_u 0.9424 (0.9647) acc_u 6.2500 (4.0625) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/17] time 0.306 (0.302) data 0.259 (0.255) loss_u loss_u 0.9404 (0.9660) acc_u 9.3750 (3.9583) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 355
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 215
clean true:156
clean false:59
clean_rate:0.7255813953488373
noisy true:241
noisy false:296
after delete: len(clean_dataset) 215
after delete: len(noisy_dataset) 537
epoch [146/200] batch [5/6] time 0.293 (0.325) data 0.246 (0.277) loss_x loss_x 0.3708 (0.2564) acc_x 93.7500 (95.0000) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/16] time 0.301 (0.310) data 0.253 (0.262) loss_u loss_u 0.9116 (0.9729) acc_u 9.3750 (2.5000) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/16] time 0.254 (0.306) data 0.206 (0.258) loss_u loss_u 0.9395 (0.9764) acc_u 6.2500 (2.1875) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [15/16] time 0.275 (0.304) data 0.227 (0.256) loss_u loss_u 0.9980 (0.9797) acc_u 0.0000 (2.0833) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2699, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 203
clean true:146
clean false:57
clean_rate:0.7192118226600985
noisy true:233
noisy false:316
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 549
epoch [147/200] batch [5/6] time 0.275 (0.298) data 0.228 (0.251) loss_x loss_x 0.2603 (0.2107) acc_x 90.6250 (95.0000) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/17] time 0.317 (0.302) data 0.269 (0.255) loss_u loss_u 0.9414 (0.9658) acc_u 6.2500 (4.3750) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/17] time 0.286 (0.304) data 0.238 (0.256) loss_u loss_u 0.9692 (0.9617) acc_u 3.1250 (4.3750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/17] time 0.315 (0.304) data 0.267 (0.256) loss_u loss_u 0.9966 (0.9625) acc_u 0.0000 (4.3750) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 202
clean true:147
clean false:55
clean_rate:0.7277227722772277
noisy true:232
noisy false:318
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 550
epoch [148/200] batch [5/6] time 0.294 (0.299) data 0.246 (0.251) loss_x loss_x 0.0629 (0.1322) acc_x 100.0000 (98.7500) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/17] time 0.311 (0.302) data 0.264 (0.254) loss_u loss_u 0.9453 (0.9380) acc_u 6.2500 (6.8750) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/17] time 0.277 (0.302) data 0.229 (0.254) loss_u loss_u 0.9478 (0.9551) acc_u 6.2500 (5.0000) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/17] time 0.310 (0.305) data 0.262 (0.258) loss_u loss_u 0.9971 (0.9638) acc_u 0.0000 (3.9583) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2673, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 201
clean true:146
clean false:55
clean_rate:0.7263681592039801
noisy true:227
noisy false:324
after delete: len(clean_dataset) 201
after delete: len(noisy_dataset) 551
epoch [149/200] batch [5/6] time 0.278 (0.298) data 0.230 (0.251) loss_x loss_x 0.2085 (0.2295) acc_x 96.8750 (94.3750) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/17] time 0.322 (0.302) data 0.275 (0.255) loss_u loss_u 0.8779 (0.9555) acc_u 12.5000 (5.0000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/17] time 0.292 (0.302) data 0.244 (0.254) loss_u loss_u 0.9497 (0.9687) acc_u 6.2500 (3.4375) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/17] time 0.293 (0.299) data 0.245 (0.251) loss_u loss_u 0.9663 (0.9600) acc_u 3.1250 (4.3750) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 212
clean true:152
clean false:60
clean_rate:0.7169811320754716
noisy true:235
noisy false:305
after delete: len(clean_dataset) 212
after delete: len(noisy_dataset) 540
epoch [150/200] batch [5/6] time 0.266 (0.294) data 0.219 (0.246) loss_x loss_x 0.1541 (0.2457) acc_x 100.0000 (98.1250) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/16] time 0.306 (0.298) data 0.259 (0.250) loss_u loss_u 0.9678 (0.9795) acc_u 3.1250 (1.8750) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/16] time 0.297 (0.297) data 0.249 (0.249) loss_u loss_u 0.9131 (0.9740) acc_u 9.3750 (2.5000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [15/16] time 0.276 (0.297) data 0.228 (0.249) loss_u loss_u 0.9985 (0.9758) acc_u 0.0000 (2.2917) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:146
clean false:58
clean_rate:0.7156862745098039
noisy true:236
noisy false:312
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [151/200] batch [5/6] time 0.296 (0.299) data 0.249 (0.252) loss_x loss_x 0.1304 (0.1947) acc_x 100.0000 (96.8750) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/17] time 0.307 (0.296) data 0.259 (0.248) loss_u loss_u 0.9614 (0.9604) acc_u 3.1250 (3.7500) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/17] time 0.285 (0.297) data 0.238 (0.249) loss_u loss_u 0.9468 (0.9638) acc_u 6.2500 (3.7500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/17] time 0.318 (0.298) data 0.271 (0.250) loss_u loss_u 0.9453 (0.9681) acc_u 6.2500 (3.3333) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 382
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 212
clean true:149
clean false:63
clean_rate:0.7028301886792453
noisy true:221
noisy false:319
after delete: len(clean_dataset) 212
after delete: len(noisy_dataset) 540
epoch [152/200] batch [5/6] time 0.322 (0.307) data 0.274 (0.259) loss_x loss_x 0.2438 (0.3140) acc_x 93.7500 (95.0000) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/16] time 0.311 (0.306) data 0.263 (0.258) loss_u loss_u 0.9619 (0.9831) acc_u 3.1250 (1.2500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/16] time 0.295 (0.301) data 0.248 (0.253) loss_u loss_u 0.9688 (0.9771) acc_u 3.1250 (1.8750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [15/16] time 0.326 (0.303) data 0.278 (0.255) loss_u loss_u 0.9717 (0.9746) acc_u 3.1250 (2.2917) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2699, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 203
clean true:144
clean false:59
clean_rate:0.7093596059113301
noisy true:230
noisy false:319
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 549
epoch [153/200] batch [5/6] time 0.257 (0.291) data 0.208 (0.243) loss_x loss_x 0.1622 (0.2114) acc_x 100.0000 (96.8750) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/17] time 0.289 (0.296) data 0.241 (0.248) loss_u loss_u 0.9995 (0.9772) acc_u 0.0000 (2.5000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/17] time 0.305 (0.299) data 0.258 (0.251) loss_u loss_u 0.9678 (0.9588) acc_u 3.1250 (4.3750) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/17] time 0.300 (0.298) data 0.253 (0.251) loss_u loss_u 0.9800 (0.9632) acc_u 3.1250 (3.9583) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2699, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 203
clean true:149
clean false:54
clean_rate:0.7339901477832512
noisy true:232
noisy false:317
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 549
epoch [154/200] batch [5/6] time 0.315 (0.297) data 0.268 (0.249) loss_x loss_x 0.0960 (0.1314) acc_x 100.0000 (99.3750) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/17] time 0.317 (0.303) data 0.269 (0.256) loss_u loss_u 0.9722 (0.9702) acc_u 3.1250 (3.7500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/17] time 0.305 (0.301) data 0.257 (0.253) loss_u loss_u 0.9434 (0.9637) acc_u 9.3750 (4.6875) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/17] time 0.306 (0.302) data 0.259 (0.255) loss_u loss_u 0.9673 (0.9687) acc_u 3.1250 (3.7500) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 206
clean true:146
clean false:60
clean_rate:0.7087378640776699
noisy true:229
noisy false:317
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 546
epoch [155/200] batch [5/6] time 0.282 (0.286) data 0.235 (0.239) loss_x loss_x 0.1534 (0.2765) acc_x 96.8750 (96.8750) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/17] time 0.268 (0.291) data 0.220 (0.244) loss_u loss_u 0.9888 (0.9743) acc_u 0.0000 (3.1250) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/17] time 0.342 (0.300) data 0.294 (0.253) loss_u loss_u 0.9639 (0.9692) acc_u 3.1250 (3.1250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/17] time 0.329 (0.299) data 0.282 (0.251) loss_u loss_u 0.9561 (0.9679) acc_u 3.1250 (3.1250) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 211
clean true:153
clean false:58
clean_rate:0.7251184834123223
noisy true:225
noisy false:316
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 541
epoch [156/200] batch [5/6] time 0.266 (0.302) data 0.218 (0.254) loss_x loss_x 0.2205 (0.1786) acc_x 96.8750 (95.6250) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/16] time 0.314 (0.300) data 0.266 (0.252) loss_u loss_u 0.9683 (0.9813) acc_u 3.1250 (1.8750) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/16] time 0.263 (0.305) data 0.216 (0.257) loss_u loss_u 0.9463 (0.9636) acc_u 6.2500 (4.0625) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [15/16] time 0.337 (0.304) data 0.289 (0.256) loss_u loss_u 0.9497 (0.9712) acc_u 6.2500 (3.1250) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2779, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 209
clean true:150
clean false:59
clean_rate:0.7177033492822966
noisy true:234
noisy false:309
after delete: len(clean_dataset) 209
after delete: len(noisy_dataset) 543
epoch [157/200] batch [5/6] time 0.307 (0.309) data 0.259 (0.261) loss_x loss_x 0.2756 (0.1752) acc_x 93.7500 (97.5000) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/16] time 0.289 (0.296) data 0.241 (0.249) loss_u loss_u 0.9380 (0.9600) acc_u 6.2500 (4.3750) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/16] time 0.285 (0.294) data 0.237 (0.246) loss_u loss_u 0.9956 (0.9713) acc_u 0.0000 (2.8125) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [15/16] time 0.319 (0.299) data 0.272 (0.251) loss_u loss_u 0.9463 (0.9742) acc_u 6.2500 (2.5000) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 206
clean true:149
clean false:57
clean_rate:0.7233009708737864
noisy true:239
noisy false:307
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 546
epoch [158/200] batch [5/6] time 0.282 (0.301) data 0.235 (0.253) loss_x loss_x 0.3599 (0.1732) acc_x 90.6250 (96.8750) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/17] time 0.306 (0.302) data 0.258 (0.255) loss_u loss_u 0.9561 (0.9785) acc_u 6.2500 (2.5000) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/17] time 0.296 (0.303) data 0.249 (0.255) loss_u loss_u 0.9414 (0.9722) acc_u 6.2500 (3.1250) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/17] time 0.324 (0.303) data 0.276 (0.255) loss_u loss_u 0.9678 (0.9707) acc_u 3.1250 (3.1250) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 206
clean true:148
clean false:58
clean_rate:0.7184466019417476
noisy true:228
noisy false:318
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 546
epoch [159/200] batch [5/6] time 0.279 (0.305) data 0.232 (0.257) loss_x loss_x 0.6260 (0.2552) acc_x 90.6250 (95.0000) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/17] time 0.286 (0.298) data 0.239 (0.251) loss_u loss_u 0.9966 (0.9652) acc_u 0.0000 (3.7500) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/17] time 0.338 (0.300) data 0.291 (0.252) loss_u loss_u 0.9971 (0.9672) acc_u 0.0000 (3.7500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/17] time 0.305 (0.300) data 0.257 (0.252) loss_u loss_u 0.9160 (0.9689) acc_u 9.3750 (3.3333) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2779, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 209
clean true:151
clean false:58
clean_rate:0.722488038277512
noisy true:231
noisy false:312
after delete: len(clean_dataset) 209
after delete: len(noisy_dataset) 543
epoch [160/200] batch [5/6] time 0.347 (0.310) data 0.300 (0.263) loss_x loss_x 0.1381 (0.1693) acc_x 96.8750 (96.8750) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/16] time 0.282 (0.298) data 0.234 (0.251) loss_u loss_u 0.9580 (0.9785) acc_u 3.1250 (1.8750) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/16] time 0.302 (0.300) data 0.255 (0.252) loss_u loss_u 0.9404 (0.9788) acc_u 6.2500 (2.1875) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/16] time 0.322 (0.301) data 0.275 (0.254) loss_u loss_u 0.9917 (0.9733) acc_u 0.0000 (2.9167) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2646, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 199
clean true:144
clean false:55
clean_rate:0.7236180904522613
noisy true:230
noisy false:323
after delete: len(clean_dataset) 199
after delete: len(noisy_dataset) 553
epoch [161/200] batch [5/6] time 0.302 (0.323) data 0.255 (0.275) loss_x loss_x 0.1071 (0.2010) acc_x 100.0000 (98.1250) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/17] time 0.272 (0.308) data 0.222 (0.260) loss_u loss_u 0.9995 (0.9406) acc_u 0.0000 (6.2500) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/17] time 0.287 (0.309) data 0.240 (0.261) loss_u loss_u 0.9980 (0.9597) acc_u 0.0000 (4.3750) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/17] time 0.294 (0.304) data 0.246 (0.256) loss_u loss_u 0.9087 (0.9538) acc_u 9.3750 (5.0000) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2793, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 210
clean true:153
clean false:57
clean_rate:0.7285714285714285
noisy true:229
noisy false:313
after delete: len(clean_dataset) 210
after delete: len(noisy_dataset) 542
epoch [162/200] batch [5/6] time 0.274 (0.314) data 0.227 (0.267) loss_x loss_x 0.4636 (0.2731) acc_x 87.5000 (95.0000) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/16] time 0.324 (0.308) data 0.276 (0.261) loss_u loss_u 0.9692 (0.9643) acc_u 3.1250 (3.7500) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/16] time 0.317 (0.308) data 0.270 (0.260) loss_u loss_u 0.9976 (0.9705) acc_u 0.0000 (3.4375) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/16] time 0.317 (0.306) data 0.269 (0.258) loss_u loss_u 0.9653 (0.9729) acc_u 3.1250 (2.9167) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 206
clean true:149
clean false:57
clean_rate:0.7233009708737864
noisy true:227
noisy false:319
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 546
epoch [163/200] batch [5/6] time 0.290 (0.306) data 0.243 (0.258) loss_x loss_x 0.1124 (0.1216) acc_x 100.0000 (99.3750) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/17] time 0.282 (0.296) data 0.234 (0.248) loss_u loss_u 0.9858 (0.9580) acc_u 0.0000 (4.3750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/17] time 0.312 (0.306) data 0.265 (0.259) loss_u loss_u 0.9976 (0.9686) acc_u 0.0000 (3.1250) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/17] time 0.307 (0.307) data 0.260 (0.259) loss_u loss_u 0.9561 (0.9632) acc_u 6.2500 (3.7500) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 375
confident_label rate tensor(0.2793, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 210
clean true:150
clean false:60
clean_rate:0.7142857142857143
noisy true:227
noisy false:315
after delete: len(clean_dataset) 210
after delete: len(noisy_dataset) 542
epoch [164/200] batch [5/6] time 0.305 (0.293) data 0.258 (0.246) loss_x loss_x 0.1209 (0.1677) acc_x 100.0000 (97.5000) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/16] time 0.303 (0.293) data 0.256 (0.246) loss_u loss_u 0.9961 (0.9767) acc_u 0.0000 (2.5000) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/16] time 0.310 (0.295) data 0.262 (0.248) loss_u loss_u 0.9717 (0.9721) acc_u 3.1250 (3.1250) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [15/16] time 0.291 (0.298) data 0.244 (0.250) loss_u loss_u 0.9663 (0.9703) acc_u 3.1250 (3.1250) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 212
clean true:154
clean false:58
clean_rate:0.7264150943396226
noisy true:220
noisy false:320
after delete: len(clean_dataset) 212
after delete: len(noisy_dataset) 540
epoch [165/200] batch [5/6] time 0.293 (0.301) data 0.246 (0.254) loss_x loss_x 0.1895 (0.2327) acc_x 96.8750 (95.0000) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/16] time 0.339 (0.305) data 0.292 (0.258) loss_u loss_u 0.9688 (0.9833) acc_u 3.1250 (1.8750) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/16] time 0.295 (0.302) data 0.248 (0.254) loss_u loss_u 0.9785 (0.9791) acc_u 3.1250 (2.5000) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/16] time 0.306 (0.299) data 0.258 (0.252) loss_u loss_u 0.9526 (0.9725) acc_u 3.1250 (2.9167) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:144
clean false:60
clean_rate:0.7058823529411765
noisy true:244
noisy false:304
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [166/200] batch [5/6] time 0.278 (0.319) data 0.231 (0.271) loss_x loss_x 0.3208 (0.2144) acc_x 93.7500 (95.6250) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/17] time 0.294 (0.300) data 0.245 (0.252) loss_u loss_u 0.9561 (0.9689) acc_u 6.2500 (3.7500) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/17] time 0.280 (0.299) data 0.232 (0.251) loss_u loss_u 0.9897 (0.9733) acc_u 0.0000 (2.8125) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/17] time 0.290 (0.303) data 0.240 (0.254) loss_u loss_u 0.9165 (0.9663) acc_u 9.3750 (3.5417) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 375
confident_label rate tensor(0.2699, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 203
clean true:150
clean false:53
clean_rate:0.7389162561576355
noisy true:227
noisy false:322
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 549
epoch [167/200] batch [5/6] time 0.258 (0.291) data 0.211 (0.244) loss_x loss_x 0.4045 (0.2054) acc_x 90.6250 (94.3750) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/17] time 0.314 (0.297) data 0.266 (0.249) loss_u loss_u 0.9604 (0.9700) acc_u 6.2500 (3.7500) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/17] time 0.299 (0.295) data 0.252 (0.248) loss_u loss_u 0.9990 (0.9652) acc_u 0.0000 (4.3750) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/17] time 0.306 (0.297) data 0.258 (0.250) loss_u loss_u 0.9956 (0.9682) acc_u 0.0000 (3.9583) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:143
clean false:61
clean_rate:0.7009803921568627
noisy true:232
noisy false:316
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [168/200] batch [5/6] time 0.317 (0.304) data 0.270 (0.257) loss_x loss_x 0.1266 (0.2182) acc_x 100.0000 (96.2500) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/17] time 0.324 (0.307) data 0.277 (0.259) loss_u loss_u 0.9346 (0.9719) acc_u 6.2500 (3.1250) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/17] time 0.297 (0.303) data 0.250 (0.256) loss_u loss_u 0.9644 (0.9628) acc_u 3.1250 (3.7500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/17] time 0.310 (0.303) data 0.262 (0.255) loss_u loss_u 0.9053 (0.9632) acc_u 9.3750 (3.7500) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 383
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 202
clean true:146
clean false:56
clean_rate:0.7227722772277227
noisy true:223
noisy false:327
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 550
epoch [169/200] batch [5/6] time 0.332 (0.305) data 0.285 (0.258) loss_x loss_x 0.1284 (0.1829) acc_x 100.0000 (96.8750) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/17] time 0.265 (0.297) data 0.217 (0.249) loss_u loss_u 0.9355 (0.9554) acc_u 6.2500 (5.0000) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/17] time 0.310 (0.298) data 0.262 (0.250) loss_u loss_u 0.9702 (0.9627) acc_u 3.1250 (4.0625) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/17] time 0.289 (0.300) data 0.242 (0.252) loss_u loss_u 0.9980 (0.9670) acc_u 0.0000 (3.5417) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 208
clean true:149
clean false:59
clean_rate:0.7163461538461539
noisy true:232
noisy false:312
after delete: len(clean_dataset) 208
after delete: len(noisy_dataset) 544
epoch [170/200] batch [5/6] time 0.343 (0.308) data 0.294 (0.261) loss_x loss_x 0.6890 (0.2773) acc_x 90.6250 (95.6250) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/17] time 0.278 (0.302) data 0.230 (0.254) loss_u loss_u 0.9692 (0.9761) acc_u 3.1250 (2.5000) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/17] time 0.302 (0.302) data 0.254 (0.255) loss_u loss_u 0.8970 (0.9673) acc_u 9.3750 (3.4375) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/17] time 0.318 (0.308) data 0.267 (0.260) loss_u loss_u 0.9873 (0.9695) acc_u 0.0000 (2.9167) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2753, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 207
clean true:150
clean false:57
clean_rate:0.7246376811594203
noisy true:226
noisy false:319
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 545
epoch [171/200] batch [5/6] time 0.292 (0.305) data 0.244 (0.257) loss_x loss_x 0.4094 (0.2562) acc_x 93.7500 (95.6250) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/17] time 0.315 (0.295) data 0.265 (0.247) loss_u loss_u 0.9546 (0.9462) acc_u 6.2500 (5.6250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/17] time 0.312 (0.304) data 0.264 (0.256) loss_u loss_u 0.8813 (0.9582) acc_u 12.5000 (4.3750) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/17] time 0.291 (0.304) data 0.243 (0.256) loss_u loss_u 0.9951 (0.9620) acc_u 0.0000 (3.9583) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 211
clean true:150
clean false:61
clean_rate:0.7109004739336493
noisy true:225
noisy false:316
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 541
epoch [172/200] batch [5/6] time 0.290 (0.306) data 0.243 (0.258) loss_x loss_x 0.2334 (0.2774) acc_x 90.6250 (93.1250) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/16] time 0.277 (0.308) data 0.230 (0.260) loss_u loss_u 0.9985 (0.9674) acc_u 0.0000 (3.7500) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/16] time 0.289 (0.304) data 0.241 (0.256) loss_u loss_u 0.9717 (0.9709) acc_u 3.1250 (3.1250) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [15/16] time 0.299 (0.301) data 0.251 (0.253) loss_u loss_u 0.9888 (0.9682) acc_u 0.0000 (3.5417) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2660, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 200
clean true:146
clean false:54
clean_rate:0.73
noisy true:227
noisy false:325
after delete: len(clean_dataset) 200
after delete: len(noisy_dataset) 552
epoch [173/200] batch [5/6] time 0.274 (0.306) data 0.227 (0.258) loss_x loss_x 0.1793 (0.2133) acc_x 96.8750 (96.8750) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/17] time 0.281 (0.301) data 0.233 (0.253) loss_u loss_u 0.9438 (0.9604) acc_u 6.2500 (4.3750) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/17] time 0.293 (0.299) data 0.244 (0.251) loss_u loss_u 0.9434 (0.9594) acc_u 6.2500 (4.3750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/17] time 0.320 (0.303) data 0.272 (0.255) loss_u loss_u 0.9839 (0.9606) acc_u 3.1250 (4.3750) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 202
clean true:146
clean false:56
clean_rate:0.7227722772277227
noisy true:233
noisy false:317
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 550
epoch [174/200] batch [5/6] time 0.315 (0.297) data 0.268 (0.249) loss_x loss_x 0.1107 (0.1723) acc_x 96.8750 (96.8750) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/17] time 0.271 (0.306) data 0.223 (0.258) loss_u loss_u 0.9663 (0.9640) acc_u 3.1250 (4.3750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/17] time 0.293 (0.302) data 0.241 (0.253) loss_u loss_u 0.9424 (0.9610) acc_u 6.2500 (4.3750) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/17] time 0.280 (0.303) data 0.232 (0.255) loss_u loss_u 0.9502 (0.9619) acc_u 6.2500 (4.3750) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 206
clean true:149
clean false:57
clean_rate:0.7233009708737864
noisy true:236
noisy false:310
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 546
epoch [175/200] batch [5/6] time 0.287 (0.306) data 0.240 (0.259) loss_x loss_x 0.1931 (0.1528) acc_x 96.8750 (98.7500) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/17] time 0.311 (0.306) data 0.262 (0.258) loss_u loss_u 0.9385 (0.9545) acc_u 6.2500 (5.0000) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/17] time 0.318 (0.306) data 0.270 (0.258) loss_u loss_u 0.9990 (0.9642) acc_u 0.0000 (3.7500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/17] time 0.360 (0.305) data 0.312 (0.257) loss_u loss_u 0.9697 (0.9652) acc_u 3.1250 (3.5417) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2726, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 205
clean true:151
clean false:54
clean_rate:0.7365853658536585
noisy true:230
noisy false:317
after delete: len(clean_dataset) 205
after delete: len(noisy_dataset) 547
epoch [176/200] batch [5/6] time 0.281 (0.307) data 0.233 (0.259) loss_x loss_x 0.0884 (0.1379) acc_x 100.0000 (98.7500) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/17] time 0.295 (0.308) data 0.244 (0.260) loss_u loss_u 0.9653 (0.9712) acc_u 3.1250 (3.1250) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/17] time 0.332 (0.307) data 0.284 (0.258) loss_u loss_u 0.9321 (0.9612) acc_u 9.3750 (4.6875) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/17] time 0.296 (0.308) data 0.248 (0.259) loss_u loss_u 0.9995 (0.9658) acc_u 0.0000 (3.9583) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 381
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 206
clean true:148
clean false:58
clean_rate:0.7184466019417476
noisy true:223
noisy false:323
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 546
epoch [177/200] batch [5/6] time 0.270 (0.305) data 0.223 (0.257) loss_x loss_x 0.3706 (0.2116) acc_x 87.5000 (94.3750) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/17] time 0.280 (0.303) data 0.233 (0.255) loss_u loss_u 0.9380 (0.9636) acc_u 6.2500 (4.3750) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/17] time 0.274 (0.306) data 0.226 (0.259) loss_u loss_u 0.9375 (0.9586) acc_u 6.2500 (4.6875) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/17] time 0.290 (0.305) data 0.243 (0.258) loss_u loss_u 0.9985 (0.9678) acc_u 0.0000 (3.5417) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 385
confident_label rate tensor(0.2872, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 216
clean true:151
clean false:65
clean_rate:0.6990740740740741
noisy true:216
noisy false:320
after delete: len(clean_dataset) 216
after delete: len(noisy_dataset) 536
epoch [178/200] batch [5/6] time 0.284 (0.304) data 0.237 (0.256) loss_x loss_x 0.2852 (0.2539) acc_x 87.5000 (95.6250) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/16] time 0.297 (0.296) data 0.249 (0.248) loss_u loss_u 0.9688 (0.9796) acc_u 3.1250 (2.5000) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/16] time 0.328 (0.299) data 0.280 (0.251) loss_u loss_u 0.9683 (0.9733) acc_u 3.1250 (2.8125) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/16] time 0.248 (0.295) data 0.200 (0.248) loss_u loss_u 0.9976 (0.9750) acc_u 0.0000 (2.5000) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:148
clean false:56
clean_rate:0.7254901960784313
noisy true:226
noisy false:322
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [179/200] batch [5/6] time 0.291 (0.297) data 0.244 (0.250) loss_x loss_x 0.1293 (0.2043) acc_x 100.0000 (95.6250) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/17] time 0.295 (0.292) data 0.247 (0.245) loss_u loss_u 0.9985 (0.9624) acc_u 0.0000 (3.7500) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/17] time 0.263 (0.293) data 0.216 (0.245) loss_u loss_u 0.9688 (0.9658) acc_u 3.1250 (3.4375) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/17] time 0.256 (0.294) data 0.207 (0.246) loss_u loss_u 0.9990 (0.9655) acc_u 0.0000 (3.3333) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 380
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:148
clean false:56
clean_rate:0.7254901960784313
noisy true:224
noisy false:324
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [180/200] batch [5/6] time 0.284 (0.308) data 0.237 (0.261) loss_x loss_x 0.2274 (0.2853) acc_x 93.7500 (95.6250) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/17] time 0.251 (0.300) data 0.202 (0.253) loss_u loss_u 0.8701 (0.9532) acc_u 15.6250 (5.6250) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/17] time 0.264 (0.301) data 0.216 (0.253) loss_u loss_u 0.9702 (0.9695) acc_u 3.1250 (3.4375) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/17] time 0.250 (0.295) data 0.200 (0.248) loss_u loss_u 0.9604 (0.9639) acc_u 6.2500 (4.1667) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 381
confident_label rate tensor(0.2646, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 199
clean true:144
clean false:55
clean_rate:0.7236180904522613
noisy true:227
noisy false:326
after delete: len(clean_dataset) 199
after delete: len(noisy_dataset) 553
epoch [181/200] batch [5/6] time 0.296 (0.297) data 0.249 (0.249) loss_x loss_x 0.2272 (0.1332) acc_x 93.7500 (98.1250) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/17] time 0.296 (0.297) data 0.248 (0.250) loss_u loss_u 0.9316 (0.9470) acc_u 9.3750 (6.2500) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/17] time 0.315 (0.303) data 0.268 (0.255) loss_u loss_u 0.9683 (0.9565) acc_u 3.1250 (5.0000) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/17] time 0.261 (0.301) data 0.213 (0.253) loss_u loss_u 0.9609 (0.9539) acc_u 6.2500 (5.2083) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 206
clean true:147
clean false:59
clean_rate:0.7135922330097088
noisy true:231
noisy false:315
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 546
epoch [182/200] batch [5/6] time 0.286 (0.307) data 0.239 (0.259) loss_x loss_x 0.2056 (0.2099) acc_x 96.8750 (95.6250) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/17] time 0.297 (0.298) data 0.249 (0.251) loss_u loss_u 0.9229 (0.9639) acc_u 9.3750 (4.3750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/17] time 0.305 (0.304) data 0.257 (0.256) loss_u loss_u 0.9585 (0.9606) acc_u 6.2500 (4.6875) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/17] time 0.249 (0.299) data 0.201 (0.251) loss_u loss_u 0.9678 (0.9594) acc_u 3.1250 (4.3750) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2753, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 207
clean true:150
clean false:57
clean_rate:0.7246376811594203
noisy true:232
noisy false:313
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 545
epoch [183/200] batch [5/6] time 0.300 (0.313) data 0.253 (0.265) loss_x loss_x 0.3521 (0.2626) acc_x 93.7500 (96.8750) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/17] time 0.316 (0.306) data 0.268 (0.258) loss_u loss_u 0.9951 (0.9733) acc_u 0.0000 (2.5000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/17] time 0.303 (0.304) data 0.255 (0.257) loss_u loss_u 0.8833 (0.9600) acc_u 12.5000 (4.3750) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/17] time 0.307 (0.298) data 0.259 (0.251) loss_u loss_u 0.9678 (0.9667) acc_u 3.1250 (3.5417) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 211
clean true:152
clean false:59
clean_rate:0.7203791469194313
noisy true:232
noisy false:309
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 541
epoch [184/200] batch [5/6] time 0.316 (0.309) data 0.268 (0.261) loss_x loss_x 0.1385 (0.1741) acc_x 100.0000 (98.1250) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/16] time 0.293 (0.307) data 0.245 (0.259) loss_u loss_u 0.9985 (0.9753) acc_u 0.0000 (3.1250) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/16] time 0.305 (0.306) data 0.257 (0.257) loss_u loss_u 0.9980 (0.9753) acc_u 0.0000 (2.8125) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/16] time 0.295 (0.300) data 0.248 (0.252) loss_u loss_u 0.9668 (0.9760) acc_u 3.1250 (2.7083) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 211
clean true:151
clean false:60
clean_rate:0.7156398104265402
noisy true:223
noisy false:318
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 541
epoch [185/200] batch [5/6] time 0.302 (0.302) data 0.255 (0.254) loss_x loss_x 0.1172 (0.1489) acc_x 96.8750 (96.8750) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/16] time 0.292 (0.307) data 0.244 (0.259) loss_u loss_u 0.9341 (0.9559) acc_u 6.2500 (4.3750) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/16] time 0.303 (0.307) data 0.255 (0.260) loss_u loss_u 0.9976 (0.9638) acc_u 0.0000 (3.7500) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/16] time 0.302 (0.307) data 0.254 (0.259) loss_u loss_u 0.9927 (0.9726) acc_u 0.0000 (2.7083) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 381
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 215
clean true:152
clean false:63
clean_rate:0.7069767441860465
noisy true:219
noisy false:318
after delete: len(clean_dataset) 215
after delete: len(noisy_dataset) 537
epoch [186/200] batch [5/6] time 0.295 (0.298) data 0.247 (0.251) loss_x loss_x 0.2605 (0.2485) acc_x 93.7500 (95.0000) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/16] time 0.288 (0.300) data 0.240 (0.253) loss_u loss_u 0.9653 (0.9633) acc_u 6.2500 (4.3750) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/16] time 0.355 (0.309) data 0.308 (0.261) loss_u loss_u 0.9990 (0.9752) acc_u 0.0000 (2.8125) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [15/16] time 0.292 (0.305) data 0.245 (0.257) loss_u loss_u 1.0000 (0.9773) acc_u 0.0000 (2.5000) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 385
confident_label rate tensor(0.2872, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 216
clean true:152
clean false:64
clean_rate:0.7037037037037037
noisy true:215
noisy false:321
after delete: len(clean_dataset) 216
after delete: len(noisy_dataset) 536
epoch [187/200] batch [5/6] time 0.293 (0.288) data 0.246 (0.240) loss_x loss_x 0.3845 (0.2818) acc_x 90.6250 (95.0000) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/16] time 0.311 (0.296) data 0.263 (0.248) loss_u loss_u 0.9497 (0.9592) acc_u 6.2500 (5.0000) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/16] time 0.289 (0.295) data 0.241 (0.248) loss_u loss_u 0.9766 (0.9732) acc_u 3.1250 (3.1250) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/16] time 0.307 (0.295) data 0.259 (0.247) loss_u loss_u 0.9604 (0.9724) acc_u 6.2500 (3.3333) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2846, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 214
clean true:153
clean false:61
clean_rate:0.7149532710280374
noisy true:223
noisy false:315
after delete: len(clean_dataset) 214
after delete: len(noisy_dataset) 538
epoch [188/200] batch [5/6] time 0.310 (0.318) data 0.263 (0.271) loss_x loss_x 0.1207 (0.2573) acc_x 100.0000 (94.3750) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/16] time 0.324 (0.326) data 0.277 (0.279) loss_u loss_u 0.9961 (0.9806) acc_u 0.0000 (1.8750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/16] time 0.290 (0.323) data 0.240 (0.275) loss_u loss_u 0.9727 (0.9842) acc_u 3.1250 (1.5625) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/16] time 0.307 (0.321) data 0.260 (0.273) loss_u loss_u 0.9883 (0.9729) acc_u 0.0000 (2.7083) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 211
clean true:148
clean false:63
clean_rate:0.7014218009478673
noisy true:225
noisy false:316
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 541
epoch [189/200] batch [5/6] time 0.317 (0.333) data 0.270 (0.285) loss_x loss_x 0.6982 (0.3104) acc_x 90.6250 (95.0000) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/16] time 0.305 (0.327) data 0.258 (0.280) loss_u loss_u 0.9678 (0.9426) acc_u 3.1250 (6.2500) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/16] time 0.317 (0.326) data 0.269 (0.278) loss_u loss_u 0.9961 (0.9619) acc_u 0.0000 (4.0625) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/16] time 0.274 (0.321) data 0.227 (0.274) loss_u loss_u 0.9883 (0.9699) acc_u 0.0000 (3.1250) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 384
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 208
clean true:148
clean false:60
clean_rate:0.7115384615384616
noisy true:220
noisy false:324
after delete: len(clean_dataset) 208
after delete: len(noisy_dataset) 544
epoch [190/200] batch [5/6] time 0.337 (0.344) data 0.289 (0.296) loss_x loss_x 0.1652 (0.1381) acc_x 96.8750 (98.1250) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/17] time 0.283 (0.331) data 0.234 (0.283) loss_u loss_u 0.9326 (0.9386) acc_u 6.2500 (6.8750) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/17] time 0.350 (0.334) data 0.302 (0.286) loss_u loss_u 0.9634 (0.9572) acc_u 3.1250 (4.6875) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/17] time 0.259 (0.332) data 0.209 (0.284) loss_u loss_u 0.9736 (0.9652) acc_u 3.1250 (3.7500) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 211
clean true:152
clean false:59
clean_rate:0.7203791469194313
noisy true:231
noisy false:310
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 541
epoch [191/200] batch [5/6] time 0.308 (0.307) data 0.261 (0.259) loss_x loss_x 0.3547 (0.2277) acc_x 90.6250 (96.8750) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/16] time 0.320 (0.309) data 0.272 (0.262) loss_u loss_u 0.9634 (0.9633) acc_u 3.1250 (3.7500) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/16] time 0.320 (0.319) data 0.272 (0.271) loss_u loss_u 0.9976 (0.9623) acc_u 0.0000 (4.0625) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [15/16] time 0.272 (0.319) data 0.224 (0.271) loss_u loss_u 0.9692 (0.9659) acc_u 3.1250 (3.7500) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 384
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 215
clean true:151
clean false:64
clean_rate:0.7023255813953488
noisy true:217
noisy false:320
after delete: len(clean_dataset) 215
after delete: len(noisy_dataset) 537
epoch [192/200] batch [5/6] time 0.358 (0.320) data 0.311 (0.273) loss_x loss_x 0.0610 (0.1821) acc_x 100.0000 (97.5000) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/16] time 0.287 (0.308) data 0.239 (0.260) loss_u loss_u 0.9551 (0.9509) acc_u 6.2500 (5.6250) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/16] time 0.310 (0.310) data 0.263 (0.263) loss_u loss_u 0.9648 (0.9681) acc_u 3.1250 (3.4375) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/16] time 0.295 (0.312) data 0.247 (0.265) loss_u loss_u 0.9956 (0.9737) acc_u 0.0000 (2.7083) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 390
confident_label rate tensor(0.2753, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 207
clean true:147
clean false:60
clean_rate:0.7101449275362319
noisy true:215
noisy false:330
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 545
epoch [193/200] batch [5/6] time 0.334 (0.312) data 0.287 (0.265) loss_x loss_x 0.1554 (0.1937) acc_x 93.7500 (95.6250) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/17] time 0.274 (0.313) data 0.226 (0.266) loss_u loss_u 0.9829 (0.9710) acc_u 3.1250 (3.7500) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/17] time 0.329 (0.318) data 0.281 (0.270) loss_u loss_u 0.9746 (0.9747) acc_u 3.1250 (3.1250) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/17] time 0.284 (0.318) data 0.236 (0.270) loss_u loss_u 0.9727 (0.9721) acc_u 3.1250 (3.3333) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 208
clean true:149
clean false:59
clean_rate:0.7163461538461539
noisy true:233
noisy false:311
after delete: len(clean_dataset) 208
after delete: len(noisy_dataset) 544
epoch [194/200] batch [5/6] time 0.314 (0.300) data 0.267 (0.253) loss_x loss_x 0.1583 (0.1876) acc_x 96.8750 (96.8750) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/17] time 0.288 (0.297) data 0.241 (0.249) loss_u loss_u 0.9761 (0.9704) acc_u 3.1250 (3.1250) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/17] time 0.330 (0.295) data 0.282 (0.248) loss_u loss_u 0.9644 (0.9748) acc_u 3.1250 (2.5000) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/17] time 0.288 (0.294) data 0.237 (0.246) loss_u loss_u 0.9502 (0.9688) acc_u 6.2500 (3.3333) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2846, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 214
clean true:155
clean false:59
clean_rate:0.7242990654205608
noisy true:221
noisy false:317
after delete: len(clean_dataset) 214
after delete: len(noisy_dataset) 538
epoch [195/200] batch [5/6] time 0.293 (0.310) data 0.245 (0.262) loss_x loss_x 0.2888 (0.3568) acc_x 90.6250 (90.6250) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/16] time 0.300 (0.295) data 0.253 (0.248) loss_u loss_u 0.9678 (0.9750) acc_u 3.1250 (2.5000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/16] time 0.307 (0.296) data 0.258 (0.249) loss_u loss_u 0.9580 (0.9749) acc_u 6.2500 (3.1250) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [15/16] time 0.256 (0.298) data 0.204 (0.250) loss_u loss_u 0.9766 (0.9726) acc_u 3.1250 (3.1250) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 208
clean true:150
clean false:58
clean_rate:0.7211538461538461
noisy true:226
noisy false:318
after delete: len(clean_dataset) 208
after delete: len(noisy_dataset) 544
epoch [196/200] batch [5/6] time 0.329 (0.315) data 0.282 (0.267) loss_x loss_x 0.1014 (0.1720) acc_x 100.0000 (97.5000) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/17] time 0.314 (0.301) data 0.266 (0.254) loss_u loss_u 0.9448 (0.9444) acc_u 6.2500 (6.2500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/17] time 0.301 (0.299) data 0.253 (0.251) loss_u loss_u 0.9712 (0.9593) acc_u 3.1250 (4.3750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/17] time 0.316 (0.301) data 0.269 (0.254) loss_u loss_u 0.9995 (0.9631) acc_u 0.0000 (3.9583) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 382
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 208
clean true:149
clean false:59
clean_rate:0.7163461538461539
noisy true:221
noisy false:323
after delete: len(clean_dataset) 208
after delete: len(noisy_dataset) 544
epoch [197/200] batch [5/6] time 0.319 (0.305) data 0.272 (0.258) loss_x loss_x 0.2590 (0.2254) acc_x 96.8750 (95.0000) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/17] time 0.335 (0.305) data 0.288 (0.257) loss_u loss_u 0.9233 (0.9684) acc_u 9.3750 (3.7500) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/17] time 0.284 (0.306) data 0.237 (0.258) loss_u loss_u 0.9829 (0.9726) acc_u 3.1250 (3.1250) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/17] time 0.277 (0.305) data 0.229 (0.257) loss_u loss_u 0.9712 (0.9624) acc_u 3.1250 (4.3750) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2793, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 210
clean true:148
clean false:62
clean_rate:0.7047619047619048
noisy true:239
noisy false:303
after delete: len(clean_dataset) 210
after delete: len(noisy_dataset) 542
epoch [198/200] batch [5/6] time 0.301 (0.312) data 0.254 (0.265) loss_x loss_x 0.2345 (0.2201) acc_x 96.8750 (96.8750) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/16] time 0.302 (0.306) data 0.255 (0.259) loss_u loss_u 0.9902 (0.9788) acc_u 0.0000 (3.1250) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/16] time 0.331 (0.313) data 0.283 (0.266) loss_u loss_u 0.9434 (0.9694) acc_u 6.2500 (3.7500) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/16] time 0.327 (0.315) data 0.278 (0.267) loss_u loss_u 0.9302 (0.9717) acc_u 6.2500 (3.3333) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 208
clean true:151
clean false:57
clean_rate:0.7259615384615384
noisy true:223
noisy false:321
after delete: len(clean_dataset) 208
after delete: len(noisy_dataset) 544
epoch [199/200] batch [5/6] time 0.246 (0.260) data 0.200 (0.212) loss_x loss_x 0.1793 (0.1883) acc_x 93.7500 (95.6250) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/17] time 0.287 (0.266) data 0.240 (0.218) loss_u loss_u 0.9731 (0.9583) acc_u 3.1250 (5.0000) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/17] time 0.303 (0.284) data 0.255 (0.236) loss_u loss_u 0.9541 (0.9737) acc_u 6.2500 (3.1250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [15/17] time 0.311 (0.295) data 0.263 (0.248) loss_u loss_u 0.9961 (0.9689) acc_u 0.0000 (3.5417) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 382
confident_label rate tensor(0.2699, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 203
clean true:149
clean false:54
clean_rate:0.7339901477832512
noisy true:221
noisy false:328
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 549
epoch [200/200] batch [5/6] time 0.279 (0.286) data 0.230 (0.238) loss_x loss_x 0.1737 (0.1368) acc_x 96.8750 (98.1250) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/17] time 0.280 (0.282) data 0.230 (0.234) loss_u loss_u 0.9697 (0.9474) acc_u 3.1250 (6.8750) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/17] time 0.292 (0.278) data 0.244 (0.230) loss_u loss_u 0.9424 (0.9506) acc_u 6.2500 (5.9375) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/17] time 0.311 (0.284) data 0.261 (0.236) loss_u loss_u 0.9629 (0.9568) acc_u 6.2500 (5.2083) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/dtd/NLPrompt/rn50_16shots/noise_sym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 1,692
* correct: 724
* accuracy: 42.8%
* error: 57.2%
* macro_f1: 42.4%
Elapsed: 0:48:20
